<files codepage='65001' xmlns:dt='urn:schemas-microsoft-com:datatypes'>
	<file name='zb_system\function\c_system_common.php' crc32='1D7CDBDF'  dt:dt='bin.base64'>PD9waHANCi8qKg0KICog6L6F5Yqp6YCa55So5Ye95pWwLg0KICoNCiAqIEBjb3B5cmlnaHQgKEMpIFJhaW5ib3dTb2Z0IFN0dWRpbw0KICovDQoNCi8qKg0KICog5b6X5Yiw6K+35rGC5Y2P6K6u77yI6ICD6JmR5Yiw5Y+N5ZCR5Luj55CG562J5Y6f5Zug77yM5pyq5b+F5YeG56Gu77yJDQogKiDlpoLmnpzmg7Pojrflj5blh4bnoa7nmoTlgLzvvIzor7d6YnAtPkxvYWTlkI7kvb/nlKgkemJwLT5pc0h0dHBzLg0KICoNCiAqIEBwYXJhbSAkYXJyYXkNCiAqDQogKiBAcmV0dXJuICRzdHJpbmcNCiAqLw0KZnVuY3Rpb24gR2V0U2NoZW1lKCRhcnJheSkNCnsNCiAgICAkYXJyYXkgPSBhcnJheV9jaGFuZ2Vfa2V5X2Nhc2UoJGFycmF5LCBDQVNFX1VQUEVSKTsNCiAgICBpZiAoDQogICAgICAgIChhcnJheV9rZXlfZXhpc3RzKCdSRVFVRVNUX1NDSEVNRScsICRhcnJheSkNCiAgICAgICAgICAgICYmDQogICAgICAgICAgICAoc3RydG9sb3dlcigkYXJyYXlbJ1JFUVVFU1RfU0NIRU1FJ10pID09ICdodHRwcycpKQ0KICAgICAgICB8fA0KICAgICAgICAoYXJyYXlfa2V5X2V4aXN0cygnSFRUUFMnLCAkYXJyYXkpDQogICAgICAgICAgICAmJg0KICAgICAgICAgICAgKHN0cnRvbG93ZXIoJGFycmF5WydIVFRQUyddKSA9PSAnb24nKSkNCiAgICAgICAgfHwNCiAgICAgICAgKGFycmF5X2tleV9leGlzdHMoJ0hUVFBfRlJPTV9IVFRQUycsICRhcnJheSkNCiAgICAgICAgICAgICYmDQogICAgICAgICAgICAoc3RydG9sb3dlcigkYXJyYXlbJ0hUVFBfRlJPTV9IVFRQUyddKSA9PSAnb24nKSkNCiAgICAgICAgfHwNCiAgICAgICAgKGFycmF5X2tleV9leGlzdHMoJ1NFUlZFUl9QT1JUJywgJGFycmF5KQ0KICAgICAgICAgICAgJiYNCiAgICAgICAgICAgIChzdHJ0b2xvd2VyKCRhcnJheVsnU0VSVkVSX1BPUlQnXSkgPT0gNDQzKSkNCiAgICAgICAgfHwNCiAgICAgICAgKGFycmF5X2tleV9leGlzdHMoJ0hUVFBfWF9GT1JXQVJERURfUE9SVCcsICRhcnJheSkNCiAgICAgICAgICAgICYmDQogICAgICAgICAgICAoc3RydG9sb3dlcigkYXJyYXlbJ0hUVFBfWF9GT1JXQVJERURfUE9SVCddKSA9PSA0NDMpKQ0KICAgICAgICB8fA0KICAgICAgICAoYXJyYXlfa2V5X2V4aXN0cygnSFRUUF9YX0ZPUldBUkRFRF9QUk9UTycsICRhcnJheSkNCiAgICAgICAgICAgICYmDQogICAgICAgICAgICAoc3RydG9sb3dlcigkYXJyYXlbJ0hUVFBfWF9GT1JXQVJERURfUFJPVE8nXSkgPT0gJ2h0dHBzJykpDQogICAgICAgIHx8DQogICAgICAgIChhcnJheV9rZXlfZXhpc3RzKCdIVFRQX0ZST05UX0VORF9IVFRQUycsICRhcnJheSkNCiAgICAgICAgICAgICYmDQogICAgICAgICAgICAoc3RydG9sb3dlcigkYXJyYXlbJ0hUVFBfRlJPTlRfRU5EX0hUVFBTJ10pID09ICdvbicpKQ0KICAgICAgICB8fA0KICAgICAgICAoYXJyYXlfa2V5X2V4aXN0cygnSFRUUF9YX0ZPUldBUkRFRF9QUk9UT0NPTCcsICRhcnJheSkNCiAgICAgICAgICAgICYmDQogICAgICAgICAgICAoc3RydG9sb3dlcigkYXJyYXlbJ0hUVFBfWF9GT1JXQVJERURfUFJPVE9DT0wnXSkgPT0gJ2h0dHBzJykpDQogICAgICAgIHx8DQogICAgICAgIChhcnJheV9rZXlfZXhpc3RzKCdIVFRQX1hfRk9SV0FSREVEX1NTTCcsICRhcnJheSkNCiAgICAgICAgICAgICYmDQogICAgICAgICAgICAoc3RydG9sb3dlcigkYXJyYXlbJ0hUVFBfWF9GT1JXQVJERURfU1NMJ10pID09ICdvbicpKQ0KICAgICAgICB8fA0KICAgICAgICAoYXJyYXlfa2V5X2V4aXN0cygnSFRUUF9YX1VSTF9TQ0hFTUUnLCAkYXJyYXkpDQogICAgICAgICAgICAmJg0KICAgICAgICAgICAgKHN0cnRvbG93ZXIoJGFycmF5WydIVFRQX1hfVVJMX1NDSEVNRSddKSA9PSAnaHR0cHMnKSkNCiAgICAgICAgfHwNCiAgICAgICAgKGFycmF5X2tleV9leGlzdHMoJ0hUVFBfQ0ZfVklTSVRPUicsICRhcnJheSkNCiAgICAgICAgICAgICYmDQogICAgICAgICAgICAoc3RyaXBvcygkYXJyYXlbJ0hUVFBfQ0ZfVklTSVRPUiddLCAnaHR0cHMnKSAhPT0gZmFsc2UpKQ0KICAgICAgICB8fA0KICAgICAgICAoYXJyYXlfa2V5X2V4aXN0cygnU0VSVkVSX1BPUlRfU0VDVVJFJywgJGFycmF5KQ0KICAgICAgICAgICAgJiYNCiAgICAgICAgICAgIChzdHJ0b2xvd2VyKCRhcnJheVsnU0VSVkVSX1BPUlRfU0VDVVJFJ10pID09IDEpKQ0KICAgICkgew0KICAgICAgICByZXR1cm4gJ2h0dHBzOi8vJzsNCiAgICB9DQoNCiAgICByZXR1cm4gJ2h0dHA6Ly8nOw0KfQ0KDQovKioNCiAqIOiOt+WPluacjeWKoeWZqC4NCiAqDQogKiBAcmV0dXJuIGludA0KICovDQpmdW5jdGlvbiBHZXRXZWJTZXJ2ZXIoKQ0Kew0KICAgIGlmICghaXNzZXQoJF9TRVJWRVJbJ1NFUlZFUl9TT0ZUV0FSRSddKSkgew0KICAgICAgICByZXR1cm4gU0VSVkVSX1VOS05PV047DQogICAgfQ0KICAgICR3ZWJTZXJ2ZXIgPSBzdHJ0b2xvd2VyKCRfU0VSVkVSWydTRVJWRVJfU09GVFdBUkUnXSk7DQogICAgaWYgKHN0cnBvcygkd2ViU2VydmVyLCAnYXBhY2hlJykgIT09IGZhbHNlKSB7DQogICAgICAgIHJldHVybiBTRVJWRVJfQVBBQ0hFOw0KICAgIH0gZWxzZWlmIChzdHJwb3MoJHdlYlNlcnZlciwgJ21pY3Jvc29mdC1paXMnKSAhPT0gZmFsc2UpIHsNCiAgICAgICAgcmV0dXJuIFNFUlZFUl9JSVM7DQogICAgfSBlbHNlaWYgKHN0cnBvcygkd2ViU2VydmVyLCAnbmdpbngnKSAhPT0gZmFsc2UpIHsNCiAgICAgICAgcmV0dXJuIFNFUlZFUl9OR0lOWDsNCiAgICB9IGVsc2VpZiAoc3RycG9zKCR3ZWJTZXJ2ZXIsICdsaWdodHRwZCcpICE9PSBmYWxzZSkgew0KICAgICAgICByZXR1cm4gU0VSVkVSX0xJR0hUVFBEOw0KICAgIH0gZWxzZWlmIChzdHJwb3MoJHdlYlNlcnZlciwgJ2thbmdsZScpICE9PSBmYWxzZSkgew0KICAgICAgICByZXR1cm4gU0VSVkVSX0tBTkdMRTsNCiAgICB9IGVsc2VpZiAoc3RycG9zKCR3ZWJTZXJ2ZXIsICdjYWRkeScpICE9PSBmYWxzZSkgew0KICAgICAgICByZXR1cm4gU0VSVkVSX0NBRERZOw0KICAgIH0gZWxzZWlmIChzdHJwb3MoJHdlYlNlcnZlciwgJ2RldmVsb3BtZW50IHNlcnZlcicpICE9PSBmYWxzZSkgew0KICAgICAgICByZXR1cm4gU0VSVkVSX0JVSUxUSU47DQogICAgfSBlbHNlIHsNCiAgICAgICAgcmV0dXJuIFNFUlZFUl9VTktOT1dOOw0KICAgIH0NCn0NCg0KLyoqDQogKiDojrflj5bmk43kvZzns7vnu58NCiAqDQogKiBAcmV0dXJuIGludA0KICovDQpmdW5jdGlvbiBHZXRTeXN0ZW0oKQ0Kew0KICAgIGlmIChpbl9hcnJheShzdHJ0b3VwcGVyKFBIUF9PUyksIGFycmF5KCdXSU5OVCcsICdXSU4zMicsICdXSU5ET1dTJykpKSB7DQogICAgICAgIHJldHVybiBTWVNURU1fV0lORE9XUzsNCiAgICB9IGVsc2VpZiAoKHN0cnRvdXBwZXIoUEhQX09TKSA9PT0gJ1VOSVgnKSkgew0KICAgICAgICByZXR1cm4gU1lTVEVNX1VOSVg7DQogICAgfSBlbHNlaWYgKHN0cnRvdXBwZXIoUEhQX09TKSA9PT0gJ0xJTlVYJykgew0KICAgICAgICByZXR1cm4gU1lTVEVNX0xJTlVYOw0KICAgIH0gZWxzZWlmIChzdHJ0b3VwcGVyKFBIUF9PUykgPT09ICdEQVJXSU4nKSB7DQogICAgICAgIHJldHVybiBTWVNURU1fREFSV0lOOw0KICAgIH0gZWxzZWlmIChzdHJ0b3VwcGVyKHN1YnN0cihQSFBfT1MsIDAsIDYpKSA9PT0gJ0NZR1dJTicpIHsNCiAgICAgICAgcmV0dXJuIFNZU1RFTV9DWUdXSU47DQogICAgfSBlbHNlaWYgKGluX2FycmF5KHN0cnRvdXBwZXIoUEhQX09TKSwgYXJyYXkoJ05FVEJTRCcsICdPUEVOQlNEJywgJ0ZSRUVCU0QnKSkpIHsNCiAgICAgICAgcmV0dXJuIFNZU1RFTV9CU0Q7DQogICAgfSBlbHNlIHsNCiAgICAgICAgcmV0dXJuIFNZU1RFTV9VTktOT1dOOw0KICAgIH0NCn0NCg0KLyoqDQogKiDojrflj5ZQSFDop6PmnpDlvJXmk44uDQogKg0KICogQHJldHVybiBpbnQNCiAqLw0KZnVuY3Rpb24gR2V0UEhQRW5naW5lKCkNCnsNCiAgICByZXR1cm4gRU5HSU5FX1BIUDsNCn0NCg0KLyoqDQogKiDojrflj5ZQSFAgVmVyc2lvbi4NCiAqDQogKiBAcmV0dXJuIHN0cmluZw0KICovDQpmdW5jdGlvbiBHZXRQSFBWZXJzaW9uKCkNCnsNCiAgICAkcCA9IHBocHZlcnNpb24oKTsNCiAgICBpZiAoc3RycG9zKCRwLCAnLScpICE9PSBmYWxzZSkgew0KICAgICAgICAkcCA9IHN1YnN0cigkcCwgMCwgc3RycG9zKCRwLCAnLScpKTsNCiAgICB9DQoNCiAgICByZXR1cm4gJHA7DQp9DQoNCi8qKg0KICog6Ieq5Yqo5Yqg6L2957G75paH5Lu2Lg0KICoNCiAqIEBhcGkgRmlsdGVyX1BsdWdpbl9BdXRvbG9hZA0KICoNCiAqIEBwYXJhbSBzdHJpbmcgJGNsYXNzTmFtZSDnsbvlkI0NCiAqDQogKiBAcmV0dXJuIG1peGVkDQogKi8NCmZ1bmN0aW9uIEF1dG9sb2FkQ2xhc3MoJGNsYXNzTmFtZSkNCnsNCiAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9BdXRvbG9hZCddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAkZnByZXR1cm4gPSAkZnBuYW1lKCRjbGFzc05hbWUpOw0KICAgICAgICBpZiAoJGZwc2lnbmFsID09IFBMVUdJTl9FWElUU0lHTkFMX1JFVFVSTikgew0KICAgICAgICAgICAgJGZwc2lnbmFsID0gUExVR0lOX0VYSVRTSUdOQUxfTk9ORTsNCg0KICAgICAgICAgICAgcmV0dXJuICRmcHJldHVybjsNCiAgICAgICAgfQ0KICAgIH0NCiAgICAkY2xhc3NOYW1lID0gc3RyX3JlcGxhY2UoJ19fJywgJy8nLCAkY2xhc3NOYW1lKTsNCiAgICAkZmlsZU5hbWUgPSBaQlBfUEFUSCAuICd6Yl9zeXN0ZW0vZnVuY3Rpb24vbGliLycgLiBzdHJ0b2xvd2VyKCRjbGFzc05hbWUpIC4gJy5waHAnOw0KICAgIGlmIChpc19yZWFkYWJsZSgkZmlsZU5hbWUpKSB7DQogICAgICAgIHJlcXVpcmUgJGZpbGVOYW1lOw0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIHJldHVybiBmYWxzZTsNCn0NCg0KLyoqDQogKiDorrDlvZXml6Xlv5cuDQogKg0KICogQHBhcmFtIHN0cmluZyAkbG9nU3RyaW5nDQogKiBAcGFyYW0gYm9vbCAgICRpc0Vycm9yDQogKg0KICogQHJldHVybiBib29sDQogKi8NCmZ1bmN0aW9uIExvZ3MoJGxvZ1N0cmluZywgJGlzRXJyb3IgPSBmYWxzZSkNCnsNCiAgICBnbG9iYWwgJHpicDsNCiAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9Mb2dzJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICRmcHJldHVybiA9ICRmcG5hbWUoJGxvZ1N0cmluZywgJGlzRXJyb3IpOw0KICAgICAgICBpZiAoJGZwc2lnbmFsID09IFBMVUdJTl9FWElUU0lHTkFMX1JFVFVSTikgew0KICAgICAgICAgICAgJGZwc2lnbmFsID0gUExVR0lOX0VYSVRTSUdOQUxfTk9ORTsNCg0KICAgICAgICAgICAgcmV0dXJuICRmcHJldHVybjsNCiAgICAgICAgfQ0KICAgIH0NCiAgICBpZiAoJHpicC0+Z3VpZCkgew0KICAgICAgICBpZiAoJGlzRXJyb3IpIHsNCiAgICAgICAgICAgICRmID0gJHpicC0+dXNlcnNkaXIgLiAnbG9ncy8nIC4gJHpicC0+Z3VpZCAuICctZXJyb3InIC4gZGF0ZSgiWW1kIikgLiAnLnR4dCc7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkZiA9ICR6YnAtPnVzZXJzZGlyIC4gJ2xvZ3MvJyAuICR6YnAtPmd1aWQgLiAnLWxvZycgLiBkYXRlKCJZbWQiKSAuICcudHh0JzsNCiAgICAgICAgfQ0KICAgIH0gZWxzZSB7DQogICAgICAgIGlmICgkaXNFcnJvcikgew0KICAgICAgICAgICAgJGYgPSAkemJwLT51c2Vyc2RpciAuICdsb2dzLycgLiBtZDUoJHpicC0+cGF0aCkgLiAnLWVycm9yLnR4dCc7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkZiA9ICR6YnAtPnVzZXJzZGlyIC4gJ2xvZ3MvJyAuIG1kNSgkemJwLT5wYXRoKSAuICcudHh0JzsNCiAgICAgICAgfQ0KICAgIH0NCiAgICBaQmxvZ0V4Y2VwdGlvbjo6U3VzcGVuZEVycm9ySG9vaygpOw0KICAgIGlmICgkaGFuZGxlID0gQGZvcGVuKCRmLCAnYSsnKSkgew0KICAgICAgICAkdCA9IGRhdGUoJ1ktbS1kJykgLiAnICcgLiBkYXRlKCdIOmk6cycpIC4gJyAnIC4gc3Vic3RyKG1pY3JvdGltZSgpLCAxLCA5KSAuICcgJyAuIGRhdGUoJ1AnKTsNCiAgICAgICAgQGZ3cml0ZSgkaGFuZGxlLCAnWycgLiAkdCAuICddJyAuICJcclxuIiAuICRsb2dTdHJpbmcgLiAiXHJcbiIpOw0KICAgICAgICBAZmNsb3NlKCRoYW5kbGUpOw0KICAgIH0NCiAgICBaQmxvZ0V4Y2VwdGlvbjo6UmVzdW1lRXJyb3JIb29rKCk7DQoNCiAgICByZXR1cm4gdHJ1ZTsNCn0NCg0KLyoqDQogKiDovpPlh7rpobXpnaLov5DooYzml7bplb8NCiAqDQogKiBAcGFyYW0gYm9vbCAkaXNPdXRwdXQg5piv5ZCm6L6T5Ye677yI6ICD6JmR5Y6G5Y+y5Y6f5Zug77yM6buY6K6k6L6T5Ye677yJDQogKg0KICogQHJldHVybiBhcnJheQ0KICovDQpmdW5jdGlvbiBSdW5UaW1lKCRpc091dHB1dCA9IHRydWUpDQp7DQogICAgZ2xvYmFsICR6YnA7DQoNCiAgICAkcnQgPSBhcnJheSgpOw0KICAgICRydFsndGltZSddID0gbnVtYmVyX2Zvcm1hdCgxMDAwICogKG1pY3JvdGltZSgxKSAtICRfU0VSVkVSWydfc3RhcnRfdGltZSddKSwgMik7DQogICAgJHJ0WydxdWVyeSddID0gJF9TRVJWRVJbJ19xdWVyeV9jb3VudCddOw0KICAgICRydFsnbWVtb3J5J10gPSAkX1NFUlZFUlsnX21lbW9yeV91c2FnZSddOw0KICAgICRydFsnZXJyb3InXSA9ICRfU0VSVkVSWydfZXJyb3JfY291bnQnXTsNCiAgICBpZiAoZnVuY3Rpb25fZXhpc3RzKCdtZW1vcnlfZ2V0X3VzYWdlJykpIHsNCiAgICAgICAgJHJ0WydtZW1vcnknXSA9IChpbnQpICgobWVtb3J5X2dldF91c2FnZSgpIC0gJF9TRVJWRVJbJ19tZW1vcnlfdXNhZ2UnXSkgLyAxMDI0KTsNCiAgICB9DQoNCiAgICBpZiAoaXNzZXQoJHpicC0+b3B0aW9uWydaQ19SVU5JTkZPX0RJU1BMQVknXSkgJiYgJHpicC0+b3B0aW9uWydaQ19SVU5JTkZPX0RJU1BMQVknXSA9PSBmYWxzZSkgew0KICAgICAgICAkX1NFUlZFUlsnX3J1bnRpbWVfcmVzdWx0J10gPSAkcnQ7DQoNCiAgICAgICAgcmV0dXJuICRydDsNCiAgICB9DQoNCiAgICBpZiAoJGlzT3V0cHV0KSB7DQogICAgICAgIGVjaG8gJzwhLS0nIC4gJHJ0Wyd0aW1lJ10gLiAnIG1zICwgJzsNCiAgICAgICAgZWNobyAkcnRbJ3F1ZXJ5J10gLiAnIHF1ZXJ5JzsNCiAgICAgICAgaWYgKGZ1bmN0aW9uX2V4aXN0cygnbWVtb3J5X2dldF91c2FnZScpKSB7DQogICAgICAgICAgICBlY2hvICcgLCAnIC4gJHJ0WydtZW1vcnknXSAuICdrYiBtZW1vcnknOw0KICAgICAgICB9DQoNCiAgICAgICAgZWNobyAnICwgJyAuICRydFsnZXJyb3InXSAuICcgZXJyb3InOw0KICAgICAgICBlY2hvICctLT4nOw0KICAgIH0NCg0KICAgIHJldHVybiAkcnQ7DQp9DQoNCi8qKg0KICog6I635b6X57O757uf5L+h5oGvLg0KICoNCiAqIEByZXR1cm4gc3RyaW5nIOezu+e7n+S/oeaBrw0KICoNCiAqIEBzaW5jZSAxLjQNCiAqLw0KZnVuY3Rpb24gR2V0RW52aXJvbm1lbnQoKQ0Kew0KICAgIGdsb2JhbCAkemJwOw0KICAgICRhamF4ID0gTmV0d29yazo6Q3JlYXRlKCk7DQogICAgaWYgKCRhamF4KSB7DQogICAgICAgICRhamF4ID0gc3Vic3RyKGdldF9jbGFzcygkYWpheCksIDkpOw0KICAgIH0NCiAgICBpZiAoJGFqYXggPT0gJ2N1cmwnKSB7DQogICAgICAgIGlmIChpbmlfZ2V0KCJzYWZlX21vZGUiKSkgew0KICAgICAgICAgICAgJGFqYXggLj0gJy1zJzsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoaW5pX2dldCgib3Blbl9iYXNlZGlyIikpIHsNCiAgICAgICAgICAgICRhamF4IC49ICctbyc7DQogICAgICAgIH0NCiAgICAgICAgJGFycmF5ID0gY3VybF92ZXJzaW9uKCk7DQogICAgICAgICRhamF4IC49ICRhcnJheVsndmVyc2lvbiddOw0KICAgIH0NCiAgICBpZiAoZnVuY3Rpb25fZXhpc3RzKCdwaHBfdW5hbWUnKSA9PSB0cnVlKSB7DQogICAgICAgICR1bmFtZSA9IFNwbGl0QW5kR2V0KHBocF91bmFtZSgncicpLCAnLScsIDApOw0KICAgIH0gZWxzZSB7DQogICAgICAgICR1bmFtZSA9ICcnOw0KICAgIH0NCiAgICAkc3lzdGVtX2Vudmlyb25tZW50ID0gUEhQX09TIC4gJHVuYW1lIC4gJzsgJyAuDQogICAgR2V0VmFsdWVJbkFycmF5KA0KICAgICAgICBleHBsb2RlKA0KICAgICAgICAgICAgJyAnLA0KICAgICAgICAgICAgc3RyX3JlcGxhY2UoYXJyYXkoJ01pY3Jvc29mdC0nLCAnLycpLCBhcnJheSgnJywgJycpLCBHZXRWYXJzKCdTRVJWRVJfU09GVFdBUkUnLCAnU0VSVkVSJykpDQogICAgICAgICksDQogICAgICAgIDANCiAgICApIC4gJzsgJyAuDQogICAgJ1BIUCcgLiBHZXRQSFBWZXJzaW9uKCkgLiAoSVNfWDY0ID8gJ3g2NCcgOiAnJykgLiAnOyAnIC4NCiAgICAkemJwLT5vcHRpb25bJ1pDX0RBVEFCQVNFX1RZUEUnXSAuICR6YnAtPmRiLT52ZXJzaW9uIC4gJzsgJyAuICRhamF4Ow0KDQogICAgaWYgKGRlZmluZWQoJ09QRU5TU0xfVkVSU0lPTl9URVhUJykpIHsNCiAgICAgICAgJGEgPSBleHBsb2RlKCcgJywgT1BFTlNTTF9WRVJTSU9OX1RFWFQpOw0KICAgICAgICAkc3lzdGVtX2Vudmlyb25tZW50IC49ICc7ICcgLiBHZXRWYWx1ZUluQXJyYXkoJGEsMCkgLiBHZXRWYWx1ZUluQXJyYXkoJGEsMSk7DQogICAgfQ0KDQogICAgcmV0dXJuICRzeXN0ZW1fZW52aXJvbm1lbnQ7DQp9DQoNCi8qKg0KICog6YCa6L+H5paH5Lu26I635Y+W5bqU55SoVVJM5Zyw5Z2ADQogKg0KICogQHBhcmFtIHN0cmluZyAkZmlsZSDmlofku7blkI0NCiAqDQogKiBAcmV0dXJuIHN0cmluZyDov5Tlm55VUkzlnLDlnYANCiAqLw0KZnVuY3Rpb24gcGx1Z2luX2Rpcl91cmwoJGZpbGUpDQp7DQogICAgZ2xvYmFsICR6YnA7DQogICAgJHMxID0gJHpicC0+cGF0aDsNCiAgICAkczIgPSBzdHJfcmVwbGFjZSgnXFwnLCAnLycsIGRpcm5hbWUoJGZpbGUpIC4gJy8nKTsNCiAgICAkcyA9IHN1YnN0cigkczIsIHN0cnNwbigkczEsICRzMiwgMCkpOw0KICAgIGlmIChzdHJwb3MoJHMsICd6Yl91c2Vycy9wbHVnaW4vJykgIT09IGZhbHNlKSB7DQogICAgICAgICRzID0gc3Vic3RyKCRzLCBzdHJzcG4oJHMsICRzMyA9ICd6Yl91c2Vycy9wbHVnaW4vJywgMCkpOw0KICAgIH0gZWxzZSB7DQogICAgICAgICRzID0gc3Vic3RyKCRzLCBzdHJzcG4oJHMsICRzMyA9ICd6Yl91c2Vycy90aGVtZS8nLCAwKSk7DQogICAgfQ0KICAgICRhID0gZXhwbG9kZSgnLycsICRzKTsNCiAgICAkcyA9ICRhWzBdOw0KICAgICRzID0gJHpicC0+aG9zdCAuICRzMyAuICRzIC4gJy8nOw0KDQogICAgcmV0dXJuICRzOw0KfQ0KDQovKioNCiAqIOmAmui/h+aWh+S7tuiOt+WPluW6lOeUqOebruW9lei3r+W+hC4NCiAqDQogKiBAcGFyYW0gJGZpbGUNCiAqDQogKiBAcmV0dXJuIHN0cmluZw0KICovDQpmdW5jdGlvbiBwbHVnaW5fZGlyX3BhdGgoJGZpbGUpDQp7DQogICAgZ2xvYmFsICR6YnA7DQogICAgJHMxID0gJHpicC0+cGF0aDsNCiAgICAkczIgPSBzdHJfcmVwbGFjZSgnXFwnLCAnLycsIGRpcm5hbWUoJGZpbGUpIC4gJy8nKTsNCiAgICAkcyA9IHN1YnN0cigkczIsIHN0cnNwbigkczEsICRzMiwgMCkpOw0KICAgIGlmIChzdHJwb3MoJHMsICd6Yl91c2Vycy9wbHVnaW4vJykgIT09IGZhbHNlKSB7DQogICAgICAgICRzID0gc3Vic3RyKCRzLCBzdHJzcG4oJHMsICRzMyA9ICd6Yl91c2Vycy9wbHVnaW4vJywgMCkpOw0KICAgIH0gZWxzZSB7DQogICAgICAgICRzID0gc3Vic3RyKCRzLCBzdHJzcG4oJHMsICRzMyA9ICd6Yl91c2Vycy90aGVtZS8nLCAwKSk7DQogICAgfQ0KICAgICRhID0gZXhwbG9kZSgnLycsICRzKTsNCiAgICAkcyA9ICRhWzBdOw0KICAgICRzID0gJHpicC0+cGF0aCAuICRzMyAuICRzIC4gJy8nOw0KDQogICAgcmV0dXJuICRzOw0KfQ0KDQovKioNCiAqIOmAmui/h0tleeS7juaVsOe7hOiOt+WPluaVsOaNri4NCiAqDQogKiBAcGFyYW0gYXJyYXkgICRhcnJheSDmlbDnu4TlkI0NCiAqIEBwYXJhbSBzdHJpbmcgJG5hbWUgIOS4i+agh2tleQ0KICoNCiAqIEByZXR1cm4gbWl4ZWQNCiAqLw0KZnVuY3Rpb24gR2V0VmFsdWVJbkFycmF5KCRhcnJheSwgJG5hbWUpDQp7DQogICAgaWYgKGlzX2FycmF5KCRhcnJheSkpIHsNCiAgICAgICAgaWYgKGFycmF5X2tleV9leGlzdHMoJG5hbWUsICRhcnJheSkpIHsNCiAgICAgICAgICAgIHJldHVybiAkYXJyYXlbJG5hbWVdOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQovKioNCiAqIOiOt+WPluaVsOe7hOS4reeahOW9k+WJjeWFg+e0oOaVsOaNri4NCiAqDQogKiBAcGFyYW0gc3RyaW5nICRhcnJheSDmlbDnu4TlkI0NCiAqIEBwYXJhbSBzdHJpbmcgJG5hbWUgIOS4i+agh2tleQ0KICoNCiAqIEByZXR1cm4gbWl4ZWQNCiAqLw0KZnVuY3Rpb24gR2V0VmFsdWVJbkFycmF5QnlDdXJyZW50KCRhcnJheSwgJG5hbWUpDQp7DQogICAgaWYgKGlzX2FycmF5KCRhcnJheSkpIHsNCiAgICAgICAgJGFycmF5ID0gY3VycmVudCgkYXJyYXkpOw0KDQogICAgICAgIHJldHVybiBHZXRWYWx1ZUluQXJyYXkoJGFycmF5LCAkbmFtZSk7DQogICAgfQ0KfQ0KDQovKioNCiAqIOWIhuWJsnN0cmluZ+W5tuWPluafkOmhueaVsOaNri4NCiAqDQogKiBAcGFyYW0gc3RyaW5nICRzdHJpbmcNCiAqIEBwYXJhbSBzdHJpbmcgJGRlbGltaXRlcg0KICogQHBhcmFtIGludCAgICAkbg0KICoNCiAqIEByZXR1cm4gc3RyaW5nDQogKi8NCmZ1bmN0aW9uIFNwbGl0QW5kR2V0KCRzdHJpbmcsICRkZWxpbWl0ZXIgPSAnOycsICRuID0gMCkNCnsNCiAgICAkYSA9IGV4cGxvZGUoJGRlbGltaXRlciwgJHN0cmluZyk7DQogICAgaWYgKCFpc19hcnJheSgkYSkpIHsNCiAgICAgICAgJGEgPSBhcnJheSgpOw0KICAgIH0NCiAgICBpZiAoaXNzZXQoJGFbJG5dKSkgew0KICAgICAgICByZXR1cm4gKHN0cmluZykgJGFbJG5dOw0KICAgIH0NCg0KICAgIHJldHVybiAnJzsNCn0NCg0KLyoqDQogKiDliKDpmaTov57nu63nqbrmoLwNCiAqDQogKiBAcGFyYW0gJHMNCiAqDQogKiBAcmV0dXJuIG51bGx8c3RyaW5nfHN0cmluZ1tdDQogKi8NCmZ1bmN0aW9uIFJlbW92ZU1vcmVTcGFjZXMoJHMpDQp7DQogICAgcmV0dXJuIHByZWdfcmVwbGFjZSgiL1xzKD89XHMpLyIsICJcXDEiLCAkcyk7DQp9DQoNCi8qKg0KICog6I635Y+WR3VpZC4NCiAqDQogKiBAcmV0dXJuIHN0cmluZw0KICovDQpmdW5jdGlvbiBHZXRHdWlkKCkNCnsNCiAgICAkY2hhcmlkID0gc3RydG9sb3dlcihtZDUodW5pcWlkKG10X3JhbmQoKSwgdHJ1ZSkpKTsNCg0KICAgIHJldHVybiAkY2hhcmlkOw0KfQ0KDQovKioNCiAqIOiOt+WPluWPguaVsOWAvA0KICoNCiAqIEBwYXJhbSBzdHJpbmcgJG5hbWUg5pWw57uEa2V55ZCNDQogKiBAcGFyYW0gc3RyaW5nICR0eXBlIOm7mOiupOS4ulJFUVVFU1QNCiAqDQogKiBAcmV0dXJuIG1peGVkfG51bGwNCiAqLw0KZnVuY3Rpb24gR2V0VmFycygkbmFtZSwgJHR5cGUgPSAnUkVRVUVTVCcpDQp7DQogICAgJGFycmF5ID0gJiRHTE9CQUxTW3N0cnRvdXBwZXIoIl8kdHlwZSIpXTsNCg0KICAgIGlmIChpc3NldCgkYXJyYXlbJG5hbWVdKSkgew0KICAgICAgICByZXR1cm4gJGFycmF5WyRuYW1lXTsNCiAgICB9IGVsc2Ugew0KICAgICAgICByZXR1cm4gbnVsbDsNCiAgICB9DQp9DQoNCi8qKg0KICog6I635Y+W5Y+C5pWw5YC877yI5Y+v6K6+572u6buY6K6k6L+U5Zue5YC877yJLg0KICoNCiAqIEBwYXJhbSBzdHJpbmcgJG5hbWUgICAg5pWw57uEa2V55ZCNDQogKiBAcGFyYW0gc3RyaW5nICR0eXBlICAgIOm7mOiupOS4ulJFUVVFU1QNCiAqIEBwYXJhbSBzdHJpbmcgJGRlZmF1bHQg6buY6K6k5Li6bnVsbA0KICoNCiAqIEByZXR1cm4gbWl4ZWR8bnVsbA0KICoNCiAqIEBzaW5jZSAxLjMuMTQwNjE0DQogKi8NCmZ1bmN0aW9uIEdldFZhcnNCeURlZmF1bHQoJG5hbWUsICR0eXBlID0gJ1JFUVVFU1QnLCAkZGVmYXVsdCA9IG51bGwpDQp7DQogICAgJGcgPSBHZXRWYXJzKCRuYW1lLCAkdHlwZSk7DQogICAgaWYgKCRnID09IG51bGwgfHwgJGcgPT0gJycpIHsNCiAgICAgICAgcmV0dXJuICRkZWZhdWx0Ow0KICAgIH0NCg0KICAgIHJldHVybiAkZzsNCn0NCg0KLyoqDQogKiDojrflj5bmlbDmja7lupPlkI0uDQogKg0KICogQHJldHVybiBzdHJpbmcg6L+U5Zue5LiA5Liq6ZqP5py655qEU1FMaXRl5pWw5o2u5paH5Lu25ZCNDQogKi8NCmZ1bmN0aW9uIEdldERiTmFtZSgpDQp7DQogICAgcmV0dXJuIHN0cl9yZXBsYWNlKCctJywgJycsICcjJTIwJyAuIHN0cnRvbG93ZXIoR2V0R3VpZCgpKSkgLiAnLmRiJzsNCn0NCg0KLyoqDQogKiDojrflj5blvZPliY3nvZHnq5nlnLDlnYANCiAqDQogKiBAcGFyYW0gc3RyaW5nICRibG9ncGF0aCAgICAg572R56uZ5Z+f5ZCNDQogKiBAcGFyYW0gc3RyaW5nICYkY29va2llc1BhdGgg6L+U5ZueY29va2ll5L2c55So5Z+f5YC877yM6KaB5Lyg5byV5YWlDQogKg0KICogQHJldHVybiBzdHJpbmcg6L+U5Zue572R56uZ5a6M5pW05Zyw5Z2A77yM5aaCaHR0cDovL2xvY2FsaG9zdC96YnAvDQogKi8NCmZ1bmN0aW9uIEdldEN1cnJlbnRIb3N0KCRibG9ncGF0aCwgJiRjb29raWVzUGF0aCkNCnsNCiAgICAkaG9zdCA9IEhUVFBfU0NIRU1FOw0KDQogICAgJGhvc3QgLj0gJF9TRVJWRVJbJ0hUVFBfSE9TVCddOw0KDQogICAgaWYgKGlzc2V0KCRfU0VSVkVSWydTQ1JJUFRfTkFNRSddKSAmJiAkX1NFUlZFUlsnU0NSSVBUX05BTUUnXSkgew0KICAgICAgICAkeCA9ICRfU0VSVkVSWydTQ1JJUFRfTkFNRSddOw0KICAgICAgICAkeSA9ICRibG9ncGF0aDsNCiAgICAgICAgZm9yICgkaSA9IDA7ICRpIDwgc3RybGVuKCR4KTsgJGkrKykgew0KICAgICAgICAgICAgJGYgPSAkeSAuIHN1YnN0cigkeCwgJGkgLSBzdHJsZW4oJHgpKTsNCiAgICAgICAgICAgICR6ID0gc3Vic3RyKCR4LCAwLCAkaSk7DQogICAgICAgICAgICBpZiAoZmlsZV9leGlzdHMoJGYpICYmIGlzX2ZpbGUoJGYpKSB7DQogICAgICAgICAgICAgICAgJHogPSB0cmltKCR6LCAnLycpOw0KICAgICAgICAgICAgICAgICR6ID0gJy8nIC4gJHogLiAnLyc7DQogICAgICAgICAgICAgICAgJHogPSBzdHJfcmVwbGFjZSgnLy8nLCAnLycsICR6KTsNCiAgICAgICAgICAgICAgICAkY29va2llc1BhdGggPSAkejsNCg0KICAgICAgICAgICAgICAgIHJldHVybiAkaG9zdCAuICR6Ow0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgJHggPSAkX1NFUlZFUlsnU0NSSVBUX05BTUUnXTsNCiAgICAkeSA9ICRibG9ncGF0aDsNCiAgICBpZiAoaXNzZXQoJF9TRVJWRVJbIkNPTlRFWFRfRE9DVU1FTlRfUk9PVCJdKSAmJiBpc3NldCgkX1NFUlZFUlsiQ09OVEVYVF9QUkVGSVgiXSkpIHsNCiAgICAgICAgaWYgKCRfU0VSVkVSWyJDT05URVhUX0RPQ1VNRU5UX1JPT1QiXSAmJiAkX1NFUlZFUlsiQ09OVEVYVF9QUkVGSVgiXSkgew0KICAgICAgICAgICAgJHkgPSAkX1NFUlZFUlsiQ09OVEVYVF9ET0NVTUVOVF9ST09UIl0gLiAkX1NFUlZFUlsiQ09OVEVYVF9QUkVGSVgiXSAuICcvJzsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgICR6ID0gJyc7DQoNCiAgICBmb3IgKCRpID0gc3RybGVuKCR4KTsgJGkgPiAwOyAkaS0tKSB7DQogICAgICAgICR6ID0gc3Vic3RyKCR4LCAwLCAkaSk7DQogICAgICAgIGlmIChzdHJ0b2xvd2VyKHN1YnN0cigkeSwgc3RybGVuKCR5KSAtICRpKSkgPT0gc3RydG9sb3dlcigkeikpIHsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgJGNvb2tpZXNQYXRoID0gJHo7DQoNCiAgICByZXR1cm4gJGhvc3QgLiAkejsNCn0NCg0KLyoqDQogKiDpgJrov4dVUkzojrflj5bov5znqIvpobXpnaLlhoXlrrkuDQogKg0KICogQHBhcmFtIHN0cmluZyAkdXJsIFVSTOWcsOWdgA0KICoNCiAqIEByZXR1cm4gc3RyaW5nIOi/lOWbnumhtemdouaWh+acrOWGheWuue+8jOm7mOiupOS4um51bGwNCiAqLw0KZnVuY3Rpb24gR2V0SHR0cENvbnRlbnQoJHVybCkNCnsNCiAgICAkYWpheCA9IE5ldHdvcms6OkNyZWF0ZSgpOw0KICAgIGlmICghJGFqYXgpIHsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgICRhamF4LT5vcGVuKCdHRVQnLCAkdXJsKTsNCiAgICAkYWpheC0+ZW5hYmxlR3ppcCgpOw0KICAgICRhamF4LT5zZXRUaW1lT3V0cyg2MCwgNjAsIDAsIDApOw0KICAgICRhamF4LT5zZW5kKCk7DQoNCiAgICByZXR1cm4gKCRhamF4LT5zdGF0dXMgPT0gMjAwKSA/ICRhamF4LT5yZXNwb25zZVRleHQgOiBudWxsOw0KfQ0KDQovKioNCiAqIOiOt+WPluebruW9leS4i+aWh+S7tuWkueWIl+ihqC4NCiAqDQogKiBAcGFyYW0gc3RyaW5nICRkaXIg55uu5b2VDQogKg0KICogQHJldHVybiBhcnJheSDmlofku7blpLnliJfooagNCiAqLw0KZnVuY3Rpb24gR2V0RGlyc0luRGlyKCRkaXIpDQp7DQogICAgJGRpcnMgPSBhcnJheSgpOw0KDQogICAgaWYgKCFmaWxlX2V4aXN0cygkZGlyKSkgew0KICAgICAgICByZXR1cm4gYXJyYXkoKTsNCiAgICB9DQogICAgaWYgKCFpc19kaXIoJGRpcikpIHsNCiAgICAgICAgcmV0dXJuIGFycmF5KCk7DQogICAgfQ0KICAgICRkaXIgPSBzdHJfcmVwbGFjZSgnXFwnLCAnLycsICRkaXIpOw0KICAgIGlmIChzdWJzdHIoJGRpciwgLTEpICE9PSAnLycpIHsNCiAgICAgICAgJGRpciAuPSAnLyc7DQogICAgfQ0KDQogICAgLy9zY2FuDQogICAgaWYgKGZ1bmN0aW9uX2V4aXN0cygnc2NhbmRpcicpKSB7DQogICAgICAgIGZvcmVhY2ggKHNjYW5kaXIoJGRpciwgMCkgYXMgJGQpIHsNCiAgICAgICAgICAgIGlmIChpc19kaXIoJGRpciAuICRkKSkgew0KICAgICAgICAgICAgICAgIGlmICgoJGQgIT0gJy4nKSAmJiAoJGQgIT0gJy4uJykpIHsNCiAgICAgICAgICAgICAgICAgICAgJGRpcnNbXSA9ICRkOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0gZWxzZSB7DQogICAgICAgIGlmICgkaGFuZGxlID0gb3BlbmRpcigkZGlyKSkgew0KICAgICAgICAgICAgd2hpbGUgKGZhbHNlICE9PSAoJGZpbGUgPSByZWFkZGlyKCRoYW5kbGUpKSkgew0KICAgICAgICAgICAgICAgIGlmICgkZmlsZSAhPSAiLiIgJiYgJGZpbGUgIT0gIi4uIikgew0KICAgICAgICAgICAgICAgICAgICBpZiAoaXNfZGlyKCRkaXIgLiAkZmlsZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICRkaXJzW10gPSAkZmlsZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGNsb3NlZGlyKCRoYW5kbGUpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgcmV0dXJuICRkaXJzOw0KfQ0KDQovKioNCiAqIOiOt+WPluebruW9leS4i+aMh+Wumuexu+Wei+aWh+S7tuWIl+ihqC4NCiAqDQogKiBAcGFyYW0gc3RyaW5nICRkaXIgIOebruW9lQ0KICogQHBhcmFtIHN0cmluZyAkdHlwZSDmlofku7bnsbvlnovvvIzku6XvvZzliIbpmpQNCiAqDQogKiBAcmV0dXJuIGFycmF5IOaWh+S7tuWIl+ihqA0KICovDQpmdW5jdGlvbiBHZXRGaWxlc0luRGlyKCRkaXIsICR0eXBlKQ0Kew0KICAgICRmaWxlcyA9IGFycmF5KCk7DQogICAgJGRpciA9IHN0cl9yZXBsYWNlKCdcXCcsICcvJywgJGRpcik7DQogICAgaWYgKHN1YnN0cigkZGlyLCAtMSkgIT09ICcvJykgew0KICAgICAgICAkZGlyIC49ICcvJzsNCiAgICB9DQogICAgaWYgKCFpc19kaXIoJGRpcikpIHsNCiAgICAgICAgcmV0dXJuIGFycmF5KCk7DQogICAgfQ0KDQogICAgaWYgKGZ1bmN0aW9uX2V4aXN0cygnc2NhbmRpcicpKSB7DQogICAgICAgIGZvcmVhY2ggKHNjYW5kaXIoJGRpcikgYXMgJGYpIHsNCiAgICAgICAgICAgIGlmICgkZiAhPSAiLiIgJiYgJGYgIT0gIi4uIiAmJiBpc19maWxlKCRkaXIgLiAkZikpIHsNCiAgICAgICAgICAgICAgICBmb3JlYWNoIChleHBsb2RlKCJ8IiwgJHR5cGUpIGFzICR0KSB7DQogICAgICAgICAgICAgICAgICAgICR0ID0gJy4nIC4gJHQ7DQogICAgICAgICAgICAgICAgICAgICRpID0gc3RybGVuKCR0KTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKHN1YnN0cigkZiwgLSRpLCAkaSkgPT0gJHQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICRzb3J0bmFtZSA9IHN1YnN0cigkZiwgMCwgKHN0cmxlbigkZikgLSAkaSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgJGZpbGVzWyRzb3J0bmFtZV0gPSAkZGlyIC4gJGY7DQogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0gZWxzZSB7DQogICAgICAgICRoYW5kbGUgPSBvcGVuZGlyKCRkaXIpOw0KICAgICAgICBpZiAoJGhhbmRsZSkgew0KICAgICAgICAgICAgd2hpbGUgKGZhbHNlICE9PSAoJGZpbGUgPSByZWFkZGlyKCRoYW5kbGUpKSkgew0KICAgICAgICAgICAgICAgIGlmICgkZmlsZSAhPSAiLiIgJiYgJGZpbGUgIT0gIi4uIikgew0KICAgICAgICAgICAgICAgICAgICBpZiAoaXNfZmlsZSgkZGlyIC4gJGZpbGUpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3JlYWNoIChleHBsb2RlKCJ8IiwgJHR5cGUpIGFzICR0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHQgPSAnLicgLiAkdDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkaSA9IHN0cmxlbigkdCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1YnN0cigkZmlsZSwgLSRpLCAkaSkgPT0gJHQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNvcnRuYW1lID0gc3Vic3RyKCRmaWxlLCAwLCAoc3RybGVuKCRmaWxlKSAtICRpKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRmaWxlc1skc29ydG5hbWVdID0gJGRpciAuICRmaWxlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBjbG9zZWRpcigkaGFuZGxlKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHJldHVybiAkZmlsZXM7DQp9DQoNCi8qKg0KICog6K6+572uaHR0cOeKtuaAgeWktC4NCiAqDQogKiBAcGFyYW0gaW50ICRudW1iZXIgSHR0cFN0YXR1cw0KICoNCiAqIEBpbnRlcm5hbCBwYXJhbSBzdHJpbmcgJHN0YXR1cyDmiJDlip/ojrflj5bnirbmgIHnoIHorr7nva7pnZnmgIHlj4LmlbBzdGF0dXMNCiAqDQogKiBAcmV0dXJuIGJvb2wNCiAqLw0KZnVuY3Rpb24gU2V0SHR0cFN0YXR1c0NvZGUoJG51bWJlciwgJGZvcmNlID0gZmFsc2UpDQp7DQogICAgc3RhdGljICRzdGF0dXMgPSAnJzsNCiAgICBpZiAoJHN0YXR1cyAhPSAnJyAmJiAkZm9yY2UgPT0gZmFsc2UpIHsNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCg0KICAgICRjb2RlcyA9IGFycmF5KA0KICAgICAgICAvLyBJbmZvcm1hdGlvbmFsIDF4eA0KICAgICAgICAxMDAgPT4gJ0NvbnRpbnVlJywNCiAgICAgICAgMTAxID0+ICdTd2l0Y2hpbmcgUHJvdG9jb2xzJywNCiAgICAgICAgMTAyID0+ICdQcm9jZXNzaW5nJywNCg0KICAgICAgICAvLyBTdWNjZXNzIDJ4eA0KICAgICAgICAyMDAgPT4gJ09LJywNCiAgICAgICAgMjAxID0+ICdDcmVhdGVkJywNCiAgICAgICAgMjAyID0+ICdBY2NlcHRlZCcsDQogICAgICAgIDIwMyA9PiAnTm9uLUF1dGhvcml0YXRpdmUgSW5mb3JtYXRpb24nLA0KICAgICAgICAyMDQgPT4gJ05vIENvbnRlbnQnLA0KICAgICAgICAyMDUgPT4gJ1Jlc2V0IENvbnRlbnQnLA0KICAgICAgICAyMDYgPT4gJ1BhcnRpYWwgQ29udGVudCcsDQogICAgICAgIDIwNyA9PiAnTXVsdGktU3RhdHVzJywNCg0KICAgICAgICAvLyBSZWRpcmVjdGlvbiAzeHgNCiAgICAgICAgMzAwID0+ICdNdWx0aXBsZSBDaG9pY2VzJywNCiAgICAgICAgMzAxID0+ICdNb3ZlZCBQZXJtYW5lbnRseScsDQogICAgICAgIDMwMiA9PiAnRm91bmQnLCAvLyAxLjENCiAgICAgICAgMzAzID0+ICdTZWUgT3RoZXInLA0KICAgICAgICAzMDQgPT4gJ05vdCBNb2RpZmllZCcsDQogICAgICAgIDMwNSA9PiAnVXNlIFByb3h5JywNCiAgICAgICAgMzA2ID0+ICdTd2l0Y2ggUHJveHknLA0KICAgICAgICAzMDcgPT4gJ1RlbXBvcmFyeSBSZWRpcmVjdCcsDQoNCiAgICAgICAgLy8gQ2xpZW50IEVycm9yIDR4eA0KICAgICAgICA0MDAgPT4gJ0JhZCBSZXF1ZXN0JywNCiAgICAgICAgNDAxID0+ICdVbmF1dGhvcml6ZWQnLA0KICAgICAgICA0MDIgPT4gJ1BheW1lbnQgUmVxdWlyZWQnLA0KICAgICAgICA0MDMgPT4gJ0ZvcmJpZGRlbicsDQogICAgICAgIDQwNCA9PiAnTm90IEZvdW5kJywNCiAgICAgICAgNDA1ID0+ICdNZXRob2QgTm90IEFsbG93ZWQnLA0KICAgICAgICA0MDYgPT4gJ05vdCBBY2NlcHRhYmxlJywNCiAgICAgICAgNDA3ID0+ICdQcm94eSBBdXRoZW50aWNhdGlvbiBSZXF1aXJlZCcsDQogICAgICAgIDQwOCA9PiAnUmVxdWVzdCBUaW1lb3V0JywNCiAgICAgICAgNDA5ID0+ICdDb25mbGljdCcsDQogICAgICAgIDQxMCA9PiAnR29uZScsDQogICAgICAgIDQxMSA9PiAnTGVuZ3RoIFJlcXVpcmVkJywNCiAgICAgICAgNDEyID0+ICdQcmVjb25kaXRpb24gRmFpbGVkJywNCiAgICAgICAgNDEzID0+ICdSZXF1ZXN0IEVudGl0eSBUb28gTGFyZ2UnLA0KICAgICAgICA0MTQgPT4gJ1JlcXVlc3QtVVJJIFRvbyBMb25nJywNCiAgICAgICAgNDE1ID0+ICdVbnN1cHBvcnRlZCBNZWRpYSBUeXBlJywNCiAgICAgICAgNDE2ID0+ICdSZXF1ZXN0ZWQgUmFuZ2UgTm90IFNhdGlzZmlhYmxlJywNCiAgICAgICAgNDE3ID0+ICdFeHBlY3RhdGlvbiBGYWlsZWQnLA0KICAgICAgICA0NTEgPT4gJ1VuYXZhaWxhYmxlIEZvciBMZWdhbCBSZWFzb25zJywNCg0KICAgICAgICAvLyBTZXJ2ZXIgRXJyb3IgNXh4DQogICAgICAgIDUwMCA9PiAnSW50ZXJuYWwgU2VydmVyIEVycm9yJywNCiAgICAgICAgNTAxID0+ICdOb3QgSW1wbGVtZW50ZWQnLA0KICAgICAgICA1MDIgPT4gJ0JhZCBHYXRld2F5JywNCiAgICAgICAgNTAzID0+ICdTZXJ2aWNlIFVuYXZhaWxhYmxlJywNCiAgICAgICAgNTA0ID0+ICdHYXRld2F5IFRpbWVvdXQnLA0KICAgICAgICA1MDUgPT4gJ0hUVFAgVmVyc2lvbiBOb3QgU3VwcG9ydGVkJywNCiAgICAgICAgNTA2ID0+ICdWYXJpYW50IEFsc28gTmVnb3RpYXRlcycsDQogICAgICAgIDUwNyA9PiAnSW5zdWZmaWNpZW50IFN0b3JhZ2UnLA0KICAgICAgICA1MDggPT4gJ0xvb3AgRGV0ZWN0ZWQnLA0KICAgICAgICA1MDkgPT4gJ0JhbmR3aWR0aCBMaW1pdCBFeGNlZWRlZCcsDQogICAgICAgIDUxMCA9PiAnTm90IEV4dGVuZGVkJywNCiAgICApOw0KDQogICAgaWYgKGlzc2V0KCRjb2Rlc1skbnVtYmVyXSkpIHsNCiAgICAgICAgaGVhZGVyKCdIVFRQLzEuMSAnIC4gJG51bWJlciAuICcgJyAuICRjb2Rlc1skbnVtYmVyXSk7DQogICAgICAgICRzdGF0dXMgPSAkbnVtYmVyOw0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIHJldHVybiBmYWxzZTsNCn0NCg0KLyoqDQogKiDnlKhzY3JpcHTmoIfnrb7ov5vooYzot7PovawuDQogKg0KICogQHBhcmFtIHN0cmluZyAkdXJsIOi3s+i9rOmTvuaOpQ0KICovDQpmdW5jdGlvbiBSZWRpcmVjdEJ5U2NyaXB0KCR1cmwpDQp7DQogICAgZWNobyAnPHNjcmlwdD5sb2NhdGlvbi5ocmVmID0gZGVjb2RlVVJJQ29tcG9uZW50KCInIC4gdXJsZW5jb2RlKCR1cmwpIC4gJyIpOzwvc2NyaXB0Pic7DQogICAgZGllKCk7DQp9DQovKioNCiAqIDMwMui3s+i9rC4NCiAqDQogKiBAcGFyYW0gc3RyaW5nICR1cmwg6Lez6L2s6ZO+5o6lDQogKi8NCmZ1bmN0aW9uIFJlZGlyZWN0KCR1cmwpDQp7DQogICAgU2V0SHR0cFN0YXR1c0NvZGUoMzAyKTsNCiAgICBoZWFkZXIoJ0xvY2F0aW9uOiAnIC4gJHVybCk7DQogICAgZGllKCk7DQp9DQoNCi8qKg0KICogMzAx6Lez6L2sLg0KICoNCiAqIEBwYXJhbSBzdHJpbmcgJHVybCDot7Povazpk77mjqUNCiAqLw0KZnVuY3Rpb24gUmVkaXJlY3QzMDEoJHVybCkNCnsNCiAgICBTZXRIdHRwU3RhdHVzQ29kZSgzMDEpOw0KICAgIGhlYWRlcignTG9jYXRpb246ICcgLiAkdXJsKTsNCiAgICBkaWUoKTsNCn0NCi8qKg0KICogQGlnbm9yZQ0KICovDQpmdW5jdGlvbiBIdHRwNDA0KCkNCnsNCiAgICBTZXRIdHRwU3RhdHVzQ29kZSg0MDQpOw0KICAgIGhlYWRlcigiU3RhdHVzOiA0MDQgTm90IEZvdW5kIik7DQp9DQovKioNCiAqIEBpZ25vcmUNCiAqLw0KZnVuY3Rpb24gSHR0cDUwMCgpDQp7DQogICAgU2V0SHR0cFN0YXR1c0NvZGUoNTAwKTsNCn0NCi8qKg0KICogQGlnbm9yZQ0KICovDQpmdW5jdGlvbiBIdHRwNTAzKCkNCnsNCiAgICBTZXRIdHRwU3RhdHVzQ29kZSg1MDMpOw0KfQ0KDQovKioNCiAqIOiuvue9rjMwNOe8k+WtmOWktC4NCiAqDQogKiBAcGFyYW0gc3RyaW5nICRmaWxlbmFtZSDmlofku7blkI0NCiAqIEBwYXJhbSBzdHJpbmcgJHRpbWUgICAgIOe8k+WtmOaXtumXtA0KICovDQpmdW5jdGlvbiBIdHRwMzA0KCRmaWxlbmFtZSwgJHRpbWUpDQp7DQogICAgJHVybCA9ICRmaWxlbmFtZTsNCiAgICAkbWQ1ID0gbWQ1KCR1cmwgLiAkdGltZSk7DQogICAgJGV0YWcgPSAnIicgLiAkbWQ1IC4gJyInOw0KICAgIGhlYWRlcignTGFzdC1Nb2RpZmllZDogJyAuIGdtZGF0ZSgnRCwgZCBNIFkgSDppOnMnLCAkdGltZSkgLiAnIEdNVCcpOw0KICAgIGhlYWRlcigiRVRhZzogJGV0YWciKTsNCiAgICBpZiAoKGlzc2V0KCRfU0VSVkVSWydIVFRQX0lGX05PTkVfTUFUQ0gnXSkgJiYgJF9TRVJWRVJbJ0hUVFBfSUZfTk9ORV9NQVRDSCddID09ICRldGFnKSkgew0KICAgICAgICBTZXRIdHRwU3RhdHVzQ29kZSgzMDQpOw0KICAgICAgICBkaWUoKTsNCiAgICB9DQp9DQoNCi8qKg0KICog6I635Y+W5a6i5oi356uvSVAuDQogKg0KICogQHJldHVybiBzdHJpbmcg6L+U5ZueSVDlnLDlnYANCiAqLw0KZnVuY3Rpb24gR2V0R3Vlc3RJUCgpDQp7DQogICAgZ2xvYmFsICR6YnA7DQogICAgaWYgKGlzc2V0KCR6YnAtPm9wdGlvblsnWkNfVVNJTkdfQ0ROX0dVRVNUSVBfVFlQRSddKSAmJiAkemJwLT5vcHRpb25bJ1pDX1VTSU5HX0NETl9HVUVTVElQX1RZUEUnXSAhPSAnJykgew0KICAgICAgICAkdXNlcl9pcCA9IEdldFZhcnMoJHpicC0+b3B0aW9uWydaQ19VU0lOR19DRE5fR1VFU1RJUF9UWVBFJ10sICJTRVJWRVIiKTsNCiAgICB9IGVsc2Ugew0KICAgICAgICAkdXNlcl9pcCA9IEdldFZhcnMoIlJFTU9URV9BRERSIiwgIlNFUlZFUiIpOw0KICAgIH0NCg0KICAgIHJldHVybiAkdXNlcl9pcDsNCn0NCg0KLyoqDQogKiDojrflj5blrqLmiLfnq69BZ2VudC4NCiAqDQogKiBAcmV0dXJuIHN0cmluZyDov5Tlm55BZ2VudA0KICovDQpmdW5jdGlvbiBHZXRHdWVzdEFnZW50KCkNCnsNCiAgICByZXR1cm4gR2V0VmFycygiSFRUUF9VU0VSX0FHRU5UIiwgIlNFUlZFUiIpOw0KfQ0KDQovKioNCiAqIOiOt+WPluivt+axguadpea6kFVSTC4NCiAqDQogKiBAcmV0dXJuIHN0cmluZyDov5Tlm55VUkwNCiAqLw0KZnVuY3Rpb24gR2V0UmVxdWVzdFVyaSgpDQp7DQogICAgaWYgKGlzc2V0KCRfU0VSVkVSWydIVFRQX1hfT1JJR0lOQUxfVVJMJ10pKSB7DQogICAgICAgICR1cmwgPSAkX1NFUlZFUlsnSFRUUF9YX09SSUdJTkFMX1VSTCddOw0KICAgIH0gZWxzZWlmIChpc3NldCgkX1NFUlZFUlsnSFRUUF9YX1JFV1JJVEVfVVJMJ10pKSB7DQogICAgICAgICR1cmwgPSAkX1NFUlZFUlsnSFRUUF9YX1JFV1JJVEVfVVJMJ107DQogICAgICAgIGlmIChzdHJwb3MoJHVybCwgJz8nKSAhPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICRxdWVyaWVzID0gR2V0VmFsdWVJbkFycmF5KGV4cGxvZGUoJz8nLCAkdXJsKSwgJzEnKTsNCiAgICAgICAgICAgIGZvcmVhY2ggKGV4cGxvZGUoJyYnLCAkcXVlcmllcykgYXMgJHF1ZXJ5KSB7DQogICAgICAgICAgICAgICAgJG5hbWUgPSBHZXRWYWx1ZUluQXJyYXkoZXhwbG9kZSgnPScsICRxdWVyeSksICcwJyk7DQogICAgICAgICAgICAgICAgJHZhbHVlID0gR2V0VmFsdWVJbkFycmF5KGV4cGxvZGUoJz0nLCAkcXVlcnkpLCAnMScpOw0KICAgICAgICAgICAgICAgICRuYW1lID0gdXJsZGVjb2RlKCRuYW1lKTsNCiAgICAgICAgICAgICAgICAkdmFsdWUgPSB1cmxkZWNvZGUoJHZhbHVlKTsNCiAgICAgICAgICAgICAgICBpZiAoIWlzc2V0KCRfR0VUWyRuYW1lXSkpIHsNCiAgICAgICAgICAgICAgICAgICAgJF9HRVRbJG5hbWVdID0gJHZhbHVlOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGlmICghaXNzZXQoJF9HRVRbJG5hbWVdKSkgew0KICAgICAgICAgICAgICAgICAgICAkX1JFUVVFU1RbJG5hbWVdID0gJHZhbHVlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0gZWxzZWlmIChpc3NldCgkX1NFUlZFUlsnUkVRVUVTVF9VUkknXSkpIHsNCiAgICAgICAgJHVybCA9ICRfU0VSVkVSWydSRVFVRVNUX1VSSSddOw0KICAgIH0gZWxzZWlmIChpc3NldCgkX1NFUlZFUlsnUkVESVJFQ1RfVVJMJ10pKSB7DQogICAgICAgICR1cmwgPSAkX1NFUlZFUlsnUkVESVJFQ1RfVVJMJ107DQogICAgICAgIGlmIChpc3NldCgkX1NFUlZFUlsnUkVESVJFQ1RfUVVFUllfU1RSSU4nXSkpIHsNCiAgICAgICAgICAgICR1cmwgLj0gJz8nIC4gJF9TRVJWRVJbJ1JFRElSRUNUX1FVRVJZX1NUUklOJ107DQogICAgICAgIH0NCiAgICB9IGVsc2Ugew0KICAgICAgICAkdXJsID0gJF9TRVJWRVJbJ1BIUF9TRUxGJ10gLiAoJF9TRVJWRVJbJ1FVRVJZX1NUUklORyddID8gJz8nIC4gJF9TRVJWRVJbJ1FVRVJZX1NUUklORyddIDogJycpOw0KICAgIH0NCg0KICAgIHJldHVybiAkdXJsOw0KfQ0KDQovKioNCiAqIOiOt+WPluaWh+S7tuWQjue8gOWQjS4NCiAqDQogKiBAcGFyYW0gc3RyaW5nICRmIOaWh+S7tuWQjQ0KICoNCiAqIEByZXR1cm4gc3RyaW5nIOi/lOWbnuWwj+WGmeeahOWQjue8gOWQjQ0KICovDQpmdW5jdGlvbiBHZXRGaWxlRXh0KCRmKQ0Kew0KICAgIGlmIChzdHJwb3MoJGYsICcuJykgPT09IGZhbHNlKSB7DQogICAgICAgIHJldHVybiAnJzsNCiAgICB9DQoNCiAgICAkYSA9IGV4cGxvZGUoJy4nLCAkZik7DQoNCiAgICByZXR1cm4gc3RydG9sb3dlcihlbmQoJGEpKTsNCn0NCg0KLyoqDQogKiDojrflj5bmlofku7bmnYPpmZAuDQogKg0KICogQHBhcmFtIHN0cmluZyAkZiDmlofku7blkI0NCiAqDQogKiBAcmV0dXJuIHN0cmluZ3xudWxsIOi/lOWbnuaWh+S7tuadg+mZkO+8jOaVsOWAvOagvOW8j++8jOWmgjA2NDQNCiAqLw0KZnVuY3Rpb24gR2V0RmlsZVBlcm1zT2N0KCRmKQ0Kew0KICAgIGlmICghZmlsZV9leGlzdHMoJGYpKSB7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICByZXR1cm4gc3Vic3RyKHNwcmludGYoJyVvJywgZmlsZXBlcm1zKCRmKSksIC00KTsNCn0NCg0KLyoqDQogKiDojrflj5bmlofku7bmnYPpmZAuDQogKg0KICogQHBhcmFtIHN0cmluZyAkZiDmlofku7blkI0NCiAqDQogKiBAcmV0dXJuIHN0cmluZ3xudWxsIOi/lOWbnuaWh+S7tuadg+mZkO+8jOWtl+espuihqOi+vuagvOW8j++8jOWmgi1ydy1yLS1yLS0NCiAqLw0KZnVuY3Rpb24gR2V0RmlsZVBlcm1zKCRmKQ0Kew0KICAgIGlmICghZmlsZV9leGlzdHMoJGYpKSB7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICAkcGVybXMgPSBmaWxlcGVybXMoJGYpOw0KICAgIHN3aXRjaCAoJHBlcm1zICYgMHhGMDAwKSB7DQogICAgICAgIGNhc2UgMHhDMDAwOiAvLyBzb2NrZXQNCiAgICAgICAgICAgICRpbmZvID0gJ3MnOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgMHhBMDAwOiAvLyBzeW1ib2xpYyBsaW5rDQogICAgICAgICAgICAkaW5mbyA9ICdsJzsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlIDB4ODAwMDogLy8gcmVndWxhcg0KICAgICAgICAgICAgJGluZm8gPSAnLSc7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAweDYwMDA6IC8vIGJsb2NrIHNwZWNpYWwNCiAgICAgICAgICAgICRpbmZvID0gJ2InOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgMHg0MDAwOiAvLyBkaXJlY3RvcnkNCiAgICAgICAgICAgICRpbmZvID0gJ2QnOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgMHgyMDAwOiAvLyBjaGFyYWN0ZXIgc3BlY2lhbA0KICAgICAgICAgICAgJGluZm8gPSAnYyc7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAweDEwMDA6IC8vIEZJRk8gcGlwZQ0KICAgICAgICAgICAgJGluZm8gPSAncCc7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgZGVmYXVsdDogLy8gdW5rbm93bg0KICAgICAgICAgICAgJGluZm8gPSAndSc7DQogICAgfQ0KDQogICAgLy8gT3duZXINCiAgICAkaW5mbyAuPSAoKCRwZXJtcyAmIDB4MDEwMCkgPyAncicgOiAnLScpOw0KICAgICRpbmZvIC49ICgoJHBlcm1zICYgMHgwMDgwKSA/ICd3JyA6ICctJyk7DQogICAgJGluZm8gLj0gKCgkcGVybXMgJiAweDAwNDApID8gKCgkcGVybXMgJiAweDA4MDApID8gJ3MnIDogJ3gnKSA6ICgoJHBlcm1zICYgMHgwODAwKSA/ICdTJyA6ICctJykpOw0KDQogICAgLy8gR3JvdXANCiAgICAkaW5mbyAuPSAoKCRwZXJtcyAmIDB4MDAyMCkgPyAncicgOiAnLScpOw0KICAgICRpbmZvIC49ICgoJHBlcm1zICYgMHgwMDEwKSA/ICd3JyA6ICctJyk7DQogICAgJGluZm8gLj0gKCgkcGVybXMgJiAweDAwMDgpID8gKCgkcGVybXMgJiAweDA0MDApID8gJ3MnIDogJ3gnKSA6ICgoJHBlcm1zICYgMHgwNDAwKSA/ICdTJyA6ICctJykpOw0KDQogICAgLy8gT3RoZXINCiAgICAkaW5mbyAuPSAoKCRwZXJtcyAmIDB4MDAwNCkgPyAncicgOiAnLScpOw0KICAgICRpbmZvIC49ICgoJHBlcm1zICYgMHgwMDAyKSA/ICd3JyA6ICctJyk7DQogICAgJGluZm8gLj0gKCgkcGVybXMgJiAweDAwMDEpID8gKCgkcGVybXMgJiAweDAyMDApID8gJ3QnIDogJ3gnKSA6ICgoJHBlcm1zICYgMHgwMjAwKSA/ICdUJyA6ICctJykpOw0KDQogICAgcmV0dXJuICRpbmZvOw0KfQ0KDQovKioNCiAqIOWQkeWtl+espuS4suWei+eahOWPguaVsOihqOWKoOWFpeS4gOS4quaWsOWPguaVsC4NCiAqDQogKiBAcGFyYW0gc3RyaW5nICRzICAgIOWtl+espuS4suWei+eahOWPguaVsOihqO+8jOS7pXznrKblj7fliIbpmpQNCiAqIEBwYXJhbSBzdHJpbmcgJG5hbWUg5Y+C5pWw5ZCNDQogKg0KICogQHJldHVybiBzdHJpbmcg6L+U5Zue5paw5a2X56ym5Liy77yM5LulfOespuWPt+WIhumalA0KICovDQpmdW5jdGlvbiBBZGROYW1lSW5TdHJpbmcoJHMsICRuYW1lKQ0Kew0KICAgICRwbCA9ICRzOw0KICAgICRuYW1lID0gKHN0cmluZykgJG5hbWU7DQogICAgJGFwbCA9IGV4cGxvZGUoJ3wnLCAkcGwpOw0KICAgIGlmIChpbl9hcnJheSgkbmFtZSwgJGFwbCkgPT0gZmFsc2UpIHsNCiAgICAgICAgJGFwbFtdID0gJG5hbWU7DQogICAgfQ0KICAgICRwbCA9IHRyaW0oaW1wbG9kZSgnfCcsICRhcGwpLCAnfCcpOw0KDQogICAgcmV0dXJuICRwbDsNCn0NCg0KLyoqDQogKiDku47lrZfnrKbkuLLlnovnmoTlj4LmlbDooajkuK3liKDpmaTkuIDkuKrlj4LmlbAuDQogKg0KICogQHBhcmFtIHN0cmluZyAkcyAgICDlrZfnrKbkuLLlnovnmoTlj4LmlbDooajvvIzku6V856ym5Y+35YiG6ZqUDQogKiBAcGFyYW0gc3RyaW5nICRuYW1lIOWPguaVsOWQjQ0KICoNCiAqIEByZXR1cm4gc3RyaW5nIOi/lOWbnuaWsOWtl+espuS4su+8jOS7pXznrKblj7fliIbpmpQNCiAqLw0KZnVuY3Rpb24gRGVsTmFtZUluU3RyaW5nKCRzLCAkbmFtZSkNCnsNCiAgICAkcGwgPSAkczsNCiAgICAkbmFtZSA9IChzdHJpbmcpICRuYW1lOw0KICAgICRhcGwgPSBleHBsb2RlKCd8JywgJHBsKTsNCiAgICAkY291bnQgPSBjb3VudCgkYXBsKTsNCiAgICBmb3IgKCRpID0gMDsgJGkgPCAkY291bnQ7ICRpKyspIHsNCiAgICAgICAgaWYgKCRhcGxbJGldID09ICRuYW1lKSB7DQogICAgICAgICAgICB1bnNldCgkYXBsWyRpXSk7DQogICAgICAgIH0NCiAgICB9DQogICAgJHBsID0gdHJpbShpbXBsb2RlKCd8JywgJGFwbCksICd8Jyk7DQoNCiAgICByZXR1cm4gJHBsOw0KfQ0KDQovKioNCiAqIOWcqOWtl+espuS4suWPguaVsOWAvOafpeaJvuWPguaVsC4NCiAqDQogKiBAcGFyYW0gc3RyaW5nICRzICAgIOWtl+espuS4suWei+eahOWPguaVsOihqO+8jOS7pXznrKblj7fliIbpmpQNCiAqIEBwYXJhbSBzdHJpbmcgJG5hbWUg5Y+C5pWw5ZCNDQogKg0KICogQHJldHVybiBib29sDQogKi8NCmZ1bmN0aW9uIEhhc05hbWVJblN0cmluZygkcywgJG5hbWUpDQp7DQogICAgJHBsID0gJHM7DQogICAgJG5hbWUgPSAoc3RyaW5nKSAkbmFtZTsNCiAgICAkYXBsID0gZXhwbG9kZSgnfCcsICRwbCk7DQoNCiAgICByZXR1cm4gaW5fYXJyYXkoJG5hbWUsICRhcGwpOw0KfQ0KDQovKioNCiAqIOS7pUpTT07lvaLlvI/ovpPlh7rplJnor6/kv6Hmga/vvIjnlKjkuo5TaG93RXJyb3LmjqXlj6PvvIkuDQogKg0KICogQHBhcmFtICRlcnJvckNvZGUNCiAqIEBwYXJhbSAkZXJyb3JTdHJpbmcNCiAqIEBwYXJhbSAkZmlsZQ0KICogQHBhcmFtICRsaW5lDQogKi8NCmZ1bmN0aW9uIEpzb25FcnJvcjRTaG93RXJyb3JIb29rKCRlcnJvckNvZGUsICRlcnJvclN0cmluZywgJGZpbGUsICRsaW5lKQ0Kew0KICAgIGlmICgkZXJyb3JDb2RlID09PSAwKSB7DQogICAgICAgICRlcnJvckNvZGUgPSAxOw0KICAgIH0NCiAgICBKc29uRXJyb3IoJGVycm9yQ29kZSwgJGVycm9yU3RyaW5nLCBudWxsKTsNCn0NCg0KLyoqDQogKiDku6VKU09O5b2i5byP6L6T5Ye66ZSZ6K+v5L+h5oGvLihlcnIgY29kZeS4uihpbnQpMOiupOS4uuaYr+ayoeaciemUmeivr++8jOaJgOS7peaKijDovazkuLoxKQ0KICoNCiAqIEBwYXJhbSBzdHJpbmcgJGVycm9yQ29kZSAgIOmUmeivr+e8luWPtw0KICogQHBhcmFtIHN0cmluZyAkZXJyb3JTdHJpbmcg6ZSZ6K+v5YaF5a65DQogKiBAcGFyYW0gb2JqZWN0ICRkYXRhIOWFt+S9k+WGheWuuQ0KICovDQpmdW5jdGlvbiBKc29uRXJyb3IoJGVycm9yQ29kZSwgJGVycm9yU3RyaW5nLCAkZGF0YSkNCnsNCiAgICAkZXhpdCA9IHRydWU7DQogICAgaWYgKCRlcnJvckNvZGUgPT09IDApIHsNCiAgICAgICAgJGV4aXQgPSBmYWxzZTsNCiAgICB9DQogICAgJHJlc3VsdCA9IGFycmF5KA0KICAgICAgICAnZGF0YScgPT4gJGRhdGEsDQogICAgICAgICdlcnInICA9PiBhcnJheSgNCiAgICAgICAgICAgICdjb2RlJyA9PiAkZXJyb3JDb2RlLA0KICAgICAgICAgICAgJ21zZycgID0+ICRlcnJvclN0cmluZywNCiAgICAgICAgICAgIC8vJ3J1bnRpbWUnID0+IFJ1blRpbWUoKSwNCiAgICAgICAgICAgICd0aW1lc3RhbXAnID0+IHRpbWUoKSwNCiAgICAgICAgKSwNCiAgICApOw0KICAgIEBvYl9jbGVhbigpOw0KICAgIGVjaG8ganNvbl9lbmNvZGUoJHJlc3VsdCk7DQogICAgaWYgKCRleGl0KSB7DQogICAgICAgIGV4aXQ7DQogICAgfQ0KfQ0KDQovKioNCiAqIOW9k+S7o+eggeato+W4uOi/kOihjOaXtu+8jOS7pUpTT07lvaLlvI/ovpPlh7rkv6Hmga8uDQogKg0KICogQHBhcmFtIG9iamVjdCDlvoXov5Tlm57lhoXlrrkNCiAqLw0KZnVuY3Rpb24gSnNvblJldHVybigkZGF0YSkNCnsNCiAgICBKc29uRXJyb3IoMCwgJycsICRkYXRhKTsNCn0NCg0KLyoqDQogKiBYTUwtUlBD5bqU562U6ZSZ6K+v6aG16Z2iLg0KICoNCiAqIEBwYXJhbSAkZXJyb3JDb2RlDQogKiBAcGFyYW0gJGVycm9yU3RyaW5nDQogKg0KICogQHJldHVybiB2b2lkDQogKi8NCmZ1bmN0aW9uIFJlc3BvbmRFcnJvcigkZXJyb3JDb2RlLCAkZXJyb3JTdHJpbmcgPSAnJywgJGZpbGUgPSAnJywgJGxpbmUgPSAnJykNCnsNCiAgICAkc3RyWE1MID0gJzw/eG1sIHZlcnNpb249IjEuMCIgZW5jb2Rpbmc9IlVURi04Ij8+PG1ldGhvZFJlc3BvbnNlPjxmYXVsdD48dmFsdWU+PHN0cnVjdD48bWVtYmVyPjxuYW1lPmZhdWx0Q29kZTwvbmFtZT48dmFsdWU+PGludD4kMTwvaW50PjwvdmFsdWU+PC9tZW1iZXI+PG1lbWJlcj48bmFtZT5mYXVsdFN0cmluZzwvbmFtZT48dmFsdWU+PHN0cmluZz4kMjwvc3RyaW5nPjwvdmFsdWU+PC9tZW1iZXI+PC9zdHJ1Y3Q+PC92YWx1ZT48L2ZhdWx0PjwvbWV0aG9kUmVzcG9uc2U+JzsNCiAgICAkc3RyRXJyb3IgPSAkc3RyWE1MOw0KICAgICRzdHJFcnJvciA9IHN0cl9yZXBsYWNlKCIkMSIsIEZvcm1hdFN0cmluZygkZXJyb3JDb2RlLCAiW2h0bWwtZm9ybWF0XSIpLCAkc3RyRXJyb3IpOw0KICAgICRzdHJFcnJvciA9IHN0cl9yZXBsYWNlKCIkMiIsIEZvcm1hdFN0cmluZygkZXJyb3JTdHJpbmcsICJbaHRtbC1mb3JtYXRdIiksICRzdHJFcnJvcik7DQoNCiAgICBvYl9jbGVhbigpOw0KICAgIGVjaG8gJHN0ckVycm9yOw0KICAgIGV4aXQ7DQp9DQoNCi8qKg0KICogWE1MLVJQQ+iEmuacrOmUmeivr+mhtemdoi4NCiAqDQogKiBAcGFyYW0gc3RyaW5nICRlcnJvckNvZGUg6ZSZ6K+v5o+Q56S65a2X56ym5LiyDQogKiBAcGFyYW0gJGVycm9yU3RyaW5nDQogKg0KICogQHJldHVybiB2b2lkDQogKi8NCmZ1bmN0aW9uIFNjcmlwdEVycm9yKCRlcnJvckNvZGUsICRlcnJvclRleHQgPSAnJywgJGZpbGUgPSAnJywgJGxpbmUgPSAnJykNCnsNCiAgICBoZWFkZXIoJ0NvbnRlbnQtdHlwZTogYXBwbGljYXRpb24veC1qYXZhc2NyaXB0OyBDaGFyc2V0PXV0Zi04Jyk7DQogICAgb2JfY2xlYW4oKTsNCiAgICBlY2hvICdhbGVydCgiJyAuIHN0cl9yZXBsYWNlKCciJywgJ1wiJywgJGVycm9yQ29kZSAuICc6JyAuICRlcnJvclRleHQpIC4gJyIpJzsNCiAgICBkaWUoKTsNCn0NCg0KLyoqDQogKiAg6aqM6K+B5a2X56ym5Liy5piv5ZCm56ym5ZCI5q2j5YiZ6KGo6L6+5byPLg0KICoNCiAqIEBwYXJhbSBzdHJpbmcgJHNvdXJjZSDlrZfnrKbkuLINCiAqIEBwYXJhbSBzdHJpbmcgJHBhcmEgICDmraPliJnooajovr7lvI/vvIzlj6/nlKhbdXNlcm5hbWVdfFtwYXNzd29yZF18W2VtYWlsXXxbaG9tZXBhZ2Vd5oiW6Ieq5a6a5LmJ6KGo6L6+5byPDQogKg0KICogQHJldHVybiBib29sDQogKi8NCmZ1bmN0aW9uIENoZWNrUmVnRXhwKCRzb3VyY2UsICRwYXJhKQ0Kew0KICAgIGlmIChzdHJwb3MoJHBhcmEsICdbdXNlcm5hbWVdJykgIT09IGZhbHNlKSB7DQogICAgICAgICRwYXJhID0gIi9eW1wuXF9BLVphLXowLTnCt0BceHs0ZTAwfS1ceHs5ZmE1fV0rJC91IjsNCiAgICB9IGVsc2VpZiAoc3RycG9zKCRwYXJhLCAnW25pY2tuYW1lXScpICE9PSBmYWxzZSkgew0KICAgICAgICAkcGFyYSA9ICcvKFteXHh7MDF9LVx4ezFGfVx4ezgwfS1ceHtGRn1cLzpcXH4mJTtAXCciPzw+fCMkXCp9eyxcKz1cW1xdXChcKVx7XH1cdFxyXG5ccHtDfV0pL3UnOw0KICAgIH0gZWxzZWlmIChzdHJwb3MoJHBhcmEsICdbcGFzc3dvcmRdJykgIT09IGZhbHNlKSB7DQogICAgICAgICRwYXJhID0gIi9eW0EtWmEtejAtOWB+IUAjXCQlXF4mXCpcLV9cP10rJC91IjsNCiAgICB9IGVsc2VpZiAoc3RycG9zKCRwYXJhLCAnW2VtYWlsXScpICE9PSBmYWxzZSkgew0KICAgICAgICAkcGFyYSA9ICIvXihbMC05YS16QS1aXShbLS5cd10qWzAtOWEtekEtWl0pKkAoWzAtOWEtekEtWl1bLVx3XSpcLikrW2EtekEtWl0qKSQvdSI7DQogICAgfSBlbHNlaWYgKHN0cnBvcygkcGFyYSwgJ1tob21lcGFnZV0nKSAhPT0gZmFsc2UpIHsNCiAgICAgICAgJHBhcmEgPSAiL15bYS16QS1aXSs6XC9cL1thLXpBLVowLTlcX1wtXC5cJlw/XC86PSNceHs0ZTAwfS1ceHs5ZmE1fV0rJC91IjsNCiAgICB9IGVsc2VpZiAoISRwYXJhKSB7DQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICB9DQoNCiAgICByZXR1cm4gKGJvb2wpIHByZWdfbWF0Y2goJHBhcmEsICRzb3VyY2UpOw0KfQ0KDQovKioNCiAqICDmoLzlvI/ljJblrZfnrKbkuLIuDQogKg0KICogQHBhcmFtIHN0cmluZyAkc291cmNlIOWtl+espuS4sg0KICogQHBhcmFtIHN0cmluZyAkcGFyYSAgIOato+WImeihqOi+vuW8j++8jOWPr+eUqFtodG1sLWZvcm1hdF18W25vaHRtbF18W25vc2NyaXB0XXxbZW50ZXJdfFtub2VudGVyXXxbZmlsZW5hbWVdfFtub3JtYWxuYW1lXeaIluiHquWumuS5ieihqOi+vuW8jw0KICoNCiAqIEByZXR1cm4gc3RyaW5nDQogKi8NCmZ1bmN0aW9uIEZvcm1hdFN0cmluZygkc291cmNlLCAkcGFyYSkNCnsNCiAgICBpZiAoc3RycG9zKCRwYXJhLCAnW2h0bWwtZm9ybWF0XScpICE9PSBmYWxzZSkgew0KICAgICAgICAkc291cmNlID0gaHRtbHNwZWNpYWxjaGFycygkc291cmNlKTsNCiAgICB9DQoNCiAgICBpZiAoc3RycG9zKCRwYXJhLCAnW25vaHRtbF0nKSAhPT0gZmFsc2UpIHsNCiAgICAgICAgJHNvdXJjZSA9IHByZWdfcmVwbGFjZSgiLzwoW148Pl0qKT4vc2kiLCAiIiwgJHNvdXJjZSk7DQogICAgICAgICRzb3VyY2UgPSBzdHJfcmVwbGFjZSgiPCIsICLLgiIsICRzb3VyY2UpOw0KICAgICAgICAkc291cmNlID0gc3RyX3JlcGxhY2UoIj4iLCAiy4MiLCAkc291cmNlKTsNCiAgICB9DQoNCiAgICBpZiAoc3RycG9zKCRwYXJhLCAnW25vc2NyaXB0XScpICE9PSBmYWxzZSkgew0KICAgICAgICAkY2xhc3MgPSBuZXcgWHNzSHRtbCgkc291cmNlKTsNCiAgICAgICAgJHNvdXJjZSA9IHRyaW0oJGNsYXNzLT5nZXRIdG1sKCkpOw0KICAgIH0NCiAgICBpZiAoc3RycG9zKCRwYXJhLCAnW2VudGVyXScpICE9PSBmYWxzZSkgew0KICAgICAgICAkc291cmNlID0gc3RyX3JlcGxhY2UoIlxyXG4iLCAiPGJyLz4iLCAkc291cmNlKTsNCiAgICAgICAgJHNvdXJjZSA9IHN0cl9yZXBsYWNlKCJcbiIsICI8YnIvPiIsICRzb3VyY2UpOw0KICAgICAgICAkc291cmNlID0gc3RyX3JlcGxhY2UoIlxyIiwgIjxici8+IiwgJHNvdXJjZSk7DQogICAgICAgICRzb3VyY2UgPSBwcmVnX3JlcGxhY2UoIi8oPGJyXC8+KSsvIiwgIjxici8+IiwgJHNvdXJjZSk7DQogICAgfQ0KICAgIGlmIChzdHJwb3MoJHBhcmEsICdbbm9lbnRlcl0nKSAhPT0gZmFsc2UpIHsNCiAgICAgICAgJHNvdXJjZSA9IHN0cl9yZXBsYWNlKCJcclxuIiwgIiIsICRzb3VyY2UpOw0KICAgICAgICAkc291cmNlID0gc3RyX3JlcGxhY2UoIlxuIiwgIiIsICRzb3VyY2UpOw0KICAgICAgICAkc291cmNlID0gc3RyX3JlcGxhY2UoIlxyIiwgIiIsICRzb3VyY2UpOw0KICAgIH0NCiAgICBpZiAoc3RycG9zKCRwYXJhLCAnW2ZpbGVuYW1lXScpICE9PSBmYWxzZSkgew0KICAgICAgICAkc291cmNlID0gc3RyX3JlcGxhY2UoYXJyYXkoIi8iLCAiIyIsICIkIiwgIlxcIiwgIjoiLCAiPyIsICIqIiwgIlwiIiwgIjwiLCAiPiIsICJ8IiwgIiAiKSwgYXJyYXkoIiIpLCAkc291cmNlKTsNCiAgICB9DQogICAgaWYgKHN0cnBvcygkcGFyYSwgJ1tub3JtYWxuYW1lXScpICE9PSBmYWxzZSkgew0KICAgICAgICAkc291cmNlID0gc3RyX3JlcGxhY2UoYXJyYXkoIiMiLCAiJCIsICIoIiwgIikiLCAiKiIsICIrIiwgIlsiLCAiXSIsICJ7IiwgIn0iLCAiPyIsICJcXCIsICJeIiwgInwiLCAiOiIsICInIiwgIlwiIiwgIjsiLCAiQCIsICJ+IiwgIj0iLCAiJSIsICImIiksIGFycmF5KCIiKSwgJHNvdXJjZSk7DQogICAgfQ0KDQogICAgcmV0dXJuICRzb3VyY2U7DQp9DQoNCi8qKg0KICogQERlcHJlY2F0ZWQNCiAqIOagvOW8j+WMluWtl+espuS4sg0KICoqLw0KZnVuY3Rpb24gVHJhbnNmZXJIVE1MKCRzb3VyY2UsICRwYXJhbSkNCnsNCiAgICByZXR1cm4gRm9ybWF0U3RyaW5nKCRzb3VyY2UsICRwYXJhbSk7DQp9DQoNCi8qKg0KICogIOWwgeijhUhUTUzmoIfnrb4uDQogKg0KICogQHBhcmFtIHN0cmluZyAkaHRtbCBodG1s5rqQ56CBDQogKg0KICogQHJldHVybiBzdHJpbmcNCiAqLw0KZnVuY3Rpb24gQ2xvc2VUYWdzKCRodG1sKQ0Kew0KICAgIHByZWdfbWF0Y2hfYWxsKCcjPCg/IW1ldGF8aW1nfGJyfGhyfGlucHV0XGIpXGIoW2Etel0rKSg/OiAuKik/KD88IVsvfC8gXSk+I2lVJywgJGh0bWwsICRyZXN1bHQpOw0KICAgICRvcGVuZWR0YWdzID0gJHJlc3VsdFsxXTsNCiAgICBwcmVnX21hdGNoX2FsbCgnIzwvKFthLXpdKyk+I2lVJywgJGh0bWwsICRyZXN1bHQpOw0KICAgICRjbG9zZWR0YWdzID0gJHJlc3VsdFsxXTsNCiAgICAkbGVuX29wZW5lZCA9IGNvdW50KCRvcGVuZWR0YWdzKTsNCiAgICBpZiAoY291bnQoJGNsb3NlZHRhZ3MpID09ICRsZW5fb3BlbmVkKSB7DQogICAgICAgIHJldHVybiAkaHRtbDsNCiAgICB9DQogICAgJG9wZW5lZHRhZ3MgPSBhcnJheV9yZXZlcnNlKCRvcGVuZWR0YWdzKTsNCiAgICBmb3IgKCRpID0gMDsgJGkgPCAkbGVuX29wZW5lZDsgJGkrKykgew0KICAgICAgICBpZiAoIWluX2FycmF5KCRvcGVuZWR0YWdzWyRpXSwgJGNsb3NlZHRhZ3MpKSB7DQogICAgICAgICAgICAkaHRtbCAuPSAnPC8nIC4gJG9wZW5lZHRhZ3NbJGldIC4gJz4nOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgdW5zZXQoJGNsb3NlZHRhZ3NbYXJyYXlfc2VhcmNoKCRvcGVuZWR0YWdzWyRpXSwgJGNsb3NlZHRhZ3MpXSk7DQogICAgICAgIH0NCiAgICB9DQogICAgcmV0dXJuICRodG1sOw0KfQ0KDQovKioNCiAqICBaQlDniYhTdHJMZW4uDQogKg0KICogQHBhcmFtIHN0cmluZyAkc3RyaW5nDQogKg0KICogQHJldHVybiBzdHJpbmcNCiAqLw0KZnVuY3Rpb24gWmJwX1N0ckxlbigkc3RyaW5nKQ0Kew0KICAgIGlmIChmdW5jdGlvbl9leGlzdHMoJ21iX3N0cmxlbicpICYmIGZ1bmN0aW9uX2V4aXN0cygnbWJfaW50ZXJuYWxfZW5jb2RpbmcnKSkgew0KICAgICAgICBtYl9pbnRlcm5hbF9lbmNvZGluZygnVVRGLTgnKTsNCiAgICAgICAgcmV0dXJuIG1iX3N0cmxlbigkc3RyaW5nKTsNCiAgICB9DQogICAgaWYgKGZ1bmN0aW9uX2V4aXN0cygnaWNvbnZfc3RybGVuJykgJiYgZnVuY3Rpb25fZXhpc3RzKCdpY29udl9zZXRfZW5jb2RpbmcnKSkgew0KICAgICAgICBjYWxsX3VzZXJfZnVuYygnaWNvbnZfc2V0X2VuY29kaW5nJywgJ2ludGVybmFsX2VuY29kaW5nJywgIlVURi04Iik7DQogICAgICAgIGNhbGxfdXNlcl9mdW5jKCdpY29udl9zZXRfZW5jb2RpbmcnLCAnb3V0cHV0X2VuY29kaW5nJywgIlVURi04Iik7DQogICAgICAgIHJldHVybiBpY29udl9zdHJsZW4oJHN0cmluZyk7DQogICAgfQ0KICAgIHJldHVybiBzdHJsZW4oJHN0cmluZyk7DQp9DQoNCi8qKg0KICog6I635Y+WVVRGOOagvOW8j+eahOWtl+espuS4sueahOWtkOS4si4NCiAqDQogKiBAcGFyYW0gc3RyaW5nICRzb3VyY2VzdHIg5rqQ5a2X56ym5LiyDQogKiBAcGFyYW0gaW50ICAgICRzdGFydCAgICAg6LW35aeL5L2N572uDQogKiBAcGFyYW0gaW50ICAgICRjdXRsZW5ndGgg5a2Q5Liy6ZW/5bqmDQogKg0KICogQHJldHVybiBzdHJpbmcNCiAqLw0KZnVuY3Rpb24gU3ViU3RyVVRGOF9TdGFydCgkc291cmNlc3RyLCAkc3RhcnQsICRjdXRsZW5ndGgpDQp7DQogICAgaWYgKGZ1bmN0aW9uX2V4aXN0cygnbWJfc3Vic3RyJykgJiYgZnVuY3Rpb25fZXhpc3RzKCdtYl9pbnRlcm5hbF9lbmNvZGluZycpKSB7DQogICAgICAgIG1iX2ludGVybmFsX2VuY29kaW5nKCdVVEYtOCcpOw0KDQogICAgICAgIHJldHVybiAoc3RyaW5nKSBtYl9zdWJzdHIoJHNvdXJjZXN0ciwgJHN0YXJ0LCAkY3V0bGVuZ3RoKTsNCiAgICB9DQoNCiAgICBpZiAoZnVuY3Rpb25fZXhpc3RzKCdpY29udl9zdWJzdHInKSAmJiBmdW5jdGlvbl9leGlzdHMoJ2ljb252X3NldF9lbmNvZGluZycpKSB7DQogICAgICAgIGljb252X3NldF9lbmNvZGluZygiaW50ZXJuYWxfZW5jb2RpbmciLCAiVVRGLTgiKTsNCiAgICAgICAgaWNvbnZfc2V0X2VuY29kaW5nKCJvdXRwdXRfZW5jb2RpbmciLCAiVVRGLTgiKTsNCg0KICAgICAgICByZXR1cm4gKHN0cmluZykgaWNvbnZfc3Vic3RyKCRzb3VyY2VzdHIsICRzdGFydCwgJGN1dGxlbmd0aCk7DQogICAgfQ0KDQogICAgcmV0dXJuIChzdHJpbmcpIHN1YnN0cigkc291cmNlc3RyLCAkc3RhcnQsICRjdXRsZW5ndGgpOw0KfQ0KDQovKioNCiAqICDojrflj5ZVVEY45qC85byP55qE5a2X56ym5Liy55qE5a2Q5LiyLg0KICoNCiAqIEBwYXJhbSBzdHJpbmcgJHNvdXJjZXN0ciDmupDlrZfnrKbkuLINCiAqIEBwYXJhbSBpbnQgICAgJGN1dGxlbmd0aCDlrZDkuLLplb/luqYNCiAqDQogKiBAcmV0dXJuIHN0cmluZw0KICovDQpmdW5jdGlvbiBTdWJTdHJVVEY4KCRzb3VyY2VzdHIsICRjdXRsZW5ndGgpDQp7DQogICAgaWYgKGZ1bmN0aW9uX2V4aXN0cygnbWJfc3Vic3RyJykgJiYgZnVuY3Rpb25fZXhpc3RzKCdtYl9pbnRlcm5hbF9lbmNvZGluZycpKSB7DQogICAgICAgIG1iX2ludGVybmFsX2VuY29kaW5nKCdVVEYtOCcpOw0KDQogICAgICAgIHJldHVybiAoc3RyaW5nKSBtYl9zdWJzdHIoJHNvdXJjZXN0ciwgMCwgJGN1dGxlbmd0aCk7DQogICAgfQ0KDQogICAgaWYgKGZ1bmN0aW9uX2V4aXN0cygnaWNvbnZfc3Vic3RyJykgJiYgZnVuY3Rpb25fZXhpc3RzKCdpY29udl9zZXRfZW5jb2RpbmcnKSkgew0KICAgICAgICBpY29udl9zZXRfZW5jb2RpbmcoImludGVybmFsX2VuY29kaW5nIiwgIlVURi04Iik7DQogICAgICAgIGljb252X3NldF9lbmNvZGluZygib3V0cHV0X2VuY29kaW5nIiwgIlVURi04Iik7DQoNCiAgICAgICAgcmV0dXJuIChzdHJpbmcpIGljb252X3N1YnN0cigkc291cmNlc3RyLCAwLCAkY3V0bGVuZ3RoKTsNCiAgICB9DQoNCiAgICAkcmV0ID0gJyc7DQogICAgJGkgPSAwOw0KICAgICRuID0gMDsNCg0KICAgICRzdHJfbGVuZ3RoID0gc3RybGVuKCRzb3VyY2VzdHIpOyAvL+Wtl+espuS4sueahOWtl+iKguaVsA0KDQogICAgd2hpbGUgKCgkbiA8ICRjdXRsZW5ndGgpIGFuZCAoJGkgPD0gJHN0cl9sZW5ndGgpKSB7DQogICAgICAgICR0ZW1wX3N0ciA9IHN1YnN0cigkc291cmNlc3RyLCAkaSwgMSk7DQogICAgICAgICRhc2NudW0gPSBvcmQoJHRlbXBfc3RyKTsgLy/lvpfliLDlrZfnrKbkuLLkuK3nrKwkaeS9jeWtl+espueahGFzY2lp56CBDQogICAgICAgIGlmICgkYXNjbnVtID49IDIyNCkgeyAvL+WmguaenEFTQ0lJ5L2N6auY5LiOMjI077yMDQogICAgICAgICAgICAkcmV0ID0gJHJldCAuIHN1YnN0cigkc291cmNlc3RyLCAkaSwgMyk7IC8v5qC55o2uVVRGLTjnvJbnoIHop4TojIPvvIzlsIYz5Liq6L+e57ut55qE5a2X56ym6K6h5Li65Y2V5Liq5a2X56ymDQogICAgICAgICAgICAkaSA9ICRpICsgMzsgLy/lrp7pmYVCeXRl6K6h5Li6Mw0KICAgICAgICAgICAgJG4rKzsgLy/lrZfkuLLplb/luqborqExDQogICAgICAgIH0gZWxzZWlmICgkYXNjbnVtID49IDE5MikgeyAvL+WmguaenEFTQ0lJ5L2N6auY5LiOMTky77yMDQogICAgICAgICAgICAkcmV0ID0gJHJldCAuIHN1YnN0cigkc291cmNlc3RyLCAkaSwgMik7IC8v5qC55o2uVVRGLTjnvJbnoIHop4TojIPvvIzlsIYy5Liq6L+e57ut55qE5a2X56ym6K6h5Li65Y2V5Liq5a2X56ymDQogICAgICAgICAgICAkaSA9ICRpICsgMjsgLy/lrp7pmYVCeXRl6K6h5Li6Mg0KICAgICAgICAgICAgJG4rKzsgLy/lrZfkuLLplb/luqborqExDQogICAgICAgIH0gZWxzZWlmICgkYXNjbnVtID49IDY1ICYmICRhc2NudW0gPD0gOTApIHsgLy/lpoLmnpzmmK/lpKflhpnlrZfmr43vvIwNCiAgICAgICAgICAgICRyZXQgPSAkcmV0IC4gc3Vic3RyKCRzb3VyY2VzdHIsICRpLCAxKTsNCiAgICAgICAgICAgICRpID0gJGkgKyAxOyAvL+WunumZheeahEJ5dGXmlbDku43orqEx5LiqDQogICAgICAgICAgICAkbisrOyAvL+S9huiAg+iZkeaVtOS9k+e+juingu+8jOWkp+WGmeWtl+avjeiuoeaIkOS4gOS4qumrmOS9jeWtl+espg0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgLy/lhbbku5bmg4XlhrXkuIvvvIzljIXmi6zlsI/lhpnlrZfmr43lkozljYrop5LmoIfngrnnrKblj7fvvIwNCg0KICAgICAgICAgICAgJHJldCA9ICRyZXQgLiBzdWJzdHIoJHNvdXJjZXN0ciwgJGksIDEpOw0KICAgICAgICAgICAgJGkgPSAkaSArIDE7IC8v5a6e6ZmF55qEQnl0ZeaVsOiuoTHkuKoNCiAgICAgICAgICAgICAgICAkbiA9ICRuICsgMC41OyAvL+Wwj+WGmeWtl+avjeWSjOWNiuinkuagh+eCueetieS4juWNiuS4qumrmOS9jeWtl+espuWuvS4uLg0KICAgICAgICB9DQogICAgICAgIC8qDQogICAgICAgIGlmICgkc3RyX2xlbmd0aCA+ICRjdXRsZW5ndGgpIHsNCiAgICAgICAgICAgICRyZXQgPSAkcmV0Ow0KICAgICAgICB9DQogICAgICAgICovDQogICAgfQ0KDQogICAgcmV0dXJuIChzdHJpbmcpICRyZXQ7DQp9DQoNCi8qKg0KICog5oiq5Y+WSFRNTOagvOW8j+eahFVURjjmoLzlvI/nmoTlrZfnrKbkuLLnmoTlrZDkuLIuDQogKg0KICogQHBhcmFtIHN0cmluZyAkc291cmNlIOa6kOWtl+espuS4sg0KICogQHBhcmFtIGludCAgICAkbGVuZ3RoIOWtkOS4sumVv+W6pg0KICoNCiAqIEByZXR1cm4gc3RyaW5nDQogKi8NCmZ1bmN0aW9uIFN1YlN0clVURjhfSHRtbCgkc291cmNlLCAkbGVuZ3RoKQ0Kew0KICAgIGlmIChmdW5jdGlvbl9leGlzdHMoJ21iX3N1YnN0cicpICYmIGZ1bmN0aW9uX2V4aXN0cygnbWJfaW50ZXJuYWxfZW5jb2RpbmcnKSkgew0KICAgICAgICBtYl9pbnRlcm5hbF9lbmNvZGluZygnVVRGLTgnKTsNCiAgICAgICAgJGogPSBtYl9zdHJsZW4oJHNvdXJjZSk7DQogICAgICAgICRzID0gbWJfc3Vic3RyKCRzb3VyY2UsIDAsICRsZW5ndGgpOw0KICAgICAgICAkbCA9IG1iX3N1YnN0cl9jb3VudCgkcywgJzwnKTsNCiAgICAgICAgJHIgPSBtYl9zdWJzdHJfY291bnQoJHMsICc+Jyk7DQogICAgICAgIGlmICgkbCA+IDAgJiYgJGwgPiAkcikgew0KICAgICAgICAgICAgZm9yICgkaSA9ICRsZW5ndGg7ICRpIDwgJGo7ICRpKyspIHsNCiAgICAgICAgICAgICAgICAkcyAuPSBtYl9zdWJzdHIoJHNvdXJjZSwgJGksIDEpOw0KICAgICAgICAgICAgICAgIGlmIChtYl9zdWJzdHIoJHNvdXJjZSwgJGksIDEpID09ICc+Jykgew0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gKHN0cmluZykgJHM7DQogICAgfQ0KDQogICAgaWYgKGZ1bmN0aW9uX2V4aXN0cygnaWNvbnZfc3Vic3RyJykgJiYgZnVuY3Rpb25fZXhpc3RzKCdpY29udl9zZXRfZW5jb2RpbmcnKSkgew0KICAgICAgICBpY29udl9zZXRfZW5jb2RpbmcoImludGVybmFsX2VuY29kaW5nIiwgIlVURi04Iik7DQogICAgICAgIGljb252X3NldF9lbmNvZGluZygib3V0cHV0X2VuY29kaW5nIiwgIlVURi04Iik7DQogICAgICAgICRqID0gaWNvbnZfc3RybGVuKCRzb3VyY2UpOw0KICAgICAgICAkcyA9IGljb252X3N1YnN0cigkc291cmNlLCAwLCAkbGVuZ3RoKTsNCiAgICAgICAgJGwgPSBzdWJzdHJfY291bnQoJHMsICc8Jyk7DQogICAgICAgICRyID0gc3Vic3RyX2NvdW50KCRzLCAnPicpOw0KICAgICAgICBpZiAoJGwgPiAwICYmICRsID4gJHIpIHsNCiAgICAgICAgICAgIGZvciAoJGkgPSAkbGVuZ3RoOyAkaSA8ICRqOyAkaSsrKSB7DQogICAgICAgICAgICAgICAgJHMgLj0gaWNvbnZfc3Vic3RyKCRzb3VyY2UsICRpLCAxKTsNCiAgICAgICAgICAgICAgICBpZiAoaWNvbnZfc3Vic3RyKCRzb3VyY2UsICRpLCAxKSA9PSAnPicpIHsNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIChzdHJpbmcpICRzOw0KICAgIH0NCg0KICAgICRqID0gc3RybGVuKCRzb3VyY2UpOw0KICAgICRzID0gc3Vic3RyKCRzb3VyY2UsIDAsICRsZW5ndGgpOw0KICAgICRsID0gc3Vic3RyX2NvdW50KCRzLCAnPCcpOw0KICAgICRyID0gc3Vic3RyX2NvdW50KCRzLCAnPicpOw0KICAgIGlmICgkbCA+IDAgJiYgJGwgPiAkcikgew0KICAgICAgICBmb3IgKCRpID0gJGxlbmd0aDsgJGkgPCAkajsgJGkrKykgew0KICAgICAgICAgICAgJHMgLj0gc3Vic3RyKCRzb3VyY2UsICRpLCAxKTsNCiAgICAgICAgICAgIGlmIChzdWJzdHIoJHNvdXJjZSwgJGksIDEpID09ICc+Jykgew0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgcmV0dXJuIChzdHJpbmcpICRzOw0KfQ0KDQovKioNCiAqIOWIoOmZpOaWh+S7tkJPTeWktC4NCiAqDQogKiBAcGFyYW0gc3RyaW5nICRzIOaWh+S7tuWGheWuuQ0KICoNCiAqIEByZXR1cm4gc3RyaW5nDQogKi8NCmZ1bmN0aW9uIFJlbW92ZUJPTSgkcykNCnsNCiAgICAkY2hhcnNldCA9IGFycmF5KCk7DQogICAgJGNoYXJzZXRbMV0gPSBzdWJzdHIoJHMsIDAsIDEpOw0KICAgICRjaGFyc2V0WzJdID0gc3Vic3RyKCRzLCAxLCAxKTsNCiAgICAkY2hhcnNldFszXSA9IHN1YnN0cigkcywgMiwgMSk7DQogICAgaWYgKG9yZCgkY2hhcnNldFsxXSkgPT0gMjM5ICYmIG9yZCgkY2hhcnNldFsyXSkgPT0gMTg3ICYmIG9yZCgkY2hhcnNldFszXSkgPT0gMTkxKSB7DQogICAgICAgICRzID0gc3Vic3RyKCRzLCAzKTsNCiAgICB9DQoNCiAgICByZXR1cm4gJHM7DQp9DQoNCi8qKg0KICog6I635Y+W5oyH5a6a5pe25Yy65ZCNLg0KICoNCiAqIEBwYXJhbSBpbnQgJHog5pe25Yy65Y+3DQogKg0KICogQHJldHVybiBzdHJpbmcg5pe25Yy65ZCNDQogKg0KICogQHNpbmNlIDEuMy4xNDA2MTQNCiAqLw0KZnVuY3Rpb24gR2V0VGltZVpvbmVCeUdNVCgkeikNCnsNCiAgICAkdGltZXpvbmVzID0gYXJyYXkoDQogICAgICAgIC0xMiA9PiAnRXRjL0dNVCsxMicsDQogICAgICAgIC0xMSA9PiAnUGFjaWZpYy9NaWR3YXknLA0KICAgICAgICAtMTAgPT4gJ1BhY2lmaWMvSG9ub2x1bHUnLA0KICAgICAgICAtOSAgPT4gJ0FtZXJpY2EvQW5jaG9yYWdlJywNCiAgICAgICAgLTggID0+ICdBbWVyaWNhL0xvc19BbmdlbGVzJywNCiAgICAgICAgLTcgID0+ICdBbWVyaWNhL0RlbnZlcicsDQogICAgICAgIC02ICA9PiAnQW1lcmljYS9UZWd1Y2lnYWxwYScsDQogICAgICAgIC01ICA9PiAnQW1lcmljYS9OZXdfWW9yaycsDQogICAgICAgIC00ICA9PiAnQW1lcmljYS9IYWxpZmF4JywNCiAgICAgICAgLTMgID0+ICdBbWVyaWNhL0FyZ2VudGluYS9CdWVub3NfQWlyZXMnLA0KICAgICAgICAtMiAgPT4gJ0F0bGFudGljL1NvdXRoX0dlb3JnaWEnLA0KICAgICAgICAtMSAgPT4gJ0F0bGFudGljL0F6b3JlcycsDQogICAgICAgIDAgICA9PiAnVVRDJywNCiAgICAgICAgMSAgID0+ICdFdXJvcGUvQmVybGluJywNCiAgICAgICAgMiAgID0+ICdFdXJvcGUvU29maWEnLA0KICAgICAgICAzICAgPT4gJ0FmcmljYS9OYWlyb2JpJywNCiAgICAgICAgNCAgID0+ICdFdXJvcGUvTW9zY293JywNCiAgICAgICAgNSAgID0+ICdBc2lhL0thcmFjaGknLA0KICAgICAgICA2ICAgPT4gJ0FzaWEvRGhha2EnLA0KICAgICAgICA3ICAgPT4gJ0FzaWEvQmFuZ2tvaycsDQogICAgICAgIDggICA9PiAnQXNpYS9TaGFuZ2hhaScsDQogICAgICAgIDkgICA9PiAnQXNpYS9Ub2t5bycsDQogICAgICAgIDEwICA9PiAnUGFjaWZpYy9HdWFtJywNCiAgICAgICAgMTEgID0+ICdBdXN0cmFsaWEvU3lkbmV5JywNCiAgICAgICAgMTIgID0+ICdQYWNpZmljL0ZpamknLA0KICAgICAgICAxMyAgPT4gJ1BhY2lmaWMvVG9uZ2F0YXB1JywNCiAgICApOw0KICAgIGlmICghaXNzZXQoJHRpbWV6b25lc1skel0pKSB7DQogICAgICAgIHJldHVybiAnVVRDJzsNCiAgICB9DQoNCiAgICByZXR1cm4gJHRpbWV6b25lc1skel07DQp9DQoNCi8qKg0KICog5a+55pWw57uE5YaF55qE5a2X56ym5Liy6L+b6KGMaHRtbHNwZWNpYWxjaGFycy4NCiAqDQogKiBAcGFyYW0gYXJyYXkgJGFycmF5IOW+hei/h+a7pOWtl+espuS4sg0KICoNCiAqIEByZXR1cm4gYXJyYXkNCiAqDQogKiBAc2luY2UgMS40DQogKi8NCmZ1bmN0aW9uIGh0bWxzcGVjaWFsY2hhcnNfYXJyYXkoJGFycmF5KQ0Kew0KICAgICRuZXdBcnJheSA9IGFycmF5KCk7DQogICAgZm9yZWFjaCAoJGFycmF5IGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICRuZXdLZXkgPSBodG1sc3BlY2lhbGNoYXJzKCRrZXkpOw0KICAgICAgICBpZiAoaXNfYXJyYXkoJHZhbHVlKSkgew0KICAgICAgICAgICAgJG5ld0FycmF5WyRuZXdLZXldID0gaHRtbHNwZWNpYWxjaGFyc19hcnJheSgkdmFsdWUpOw0KICAgICAgICB9IGVsc2VpZiAoaXNfc3RyaW5nKCR2YWx1ZSkpIHsNCiAgICAgICAgICAgICRuZXdBcnJheVskbmV3S2V5XSA9IGh0bWxzcGVjaWFsY2hhcnMoJHZhbHVlKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHJldHVybiAkbmV3QXJyYXk7DQp9DQoNCi8qKg0KICog6I635b6X5LiA5Liq5Y+q5ZCr5pWw5a2X5a2X5q+N5ZKMLee6v+eahHN0cmluZy4NCiAqDQogKiBAcGFyYW0gc3RyaW5nICRzIOW+hei/h+a7pOWtl+espuS4sg0KICoNCiAqIEByZXR1cm4gc3RyaW5nfHN0cmluZ1tdDQogKg0KICogQHNpbmNlIDEuNA0KICovDQpmdW5jdGlvbiBGaWx0ZXJDb3JyZWN0TmFtZSgkcykNCnsNCiAgICByZXR1cm4gcHJlZ19yZXBsYWNlKCd8W14wLTlhLXpBLVpfLy1dfCcsICcnLCAkcyk7DQp9DQoNCi8qKg0KICog56Gu6K6k5LiA5Liq5a+56LGh5piv5ZCm5Y+v6KKr6L2s5o2i5Li6c3RyaW5nLg0KICoNCiAqIEBwYXJhbSBvYmplY3QgJG9iag0KICoNCiAqIEByZXR1cm4gYm9vbA0KICoNCiAqIEBzaW5jZSAxLjQNCiAqLw0KZnVuY3Rpb24gQ2hlY2tDYW5CZVN0cmluZygkb2JqKQ0Kew0KICAgIC8vIEZ1Y2sgUEhQIDUuMiEhISENCiAgICAvLyByZXR1cm4gJG9iaiA9PT0gbnVsbCB8fCBpc19zY2FsYXIoJG9iaikgfHwgaXNfY2FsbGFibGUoWyRvYmosICdfX3RvU3RyaW5nJ10pOw0KICAgIGlmIChpc19vYmplY3QoJG9iaikgJiYgbWV0aG9kX2V4aXN0cygkb2JqLCAnX190b1N0cmluZycpKSB7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIGlmIChpc19udWxsKCRvYmopKSB7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIHJldHVybiBpc19zY2FsYXIoJG9iaik7DQp9DQoNCi8qKg0KICog5p6E6YCg5bimVG9rZW7nmoTlronlhahVUkwuDQogKg0KICogQHBhcmFtIHN0cmluZyAkdXJsDQogKiBAcGFyYW0gc3RyaW5nICRhcHBJZCDlupTnlKhJRO+8jOWPr+S7peeUn+aIkOS4gOS4quW6lOeUqOS4k+WxnueahFRva2VuDQogKg0KICogQHJldHVybiBzdHJpbmcNCiAqDQogKiBAc2luY2UgMS41LjINCiAqLw0KZnVuY3Rpb24gQnVpbGRTYWZlVVJMKCR1cmwsICRhcHBJZCA9ICcnKQ0Kew0KICAgIGdsb2JhbCAkemJwOw0KICAgIGlmIChzdHJwb3MoJHVybCwgJz8nKSAhPT0gZmFsc2UpIHsNCiAgICAgICAgJHVybCAuPSAnJmNzcmZUb2tlbj0nOw0KICAgIH0gZWxzZSB7DQogICAgICAgICR1cmwgLj0gJz9jc3JmVG9rZW49JzsNCiAgICB9DQogICAgaWYgKHN1YnN0cigkdXJsLCAwLCAxKSA9PT0gJy8nKSB7DQogICAgICAgICR1cmwgPSAkemJwLT5ob3N0IC4gc3Vic3RyKCR1cmwsIDEpOw0KICAgIH0NCiAgICAkdXJsID0gJHVybCAuICR6YnAtPkdldENTUkZUb2tlbigkYXBwSWQpOw0KDQogICAgcmV0dXJuICR1cmw7DQp9DQoNCi8qKg0KICog5p6E6YCgY21kLnBocOeahOiuv+mXrumTvuaOpS4NCiAqDQogKiBAcGFyYW0gc3RyaW5nICRwYXJhbXRlcnMgY21kLnBocOWPguaVsA0KICoNCiAqIEByZXR1cm4gYm9vbA0KICoNCiAqIEBzaW5jZSAxLjUuMg0KICovDQpmdW5jdGlvbiBCdWlsZFNhZmVDbWRVUkwoJHBhcmFtdGVycykNCnsNCiAgICByZXR1cm4gQnVpbGRTYWZlVVJMKCcvemJfc3lzdGVtL2NtZC5waHA/JyAuICRwYXJhbXRlcnMpOw0KfQ0KDQpmdW5jdGlvbiB1dGY4NG1iX2ZpbHRlcigmJHNxbCkNCnsNCiAgICAkc3FsID0gcHJlZ19yZXBsYWNlX2NhbGxiYWNrKCIvW1x4ezEwMDAwfS1ceHsxMEZGRkZ9XS91IiwgJ3V0Zjg0bWJfY29udmVydFRvVUNTNCcsICRzcWwpOw0KfQ0KDQpmdW5jdGlvbiB1dGY4NG1iX2ZpeEh0bWxTcGVjaWFsQ2hhcnMoKQ0Kew0KICAgIGdsb2JhbCAkYXJ0aWNsZTsNCiAgICAkYXJ0aWNsZS0+Q29udGVudCA9IHByZWdfcmVwbGFjZV9jYWxsYmFjaygiL1wmXCN4KFswLTlBLVpdezIsNn0pXDsvdSIsICd1dGY4NG1iX2NvbnZlcnRUb1VURjgnLCAkYXJ0aWNsZS0+Q29udGVudCk7DQogICAgJGFydGljbGUtPkludHJvID0gcHJlZ19yZXBsYWNlX2NhbGxiYWNrKCIvXCZcI3goWzAtOUEtWl17Miw2fSlcOy91IiwgJ3V0Zjg0bWJfY29udmVydFRvVVRGOCcsICRhcnRpY2xlLT5JbnRybyk7DQp9DQoNCmZ1bmN0aW9uIHV0Zjg0bWJfY29udmVydFRvVUNTNCgkbWF0Y2hlcykNCnsNCiAgICByZXR1cm4gc3ByaW50ZigiJiN4JXM7IiwgbHRyaW0oc3RydG91cHBlcihiaW4yaGV4KGljb252KCdVVEYtOCcsICdVQ1MtNCcsICRtYXRjaGVzWzBdKSkpLCAiMCIpKTsNCn0NCg0KZnVuY3Rpb24gdXRmODRtYl9jb252ZXJ0VG9VVEY4KCRtYXRjaGVzKQ0Kew0KICAgIHJldHVybiBpY29udignVUNTLTQnLCAnVVRGLTgnLCBoZXgyYmluKHN0cl9wYWQoJG1hdGNoZXNbMV0sIDgsICIwIiwgU1RSX1BBRF9MRUZUKSkpOw0KfQ0KDQovKioNCiAqIOmqjOivgVdlYiBUb2tlbuaYr+WQpuWQiOazlS4NCiAqDQogKiBAcGFyYW0gJHdlYlRva2VuU3RyaW5nDQogKiBAcGFyYW0gJHdlYlRva2VuSWQNCiAqIEBwYXJhbSBzdHJpbmcgJGtleQ0KICoNCiAqIEByZXR1cm4gYm9vbA0KICovDQpmdW5jdGlvbiBWZXJpZnlXZWJUb2tlbigkd2ViVG9rZW5TdHJpbmcsICR3ZWJUb2tlbklkLCAka2V5ID0gJycpDQp7DQogICAgZ2xvYmFsICR6YnA7DQogICAgJHRpbWUgPSBzdWJzdHIoJHdlYlRva2VuU3RyaW5nLCA2NCk7DQogICAgJHd0ID0gc3Vic3RyKCR3ZWJUb2tlblN0cmluZywgMCwgNjQpOw0KICAgICRhcmdzID0gYXJyYXkoKTsNCiAgICBmb3IgKCRpID0gMzsgJGkgPCBmdW5jX251bV9hcmdzKCk7ICRpKyspIHsNCiAgICAgICAgJGFyZ3NbXSA9IGZ1bmNfZ2V0X2FyZygkaSk7DQogICAgfQ0KICAgIGlmICgka2V5ID09ICcnKSB7DQogICAgICAgICRrZXkgPSAkemJwLT5ndWlkOw0KICAgIH0NCiAgICAkc2hhID0gaGFzaF9obWFjKCdzaGEyNTYnLCAkdGltZSAuICR3ZWJUb2tlbklkIC4gaW1wbG9kZSgkYXJncyksICRrZXkpOw0KICAgIGlmICgkd3QgPT09ICRzaGEpIHsNCiAgICAgICAgaWYgKCR0aW1lID4gdGltZSgpKSB7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHJldHVybiBmYWxzZTsNCn0NCg0KLyoqDQogKiDliJvlu7pXZWIgVG9rZW4uDQogKg0KICogQHBhcmFtICR3ZWJUb2tlbklkDQogKiBAcGFyYW0gJHRpbWUNCiAqIEBwYXJhbSBzdHJpbmcgJGtleQ0KICoNCiAqIEByZXR1cm4gc3RyaW5nDQogKi8NCmZ1bmN0aW9uIENyZWF0ZVdlYlRva2VuKCR3ZWJUb2tlbklkLCAkdGltZSwgJGtleSA9ICcnKQ0Kew0KICAgIGdsb2JhbCAkemJwOw0KICAgICR0aW1lID0gKGludCkgJHRpbWU7DQogICAgJGFyZ3MgPSBhcnJheSgpOw0KICAgIGZvciAoJGkgPSAzOyAkaSA8IGZ1bmNfbnVtX2FyZ3MoKTsgJGkrKykgew0KICAgICAgICAkYXJnc1tdID0gZnVuY19nZXRfYXJnKCRpKTsNCiAgICB9DQogICAgaWYgKCRrZXkgPT0gJycpIHsNCiAgICAgICAgJGtleSA9ICR6YnAtPmd1aWQ7DQogICAgfQ0KDQogICAgcmV0dXJuIGhhc2hfaG1hYygnc2hhMjU2JywgJHRpbWUgLiAkd2ViVG9rZW5JZCAuIGltcGxvZGUoJGFyZ3MpLCAka2V5KSAuICR0aW1lOw0KfQ0KDQovKioNCiAqIOajgOa1i+adpea6kOaYr+WQpuWQiOazle+8jOi/meWMheaLrENTUkbmo4DmtYvvvIzlnKjlvIDlkK/lop7lvLrlronlhajmqKHlvI/ml7bliqDlhaXmnaXmupDmo4DmtYsuDQogKg0KICogQHRocm93cyBFeGNlcHRpb24NCiAqLw0KZnVuY3Rpb24gQ2hlY2tJc1JlZmVyZXJWYWxpZCgpDQp7DQogICAgZ2xvYmFsICR6YnA7DQogICAgJGZsYWcgPSBDaGVja0NTUkZUb2tlblZhbGlkKCk7DQogICAgaWYgKCRmbGFnICYmICR6YnAtPm9wdGlvblsnWkNfQURESVRJT05BTF9TRUNVUklUWSddKSB7DQogICAgICAgICRmbGFnID0gQ2hlY2tIVFRQUmVmZXJlclZhbGlkKCk7DQogICAgfQ0KDQogICAgaWYgKCEkZmxhZykgew0KICAgICAgICAkemJwLT5TaG93RXJyb3IoNSwgX19GSUxFX18sIF9fTElORV9fKTsNCiAgICAgICAgZXhpdDsNCiAgICB9DQp9DQoNCi8qKg0KICog6aqM6K+BQ1NSRiBUb2tlbuaYr+WQpuWQiOazlS4NCiAqDQogKiBAcGFyYW0gc3RyaW5nICRmaWVsZE5hbWUNCiAqIEBwYXJhbSBhcnJheSAgJG1ldGhvZHMNCiAqDQogKiBAcmV0dXJuIGJvb2wNCiAqLw0KZnVuY3Rpb24gQ2hlY2tDU1JGVG9rZW5WYWxpZCgkZmllbGROYW1lID0gJ2NzcmZUb2tlbicsICRtZXRob2RzID0gYXJyYXkoJ2dldCcsICdwb3N0JykpDQp7DQogICAgZ2xvYmFsICR6YnA7DQogICAgJGZsYWcgPSBmYWxzZTsNCiAgICBpZiAoaXNfc3RyaW5nKCRtZXRob2RzKSkgew0KICAgICAgICAkbWV0aG9kcyA9IGFycmF5KCRtZXRob2RzKTsNCiAgICB9DQogICAgZm9yZWFjaCAoJG1ldGhvZHMgYXMgJG1ldGhvZCkgew0KICAgICAgICBpZiAoJHpicC0+VmVyaWZ5Q1NSRlRva2VuKEdldFZhcnMoJGZpZWxkTmFtZSwgJG1ldGhvZCkpKSB7DQogICAgICAgICAgICAkZmxhZyA9IHRydWU7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHJldHVybiAkZmxhZzsNCn0NCg0KLyoqDQogKiDmo4DmtYtIVFRQIFJlZmVyZXLmmK/lkKblkIjms5UuDQogKg0KICogQHJldHVybiBib29sDQogKi8NCmZ1bmN0aW9uIENoZWNrSFRUUFJlZmVyZXJWYWxpZCgpDQp7DQogICAgZ2xvYmFsICRibG9naG9zdDsNCiAgICAkcmVmZXJlciA9IEdldFZhcnMoJ0hUVFBfUkVGRVJFUicsICdTRVJWRVInKTsNCiAgICBpZiAodHJpbSgkcmVmZXJlcikgPT09ICcnKSB7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCiAgICAkcyA9ICRibG9naG9zdDsNCiAgICAkcyA9IHN0cl9yZXBsYWNlKCc6ODAvJywgJy8nLCAkcyk7DQogICAgJHMgPSBzdHJfcmVwbGFjZSgnOjQ0My8nLCAnLycsICRzKTsNCiAgICBpZiAoc3RyaXBvcygkcmVmZXJlciwgJHMpID09PSBmYWxzZSkgew0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KDQogICAgcmV0dXJuIHRydWU7DQp9DQoNCi8qKg0KICog5riF6Zmk5LiA5Liy5Luj56CB5YaF5omA5pyJ55qEUEhQ5Luj56CBDQogKg0KICogQHBhcmFtIHN0cmluZyAkY29kZQ0KICoNCiAqIEByZXR1cm4gc3RyaW5nDQogKi8NCmZ1bmN0aW9uIFJlbW92ZVBIUENvZGUoJGNvZGUpDQp7DQogICAgLy8gUEhQIFN0YXJ0IHRhZ3M6IDw/cGhwIDw/IDw/PQ0KICAgIC8vIFBIUCA1IHN1cHBvcnRzOiA8JSA8c2NyaXB0IGxhbmd1YWdlPSJwaHAiPg0KICAgIC8vIERlcGVuZHMgb24gUEhQDQogICAgJGNvbnRpbnVlID0gdHJ1ZTsNCiAgICB3aGlsZSAoJGNvbnRpbnVlKSB7DQogICAgICAgICR0b2tlbnMgPSB0b2tlbl9nZXRfYWxsKCRjb2RlKTsNCiAgICAgICAgJGNvbnRpbnVlID0gZmFsc2U7DQogICAgICAgIGZvcmVhY2ggKCR0b2tlbnMgYXMgJHR0KSB7DQogICAgICAgICAgICAkbmFtZSA9IGlzX251bWVyaWMoJHR0WzBdKSA/IHRva2VuX25hbWUoJHR0WzBdKSA6ICcnOw0KICAgICAgICAgICAgaWYgKCRuYW1lID09PSAnVF9PUEVOX1RBRycgfHwgJG5hbWUgPT09ICdUX09QRU5fVEFHX1dJVEhfRUNITycgfHwgJG5hbWUgPT09ICdUX0NMT1NFX1RBRycpIHsNCiAgICAgICAgICAgICAgICAkY29kZSA9IHN0cl9yZXBsYWNlKCR0dFsxXSwgIiIsICRjb2RlKTsNCiAgICAgICAgICAgICAgICAkY29udGludWUgPSB0cnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgcmV0dXJuICRjb2RlOw0KfQ0KDQpmdW5jdGlvbiBHZXRJREFycmF5QnlMaXN0KCRhcnJheSwgJGtleW5hbWUgPSBudWxsKQ0Kew0KICAgICRpZHMgPSBhcnJheSgpOw0KICAgIGZvcmVhY2ggKCRhcnJheSBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICBpZiAoJGtleW5hbWUgPT0gbnVsbCkgew0KICAgICAgICAgICAgJGlkc1tdID0gcmVzZXQoJHZhbHVlLT5HZXREYXRhKCkpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJGEgPSAkdmFsdWUtPkdldERhdGEoKTsNCiAgICAgICAgICAgICRpZHNbXSA9ICRhWyRrZXluYW1lXTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHJldHVybiAkaWRzOw0KfQ0KDQpmdW5jdGlvbiBHZXRCYWNrZW5kQ1NQSGVhZGVyKCkNCnsNCiAgICAkZGVmYXVsdENTUCA9IGFycmF5KA0KICAgICAgICAnZGVmYXVsdC1zcmMnID0+ICInc2VsZicgZGF0YTogYmxvYjoiLA0KICAgICAgICAnaW1nLXNyYycgICAgID0+ICIqIGRhdGE6IGJsb2I6IiwNCiAgICAgICAgJ21lZGlhLXNyYycgICA9PiAiKiBkYXRhOiBibG9iOiIsDQogICAgICAgICdzY3JpcHQtc3JjJyAgPT4gIidzZWxmJyAndW5zYWZlLWlubGluZScgJ3Vuc2FmZS1ldmFsJyIsDQogICAgICAgICdzdHlsZS1zcmMnICAgPT4gIidzZWxmJyAndW5zYWZlLWlubGluZSciLA0KICAgICk7DQogICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fQ1NQX0JhY2tlbmQnXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgJGZwcmV0dXJuID0gJGZwbmFtZSgkZGVmYXVsdENTUCk7DQogICAgfQ0KICAgICRyZXQgPSBhcnJheSgpOw0KICAgIGZvcmVhY2ggKCRkZWZhdWx0Q1NQIGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICRyZXRbXSA9ICRrZXkgLiAnICcgLiAkdmFsdWU7DQogICAgfQ0KDQogICAgcmV0dXJuIGltcGxvZGUoJzsgJywgJHJldCk7DQp9DQoNCi8qKg0KICog5qOA5p+l6YeN5aSN5Yqg6L2955qELg0KICovDQpmdW5jdGlvbiBDaGVja0luY2x1ZGVkRmlsZXMoJGZpbGUpDQp7DQogICAgJGEgPSBnZXRfaW5jbHVkZWRfZmlsZXMoKTsNCiAgICAkZmlsZSA9IHN0cl9yZXBsYWNlKCdcXCcsICcvJywgJGZpbGUpOw0KICAgIGZvcmVhY2ggKCRhIGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICRhWyRrZXldID0gdHJpbShzdHJfcmVwbGFjZSgnXFwnLCAnLycsICR2YWx1ZSkpOw0KICAgIH0NCg0KICAgIHJldHVybiBpbl9hcnJheSh0cmltKCRmaWxlKSwgJGEpOw0KfQ0K</file>
	<file name='zb_system\function\lib\zblogphp.php' crc32='B154A696'  dt:dt='bin.base64'>PD9waHANCg0KaWYgKCFkZWZpbmVkKCdaQlBfUEFUSCcpKSB7DQogICAgZXhpdCgnQWNjZXNzIGRlbmllZCcpOw0KfQ0KLyoqDQogKiB6YnDlhajlsYDmk43kvZznsbsuIA0KICovDQpjbGFzcyBaQmxvZ1BIUA0Kew0KICAgIHByaXZhdGUgc3RhdGljICRfemJwID0gbnVsbDsNCiAgICAvKioNCiAgICAgKiBAdmFyIHN0cmluZyDniYjmnKzlj7cNCiAgICAgKi8NCiAgICBwdWJsaWMgJHZlcnNpb24gPSBudWxsOw0KICAgIC8qKg0KICAgICAqIEB2YXIgRGF0YWJhc2VfX0ludGVyZmFjZSDmlbDmja7lupMNCiAgICAgKi8NCiAgICBwdWJsaWMgJGRiID0gbnVsbDsNCiAgICAvKioNCiAgICAgKiBAdmFyIGFycmF5IOmFjee9rumAiemhuQ0KICAgICAqLw0KICAgIHB1YmxpYyAkb3B0aW9uID0gYXJyYXkoKTsNCiAgICAvKioNCiAgICAgKiBAdmFyIGFycmF5IOivreiogA0KICAgICAqLw0KICAgIHB1YmxpYyAkbGFuZyA9IGFycmF5KCk7DQogICAgLyoqDQogICAgICogQHZhciBqc29u57G75Z6LIOivreiogA0KICAgICAqLw0KICAgIHB1YmxpYyAkbGFuZ3MgPSBudWxsOw0KICAgIC8qKg0KICAgICAqIEB2YXIgYXJyYXkg6K+t6KiA5YyFbGlzdA0KICAgICAqLw0KICAgIHB1YmxpYyAkbGFuZ3BhY2tsaXN0ID0gYXJyYXkoKTsNCiAgICAvKioNCiAgICAgKiBAdmFyIHN0cmluZyDot6/lvoQNCiAgICAgKi8NCiAgICBwdWJsaWMgJHBhdGggPSBudWxsOw0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nIOWfn+WQjQ0KICAgICAqLw0KICAgIHB1YmxpYyAkaG9zdCA9IG51bGw7DQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcgY29va2ll5L2c55So5Z+fDQogICAgICovDQogICAgcHVibGljICRjb29raWVzcGF0aCA9IG51bGw7DQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcgZ3VpZA0KICAgICAqLw0KICAgIHB1YmxpYyAkZ3VpZCA9IG51bGw7DQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcg5b2T5YmN6ZO+5o6lDQogICAgICovDQogICAgcHVibGljICRjdXJyZW50dXJsID0gbnVsbDsNCiAgICAvKioNCiAgICAgKiBAdmFyIHN0cmluZyDlvZPliY3pk77mjqUNCiAgICAgKi8NCiAgICBwdWJsaWMgJGZ1bGxjdXJyZW50dXJsID0gbnVsbDsNCiAgICAvKioNCiAgICAgKiBAdmFyIHN0cmluZyDnlKjmiLfnm67lvZUNCiAgICAgKi8NCiAgICBwdWJsaWMgJHVzZXJzZGlyID0gbnVsbDsNCiAgICAvKioNCiAgICAgKiBAdmFyIHN0cmluZyDpqozor4HnoIHlnLDlnYANCiAgICAgKi8NCiAgICBwdWJsaWMgJHZlcmlmeUNvZGVVcmwgPSBudWxsOw0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nIOmqjOivgeeggeWcsOWdgO+8iOaLvOWGmemUmeivr++8iQ0KICAgICAqDQogICAgICogQGRlcHJlY2F0ZWQNCiAgICAgKi8NCiAgICBwdWJsaWMgJHZhbGlkY29kZXVybCA9IG51bGw7DQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcNCiAgICAgKi8NCiAgICBwdWJsaWMgJGZlZWR1cmwgPSBudWxsOw0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nDQogICAgICovDQogICAgcHVibGljICRzZWFyY2h1cmwgPSBudWxsOw0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nDQogICAgICovDQogICAgcHVibGljICRhamF4dXJsID0gbnVsbDsNCiAgICAvKioNCiAgICAgKiBAdmFyIHN0cmluZw0KICAgICAqLw0KICAgIHB1YmxpYyAkeG1scnBjdXJsID0gbnVsbDsNCiAgICAvKioNCiAgICAgKiBAdmFyIE1lbWJlcltdIOeUqOaIt+aVsOe7hA0KICAgICAqLw0KICAgIHB1YmxpYyAkbWVtYmVycyA9IGFycmF5KCk7DQogICAgLyoqDQogICAgICogQHZhciBNZW1iZXJbXSDnlKjmiLfmlbDnu4TvvIjku6XnlKjmiLflkI3kuLrplK7vvIkNCiAgICAgKi8NCiAgICBwdWJsaWMgJG1lbWJlcnNieW5hbWUgPSBhcnJheSgpOw0KICAgIC8qKg0KICAgICAqIEB2YXIgQ2F0ZWdvcnlbXSDliIbnsbvmlbDnu4QNCiAgICAgKi8NCiAgICBwdWJsaWMgJGNhdGVnb3J5cyA9IGFycmF5KCk7DQogICAgcHVibGljICRjYXRlZ29yaWVzID0gbnVsbDsNCiAgICAvKioNCiAgICAgKiBAdmFyIENhdGVnb3J5W10g5YiG57G75pWw57uE77yI5bey5o6S5bqP77yJDQogICAgICovDQogICAgcHVibGljICRjYXRlZ29yeXNieW9yZGVyID0gYXJyYXkoKTsNCiAgICBwdWJsaWMgJGNhdGVnb3JpZXNieW9yZGVyID0gbnVsbDsNCiAgICAvKioNCiAgICAgKiBAdmFyIE1vZHVsZVtdIOaooeWdl+aVsOe7hA0KICAgICAqLw0KICAgIHB1YmxpYyAkbW9kdWxlcyA9IGFycmF5KCk7DQogICAgLyoqDQogICAgICogQHZhciBNb2R1bGVbXSDmqKHlnZfmlbDnu4TvvIjku6Xmlofku7blkI3kuLrplK7vvIkNCiAgICAgKi8NCiAgICBwdWJsaWMgJG1vZHVsZXNieWZpbGVuYW1lID0gYXJyYXkoKTsNCiAgICAvKioNCiAgICAgKiBAdmFyIENvbmZpZ1tdIOmFjee9rumAiemhuQ0KICAgICAqLw0KICAgIHB1YmxpYyAkY29uZmlncyA9IGFycmF5KCk7DQogICAgLyoqDQogICAgICogQHZhciBUYWdbXSDmoIfnrb7mlbDnu4QNCiAgICAgKi8NCiAgICBwdWJsaWMgJHRhZ3MgPSBhcnJheSgpOw0KICAgIC8qKg0KICAgICAqIEB2YXIgVGFnW10g5qCH562+5pWw57uE77yI5Lul5qCH562+5ZCN5Li66ZSu77yJDQogICAgICovDQogICAgcHVibGljICR0YWdzYnluYW1lID0gYXJyYXkoKTsNCiAgICAvKioNCiAgICAgKiBAdmFyIENvbW1lbnRbXSDor4TorrrmlbDnu4QNCiAgICAgKi8NCiAgICBwdWJsaWMgJGNvbW1lbnRzID0gYXJyYXkoKTsNCiAgICAvKioNCiAgICAgKiBAdmFyIFBvc3RbXSDmlofnq6DliJfooajmlbDnu4QNCiAgICAgKi8NCiAgICBwdWJsaWMgJHBvc3RzID0gYXJyYXkoKTsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nIOW9k+WJjemhtemdouagh+mimA0KICAgICAqLw0KICAgIHB1YmxpYyAkdGl0bGUgPSBudWxsOw0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nIOe9keermeWQjQ0KICAgICAqLw0KICAgIHB1YmxpYyAkbmFtZSA9IG51bGw7DQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcg572R56uZ5a2Q5qCH6aKYDQogICAgICovDQogICAgcHVibGljICRzdWJuYW1lID0gbnVsbDsNCiAgICAvKioNCiAgICAgKiBAdmFyIEFwcCDlvZPliY3kuLvpopgNCiAgICAgKi8NCiAgICBwdWJsaWMgJHRoZW1lID0gbnVsbDsNCiAgICAvKioNCiAgICAgKiBAdmFyIGFycmF5KCkg5b2T5YmN5Li76aKY54mI5pys5L+h5oGvDQogICAgICovDQogICAgcHVibGljICR0aGVtZWluZm8gPSBhcnJheSgpOw0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nIOW9k+WJjeS4u+mimOmjjuagvA0KICAgICAqLw0KICAgIHB1YmxpYyAkc3R5bGUgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBNZW1iZXIg5b2T5YmN55So5oi3DQogICAgICovDQogICAgcHVibGljICR1c2VyID0gbnVsbDsNCiAgICAvKioNCiAgICAgKiBAdmFyIENvbmZpZyDnvJPlrZgNCiAgICAgKi8NCiAgICBwdWJsaWMgJGNhY2hlID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgYXJyYXl8bnVsbCDmlbDmja7ooagNCiAgICAgKi8NCiAgICBwdWJsaWMgJHRhYmxlID0gbnVsbDsNCiAgICAvKioNCiAgICAgKiBAdmFyIGFycmF5fG51bGwg5pWw5o2u6KGo5L+h5oGvDQogICAgICovDQogICAgcHVibGljICRkYXRhaW5mbyA9IG51bGw7DQogICAgLyoqDQogICAgICogQHZhciBhcnJheXxudWxsIOexu+Wei+W6j+WIlw0KICAgICAqLw0KICAgIHB1YmxpYyAkcG9zdHR5cGUgPSBudWxsOw0KICAgIC8qKg0KICAgICAqIEB2YXIgYXJyYXl8bnVsbCDmk43kvZzliJfooagNCiAgICAgKi8NCiAgICBwdWJsaWMgJGFjdGlvbnMgPSBudWxsOw0KICAgIC8qKg0KICAgICAqIEB2YXIgbWl4ZWR8bnVsbHxzdHJpbmcg5b2T5YmN5pON5L2cDQogICAgICovDQogICAgcHVibGljICRhY3Rpb24gPSBudWxsOw0KDQogICAgcHJpdmF0ZSAkaXNpbml0aWFsaXplZCA9IGZhbHNlOyAvL+aYr+WQpuWIneWni+WMluaIkOWKnw0KICAgIHByaXZhdGUgJGlzY29ubmVjdGVkID0gZmFsc2U7IC8v5piv5ZCm6L+e5o6l5oiQ5YqfDQogICAgcHJpdmF0ZSAkaXNsb2FkID0gZmFsc2U7IC8v5piv5ZCm6L295YWlDQogICAgcHJpdmF0ZSAkaXNzZXNzaW9uID0gZmFsc2U7IC8v5piv5ZCm5L2/55Soc2Vzc2lvbg0KICAgIHB1YmxpYyAkaXNtYW5hZ2UgPSBmYWxzZTsgLy/mmK/lkKbliqDovb3nrqHnkIbmqKHlvI8NCiAgICBwcml2YXRlICRpc0d6aXAgPSBmYWxzZTsgLy/mmK/lkKblvIDlkK9nemlwDQogICAgcHVibGljICRpc0h0dHBzID0gZmFsc2U7IC8v5piv5ZCmSFRUUFMNCiAgICBwdWJsaWMgJGlzY21kID0gZmFsc2U7IC8v5piv5ZCm5Yqg6L29Q01E5qih5byPDQogICAgcHVibGljICRpc2FqYXggPSBmYWxzZTsgLy/mmK/lkKbliqDovb1BSkFY5qih5byPDQoNCiAgICAvKioNCiAgICAgKiBAdmFyIFRlbXBsYXRlIOW9k+WJjeaooeadvw0KICAgICAqLw0KICAgIHB1YmxpYyAkdGVtcGxhdGUgPSBudWxsOw0KICAgIC8qKg0KICAgICAqIEB2YXIgbnVsbCDnpL7kvJrljJbor4TorroNCiAgICAgKi8NCiAgICBwdWJsaWMgJHNvY2lhbGNvbW1lbnQgPSBudWxsOw0KICAgIC8qKg0KICAgICAqIEB2YXIgbnVsbCDmqKHmnb/lpLTpg6gNCiAgICAgKi8NCiAgICBwdWJsaWMgJGhlYWRlciA9IG51bGw7DQogICAgLyoqDQogICAgICogQHZhciBudWxsIOaooeadv+WwvumDqA0KICAgICAqLw0KICAgIHB1YmxpYyAkZm9vdGVyID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgYXJyYXkg5r+A5rS755qE5o+S5Lu25YiX6KGoDQogICAgICovDQogICAgcHVibGljICRhY3RpdmVkYXBwcyA9IGFycmF5KCk7DQogICAgcHVibGljICRhY3RpdmVhcHBzOw0KDQogICAgLyoqDQogICAgICogQHZhciBpbnQg566h55CG6aG16Z2i5pi+56S65p2h5pWwDQogICAgICovDQogICAgcHVibGljICRtYW5hZ2Vjb3VudCA9IDUwOw0KICAgIC8qKg0KICAgICAqIEB2YXIgaW50IOmhteeggeaYvuekuuadoeaVsA0KICAgICAqLw0KICAgIHB1YmxpYyAkcGFnZWJhcmNvdW50ID0gMTA7DQogICAgLyoqDQogICAgICogQHZhciBpbnQg5pCc57Si6L+U5Zue5p2h5pWwDQogICAgICovDQogICAgcHVibGljICRzZWFyY2hjb3VudCA9IDEwOw0KICAgIC8qKg0KICAgICAqIEB2YXIgaW50IOaWh+eroOWIl+ihqOaYvuekuuadoeaVsA0KICAgICAqLw0KICAgIHB1YmxpYyAkZGlzcGxheWNvdW50ID0gMTA7DQogICAgLyoqDQogICAgICogQHZhciBpbnQg6K+E6K665pi+56S65pWw6YePDQogICAgICovDQogICAgcHVibGljICRjb21tZW50ZGlzcGxheWNvdW50ID0gMTA7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIGludCDlvZPliY3lrp7kvovkuItDU1JGIFRva2Vu6L+H5pyf5pe26Ze077yI5bCP5pe277yJDQogICAgICovDQogICAgcHVibGljICRjc3JmRXhwaXJhdGlvbiA9IDE7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIEFwcCDlvZPliY3kuLvpopjnsbsNCiAgICAgKi8NCiAgICBwdWJsaWMgJHRoZW1lYXBwID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIOiOt+WPluWUr+S4gOWunuS+iy4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gbnVsbHxaQmxvZ1BIUA0KICAgICAqLw0KICAgIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gR2V0SW5zdGFuY2UoKQ0KICAgIHsNCiAgICAgICAgaWYgKCFpc3NldChzZWxmOjokX3picCkpIHsNCiAgICAgICAgICAgIGlmIChpc3NldCgkR0xPQkFMU1snb3B0aW9uJ11bJ1pDX0dPRFpCUF9GSUxFJ10pICYmIGlzc2V0KCRHTE9CQUxTWydvcHRpb24nXVsnWkNfR09EWkJQX05BTUUnXSkgJiYgaXNfcmVhZGFibGUoWkJQX1BBVEggLiAkR0xPQkFMU1snb3B0aW9uJ11bJ1pDX0dPRFpCUF9GSUxFJ10pKSB7DQogICAgICAgICAgICAgICAgcmVxdWlyZSBaQlBfUEFUSCAuICRHTE9CQUxTWydvcHRpb24nXVsnWkNfR09EWkJQX0ZJTEUnXTsNCiAgICAgICAgICAgICAgICBzZWxmOjokX3picCA9IG5ldyAkR0xPQkFMU1snb3B0aW9uJ11bJ1pDX0dPRFpCUF9OQU1FJ10oKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgc2VsZjo6JF96YnAgPSBuZXcgc2VsZigpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIHNlbGY6OiRfemJwOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWIneWni+WMluaVsOaNruW6k+i/nuaOpS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHR5cGUg5pWw5o2u6L+e5o6l57G75Z6LDQogICAgICoNCiAgICAgKiBAcmV0dXJuIERhdGFiYXNlX19JbnRlcmZhY2UNCiAgICAgKi8NCiAgICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIEluaXRpYWxpemVEQigkdHlwZSkNCiAgICB7DQogICAgICAgIGlmICghdHJpbSgkdHlwZSkpIHsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KDQogICAgICAgICRuZXd0eXBlID0gJ0RhdGFiYXNlX18nIC4gdHJpbSgkdHlwZSk7DQoNCiAgICAgICAgcmV0dXJuIG5ldyAkbmV3dHlwZSgpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOaehOmAoOWHveaVsO+8jOWKoOi9veWfuuacrOmFjee9ruWIsCR6YnAuDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIF9fY29uc3RydWN0KCkNCiAgICB7DQogICAgICAgIGdsb2JhbCAkb3B0aW9uLCAkbGFuZywgJGxhbmdzLCAkYmxvZ3BhdGgsICRibG9naG9zdCwgJGNvb2tpZXNwYXRoLCAkdXNlcnNkaXIsICR0YWJsZSwNCiAgICAgICAgJGRhdGFpbmZvLCAkYWN0aW9ucywgJGFjdGlvbiwgJGJsb2d2ZXJzaW9uLCAkYmxvZ3RpdGxlLCAkYmxvZ25hbWUsICRibG9nc3VibmFtZSwNCiAgICAgICAgJGJsb2d0aGVtZSwgJGJsb2dzdHlsZSwgJGN1cnJlbnR1cmwsICRhY3RpdmVkYXBwcywgJHBvc3R0eXBlOw0KDQogICAgICAgIGlmIChaQlBfSE9PS0VSUk9SKSB7DQogICAgICAgICAgICBaQmxvZ0V4Y2VwdGlvbjo6U2V0RXJyb3JIb29rKCk7DQogICAgICAgIH0NCg0KICAgICAgICAvL+WfuuacrOmFjee9ruWKoOi9veWIsCR6YnDlhoUNCiAgICAgICAgJHRoaXMtPnZlcnNpb24gPSAmJGJsb2d2ZXJzaW9uOw0KICAgICAgICAkdGhpcy0+b3B0aW9uID0gJiRvcHRpb247DQogICAgICAgICR0aGlzLT5sYW5nID0gJiRsYW5nOw0KICAgICAgICAkdGhpcy0+bGFuZ3MgPSAmJGxhbmdzOw0KICAgICAgICAkdGhpcy0+cGF0aCA9ICYkYmxvZ3BhdGg7DQogICAgICAgICR0aGlzLT5ob3N0ID0gJiRibG9naG9zdDsgLy/mraTlgLzlnKjlkI7ovrnliJ3lp4vljJbml7blj6/og73kvJrlj5jljJYhDQogICAgICAgICR0aGlzLT5jb29raWVzcGF0aCA9ICYkY29va2llc3BhdGg7DQogICAgICAgICR0aGlzLT51c2Vyc2RpciA9ICYkdXNlcnNkaXI7DQoNCiAgICAgICAgJHRoaXMtPnRhYmxlID0gJiR0YWJsZTsNCiAgICAgICAgJHRoaXMtPmRhdGFpbmZvID0gJiRkYXRhaW5mbzsNCiAgICAgICAgJHRoaXMtPmFjdGlvbnMgPSAmJGFjdGlvbnM7DQogICAgICAgICR0aGlzLT5wb3N0dHlwZSA9ICYkcG9zdHR5cGU7DQogICAgICAgICR0aGlzLT5jdXJyZW50dXJsID0gJiRjdXJyZW50dXJsOw0KDQogICAgICAgICR0aGlzLT5hY3Rpb24gPSAmJGFjdGlvbjsNCiAgICAgICAgJHRoaXMtPmFjdGl2ZWRhcHBzID0gJiRhY3RpdmVkYXBwczsNCiAgICAgICAgJHRoaXMtPmFjdGl2ZWFwcHMgPSAmJHRoaXMtPmFjdGl2ZWRhcHBzOw0KDQogICAgICAgICR0aGlzLT5ndWlkID0gJiR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfQ0xTSUQnXTsNCg0KICAgICAgICAkdGhpcy0+dGl0bGUgPSAmJGJsb2d0aXRsZTsNCiAgICAgICAgJHRoaXMtPm5hbWUgPSAmJGJsb2duYW1lOw0KICAgICAgICAkdGhpcy0+c3VibmFtZSA9ICYkYmxvZ3N1Ym5hbWU7DQogICAgICAgICR0aGlzLT50aGVtZSA9ICYkYmxvZ3RoZW1lOw0KICAgICAgICAkdGhpcy0+c3R5bGUgPSAmJGJsb2dzdHlsZTsNCg0KICAgICAgICAkdGhpcy0+bWFuYWdlY291bnQgPSAmJHRoaXMtPm9wdGlvblsnWkNfTUFOQUdFX0NPVU5UJ107DQogICAgICAgICR0aGlzLT5wYWdlYmFyY291bnQgPSAmJHRoaXMtPm9wdGlvblsnWkNfUEFHRUJBUl9DT1VOVCddOw0KICAgICAgICAkdGhpcy0+c2VhcmNoY291bnQgPSAmJHRoaXMtPm9wdGlvblsnWkNfU0VBUkNIX0NPVU5UJ107DQogICAgICAgICR0aGlzLT5kaXNwbGF5Y291bnQgPSAmJHRoaXMtPm9wdGlvblsnWkNfRElTUExBWV9DT1VOVCddOw0KICAgICAgICAkdGhpcy0+Y29tbWVudGRpc3BsYXljb3VudCA9ICYkdGhpcy0+b3B0aW9uWydaQ19DT01NRU5UU19ESVNQTEFZX0NPVU5UJ107DQoNCiAgICAgICAgJHRoaXMtPmNhdGVnb3JpZXMgPSAmJHRoaXMtPmNhdGVnb3J5czsNCiAgICAgICAgJHRoaXMtPmNhdGVnb3JpZXNieW9yZGVyID0gJiR0aGlzLT5jYXRlZ29yeXNieW9yZGVyOw0KDQogICAgICAgICR0aGlzLT51c2VyID0gbmV3IHN0ZENsYXNzKCk7DQogICAgICAgIGZvcmVhY2ggKCR0aGlzLT5kYXRhaW5mb1snTWVtYmVyJ10gYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgICAgICR0aGlzLT51c2VyLT4ka2V5ID0gJHZhbHVlWzNdOw0KICAgICAgICB9DQogICAgICAgICR0aGlzLT51c2VyLT5NZXRhcyA9IG5ldyBNZXRhcygpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAq5p6Q5p6E5Ye95pWw77yM6YeK5pS+6LWE5rqQLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBfX2Rlc3RydWN0KCkNCiAgICB7DQogICAgICAgICR0aGlzLT5UZXJtaW5hdGUoKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBAYXBpIEZpbHRlcl9QbHVnaW5fWmJwX0NhbGwNCiAgICAgKg0KICAgICAqIEBwYXJhbSAkbWV0aG9kDQogICAgICogQHBhcmFtICRhcmdzDQogICAgICoNCiAgICAgKiBAcmV0dXJuIG1peGVkDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIF9fY2FsbCgkbWV0aG9kLCAkYXJncykNCiAgICB7DQogICAgICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1picF9DYWxsJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICAgICAkZnByZXR1cm4gPSAkZnBuYW1lKCRtZXRob2QsICRhcmdzKTsNCiAgICAgICAgICAgIGlmICgkZnBzaWduYWwgPT0gUExVR0lOX0VYSVRTSUdOQUxfUkVUVVJOKSB7DQogICAgICAgICAgICAgICAgJGZwc2lnbmFsID0gUExVR0lOX0VYSVRTSUdOQUxfTk9ORTsNCg0KICAgICAgICAgICAgICAgIHJldHVybiAkZnByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgdHJpZ2dlcl9lcnJvcigkdGhpcy0+bGFuZ1snZXJyb3InXVs4MV0sIEVfVVNFUl9XQVJOSU5HKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDorr7nva7lj4LmlbDlgLwNCiAgICAgKg0KICAgICAqIEBwYXJhbSAkbmFtZQ0KICAgICAqIEBwYXJhbSAkdmFsdWUNCiAgICAgKg0KICAgICAqIEByZXR1cm4gbWl4ZWQNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gX19zZXQoJG5hbWUsICR2YWx1ZSkNCiAgICB7DQogICAgICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1picF9TZXQnXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgICAgICRmcHJldHVybiA9ICRmcG5hbWUoJG5hbWUsICR2YWx1ZSk7DQogICAgICAgICAgICBpZiAoJGZwc2lnbmFsID09IFBMVUdJTl9FWElUU0lHTkFMX1JFVFVSTikgew0KICAgICAgICAgICAgICAgICRmcHNpZ25hbCA9IFBMVUdJTl9FWElUU0lHTkFMX05PTkU7DQoNCiAgICAgICAgICAgICAgICByZXR1cm4gJGZwcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHRyaWdnZXJfZXJyb3IoJHRoaXMtPmxhbmdbJ2Vycm9yJ11bODFdLCBFX1VTRVJfV0FSTklORyk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6I635Y+W5Y+C5pWw5YC8DQogICAgICoNCiAgICAgKiBAcGFyYW0gJG5hbWUNCiAgICAgKg0KICAgICAqIEByZXR1cm4gbWl4ZWQNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gX19nZXQoJG5hbWUpDQogICAgew0KICAgICAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9aYnBfR2V0J10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICAgICAkZnByZXR1cm4gPSAkZnBuYW1lKCRuYW1lKTsNCiAgICAgICAgICAgIGlmICgkZnBzaWduYWwgPT0gUExVR0lOX0VYSVRTSUdOQUxfUkVUVVJOKSB7DQogICAgICAgICAgICAgICAgJGZwc2lnbmFsID0gUExVR0lOX0VYSVRTSUdOQUxfTk9ORTsNCg0KICAgICAgICAgICAgICAgIHJldHVybiAkZnByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgdHJpZ2dlcl9lcnJvcigkdGhpcy0+bGFuZ1snZXJyb3InXVs4MV0sIEVfVVNFUl9XQVJOSU5HKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDliJ3lp4vljJYkemJwLg0KICAgICAqDQogICAgICogQHRocm93cyBFeGNlcHRpb24NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBJbml0aWFsaXplKCkNCiAgICB7DQogICAgICAgICRvbGRab25lID0gJHRoaXMtPm9wdGlvblsnWkNfVElNRV9aT05FX05BTUUnXTsNCiAgICAgICAgZGF0ZV9kZWZhdWx0X3RpbWV6b25lX3NldCgkb2xkWm9uZSk7DQoNCiAgICAgICAgJG9sZExhbmcgPSAkdGhpcy0+b3B0aW9uWydaQ19CTE9HX0xBTkdVQUdFUEFDSyddOw0KICAgICAgICAkdGhpcy0+TG9hZExhbmd1YWdlKCdzeXN0ZW0nLCAnJyk7DQoNCiAgICAgICAgaWYgKCR0aGlzLT5vcHRpb25bJ1pDX0NMT1NFX1dIT0xFX1NJVEUnXSA9PSB0cnVlKSB7DQogICAgICAgICAgICBIdHRwNTAzKCk7DQogICAgICAgICAgICAkdGhpcy0+U2hvd0Vycm9yKDgyLCBfX0ZJTEVfXywgX19MSU5FX18pOw0KDQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoISR0aGlzLT5PcGVuQ29ubmVjdCgpKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCg0KICAgICAgICAkdGhpcy0+Q29udmVydFRhYmxlQW5kRGF0YWluZm8oKTsNCg0KICAgICAgICAkdGhpcy0+TG9hZENvbmZpZ3NPbmx5U3lzdGVtKHRydWUpOw0KICAgICAgICAkdGhpcy0+TG9hZE9wdGlvbigpOw0KDQogICAgICAgICR0aGlzLT5SZWdQb3N0VHlwZSgwLCAnYXJ0aWNsZScsICR0aGlzLT5vcHRpb25bJ1pDX0FSVElDTEVfUkVHRVgnXSwgJHRoaXMtPm9wdGlvblsnWkNfUE9TVF9ERUZBVUxUX1RFTVBMQVRFJ10sIDAsIDApOw0KICAgICAgICAkdGhpcy0+UmVnUG9zdFR5cGUoMSwgJ3BhZ2UnLCAkdGhpcy0+b3B0aW9uWydaQ19QQUdFX1JFR0VYJ10sICR0aGlzLT5vcHRpb25bJ1pDX1BPU1RfREVGQVVMVF9URU1QTEFURSddLCBudWxsLCBudWxsKTsNCg0KICAgICAgICBpZiAoJHRoaXMtPm9wdGlvblsnWkNfQkxPR19MQU5HVUFHRVBBQ0snXSA9PT0gJ1NpbXBDaGluZXNlJykgew0KICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfQkxPR19MQU5HVUFHRVBBQ0snXSA9ICd6aC1jbic7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoJHRoaXMtPm9wdGlvblsnWkNfQkxPR19MQU5HVUFHRVBBQ0snXSA9PT0gJ1RyYWRDaGluZXNlJykgew0KICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfQkxPR19MQU5HVUFHRVBBQ0snXSA9ICd6aC10dyc7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoJG9sZExhbmcgIT0gJHRoaXMtPm9wdGlvblsnWkNfQkxPR19MQU5HVUFHRVBBQ0snXSkgew0KICAgICAgICAgICAgJHRoaXMtPkxvYWRMYW5ndWFnZSgnc3lzdGVtJywgJycpOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKGlzc2V0KCR0aGlzLT5vcHRpb25bJ1pDX0RFQlVHX01PREVfV0FSTklORyddKSkgew0KICAgICAgICAgICAgWkJsb2dFeGNlcHRpb246OiRpc3dhcm5pbmcgPSAoYm9vbCkgJHRoaXMtPm9wdGlvblsnWkNfREVCVUdfTU9ERV9XQVJOSU5HJ107DQogICAgICAgIH0NCiAgICAgICAgaWYgKGlzc2V0KCR0aGlzLT5vcHRpb25bJ1pDX0RFQlVHX01PREVfU1RSSUNUJ10pKSB7DQogICAgICAgICAgICBaQmxvZ0V4Y2VwdGlvbjo6JGlzc3RyaWN0ID0gKGJvb2wpICR0aGlzLT5vcHRpb25bJ1pDX0RFQlVHX01PREVfU1RSSUNUJ107DQogICAgICAgIH0NCiAgICAgICAgaWYgKGlzc2V0KCR0aGlzLT5vcHRpb25bJ1pDX0RFQlVHX0xPR19FUlJPUiddKSkgew0KICAgICAgICAgICAgWkJsb2dFeGNlcHRpb246OiRpc2xvZ2Vycm9yID0gKGJvb2wpICR0aGlzLT5vcHRpb25bJ1pDX0RFQlVHX0xPR19FUlJPUiddOw0KICAgICAgICB9DQoNCiAgICAgICAgLy9aQ19QRVJNQU5FTlRfRE9NQUlOX1dIT0xFX0RJU0FCTEXkuI3lrZjlnKgg5oiW5pivIFpDX1BFUk1BTkVOVF9ET01BSU5fV0hPTEVfRElTQUJMReWtmOWcqOS9huS4uuWBhw0KICAgICAgICAkZG9tYWluX2Rpc2FibGUgPSBHZXRWYWx1ZUluQXJyYXkoJHRoaXMtPm9wdGlvbiwnWkNfUEVSTUFORU5UX0RPTUFJTl9XSE9MRV9ESVNBQkxFJyk7DQogICAgICAgIGlmICgkZG9tYWluX2Rpc2FibGUgPT0gZmFsc2UpIHsNCiAgICAgICAgICAgIC8v5aaC5p6cWkNfUEVSTUFORU5UX0RPTUFJTl9GT1JDRURfVVJM5a2Y5ZyoIOS4lOS4jeS4uuepug0KICAgICAgICAgICAgJGZvcmNlZF91cmwgPSBHZXRWYWx1ZUluQXJyYXkoJHRoaXMtPm9wdGlvbiwnWkNfUEVSTUFORU5UX0RPTUFJTl9GT1JDRURfVVJMJyk7DQogICAgICAgICAgICBpZiAoJGZvcmNlZF91cmwgIT0gJycpew0KICAgICAgICAgICAgICAgICR0aGlzLT5ob3N0ID0gKHN0cmluZykgJGZvcmNlZF91cmw7DQogICAgICAgICAgICAgICAgJHRoaXMtPmNvb2tpZXNwYXRoID0gc3Ryc3RyKHN0cl9yZXBsYWNlKCc6Ly8nLCAnJywgJHRoaXMtPmhvc3QpLCAnLycpOw0KICAgICAgICAgICAgLy/lpoLmnpxaQ19QRVJNQU5FTlRfRE9NQUlOX0VOQUJMReW3suW8gOWQr+eahOivnQ0KICAgICAgICAgICAgfWVsc2VpZiAoJHRoaXMtPm9wdGlvblsnWkNfUEVSTUFORU5UX0RPTUFJTl9FTkFCTEUnXSA9PSB0cnVlKSB7DQogICAgICAgICAgICAgICAgJHRoaXMtPmhvc3QgPSAkdGhpcy0+b3B0aW9uWydaQ19CTE9HX0hPU1QnXTsNCiAgICAgICAgICAgICAgICAkdGhpcy0+Y29va2llc3BhdGggPSBzdHJzdHIoc3RyX3JlcGxhY2UoJzovLycsICcnLCAkdGhpcy0+aG9zdCksICcvJyk7DQogICAgICAgICAgICAvL+m7mOiupOiHquWKqOivhuWIq+Wfn+WQjQ0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19CTE9HX0hPU1QnXSA9ICR0aGlzLT5ob3N0Ow0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfQkxPR19IT1NUJ10gPSAkdGhpcy0+aG9zdDsNCiAgICAgICAgfQ0KDQogICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfUFJPRFVDVCddID0gJ1otQmxvZ1BIUCc7DQogICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfVkVSU0lPTiddID0gWkNfQkxPR19WRVJTSU9OOw0KICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19OT1dfVkVSU0lPTiddID0gJHRoaXMtPnZlcnNpb247ICAvL1pDX0xBU1RfVkVSU0lPTg0KICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19CTE9HX1BST0RVQ1RfRlVMTCddID0gJHRoaXMtPm9wdGlvblsnWkNfQkxPR19QUk9EVUNUJ10gLiAnICcgLiBaQ19WRVJTSU9OX0RJU1BMQVk7DQogICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfUFJPRFVDVF9GVUxMSFRNTCddID0gJzxhIGhyZWY9Imh0dHBzOi8vd3d3LnpibG9nY24uY29tLyIgdGl0bGU9IlotQmxvZ1BIUCAnIC4gWkNfQkxPR19WRVJTSU9OIC4gJyIgdGFyZ2V0PSJfYmxhbmsiPicgLiAkdGhpcy0+b3B0aW9uWydaQ19CTE9HX1BST0RVQ1RfRlVMTCddIC4gJzwvYT4nOw0KICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19CTE9HX1BST0RVQ1RfSFRNTCddID0gJzxhIGhyZWY9Imh0dHBzOi8vd3d3LnpibG9nY24uY29tLyIgdGl0bGU9IlotQmxvZ1BIUCAnIC4gWkNfQkxPR19WRVJTSU9OIC4gJyIgdGFyZ2V0PSJfYmxhbmsiPicgLiAkdGhpcy0+b3B0aW9uWydaQ19CTE9HX1BST0RVQ1QnXSAuICc8L2E+JzsNCg0KICAgICAgICBpZiAoJG9sZFpvbmUgIT0gJHRoaXMtPm9wdGlvblsnWkNfVElNRV9aT05FX05BTUUnXSkgew0KICAgICAgICAgICAgZGF0ZV9kZWZhdWx0X3RpbWV6b25lX3NldCgkdGhpcy0+b3B0aW9uWydaQ19USU1FX1pPTkVfTkFNRSddKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8qaWYoaXNzZXQoJF9DT09LSUVbJ3RpbWV6b25lJ10pKXsNCiAgICAgICAgICAgICR0ej1HZXRWYXJzKCd0aW1lem9uZScsJ0NPT0tJRScpOw0KICAgICAgICAgICAgaWYoaXNfbnVtZXJpYygkdHopKXsNCiAgICAgICAgICAgICR0ej1zcHJpbnRmKCclK2QnLC0kdHopOw0KICAgICAgICAgICAgZGF0ZV9kZWZhdWx0X3RpbWV6b25lX3NldCgnRXRjL0dNVCcgLiAkdHopOw0KICAgICAgICAgICAgJHRoaXMtPnRpbWV6b25lPWRhdGVfZGVmYXVsdF90aW1lem9uZV9nZXQoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgKi8NCg0KICAgICAgICBpZiAoJHRoaXMtPm9wdGlvblsnWkNfVkVSU0lPTl9JTl9IRUFERVInXSAmJiAhaGVhZGVyc19zZW50KCkpIHsNCiAgICAgICAgICAgIGhlYWRlcignUHJvZHVjdDonIC4gJHRoaXMtPm9wdGlvblsnWkNfQkxPR19QUk9EVUNUX0ZVTEwnXSk7DQogICAgICAgIH0NCg0KICAgICAgICAkcGFyc2VkSG9zdCA9IHBhcnNlX3VybCgkdGhpcy0+aG9zdCk7DQogICAgICAgICR0aGlzLT5mdWxsY3VycmVudHVybCA9ICRwYXJzZWRIb3N0WydzY2hlbWUnXSAuICc6Ly8nIC4gJHBhcnNlZEhvc3RbJ2hvc3QnXTsNCiAgICAgICAgaWYgKGlzc2V0KCRwYXJzZWRIb3N0Wydwb3J0J10pKSB7DQogICAgICAgICAgICAkdGhpcy0+ZnVsbGN1cnJlbnR1cmwgLj0gJzonIC4gJHBhcnNlZEhvc3RbJ3BvcnQnXTsNCiAgICAgICAgfQ0KICAgICAgICAkdGhpcy0+ZnVsbGN1cnJlbnR1cmwgLj0gJHRoaXMtPmN1cnJlbnR1cmw7DQoNCiAgICAgICAgaWYgKHN1YnN0cigkdGhpcy0+aG9zdCwgMCwgOCkgPT0gJ2h0dHBzOi8vJykgew0KICAgICAgICAgICAgJHRoaXMtPmlzSHR0cHMgPSB0cnVlOw0KICAgICAgICB9DQoNCiAgICAgICAgJHRoaXMtPnZlcmlmeUNvZGVVcmwgPSAkdGhpcy0+aG9zdCAuICd6Yl9zeXN0ZW0vc2NyaXB0L2NfdmFsaWRjb2RlLnBocCc7DQogICAgICAgICR0aGlzLT52YWxpZGNvZGV1cmwgPSAmJHRoaXMtPnZlcmlmeUNvZGVVcmw7DQogICAgICAgICR0aGlzLT5mZWVkdXJsID0gJHRoaXMtPmhvc3QgLiAnZmVlZC5waHAnOw0KICAgICAgICAkdGhpcy0+c2VhcmNodXJsID0gJHRoaXMtPmhvc3QgLiAnc2VhcmNoLnBocCc7DQogICAgICAgICR0aGlzLT5hamF4dXJsID0gJHRoaXMtPmhvc3QgLiAnemJfc3lzdGVtL2NtZC5waHA/YWN0PWFqYXgmc3JjPSc7DQogICAgICAgICR0aGlzLT54bWxycGN1cmwgPSAkdGhpcy0+aG9zdCAuICd6Yl9zeXN0ZW0veG1sLXJwYy9pbmRleC5waHAnOw0KDQogICAgICAgICR0aGlzLT5Mb2FkQ29uZmlnc09ubHlTeXN0ZW0oZmFsc2UpOw0KDQogICAgICAgICR0aGlzLT5Mb2FkQ2FjaGUoKTsNCg0KICAgICAgICAhZGVmaW5lZCgnWkJQX0lOX0NNRCcpIHx8ICR0aGlzLT5pc2NtZCA9IHRydWU7DQogICAgICAgICFkZWZpbmVkKCdaQlBfSU5fQUpBWCcpIHx8ICR0aGlzLT5pc2FqYXggPSB0cnVlOw0KDQogICAgICAgICR0aGlzLT5pc2luaXRpYWxpemVkID0gdHJ1ZTsNCg0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDku47mlbDmja7lupPph4zor7vlj5bkv6Hmga/vvIzlkK/liqjmlbTkuKpaQlAuDQogICAgICoNCiAgICAgKiBAdGhyb3dzIEV4Y2VwdGlvbg0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIExvYWQoKQ0KICAgIHsNCiAgICAgICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fWmJwX0xvYWRfUHJlJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICAgICAkZnByZXR1cm4gPSAkZnBuYW1lKCk7DQogICAgICAgICAgICBpZiAoJGZwc2lnbmFsID09IFBMVUdJTl9FWElUU0lHTkFMX1JFVFVSTikgew0KICAgICAgICAgICAgICAgICRmcHNpZ25hbCA9IFBMVUdJTl9FWElUU0lHTkFMX05PTkU7DQoNCiAgICAgICAgICAgICAgICByZXR1cm4gJGZwcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCEkdGhpcy0+aXNpbml0aWFsaXplZCkgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCR0aGlzLT5pc2xvYWQpIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgICR0aGlzLT5TdGFydEd6aXAoKTsNCg0KICAgICAgICBpZiAoIWhlYWRlcnNfc2VudCgpKSB7DQogICAgICAgICAgICBoZWFkZXIoJ0NvbnRlbnQtdHlwZTogdGV4dC9odG1sOyBjaGFyc2V0PXV0Zi04Jyk7DQogICAgICAgIH0NCg0KICAgICAgICAkdGhpcy0+Q29udmVydFRhYmxlQW5kRGF0YWluZm8oKTsNCg0KICAgICAgICAkdGhpcy0+TG9hZE1lbWJlcnMoJHRoaXMtPm9wdGlvblsnWkNfTE9BRE1FTUJFUlNfTEVWRUwnXSk7DQogICAgICAgICR0aGlzLT5Mb2FkQ2F0ZWdvcmllcygpOw0KICAgICAgICAvLyR0aGlzLT5Mb2FkVGFncygpOw0KICAgICAgICAkdGhpcy0+TG9hZE1vZHVsZXMoKTsNCiAgICAgICAgJHRoaXMtPlJlZ0J1aWxkTW9kdWxlcygpOw0KDQogICAgICAgIGlmICghKGdldF9jbGFzcygkdGhpcy0+dXNlcikgPT09ICdNZW1iZXInICYmICR0aGlzLT51c2VyLT5MZXZlbCA+IDAgJiYgIWVtcHR5KCR0aGlzLT51c2VyLT5JRCkpKSB7DQogICAgICAgICAgICAkdGhpcy0+VmVyaWZ5KCk7DQogICAgICAgIH0NCg0KICAgICAgICAvL+WIm+W7uuaooeadv+exuw0KICAgICAgICAkdGhpcy0+dGVtcGxhdGUgPSAkdGhpcy0+UHJlcGFyZVRlbXBsYXRlKCk7DQoNCiAgICAgICAgLy8g6K+75Li76aKY54mI5pys5L+h5oGvDQogICAgICAgICR0aGlzLT50aGVtZWFwcCA9ICR0aGlzLT5Mb2FkQXBwKCd0aGVtZScsICR0aGlzLT50aGVtZSk7DQogICAgICAgICR0aGlzLT50aGVtZWluZm8gPSAkdGhpcy0+dGhlbWVhcHAtPkdldEluZm9BcnJheSgpOw0KDQogICAgICAgIGlmICgkdGhpcy0+aXNtYW5hZ2UpIHsNCiAgICAgICAgICAgICR0aGlzLT5Mb2FkTWFuYWdlKCk7DQogICAgICAgIH0NCg0KICAgICAgICBBZGRfRmlsdGVyX1BsdWdpbignRmlsdGVyX1BsdWdpbl9Mb2dpbl9IZWFkZXInLCAnSW5jbHVkZV9BZGRvbkFkbWluRm9udCcpOw0KICAgICAgICBBZGRfRmlsdGVyX1BsdWdpbignRmlsdGVyX1BsdWdpbl9PdGhlcl9IZWFkZXInLCAnSW5jbHVkZV9BZGRvbkFkbWluRm9udCcpOw0KICAgICAgICBBZGRfRmlsdGVyX1BsdWdpbignRmlsdGVyX1BsdWdpbl9BZG1pbl9IZWFkZXInLCAnSW5jbHVkZV9BZGRvbkFkbWluRm9udCcpOw0KDQogICAgICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1picF9Mb2FkJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICAgICAkZnBuYW1lKCk7DQogICAgICAgIH0NCg0KICAgICAgICAkdGhpcy0+UmVmbHVzaExhbmd1YWdlcygpOw0KDQogICAgICAgIGlmICgkdGhpcy0+b3B0aW9uWydaQ19ERUJVR19NT0RFJ10gfHwgJHRoaXMtPmlzbWFuYWdlKSB7DQogICAgICAgICAgICAkdGhpcy0+Q2hlY2tUZW1wbGF0ZSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgJHRoaXMtPmlzbG9hZCA9IHRydWU7DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6L295YWl566h55CGLg0KICAgICAqDQogICAgICogQHRocm93cyBFeGNlcHRpb24NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gTG9hZE1hbmFnZSgpDQogICAgew0KICAgICAgICAvL2lmICgkdGhpcy0+b3B0aW9uWydaQ19QRVJNQU5FTlRfRE9NQUlOX1dJVEhfQURNSU4nXSA9PSBmYWxzZSkgew0KICAgICAgICAvLyAgICAgJHRoaXMtPmhvc3QgPSBHZXRDdXJyZW50SG9zdCgkdGhpcy0+cGF0aCwgJHRoaXMtPmNvb2tpZXNwYXRoKTsNCiAgICAgICAgLy99DQoNCiAgICAgICAgLy9pZiAoc3Vic3RyKCR0aGlzLT5ob3N0LCAwLCA4KSA9PSAnaHR0cHM6Ly8nKSB7DQogICAgICAgIC8vICAgICR0aGlzLT5pc0h0dHBzID0gdHJ1ZTsNCiAgICAgICAgLy99DQoNCiAgICAgICAgaWYgKCR0aGlzLT51c2VyLT5TdGF0dXMgPT0gWkNfTUVNQkVSX1NUQVRVU19BVURJVElORykgew0KICAgICAgICAgICAgJHRoaXMtPlNob3dFcnJvcig3OSwgX19GSUxFX18sIF9fTElORV9fKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmICgkdGhpcy0+dXNlci0+U3RhdHVzID09IFpDX01FTUJFUl9TVEFUVVNfTE9DS0VEKSB7DQogICAgICAgICAgICAkdGhpcy0+U2hvd0Vycm9yKDgwLCBfX0ZJTEVfXywgX19MSU5FX18pOw0KICAgICAgICB9DQoNCiAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fQWRtaW5fUGFnZU1uZ19TdWJNZW51JywgJ0luY2x1ZGVfQWRtaW5fQWRkcGFnZXN1Ym1lbnUnKTsNCiAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fQWRtaW5fVGFnTW5nX1N1Yk1lbnUnLCAnSW5jbHVkZV9BZG1pbl9BZGR0YWdzdWJtZW51Jyk7DQogICAgICAgIEFkZF9GaWx0ZXJfUGx1Z2luKCdGaWx0ZXJfUGx1Z2luX0FkbWluX0NhdGVnb3J5TW5nX1N1Yk1lbnUnLCAnSW5jbHVkZV9BZG1pbl9BZGRjYXRlc3VibWVudScpOw0KICAgICAgICBBZGRfRmlsdGVyX1BsdWdpbignRmlsdGVyX1BsdWdpbl9BZG1pbl9NZW1iZXJNbmdfU3ViTWVudScsICdJbmNsdWRlX0FkbWluX0FkZG1lbXN1Ym1lbnUnKTsNCiAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fQWRtaW5fTW9kdWxlTW5nX1N1Yk1lbnUnLCAnSW5jbHVkZV9BZG1pbl9BZGRtb2RzdWJtZW51Jyk7DQogICAgICAgIEFkZF9GaWx0ZXJfUGx1Z2luKCdGaWx0ZXJfUGx1Z2luX0FkbWluX0NvbW1lbnRNbmdfU3ViTWVudScsICdJbmNsdWRlX0FkbWluX0FkZGNtdHN1Ym1lbnUnKTsNCg0KICAgICAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9aYnBfTG9hZE1hbmFnZSddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAgICAgJGZwbmFtZSgpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog57uI5q2i6L+e5o6l77yM6YeK5pS+6LWE5rqQLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBUZXJtaW5hdGUoKQ0KICAgIHsNCiAgICAgICAgaWYgKCR0aGlzLT5pc2luaXRpYWxpemVkKSB7DQogICAgICAgICAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9aYnBfVGVybWluYXRlJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICAgICAgICAgJGZwbmFtZSgpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAkdGhpcy0+Q2xvc2VDb25uZWN0KCk7DQogICAgICAgICAgICB1bnNldCgkdGhpcy0+ZGIpOw0KICAgICAgICAgICAgJHRoaXMtPmlzaW5pdGlhbGl6ZWQgPSBmYWxzZTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOi/nuaOpeaVsOaNruW6ky4NCiAgICAgKg0KICAgICAqIEB0aHJvd3MgRXhjZXB0aW9uDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gT3BlbkNvbm5lY3QoKQ0KICAgIHsNCiAgICAgICAgaWYgKCR0aGlzLT5pc2Nvbm5lY3RlZCkgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCEkdGhpcy0+b3B0aW9uWydaQ19EQVRBQkFTRV9UWVBFJ10pIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgIHN3aXRjaCAoJHRoaXMtPm9wdGlvblsnWkNfREFUQUJBU0VfVFlQRSddKSB7DQogICAgICAgICAgICBjYXNlICdzcWxpdGUnOg0KICAgICAgICAgICAgY2FzZSAnc3FsaXRlMyc6DQogICAgICAgICAgICBjYXNlICdwZG9fc3FsaXRlJzoNCiAgICAgICAgICAgICAgICAkdGhpcy0+ZGIgPSBzZWxmOjpJbml0aWFsaXplREIoJHRoaXMtPm9wdGlvblsnWkNfREFUQUJBU0VfVFlQRSddKTsNCiAgICAgICAgICAgICAgICBpZiAoJHRoaXMtPmRiLT5PcGVuKGFycmF5KA0KICAgICAgICAgICAgICAgICAgICAkdGhpcy0+dXNlcnNkaXIgLiAnZGF0YS8nIC4gJHRoaXMtPm9wdGlvblsnWkNfU1FMSVRFX05BTUUnXSwNCiAgICAgICAgICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfU1FMSVRFX1BSRSddLA0KICAgICAgICAgICAgICAgICkpID09IGZhbHNlKSB7DQogICAgICAgICAgICAgICAgICAgICR0aGlzLT5TaG93RXJyb3IoNjksIF9fRklMRV9fLCBfX0xJTkVfXyk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAncGdzcWwnOg0KICAgICAgICAgICAgY2FzZSAncGRvX3Bnc3FsJzoNCiAgICAgICAgICAgICAgICAkdGhpcy0+ZGIgPSBzZWxmOjpJbml0aWFsaXplREIoJHRoaXMtPm9wdGlvblsnWkNfREFUQUJBU0VfVFlQRSddKTsNCiAgICAgICAgICAgICAgICBpZiAoJHRoaXMtPmRiLT5PcGVuKGFycmF5KA0KICAgICAgICAgICAgICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19QR1NRTF9TRVJWRVInXSwNCiAgICAgICAgICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfUEdTUUxfVVNFUk5BTUUnXSwNCiAgICAgICAgICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfUEdTUUxfUEFTU1dPUkQnXSwNCiAgICAgICAgICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfUEdTUUxfTkFNRSddLA0KICAgICAgICAgICAgICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19QR1NRTF9QUkUnXSwNCiAgICAgICAgICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfUEdTUUxfUE9SVCddLA0KICAgICAgICAgICAgICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19QR1NRTF9QRVJTSVNURU5UJ10sDQogICAgICAgICAgICAgICAgKSkgPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICAgICAgICAgJHRoaXMtPlNob3dFcnJvcig2NywgX19GSUxFX18sIF9fTElORV9fKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdteXNxbCc6DQogICAgICAgICAgICBjYXNlICdteXNxbGknOg0KICAgICAgICAgICAgY2FzZSAncGRvX215c3FsJzoNCiAgICAgICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgICAgICAgaWYgKCR0aGlzLT5vcHRpb25bJ1pDX0RBVEFCQVNFX1RZUEUnXSA9PSAnbXlzcWwnICYmIHZlcnNpb25fY29tcGFyZShQSFBfVkVSU0lPTiwgJzcuMC4wJykgPj0gMCkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoZXh0ZW5zaW9uX2xvYWRlZCgnbXlzcWxpJykpew0KICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfREFUQUJBU0VfVFlQRSddID0gJ215c3FsaSc7DQogICAgICAgICAgICAgICAgICAgIH1lbHNlaWYgKGV4dGVuc2lvbl9sb2FkZWQoJ3Bkb19teXNxbCcpKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX0RBVEFCQVNFX1RZUEUnXSA9ICdwZG9fbXlzcWwnOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICR0aGlzLT5kYiA9IHNlbGY6OkluaXRpYWxpemVEQigkdGhpcy0+b3B0aW9uWydaQ19EQVRBQkFTRV9UWVBFJ10pOw0KICAgICAgICAgICAgICAgIGlmICgkdGhpcy0+ZGItPk9wZW4oYXJyYXkoDQogICAgICAgICAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX01ZU1FMX1NFUlZFUiddLA0KICAgICAgICAgICAgICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19NWVNRTF9VU0VSTkFNRSddLA0KICAgICAgICAgICAgICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19NWVNRTF9QQVNTV09SRCddLA0KICAgICAgICAgICAgICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19NWVNRTF9OQU1FJ10sDQogICAgICAgICAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX01ZU1FMX1BSRSddLA0KICAgICAgICAgICAgICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19NWVNRTF9QT1JUJ10sDQogICAgICAgICAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX01ZU1FMX1BFUlNJU1RFTlQnXSwNCiAgICAgICAgICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfTVlTUUxfRU5HSU5FJ10sDQogICAgICAgICAgICAgICAgKSkgPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICAgICAgICAgJHRoaXMtPlNob3dFcnJvcig2NywgX19GSUxFX18sIF9fTElORV9fKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIH0NCiAgICAgICAgLy8gdXRmOG1iNOaUr+aMgQ0KICAgICAgICBpZiAoJHRoaXMtPmRiLT50eXBlID09ICdteXNxbCcgJiYgdmVyc2lvbl9jb21wYXJlKCR0aGlzLT5kYi0+dmVyc2lvbiwgJzUuNS4zJykgPCAwKSB7DQogICAgICAgICAgICBBZGRfRmlsdGVyX1BsdWdpbignRmlsdGVyX1BsdWdpbl9EYlNxbF9GaWx0ZXInLCAndXRmODRtYl9maWx0ZXInKTsNCiAgICAgICAgICAgIEFkZF9GaWx0ZXJfUGx1Z2luKCdGaWx0ZXJfUGx1Z2luX0VkaXRfQmVnaW4nLCAndXRmODRtYl9maXhIdG1sU3BlY2lhbENoYXJzJyk7DQogICAgICAgIH0NCiAgICAgICAgJHRoaXMtPmlzY29ubmVjdGVkID0gdHJ1ZTsNCg0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDlr7nooajlkI3lkozmlbDmja7nu5PmnoTov5vooYzpooTovazmjaIuDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIENvbnZlcnRUYWJsZUFuZERhdGFpbmZvKCkNCiAgICB7DQogICAgICAgIGlmICgkdGhpcy0+ZGItPmRicHJlKSB7DQogICAgICAgICAgICAkdGhpcy0+dGFibGUgPSBzdHJfcmVwbGFjZSgnJXByZSUnLCAkdGhpcy0+ZGItPmRicHJlLCAkdGhpcy0+dGFibGUpOw0KICAgICAgICB9DQogICAgICAgIGlmICgkdGhpcy0+ZGItPnR5cGUgPT09ICdwb3N0Z3Jlc3FsJykgew0KICAgICAgICAgICAgZm9yZWFjaCAoJHRoaXMtPmRhdGFpbmZvIGFzICRrZXkgPT4gJiR2YWx1ZSkgew0KICAgICAgICAgICAgICAgIGZvcmVhY2ggKCR2YWx1ZSBhcyAkazIgPT4gJiR2Mikgew0KICAgICAgICAgICAgICAgICAgICAkdjJbMF0gPSBzdHJ0b2xvd2VyKCR2MlswXSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5YWz6Zet5pWw5o2u5bqT6L+e5o6lLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBDbG9zZUNvbm5lY3QoKQ0KICAgIHsNCiAgICAgICAgaWYgKCR0aGlzLT5pc2Nvbm5lY3RlZCkgew0KICAgICAgICAgICAgJHRoaXMtPmRiLT5DbG9zZSgpOw0KICAgICAgICAgICAgJHRoaXMtPmlzY29ubmVjdGVkID0gZmFsc2U7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDlkK/nlKhzZXNzaW9uLg0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFN0YXJ0U2Vzc2lvbigpDQogICAgew0KICAgICAgICBpZiAoc2Vzc2lvbl9zdGF0dXMoKSA9PSAxKSB7DQogICAgICAgICAgICBzZXNzaW9uX3N0YXJ0KCk7DQogICAgICAgICAgICAkdGhpcy0+aXNzZXNzaW9uID0gdHJ1ZTsNCg0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog57uI5q2ic2Vzc2lvbi4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBFbmRTZXNzaW9uKCkNCiAgICB7DQogICAgICAgIGlmIChzZXNzaW9uX3N0YXR1cygpID09IDIpIHsNCiAgICAgICAgICAgIHNlc3Npb25fd3JpdGVfY2xvc2UoKTsNCiAgICAgICAgICAgICR0aGlzLT5pc3Nlc3Npb24gPSBmYWxzZTsNCg0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogTG9hZCBvciBSZUxvYWTmj5Lku7ZDb25maWdz6KGoLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBMb2FkQ29uZmlncygpDQogICAgew0KICAgICAgICAkdGhpcy0+TG9hZENvbmZpZ3NPbmx5U3lzdGVtKHRydWUpOw0KICAgICAgICAkdGhpcy0+TG9hZENvbmZpZ3NPbmx5U3lzdGVtKGZhbHNlKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDovb3lhaXmj5Lku7ZDb25maWdz6KGoIE9ubHkgU3lzdGVtIE9wdGlvbi4NCiAgICAgKi8NCiAgICBwcml2YXRlICRwcnZDb25maWdMaXN0ID0gYXJyYXkoKTsNCg0KICAgIHB1YmxpYyBmdW5jdGlvbiBMb2FkQ29uZmlnc09ubHlTeXN0ZW0oJG9ubHlzeXN0ZW1vcHRpb24gPSB0cnVlKQ0KICAgIHsNCiAgICAgICAgaWYgKCRvbmx5c3lzdGVtb3B0aW9uID09IHRydWUpIHsNCiAgICAgICAgICAgICR0aGlzLT5jb25maWdzID0gYXJyYXkoKTsNCiAgICAgICAgICAgICR0aGlzLT5wcnZDb25maWdMaXN0ID0gYXJyYXkoKTsNCg0KICAgICAgICAgICAgJHNxbCA9ICR0aGlzLT5kYi0+c3FsLT5TZWxlY3QoJHRoaXMtPnRhYmxlWydDb25maWcnXSwgJycsICcnLCAnJywgJycsICcnKTsNCiAgICAgICAgICAgIC8qIEB2YXIgQ29uZmlnW10gJGFycmF5ICovDQogICAgICAgICAgICAkdGhpcy0+cHJ2Q29uZmlnTGlzdCA9ICR0aGlzLT5HZXRMaXN0T3JpZ2luKCRzcWwpOw0KICAgICAgICB9DQoNCiAgICAgICAgJHR5cGUgPSAnQ29uZmlnJzsNCg0KICAgICAgICBmb3JlYWNoICgkdGhpcy0+cHJ2Q29uZmlnTGlzdCBhcyAkYykgew0KDQogICAgICAgICAgICAkbmFtZSA9ICRjWyR0aGlzLT5kYXRhaW5mb1snQ29uZmlnJ11bJ05hbWUnXVswXV07DQoNCg0KDQogICAgICAgICAgICBpZiAoKCRuYW1lID09ICdzeXN0ZW0nICYmICRvbmx5c3lzdGVtb3B0aW9uID09IHRydWUpIHx8ICgkbmFtZSAhPSAnc3lzdGVtJyAmJiAkb25seXN5c3RlbW9wdGlvbiA9PSBmYWxzZSkpIHsNCiAgICAgICAgICAgICAgICBpZiAoIWlzc2V0KCR0aGlzLT5jb25maWdzWyRuYW1lXSkpIHsNCiAgICAgICAgICAgICAgICAgICAgJGwgPSBuZXcgJHR5cGUoJG5hbWUpOw0KICAgICAgICAgICAgICAgICAgICAkdGhpcy0+Y29uZmlnc1skbmFtZV0gPSAkbDsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAkbCA9ICR0aGlzLT5jb25maWdzWyRuYW1lXTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKGdldF9jbGFzcygkbCkgIT0gJHR5cGUpIHsNCiAgICAgICAgICAgICAgICAgICAgJGwgPSBuZXcgJHR5cGUoJG5hbWUpOw0KICAgICAgICAgICAgICAgICAgICAkdGhpcy0+Y29uZmlnc1skbmFtZV0gPSAkbDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKGlzc2V0KCRjWydjb25mX0tleSddKSAmJiAkY1snY29uZl9LZXknXSAhPSAnJykgew0KICAgICAgICAgICAgICAgICAgICAkbC0+TG9hZEluZm9CeUFzc29jU2luZ2xlV2l0aFByZSgkYyk7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgJGwtPkxvYWRJbmZvQnlBc3NvYygkYyk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIC8v5bCG6K+75Ye65p2l55qE5pWw57uE5YaN5ou85oiQ5bqP5YiX5YyW5pWw5o2u5YaN5Y+N5bqP5YiX5YyWDQogICAgICAgIGZvcmVhY2ggKCR0aGlzLT5jb25maWdzIGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICAgICBpZiAoaXNfb2JqZWN0KCR2YWx1ZSkgJiYgKCRrZXkgPT0gJ3N5c3RlbScgJiYgJG9ubHlzeXN0ZW1vcHRpb24gPT0gdHJ1ZSkgfHwgKCRrZXkgIT0gJ3N5c3RlbScgJiYgJG9ubHlzeXN0ZW1vcHRpb24gPT0gZmFsc2UpKSB7DQogICAgICAgICAgICAgICAgJHZhbHVlLT5Mb2FkSW5mb0J5QXNzb2NTaW5nbGVXaXRoQWZ0ZXIoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIGlmICgkb25seXN5c3RlbW9wdGlvbiA9PSBmYWxzZSkgew0KICAgICAgICAgICAgJHRoaXMtPnBydkNvbmZpZ0xpc3QgPSBhcnJheSgpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5L+d5a2YQ29uZmlnc+ihqC4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUgQ29uZmlnc+ihqOWQjQ0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFNhdmVDb25maWcoJG5hbWUpDQogICAgew0KICAgICAgICBpZiAoIWlzc2V0KCR0aGlzLT5jb25maWdzWyRuYW1lXSkpIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgICR0aGlzLT5jb25maWdzWyRuYW1lXS0+U2F2ZSgpOw0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWIoOmZpENvbmZpZ3PooaguDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRuYW1lIENvbmZpZ3PooajlkI0NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBEZWxDb25maWcoJG5hbWUpDQogICAgew0KICAgICAgICBpZiAoIWlzc2V0KCR0aGlzLT5jb25maWdzWyRuYW1lXSkpIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgICR0aGlzLT5jb25maWdzWyRuYW1lXS0+RGVsZXRlKCk7DQogICAgICAgIHVuc2V0KCR0aGlzLT5jb25maWdzWyRuYW1lXSk7DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6I635Y+WQ29uZmlnc+ihqOWAvA0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbmFtZSBDb25maWdz6KGo5ZCNDQogICAgICoNCiAgICAgKiBAcmV0dXJuIG1peGVkDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIENvbmZpZygkbmFtZSkNCiAgICB7DQogICAgICAgIGlmICghaXNzZXQoJHRoaXMtPmNvbmZpZ3NbJG5hbWVdKSkgew0KICAgICAgICAgICAgJG5hbWUgPSBGaWx0ZXJDb3JyZWN0TmFtZSgkbmFtZSk7DQogICAgICAgICAgICBpZiAoISRuYW1lKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAkdGhpcy0+Y29uZmlnc1skbmFtZV0gPSBuZXcgQ29uZmlnKCRuYW1lKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAkdGhpcy0+Y29uZmlnc1skbmFtZV07DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5p+l5p+QQ29uZmln5piv5ZCm5a2Y5ZyoLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbmFtZSBDb25maWdz6KGo5ZCNDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gSGFzQ29uZmlnKCRuYW1lKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuIGlzc2V0KCR0aGlzLT5jb25maWdzWyRuYW1lXSkgJiYgJHRoaXMtPmNvbmZpZ3NbJG5hbWVdLT5Db3VudEl0ZW0oKSA+IDA7DQogICAgfQ0KDQogICAgLy8jIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCiAgICAvL0NhY2hl55u45YWzDQogICAgcHJpdmF0ZSAkY2FjaGVfaGFzaCA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiDkv53lrZjnvJPlrZguDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gU2F2ZUNhY2hlKCkNCiAgICB7DQogICAgICAgIC8vJHM9JHRoaXMtPnVzZXJzZGlyIC4gJ2NhY2hlLycgLiAkdGhpcy0+Z3VpZCAuICcuY2FjaGUnOw0KICAgICAgICAvLyRjPXNlcmlhbGl6ZSgkdGhpcy0+Y2FjaGUpOw0KICAgICAgICAvL0BmaWxlX3B1dF9jb250ZW50cygkcywgJGMpOw0KICAgICAgICAvLyR0aGlzLT5jb25maWdzWydjYWNoZSddPSR0aGlzLT5jYWNoZTsNCiAgICAgICAgJG5ld19oYXNoID0gbWQ1KCR0aGlzLT5Db25maWcoJ2NhY2hlJykpOw0KICAgICAgICBpZiAoJHRoaXMtPmNhY2hlX2hhc2ggPT0gJG5ld19oYXNoKSB7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KDQogICAgICAgICR0aGlzLT5TYXZlQ29uZmlnKCdjYWNoZScpOw0KICAgICAgICAkdGhpcy0+Y2FjaGVfaGFzaCA9ICRuZXdfaGFzaDsNCg0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDliqDovb3nvJPlrZguDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gTG9hZENhY2hlKCkNCiAgICB7DQogICAgICAgICR0aGlzLT5jYWNoZSA9ICR0aGlzLT5Db25maWcoJ2NhY2hlJyk7DQogICAgICAgICR0aGlzLT5jYWNoZV9oYXNoID0gbWQ1KCR0aGlzLT5Db25maWcoJ2NhY2hlJykpOw0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOS/neWtmOmFjee9ri4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBTYXZlT3B0aW9uKCkNCiAgICB7DQogICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfQ0xTSUQnXSA9ICR0aGlzLT5ndWlkOw0KDQogICAgICAgIHVuc2V0KCR0aGlzLT5vcHRpb25bJ1pDX1BFUk1BTkVOVF9ET01BSU5fV0hPTEVfRElTQUJMRSddKTsNCiAgICAgICAgdW5zZXQoJHRoaXMtPm9wdGlvblsnWkNfUEVSTUFORU5UX0RPTUFJTl9GT1JDRURfVVJMJ10pOw0KDQogICAgICAgICRzID0gJ1pDX0RBVEFCQVNFX1RZUEV8WkNfU1FMSVRFX05BTUV8WkNfU1FMSVRFX1BSRXxaQ19NWVNRTF9TRVJWRVJ8WkNfTVlTUUxfVVNFUk5BTUV8WkNfTVlTUUxfUEFTU1dPUkR8WkNfTVlTUUxfTkFNRXxaQ19NWVNRTF9DSEFSU0VUfFpDX01ZU1FMX0NPTExBVEV8WkNfTVlTUUxfUFJFfFpDX01ZU1FMX0VOR0lORXxaQ19NWVNRTF9QT1JUfFpDX01ZU1FMX1BFUlNJU1RFTlR8WkNfTVlTUUxfUE9SVHxaQ19QR1NRTF9TRVJWRVJ8WkNfUEdTUUxfVVNFUk5BTUV8WkNfUEdTUUxfUEFTU1dPUkR8WkNfUEdTUUxfTkFNRXxaQ19QR1NRTF9DSEFSU0VUfFpDX1BHU1FMX1BSRXxaQ19QR1NRTF9QT1JUfFpDX1BHU1FMX1BFUlNJU1RFTlR8WkNfQ0xPU0VfV0hPTEVfU0lURXxaQ19QRVJNQU5FTlRfRE9NQUlOX0ZPUkNFRF9VUkx8WkNfUEVSTUFORU5UX0RPTUFJTl9XSE9MRV9ESVNBQkxFJzsNCiAgICAgICAgJHJlc2VydmVfa2V5cyA9IGV4cGxvZGUoJ3wnLCAkcyk7DQoNCiAgICAgICAgaWYgKGZpbGVfZXhpc3RzKCR0aGlzLT51c2Vyc2RpciAuICdjX29wdGlvbi5waHAnKSA9PSBmYWxzZSkgew0KICAgICAgICAgICAgJHMgPSAiPCIgLiAiPyIgLiAicGhwXHJcbiI7DQogICAgICAgICAgICAkcyAuPSAicmV0dXJuICI7DQogICAgICAgICAgICAkb3B0aW9uID0gYXJyYXkoKTsNCiAgICAgICAgICAgIGZvcmVhY2ggKCR0aGlzLT5vcHRpb24gYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgICAgICAgICBpZiAoKCRrZXkgPT0gJ1pDX0RBVEFCQVNFX1RZUEUnKSB8fA0KICAgICAgICAgICAgICAgICAgICAoJGtleSA9PSAnWkNfU1FMSVRFX05BTUUnKSB8fA0KICAgICAgICAgICAgICAgICAgICAoJGtleSA9PSAnWkNfU1FMSVRFX1BSRScpIHx8DQogICAgICAgICAgICAgICAgICAgICgka2V5ID09ICdaQ19NWVNRTF9TRVJWRVInKSB8fA0KICAgICAgICAgICAgICAgICAgICAoJGtleSA9PSAnWkNfTVlTUUxfVVNFUk5BTUUnKSB8fA0KICAgICAgICAgICAgICAgICAgICAoJGtleSA9PSAnWkNfTVlTUUxfUEFTU1dPUkQnKSB8fA0KICAgICAgICAgICAgICAgICAgICAoJGtleSA9PSAnWkNfTVlTUUxfTkFNRScpIHx8DQogICAgICAgICAgICAgICAgICAgICgka2V5ID09ICdaQ19NWVNRTF9DSEFSU0VUJykgfHwNCiAgICAgICAgICAgICAgICAgICAgKCRrZXkgPT0gJ1pDX01ZU1FMX1BSRScpIHx8DQogICAgICAgICAgICAgICAgICAgICgka2V5ID09ICdaQ19NWVNRTF9FTkdJTkUnKSB8fA0KICAgICAgICAgICAgICAgICAgICAoJGtleSA9PSAnWkNfTVlTUUxfUE9SVCcpIHx8DQogICAgICAgICAgICAgICAgICAgICgka2V5ID09ICdaQ19NWVNRTF9QRVJTSVNURU5UJykgfHwNCiAgICAgICAgICAgICAgICAgICAgKCRrZXkgPT0gJ1pDX1BHU1FMX1NFUlZFUicpIHx8DQogICAgICAgICAgICAgICAgICAgICgka2V5ID09ICdaQ19QR1NRTF9VU0VSTkFNRScpIHx8DQogICAgICAgICAgICAgICAgICAgICgka2V5ID09ICdaQ19QR1NRTF9QQVNTV09SRCcpIHx8DQogICAgICAgICAgICAgICAgICAgICgka2V5ID09ICdaQ19QR1NRTF9OQU1FJykgfHwNCiAgICAgICAgICAgICAgICAgICAgKCRrZXkgPT0gJ1pDX1BHU1FMX0NIQVJTRVQnKSB8fA0KICAgICAgICAgICAgICAgICAgICAoJGtleSA9PSAnWkNfUEdTUUxfUFJFJykgfHwNCiAgICAgICAgICAgICAgICAgICAgKCRrZXkgPT0gJ1pDX1BHU1FMX1BPUlQnKSB8fA0KICAgICAgICAgICAgICAgICAgICAoJGtleSA9PSAnWkNfUEdTUUxfUEVSU0lTVEVOVCcpIHx8DQogICAgICAgICAgICAgICAgICAgICgka2V5ID09ICdaQ19DTE9TRV9XSE9MRV9TSVRFJykNCiAgICAgICAgICAgICAgICApIHsNCiAgICAgICAgICAgICAgICAgICAgJG9wdGlvblska2V5XSA9ICR2YWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgJHJlc2VydmVfa2V5c1tdID0gJGtleTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICAkcyAuPSB2YXJfZXhwb3J0KCRvcHRpb24sIHRydWUpOw0KICAgICAgICAgICAgJHMgLj0gIjsiOw0KICAgICAgICAgICAgQGZpbGVfcHV0X2NvbnRlbnRzKCR0aGlzLT51c2Vyc2RpciAuICdjX29wdGlvbi5waHAnLCAkcyk7DQogICAgICAgIH0NCg0KICAgICAgICBmb3JlYWNoICgkdGhpcy0+b3B0aW9uIGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICAgICAkdGhpcy0+Q29uZmlnKCdzeXN0ZW0nKS0+JGtleSA9ICR2YWx1ZTsNCiAgICAgICAgfQ0KDQogICAgICAgIGZvcmVhY2ggKCRyZXNlcnZlX2tleXMgYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgICAgICR0aGlzLT5Db25maWcoJ3N5c3RlbScpLT5EZWxLZXkoJHZhbHVlKTsNCiAgICAgICAgfQ0KDQogICAgICAgICR0aGlzLT5Db25maWcoJ3N5c3RlbScpLT5aQ19CTE9HX0hPU1QgPSBjaHVua19zcGxpdCgkdGhpcy0+Q29uZmlnKCdzeXN0ZW0nKS0+WkNfQkxPR19IT1NULCAxLCAifCIpOw0KDQogICAgICAgICR0aGlzLT5TYXZlQ29uZmlnKCdzeXN0ZW0nKTsNCg0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDovb3lhaXphY3nva4uDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gTG9hZE9wdGlvbigpDQogICAgew0KICAgICAgICAkYXJyYXkgPSAkdGhpcy0+Q29uZmlnKCdzeXN0ZW0nKS0+R2V0RGF0YSgpOw0KDQogICAgICAgIGlmIChlbXB0eSgkYXJyYXkpKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoIWlzX2FycmF5KCRhcnJheSkpIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgIGZvcmVhY2ggKCRhcnJheSBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAgICAgLy9pZigka2V5PT0nWkNfUEVSTUFORU5UX0RPTUFJTl9FTkFCTEUnKWNvbnRpbnVlOw0KICAgICAgICAgICAgLy9pZigka2V5PT0nWkNfQkxPR19IT1NUJyljb250aW51ZTsNCiAgICAgICAgICAgIC8vaWYoJGtleT09J1pDX0JMT0dfQ0xTSUQnKWNvbnRpbnVlOw0KICAgICAgICAgICAgLy9pZigka2V5PT0nWkNfQkxPR19MQU5HVUFHRVBBQ0snKWNvbnRpbnVlOw0KICAgICAgICAgICAgaWYgKCRrZXkgPT0gJ1pDX0JMT0dfSE9TVCcpIHsNCiAgICAgICAgICAgICAgICAkdmFsdWUgPSBzdHJfcmVwbGFjZSgnfCcsICcnLCAkdmFsdWUpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoKCRrZXkgPT0gJ1pDX0RBVEFCQVNFX1RZUEUnKSB8fA0KICAgICAgICAgICAgICAgICgka2V5ID09ICdaQ19TUUxJVEVfTkFNRScpIHx8DQogICAgICAgICAgICAgICAgKCRrZXkgPT0gJ1pDX1NRTElURV9QUkUnKSB8fA0KICAgICAgICAgICAgICAgICgka2V5ID09ICdaQ19NWVNRTF9TRVJWRVInKSB8fA0KICAgICAgICAgICAgICAgICgka2V5ID09ICdaQ19NWVNRTF9VU0VSTkFNRScpIHx8DQogICAgICAgICAgICAgICAgKCRrZXkgPT0gJ1pDX01ZU1FMX1BBU1NXT1JEJykgfHwNCiAgICAgICAgICAgICAgICAoJGtleSA9PSAnWkNfTVlTUUxfTkFNRScpIHx8DQogICAgICAgICAgICAgICAgKCRrZXkgPT0gJ1pDX01ZU1FMX0NIQVJTRVQnKSB8fA0KICAgICAgICAgICAgICAgICgka2V5ID09ICdaQ19NWVNRTF9QUkUnKSB8fA0KICAgICAgICAgICAgICAgICgka2V5ID09ICdaQ19NWVNRTF9FTkdJTkUnKSB8fA0KICAgICAgICAgICAgICAgICgka2V5ID09ICdaQ19NWVNRTF9QT1JUJykgfHwNCiAgICAgICAgICAgICAgICAoJGtleSA9PSAnWkNfTVlTUUxfUEVSU0lTVEVOVCcpIHx8DQogICAgICAgICAgICAgICAgKCRrZXkgPT0gJ1pDX1BHU1FMX1NFUlZFUicpIHx8DQogICAgICAgICAgICAgICAgKCRrZXkgPT0gJ1pDX1BHU1FMX1VTRVJOQU1FJykgfHwNCiAgICAgICAgICAgICAgICAoJGtleSA9PSAnWkNfUEdTUUxfUEFTU1dPUkQnKSB8fA0KICAgICAgICAgICAgICAgICgka2V5ID09ICdaQ19QR1NRTF9OQU1FJykgfHwNCiAgICAgICAgICAgICAgICAoJGtleSA9PSAnWkNfUEdTUUxfQ0hBUlNFVCcpIHx8DQogICAgICAgICAgICAgICAgKCRrZXkgPT0gJ1pDX1BHU1FMX1BSRScpIHx8DQogICAgICAgICAgICAgICAgKCRrZXkgPT0gJ1pDX1BHU1FMX1BPUlQnKSB8fA0KICAgICAgICAgICAgICAgICgka2V5ID09ICdaQ19QR1NRTF9QRVJTSVNURU5UJykgfHwNCiAgICAgICAgICAgICAgICAoJGtleSA9PSAnWkNfQ0xPU0VfV0hPTEVfU0lURScpIHx8DQogICAgICAgICAgICAgICAgKCRrZXkgPT0gJ1pDX1BFUk1BTkVOVF9ET01BSU5fV0hPTEVfRElTQUJMRScpIHx8DQogICAgICAgICAgICAgICAgKCRrZXkgPT0gJ1pDX1BFUk1BTkVOVF9ET01BSU5fRk9SQ0VEX1VSTCcpDQogICAgICAgICAgICApIHsNCiAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgJHRoaXMtPm9wdGlvblska2V5XSA9ICR2YWx1ZTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoIWV4dGVuc2lvbl9sb2FkZWQoJ2dkJykpIHsNCiAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX0NPTU1FTlRfVkVSSUZZX0VOQUJMRSddID0gZmFsc2U7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpqozor4Hmk43kvZzmnYPpmZAuDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICAgICAkYWN0aW9uIOaTjeS9nA0KICAgICAqIEBwYXJhbSBpbnR8c3RyaW5nICRsZXZlbA0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIENoZWNrUmlnaHRzKCRhY3Rpb24sICRsZXZlbCA9IG51bGwpDQogICAgew0KICAgICAgICBpZiAoJGxldmVsID09PSBudWxsKSB7DQogICAgICAgICAgICAkbGV2ZWwgPSAkdGhpcy0+dXNlci0+TGV2ZWw7DQogICAgICAgIH0NCg0KICAgICAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9aYnBfQ2hlY2tSaWdodHMnXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgICAgICRmcHJldHVybiA9ICRmcG5hbWUoJGFjdGlvbiwgJGxldmVsKTsNCiAgICAgICAgICAgIGlmICgkZnBzaWduYWwgPT0gUExVR0lOX0VYSVRTSUdOQUxfUkVUVVJOKSB7DQogICAgICAgICAgICAgICAgJGZwc2lnbmFsID0gUExVR0lOX0VYSVRTSUdOQUxfTk9ORTsNCg0KICAgICAgICAgICAgICAgIHJldHVybiAkZnByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgaWYgKCFpc3NldCgkdGhpcy0+YWN0aW9uc1skYWN0aW9uXSkpIHsNCiAgICAgICAgICAgIGlmIChpc19udW1lcmljKCRhY3Rpb24pKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICRsZXZlbCA8PSAkYWN0aW9uOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJGxldmVsIDw9ICR0aGlzLT5hY3Rpb25zWyRhY3Rpb25dOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOagueaNrueUqOaIt+etiee6p+mqjOivgeaTjeS9nOadg+mZkCAxLjXlvIDlp4vlj4LmlbDmjaLpobrluo8uDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRhY3Rpb24g5pON5L2cDQogICAgICogQHBhcmFtIGludCAgICAkbGV2ZWwgIOeUqOaIt+etiee6pw0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIENoZWNrUmlnaHRzQnlMZXZlbCgkYWN0aW9uLCAkbGV2ZWwpDQogICAgew0KICAgICAgICByZXR1cm4gJHRoaXMtPkNoZWNrUmlnaHRzKCRhY3Rpb24sICRsZXZlbCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6aqM6K+B55So5oi355m75b2VLg0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFZlcmlmeSgpDQogICAgew0KICAgICAgICAkdXNlcm5hbWUgPSB0cmltKEdldFZhcnMoJ3VzZXJuYW1lJywgJ0NPT0tJRScpKTsNCiAgICAgICAgJHRva2VuID0gdHJpbShHZXRWYXJzKCd0b2tlbicsICdDT09LSUUnKSk7DQogICAgICAgICR1c2VyID0gJHRoaXMtPlZlcmlmeVVzZXJUb2tlbigkdG9rZW4sICR1c2VybmFtZSk7DQogICAgICAgIGlmICghaXNfbnVsbCgkdXNlcikpIHsNCiAgICAgICAgICAgICR0aGlzLT51c2VyID0gJHVzZXI7DQoNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9DQogICAgICAgICR0aGlzLT51c2VyID0gbmV3IE1lbWJlcigpOw0KICAgICAgICAkdGhpcy0+dXNlci0+R3VpZCA9IEdldEd1aWQoKTsNCg0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6L+U5Zue55m75b2V5oiQ5Yqf5ZCO5bqU5L+d5a2Y55qEY29va2ll5L+h5oGvLg0KICAgICAqDQogICAgICogQHBhcmFtIE1lbWJlciAkbSDlt7Lpqozov4fmiJDlip/nmoRtZW1iZXINCiAgICAgKg0KICAgICAqIEByZXR1cm4gc3RyaW5nDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFZlcmlmeVJlc3VsdCgkbSkNCiAgICB7DQogICAgICAgIHJldHVybiAkdGhpcy0+R2VuZXJhdGVVc2VyVG9rZW4oJG0pOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOeUn+aIkFVzZXIgVG9rZW7vvIznlKjkuo7nmbvlvZXpqozor4ENCiAgICAgKg0KICAgICAqIEBwYXJhbSBNZW1iZXIgJHVzZXINCiAgICAgKiBAcGFyYW0gaW50ICAgICR0aW1lDQogICAgICoNCiAgICAgKiBAcmV0dXJuIHN0cmluZw0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZW5lcmF0ZVVzZXJUb2tlbigkdXNlciwgJHRpbWUgPSAwKQ0KICAgIHsNCiAgICAgICAgaWYgKCR0aW1lID09PSAwKSB7DQogICAgICAgICAgICAkdGltZSA9IHRpbWUoKSArIDM2MDAgKiAyNDsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiBDcmVhdGVXZWJUb2tlbigkdXNlci0+SUQsICR0aW1lLCAkdXNlci0+R3VpZCwgJHVzZXItPlBhc3NXb3JkX01ENVBhdGgpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmqjOivgeeUqOaIt+eZu+W9lVRva2VuLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkdG9rZW4NCiAgICAgKiBAcGFyYW0gc3RyaW5nICR1c2VybmFtZQ0KICAgICAqDQogICAgICogQHJldHVybiBNZW1iZXINCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gVmVyaWZ5VXNlclRva2VuKCR0b2tlbiwgJHVzZXJuYW1lKQ0KICAgIHsNCiAgICAgICAgJHVzZXIgPSAkdGhpcy0+R2V0TWVtYmVyQnlOYW1lKCR1c2VybmFtZSk7DQogICAgICAgIGlmICgkdXNlci0+SUQgPiAwKSB7DQogICAgICAgICAgICBpZiAoVmVyaWZ5V2ViVG9rZW4oJHRva2VuLCAkdXNlci0+SUQsICR1c2VyLT5HdWlkLCAkdXNlci0+UGFzc1dvcmRfTUQ1UGF0aCkpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gJHVzZXI7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpqozor4HnlKjmiLfnmbvlvZXvvIjkuIDmrKFNRDXlr4bnoIHvvIkuDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRuYW1lICAg55So5oi35ZCNDQogICAgICogQHBhcmFtIHN0cmluZyAkbWQ1cHcgIG1kNeWKoOWvhuWQjueahOWvhueggQ0KICAgICAqIEBwYXJhbSBNZW1iZXIgJG1lbWJlciDov5Tlm57or7vlj5bmiJDlip/nmoRtZW1iZXLlr7nosaENCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBWZXJpZnlfTUQ1KCRuYW1lLCAkbWQ1cHcsICYkbWVtYmVyKQ0KICAgIHsNCiAgICAgICAgaWYgKCRuYW1lID09ICcnIHx8ICRtZDVwdyA9PSAnJykgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQogICAgICAgICRtZW1iZXIgPSAkdGhpcy0+R2V0TWVtYmVyQnlOYW1lKCRuYW1lKTsNCiAgICAgICAgaWYgKCRtZW1iZXItPklEID4gMCkgew0KICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5WZXJpZnlfRmluYWwoJG5hbWUsIG1kNSgkbWQ1cHcgLiAkbWVtYmVyLT5HdWlkKSwgJG1lbWJlcik7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6aqM6K+B55So5oi355m75b2V77yI5Y6f5aeL5piO5paH5a+G56CB77yJLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbmFtZSAgICAgICDnlKjmiLflkI0NCiAgICAgKiBAcGFyYW0gc3RyaW5nICRvcmlnaW5hbHB3IOWvhueggeaYjuaWhw0KICAgICAqIEBwYXJhbSBNZW1iZXIgJG1lbWJlciAgICAg6L+U5Zue6K+75Y+W5oiQ5Yqf55qEbWVtYmVy5a+56LGhDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gVmVyaWZ5X09yaWdpbmFsKCRuYW1lLCAkb3JpZ2luYWxwdywgJiRtZW1iZXIgPSBudWxsKQ0KICAgIHsNCiAgICAgICAgaWYgKCRuYW1lID09ICcnIHx8ICRvcmlnaW5hbHB3ID09ICcnKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCiAgICAgICAgJG0gPSAkdGhpcy0+R2V0TWVtYmVyQnlOYW1lKCRuYW1lKTsNCiAgICAgICAgaWYgKCRtLT5JRCA+IDApIHsNCiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+VmVyaWZ5X01ENSgkbmFtZSwgbWQ1KCRvcmlnaW5hbHB3KSwgJG1lbWJlcik7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6aqM6K+B55So5oi355m75b2V77yI5pWw5o2u5bqT5L+d5a2Y55qE5pyA57uI6L+Q566X5ZCO5a+G56CB77yJLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbmFtZSAgICAg55So5oi35ZCNDQogICAgICogQHBhcmFtIHN0cmluZyAkcGFzc3dvcmQg5LqM5qyh5Yqg5a+G5ZCO55qE5a+G56CBDQogICAgICogQHBhcmFtIG9iamVjdCAkbWVtYmVyICAg6L+U5Zue6K+75Y+W5oiQ5Yqf55qEbWVtYmVy5a+56LGhDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gVmVyaWZ5X0ZpbmFsKCRuYW1lLCAkcGFzc3dvcmQsICYkbWVtYmVyID0gbnVsbCkNCiAgICB7DQogICAgICAgIGlmICgkbmFtZSA9PSAnJyB8fCAkcGFzc3dvcmQgPT0gJycpIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KICAgICAgICAkbSA9ICR0aGlzLT5HZXRNZW1iZXJCeU5hbWUoJG5hbWUpOw0KICAgICAgICBpZiAoJG0tPklEID4gMCkgew0KICAgICAgICAgICAgaWYgKHN0cmNhc2VjbXAoJG0tPlBhc3N3b3JkLCAkcGFzc3dvcmQpID09IDApIHsNCiAgICAgICAgICAgICAgICAkbWVtYmVyID0gJG07DQoNCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpqozor4HnlKjmiLfnmbvlvZXvvIjkvb/nlKhUb2tlbu+8jOabv+S7o+WvhueggeS/neWtmO+8iS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUgICDnlKjmiLflkI0NCiAgICAgKiBAcGFyYW0gc3RyaW5nICR3dCAgICAgV2ViVG9rZW4NCiAgICAgKiBAcGFyYW0gc3RyaW5nICR3dF9pZCAgV2ViVG9rZW7nmoRJROivhuWIq+espg0KICAgICAqIEBwYXJhbSBvYmplY3QgJG1lbWJlciDov5Tlm57or7vlj5bmiJDlip/nmoRtZW1iZXLlr7nosaENCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBWZXJpZnlfVG9rZW4oJG5hbWUsICR3dCwgJHd0X2lkLCAmJG1lbWJlciA9IG51bGwpDQogICAgew0KICAgICAgICBpZiAoJG5hbWUgPT0gJycgfHwgJHd0ID09ICcnKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCiAgICAgICAgJG0gPSBudWxsOw0KICAgICAgICAkbSA9ICR0aGlzLT5HZXRNZW1iZXJCeU5hbWUoJG5hbWUpOw0KICAgICAgICBpZiAoJG0tPklEID4gMCkgew0KICAgICAgICAgICAgaWYgKFZlcmlmeVdlYlRva2VuKCR3dCwgJHd0X2lkLCAkdGhpcy0+Z3VpZCwgJG0tPklELCAkbS0+UGFzc3dvcmQpID09PSB0cnVlKSB7DQogICAgICAgICAgICAgICAgJG1lbWJlciA9ICRtOw0KDQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6L295YWl55So5oi35YiX6KGoLg0KICAgICAqDQogICAgICogQHBhcmFtIGludCAkbGV2ZWwg55So5oi3562J57qnDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gTG9hZE1lbWJlcnMoJGxldmVsID0gMCkNCiAgICB7DQogICAgICAgIGlmICgkbGV2ZWwgPCAwKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCg0KICAgICAgICAkd2hlcmUgPSBudWxsOw0KICAgICAgICBpZiAoJGxldmVsID4gMCkgew0KICAgICAgICAgICAgJHdoZXJlID0gYXJyYXkoYXJyYXkoJzw9JywgJ21lbV9MZXZlbCcsICRsZXZlbCkpOw0KICAgICAgICB9DQogICAgICAgICR0aGlzLT5tZW1iZXJzID0gYXJyYXkoKTsNCiAgICAgICAgJHRoaXMtPm1lbWJlcnNieW5hbWUgPSBhcnJheSgpOw0KICAgICAgICAkYXJyYXkgPSAkdGhpcy0+R2V0TWVtYmVyTGlzdChudWxsLCAkd2hlcmUpOw0KICAgICAgICBmb3JlYWNoICgkYXJyYXkgYXMgJG0pIHsNCiAgICAgICAgICAgICR0aGlzLT5tZW1iZXJzWyRtLT5JRF0gPSAkbTsNCiAgICAgICAgICAgICR0aGlzLT5tZW1iZXJzYnluYW1lWyRtLT5OYW1lXSA9ICYkdGhpcy0+bWVtYmVyc1skbS0+SURdOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6L295YWl5YiG57G75YiX6KGoLg0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIExvYWRDYXRlZ29yaWVzKCkNCiAgICB7DQogICAgICAgICR0aGlzLT5jYXRlZ29yaWVzID0gYXJyYXkoKTsNCiAgICAgICAgJHRoaXMtPmNhdGVnb3JpZXNieW9yZGVyID0gYXJyYXkoKTsNCiAgICAgICAgJGx2MCA9IGFycmF5KCk7DQogICAgICAgICRsdjEgPSBhcnJheSgpOw0KICAgICAgICAkbHYyID0gYXJyYXkoKTsNCiAgICAgICAgJGx2MyA9IGFycmF5KCk7DQogICAgICAgICRhcnJheSA9ICR0aGlzLT5HZXRDYXRlZ29yeUxpc3QobnVsbCwgbnVsbCwgYXJyYXkoJ2NhdGVfT3JkZXInID0+ICdBU0MnKSwgbnVsbCwgbnVsbCk7DQogICAgICAgIGlmIChjb3VudCgkYXJyYXkpID09IDApIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgIGZvcmVhY2ggKCRhcnJheSBhcyAkYykgew0KICAgICAgICAgICAgJHRoaXMtPmNhdGVnb3JpZXNbJGMtPklEXSA9ICRjOw0KICAgICAgICB9DQoNCiAgICAgICAgZm9yZWFjaCAoJHRoaXMtPmNhdGVnb3JpZXMgYXMgJGlkID0+ICRjKSB7DQogICAgICAgICAgICAkbCA9ICdsdicgLiAkYy0+TGV2ZWw7DQogICAgICAgICAgICAkeyRsfVskYy0+UGFyZW50SURdW10gPSAkaWQ7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoIWlzX2FycmF5KCRsdjBbMF0pKSB7DQogICAgICAgICAgICAkbHYwWzBdID0gYXJyYXkoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8qDQogICAgICAgICAqIOS7peS4i+Weg+WcvuS7o+egge+8jOW/hemhu+mHjeaehO+8gQ0KICAgICAgICAgKi8NCiAgICAgICAgZm9yZWFjaCAoJGx2MFswXSBhcyAkaWQwKSB7DQogICAgICAgICAgICAkdGhpcy0+Y2F0ZWdvcmllc2J5b3JkZXJbJGlkMF0gPSAmJHRoaXMtPmNhdGVnb3JpZXNbJGlkMF07DQogICAgICAgICAgICBpZiAoIWlzc2V0KCRsdjFbJGlkMF0pKSB7DQogICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBmb3JlYWNoICgkbHYxWyRpZDBdIGFzICRpZDEpIHsNCiAgICAgICAgICAgICAgICBpZiAoJHRoaXMtPmNhdGVnb3JpZXNbJGlkMV0tPlBhcmVudElEID09ICRpZDApIHsNCiAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmNhdGVnb3JpZXNbJGlkMV0tPlJvb3RJRCA9ICRpZDA7DQogICAgICAgICAgICAgICAgICAgICR0aGlzLT5jYXRlZ29yaWVzWyRpZDBdLT5TdWJDYXRlZ29yaWVzW10gPSAkdGhpcy0+Y2F0ZWdvcmllc1skaWQxXTsNCiAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmNhdGVnb3JpZXNbJGlkMF0tPkNoaWxkcmVuQ2F0ZWdvcmllc1tdID0gJHRoaXMtPmNhdGVnb3JpZXNbJGlkMV07DQogICAgICAgICAgICAgICAgICAgICR0aGlzLT5jYXRlZ29yaWVzYnlvcmRlclskaWQxXSA9ICYkdGhpcy0+Y2F0ZWdvcmllc1skaWQxXTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCFpc3NldCgkbHYyWyRpZDFdKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZm9yZWFjaCAoJGx2MlskaWQxXSBhcyAkaWQyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHRoaXMtPmNhdGVnb3JpZXNbJGlkMl0tPlBhcmVudElEID09ICRpZDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+Y2F0ZWdvcmllc1skaWQyXS0+Um9vdElEID0gJGlkMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+Y2F0ZWdvcmllc1skaWQwXS0+Q2hpbGRyZW5DYXRlZ29yaWVzW10gPSAkdGhpcy0+Y2F0ZWdvcmllc1skaWQyXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+Y2F0ZWdvcmllc1skaWQxXS0+U3ViQ2F0ZWdvcmllc1tdID0gJHRoaXMtPmNhdGVnb3JpZXNbJGlkMl07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmNhdGVnb3JpZXNbJGlkMV0tPkNoaWxkcmVuQ2F0ZWdvcmllc1tdID0gJHRoaXMtPmNhdGVnb3JpZXNbJGlkMl07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmNhdGVnb3JpZXNieW9yZGVyWyRpZDJdID0gJiR0aGlzLT5jYXRlZ29yaWVzWyRpZDJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNzZXQoJGx2M1skaWQyXSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcmVhY2ggKCRsdjNbJGlkMl0gYXMgJGlkMykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHRoaXMtPmNhdGVnb3JpZXNbJGlkM10tPlBhcmVudElEID09ICRpZDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5jYXRlZ29yaWVzWyRpZDNdLT5Sb290SUQgPSAkaWQwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmNhdGVnb3JpZXNbJGlkMF0tPkNoaWxkcmVuQ2F0ZWdvcmllc1tdID0gJHRoaXMtPmNhdGVnb3JpZXNbJGlkM107DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+Y2F0ZWdvcmllc1skaWQxXS0+Q2hpbGRyZW5DYXRlZ29yaWVzW10gPSAkdGhpcy0+Y2F0ZWdvcmllc1skaWQzXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5jYXRlZ29yaWVzWyRpZDJdLT5TdWJDYXRlZ29yaWVzW10gPSAkdGhpcy0+Y2F0ZWdvcmllc1skaWQzXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5jYXRlZ29yaWVzWyRpZDJdLT5DaGlsZHJlbkNhdGVnb3JpZXNbXSA9ICR0aGlzLT5jYXRlZ29yaWVzWyRpZDNdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmNhdGVnb3JpZXNieW9yZGVyWyRpZDNdID0gJiR0aGlzLT5jYXRlZ29yaWVzWyRpZDNdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6L295YWl5qCH562+5YiX6KGoLg0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIExvYWRUYWdzKCkNCiAgICB7DQogICAgICAgICR0aGlzLT50YWdzID0gYXJyYXkoKTsNCiAgICAgICAgJHRoaXMtPnRhZ3NieW5hbWUgPSBhcnJheSgpOw0KICAgICAgICAkYXJyYXkgPSAkdGhpcy0+R2V0VGFnTGlzdCgpOw0KICAgICAgICBmb3JlYWNoICgkYXJyYXkgYXMgJHQpIHsNCiAgICAgICAgICAgICR0aGlzLT50YWdzWyR0LT5JRF0gPSAkdDsNCiAgICAgICAgICAgICR0aGlzLT50YWdzYnluYW1lWyR0LT5OYW1lXSA9ICYkdGhpcy0+dGFnc1skdC0+SURdOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6L295YWl5qih5Z2X5YiX6KGoLg0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIExvYWRNb2R1bGVzKCkNCiAgICB7DQogICAgICAgICR0aGlzLT5tb2R1bGVzID0gYXJyYXkoKTsNCiAgICAgICAgJHRoaXMtPm1vZHVsZXNieWZpbGVuYW1lID0gYXJyYXkoKTsNCiAgICAgICAgJGFycmF5ID0gJHRoaXMtPkdldE1vZHVsZUxpc3QoKTsNCiAgICAgICAgZm9yZWFjaCAoJGFycmF5IGFzICRtKSB7DQogICAgICAgICAgICAkdGhpcy0+bW9kdWxlc1tdID0gJG07DQogICAgICAgICAgICAkdGhpcy0+bW9kdWxlc2J5ZmlsZW5hbWVbJG0tPkZpbGVOYW1lXSA9ICRtOw0KICAgICAgICB9DQoNCiAgICAgICAgJGRpciA9ICR0aGlzLT51c2Vyc2RpciAuICd0aGVtZS8nIC4gJHRoaXMtPnRoZW1lIC4gJy9pbmNsdWRlLyc7DQogICAgICAgIGlmIChmaWxlX2V4aXN0cygkZGlyKSkgew0KICAgICAgICAgICAgJGZpbGVzID0gR2V0RmlsZXNJbkRpcigkZGlyLCAncGhwJyk7DQogICAgICAgICAgICBmb3JlYWNoICgkZmlsZXMgYXMgJHNvcnRuYW1lID0+ICRmdWxsbmFtZSkgew0KICAgICAgICAgICAgICAgICRtID0gbmV3IE1vZHVsZSgpOw0KICAgICAgICAgICAgICAgICRtLT5GaWxlTmFtZSA9ICRzb3J0bmFtZTsNCiAgICAgICAgICAgICAgICAkbS0+TmFtZSA9ICRtLT5GaWxlTmFtZTsNCiAgICAgICAgICAgICAgICAkbS0+SHRtbElEID0gJG0tPkZpbGVOYW1lOw0KICAgICAgICAgICAgICAgICRtLT5Db250ZW50ID0gZmlsZV9nZXRfY29udGVudHMoJGZ1bGxuYW1lKTsNCiAgICAgICAgICAgICAgICBpZiAoIHN0cmlwb3MoJG0tPkNvbnRlbnQsJzxsaScpICE9PSBmYWxzZSAmJiBzdHJpcG9zKCRtLT5Db250ZW50LCc8L2xpPicpICE9PSBmYWxzZSApIHsNCiAgICAgICAgICAgICAgICAgICAgJG0tPlR5cGUgPSAndWwnOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICRtLT5UeXBlID0gJ2Rpdic7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICRtLT5Tb3VyY2UgPSAndGhlbWVpbmNsdWRlXycgLiAkdGhpcy0+dGhlbWU7Ow0KICAgICAgICAgICAgICAgICRtLT5Jc0luY2x1ZGVGaWxlID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAkdGhpcy0+bW9kdWxlc1tdID0gJG07DQogICAgICAgICAgICAgICAgJHRoaXMtPm1vZHVsZXNieWZpbGVuYW1lWyRtLT5GaWxlTmFtZV0gPSAkbTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOi9veWFpeS4u+mimOWIl+ihqC4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gQXBwW10NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gTG9hZFRoZW1lcygpDQogICAgew0KICAgICAgICAkYWxsVGhlbWVzID0gYXJyYXkoKTsNCiAgICAgICAgJGRpcnMgPSBHZXREaXJzSW5EaXIoJHRoaXMtPnVzZXJzZGlyIC4gJ3RoZW1lLycpOw0KICAgICAgICBuYXRjYXNlc29ydCgkZGlycyk7DQogICAgICAgIGFycmF5X3Vuc2hpZnQoJGRpcnMsICR0aGlzLT50aGVtZSk7DQogICAgICAgICRkaXJzID0gYXJyYXlfdW5pcXVlKCRkaXJzKTsNCiAgICAgICAgZm9yZWFjaCAoJGRpcnMgYXMgJGlkKSB7DQogICAgICAgICAgICAkYXBwID0gbmV3IEFwcCgpOw0KICAgICAgICAgICAgaWYgKCRhcHAtPkxvYWRJbmZvQnlYbWwoJ3RoZW1lJywgJGlkKSA9PSB0cnVlKSB7DQogICAgICAgICAgICAgICAgJGFsbFRoZW1lc1tdID0gJGFwcDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAkYWxsVGhlbWVzOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOi9veWFpeaPkuS7tuWIl+ihqC4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gQXBwW10NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gTG9hZFBsdWdpbnMoKQ0KICAgIHsNCiAgICAgICAgJGFsbFBsdWdpbnMgPSBhcnJheSgpOw0KICAgICAgICAkZGlycyA9IEdldERpcnNJbkRpcigkdGhpcy0+dXNlcnNkaXIgLiAncGx1Z2luLycpOw0KICAgICAgICBuYXRjYXNlc29ydCgkZGlycyk7DQoNCiAgICAgICAgZm9yZWFjaCAoJGRpcnMgYXMgJGlkKSB7DQogICAgICAgICAgICAkYXBwID0gbmV3IEFwcCgpOw0KICAgICAgICAgICAgaWYgKCRhcHAtPkxvYWRJbmZvQnlYbWwoJ3BsdWdpbicsICRpZCkgPT0gdHJ1ZSkgew0KICAgICAgICAgICAgICAgICRhbGxQbHVnaW5zW10gPSAkYXBwOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICRhbGxQbHVnaW5zOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOi9veWFpeaMh+WumuW6lOeUqC4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHR5cGUg5bqU55So57G75Z6LKHRoZW1lfHBsdWdpbikNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRpZCAgIOW6lOeUqElEDQogICAgICoNCiAgICAgKiBAcmV0dXJuIEFwcA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBMb2FkQXBwKCR0eXBlLCAkaWQpDQogICAgew0KICAgICAgICAkYXBwID0gbmV3IEFwcCgpOw0KICAgICAgICBpZiAoJGFwcC0+TG9hZEluZm9CeVhtbCgkdHlwZSwgJGlkKSAhPSB0cnVlKSB7DQogICAgICAgICAgICAkYXBwLT5pc2xvYWRlZCA9IGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICRhcHA7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5qOA5p+l5bqU55So5piv5ZCm5a6J6KOF5bm25ZCv55SoLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbmFtZSDlupTnlKjvvIjmj5Lku7bmiJbkuLvpopjvvInnmoRJRA0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIENoZWNrUGx1Z2luKCRuYW1lKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuIGluX2FycmF5KCRuYW1lLCAkdGhpcy0+YWN0aXZlZGFwcHMpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOajgOafpeW6lOeUqOaYr+WQpuWuieijheW5tuWQr+eUqC4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUg5bqU55SoSUTvvIjmj5Lku7bmiJbkuLvpopjvvIkNCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBDaGVja0FwcCgkbmFtZSkNCiAgICB7DQogICAgICAgIHJldHVybiAkdGhpcy0+Q2hlY2tQbHVnaW4oJG5hbWUpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOiOt+WPlumihOa/gOa0u+aPkuS7tuWQjeaVsOe7hC4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gc3RyaW5nW10NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0UHJlQWN0aXZlUGx1Z2luKCkNCiAgICB7DQogICAgICAgICRhcCA9IGV4cGxvZGUoInwiLCAkdGhpcy0+b3B0aW9uWydaQ19VU0lOR19QTFVHSU5fTElTVCddKTsNCiAgICAgICAgJGFwID0gYXJyYXlfdW5pcXVlKCRhcCk7DQoNCiAgICAgICAgcmV0dXJuICRhcDsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDovb3lhaXmjIflrprlupTnlKjor63oqIDljIUuDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICR0eXBlICAgIOW6lOeUqOexu+WeiyhzeXN0ZW18dGhlbWV8cGx1Z2luKQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgJGlkICAgICAg5bqU55SoSUQNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRkZWZhdWx0IOm7mOiupOivreiogA0KICAgICAqDQogICAgICogQHRocm93cyBFeGNlcHRpb24NCiAgICAgKg0KICAgICAqIEByZXR1cm4gbnVsbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBMb2FkTGFuZ3VhZ2UoJHR5cGUsICRpZCwgJGRlZmF1bHQgPSAnJykNCiAgICB7DQogICAgICAgICRsYW5ndWFnZVBhdGggPSAkdGhpcy0+cGF0aDsNCiAgICAgICAgJGxhbmd1YWdlUmVnRXggPSAnL14oWzAtOUEtWlwtX10qKVwucGhwJC91aSc7DQogICAgICAgICRsYW5ndWFnZUxpc3QgPSBhcnJheSgpOw0KICAgICAgICAkbGFuZ3VhZ2UgPSAnJzsNCiAgICAgICAgJGRlZmF1bHQgPSBzdHJfcmVwbGFjZShhcnJheSgnLycsICdcXCcpLCAnJywgJGRlZmF1bHQpOw0KICAgICAgICAkbGFuZ3VhZ2VQdHIgPSAmJHRoaXMtPmxhbmc7DQoNCiAgICAgICAgaWYgKCRkZWZhdWx0ID09PSAnJykgew0KICAgICAgICAgICAgJGRlZmF1bHQgPSAkdGhpcy0+b3B0aW9uWydaQ19CTE9HX0xBTkdVQUdFUEFDSyddOw0KICAgICAgICB9DQoNCiAgICAgICAgJGRlZmF1bHRMYW5ndWFnZUxpc3QgPSBhcnJheSgkZGVmYXVsdCwgJ3poLWNuJywgJ3poLXR3JywgJ2VuJyk7DQoNCiAgICAgICAgc3dpdGNoICgkdHlwZSkgew0KICAgICAgICAgICAgY2FzZSAnc3lzdGVtJzoNCiAgICAgICAgICAgICAgICAkbGFuZ3VhZ2VQYXRoIC49ICd6Yl91c2Vycy9sYW5ndWFnZS8nOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAncGx1Z2luJzoNCiAgICAgICAgICAgIGNhc2UgJ3RoZW1lJzoNCiAgICAgICAgICAgICAgICAkbGFuZ3VhZ2VQYXRoIC49ICd6Yl91c2Vycy8nIC4gJHR5cGUgLiAnLycgLiAkaWQgLiAnL2xhbmd1YWdlLyc7DQogICAgICAgICAgICAgICAgJGxhbmd1YWdlUHRyID0gJiR0aGlzLT5sYW5nWyRpZF07DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgICAgICRsYW5ndWFnZVBhdGggLj0gJHR5cGUgLiAnL2xhbmd1YWdlLyc7DQogICAgICAgICAgICAgICAgJGxhbmd1YWdlUHRyID0gJiR0aGlzLT5sYW5nWyRpZF07DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIH0NCg0KICAgICAgICAkaGFuZGxlID0gQG9wZW5kaXIoJGxhbmd1YWdlUGF0aCk7DQogICAgICAgICRtYXRjaCA9IG51bGw7DQogICAgICAgIGlmICgkaGFuZGxlKSB7DQogICAgICAgICAgICB3aGlsZSAoZmFsc2UgIT09ICgkZmlsZSA9IHJlYWRkaXIoJGhhbmRsZSkpKSB7DQogICAgICAgICAgICAgICAgaWYgKHByZWdfbWF0Y2goJGxhbmd1YWdlUmVnRXgsICRmaWxlLCAkbWF0Y2gpKSB7DQogICAgICAgICAgICAgICAgICAgICRsYW5ndWFnZUxpc3RbXSA9ICRtYXRjaFsxXTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBjbG9zZWRpcigkaGFuZGxlKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIC8vIOi/memHjOS4jeS8muaJp+ihjOWIsO+8jOWcqG9wZW5kaXLml7blsLHlt7Lnu4/mipvlh7pFX1dBUk5JTkcNCiAgICAgICAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oJ0Nhbm5vdCBvcGVuZGlyKCcgLiAkbGFuZ3VhZ2VQYXRoIC4gJyknKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChjb3VudCgkbGFuZ3VhZ2VMaXN0KSA9PT0gMCkgew0KICAgICAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbignTm8gbGFuZ3VhZ2UgaW4gJyAuICRsYW5ndWFnZVBhdGgpOw0KICAgICAgICB9DQoNCiAgICAgICAgZm9yICgkaSA9IDA7ICRpIDwgY291bnQoJGRlZmF1bHRMYW5ndWFnZUxpc3QpOyAkaSsrKSB7DQogICAgICAgICAgICAvLyDlnKjmlYjnjofkuIrvvIxhcnJheV9zZWFyY2jlkozlkb3lkI3mlbDnu4TmsqHmnInmnKzotKjljLrliKvvvIzoh7PlsJHlnKjov5nph4zlpoLmraTjgIINCiAgICAgICAgICAgIGlmIChmYWxzZSAhPT0gYXJyYXlfc2VhcmNoKCRkZWZhdWx0TGFuZ3VhZ2VMaXN0WyRpXSwgJGxhbmd1YWdlTGlzdCkpIHsNCiAgICAgICAgICAgICAgICAkbGFuZ3VhZ2UgPSAkZGVmYXVsdExhbmd1YWdlTGlzdFskaV07DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgaWYgKCRsYW5ndWFnZSA9PT0gJycpIHsNCiAgICAgICAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oJ0xhbmd1YWdlICcgLiAkZGVmYXVsdCAuICcgaXMgbm90IGZvdW5kIGluICcgLiAkbGFuZ3VhZ2VQYXRoKTsNCiAgICAgICAgfQ0KDQogICAgICAgICRsYW5ndWFnZVBhdGggLj0gJGxhbmd1YWdlIC4gJy5waHAnOw0KICAgICAgICAkbGFuZ3VhZ2VQdHIgPSByZXF1aXJlICRsYW5ndWFnZVBhdGg7DQogICAgICAgICR0aGlzLT5sYW5ncGFja2xpc3RbXSA9IGFycmF5KCR0eXBlLCAkaWQsICRsYW5ndWFnZSk7DQogICAgICAgIGlmICgkdHlwZSA9PSAnc3lzdGVtJykgew0KICAgICAgICAgICAgJHRoaXMtPmxhbmdzID0ganNvbl9kZWNvZGUoanNvbl9lbmNvZGUoJHRoaXMtPmxhbmcpKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGlmICgkaWQgIT0gJycgJiYgaXNzZXQoJHRoaXMtPmxhbmdbJGlkXSkpIHsNCiAgICAgICAgICAgICAgICAkdGhpcy0+bGFuZ3MtPiRpZCA9IGpzb25fZGVjb2RlKGpzb25fZW5jb2RlKCR0aGlzLT5sYW5nWyRpZF0pKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIHB1YmxpYyBmdW5jdGlvbiBSZWZsdXNoTGFuZ3VhZ2VzKCkNCiAgICB7DQogICAgICAgICR0aGlzLT5sYW5nWydlcnJvciddWyc3NyddID0gc3RyX3JlcGxhY2UoYXJyYXkoJyVtaW4nLCAnJW1heCcpLCBhcnJheSgkdGhpcy0+b3B0aW9uWydaQ19VU0VSTkFNRV9NSU4nXSwgJHRoaXMtPm9wdGlvblsnWkNfVVNFUk5BTUVfTUFYJ10pLCAkdGhpcy0+bGFuZ1snZXJyb3InXVsnNzcnXSk7DQogICAgICAgICR0aGlzLT5sYW5ncyA9IGpzb25fZGVjb2RlKGpzb25fZW5jb2RlKCR0aGlzLT5sYW5nKSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YeN5paw6K+75Y+W6K+t6KiA5YyFLg0KICAgICAqDQogICAgICogQHRocm93cyBFeGNlcHRpb24NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gUmVsb2FkTGFuZ3VhZ2VzKCkNCiAgICB7DQogICAgICAgICRhcnJheSA9ICR0aGlzLT5sYW5ncGFja2xpc3Q7DQogICAgICAgICR0aGlzLT5sYW5nID0gJHRoaXMtPmxhbmdwYWNrbGlzdCA9IGFycmF5KCk7DQogICAgICAgIGZvcmVhY2ggKCRhcnJheSBhcyAkdikgew0KICAgICAgICAgICAgJHRoaXMtPkxvYWRMYW5ndWFnZSgkdlswXSwgJHZbMV0sICR2WzJdKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWIm+W7uuaooeadv+Wvueixoe+8jOmihOWKoOi9veW3sue8luivkeaooeadvw0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkdGhlbWUg5oyH5a6a5Li76aKY5ZCNDQogICAgICoNCiAgICAgKiBAcmV0dXJuIFRlbXBsYXRlDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFByZXBhcmVUZW1wbGF0ZSgkdGhlbWUgPSBudWxsKQ0KICAgIHsNCiAgICAgICAgaWYgKGlzX251bGwoJHRoZW1lKSkgew0KICAgICAgICAgICAgJHRoZW1lID0gJiR0aGlzLT50aGVtZTsNCiAgICAgICAgfQ0KDQogICAgICAgICR0ZW1wbGF0ZSA9IG5ldyBUZW1wbGF0ZSgpOw0KICAgICAgICAkdGVtcGxhdGUtPk1ha2VUZW1wbGF0ZVRhZ3MoKTsNCg0KICAgICAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9aYnBfTWFrZVRlbXBsYXRldGFncyddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAgICAgJGZwbmFtZSgkdGVtcGxhdGUtPnRlbXBsYXRlVGFncyk7DQogICAgICAgIH0NCg0KICAgICAgICAkdGVtcGxhdGUtPlNldFBhdGgoJHRoaXMtPnVzZXJzZGlyIC4gJ2NhY2hlL2NvbXBpbGVkLycgLiAkdGhlbWUgLiAnLycpOw0KICAgICAgICAkdGVtcGxhdGUtPnRoZW1lID0gJHRoZW1lOw0KDQogICAgICAgICR0ZW1wbGF0ZS0+TG9hZFRlbXBsYXRlcygpOw0KDQogICAgICAgIHJldHVybiAkdGVtcGxhdGU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5qih5p2/6Kej5p6QLg0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEJ1aWxkVGVtcGxhdGUoKQ0KICAgIHsNCiAgICAgICAgJHRoaXMtPnRlbXBsYXRlLT5Mb2FkVGVtcGxhdGVzKCk7DQoNCiAgICAgICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fWmJwX0J1aWxkVGVtcGxhdGUnXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgICAgICRmcG5hbWUoJHRoaXMtPnRlbXBsYXRlLT50ZW1wbGF0ZXMpOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICR0aGlzLT50ZW1wbGF0ZS0+QnVpbGRUZW1wbGF0ZSgpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOabtOaWsOaooeadv+e8k+WtmC4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBib29sICRvbmx5Y2hlY2sgIOS4uuecn+eahOivne+8jOWPquWIpOaWreaYr+WQpumcgOimgeiAjOS4jUJ1aWxkDQogICAgICogQHBhcmFtIGJvb2wgJGZvcmNlYnVpbGQNCiAgICAgKg0KICAgICAqIEByZXR1cm4gdHJ1ZSBvciBmYWxzZQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBDaGVja1RlbXBsYXRlKCRvbmx5Y2hlY2sgPSBmYWxzZSwgJGZvcmNlYnVpbGQgPSBmYWxzZSkNCiAgICB7DQogICAgICAgICR0aGlzLT50ZW1wbGF0ZS0+TG9hZFRlbXBsYXRlcygpOw0KICAgICAgICAkcyA9IGltcGxvZGUoJHRoaXMtPnRlbXBsYXRlLT50ZW1wbGF0ZXMpOw0KICAgICAgICAkbWQ1ID0gbWQ1KCRzKTsNCg0KICAgICAgICAvL+acrOWHveaVsOeahOi/lOWbnuWAvOW+iOacieaEj+aAne+8jOS4umZhbHNl6KGo56S66ZyA6KaBcmVidWlsZCDkuLp0cnVl6KGo56S65bey6YeN5bu65a6M5oiQ5oiW5piv5LiN6ZyA6KaBcmVidWlsZA0KICAgICAgICAvLyR6YnAtPkNoZWNrVGVtcGxhdGUodHJ1ZSkgPT0gZmFsc2Ug55qE5oSP5oCd77yM5bCx5piv5Yik5pat5qih5p2/6ZyA6ZyA6KaB6YeN5Yi35paw5ZCX77yfDQoNCiAgICAgICAgLy/lpoLmnpzlr7nmr5TkuI3kuIDmoLcsJG9ubHljaGVja+WwseacieeUqOS6hg0KICAgICAgICBpZiAoJG1kNSAhPSAkdGhpcy0+Y2FjaGUtPnRlbXBsYXRlc19tZDUpIHsNCiAgICAgICAgICAgIGlmICgkb25seWNoZWNrID09IHRydWUgJiYgJGZvcmNlYnVpbGQgPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICB9DQogICAgICAgICAgICAkdGhpcy0+QnVpbGRUZW1wbGF0ZSgpOw0KICAgICAgICAgICAgJHRoaXMtPmNhY2hlLT50ZW1wbGF0ZXNfbWQ1ID0gJG1kNTsNCiAgICAgICAgICAgICR0aGlzLT5TYXZlQ2FjaGUoKTsNCg0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0NCiAgICAgICAgLy/lpoLmnpzlr7nmr5TkuIDmoLfnmoTor53vvIwkZm9yY2VidWlsZOWwseacieeUqOS6hg0KICAgICAgICBpZiAoJG1kNSA9PSAkdGhpcy0+Y2FjaGUtPnRlbXBsYXRlc19tZDUpIHsNCiAgICAgICAgICAgIGlmICgkZm9yY2VidWlsZCA9PSB0cnVlKSB7DQogICAgICAgICAgICAgICAgJHRoaXMtPkJ1aWxkVGVtcGxhdGUoKTsNCiAgICAgICAgICAgICAgICAkdGhpcy0+Y2FjaGUtPnRlbXBsYXRlc19tZDUgPSAkbWQ1Ow0KICAgICAgICAgICAgICAgICR0aGlzLT5TYXZlQ2FjaGUoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOeUn+aIkOaJgOaciei/m1JlYWR5IExpc3TnmoTmqKHlnZfnmoRDb250ZW505YaF5a655bm25L+d5a2YLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBCdWlsZE1vZHVsZSgpDQogICAgew0KICAgICAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9aYnBfQnVpbGRNb2R1bGUnXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgICAgICRmcG5hbWUoKTsNCiAgICAgICAgfQ0KICAgICAgICBNb2R1bGVCdWlsZGVyOjpCdWlsZCgpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmHjeW7uuaooeWdly4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG1vZHVsZUZpbGVOYW1lIOaooeWdl+WQjQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG1vZHVsZUZ1bmN0aW9uIOeUqOaIt+WHveaVsA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBSZWdCdWlsZE1vZHVsZSgkbW9kdWxlRmlsZU5hbWUsICRtb2R1bGVGdW5jdGlvbikNCiAgICB7DQogICAgICAgIE1vZHVsZUJ1aWxkZXI6OlJlZygkbW9kdWxlRmlsZU5hbWUsICRtb2R1bGVGdW5jdGlvbik7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog57O757uf6buY6K6k5rOo5YaM5qih5Z2XLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBSZWdCdWlsZE1vZHVsZXMoKQ0KICAgIHsNCiAgICAgICAgJHRoaXMtPlJlZ0J1aWxkTW9kdWxlKCdjYXRhbG9nJywgJ01vZHVsZUJ1aWxkZXI6OkNhdGFsb2cnKTsNCiAgICAgICAgJHRoaXMtPlJlZ0J1aWxkTW9kdWxlKCdjYWxlbmRhcicsICdNb2R1bGVCdWlsZGVyOjpDYWxlbmRhcicpOw0KICAgICAgICAkdGhpcy0+UmVnQnVpbGRNb2R1bGUoJ2NvbW1lbnRzJywgJ01vZHVsZUJ1aWxkZXI6OkNvbW1lbnRzJyk7DQogICAgICAgICR0aGlzLT5SZWdCdWlsZE1vZHVsZSgncHJldmlvdXMnLCAnTW9kdWxlQnVpbGRlcjo6TGF0ZXN0QXJ0aWNsZXMnKTsNCiAgICAgICAgJHRoaXMtPlJlZ0J1aWxkTW9kdWxlKCdhcmNoaXZlcycsICdNb2R1bGVCdWlsZGVyOjpBcmNoaXZlcycpOw0KICAgICAgICAkdGhpcy0+UmVnQnVpbGRNb2R1bGUoJ25hdmJhcicsICdNb2R1bGVCdWlsZGVyOjpOYXZiYXInKTsNCiAgICAgICAgJHRoaXMtPlJlZ0J1aWxkTW9kdWxlKCd0YWdzJywgJ01vZHVsZUJ1aWxkZXI6OlRhZ0xpc3QnKTsNCiAgICAgICAgJHRoaXMtPlJlZ0J1aWxkTW9kdWxlKCdzdGF0aXN0aWNzJywgJ01vZHVsZUJ1aWxkZXI6OlN0YXRpc3RpY3MnKTsNCiAgICAgICAgJHRoaXMtPlJlZ0J1aWxkTW9kdWxlKCdhdXRob3JzJywgJ01vZHVsZUJ1aWxkZXI6OkF1dGhvcnMnKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmt7vliqDov5vlhaVCdWlsZCBSZWFkeeWIl+ihqOeahOaooeWdly4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG1vZHVsZUZpbGVOYW1lIOaooeWdl+WQjQ0KICAgICAqIEBwYXJhbSBudWxsICAgJHBhcmFtZXRlcnMgICAgIOaooeWdl+WPguaVsA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBBZGRCdWlsZE1vZHVsZSgkbW9kdWxlRmlsZU5hbWUsICRwYXJhbWV0ZXJzID0gbnVsbCkNCiAgICB7DQogICAgICAgICRwID0gZnVuY19nZXRfYXJncygpOw0KICAgICAgICBjYWxsX3VzZXJfZnVuY19hcnJheSgnTW9kdWxlQnVpbGRlcjo6QWRkJywgJHApOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWIoOmZpOi/m+WFpUJ1aWxkIFJlYWR55YiX6KGo5qih5Z2XLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbW9kdWxlRmlsZU5hbWUg5qih5Z2X5ZCNDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIERlbEJ1aWxkTW9kdWxlKCRtb2R1bGVGaWxlTmFtZSkNCiAgICB7DQogICAgICAgIE1vZHVsZUJ1aWxkZXI6OkRlbCgkbW9kdWxlRmlsZU5hbWUpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOafpeivouaMh+WumuaVsOaNrue7k+aehOeahHNxbOW5tui/lOWbnkJhc2Xlr7nosaHliJfooaguDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nfGFycmF5ICR0YWJsZSAgICDmlbDmja7ooagNCiAgICAgKiBAcGFyYW0gYXJyYXkgICAgICAgICRkYXRhaW5mbyDmlbDmja7lrZfmrrUNCiAgICAgKiBAcGFyYW0gc3RyaW5nICAgICAgICRzcWwgICAgICBTUUzmk43kvZzor63lj6UNCiAgICAgKg0KICAgICAqIEByZXR1cm4gYXJyYXkNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0TGlzdEN1c3RvbSgkdGFibGUsICRkYXRhaW5mbywgJHNxbCkNCiAgICB7DQogICAgICAgICRhcnJheSA9IG51bGw7DQogICAgICAgICRsaXN0ID0gYXJyYXkoKTsNCiAgICAgICAgJGFycmF5ID0gJHRoaXMtPmRiLT5RdWVyeSgkc3FsKTsNCiAgICAgICAgaWYgKCFpc3NldCgkYXJyYXkpKSB7DQogICAgICAgICAgICByZXR1cm4gYXJyYXkoKTsNCiAgICAgICAgfQ0KICAgICAgICBmb3JlYWNoICgkYXJyYXkgYXMgJGEpIHsNCiAgICAgICAgICAgICRsID0gbmV3IEJhc2UoJHRhYmxlLCAkZGF0YWluZm8pOw0KICAgICAgICAgICAgJGwtPkxvYWRJbmZvQnlBc3NvYygkYSk7DQogICAgICAgICAgICAkbGlzdFtdID0gJGw7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJGxpc3Q7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5p+l6K+iSUTmlbDmja7nmoTmjIflrprmlbDmja7nu5PmnoTnmoRzcWzlubbov5Tlm55CYXNl5a+56LGh5YiX6KGoLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZ3xhcnJheSAkdGFibGUgICAg5pWw5o2u6KGoDQogICAgICogQHBhcmFtIGFycmF5ICAgICAgICAkZGF0YWluZm8g5pWw5o2u5a2X5q61DQogICAgICogQHBhcmFtIGFycmF5ICAgICAgICAkYXJyYXkgICAgSUTmlbDnu4QNCiAgICAgKg0KICAgICAqIEByZXR1cm4gQmFzZVtdDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldExpc3RDdXN0b21CeUFycmF5KCR0YWJsZSwgJGRhdGFpbmZvLCAkYXJyYXkpDQogICAgew0KICAgICAgICBpZiAoIWlzX2FycmF5KCRhcnJheSkpIHsNCiAgICAgICAgICAgIHJldHVybiBhcnJheSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKGNvdW50KCRhcnJheSkgPT0gMCkgew0KICAgICAgICAgICAgcmV0dXJuIGFycmF5KCk7DQogICAgICAgIH0NCg0KICAgICAgICAkd2hlcmUgPSBhcnJheSgpOw0KICAgICAgICAkd2hlcmVbXSA9IGFycmF5KCdJTicsICRkYXRhaW5mb1snSUQnXVswXSwgaW1wbG9kZSgnLCcsICRhcnJheSkpOw0KICAgICAgICAkc3FsID0gJHRoaXMtPmRiLT5zcWwtPlNlbGVjdCgkdGFibGUsICcqJywgJHdoZXJlKTsNCiAgICAgICAgJGFycmF5ID0gbnVsbDsNCiAgICAgICAgJGxpc3QgPSBhcnJheSgpOw0KICAgICAgICAkYXJyYXkgPSAkdGhpcy0+ZGItPlF1ZXJ5KCRzcWwpOw0KICAgICAgICBpZiAoIWlzc2V0KCRhcnJheSkpIHsNCiAgICAgICAgICAgIHJldHVybiBhcnJheSgpOw0KICAgICAgICB9DQogICAgICAgIGZvcmVhY2ggKCRhcnJheSBhcyAkYSkgew0KICAgICAgICAgICAgJGwgPSBuZXcgQmFzZSgkdGFibGUsICRkYXRhaW5mbyk7DQogICAgICAgICAgICAkbC0+TG9hZEluZm9CeUFzc29jKCRhKTsNCiAgICAgICAgICAgICRsaXN0W10gPSAkbDsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAkbGlzdDsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDlt7LmlLnlkI1HZXRMaXN0VHlwZSwxLjXniYjkuK3miZTmjonmnInmrafkuYnnmoRHZXRMaXN0Lg0KICAgICAqDQogICAgICogQHBhcmFtICR0eXBlDQogICAgICogQHBhcmFtICRzcWwNCiAgICAgKg0KICAgICAqIEByZXR1cm4gQmFzZVtdDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldExpc3RUeXBlKCR0eXBlLCAkc3FsKQ0KICAgIHsNCiAgICAgICAgJGFycmF5ID0gbnVsbDsNCiAgICAgICAgJGxpc3QgPSBhcnJheSgpOw0KICAgICAgICAkYXJyYXkgPSAkdGhpcy0+ZGItPlF1ZXJ5KCRzcWwpOw0KICAgICAgICBpZiAoIWlzc2V0KCRhcnJheSkpIHsNCiAgICAgICAgICAgIHJldHVybiBhcnJheSgpOw0KICAgICAgICB9DQogICAgICAgIGZvcmVhY2ggKCRhcnJheSBhcyAkYSkgew0KICAgICAgICAgICAgLyoqIEB2YXIgQmFzZSAkbCAqLw0KICAgICAgICAgICAgJGwgPSBuZXcgJHR5cGUoKTsNCiAgICAgICAgICAgICRsLT5Mb2FkSW5mb0J5QXNzb2MoJGEpOw0KICAgICAgICAgICAgJGxpc3RbXSA9ICRsOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICRsaXN0Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEdldExpc3RPcmlnaW4uDQogICAgICoNCiAgICAgKiBAcGFyYW0gJHNxbA0KICAgICAqDQogICAgICogQHJldHVybiBCYXNlW10NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0TGlzdE9yaWdpbigkc3FsKQ0KICAgIHsNCiAgICAgICAgJGFycmF5ID0gbnVsbDsNCiAgICAgICAgJGxpc3QgPSBhcnJheSgpOw0KICAgICAgICAkYXJyYXkgPSAkdGhpcy0+ZGItPlF1ZXJ5KCRzcWwpOw0KICAgICAgICBpZiAoIWlzc2V0KCRhcnJheSkpIHsNCiAgICAgICAgICAgIHJldHVybiBhcnJheSgpOw0KICAgICAgICB9DQogICAgICAgIGZvcmVhY2ggKCRhcnJheSBhcyAkYSkgew0KICAgICAgICAgICAgJGxpc3RbXSA9ICRhOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICRsaXN0Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOafpeivoklE5pWw5o2u55qE5oyH5a6a57G75Z6L55qEc3Fs5bm26L+U5Zue5oyH5a6a57G75Z6L5a+56LGh5YiX6KGoLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkdHlwZSAg57G75Z6LDQogICAgICogQHBhcmFtIG1peGVkICAkYXJyYXkgSUTmlbDnu4QNCiAgICAgKg0KICAgICAqIEByZXR1cm4gQmFzZVtdDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldExpc3RUeXBlQnlBcnJheSgkdHlwZSwgJGFycmF5KQ0KICAgIHsNCiAgICAgICAgaWYgKCFpc19hcnJheSgkYXJyYXkpKSB7DQogICAgICAgICAgICByZXR1cm4gYXJyYXkoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChjb3VudCgkYXJyYXkpID09IDApIHsNCiAgICAgICAgICAgIHJldHVybiBhcnJheSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgJHdoZXJlID0gYXJyYXkoKTsNCiAgICAgICAgJHdoZXJlW10gPSBhcnJheSgnSU4nLCAkdGhpcy0+ZGF0YWluZm9bJHR5cGVdWydJRCddWzBdLCBpbXBsb2RlKCcsJywgJGFycmF5KSk7DQogICAgICAgICRzcWwgPSAkdGhpcy0+ZGItPnNxbC0+U2VsZWN0KCR0aGlzLT50YWJsZVskdHlwZV0sICcqJywgJHdoZXJlKTsNCiAgICAgICAgJGFycmF5ID0gbnVsbDsNCiAgICAgICAgJGxpc3QgPSBhcnJheSgpOw0KICAgICAgICAkYXJyYXkgPSAkdGhpcy0+ZGItPlF1ZXJ5KCRzcWwpOw0KICAgICAgICBpZiAoIWlzc2V0KCRhcnJheSkpIHsNCiAgICAgICAgICAgIHJldHVybiBhcnJheSgpOw0KICAgICAgICB9DQogICAgICAgIGZvcmVhY2ggKCRhcnJheSBhcyAkYSkgew0KICAgICAgICAgICAgLyoqIEB2YXIgQmFzZSAkbCAqLw0KICAgICAgICAgICAgJGwgPSBuZXcgJHR5cGUoKTsNCiAgICAgICAgICAgICRsLT5Mb2FkSW5mb0J5QXNzb2MoJGEpOw0KICAgICAgICAgICAgJGxpc3RbXSA9ICRsOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICRsaXN0Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBwYXJhbSBtaXhlZCAkc2VsZWN0DQogICAgICogQHBhcmFtIG1peGVkICR3aGVyZQ0KICAgICAqIEBwYXJhbSBtaXhlZCAkb3JkZXINCiAgICAgKiBAcGFyYW0gbWl4ZWQgJGxpbWl0DQogICAgICogQHBhcmFtIG1peGVkICRvcHRpb24NCiAgICAgKg0KICAgICAqIEByZXR1cm4gUG9zdFtdDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFBvc3RMaXN0KCRzZWxlY3QgPSBudWxsLCAkd2hlcmUgPSBudWxsLCAkb3JkZXIgPSBudWxsLCAkbGltaXQgPSBudWxsLCAkb3B0aW9uID0gbnVsbCkNCiAgICB7DQogICAgICAgIGlmIChlbXB0eSgkc2VsZWN0KSkgew0KICAgICAgICAgICAgJHNlbGVjdCA9IGFycmF5KCcqJyk7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGVtcHR5KCR3aGVyZSkpIHsNCiAgICAgICAgICAgICR3aGVyZSA9IGFycmF5KCk7DQogICAgICAgIH0NCiAgICAgICAgJHNxbCA9ICR0aGlzLT5kYi0+c3FsLT5TZWxlY3QoJHRoaXMtPnRhYmxlWydQb3N0J10sICRzZWxlY3QsICR3aGVyZSwgJG9yZGVyLCAkbGltaXQsICRvcHRpb24pOw0KDQogICAgICAgIC8qKiBAdmFyIFBvc3RbXSAkYXJyYXkgKi8NCiAgICAgICAgJGFycmF5ID0gJHRoaXMtPkdldExpc3RUeXBlKCdQb3N0JywgJHNxbCk7DQogICAgICAgIGZvcmVhY2ggKCRhcnJheSBhcyAkYSkgew0KICAgICAgICAgICAgJHRoaXMtPnBvc3RzWyRhLT5JRF0gPSAkYTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAkYXJyYXk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YCa6L+HSUTmlbDnu4Tojrflj5bmlofnq6Dlrp7kvosuDQogICAgICoNCiAgICAgKiBAcGFyYW0gbWl4ZWRbXSAkYXJyYXkNCiAgICAgKg0KICAgICAqIEByZXR1cm4gUG9zdFtdfEJhc2VbXSBQb3N0cw0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRQb3N0QnlBcnJheSgkYXJyYXkpDQogICAgew0KICAgICAgICByZXR1cm4gJHRoaXMtPkdldExpc3RUeXBlQnlBcnJheSgnUG9zdCcsICRhcnJheSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogQHBhcmFtIG1peGVkICRzZWxlY3QNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJHdoZXJlDQogICAgICogQHBhcmFtIG1peGVkICRvcmRlcg0KICAgICAqIEBwYXJhbSBtaXhlZCAkbGltaXQNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJG9wdGlvbg0KICAgICAqIEBwYXJhbSBtaXhlZCAkcmVhZHRhZ3MNCiAgICAgKg0KICAgICAqIEByZXR1cm4gUG9zdFtdDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldEFydGljbGVMaXN0KCRzZWxlY3QgPSBudWxsLCAkd2hlcmUgPSBudWxsLCAkb3JkZXIgPSBudWxsLCAkbGltaXQgPSBudWxsLCAkb3B0aW9uID0gbnVsbCwgJHJlYWR0YWdzID0gdHJ1ZSkNCiAgICB7DQogICAgICAgIGlmIChlbXB0eSgkc2VsZWN0KSkgew0KICAgICAgICAgICAgJHNlbGVjdCA9IGFycmF5KCcqJyk7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGVtcHR5KCR3aGVyZSkpIHsNCiAgICAgICAgICAgICR3aGVyZSA9IGFycmF5KCk7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoaXNfYXJyYXkoJHdoZXJlKSkgew0KICAgICAgICAgICAgJGhhc1R5cGUgPSBmYWxzZTsNCiAgICAgICAgICAgIGZvcmVhY2ggKCR3aGVyZSBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAgICAgICAgIGlmIChpc19hcnJheSgkdmFsdWUpKSB7DQogICAgICAgICAgICAgICAgICAgIGZvcmVhY2ggKCR2YWx1ZSBhcyAka2V5MiA9PiAkdmFsdWUyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoJGtleTIgPT0gMSAmJiAkdmFsdWUyID09ICdsb2dfVHlwZScpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkaGFzVHlwZSA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoISRoYXNUeXBlKSB7DQogICAgICAgICAgICAgICAgYXJyYXlfdW5zaGlmdCgkd2hlcmUsIGFycmF5KCc9JywgJ2xvZ19UeXBlJywgJzAnKSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAkc3FsID0gJHRoaXMtPmRiLT5zcWwtPlNlbGVjdCgkdGhpcy0+dGFibGVbJ1Bvc3QnXSwgJHNlbGVjdCwgJHdoZXJlLCAkb3JkZXIsICRsaW1pdCwgJG9wdGlvbik7DQoNCiAgICAgICAgLyoqIEB2YXIgUG9zdFtdICRhcnJheSAqLw0KICAgICAgICAkYXJyYXkgPSAkdGhpcy0+R2V0TGlzdFR5cGUoJ1Bvc3QnLCAkc3FsKTsNCg0KICAgICAgICBmb3JlYWNoICgkYXJyYXkgYXMgJGEpIHsNCiAgICAgICAgICAgICR0aGlzLT5wb3N0c1skYS0+SURdID0gJGE7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoJHJlYWR0YWdzKSB7DQogICAgICAgICAgICAkdGFnc3RyaW5nID0gJyc7DQogICAgICAgICAgICBmb3JlYWNoICgkYXJyYXkgYXMgJGEpIHsNCiAgICAgICAgICAgICAgICAkdGFnc3RyaW5nIC49ICRhLT5UYWc7DQogICAgICAgICAgICB9DQogICAgICAgICAgICAkdGhpcy0+TG9hZFRhZ3NCeUlEU3RyaW5nKCR0YWdzdHJpbmcpOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICRhcnJheTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJHNlbGVjdA0KICAgICAqIEBwYXJhbSBtaXhlZCAkd2hlcmUNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJG9yZGVyDQogICAgICogQHBhcmFtIG1peGVkICRsaW1pdA0KICAgICAqIEBwYXJhbSBtaXhlZCAkb3B0aW9uDQogICAgICoNCiAgICAgKiBAcmV0dXJuIFBvc3RbXQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRQYWdlTGlzdCgkc2VsZWN0ID0gbnVsbCwgJHdoZXJlID0gbnVsbCwgJG9yZGVyID0gbnVsbCwgJGxpbWl0ID0gbnVsbCwgJG9wdGlvbiA9IG51bGwpDQogICAgew0KICAgICAgICBpZiAoZW1wdHkoJHNlbGVjdCkpIHsNCiAgICAgICAgICAgICRzZWxlY3QgPSBhcnJheSgnKicpOw0KICAgICAgICB9DQogICAgICAgIGlmIChlbXB0eSgkd2hlcmUpKSB7DQogICAgICAgICAgICAkd2hlcmUgPSBhcnJheSgpOw0KICAgICAgICB9DQogICAgICAgIGlmIChpc19hcnJheSgkd2hlcmUpKSB7DQogICAgICAgICAgICBhcnJheV91bnNoaWZ0KCR3aGVyZSwgYXJyYXkoJz0nLCAnbG9nX1R5cGUnLCAnMScpKTsNCiAgICAgICAgfQ0KDQogICAgICAgICRzcWwgPSAkdGhpcy0+ZGItPnNxbC0+U2VsZWN0KCR0aGlzLT50YWJsZVsnUG9zdCddLCAkc2VsZWN0LCAkd2hlcmUsICRvcmRlciwgJGxpbWl0LCAkb3B0aW9uKTsNCiAgICAgICAgLyoqIEB2YXIgUG9zdFtdICRhcnJheSAqLw0KICAgICAgICAkYXJyYXkgPSAkdGhpcy0+R2V0TGlzdFR5cGUoJ1Bvc3QnLCAkc3FsKTsNCiAgICAgICAgZm9yZWFjaCAoJGFycmF5IGFzICRhKSB7DQogICAgICAgICAgICAkdGhpcy0+cG9zdHNbJGEtPklEXSA9ICRhOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICRhcnJheTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJHNlbGVjdA0KICAgICAqIEBwYXJhbSBtaXhlZCAkd2hlcmUNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJG9yZGVyDQogICAgICogQHBhcmFtIG1peGVkICRsaW1pdA0KICAgICAqIEBwYXJhbSBtaXhlZCAkb3B0aW9uDQogICAgICoNCiAgICAgKiBAcmV0dXJuIENvbW1lbnRbXQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRDb21tZW50TGlzdCgkc2VsZWN0ID0gbnVsbCwgJHdoZXJlID0gbnVsbCwgJG9yZGVyID0gbnVsbCwgJGxpbWl0ID0gbnVsbCwgJG9wdGlvbiA9IG51bGwpDQogICAgew0KICAgICAgICBpZiAoZW1wdHkoJHNlbGVjdCkpIHsNCiAgICAgICAgICAgICRzZWxlY3QgPSBhcnJheSgnKicpOw0KICAgICAgICB9DQogICAgICAgICRzcWwgPSAkdGhpcy0+ZGItPnNxbC0+U2VsZWN0KCR0aGlzLT50YWJsZVsnQ29tbWVudCddLCAkc2VsZWN0LCAkd2hlcmUsICRvcmRlciwgJGxpbWl0LCAkb3B0aW9uKTsNCiAgICAgICAgLyoqIEB2YXIgQ29tbWVudFtdICRhcnJheSAqLw0KICAgICAgICAkYXJyYXkgPSAkdGhpcy0+R2V0TGlzdFR5cGUoJ0NvbW1lbnQnLCAkc3FsKTsNCiAgICAgICAgZm9yZWFjaCAoJGFycmF5IGFzICRjb21tZW50KSB7DQogICAgICAgICAgICAkdGhpcy0+Y29tbWVudHNbJGNvbW1lbnQtPklEXSA9ICRjb21tZW50Ow0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICRhcnJheTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJHNlbGVjdA0KICAgICAqIEBwYXJhbSBtaXhlZCAkd2hlcmUNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJG9yZGVyDQogICAgICogQHBhcmFtIG1peGVkICRsaW1pdA0KICAgICAqIEBwYXJhbSBtaXhlZCAkb3B0aW9uDQogICAgICoNCiAgICAgKiBAcmV0dXJuIE1lbWJlcltdfEJhc2VbXQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRNZW1iZXJMaXN0KCRzZWxlY3QgPSBudWxsLCAkd2hlcmUgPSBudWxsLCAkb3JkZXIgPSBudWxsLCAkbGltaXQgPSBudWxsLCAkb3B0aW9uID0gbnVsbCkNCiAgICB7DQogICAgICAgIGlmIChlbXB0eSgkc2VsZWN0KSkgew0KICAgICAgICAgICAgJHNlbGVjdCA9IGFycmF5KCcqJyk7DQogICAgICAgIH0NCiAgICAgICAgJHNxbCA9ICR0aGlzLT5kYi0+c3FsLT5TZWxlY3QoJHRoaXMtPnRhYmxlWydNZW1iZXInXSwgJHNlbGVjdCwgJHdoZXJlLCAkb3JkZXIsICRsaW1pdCwgJG9wdGlvbik7DQoNCiAgICAgICAgcmV0dXJuICR0aGlzLT5HZXRMaXN0VHlwZSgnTWVtYmVyJywgJHNxbCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogQHBhcmFtIG1peGVkICRzZWxlY3QNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJHdoZXJlDQogICAgICogQHBhcmFtIG1peGVkICRvcmRlcg0KICAgICAqIEBwYXJhbSBtaXhlZCAkbGltaXQNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJG9wdGlvbg0KICAgICAqDQogICAgICogQHJldHVybiBUYWdbXXxCYXNlW10NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0VGFnTGlzdCgkc2VsZWN0ID0gbnVsbCwgJHdoZXJlID0gbnVsbCwgJG9yZGVyID0gbnVsbCwgJGxpbWl0ID0gbnVsbCwgJG9wdGlvbiA9IG51bGwpDQogICAgew0KICAgICAgICBpZiAoZW1wdHkoJHNlbGVjdCkpIHsNCiAgICAgICAgICAgICRzZWxlY3QgPSBhcnJheSgnKicpOw0KICAgICAgICB9DQogICAgICAgICRzcWwgPSAkdGhpcy0+ZGItPnNxbC0+U2VsZWN0KCR0aGlzLT50YWJsZVsnVGFnJ10sICRzZWxlY3QsICR3aGVyZSwgJG9yZGVyLCAkbGltaXQsICRvcHRpb24pOw0KDQogICAgICAgIHJldHVybiAkdGhpcy0+R2V0TGlzdFR5cGUoJ1RhZycsICRzcWwpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBwYXJhbSBtaXhlZCAkc2VsZWN0DQogICAgICogQHBhcmFtIG1peGVkICR3aGVyZQ0KICAgICAqIEBwYXJhbSBtaXhlZCAkb3JkZXINCiAgICAgKiBAcGFyYW0gbWl4ZWQgJGxpbWl0DQogICAgICogQHBhcmFtIG1peGVkICRvcHRpb24NCiAgICAgKg0KICAgICAqIEByZXR1cm4gQ2F0ZWdvcnlbXXxCYXNlW10NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0Q2F0ZWdvcnlMaXN0KCRzZWxlY3QgPSBudWxsLCAkd2hlcmUgPSBudWxsLCAkb3JkZXIgPSBudWxsLCAkbGltaXQgPSBudWxsLCAkb3B0aW9uID0gbnVsbCkNCiAgICB7DQogICAgICAgIGlmIChlbXB0eSgkc2VsZWN0KSkgew0KICAgICAgICAgICAgJHNlbGVjdCA9IGFycmF5KCcqJyk7DQogICAgICAgIH0NCiAgICAgICAgJHNxbCA9ICR0aGlzLT5kYi0+c3FsLT5TZWxlY3QoJHRoaXMtPnRhYmxlWydDYXRlZ29yeSddLCAkc2VsZWN0LCAkd2hlcmUsICRvcmRlciwgJGxpbWl0LCAkb3B0aW9uKTsNCg0KICAgICAgICByZXR1cm4gJHRoaXMtPkdldExpc3RUeXBlKCdDYXRlZ29yeScsICRzcWwpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBwYXJhbSBtaXhlZCAkc2VsZWN0DQogICAgICogQHBhcmFtIG1peGVkICR3aGVyZQ0KICAgICAqIEBwYXJhbSBtaXhlZCAkb3JkZXINCiAgICAgKiBAcGFyYW0gbWl4ZWQgJGxpbWl0DQogICAgICogQHBhcmFtIG1peGVkICRvcHRpb24NCiAgICAgKg0KICAgICAqIEByZXR1cm4gTW9kdWxlW118QmFzZVtdDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldE1vZHVsZUxpc3QoJHNlbGVjdCA9IG51bGwsICR3aGVyZSA9IG51bGwsICRvcmRlciA9IG51bGwsICRsaW1pdCA9IG51bGwsICRvcHRpb24gPSBudWxsKQ0KICAgIHsNCiAgICAgICAgaWYgKGVtcHR5KCRzZWxlY3QpKSB7DQogICAgICAgICAgICAkc2VsZWN0ID0gYXJyYXkoJyonKTsNCiAgICAgICAgfQ0KICAgICAgICAkc3FsID0gJHRoaXMtPmRiLT5zcWwtPlNlbGVjdCgkdGhpcy0+dGFibGVbJ01vZHVsZSddLCAkc2VsZWN0LCAkd2hlcmUsICRvcmRlciwgJGxpbWl0LCAkb3B0aW9uKTsNCg0KICAgICAgICByZXR1cm4gJHRoaXMtPkdldExpc3RUeXBlKCdNb2R1bGUnLCAkc3FsKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJHNlbGVjdA0KICAgICAqIEBwYXJhbSBtaXhlZCAkd2hlcmUNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJG9yZGVyDQogICAgICogQHBhcmFtIG1peGVkICRsaW1pdA0KICAgICAqIEBwYXJhbSBtaXhlZCAkb3B0aW9uDQogICAgICoNCiAgICAgKiBAcmV0dXJuIFVwbG9hZFtdfEJhc2VbXQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRVcGxvYWRMaXN0KCRzZWxlY3QgPSBudWxsLCAkd2hlcmUgPSBudWxsLCAkb3JkZXIgPSBudWxsLCAkbGltaXQgPSBudWxsLCAkb3B0aW9uID0gbnVsbCkNCiAgICB7DQogICAgICAgIGlmIChlbXB0eSgkc2VsZWN0KSkgew0KICAgICAgICAgICAgJHNlbGVjdCA9IGFycmF5KCcqJyk7DQogICAgICAgIH0NCiAgICAgICAgJHNxbCA9ICR0aGlzLT5kYi0+c3FsLT5TZWxlY3QoJHRoaXMtPnRhYmxlWydVcGxvYWQnXSwgJHNlbGVjdCwgJHdoZXJlLCAkb3JkZXIsICRsaW1pdCwgJG9wdGlvbik7DQoNCiAgICAgICAgcmV0dXJuICR0aGlzLT5HZXRMaXN0VHlwZSgnVXBsb2FkJywgJHNxbCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogQHBhcmFtICRzcWwNCiAgICAgKg0KICAgICAqIEByZXR1cm4gbWl4ZWQNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gZ2V0X3Jlc3VsdHMoJHNxbCkNCiAgICB7DQogICAgICAgIHJldHVybiAkdGhpcy0+ZGItPlF1ZXJ5KCRzcWwpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOagueaNruWIq+WQjeW+l+WIsOebuOW6lOaVsOaNri4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBCYXNlW118c3RyaW5nICYkb2JqZWN0ICAg57yT5a2Y5a+56LGhDQogICAgICogQHBhcmFtIHN0cmluZyAgICAgICAgJHZhbA0KICAgICAqIEBwYXJhbSBzdHJpbmcgICAgICAgICRiYWNrQXR0cg0KICAgICAqIEBwYXJhbSBzdHJpbmcgICAgICAgICRjbGFzc05hbWUNCiAgICAgKg0KICAgICAqIEByZXR1cm4gQmFzZXxudWxsDQogICAgICovDQogICAgcHJpdmF0ZSBmdW5jdGlvbiBHZXRTb21lVGhpbmdCeUFsaWFzKCRvYmplY3QsICR2YWwsICRiYWNrQXR0ciA9IG51bGwsICRjbGFzc05hbWUgPSBudWxsKQ0KICAgIHsNCiAgICAgICAgJHJldCA9ICR0aGlzLT5HZXRTb21lVGhpbmcoJG9iamVjdCwgJ0FsaWFzJywgJHZhbCk7DQoNCiAgICAgICAgaWYgKCFpc19udWxsKCRyZXQpKSB7DQogICAgICAgICAgICByZXR1cm4gJHJldDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGlmIChpc19udWxsKCRiYWNrQXR0cikpIHsNCiAgICAgICAgICAgICAgICAkYmFja0F0dHIgPSAkdGhpcy0+b3B0aW9uWydaQ19BTElBU19CQUNLX0FUVFInXTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5HZXRTb21lVGhpbmcoJG9iamVjdCwgJGJhY2tBdHRyLCAkdmFsLCAkY2xhc3NOYW1lKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOagueaNrklE5b6X5Yiw55u45bqU5pWw5o2uLg0KICAgICAqDQogICAgICogQHBhcmFtIEJhc2VbXSAgICAgJiRvYmplY3QgICDnvJPlrZjlr7nosaENCiAgICAgKiBAcGFyYW0gc3RyaW5nICAgICAkY2xhc3NOYW1lIOaJvuS4jeWIsElE5pe25Yid5aeL5YyW5a+56LGh55qE57G75ZCNDQogICAgICogQHBhcmFtIGludHxzdHJpbmcgJGlkICAgICAgICDkuI7mraTnsbvnm7jlhbPnmoRJRA0KICAgICAqDQogICAgICogQHJldHVybiBCYXNlfG51bGwNCiAgICAgKi8NCiAgICBwcml2YXRlIGZ1bmN0aW9uIEdldFNvbWVUaGluZ0J5SWQoJiRvYmplY3QsICRjbGFzc05hbWUsICRpZCkNCiAgICB7DQogICAgICAgIGlmICgkaWQgPT0gMCkgew0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQogICAgICAgIGlmICgkb2JqZWN0ICE9IG51bGwpIHsNCiAgICAgICAgICAgIC8vJG1vZHVsZXPpnZ5JROS4umtleQ0KICAgICAgICAgICAgaWYgKCRjbGFzc05hbWUgPT0gIk1vZHVsZSIpIHsNCiAgICAgICAgICAgICAgICBpZiAoJGlkID4gMCkgew0KICAgICAgICAgICAgICAgICAgICBmb3JlYWNoICgkb2JqZWN0IGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHZhbHVlLT5JRCA9PSAkaWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHZhbHVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICRtID0gbmV3IE1vZHVsZSgpOw0KDQogICAgICAgICAgICAgICAgcmV0dXJuICRtOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoaXNzZXQoJG9iamVjdFskaWRdKSkgew0KICAgICAgICAgICAgICAgIHJldHVybiAkb2JqZWN0WyRpZF07DQogICAgICAgICAgICB9IGVsc2VpZiAoJGNsYXNzTmFtZSA9PSAiUG9zdCIgfHwgJGNsYXNzTmFtZSA9PSAiQ29tbWVudCIgfHwgJGNsYXNzTmFtZSA9PSAiVGFnIikgew0KICAgICAgICAgICAgICAgIC8vIOaWh+eroOmcgOimgeivu+WPlu+8jOWFtuS7lueahOebtOaOpei/lOWbnuepuuWvueixoeWNs+WPrw0KICAgICAgICAgICAgICAgIC8qKiBAdmFyIEJhc2UgJHAgKi8NCiAgICAgICAgICAgICAgICAkcCA9IG5ldyAkY2xhc3NOYW1lKCk7DQogICAgICAgICAgICAgICAgJHAtPkxvYWRJbmZvQnlJRCgkaWQpOw0KICAgICAgICAgICAgICAgICRvYmplY3RbJGlkXSA9ICRwOw0KDQogICAgICAgICAgICAgICAgcmV0dXJuICRwOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gJHRoaXMtPkdldFNvbWVUaGluZ0J5QXR0cigkb2JqZWN0LCAnSUQnLCAkaWQpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgLyoqIEB2YXIgQmFzZSAkcCAqLw0KICAgICAgICAgICAgJHAgPSBuZXcgJGNsYXNzTmFtZSgpOw0KICAgICAgICAgICAgJHAtPkxvYWRJbmZvQnlJRCgkaWQpOw0KDQogICAgICAgICAgICByZXR1cm4gJHA7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmoLnmja7lsZ7mgKflgLzlvpfliLDnm7jlupTmlbDmja4uDQogICAgICoNCiAgICAgKiBAcGFyYW0gQmFzZVtdICYkb2JqZWN0IOe8k+WtmOWvueixoQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgJGF0dHIgICAg5bGe5oCn5ZCNDQogICAgICogQHBhcmFtIG1peGVkICAkdmFsICAgICDopoHmn6Xmib7nmoTlgLwNCiAgICAgKg0KICAgICAqIEByZXR1cm4gbnVsbA0KICAgICAqLw0KICAgIHByaXZhdGUgZnVuY3Rpb24gR2V0U29tZVRoaW5nQnlBdHRyKCYkb2JqZWN0LCAkYXR0ciwgJHZhbCkNCiAgICB7DQogICAgICAgICR2YWwgPSB0cmltKCR2YWwpOw0KICAgICAgICBmb3JlYWNoICgkb2JqZWN0IGFzICRrZXkgPT4gJiR2YWx1ZSkgew0KICAgICAgICAgICAgaWYgKGlzX251bGwoJHZhbHVlKSkgew0KICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKCR2YWx1ZS0+JGF0dHIgPT0gJHZhbCkgew0KICAgICAgICAgICAgICAgIHJldHVybiAkdmFsdWU7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDojrflj5bmlbDmja7pgJrnlKjlh73mlbAuDQogICAgICoNCiAgICAgKiBAcGFyYW0gQmFzZVtdfHN0cmluZyAkb2JqZWN0ICAgIOe8k+WtmOWvueixoe+8iHN0cmluZyAvIG9iamVjdO+8iQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgICAgICAgICRhdHRyICAgICAg5qyy5p+l5om+55qE5bGe5oCnDQogICAgICogQHBhcmFtIG1peGVkICAgICAgICAgJHZhbCAgICAgICDopoHmn6Xmib7lhoXlrrkNCiAgICAgKiBAcGFyYW0gc3RyaW5nICAgICAgICAkY2xhc3NOYW1lIOWvueixoeacquaJvuWIsOaXtu+8jOWIneWni+WMluexu+WQjQ0KICAgICAqDQogICAgICogQHJldHVybiBCYXNlfG51bGwNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0U29tZVRoaW5nKCRvYmplY3QsICRhdHRyLCAkdmFsLCAkY2xhc3NOYW1lID0gbnVsbCkNCiAgICB7DQogICAgICAgICRjYWNoZU9iamVjdCA9IG51bGw7DQogICAgICAgIGlmIChpc19vYmplY3QoJG9iamVjdCkpIHsNCiAgICAgICAgICAgICRjYWNoZU9iamVjdCA9ICRvYmplY3Q7DQogICAgICAgIH0gZWxzZWlmICgkb2JqZWN0ICE9ICIiKSB7DQogICAgICAgICAgICAkY2FjaGVPYmplY3QgPSAmJHRoaXMtPiRvYmplY3Q7DQogICAgICAgIH0NCiAgICAgICAgaWYgKCRhdHRyID09ICJJRCIpIHsNCiAgICAgICAgICAgICRyZXQgPSAkdGhpcy0+R2V0U29tZVRoaW5nQnlJZCgkY2FjaGVPYmplY3QsICRjbGFzc05hbWUsICR2YWwpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJHJldCA9ICR0aGlzLT5HZXRTb21lVGhpbmdCeUF0dHIoJGNhY2hlT2JqZWN0LCAkYXR0ciwgJHZhbCk7DQogICAgICAgIH0NCiAgICAgICAgaWYgKCRyZXQgPT09IG51bGwgJiYgIWlzX251bGwoJGNsYXNzTmFtZSkpIHsNCiAgICAgICAgICAgIC8qKiBAdmFyIEJhc2UgJHJldCAqLw0KICAgICAgICAgICAgJHJldCA9IG5ldyAkY2xhc3NOYW1lKCk7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJHJldDsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4dJROiOt+WPluaWh+eroOWunuS+iy4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBpbnQgJGlkDQogICAgICoNCiAgICAgKiBAcmV0dXJuIFBvc3R8QmFzZQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRQb3N0QnlJRCgkaWQpDQogICAgew0KICAgICAgICByZXR1cm4gJHRoaXMtPkdldFNvbWVUaGluZygncG9zdHMnLCAnSUQnLCAkaWQsICdQb3N0Jyk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YCa6L+HSUTojrflj5bliIbnsbvlrp7kvosuDQogICAgICoNCiAgICAgKiBAcGFyYW0gaW50ICRpZA0KICAgICAqDQogICAgICogQHJldHVybiBDYXRlZ29yeXxCYXNlDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldENhdGVnb3J5QnlJRCgkaWQpDQogICAgew0KICAgICAgICByZXR1cm4gJHRoaXMtPkdldFNvbWVUaGluZygnY2F0ZWdvcmllcycsICdJRCcsICRpZCwgJ0NhdGVnb3J5Jyk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YCa6L+H5YiG57G75ZCN6I635Y+W5YiG57G75a6e5L6LLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbmFtZQ0KICAgICAqDQogICAgICogQHJldHVybiBDYXRlZ29yeXxCYXNlDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldENhdGVnb3J5QnlOYW1lKCRuYW1lKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuICR0aGlzLT5HZXRTb21lVGhpbmcoJ2NhdGVnb3JpZXMnLCAnTmFtZScsICRuYW1lLCAnQ2F0ZWdvcnknKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4fliIbnsbvliKvlkI3ojrflj5bliIbnsbvlrp7kvosuDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRuYW1lDQogICAgICogQHBhcmFtIG51bGwgICAkYmFja0tleQ0KICAgICAqDQogICAgICogQHJldHVybiBDYXRlZ29yeXxCYXNlDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldENhdGVnb3J5QnlBbGlhcygkbmFtZSwgJGJhY2tLZXkgPSBudWxsKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuICR0aGlzLT5HZXRTb21lVGhpbmdCeUFsaWFzKCdjYXRlZ29yaWVzJywgJG5hbWUsICRiYWNrS2V5LCAnQ2F0ZWdvcnknKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDkuI7ogIHniYjmnKzkv53mjIHlhbzlrrnlh73mlbAuDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRuYW1lDQogICAgICoNCiAgICAgKiBAcmV0dXJuIENhdGVnb3J5DQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldENhdGVnb3J5QnlBbGlhc09yTmFtZSgkbmFtZSkNCiAgICB7DQogICAgICAgIHJldHVybiAkdGhpcy0+R2V0Q2F0ZWdvcnlCeUFsaWFzKCRuYW1lLCAnTmFtZScpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h0lE6I635Y+W5qih5Z2X5a6e5L6LLg0KICAgICAqDQogICAgICogQHBhcmFtIGludCAkaWQNCiAgICAgKg0KICAgICAqIEByZXR1cm4gTW9kdWxlfEJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0TW9kdWxlQnlJRCgkaWQpDQogICAgew0KICAgICAgICByZXR1cm4gJHRoaXMtPkdldFNvbWVUaGluZygnbW9kdWxlcycsICdJRCcsICRpZCwgJ01vZHVsZScpOyAvLyBXaGF0IHRoZSBmdWNrPw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h0ZpbGVOYW1l6I635Y+W5qih5Z2X5a6e5L6LLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkZm4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gTW9kdWxlfEJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0TW9kdWxlQnlGaWxlTmFtZSgkZm4pDQogICAgew0KICAgICAgICByZXR1cm4gJHRoaXMtPkdldFNvbWVUaGluZygnbW9kdWxlc2J5ZmlsZW5hbWUnLCAnRmlsZU5hbWUnLCAkZm4sICdNb2R1bGUnKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4dJROiOt+WPlueUqOaIt+WunuS+iy4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBpbnQgJGlkDQogICAgICoNCiAgICAgKiBAcmV0dXJuIE1lbWJlcnxCYXNlDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldE1lbWJlckJ5SUQoJGlkKQ0KICAgIHsNCiAgICAgICAgLyoqIEB2YXIgTWVtYmVyICRyZXQgKi8NCiAgICAgICAgJHJldCA9ICR0aGlzLT5HZXRTb21lVGhpbmcoJ21lbWJlcnMnLCAnSUQnLCAkaWQsICdNZW1iZXInKTsNCiAgICAgICAgaWYgKCRyZXQtPklEID09IDApIHsNCiAgICAgICAgICAgICRyZXQtPkd1aWQgPSBHZXRHdWlkKCk7DQogICAgICAgICAgICBpZiAoJHJldC0+TG9hZEluZm9CeUlEKCRpZCkgPT0gdHJ1ZSkgew0KICAgICAgICAgICAgICAgICR0aGlzLT5tZW1iZXJzWyRyZXQtPklEXSA9ICRyZXQ7DQogICAgICAgICAgICAgICAgJHRoaXMtPm1lbWJlcnNieW5hbWVbJHJldC0+TmFtZV0gPSAmJHRoaXMtPm1lbWJlcnNbJHJldC0+SURdOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICRyZXQ7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YCa6L+H55So5oi35ZCN6I635Y+W55So5oi35a6e5L6LKOS4jeWMuuWIhuWkp+Wwj+WGmSkuDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRuYW1lDQogICAgICoNCiAgICAgKiBAcmV0dXJuIE1lbWJlcnxCYXNlDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldE1lbWJlckJ5TmFtZSgkbmFtZSkNCiAgICB7DQogICAgICAgICRuYW1lID0gdHJpbSgkbmFtZSk7DQogICAgICAgIGlmICghJG5hbWUgfHwgIUNoZWNrUmVnRXhwKCRuYW1lLCAnW3VzZXJuYW1lXScpKSB7DQogICAgICAgICAgICByZXR1cm4gbmV3IE1lbWJlcigpOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKGlzc2V0KCR0aGlzLT5tZW1iZXJzYnluYW1lWyRuYW1lXSkpIHsNCiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+bWVtYmVyc2J5bmFtZVskbmFtZV07DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkYXJyYXkgPSBhcnJheV9rZXlzKCR0aGlzLT5tZW1iZXJzYnluYW1lKTsNCiAgICAgICAgICAgIGZvcmVhY2ggKCRhcnJheSBhcyAkayA9PiAkdikgew0KICAgICAgICAgICAgICAgIGlmIChzdHJjYXNlY21wKCRuYW1lLCAkdikgPT0gMCkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHRoaXMtPm1lbWJlcnNieW5hbWVbJHZdOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgICRsaWtlID0gKCR0aGlzLT5kYi0+dHlwZSA9PSAncGdzcWwnKSA/ICdJTElLRScgOiAnTElLRSc7DQogICAgICAgICRzcWwgPSAkdGhpcy0+ZGItPnNxbC0+U2VsZWN0KCR0aGlzLT50YWJsZVsnTWVtYmVyJ10sICcqJywgYXJyYXkoYXJyYXkoJGxpa2UsICdtZW1fTmFtZScsICRuYW1lKSksIG51bGwsIDEsIG51bGwpOw0KDQogICAgICAgIC8qKiBAdmFyIE1lbWJlcltdICRhbSAqLw0KICAgICAgICAkYW0gPSAkdGhpcy0+R2V0TGlzdFR5cGUoJ01lbWJlcicsICRzcWwpOw0KICAgICAgICBpZiAoY291bnQoJGFtKSA+IDApIHsNCiAgICAgICAgICAgICRtID0gJGFtWzBdOw0KICAgICAgICAgICAgaWYgKCFpc3NldCgkdGhpcy0+bWVtYmVyc1skbS0+SURdKSkgew0KICAgICAgICAgICAgICAgICR0aGlzLT5tZW1iZXJzWyRtLT5JRF0gPSAkbTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICghaXNzZXQoJHRoaXMtPm1lbWJlcnNieW5hbWVbJG0tPk5hbWVdKSkgew0KICAgICAgICAgICAgICAgICR0aGlzLT5tZW1iZXJzYnluYW1lWyRtLT5OYW1lXSA9ICYkdGhpcy0+bWVtYmVyc1skbS0+SURdOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gJG07DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gbmV3IE1lbWJlcigpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h+iOt+WPlueUqOaIt+WQjeaIluWIq+WQjeWunuS+iyjkuI3ljLrliIblpKflsI/lhpkpLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbmFtZQ0KICAgICAqDQogICAgICogQHJldHVybiBNZW1iZXJ8QmFzZQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRNZW1iZXJCeU5hbWVPckFsaWFzKCRuYW1lKQ0KICAgIHsNCiAgICAgICAgJG5hbWUgPSB0cmltKCRuYW1lKTsNCiAgICAgICAgaWYgKCEkbmFtZSB8fCAhKENoZWNrUmVnRXhwKCRuYW1lLCAnW3VzZXJuYW1lXScpIHx8IENoZWNrUmVnRXhwKCRuYW1lLCAnW25pY2tuYW1lXScpKSkgew0KICAgICAgICAgICAgcmV0dXJuIG5ldyBNZW1iZXIoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGZvcmVhY2ggKCR0aGlzLT5tZW1iZXJzIGFzICRrZXkgPT4gJiR2YWx1ZSkgew0KICAgICAgICAgICAgaWYgKHN0cmNhc2VjbXAoJHZhbHVlLT5OYW1lLCAkbmFtZSkgPT0gMCB8fCBzdHJjYXNlY21wKCR2YWx1ZS0+QWxpYXMsICRuYW1lKSA9PSAwKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICR2YWx1ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgICRsaWtlID0gKCR0aGlzLT5kYi0+dHlwZSA9PSAncGdzcWwnKSA/ICdJTElLRScgOiAnTElLRSc7DQoNCiAgICAgICAgJHNxbCA9ICR0aGlzLT5kYi0+c3FsLT5nZXQoKS0+c2VsZWN0KCR0aGlzLT50YWJsZVsnTWVtYmVyJ10pLT53aGVyZShhcnJheSgiJGxpa2UgYXJyYXkiLCBhcnJheSgNCiAgICAgICAgICAgIGFycmF5KCdtZW1fTmFtZScsICRuYW1lKSwNCiAgICAgICAgICAgIGFycmF5KCdtZW1fQWxpYXMnLCAkbmFtZSksDQogICAgICAgICkpKS0+bGltaXQoMSktPnNxbDsNCg0KICAgICAgICAvKiogQHZhciBNZW1iZXJbXSAkYW0gKi8NCiAgICAgICAgJGFtID0gJHRoaXMtPkdldExpc3RUeXBlKCdNZW1iZXInLCAkc3FsKTsNCiAgICAgICAgaWYgKGNvdW50KCRhbSkgPiAwKSB7DQogICAgICAgICAgICAkbSA9ICRhbVswXTsNCiAgICAgICAgICAgIGlmICghaXNzZXQoJHRoaXMtPm1lbWJlcnNbJG0tPklEXSkpIHsNCiAgICAgICAgICAgICAgICAkdGhpcy0+bWVtYmVyc1skbS0+SURdID0gJG07DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoIWlzc2V0KCR0aGlzLT5tZW1iZXJzYnluYW1lWyRtLT5OYW1lXSkpIHsNCiAgICAgICAgICAgICAgICAkdGhpcy0+bWVtYmVyc2J5bmFtZVskbS0+TmFtZV0gPSAmJHRoaXMtPm1lbWJlcnNbJG0tPklEXTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuICRtOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIG5ldyBNZW1iZXIoKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4fpgq7nrrHlkI3ojrflj5bnlKjmiLflrp7kvoso5LiN5Yy65YiG5aSn5bCP5YaZKS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJGVtYWlsDQogICAgICoNCiAgICAgKiBAcmV0dXJuIE1lbWJlcg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRNZW1iZXJCeUVtYWlsKCRlbWFpbCkNCiAgICB7DQogICAgICAgICRlbWFpbCA9IHN0cnRvbG93ZXIodHJpbSgkZW1haWwpKTsNCiAgICAgICAgaWYgKCEkZW1haWwgfHwgIUNoZWNrUmVnRXhwKCRlbWFpbCwgJ1tlbWFpbF0nKSkgew0KICAgICAgICAgICAgcmV0dXJuIG5ldyBNZW1iZXIoKTsNCiAgICAgICAgfQ0KDQogICAgICAgICRzcWwgPSAkdGhpcy0+ZGItPnNxbC0+U2VsZWN0KCR0aGlzLT50YWJsZVsnTWVtYmVyJ10sICcqJywgYXJyYXkoYXJyYXkoJ0xJS0UnLCAnbWVtX0VtYWlsJywgJGVtYWlsKSksIG51bGwsIDEsIG51bGwpOw0KICAgICAgICAvKiogQHZhciBNZW1iZXJbXSAkYW0gKi8NCiAgICAgICAgJGFtID0gJHRoaXMtPkdldExpc3RUeXBlKCdNZW1iZXInLCAkc3FsKTsNCiAgICAgICAgaWYgKGNvdW50KCRhbSkgPiAwKSB7DQogICAgICAgICAgICAkbSA9ICRhbVswXTsNCiAgICAgICAgICAgIGlmICghaXNzZXQoJHRoaXMtPm1lbWJlcnNbJG0tPklEXSkpIHsNCiAgICAgICAgICAgICAgICAkdGhpcy0+bWVtYmVyc1skbS0+SURdID0gJG07DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoIWlzc2V0KCR0aGlzLT5tZW1iZXJzYnluYW1lWyRtLT5OYW1lXSkpIHsNCiAgICAgICAgICAgICAgICAkdGhpcy0+bWVtYmVyc2J5bmFtZVskbS0+TmFtZV0gPSAmJHRoaXMtPm1lbWJlcnNbJG0tPklEXTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuICRtOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIG5ldyBNZW1iZXIoKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmo4Dmn6XmjIflrprlkI3np7DnmoTnlKjmiLfmmK/lkKblrZjlnKgo5LiN5Yy65YiG5aSn5bCP5YaZKS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSAkbmFtZQ0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIENoZWNrTWVtYmVyTmFtZUV4aXN0KCRuYW1lKQ0KICAgIHsNCiAgICAgICAgJG0gPSAkdGhpcy0+R2V0TWVtYmVyQnlOYW1lKCRuYW1lKTsNCg0KICAgICAgICByZXR1cm4gJG0tPklEID4gMDsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmo4Dmn6XmjIflrprlkI3np7DmiJbliKvlkI3nmoTnlKjmiLfmmK/lkKblrZjlnKgo5LiN5Yy65YiG5aSn5bCP5YaZKS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSAkbmFtZQ0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIENoZWNrTWVtYmVyQnlOYW1lT3JBbGlhc0V4aXN0KCRuYW1lKQ0KICAgIHsNCiAgICAgICAgJG0gPSAkdGhpcy0+R2V0TWVtYmVyQnlOYW1lT3JBbGlhcygkbmFtZSk7DQoNCiAgICAgICAgcmV0dXJuICRtLT5JRCA+IDA7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5qOA5p+l5oyH5a6a6YKu566x55qE55So5oi35piv5ZCm5a2Y5ZyoKOS4jeWMuuWIhuWkp+Wwj+WGmSkuDQogICAgICoNCiAgICAgKiBAcGFyYW0gJGVtYWlsDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQ2hlY2tNZW1iZXJCeUVtYWlsRXhpc3QoJGVtYWlsKQ0KICAgIHsNCiAgICAgICAgJG0gPSAkdGhpcy0+R2V0TWVtYmVyQnlFbWFpbCgkZW1haWwpOw0KDQogICAgICAgIHJldHVybiAkbS0+SUQgPiAwOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h0lE6I635Y+W6K+E6K665a6e5L6LLg0KICAgICAqDQogICAgICogQHBhcmFtIGludCAkaWQNCiAgICAgKg0KICAgICAqIEByZXR1cm4gQ29tbWVudHxCYXNlDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldENvbW1lbnRCeUlEKCRpZCkNCiAgICB7DQogICAgICAgIHJldHVybiAkdGhpcy0+R2V0U29tZVRoaW5nKCdjb21tZW50cycsICdJRCcsICRpZCwgJ0NvbW1lbnQnKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4dJROiOt+WPlumZhOS7tuWunuS+iy4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBpbnQgJGlkDQogICAgICoNCiAgICAgKiBAcmV0dXJuIFVwbG9hZHxCYXNlDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFVwbG9hZEJ5SUQoJGlkKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuICR0aGlzLT5HZXRTb21lVGhpbmcoJycsICdJRCcsICRpZCwgJ1VwbG9hZCcpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h3RhZ+WQjeiOt+WPlnRhZ+WunuS+iy4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUNCiAgICAgKiBAcGFyYW0gbnVsbCAgICRiYWNrS2V5DQogICAgICoNCiAgICAgKiBAcmV0dXJuIFRhZ3xCYXNlDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFRhZ0J5QWxpYXMoJG5hbWUsICRiYWNrS2V5ID0gbnVsbCkNCiAgICB7DQogICAgICAgICRyZXQgPSAkdGhpcy0+R2V0U29tZVRoaW5nQnlBbGlhcygndGFncycsICRuYW1lLCAkYmFja0tleSwgJ1RhZycpOw0KICAgICAgICBpZiAoJHJldC0+SUQgPj0gMCkgew0KICAgICAgICAgICAgJHRoaXMtPnRhZ3NieW5hbWVbJHJldC0+SURdID0gJiR0aGlzLT50YWdzWyRyZXQtPklEXTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAkcmV0Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h3RhZ+WQjeiOt+WPlnRhZ+WunuS+iy4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUNCiAgICAgKg0KICAgICAqIEByZXR1cm4gVGFnfEJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0VGFnQnlBbGlhc09yTmFtZSgkbmFtZSkNCiAgICB7DQogICAgICAgIC8vcmV0dXJuICR0aGlzLT5HZXRUYWdCeUFsaWFzKCRuYW1lLCAnTmFtZScpOw0KICAgICAgICAkYSA9IGFycmF5KCk7DQogICAgICAgICRhW10gPSBhcnJheSgndGFnX0FsaWFzJywgJG5hbWUpOw0KICAgICAgICAkYVtdID0gYXJyYXkoJ3RhZ19OYW1lJywgJG5hbWUpOw0KICAgICAgICAkYXJyYXkgPSAkdGhpcy0+R2V0VGFnTGlzdCgnKicsIGFycmF5KGFycmF5KCdhcnJheScsICRhKSksICcnLCAxLCAnJyk7DQogICAgICAgIGlmIChjb3VudCgkYXJyYXkpID09IDApIHsNCiAgICAgICAgICAgIHJldHVybiBuZXcgVGFnKCk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkdGhpcy0+dGFnc1skYXJyYXlbMF0tPklEXSA9ICRhcnJheVswXTsNCiAgICAgICAgICAgICR0aGlzLT50YWdzYnluYW1lWyRhcnJheVswXS0+SURdID0gJiR0aGlzLT50YWdzWyRhcnJheVswXS0+SURdOw0KDQogICAgICAgICAgICByZXR1cm4gJHRoaXMtPnRhZ3NbJGFycmF5WzBdLT5JRF07DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4dJROiOt+WPlnRhZ+WunuS+iy4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBpbnQgJGlkDQogICAgICoNCiAgICAgKiBAcmV0dXJuIFRhZ3xCYXNlDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFRhZ0J5SUQoJGlkKQ0KICAgIHsNCiAgICAgICAgJHJldCA9ICR0aGlzLT5HZXRTb21lVGhpbmcoJ3RhZ3MnLCAnSUQnLCAkaWQsICdUYWcnKTsNCiAgICAgICAgaWYgKCRyZXQtPklEID4gMCkgew0KICAgICAgICAgICAgJHRoaXMtPnRhZ3NieW5hbWVbJHJldC0+SURdID0gJiR0aGlzLT50YWdzWyRyZXQtPklEXTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAkcmV0Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h+exu+S8vCd7MX17Mn17M317NH0n6L295YWldGFncy4NCiAgICAgKg0KICAgICAqIEBwYXJhbSAkcw0KICAgICAqDQogICAgICogQHJldHVybiBhcnJheQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBMb2FkVGFnc0J5SURTdHJpbmcoJHMpDQogICAgew0KICAgICAgICAkcyA9IHRyaW0oJHMpOw0KICAgICAgICBpZiAoJHMgPT09ICcnKSB7DQogICAgICAgICAgICByZXR1cm4gYXJyYXkoKTsNCiAgICAgICAgfQ0KDQogICAgICAgICRzID0gc3RyX3JlcGxhY2UoJ317JywgJ3wnLCAkcyk7DQogICAgICAgICRzID0gc3RyX3JlcGxhY2UoJ3snLCAnJywgJHMpOw0KICAgICAgICAkcyA9IHN0cl9yZXBsYWNlKCd9JywgJycsICRzKTsNCiAgICAgICAgJGEgPSBleHBsb2RlKCd8JywgJHMpOw0KICAgICAgICAkYiA9IGFycmF5KCk7DQogICAgICAgIGZvcmVhY2ggKCRhIGFzICYkdmFsdWUpIHsNCiAgICAgICAgICAgICR2YWx1ZSA9IHRyaW0oJHZhbHVlKTsNCiAgICAgICAgICAgIGlmICgkdmFsdWUpIHsNCiAgICAgICAgICAgICAgICAkYltdID0gJHZhbHVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgICR0ID0gYXJyYXlfdW5pcXVlKCRiKTsNCg0KICAgICAgICBpZiAoY291bnQoJHQpID09PSAwKSB7DQogICAgICAgICAgICByZXR1cm4gYXJyYXkoKTsNCiAgICAgICAgfQ0KDQogICAgICAgICRhID0gYXJyYXkoKTsNCiAgICAgICAgJGIgPSBhcnJheSgpOw0KICAgICAgICAkYyA9IGFycmF5KCk7DQogICAgICAgIGZvcmVhY2ggKCR0IGFzICR2KSB7DQogICAgICAgICAgICBpZiAoIWlzc2V0KCR0aGlzLT50YWdzWyR2XSkpIHsNCiAgICAgICAgICAgICAgICAkYVtdID0gYXJyYXkoJ3RhZ19JRCcsICR2KTsNCiAgICAgICAgICAgICAgICAkY1tdID0gJHY7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICRiWyR2XSA9ICYkdGhpcy0+dGFnc1skdl07DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoY291bnQoJGEpID09PSAwKSB7DQogICAgICAgICAgICByZXR1cm4gJGI7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkdCA9IGFycmF5KCk7DQogICAgICAgICAgICAvLyRhcnJheT0kdGhpcy0+R2V0VGFnTGlzdCgnJyxhcnJheShhcnJheSgnYXJyYXknLCRhKSksJycsJycsJycpOw0KICAgICAgICAgICAgJGFycmF5ID0gJHRoaXMtPkdldFRhZ0xpc3QoJycsIGFycmF5KGFycmF5KCdJTicsICd0YWdfSUQnLCAkYykpLCAnJywgJycsICcnKTsNCiAgICAgICAgICAgIGZvcmVhY2ggKCRhcnJheSBhcyAkdikgew0KICAgICAgICAgICAgICAgICR0aGlzLT50YWdzWyR2LT5JRF0gPSAkdjsNCiAgICAgICAgICAgICAgICAkdGhpcy0+dGFnc2J5bmFtZVskdi0+TmFtZV0gPSAmJHRoaXMtPnRhZ3NbJHYtPklEXTsNCiAgICAgICAgICAgICAgICAkdFskdi0+SURdID0gJiR0aGlzLT50YWdzWyR2LT5JRF07DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiBhcnJheV9tZXJnZSgkYiwgJHQpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YCa6L+H57G75Ly8J2FhYSxiYmIsY2NjLGRkZCfovb3lhaV0YWdzLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkcyDmoIfnrb7lkI3lrZfnrKbkuLLvvIzlpoInYWFhLGJiYixjY2MsZGRkDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGFycmF5DQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIExvYWRUYWdzQnlOYW1lU3RyaW5nKCRzKQ0KICAgIHsNCiAgICAgICAgJHMgPSB0cmltKCRzKTsNCiAgICAgICAgJHMgPSBzdHJfcmVwbGFjZSgnOycsICcsJywgJHMpOw0KICAgICAgICAkcyA9IHN0cl9yZXBsYWNlKCfvvIwnLCAnLCcsICRzKTsNCiAgICAgICAgJHMgPSBzdHJfcmVwbGFjZSgn44CBJywgJywnLCAkcyk7DQogICAgICAgICRzID0gdHJpbSgkcyk7DQogICAgICAgICRzID0gc3RyaXBfdGFncygkcyk7DQogICAgICAgIGlmICgkcyA9PT0gJycgfHwgJHMgPT09ICcsJykgew0KICAgICAgICAgICAgcmV0dXJuIGFycmF5KCk7DQogICAgICAgIH0NCg0KICAgICAgICAkYSA9IGV4cGxvZGUoJywnLCAkcyk7DQogICAgICAgICR0ID0gYXJyYXlfdW5pcXVlKCRhKTsNCg0KICAgICAgICBpZiAoY291bnQoJHQpID09PSAwKSB7DQogICAgICAgICAgICByZXR1cm4gYXJyYXkoKTsNCiAgICAgICAgfQ0KDQogICAgICAgICRhID0gYXJyYXkoKTsNCiAgICAgICAgJGIgPSBhcnJheSgpOw0KICAgICAgICBmb3JlYWNoICgkdCBhcyAkdmFsdWUpIHsNCiAgICAgICAgICAgICR2ID0gdHJpbSgkdmFsdWUpOw0KICAgICAgICAgICAgaWYgKGlzc2V0KCR0aGlzLT50YWdzYnluYW1lWyR2XSkgPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICAgICAkYVtdID0gYXJyYXkoJ3RhZ19OYW1lJywgJHYpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAkYlskdl0gPSAmJHRoaXMtPnRhZ3NieW5hbWVbJHZdOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKGNvdW50KCRhKSA9PT0gMCkgew0KICAgICAgICAgICAgcmV0dXJuICRiOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJHQgPSBhcnJheSgpOw0KICAgICAgICAgICAgJGFycmF5ID0gJHRoaXMtPkdldFRhZ0xpc3QoJycsIGFycmF5KGFycmF5KCdhcnJheScsICRhKSksICcnLCAnJywgJycpOw0KICAgICAgICAgICAgZm9yZWFjaCAoJGFycmF5IGFzICR2KSB7DQogICAgICAgICAgICAgICAgJHRoaXMtPnRhZ3NbJHYtPklEXSA9ICR2Ow0KICAgICAgICAgICAgICAgICR0aGlzLT50YWdzYnluYW1lWyR2LT5OYW1lXSA9ICYkdGhpcy0+dGFnc1skdi0+SURdOw0KICAgICAgICAgICAgICAgICR0WyR2LT5OYW1lXSA9ICYkdGhpcy0+dGFnc1skdi0+SURdOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZm9yZWFjaCAoJHQgYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgICAgICAgICAkYlska2V5XSA9ICR2YWx1ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiAkYjsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h+aVsOe7hGFycmF5WzExMSwzMzMsNDQ0LDU1NSw2NjZd6L2s5o2i5oiQ5a2Y5YKo5LiyLg0KICAgICAqDQogICAgICogQHBhcmFtIGFycmF5ICRhcnJheSDmoIfnrb5JROaVsOe7hA0KICAgICAqDQogICAgICogQHJldHVybiBzdHJpbmcNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQ29udmVydFRhZ0lEdG9TdHJpbmcoJGFycmF5KQ0KICAgIHsNCiAgICAgICAgJHMgPSAnJzsNCiAgICAgICAgZm9yZWFjaCAoJGFycmF5IGFzICRhKSB7DQogICAgICAgICAgICAkcyAuPSAneycgLiAkYSAuICd9JzsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAkczsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDojrflj5blhajpg6jnva7pobbmlofnq6DvvIjkvJjlhYjku45jYWNoZemHjOivu+aVsOe7hO+8iS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBpbnQgJHR5cGUNCiAgICAgKg0KICAgICAqIEByZXR1cm4gYXJyYXkNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0VG9wQXJ0aWNsZSgkdHlwZSA9IDApDQogICAgew0KICAgICAgICAkdmFybmFtZSA9ICd0b3BfcG9zdF9hcnJheV8nIC4gJHR5cGU7DQogICAgICAgIGlmICgkdGhpcy0+Y2FjaGUtPkhhc0tleSgkdmFybmFtZSkgPT0gZmFsc2UpIHsNCiAgICAgICAgICAgIHJldHVybiBhcnJheSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgJGFydGljbGVzX3RvcF9ub3RvcmRlcl9pZGFycmF5ID0gdW5zZXJpYWxpemUoJHRoaXMtPmNhY2hlLT4kdmFybmFtZSk7DQogICAgICAgIGlmICghaXNfYXJyYXkoJGFydGljbGVzX3RvcF9ub3RvcmRlcl9pZGFycmF5KSkgew0KICAgICAgICAgICAgQ291bnRUb3BBcnRpY2xlKCR0eXBlLCBudWxsLCBudWxsKTsNCiAgICAgICAgICAgICRhcnRpY2xlc190b3Bfbm90b3JkZXJfaWRhcnJheSA9IHVuc2VyaWFsaXplKCR0aGlzLT5jYWNoZS0+JHZhcm5hbWUpOw0KICAgICAgICB9DQogICAgICAgICRhcnRpY2xlc190b3Bfbm90b3JkZXIgPSAkdGhpcy0+R2V0UG9zdEJ5QXJyYXkoJGFydGljbGVzX3RvcF9ub3RvcmRlcl9pZGFycmF5KTsNCg0KICAgICAgICByZXR1cm4gJGFydGljbGVzX3RvcF9ub3RvcmRlcjsNCiAgICB9DQoNCiAgICAvLyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KICAgIC8v6aqM6K+B55u45YWzDQoNCiAgICAvKioNCiAgICAgKiDojrflj5bor4TorrprZXkuDQogICAgICoNCiAgICAgKiBAcGFyYW0gJGlkDQogICAgICoNCiAgICAgKiBAcmV0dXJuIHN0cmluZw0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRDbXRLZXkoJGlkKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuIG1kNSgkdGhpcy0+Z3VpZCAuICRpZCAuIGRhdGUoJ1ltZGgnKSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6aqM6K+B6K+E6K66a2V5Lg0KICAgICAqDQogICAgICogQHBhcmFtICRpZA0KICAgICAqIEBwYXJhbSAka2V5DQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gVmFsaWRDbXRLZXkoJGlkLCAka2V5KQ0KICAgIHsNCiAgICAgICAgJG5vd2tleSA9IG1kNSgkdGhpcy0+Z3VpZCAuICRpZCAuIGRhdGUoJ1ltZGgnKSk7DQogICAgICAgICRub3drZXkyID0gbWQ1KCR0aGlzLT5ndWlkIC4gJGlkIC4gZGF0ZSgnWW1kaCcsIHRpbWUoKSAtICgzNjAwICogMSkpKTsNCg0KICAgICAgICByZXR1cm4gJGtleSA9PSAkbm93a2V5IHx8ICRrZXkgPT0gJG5vd2tleTI7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6I635Y+WQ1NSRiBUb2tlbi4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJGlkIOW6lOeUqElE77yM5Y+v5Lul5L+d6K+B5q+P5Liq5bqU55So6I635Y+W5LiN5ZCM55qEVG9rZW4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gc3RyaW5nDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldENTUkZUb2tlbigkaWQgPSAnJykNCiAgICB7DQogICAgICAgICRzID0gJHRoaXMtPnVzZXItPklEIC4gJHRoaXMtPnVzZXItPlBhc3N3b3JkIC4gJHRoaXMtPnVzZXItPlN0YXR1czsNCg0KICAgICAgICByZXR1cm4gbWQ1KCR0aGlzLT5ndWlkIC4gJHMgLiAkaWQgLiBkYXRlKCdZbWRoJykpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmqjOivgUNTUkYgVG9rZW4uDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICR0b2tlbg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJGlkICAgIOW6lOeUqElE77yM5Y+v5Li65q+P5Liq5bqU55So55Sf5oiQ5LiA5Liq5LiT5bGedG9rZW4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBWZXJpZnlDU1JGVG9rZW4oJHRva2VuLCAkaWQgPSAnJykNCiAgICB7DQogICAgICAgICR1c2VyU3RyaW5nID0gJHRoaXMtPnVzZXItPklEIC4gJHRoaXMtPnVzZXItPlBhc3N3b3JkIC4gJHRoaXMtPnVzZXItPlN0YXR1czsNCiAgICAgICAgJHRva2VuU3RyaW5nID0gJHRoaXMtPmd1aWQgLiAkdXNlclN0cmluZyAuICRpZDsNCg0KICAgICAgICBmb3IgKCRpID0gMDsgJGkgPD0gJHRoaXMtPmNzcmZFeHBpcmF0aW9uOyAkaSsrKSB7DQogICAgICAgICAgICBpZiAoJHRva2VuID09PSBtZDUoJHRva2VuU3RyaW5nIC4gZGF0ZSgnWW1kaCcsIHRpbWUoKSAtICgzNjAwICogJGkpKSkpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmmL7npLrpqozor4HnoIENCiAgICAgKg0KICAgICAqIEBhcGkgRmlsdGVyX1BsdWdpbl9aYnBfU2hvd1ZhbGlkQ29kZSDlpoLor6XmjqXlj6PmnKrooqvmjILovb3liJnmmL7npLrpu5jorqTpqozor4Hlm77niYcNCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJGlkIOWRveWQjeS6i+S7tg0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFNob3dWYWxpZENvZGUoJGlkID0gJycpDQogICAgew0KICAgICAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9aYnBfU2hvd1ZhbGlkQ29kZSddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAgICAgcmV0dXJuICRmcG5hbWUoJGlkKTsgLy8qDQogICAgICAgIH0NCg0KICAgICAgICAkX3ZjID0gbmV3IFZhbGlkYXRlQ29kZSgpOw0KICAgICAgICAkX3ZjLT5HZXRJbWcoKTsNCiAgICAgICAgc2V0Y29va2llKCdjYXB0Y2hhXycgLiBjcmMzMigkdGhpcy0+Z3VpZCAuICRpZCksIG1kNSgkdGhpcy0+Z3VpZCAuIGRhdGUoIlltZGgiKSAuICRfdmMtPkdldENvZGUoKSksIG51bGwsICR0aGlzLT5jb29raWVzcGF0aCk7DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5q+U5a+56aqM6K+B56CBDQogICAgICoNCiAgICAgKiBAYXBpIEZpbHRlcl9QbHVnaW5fWmJwX0NoZWNrVmFsaWRDb2RlIOWmguivpeaOpeWPo+acquiiq+aMgui9veWImeavlOWvuem7mOiupOmqjOivgeeggQ0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkdmVyaWZ5Q29kZSDpqozor4HnoIHmlbDlgLwNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRpZCAgICAgICAgIOWRveWQjeS6i+S7tg0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIENoZWNrVmFsaWRDb2RlKCR2ZXJpZnlDb2RlLCAkaWQgPSAnJykNCiAgICB7DQogICAgICAgICR2ZXJpZnlDb2RlID0gc3RydG9sb3dlcigkdmVyaWZ5Q29kZSk7DQogICAgICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1picF9DaGVja1ZhbGlkQ29kZSddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAgICAgcmV0dXJuICRmcG5hbWUoJHZlcmlmeUNvZGUsICRpZCk7IC8vKg0KICAgICAgICB9DQoNCiAgICAgICAgJG9yaWdpbmFsID0gR2V0VmFycygnY2FwdGNoYV8nIC4gY3JjMzIoJHRoaXMtPmd1aWQgLiAkaWQpLCAnQ09PS0lFJyk7DQogICAgICAgIHNldGNvb2tpZSgnY2FwdGNoYV8nIC4gY3JjMzIoJHRoaXMtPmd1aWQgLiAkaWQpLCAnJywgdGltZSgpIC0gMzYwMCwgJHRoaXMtPmNvb2tpZXNwYXRoKTsNCg0KICAgICAgICByZXR1cm4gbWQ1KCR0aGlzLT5ndWlkIC4gZGF0ZSgiWW1kaCIpIC4gc3RydG9sb3dlcigkdmVyaWZ5Q29kZSkpID09ICRvcmlnaW5hbA0KICAgICAgICAgICAgICAgIHx8DQogICAgICAgICAgICAgICAgbWQ1KCR0aGlzLT5ndWlkIC4gZGF0ZSgiWW1kaCIsIHRpbWUoKSAtICgzNjAwICogMSkpIC4gc3RydG9sb3dlcigkdmVyaWZ5Q29kZSkpID09ICRvcmlnaW5hbDsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDlkJHlr7zoiKroj5zljZXmt7vliqDnm7jlupTmnaHnm64uDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICR0eXBlICR0eXBlPWNhdGVnb3J5LHRhZyxwYWdlLGl0ZW0NCiAgICAgKiBAcGFyYW0gc3RyaW5nICRpZA0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUNCiAgICAgKiBAcGFyYW0gc3RyaW5nICR1cmwNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQWRkSXRlbVRvTmF2YmFyKCR0eXBlLCAkaWQsICRuYW1lLCAkdXJsKQ0KICAgIHsNCiAgICAgICAgaWYgKCEkdHlwZSkgew0KICAgICAgICAgICAgJHR5cGUgPSAnaXRlbSc7DQogICAgICAgIH0NCg0KICAgICAgICAkbSA9ICR0aGlzLT5tb2R1bGVzYnlmaWxlbmFtZVsnbmF2YmFyJ107DQogICAgICAgICRzID0gJG0tPkNvbnRlbnQ7DQoNCiAgICAgICAgJGEgPSAnPGxpIGlkPSJuYXZiYXItJyAuICR0eXBlIC4gJy0nIC4gJGlkIC4gJyI+PGEgaHJlZj0iJyAuICR1cmwgLiAnIj4nIC4gJG5hbWUgLiAnPC9hPjwvbGk+JzsNCg0KICAgICAgICBpZiAoJHRoaXMtPkNoZWNrSXRlbVRvTmF2YmFyKCR0eXBlLCAkaWQpKSB7DQogICAgICAgICAgICAkcyA9IHByZWdfcmVwbGFjZSgnLzxsaSBpZD0ibmF2YmFyLScgLiAkdHlwZSAuICctJyAuICRpZCAuICciPi4qPzxcL2xpPi8nLCAkYSwgJHMpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJHMgLj0gJzxsaSBpZD0ibmF2YmFyLScgLiAkdHlwZSAuICctJyAuICRpZCAuICciPjxhIGhyZWY9IicgLiAkdXJsIC4gJyI+JyAuICRuYW1lIC4gJzwvYT48L2xpPic7DQogICAgICAgIH0NCg0KICAgICAgICAkbS0+Q29udGVudCA9ICRzOw0KICAgICAgICAkbS0+U2F2ZSgpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWIoOmZpOWvvOiIquiPnOWNleS4reebuOW6lOadoeebri4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHR5cGUNCiAgICAgKiBAcGFyYW0gJGlkDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIERlbEl0ZW1Ub05hdmJhcigkdHlwZSwgJGlkKQ0KICAgIHsNCiAgICAgICAgaWYgKCEkdHlwZSkgew0KICAgICAgICAgICAgJHR5cGUgPSAnaXRlbSc7DQogICAgICAgIH0NCg0KICAgICAgICAkbSA9ICR0aGlzLT5tb2R1bGVzYnlmaWxlbmFtZVsnbmF2YmFyJ107DQogICAgICAgICRzID0gJG0tPkNvbnRlbnQ7DQoNCiAgICAgICAgJHMgPSBwcmVnX3JlcGxhY2UoJy88bGkgaWQ9Im5hdmJhci0nIC4gJHR5cGUgLiAnLScgLiAkaWQgLiAnIj4uKj88XC9saT4vJywgJycsICRzKTsNCg0KICAgICAgICAkbS0+Q29udGVudCA9ICRzOw0KICAgICAgICAkbS0+U2F2ZSgpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOajgOafpeadoeebruaYr+WQpuWcqOWvvOiIquiPnOWNleS4rS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHR5cGUNCiAgICAgKiBAcGFyYW0gJGlkDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQ2hlY2tJdGVtVG9OYXZiYXIoJHR5cGUsICRpZCkNCiAgICB7DQogICAgICAgIGlmICghJHR5cGUpIHsNCiAgICAgICAgICAgICR0eXBlID0gJ2l0ZW0nOw0KICAgICAgICB9DQoNCiAgICAgICAgJG0gPSAkdGhpcy0+bW9kdWxlc2J5ZmlsZW5hbWVbJ25hdmJhciddOw0KICAgICAgICAkcyA9ICRtLT5Db250ZW50Ow0KDQogICAgICAgIHJldHVybiAoYm9vbCkgc3RycG9zKCRzLCAnaWQ9Im5hdmJhci0nIC4gJHR5cGUgLiAnLScgLiAkaWQgLiAnIicpOw0KICAgIH0NCg0KICAgIC8vJHNpZ25hbCA9IGdvb2QsYmFkLHRpcHMNCiAgICBwcml2YXRlICRoaW50MSA9IG51bGw7DQogICAgcHJpdmF0ZSAkaGludDIgPSBudWxsOw0KICAgIHByaXZhdGUgJGhpbnQzID0gbnVsbDsNCiAgICBwcml2YXRlICRoaW50NCA9IG51bGw7DQogICAgcHJpdmF0ZSAkaGludDUgPSBudWxsOw0KDQogICAgLyoqDQogICAgICog6K6+572u5o+Q56S65raI5oGv5bm25a2Y5YWlQ29va2llLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkc2lnbmFsICDmj5DnpLrnsbvlnovvvIhnb29kfGJhZHx0aXBz77yJDQogICAgICogQHBhcmFtIHN0cmluZyAkY29udGVudCDmj5DnpLrlhoXlrrkNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gU2V0SGludCgkc2lnbmFsLCAkY29udGVudCA9ICcnKQ0KICAgIHsNCiAgICAgICAgaWYgKCRjb250ZW50ID09ICcnKSB7DQogICAgICAgICAgICBpZiAoc3Vic3RyKCRzaWduYWwsIDAsIDQpID09ICdnb29kJykgew0KICAgICAgICAgICAgICAgICRjb250ZW50ID0gJHRoaXMtPmxhbmdbJ21zZyddWydvcGVyYXRpb25fc3VjY2VlZCddOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoc3Vic3RyKCRzaWduYWwsIDAsIDMpID09ICdiYWQnKSB7DQogICAgICAgICAgICAgICAgJGNvbnRlbnQgPSAkdGhpcy0+bGFuZ1snbXNnJ11bJ29wZXJhdGlvbl9mYWlsZWQnXTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICAkY29udGVudCA9IHN1YnN0cigkY29udGVudCwgMCwgMjU1KTsNCiAgICAgICAgaWYgKCR0aGlzLT5oaW50MSA9PSBudWxsKSB7DQogICAgICAgICAgICAkdGhpcy0+aGludDEgPSAkc2lnbmFsIC4gJ3wnIC4gJGNvbnRlbnQ7DQogICAgICAgICAgICBzZXRjb29raWUoImhpbnRfc2lnbmFsMSIsICRzaWduYWwgLiAnfCcgLiAkY29udGVudCwgMCwgJHRoaXMtPmNvb2tpZXNwYXRoKTsNCiAgICAgICAgfSBlbHNlaWYgKCR0aGlzLT5oaW50MiA9PSBudWxsKSB7DQogICAgICAgICAgICAkdGhpcy0+aGludDIgPSAkc2lnbmFsIC4gJ3wnIC4gJGNvbnRlbnQ7DQogICAgICAgICAgICBzZXRjb29raWUoImhpbnRfc2lnbmFsMiIsICRzaWduYWwgLiAnfCcgLiAkY29udGVudCwgMCwgJHRoaXMtPmNvb2tpZXNwYXRoKTsNCiAgICAgICAgfSBlbHNlaWYgKCR0aGlzLT5oaW50MyA9PSBudWxsKSB7DQogICAgICAgICAgICAkdGhpcy0+aGludDMgPSAkc2lnbmFsIC4gJ3wnIC4gJGNvbnRlbnQ7DQogICAgICAgICAgICBzZXRjb29raWUoImhpbnRfc2lnbmFsMyIsICRzaWduYWwgLiAnfCcgLiAkY29udGVudCwgMCwgJHRoaXMtPmNvb2tpZXNwYXRoKTsNCiAgICAgICAgfSBlbHNlaWYgKCR0aGlzLT5oaW50NCA9PSBudWxsKSB7DQogICAgICAgICAgICAkdGhpcy0+aGludDQgPSAkc2lnbmFsIC4gJ3wnIC4gJGNvbnRlbnQ7DQogICAgICAgICAgICBzZXRjb29raWUoImhpbnRfc2lnbmFsNCIsICRzaWduYWwgLiAnfCcgLiAkY29udGVudCwgMCwgJHRoaXMtPmNvb2tpZXNwYXRoKTsNCiAgICAgICAgfSBlbHNlaWYgKCR0aGlzLT5oaW50NSA9PSBudWxsKSB7DQogICAgICAgICAgICAkdGhpcy0+aGludDUgPSAkc2lnbmFsIC4gJ3wnIC4gJGNvbnRlbnQ7DQogICAgICAgICAgICBzZXRjb29raWUoImhpbnRfc2lnbmFsNSIsICRzaWduYWwgLiAnfCcgLiAkY29udGVudCwgMCwgJHRoaXMtPmNvb2tpZXNwYXRoKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOaPkOWPlkNvb2tpZeS4reeahOaPkOekuua2iOaBry4NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0SGludCgpDQogICAgew0KICAgICAgICBmb3IgKCRpID0gMTsgJGkgPD0gNTsgJGkrKykgew0KICAgICAgICAgICAgJHNpZ25hbCA9ICdoaW50JyAuICRpOw0KICAgICAgICAgICAgJHNpZ25hbCA9ICR0aGlzLT4kc2lnbmFsOw0KICAgICAgICAgICAgaWYgKCRzaWduYWwpIHsNCiAgICAgICAgICAgICAgICAkYSA9IGV4cGxvZGUoJ3wnLCAkc2lnbmFsKTsNCiAgICAgICAgICAgICAgICAkdGhpcy0+U2hvd0hpbnQoJGFbMF0sICRhWzFdKTsNCiAgICAgICAgICAgICAgICBzZXRjb29raWUoImhpbnRfc2lnbmFsIiAuICRpLCAnJywgdGltZSgpIC0gMzYwMCwgJHRoaXMtPmNvb2tpZXNwYXRoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBmb3IgKCRpID0gMTsgJGkgPD0gNTsgJGkrKykgew0KICAgICAgICAgICAgJHNpZ25hbCA9IEdldFZhcnMoJ2hpbnRfc2lnbmFsJyAuICRpLCAnQ09PS0lFJyk7DQogICAgICAgICAgICBpZiAoJHNpZ25hbCkgew0KICAgICAgICAgICAgICAgICRhID0gZXhwbG9kZSgnfCcsICRzaWduYWwpOw0KICAgICAgICAgICAgICAgICR0aGlzLT5TaG93SGludCgkYVswXSwgJGFbMV0pOw0KICAgICAgICAgICAgICAgIHNldGNvb2tpZSgiaGludF9zaWduYWwiIC4gJGksICcnLCB0aW1lKCkgLSAzNjAwLCAkdGhpcy0+Y29va2llc3BhdGgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog55Sx5o+Q56S65raI5oGv6I635Y+WSFRNTC4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHNpZ25hbCAg5o+Q56S657G75Z6L77yIZ29vZHxiYWR8dGlwc++8iQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgJGNvbnRlbnQg5o+Q56S65YaF5a65DQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFNob3dIaW50KCRzaWduYWwsICRjb250ZW50ID0gJycpDQogICAgew0KICAgICAgICBpZiAoJGNvbnRlbnQgPT0gJycpIHsNCiAgICAgICAgICAgIGlmIChzdWJzdHIoJHNpZ25hbCwgMCwgNCkgPT0gJ2dvb2QnKSB7DQogICAgICAgICAgICAgICAgJGNvbnRlbnQgPSAkdGhpcy0+bGFuZ1snbXNnJ11bJ29wZXJhdGlvbl9zdWNjZWVkJ107DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmIChzdWJzdHIoJHNpZ25hbCwgMCwgMykgPT0gJ2JhZCcpIHsNCiAgICAgICAgICAgICAgICAkY29udGVudCA9ICR0aGlzLT5sYW5nWydtc2cnXVsnb3BlcmF0aW9uX2ZhaWxlZCddOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGVjaG8gIjxkaXYgY2xhc3M9XCJoaW50XCI+PHAgY2xhc3M9XCJoaW50IGhpbnRfJHNpZ25hbFwiPiRjb250ZW50PC9wPjwvZGl2PiI7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5pi+56S66ZSZ6K+v5L+h5oGvLg0KICAgICAqDQogICAgICogQGFwaSBGaWx0ZXJfUGx1Z2luX1picF9TaG93RXJyb3INCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcvaW50ICRlcnJvclRleHQNCiAgICAgKiBAcGFyYW0gbnVsbCAgICAgICAkZmlsZQ0KICAgICAqIEBwYXJhbSBudWxsICAgICAgICRsaW5lDQogICAgICoNCiAgICAgKiBAdGhyb3dzIEV4Y2VwdGlvbg0KICAgICAqDQogICAgICogQHJldHVybiBtaXhlZA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBTaG93RXJyb3IoJGVycm9yVGV4dCwgJGZpbGUgPSBudWxsLCAkbGluZSA9IG51bGwpDQogICAgew0KICAgICAgICAkZXJyb3JDb2RlID0gMDsNCiAgICAgICAgaWYgKGlzX251bWVyaWMoJGVycm9yVGV4dCkpIHsNCiAgICAgICAgICAgICRlcnJvckNvZGUgPSAoaW50KSAkZXJyb3JUZXh0Ow0KICAgICAgICAgICAgJGVycm9yVGV4dCA9ICR0aGlzLT5sYW5nWydlcnJvciddWyRlcnJvclRleHRdOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCRlcnJvckNvZGUgPT0gMikgew0KICAgICAgICAgICAgSHR0cDQwNCgpOw0KICAgICAgICB9DQoNCiAgICAgICAgWkJsb2dFeGNlcHRpb246OiRlcnJvcl9pZCA9ICRlcnJvckNvZGU7DQogICAgICAgIFpCbG9nRXhjZXB0aW9uOjokZXJyb3JfZmlsZSA9ICRmaWxlOw0KICAgICAgICBaQmxvZ0V4Y2VwdGlvbjo6JGVycm9yX2xpbmUgPSAkbGluZTsNCg0KICAgICAgICBpZiAoc3RyaXBvcygneycgLiBzaGExKCdtdXN0c2hvd2Vycm9yJykgLiAnfScsICRlcnJvclRleHQpID09PSAwKSB7DQogICAgICAgICAgICAkZXJyb3JUZXh0ID0gc3RyX3JlcGxhY2UoJ3snIC4gc2hhMSgnbXVzdHNob3dlcnJvcicpIC4gJ30nLCAnJywgJGVycm9yVGV4dCk7DQogICAgICAgICAgICAkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9EZWJ1Z19EaXNwbGF5J10gPSBhcnJheSgpOw0KICAgICAgICAgICAgJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fRGVidWdfSGFuZGxlciddID0gYXJyYXkoKTsNCg0KICAgICAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbigkZXJyb3JUZXh0KTsNCiAgICAgICAgICAgIGV4aXQoMSk7DQogICAgICAgIH0NCg0KICAgICAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9aYnBfU2hvd0Vycm9yJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICAgICAkZnByZXR1cm4gPSAkZnBuYW1lKCRlcnJvckNvZGUsICRlcnJvclRleHQsICRmaWxlLCAkbGluZSk7DQogICAgICAgICAgICBpZiAoJGZwc2lnbmFsID09IFBMVUdJTl9FWElUU0lHTkFMX1JFVFVSTikgew0KICAgICAgICAgICAgICAgICRmcHNpZ25hbCA9IFBMVUdJTl9FWElUU0lHTkFMX05PTkU7DQoNCiAgICAgICAgICAgICAgICByZXR1cm4gJGZwcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbigkZXJyb3JUZXh0KTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmo4Dmn6XlubblvIDlkK9Hemlw5Y6L57ypLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBDaGVja0d6aXAoKQ0KICAgIHsNCiAgICAgICAgaWYgKGV4dGVuc2lvbl9sb2FkZWQoInpsaWIiKSAmJg0KICAgICAgICAgICAgaXNzZXQoJF9TRVJWRVJbIkhUVFBfQUNDRVBUX0VOQ09ESU5HIl0pICYmDQogICAgICAgICAgICBzdHJzdHIoJF9TRVJWRVJbIkhUVFBfQUNDRVBUX0VOQ09ESU5HIl0sICJnemlwIikNCiAgICAgICAgKSB7DQogICAgICAgICAgICAkdGhpcy0+aXNHemlwID0gdHJ1ZTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWQr+eUqEd6aXAuDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFN0YXJ0R3ppcCgpDQogICAgew0KICAgICAgICBpZiAoIWhlYWRlcnNfc2VudCgpICYmICR0aGlzLT5pc0d6aXAgJiYgJHRoaXMtPm9wdGlvblsnWkNfR1pJUF9FTkFCTEUnXSkgew0KICAgICAgICAgICAgaWYgKGluaV9nZXQoJ291dHB1dF9oYW5kbGVyJykpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICRhID0gb2JfbGlzdF9oYW5kbGVycygpOw0KICAgICAgICAgICAgaWYgKGluX2FycmF5KCdvYl9nemhhbmRsZXInLCAkYSkgfHwgaW5fYXJyYXkoJ3psaWIgb3V0cHV0IGNvbXByZXNzaW9uJywgJGEpKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoZnVuY3Rpb25fZXhpc3RzKCdpbmlfc2V0JykgJiYgZnVuY3Rpb25fZXhpc3RzKCd6bGliX2VuY29kZScpKSB7DQogICAgICAgICAgICAgICAgQG9iX2VuZF9jbGVhbigpOw0KICAgICAgICAgICAgICAgIEBpbmlfc2V0KCd6bGliLm91dHB1dF9jb21wcmVzc2lvbicsICdPbicpOw0KICAgICAgICAgICAgICAgIEBpbmlfc2V0KCd6bGliLm91dHB1dF9jb21wcmVzc2lvbl9sZXZlbCcsICc1Jyk7DQogICAgICAgICAgICB9IGVsc2VpZiAoZnVuY3Rpb25fZXhpc3RzKCdvYl9nemhhbmRsZXInKSkgew0KICAgICAgICAgICAgICAgIEBvYl9lbmRfY2xlYW4oKTsNCiAgICAgICAgICAgICAgICBAb2Jfc3RhcnQoJ29iX2d6aGFuZGxlcicpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgb2Jfc3RhcnQoKTsNCg0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5qOA5rWL572R56uZ5YWz6Zet77yM5aaC5p6c5YWz6Zet77yM5YiZ5oqb5Ye66ZSZ6K+vLg0KICAgICAqDQogICAgICogQHRocm93cyBFeGNlcHRpb24NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQ2hlY2tTaXRlQ2xvc2VkKCkNCiAgICB7DQogICAgICAgIGlmICgkdGhpcy0+b3B0aW9uWydaQ19DTE9TRV9TSVRFJ10pIHsNCiAgICAgICAgICAgIEh0dHA1MDMoKTsNCiAgICAgICAgICAgICR0aGlzLT5TaG93RXJyb3IoODIsIF9fRklMRV9fLCBfX0xJTkVfXyk7DQogICAgICAgICAgICBleGl0Ow0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6Lez6L2s5Yiw5a6J6KOF6aG16Z2iLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBSZWRpcmVjdEluc3RhbGwoKQ0KICAgIHsNCiAgICAgICAgaWYgKCEkdGhpcy0+b3B0aW9uWydaQ19EQVRBQkFTRV9UWVBFJ10pIHsNCiAgICAgICAgICAgIFJlZGlyZWN0KCcuL3piX2luc3RhbGwvaW5kZXgucGhwJyk7DQogICAgICAgIH0NCg0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOajgOa1i+W9k+WJjXVybO+8jOWmguaenOS4jeespuWQiOiuvue9ruWwsei3s+i9rOWIsOWbuuWumuWfn+WQjeeahOmTvuaOpS4NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gUmVkaXJlY3RQZXJtYW5lbnREb21haW4oKQ0KICAgIHsNCiAgICAgICAgJGRvbWFpbl9kaXNhYmxlID0gR2V0VmFsdWVJbkFycmF5KCR0aGlzLT5vcHRpb24sJ1pDX1BFUk1BTkVOVF9ET01BSU5fV0hPTEVfRElTQUJMRScpOw0KICAgICAgICBpZiAoJGRvbWFpbl9kaXNhYmxlID09IHRydWUpIHsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KDQogICAgICAgICRmb3JjZWQgPSBHZXRWYWx1ZUluQXJyYXkoJHRoaXMtPm9wdGlvbiwnWkNfUEVSTUFORU5UX0RPTUFJTl9GT1JDRURfVVJMJyk7DQogICAgICAgIGlmICgkdGhpcy0+b3B0aW9uWydaQ19QRVJNQU5FTlRfRE9NQUlOX0VOQUJMRSddID09IGZhbHNlICYmICRmb3JjZWQgPT0gJycpIHsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KDQogICAgICAgICRob3N0ID0gc3RyX3JlcGxhY2UoYXJyYXkoJ2h0dHBzOi8vJywgJ2h0dHA6Ly8nKSwgYXJyYXkoJycsICcnKSwgR2V0Q3VycmVudEhvc3QoWkJQX1BBVEgsICRudWxsKSk7DQogICAgICAgICRob3N0MiA9IHN0cl9yZXBsYWNlKGFycmF5KCdodHRwczovLycsICdodHRwOi8vJyksIGFycmF5KCcnLCAnJyksICR0aGlzLT5ob3N0KTsNCg0KICAgICAgICBpZiAoJGhvc3QgIT0gJGhvc3QyKSB7DQogICAgICAgICAgICAkdSA9IEdldFJlcXVlc3RVcmkoKTsNCiAgICAgICAgICAgICR1ID0gJHRoaXMtPmhvc3QgLiBzdWJzdHIoJHUsIDEsIHN0cmxlbigkdSkpOw0KICAgICAgICAgICAgUmVkaXJlY3QzMDEoJHUpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5rOo5YaMUG9zdFR5cGUuDQogICAgICoNCiAgICAgKiBAcGFyYW0gJHR5cGVJZA0KICAgICAqIEBwYXJhbSAkbmFtZQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHVybFJ1bGUgICAgICDpu5jorqTmmK/lj5ZQYWdl57G75Z6L55qEVXJsIFJ1bGUNCiAgICAgKiBAcGFyYW0gc3RyaW5nICR0ZW1wbGF0ZSAgICAg6buY6K6k5qih5p2/5ZCNcGFnZQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgJGNhdGVnb3J5VHlwZSDlvZPliY3mlofnq6DnsbvnmoTliIbnsbtUeXBlDQogICAgICogQHBhcmFtIHN0cmluZyAkdGFnVHlwZSAgICAgIOW9k+WJjeaWh+eroOexu+eahOagh+etvlR5cGUNCiAgICAgKg0KICAgICAqIEB0aHJvd3MgRXhjZXB0aW9uDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFJlZ1Bvc3RUeXBlKCR0eXBlSWQsICRuYW1lLCAkdXJsUnVsZSA9ICcnLCAkdGVtcGxhdGUgPSAnc2luZ2xlJywgJGNhdGVnb3J5VHlwZSA9IG51bGwsICR0YWdUeXBlID0gbnVsbCkNCiAgICB7DQogICAgICAgIGlmICgkdXJsUnVsZSA9PSAnJykgew0KICAgICAgICAgICAgJHVybFJ1bGUgPSAkdGhpcy0+b3B0aW9uWydaQ19QQUdFX1JFR0VYJ107DQogICAgICAgIH0NCg0KICAgICAgICAkdHlwZUlkID0gKGludCkgJHR5cGVJZDsNCiAgICAgICAgJG5hbWUgPSBzdHJ0b2xvd2VyKHRyaW0oJG5hbWUpKTsNCiAgICAgICAgaWYgKCR0eXBlSWQgPiA5OSkgew0KICAgICAgICAgICAgaWYgKGlzc2V0KCR0aGlzLT5wb3N0dHlwZVskdHlwZUlkXSkpIHsNCiAgICAgICAgICAgICAgICAkdGhpcy0+U2hvd0Vycm9yKDg3LCBfX0ZJTEVfXywgX19MSU5FX18pOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgICR0aGlzLT5wb3N0dHlwZVskdHlwZUlkXSA9IGFycmF5KCRuYW1lLCAkdXJsUnVsZSwgJHRlbXBsYXRlLCAkY2F0ZWdvcnlUeXBlLCAkdGFnVHlwZSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogQHBhcmFtICR0eXBlaWQNCiAgICAgKg0KICAgICAqIEByZXR1cm4gc3RyaW5nDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFBvc3RUeXBlX05hbWUoJHR5cGVpZCkNCiAgICB7DQogICAgICAgIGlmIChpc3NldCgkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF0pKSB7DQogICAgICAgICAgICByZXR1cm4gJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWzBdOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICcnOw0KICAgIH0NCg0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRQb3N0VHlwZV9VcmxSdWxlKCR0eXBlaWQpDQogICAgew0KICAgICAgICBpZiAoaXNzZXQoJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdKSkgew0KICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVsxXTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAkdGhpcy0+b3B0aW9uWydaQ19QQUdFX1JFR0VYJ107DQogICAgfQ0KDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFBvc3RUeXBlX1RlbXBsYXRlKCR0eXBlaWQpDQogICAgew0KICAgICAgICBpZiAoaXNzZXQoJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdKSkgew0KICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVsyXTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAnc2luZ2xlJzsNCiAgICB9DQoNCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0UG9zdFR5cGVfQ2F0ZWdvcnlUeXBlKCR0eXBlaWQpDQogICAgew0KICAgICAgICBpZiAoaXNzZXQoJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdKSkgew0KICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVszXTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRQb3N0VHlwZV9UYWdUeXBlKCR0eXBlaWQpDQogICAgew0KICAgICAgICBpZiAoaXNzZXQoJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdKSkgew0KICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVs0XTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOazqOWGjEFjdGlvbi4NCiAgICAgKg0KICAgICAqIEBwYXJhbSAkbmFtZQ0KICAgICAqIEBwYXJhbSAkbGV2ZWwNCiAgICAgKiBAcGFyYW0gJHRpdGxlDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFJlZ0FjdGlvbigkbmFtZSwgJGxldmVsLCAkdGl0bGUpDQogICAgew0KICAgICAgICAkdGhpcy0+YWN0aW9uc1skbmFtZV0gPSAkbGV2ZWw7DQogICAgICAgICR0aGlzLT5sYW5nWydhY3Rpb25zJ11bJG5hbWVdID0gJHRpdGxlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOiOt+W+l0FjdGlvbuadg+mZkOazqOmHii4NCiAgICAgKg0KICAgICAqIEBwYXJhbSAkbmFtZQ0KICAgICAqDQogICAgICogQHJldHVybiBtaXhlZA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRBY3Rpb25EZXNjcmlwdGlvbigkbmFtZSkNCiAgICB7DQogICAgICAgIGlmIChpc3NldCgkdGhpcy0+bGFuZ1snYWN0aW9ucyddWyRuYW1lXSkpIHsNCiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+bGFuZ1snYWN0aW9ucyddWyRuYW1lXTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAkbmFtZTsNCiAgICB9DQoNCiAgICAvL+S4vuS+i++8mmJhY2tlbmQtdWksLCwNCiAgICBwcm90ZWN0ZWQgJF9leGNsdXNpdmUgPSBhcnJheSgpOw0KICAgIC8qKg0KICAgICAqIOmAmuefpeezu+e7n+aOp+WItuadgw0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBTZXRFeGNsdXNpdmUoJGZ1bmN0aW9uLCRhcHBpZCkNCiAgICB7DQogICAgICAgIGlmICgkYXBwaWQgPT0gZmFsc2UpIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KICAgICAgICAkdGhpcy0+X2V4Y2x1c2l2ZVskZnVuY3Rpb25dID0gJGFwcGlkOw0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQogICAgLyoqDQogICAgICog5p+l6K+i57O757uf5o6n5Yi25p2DDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIElzRXhjbHVzaXZlKCRmdW5jdGlvbikNCiAgICB7DQogICAgICAgIGlmIChpc3NldCgkdGhpcy0+X2V4Y2x1c2l2ZVskZnVuY3Rpb25dKSkgew0KICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5fZXhjbHVzaXZlWyRmdW5jdGlvbl07DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOS7peS4i+mDqOWIhuS4uuW3suW6n+W8g++8jOS9huiAg+iZkeWIsOWFvOWuueaAp+S/neeVmeeahOS7o+eggSoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLg0KICAgICAqLw0KDQogICAgLyoqDQogICAgICog6aqM6K+B55So5oi355m75b2V77yITUQ15YqgemJwLT5ndWlk55uQ5ZCO55qE5a+G56CB77yJLg0KICAgICAqDQogICAgICogQGRlcHJlY2F0ZWQNCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUgICAgICAgICDnlKjmiLflkI0NCiAgICAgKiBAcGFyYW0gc3RyaW5nICRwc19wYXRoX2hhc2ggTUQ15YqgemJwLT5ndWlk55uQ5ZCO55qE5a+G56CBDQogICAgICogQHBhcmFtIG9iamVjdCAkbWVtYmVyICAgICAgIOi/lOWbnuivu+WPluaIkOWKn+eahG1lbWJlcuWvueixoQ0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFZlcmlmeV9NRDVQYXRoKCRuYW1lLCAkcHNfcGF0aF9oYXNoLCAmJG1lbWJlciA9IG51bGwpDQogICAgew0KICAgICAgICBpZiAoJG5hbWUgPT0gJycgfHwgJHBzX3BhdGhfaGFzaCA9PSAnJykgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQogICAgICAgICRtID0gJHRoaXMtPkdldE1lbWJlckJ5TmFtZSgkbmFtZSk7DQogICAgICAgIGlmICgkbS0+SUQgPiAwKSB7DQogICAgICAgICAgICBpZiAoJG0tPlBhc3NXb3JkX01ENVBhdGggPT0gJHBzX3BhdGhfaGFzaCkgew0KICAgICAgICAgICAgICAgICRtZW1iZXIgPSAkbTsNCg0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOiOt+WPlkNTUkYgVG9rZW7nmoTplJnor6/liKvlkI0uDQogICAgICoNCiAgICAgKiBAZGVwcmVjYXRlZCBVc2UgYGBHZXRDU1JGVG9rZW5gYA0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkaWQg5bqU55SoSUTvvIzlj6/ku6Xkv53or4Hmr4/kuKrlupTnlKjojrflj5bkuI3lkIznmoRUb2tlbg0KICAgICAqDQogICAgICogQHJldHVybiBzdHJpbmcNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0VG9rZW4oJGlkID0gJycpDQogICAgew0KICAgICAgICByZXR1cm4gJHRoaXMtPkdldENTUkZUb2tlbigkaWQpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmqjOivgUNTUkYgVG9rZW7nmoTplJnor6/liKvlkI0uDQogICAgICoNCiAgICAgKiBAZGVwcmVjYXRlZCBVc2UgYGBWZXJpZnlDU1JGVG9rZW5gYA0KICAgICAqDQogICAgICogQHBhcmFtICR0DQogICAgICogQHBhcmFtICRpZA0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFZhbGlkVG9rZW4oJHQsICRpZCA9ICcnKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuICR0aGlzLT5WZXJpZnlDU1JGVG9rZW4oJHQsICRpZCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogQGRlcHJlY2F0ZWQNCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBMb2FkQ2F0ZWdvcnlzKCkNCiAgICB7DQogICAgICAgIHJldHVybiAkdGhpcy0+TG9hZENhdGVnb3JpZXMoKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDojrflj5bkvJror51XZWJUb2tlbi4NCiAgICAgKg0KICAgICAqIEBkZXByZWNhdGVkIOavq+aXoOaEj+S5ie+8jOWNs+WwhuW6n+W8gw0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkd3RfaWQNCiAgICAgKiBAcGFyYW0gaW50ICAgICRkYXkgICDpu5jorqQx5aSp5pyJ5pWI5pyf77yMMeWwj+aXtuS4ujEvMjTvvIwx5YiG6ZKf5Li6MS8oMjQqNjApDQogICAgICoNCiAgICAgKiBAcmV0dXJuIHN0cmluZw0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRXZWJUb2tlbigkd3RfaWQgPSAnJywgJGRheSA9IDEpDQogICAgew0KICAgICAgICAkdCA9IGludHZhbCgkZGF5ICogMjQgKiAzNjAwKSArIHRpbWUoKTsNCg0KICAgICAgICByZXR1cm4gQ3JlYXRlV2ViVG9rZW4oJHd0X2lkLCAkdCwgJHRoaXMtPmd1aWQsICR0aGlzLT51c2VyLT5TdGF0dXMsICR0aGlzLT51c2VyLT5JRCwgJHRoaXMtPnVzZXItPlBhc3N3b3JkKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpqozor4HkvJror51XZWJUb2tlbi4NCiAgICAgKg0KICAgICAqIEBkZXByZWNhdGVkIOavq+aXoOaEj+S5ie+8jOWNs+WwhuW6n+W8gw0KICAgICAqDQogICAgICogQHBhcmFtICR3dA0KICAgICAqIEBwYXJhbSAkd3RfaWQNCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBWYWxpZFdlYlRva2VuKCR3dCwgJHd0X2lkID0gJycpDQogICAgew0KICAgICAgICBpZiAoVmVyaWZ5V2ViVG9rZW4oJHd0LCAkd3RfaWQsICR0aGlzLT5ndWlkLCAkdGhpcy0+dXNlci0+U3RhdHVzLCAkdGhpcy0+dXNlci0+SUQsICR0aGlzLT51c2VyLT5QYXNzd29yZCkgPT09IHRydWUpIHsNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCn0NCg==</file>
	<file name='zb_system\function\c_system_version.php' crc32='822E5D8D'  dt:dt='bin.base64'>PD9waHANCg0KaWYgKCFkZWZpbmVkKCdaQlBfUEFUSCcpKSB7DQogICAgZXhpdCgnQWNjZXNzIGRlbmllZCcpOw0KfQ0KLyoNCiAqIOWumuS5ieeJiOacrOWPtw0KDQrov5nmmK8xLjXlj5bmtojnmoTmlbDnu4TvvIzooqvlronmjpLliLDlupTnlKjkuK3lv4PlrqLmiLfnq6/nmoRpbmNsdWRlLnBocOaWh+S7tumHjOOAgg0KI+WumuS5ieeJiOacrOWPt+WIlw0KJHpicHZlcnM9YXJyYXkoKTsNCiR6YnB2ZXJzWycxMzA3MDcnXT0nMS4wIEJldGEgQnVpbGQgMTMwNzA3JzsNCiR6YnB2ZXJzWycxMzExMTEnXT0nMS4wIEJldGEyIEJ1aWxkIDEzMTExMSc7DQokemJwdmVyc1snMTMxMjIxJ109JzEuMSBUYWljaGkgQnVpbGQgMTMxMjIxJzsNCiR6YnB2ZXJzWycxNDAyMjAnXT0nMS4yIEhpcHBvIEJ1aWxkIDE0MDIyMCc7DQokemJwdmVyc1snMTQwNjE0J109JzEuMyBXb25jZSBCdWlsZCAxNDA2MTQnOw0KJHpicHZlcnNbJzE1MDEwMSddPScxLjQgRGVlcGx1ZSBCdWlsZCAxNTAxMDEnOw0KJHpicHZlcnNbJzE1MTYyNiddPScxLjUgWmVybyBCdWlsZCAxNTE2MjYnOw0KDQogKi8NCmRlZmluZSgnWkNfVkVSU0lPTl9NQUpPUicsICcxJyk7DQpkZWZpbmUoJ1pDX1ZFUlNJT05fTUlOT1InLCAnNicpOw0KZGVmaW5lKCdaQ19WRVJTSU9OX0JVSUxEJywgJzgnKTsNCmRlZmluZSgnWkNfVkVSU0lPTl9DT01NSVQnLCAnMjIwMCcpOw0KZGVmaW5lKCdaQ19WRVJTSU9OX0NPREVOQU1FJywgJ1ZhbHlyaWEnKTsNCmRlZmluZSgnWkNfVkVSU0lPTicsIFpDX1ZFUlNJT05fTUFKT1IgLiAnLicgLiBaQ19WRVJTSU9OX01JTk9SIC4gJy4nIC4gWkNfVkVSU0lPTl9CVUlMRCAuICcuJyAuIFpDX1ZFUlNJT05fQ09NTUlUKTsNCmRlZmluZSgnWkNfVkVSU0lPTl9ESVNQTEFZJywgWkNfVkVSU0lPTl9NQUpPUiAuICcuJyAuIFpDX1ZFUlNJT05fTUlOT1IgLiAnLicgLiBaQ19WRVJTSU9OX0JVSUxEIC4gJyAnIC4gWkNfVkVSU0lPTl9DT0RFTkFNRSk7DQpkZWZpbmUoJ1pDX1ZFUlNJT05fRlVMTCcsIFpDX1ZFUlNJT04gLiAnICgnIC4gWkNfVkVSU0lPTl9DT0RFTkFNRSAuICcpJyk7DQpkZWZpbmUoJ1pDX0JMT0dfQ09NTUlUJywgWkNfVkVSU0lPTl9DT01NSVQpOyAvLyDkuLrlhpnlhaXns7vnu5/phY3nva7nu5/kuIDpo47moLwNCiRHTE9CQUxTWydibG9ndmVyc2lvbiddID0gWkNfVkVSU0lPTl9NQUpPUiAuIFpDX1ZFUlNJT05fTUlOT1IgLiBaQ19WRVJTSU9OX0NPTU1JVDsNCmRlZmluZSgnWkNfQkxPR19WRVJTSU9OJywgWkNfVkVSU0lPTl9ESVNQTEFZIC4gJyBCdWlsZCAnIC4gJEdMT0JBTFNbJ2Jsb2d2ZXJzaW9uJ10pOw0K</file>
	<file name='zb_system\function\lib\config.php' crc32='5BE717C7'  dt:dt='bin.base64'>PD9waHANCg0KaWYgKCFkZWZpbmVkKCdaQlBfUEFUSCcpKSB7DQogICAgZXhpdCgnQWNjZXNzIGRlbmllZCcpOw0KfQ0KDQovKioNCiAqIOmFjee9ruexuy4NCiAqLw0KY2xhc3MgQ29uZmlnIGltcGxlbWVudHMgSXRlcmF0b3INCnsNCg0KICAgIHByaXZhdGUgJHBvc2l0aW9uID0gMDsNCg0KICAgIHByaXZhdGUgJGFycmF5ID0gYXJyYXkoKTsgLy/lrZgka2V555qE5pWw57uE77yM6Z2eJHZhbHVlDQoNCiAgICBwdWJsaWMgZnVuY3Rpb24gcmV3aW5kKCkNCiAgICB7DQogICAgICAgIC8vZm9yZWFjaCAoJHRoaXMtPmt2ZGF0YSBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAvLyAgICAkdGhpcy0+YXJyYXlbXSA9ICRrZXk7DQogICAgICAgIC8vfQ0KICAgICAgICAkdGhpcy0+YXJyYXkgPSBhcnJheV9rZXlzKCR0aGlzLT5rdmRhdGEpOw0KICAgICAgICAkdGhpcy0+cG9zaXRpb24gPSAwOw0KICAgIH0NCg0KICAgIHB1YmxpYyBmdW5jdGlvbiBjdXJyZW50KCkNCiAgICB7DQogICAgICAgIHJldHVybiAkdGhpcy0+a3ZkYXRhWyR0aGlzLT5hcnJheVskdGhpcy0+cG9zaXRpb25dXTsNCiAgICB9DQoNCiAgICBwdWJsaWMgZnVuY3Rpb24ga2V5KCkNCiAgICB7DQogICAgICAgIHJldHVybiAkdGhpcy0+YXJyYXlbJHRoaXMtPnBvc2l0aW9uXTsNCiAgICB9DQoNCiAgICBwdWJsaWMgZnVuY3Rpb24gbmV4dCgpDQogICAgew0KICAgICAgICArKyR0aGlzLT5wb3NpdGlvbjsNCiAgICB9DQoNCiAgICBwdWJsaWMgZnVuY3Rpb24gdmFsaWQoKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuIGFycmF5X2tleV9leGlzdHMoJHRoaXMtPnBvc2l0aW9uLCAkdGhpcy0+YXJyYXkpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nIOaVsOaNruihqA0KICAgICAqLw0KICAgIHByb3RlY3RlZCAkdGFibGUgPSAnJzsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgYXJyYXkg6KGo57uT5p6E5L+h5oGvDQogICAgICovDQogICAgcHJvdGVjdGVkICRkYXRhaW5mbyA9IGFycmF5KCk7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIGFycmF5IOWOn+Wni2Ri5pWw5o2u5pWw57uEDQogICAgICovDQogICAgcHJvdGVjdGVkICRkYXRhID0gYXJyYXkoKTsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgYXJyYXkg5a2Y5YKoQ29uZmln55u45bqUa2V5LXZhbHVl5pWw5YC855qE5pWw57uEDQogICAgICovDQogICAgcHJvdGVjdGVkICRrdmRhdGEgPSBhcnJheSgpOw0KDQogICAgLyoqDQogICAgICogQHZhciBhcnJheSDlrZjlgqhDb25maWfnm7jlupTljp/lp4vmlbDmja7nmoTmlbDnu4QNCiAgICAgKi8NCiAgICBwcm90ZWN0ZWQgJG9yaWdrdmRhdGEgPSBhcnJheSgpOw0KDQogICAgLyoqDQogICAgICogQHZhciBEYXRhYmFzZV9fSW50ZXJmYWNlDQogICAgICovDQogICAgcHJvdGVjdGVkICRkYiA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiAkaXRlbW5hbWUgc3RyaW5nIOmhueebruWQjeensC4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJGl0ZW1OYW1lDQogICAgICogQHBhcmFtIG51bGwgICAkZGINCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGl0ZW1OYW1lID0gJycsICYkZGIgPSBudWxsKQ0KICAgIHsNCiAgICAgICAgaWYgKCRkYiAhPT0gbnVsbCkgew0KICAgICAgICAgICAgJHRoaXMtPmRiID0gJiRkYjsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICR0aGlzLT5kYiA9ICYkR0xPQkFMU1snemJwJ10tPmRiOw0KICAgICAgICB9DQoNCiAgICAgICAgJHRoaXMtPnRhYmxlID0gJiRHTE9CQUxTWyd0YWJsZSddWydDb25maWcnXTsNCiAgICAgICAgJHRoaXMtPmRhdGFpbmZvID0gJiRHTE9CQUxTWydkYXRhaW5mbyddWydDb25maWcnXTsNCg0KICAgICAgICBmb3JlYWNoICgkdGhpcy0+ZGF0YWluZm8gYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgICAgICR0aGlzLT5kYXRhWyRrZXldID0gJHZhbHVlWzNdOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCRpdGVtTmFtZSkgew0KICAgICAgICAgICAgJGl0ZW1OYW1lID0gRmlsdGVyQ29ycmVjdE5hbWUoJGl0ZW1OYW1lKTsNCiAgICAgICAgfQ0KDQogICAgICAgICR0aGlzLT5kYXRhWydOYW1lJ10gPSAkaXRlbU5hbWU7DQogICAgICAgICR0aGlzLT5wb3NpdGlvbiA9IDA7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogQHBhcmFtICRuYW1lDQogICAgICogQHBhcmFtICR2YWx1ZQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBfX3NldCgkbmFtZSwgJHZhbHVlKQ0KICAgIHsNCiAgICAgICAgJG5hbWUgPSBGaWx0ZXJDb3JyZWN0TmFtZSgkbmFtZSk7DQogICAgICAgICR0aGlzLT5rdmRhdGFbJG5hbWVdID0gJHZhbHVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUga2V55ZCNDQogICAgICoNCiAgICAgKiBAcmV0dXJuIG51bGwNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gX19nZXQoJG5hbWUpDQogICAgew0KICAgICAgICBpZiAoIWlzc2V0KCR0aGlzLT5rdmRhdGFbJG5hbWVdKSkgew0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICR0aGlzLT5rdmRhdGFbJG5hbWVdOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBwYXJhbSAkbmFtZQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBfX2lzc2V0KCRuYW1lKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuIGFycmF5X2tleV9leGlzdHMoJG5hbWUsICR0aGlzLT5rdmRhdGEpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBwYXJhbSAkbmFtZQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBfX3Vuc2V0KCRuYW1lKQ0KICAgIHsNCiAgICAgICAgdW5zZXQoJHRoaXMtPmt2ZGF0YVskbmFtZV0pOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOiOt+WPlkRhdGHmlbDmja4uDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGFycmF5DQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldERhdGEoKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuICR0aGlzLT5rdmRhdGE7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6I635Y+WQ29uZmln55qESXRlbSjpobnnm67lkI0pLg0KICAgICAqDQogICAgICogQHJldHVybiBzdHJpbmcNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0SXRlbU5hbWUoKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuICR0aGlzLT5kYXRhWydOYW1lJ107DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5qOA5p+lS1ZEYXRh5bGe5oCn77yI5pWw57uE77yJ5bGe5oCn5YC85piv5piv5ZCm5a2Y5Zyo55u45bqUa2V5Lg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbmFtZSBrZXnlkI0NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBIYXNLZXkoJG5hbWUpDQogICAgew0KICAgICAgICByZXR1cm4gYXJyYXlfa2V5X2V4aXN0cygkbmFtZSwgJHRoaXMtPmt2ZGF0YSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5qOA5p+lS1ZEYXRh5bGe5oCn77yI5pWw57uE77yJ5Lit55qE5Y2V5YWD5pWw55uuLg0KICAgICAqDQogICAgICogQHJldHVybiBpbnQNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQ291bnRJdGVtKCkNCiAgICB7DQogICAgICAgIHJldHVybiBjb3VudCgkdGhpcy0+a3ZkYXRhKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgZnVuY3Rpb24gQ291bnRJdGVtT3JpZygpDQogICAgew0KICAgICAgICByZXR1cm4gY291bnQoJHRoaXMtPm9yaWdrdmRhdGEpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWPjOmHjeaEj+S5ieeahOWHveaVsA0KICAgICAqICRuYW1l5Li6bnVsbOWwsei9rOWQkURlbGV0ZSgpDQogICAgICogJG5hbWXkuI3kuLpudWxs5bCx6L2s5ZCRRGVsS2V5KCkNCiAgICAgKiDliKDpmaRLVkRhdGHlsZ7mgKfvvIjmlbDnu4TvvInkuK3nmoTnm7jlupTpobkNCiAgICAgKiBEZWzlkI3np7DlkozmlbDmja7lupPliKDpmaTlh73mlbDmnInlhrLnqoENCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUga2V55ZCNDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIERlbCgkbmFtZSA9IG51bGwpDQogICAgew0KICAgICAgICBpZiAoJG5hbWUgPT09IG51bGwpIHsNCiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+RGVsZXRlKCk7DQogICAgICAgIH0NCiAgICAgICAgaWYgKCRuYW1lICE9PSBudWxsKSB7DQogICAgICAgICAgICByZXR1cm4gJHRoaXMtPkRlbEtleSgkbmFtZSk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDlsIZEYXRh5bGe5oCn77yI5pWw57uE77yJ5YC85bqP5YiX5YyWLg0KICAgICAqDQogICAgICogQHJldHVybiBzdHJpbmcg6L+U5Zue5bqP5YiX5YyW55qE5YC8DQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFNlcmlhbGl6ZSgpDQogICAgew0KICAgICAgICBnbG9iYWwgJGJsb2dob3N0Ow0KICAgICAgICBpZiAoY291bnQoJHRoaXMtPmt2ZGF0YSkgPT0gMCkgew0KICAgICAgICAgICAgcmV0dXJuICcnOw0KICAgICAgICB9DQoNCiAgICAgICAgJGFycmF5ID0gJHRoaXMtPmt2ZGF0YTsNCiAgICAgICAgZm9yZWFjaCAoJGFycmF5IGFzICRrZXkgPT4gJiR2YWx1ZSkgew0KICAgICAgICAgICAgaWYgKGlzX3N0cmluZygkdmFsdWUpKSB7DQogICAgICAgICAgICAgICAgJHZhbHVlID0gc3RyX3JlcGxhY2UoJGJsb2dob3N0LCAneyNaQ19CTE9HX0hPU1QjfScsICR2YWx1ZSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gc2VyaWFsaXplKCRhcnJheSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5bCG5bqP5YiX5YyW55qE5YC85Y+N5bqP5YiX5YyW5ZCO6LWL5LqIRGF0YeWxnuaAp+WAvA0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkcyDluo/liJfljJblgLwNCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBVbnNlcmlhbGl6ZSgkcykNCiAgICB7DQogICAgICAgIGdsb2JhbCAkYmxvZ2hvc3Q7DQoNCiAgICAgICAgaWYgKCRzID09ICcnKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCg0KICAgICAgICAkdGhpcy0+a3ZkYXRhID0gQHVuc2VyaWFsaXplKCRzKTsNCiAgICAgICAgaWYgKCFpc19hcnJheSgkdGhpcy0+a3ZkYXRhKSkgew0KICAgICAgICAgICAgJHRoaXMtPmt2ZGF0YSA9IGFycmF5KCk7DQoNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgIGZvcmVhY2ggKCR0aGlzLT5rdmRhdGEgYXMgJGtleSA9PiAmJHZhbHVlKSB7DQogICAgICAgICAgICBpZiAoaXNfc3RyaW5nKCR2YWx1ZSkpIHsNCiAgICAgICAgICAgICAgICAkdmFsdWUgPSBzdHJfcmVwbGFjZSgneyNaQ19CTE9HX0hPU1QjfScsICRibG9naG9zdCwgJHZhbHVlKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOS7juaVsOe7hOS4reWKoOi9veaVsOaNri4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBhcnJheSAkYXJyYXkg5YWz6IGU5pWw57uEDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gTG9hZEluZm9CeUFzc29jKCRhcnJheSkNCiAgICB7DQogICAgICAgIGZvcmVhY2ggKCR0aGlzLT5kYXRhaW5mbyBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAgICAgaWYgKCFpc3NldCgkYXJyYXlbJHZhbHVlWzBdXSkpIHsNCiAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgICR0aGlzLT5kYXRhWyRrZXldID0gJGFycmF5WyR2YWx1ZVswXV07DQogICAgICAgIH0NCiAgICAgICAgJHRoaXMtPlVuc2VyaWFsaXplKCR0aGlzLT5kYXRhWydWYWx1ZSddKTsNCiAgICAgICAgJHRoaXMtPm9yaWdrdmRhdGEgPSAkdGhpcy0+a3ZkYXRhOw0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOS4uuS6huWKoOW/q+WkhOeQhumAn+W6puaJjeWGmeeahOS4gOWvuVdpdGhQcmUsV2l0aEFmdGVy5Ye95pWwLg0KICAgICAqLw0KICAgIHByaXZhdGUgJGRhdGFfcHJlX2tleSA9IGFycmF5KCk7DQoNCiAgICBwcml2YXRlICRkYXRhX3ByZV92YWx1ZSA9IGFycmF5KCk7DQoNCiAgICBwdWJsaWMgZnVuY3Rpb24gTG9hZEluZm9CeUFzc29jU2luZ2xlV2l0aFByZSgkYXJyYXkpDQogICAgew0KICAgICAgICAka2V5ID0gdHJpbSgkYXJyYXlbJ2NvbmZfS2V5J10pOw0KICAgICAgICAkdmFsdWUgPSB0cmltKCRhcnJheVskdGhpcy0+ZGF0YWluZm9bJ1ZhbHVlJ11bMF1dKTsNCiAgICAgICAgJHRoaXMtPmRhdGFfcHJlX2tleVtdID0gJGtleTsNCiAgICAgICAgJHRoaXMtPmRhdGFfcHJlX3ZhbHVlW10gPSAkdmFsdWU7DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgcHVibGljIGZ1bmN0aW9uIExvYWRJbmZvQnlBc3NvY1NpbmdsZVdpdGhBZnRlcigpDQogICAgew0KICAgICAgICBnbG9iYWwgJGJsb2dob3N0Ow0KICAgICAgICBpZiAoY291bnQoJHRoaXMtPmRhdGFfcHJlX3ZhbHVlKSA9PSAwIHx8IGNvdW50KCR0aGlzLT5kYXRhX3ByZV9rZXkpID09IDApIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgICR0aGlzLT5rdmRhdGEgPSBhcnJheSgpOw0KDQogICAgICAgIGZvcmVhY2ggKCR0aGlzLT5kYXRhX3ByZV92YWx1ZSBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAgICAgaWYgKGlzX2FycmF5KCR0aGlzLT5kYXRhX3ByZV9rZXlbJGtleV0pKSB7DQogICAgICAgICAgICAgICAgdW5zZXQoJHRoaXMtPmRhdGFfcHJlX2tleVska2V5XSk7DQogICAgICAgICAgICAgICAgdW5zZXQoJHRoaXMtPmRhdGFfcHJlX3ZhbHVlWyRrZXldKTsNCiAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIEAkdGhpcy0+a3ZkYXRhWyR0aGlzLT5kYXRhX3ByZV9rZXlbJGtleV1dID0gdW5zZXJpYWxpemUoJHRoaXMtPmRhdGFfcHJlX3ZhbHVlWyRrZXldKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGZvcmVhY2ggKCR0aGlzLT5rdmRhdGEgYXMgJGtleSA9PiAmJHZhbHVlKSB7DQogICAgICAgICAgICBpZiAoaXNfc3RyaW5nKCR2YWx1ZSkpIHsNCiAgICAgICAgICAgICAgICAkdmFsdWUgPSBzdHJfcmVwbGFjZSgneyNaQ19CTE9HX0hPU1QjfScsICRibG9naG9zdCwgJHZhbHVlKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICAkdGhpcy0+b3JpZ2t2ZGF0YSA9ICR0aGlzLT5rdmRhdGE7DQogICAgICAgICR0aGlzLT5kYXRhX3ByZV9rZXlbXSA9IGFycmF5KCk7DQogICAgICAgICR0aGlzLT5kYXRhX3ByZV92YWx1ZVtdID0gYXJyYXkoKTsNCg0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICBwdWJsaWMgZnVuY3Rpb24gTG9hZEluZm9CeUFzc29jU2luZ2xlKCRhcnJheSkNCiAgICB7DQogICAgICAgICRrZXkgPSB0cmltKCRhcnJheVsnY29uZl9LZXknXSk7DQogICAgICAgICR2YWx1ZSA9IHRyaW0oJGFycmF5WyR0aGlzLT5kYXRhaW5mb1snVmFsdWUnXVswXV0pOw0KDQogICAgICAgICR2YWx1ZSA9ICR0aGlzLT5VbnNlcmlhbGl6ZVNpbmdsZSgkdmFsdWUpOw0KICAgICAgICAkdGhpcy0+a3ZkYXRhWyRrZXldID0gJHZhbHVlOw0KICAgICAgICAkdGhpcy0+b3JpZ2t2ZGF0YVska2V5XSA9ICR2YWx1ZTsNCg0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICBwdWJsaWMgZnVuY3Rpb24gU2VyaWFsaXplU2luZ2xlKCRzaW5nbGV2YWx1ZSkNCiAgICB7DQogICAgICAgIGdsb2JhbCAkYmxvZ2hvc3Q7DQogICAgICAgICRzID0gJHNpbmdsZXZhbHVlOw0KICAgICAgICBpZiAoaXNfc3RyaW5nKCRzKSkgew0KICAgICAgICAgICAgJHMgPSBzdHJfcmVwbGFjZSgkYmxvZ2hvc3QsICd7I1pDX0JMT0dfSE9TVCN9JywgJHMpOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIHNlcmlhbGl6ZSgkcyk7DQogICAgfQ0KDQogICAgcHVibGljIGZ1bmN0aW9uIFVuc2VyaWFsaXplU2luZ2xlKCRzaW5nbGV2YWx1ZSkNCiAgICB7DQogICAgICAgIGdsb2JhbCAkYmxvZ2hvc3Q7DQogICAgICAgICRzID0gQHVuc2VyaWFsaXplKCRzaW5nbGV2YWx1ZSk7DQoNCiAgICAgICAgaWYgKGlzX3N0cmluZygkcykpIHsNCiAgICAgICAgICAgICRzID0gc3RyX3JlcGxhY2UoJ3sjWkNfQkxPR19IT1NUI30nLCAkYmxvZ2hvc3QsICRzKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAkczsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDkv53lrZjmlbDmja4uDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gU2F2ZSgpDQogICAgew0KICAgICAgICAkbmFtZSA9ICR0aGlzLT5HZXRJdGVtTmFtZSgpOw0KICAgICAgICBpZiAoJG5hbWUgPT0gJycpIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgICRhZGQgPSBhcnJheV9kaWZmX2tleSgkdGhpcy0+a3ZkYXRhLCAkdGhpcy0+b3JpZ2t2ZGF0YSk7DQogICAgICAgICRkZWwgPSBhcnJheV9kaWZmX2tleSgkdGhpcy0+b3JpZ2t2ZGF0YSwgJHRoaXMtPmt2ZGF0YSk7DQogICAgICAgICRtb2QgPSBhcnJheSgpOyAvL2FycmF5X2ludGVyc2VjdCgkdGhpcy0+a3ZkYXRhLCAkdGhpcy0+b3JpZ2t2ZGF0YSk7DQogICAgICAgIGZvcmVhY2ggKCR0aGlzLT5rdmRhdGEgYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgICAgIGlmIChhcnJheV9rZXlfZXhpc3RzKCRrZXksICR0aGlzLT5vcmlna3ZkYXRhKSAmJiAkdGhpcy0+a3ZkYXRhWyRrZXldICE9ICR0aGlzLT5vcmlna3ZkYXRhWyRrZXldKSB7DQogICAgICAgICAgICAgICAgJG1vZFska2V5XSA9ICR2YWx1ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICAvL3Zhcl9kdW1wKGNvdW50KCR0aGlzLT5rdmRhdGEpLGNvdW50KCR0aGlzLT5vcmlna3ZkYXRhKSk7ZGllOw0KICAgICAgICAvL2xvZ3ModmFyX2V4cG9ydCggYXJyYXkoJHRoaXMtPm9yaWdrdmRhdGFbJ1pDX0RFQlVHX01PREUnXSwgJHRoaXMtPmt2ZGF0YVsnWkNfREVCVUdfTU9ERSddKSwgdHJ1ZSApICk7DQogICAgICAgIC8vbG9ncyh2YXJfZXhwb3J0KCBhcnJheSgnYWRkJz0+JGFkZCAsICdkZWwnPT4kZGVsICwgJ21vZCc9PiRtb2QpLHRydWUgKSApOw0KICAgICAgICAvL3Zhcl9kdW1wKCR0aGlzLT5vcmlna3ZkYXRhWydaQ19ERUJVR19NT0RFJ10sICR0aGlzLT5rdmRhdGFbJ1pDX0RFQlVHX01PREUnXSk7DQogICAgICAgIC8vdmFyX2R1bXAoJGFkZCwgJGRlbCwgJG1vZCk7DQogICAgICAgIC8vdmFyX2R1bXAoJHRoaXMtPmt2ZGF0YSwgJHRoaXMtPm9yaWdrdmRhdGEpO2RpZTsNCiAgICAgICAgaWYgKCgkYWRkICsgJGRlbCArICRtb2QpID09IGFycmF5KCkpIHsNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCR0aGlzLT5kYi0+dHlwZSA9PSAnc3FsaXRlJykgew0KICAgICAgICAgICAgJG9sZCA9IEAkdGhpcy0+ZGItPlF1ZXJ5KCdQUkFHTUEgdGFibGVfaW5mbyhbJyAuICR0aGlzLT50YWJsZSAuICddKScpOw0KICAgICAgICAgICAgJG9sZCA9IHNlcmlhbGl6ZSgkb2xkKTsNCiAgICAgICAgICAgIGlmIChzdHJpcG9zKCRvbGQsICciY29uZl9LZXkiJykgIT09IGZhbHNlKSB7DQogICAgICAgICAgICAgICAgJG9sZCA9IGFycmF5KCk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICRvbGQgPSBhcnJheShmYWxzZSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkb2xkID0gQCR0aGlzLT5kYi0+UXVlcnkoJHRoaXMtPmRiLT5zcWwtPlNlbGVjdCgkdGhpcy0+dGFibGUsICdjb25mX0tleScsIG51bGwsIG51bGwsIDEpKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8v5rKh5pyJ6L+Z5Liq5a2X5q6177yaYXJyYXkoMSkgeyBbMF09PiBib29sKGZhbHNlKSB9DQogICAgICAgIGlmIChjb3VudCgkb2xkKSA9PSAxICYmICRvbGRbMF0gPT09IGZhbHNlKSB7IC8v5aaC5p6c6L+Y5rKh5pyJ5bu6Y29uZl9LZXnlrZfmrrXlsLHkuI3opoHljp/lrZDljJblrZjlgqgNCiAgICAgICAgICAgICR2YWx1ZSA9ICR0aGlzLT5TZXJpYWxpemUoKTsNCg0KICAgICAgICAgICAgJGt2ID0gYXJyYXkoJHRoaXMtPmRhdGFpbmZvWydOYW1lJ11bMF0gPT4gJG5hbWUsICR0aGlzLT5kYXRhaW5mb1snVmFsdWUnXVswXSA9PiAkdmFsdWUpOw0KDQogICAgICAgICAgICAkb2xkMiA9ICR0aGlzLT5kYi0+UXVlcnkoJHRoaXMtPmRiLT5zcWwtPlNlbGVjdCgkdGhpcy0+dGFibGUsICcqJywgYXJyYXkoYXJyYXkoJz0nLCAkdGhpcy0+ZGF0YWluZm9bJ05hbWUnXVswXSwgJG5hbWUpKSkpOw0KICAgICAgICAgICAgLy/msqHmnInov5nkuIDooYzmlbDmja4gYXJyYXkoMCkgeyB9DQogICAgICAgICAgICBpZiAoY291bnQoJG9sZDIpID09IDApIHsNCiAgICAgICAgICAgICAgICAkc3FsID0gJHRoaXMtPmRiLT5zcWwtPkluc2VydCgkdGhpcy0+dGFibGUsICRrdik7DQogICAgICAgICAgICAgICAgJHRoaXMtPmRiLT5JbnNlcnQoJHNxbCk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIGFycmF5X3NoaWZ0KCRrdik7DQogICAgICAgICAgICAgICAgJHNxbCA9ICR0aGlzLT5kYi0+c3FsLT5VcGRhdGUoJHRoaXMtPnRhYmxlLCAka3YsIGFycmF5KGFycmF5KCc9JywgJHRoaXMtPmRhdGFpbmZvWydOYW1lJ11bMF0sICRuYW1lKSkpOw0KICAgICAgICAgICAgICAgICR0aGlzLT5kYi0+VXBkYXRlKCRzcWwpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgLy/lrZjlgqjmiJDlip/lkI7ph43nva5vcmlna3ZkYXRhDQogICAgICAgICAgICAkdGhpcy0+b3JpZ2t2ZGF0YSA9ICR0aGlzLT5rdmRhdGE7DQoNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9DQoNCiAgICAgICAgJG9sZDMgPSAkdGhpcy0+ZGItPlF1ZXJ5KCR0aGlzLT5kYi0+c3FsLT5TZWxlY3QoJHRoaXMtPnRhYmxlLCAnKicsIGFycmF5KGFycmF5KCc9JywgJHRoaXMtPmRhdGFpbmZvWydOYW1lJ11bMF0sICRuYW1lKSwgYXJyYXkoJz0nLCAnY29uZl9LZXknLCAnJykpKSk7DQogICAgICAgIGlmIChjb3VudCgkb2xkMykgPiAwKSB7IC8v5aaC5p6c5a2Y5Zyo6ICB5pWw5o2u77yM5YWI5Yig6Zmk6ICB55qEDQogICAgICAgICAgICAkZGVsID0gYXJyYXkoKTsNCiAgICAgICAgICAgICRtb2QgPSBhcnJheSgpOw0KICAgICAgICAgICAgJGFkZCA9ICR0aGlzLT5rdmRhdGE7DQoNCiAgICAgICAgICAgICRzcWwgPSAkdGhpcy0+ZGItPnNxbC0+RGVsZXRlKCR0aGlzLT50YWJsZSwgYXJyYXkoYXJyYXkoJz0nLCAkdGhpcy0+ZGF0YWluZm9bJ05hbWUnXVswXSwgJG5hbWUpLCBhcnJheSgnPScsICdjb25mX0tleScsICcnKSkpOw0KICAgICAgICAgICAgJHRoaXMtPmRiLT5EZWxldGUoJHNxbCk7DQogICAgICAgIH0NCiAgICAgICAgaWYgKCgkYWRkICsgJGRlbCArICRtb2QpID09IGFycmF5KCkpIHsNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9DQoNCiAgICAgICAgJHRoaXMtPmRiLT5RdWVyeSgnQkVHSU4nKTsNCg0KICAgICAgICAvL2FkZA0KICAgICAgICBmb3JlYWNoICgkYWRkIGFzICRrZXkyID0+ICR2YWx1ZTIpIHsNCiAgICAgICAgICAgICRrdjIgPSBhcnJheSgkdGhpcy0+ZGF0YWluZm9bJ05hbWUnXVswXSA9PiAkbmFtZSwgJ2NvbmZfS2V5JyA9PiAka2V5MiwgJHRoaXMtPmRhdGFpbmZvWydWYWx1ZSddWzBdID0+ICR0aGlzLT5TZXJpYWxpemVTaW5nbGUoJHZhbHVlMikpOw0KICAgICAgICAgICAgJHNxbDIgPSAkdGhpcy0+ZGItPnNxbC0+SW5zZXJ0KCR0aGlzLT50YWJsZSwgJGt2Mik7DQogICAgICAgICAgICAkb2xkNCA9ICR0aGlzLT5kYi0+UXVlcnkoJHRoaXMtPmRiLT5zcWwtPlNlbGVjdCgkdGhpcy0+dGFibGUsICcqJywgYXJyYXkoYXJyYXkoJz0nLCAkdGhpcy0+ZGF0YWluZm9bJ05hbWUnXVswXSwgJG5hbWUpLCBhcnJheSgnPScsICdjb25mX0tleScsICRrZXkyKSkpKTsNCiAgICAgICAgICAgIGlmIChjb3VudCgkb2xkNCkgPT0gMCkgew0KICAgICAgICAgICAgICAgICR0aGlzLT5kYi0+SW5zZXJ0KCRzcWwyKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgJGtleTMgPSAka2V5MjsNCiAgICAgICAgICAgICAgICAkdmFsdWUzID0gJHZhbHVlMjsNCiAgICAgICAgICAgICAgICAka3YzID0gYXJyYXkoJHRoaXMtPmRhdGFpbmZvWydWYWx1ZSddWzBdID0+ICR0aGlzLT5TZXJpYWxpemVTaW5nbGUoJHZhbHVlMykpOw0KICAgICAgICAgICAgICAgICRzcWwzID0gJHRoaXMtPmRiLT5zcWwtPlVwZGF0ZSgkdGhpcy0+dGFibGUsICRrdjMsIGFycmF5KGFycmF5KCc9JywgJHRoaXMtPmRhdGFpbmZvWydOYW1lJ11bMF0sICRuYW1lKSwgYXJyYXkoJz0nLCAnY29uZl9LZXknLCAka2V5MykpKTsNCiAgICAgICAgICAgICAgICAkdGhpcy0+ZGItPlVwZGF0ZSgkc3FsMyk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgLy9tb2QNCiAgICAgICAgZm9yZWFjaCAoJG1vZCBhcyAka2V5NCA9PiAkdmFsdWU0KSB7DQogICAgICAgICAgICAka3YzID0gYXJyYXkoJHRoaXMtPmRhdGFpbmZvWydOYW1lJ11bMF0gPT4gJG5hbWUsICdjb25mX0tleScgPT4gJGtleTQsICR0aGlzLT5kYXRhaW5mb1snVmFsdWUnXVswXSA9PiAkdGhpcy0+U2VyaWFsaXplU2luZ2xlKCR2YWx1ZTQpKTsNCiAgICAgICAgICAgICRzcWw0ID0gJHRoaXMtPmRiLT5zcWwtPkluc2VydCgkdGhpcy0+dGFibGUsICRrdjMpOw0KICAgICAgICAgICAgJG9sZDUgPSAkdGhpcy0+ZGItPlF1ZXJ5KCR0aGlzLT5kYi0+c3FsLT5TZWxlY3QoJHRoaXMtPnRhYmxlLCAnKicsIGFycmF5KGFycmF5KCc9JywgJHRoaXMtPmRhdGFpbmZvWydOYW1lJ11bMF0sICRuYW1lKSwgYXJyYXkoJz0nLCAnY29uZl9LZXknLCAka2V5NCkpKSk7DQogICAgICAgICAgICBpZiAoY291bnQoJG9sZDUpID09IDApIHsNCiAgICAgICAgICAgICAgICAkdGhpcy0+ZGItPkluc2VydCgkc3FsNCk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICRrZXk1ID0gJGtleTQ7DQogICAgICAgICAgICAgICAgJHZhbHVlNSA9ICR2YWx1ZTQ7DQogICAgICAgICAgICAgICAgJGt2MyA9IGFycmF5KCR0aGlzLT5kYXRhaW5mb1snVmFsdWUnXVswXSA9PiAkdGhpcy0+U2VyaWFsaXplU2luZ2xlKCR2YWx1ZTUpKTsNCiAgICAgICAgICAgICAgICAkc3FsNSA9ICR0aGlzLT5kYi0+c3FsLT5VcGRhdGUoJHRoaXMtPnRhYmxlLCAka3YzLCBhcnJheShhcnJheSgnPScsICR0aGlzLT5kYXRhaW5mb1snTmFtZSddWzBdLCAkbmFtZSksIGFycmF5KCc9JywgJ2NvbmZfS2V5JywgJGtleTUpKSk7DQogICAgICAgICAgICAgICAgJHRoaXMtPmRiLT5VcGRhdGUoJHNxbDUpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIC8vZGVsDQogICAgICAgIGZvcmVhY2ggKCRkZWwgYXMgJGtleTYgPT4gJHZhbHVlNikgew0KICAgICAgICAgICAgJHNxbDYgPSAkdGhpcy0+ZGItPnNxbC0+RGVsZXRlKCR0aGlzLT50YWJsZSwgYXJyYXkoYXJyYXkoJz0nLCAkdGhpcy0+ZGF0YWluZm9bJ05hbWUnXVswXSwgJG5hbWUpLCBhcnJheSgnPScsICdjb25mX0tleScsICRrZXk2KSkpOw0KICAgICAgICAgICAgJHRoaXMtPmRiLT5EZWxldGUoJHNxbDYpOw0KICAgICAgICB9DQogICAgICAgIC8vdmFyX2R1bXAoJGFkZCwkZGVsLCRtb2QpO2RpZTsNCiAgICAgICAgJHRoaXMtPmRiLT5RdWVyeSgnQ09NTUlUJyk7DQogICAgICAgIC8v5a2Y5YKo5oiQ5Yqf5ZCO6YeN572ub3JpZ2t2ZGF0YQ0KICAgICAgICAkdGhpcy0+b3JpZ2t2ZGF0YSA9ICR0aGlzLT5rdmRhdGE7DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5Yig6Zmk5pWw5o2uDQogICAgICogRGVsZXRl6KGo56S65LuO5pWw5o2u5bqT5Yig6ZmkDQogICAgICog5LuOJHpicOWPiuaVsOaNruW6k+S4reWIoOmZpOivpeWunuS+i0NvbmZpZ+aVsOaNri4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBEZWxldGUoKQ0KICAgIHsNCiAgICAgICAgZ2xvYmFsICR6YnA7DQogICAgICAgICRuYW1lID0gJHRoaXMtPkdldEl0ZW1OYW1lKCk7DQogICAgICAgICRzcWwgPSAkdGhpcy0+ZGItPnNxbC0+RGVsZXRlKCR0aGlzLT50YWJsZSwgYXJyYXkoYXJyYXkoJz0nLCAkdGhpcy0+ZGF0YWluZm9bJ05hbWUnXVswXSwgJG5hbWUpKSk7DQogICAgICAgICR0aGlzLT5kYi0+RGVsZXRlKCRzcWwpOw0KICAgICAgICB1bnNldCgkemJwLT5jb25maWdzWyRuYW1lXSk7DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogdG9TdHJpbmcuDQogICAgICoNCiAgICAgKiDlsIZCYXNl5a+55YOP6L+U5ZueSlNPTuaVsOaNrg0KICAgICAqDQogICAgICogQHJldHVybiBzdHJpbmcNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gX190b1N0cmluZygpDQogICAgew0KICAgICAgICByZXR1cm4gKHN0cmluZykganNvbl9lbmNvZGUoJHRoaXMtPmt2ZGF0YSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5re75Yqgb3Lkv67mlLlLZXkuDQogICAgICoNCiAgICAgKiBAcGFyYW0gJG5hbWUNCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBBZGRLZXkoJG5hbWUsICR2YWx1ZSkNCiAgICB7DQogICAgICAgICRuYW1lID0gRmlsdGVyQ29ycmVjdE5hbWUoJG5hbWUpOw0KICAgICAgICBpZiAoISRuYW1lKSB7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCiAgICAgICAgJHRoaXMtPmt2ZGF0YVskbmFtZV0gPSAkdmFsdWU7DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5Yig6ZmkS2V577yM5LiN5o6o6I2Q5L2/55SoRGVsKCRuYW1lKS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSAkbmFtZQ0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIERlbEtleSgkbmFtZSkNCiAgICB7DQogICAgICAgICRuYW1lID0gRmlsdGVyQ29ycmVjdE5hbWUoJG5hbWUpOw0KICAgICAgICBpZiAoIWlzc2V0KCR0aGlzLT5rdmRhdGFbJG5hbWVdKSkgew0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQoNCiAgICAgICAgdW5zZXQoJHRoaXMtPmt2ZGF0YVskbmFtZV0pOw0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KfQ0K</file>
</files>