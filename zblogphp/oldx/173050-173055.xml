<files codepage='65001'>
	<file name='zb_system\function\c_system_version.php' crc32='5D596D4B'>PD9waHANCg0KaWYgKCFkZWZpbmVkKCdaQlBfUEFUSCcpKSB7DQogICAgZXhpdCgnQWNjZXNzIGRlbmllZCcpOw0KfQ0KLyoNCiAqIOWumuS5ieeJiOacrOWPtw0KDQrov5nmmK8xLjXlj5bmtojnmoTmlbDnu4TvvIzooqvlronmjpLliLDlupTnlKjkuK3lv4PlrqLmiLfnq6/nmoRpbmNsdWRlLnBocOaWh+S7tumHjOOAgg0KI+WumuS5ieeJiOacrOWPt+WIlw0KJHpicHZlcnM9YXJyYXkoKTsNCiR6YnB2ZXJzWycxMzA3MDcnXT0nMS4wIEJldGEgQnVpbGQgMTMwNzA3JzsNCiR6YnB2ZXJzWycxMzExMTEnXT0nMS4wIEJldGEyIEJ1aWxkIDEzMTExMSc7DQokemJwdmVyc1snMTMxMjIxJ109JzEuMSBUYWljaGkgQnVpbGQgMTMxMjIxJzsNCiR6YnB2ZXJzWycxNDAyMjAnXT0nMS4yIEhpcHBvIEJ1aWxkIDE0MDIyMCc7DQokemJwdmVyc1snMTQwNjE0J109JzEuMyBXb25jZSBCdWlsZCAxNDA2MTQnOw0KJHpicHZlcnNbJzE1MDEwMSddPScxLjQgRGVlcGx1ZSBCdWlsZCAxNTAxMDEnOw0KJHpicHZlcnNbJzE1MTYyNiddPScxLjUgWmVybyBCdWlsZCAxNTE2MjYnOw0KDQogKi8NCmRlZmluZSgnWkNfVkVSU0lPTl9NQUpPUicsICcxJyk7DQpkZWZpbmUoJ1pDX1ZFUlNJT05fTUlOT1InLCAnNycpOw0KZGVmaW5lKCdaQ19WRVJTSU9OX0JVSUxEJywgJzInKTsNCmRlZmluZSgnWkNfVkVSU0lPTl9DT01NSVQnLCAnMzA1NScpOw0KZGVmaW5lKCdaQ19WRVJTSU9OX0NPREVOQU1FJywgJ1RlbmV0Jyk7DQpkZWZpbmUoJ1pDX1ZFUlNJT04nLCBaQ19WRVJTSU9OX01BSk9SIC4gJy4nIC4gWkNfVkVSU0lPTl9NSU5PUiAuICcuJyAuIFpDX1ZFUlNJT05fQlVJTEQgLiAnLicgLiBaQ19WRVJTSU9OX0NPTU1JVCk7DQppZiAoc3RyY2FzZWNtcChaQ19WRVJTSU9OX0NPREVOQU1FLCAnQmV0YScpID09IDAgfHwgc3RyY2FzZWNtcChaQ19WRVJTSU9OX0NPREVOQU1FLCAnQWxwaGEnKSA9PSAwKSB7DQogICAgZGVmaW5lKCdaQ19WRVJTSU9OX0RJU1BMQVknLCBaQ19WRVJTSU9OX01BSk9SIC4gJy4nIC4gWkNfVkVSU0lPTl9NSU5PUiAuICcuJyAuIFpDX1ZFUlNJT05fQlVJTEQgLiAnICcgLiBaQ19WRVJTSU9OX0NPREVOQU1FKTsNCn0gZWxzZSB7DQogICAgZGVmaW5lKCdaQ19WRVJTSU9OX0RJU1BMQVknLCBaQ19WRVJTSU9OX01BSk9SIC4gJy4nIC4gWkNfVkVSU0lPTl9NSU5PUiAuICcuJyAuIFpDX1ZFUlNJT05fQlVJTEQpOw0KfQ0KZGVmaW5lKCdaQ19WRVJTSU9OX0ZVTEwnLCBaQ19WRVJTSU9OIC4gJyAoJyAuIFpDX1ZFUlNJT05fQ09ERU5BTUUgLiAnKScpOw0KZGVmaW5lKCdaQ19CTE9HX0NPTU1JVCcsIFpDX1ZFUlNJT05fQ09NTUlUKTsgLy8g5Li65YaZ5YWl57O757uf6YWN572u57uf5LiA6aOO5qC8DQokR0xPQkFMU1snYmxvZ3ZlcnNpb24nXSA9IFpDX1ZFUlNJT05fTUFKT1IgLiBaQ19WRVJTSU9OX01JTk9SIC4gWkNfVkVSU0lPTl9DT01NSVQ7DQpkZWZpbmUoJ1pDX05PV19WRVJTSU9OJywgJEdMT0JBTFNbJ2Jsb2d2ZXJzaW9uJ10pOw0KZGVmaW5lKCdaQ19CTE9HX1ZFUlNJT04nLCBaQ19WRVJTSU9OX0RJU1BMQVkgLiAnIEJ1aWxkICcgLiAkR0xPQkFMU1snYmxvZ3ZlcnNpb24nXSk7DQpkZWZpbmUoJ1pDX0xBU1RfVkVSU0lPTicsICcxNzI4MDAnKTsgLy/mlbDmja7lupPph4zlhpnlhaXnmoTmnIDmlrDnmoTmlbDmja7lupPniYjmnKzlj7fvvIjpnZ7ns7vnu5/niYjmnKzlj7fvvIzlj6rmnInmm7TmlLnmlbDmja7lupPnu5PmnoTmiY3kvJrlj5jliqjvvIkNCg==</file>
	<file name='zb_system\function\lib\zblogphp.php' crc32='48EF456E'>PD9waHANCg0KaWYgKCFkZWZpbmVkKCdaQlBfUEFUSCcpKSB7DQogICAgZXhpdCgnQWNjZXNzIGRlbmllZCcpOw0KfQ0KLyoqDQogKiB6YnDlhajlsYDmk43kvZznsbsuDQogKi8NCmNsYXNzIFpCbG9nUEhQDQp7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIG9iamVjdCDljZXkvovmqKHlvI/kuIvnmoRaQlDllK/kuIDlrp7kvosNCiAgICAgKi8NCiAgICBwcml2YXRlIHN0YXRpYyAkcHJpdmF0ZV96YnAgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcg54mI5pys5Y+3DQogICAgICovDQogICAgcHVibGljICR2ZXJzaW9uID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgRGF0YWJhc2VfX0ludGVyZmFjZSDmlbDmja7lupMNCiAgICAgKi8NCiAgICBwdWJsaWMgJGRiID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgYXJyYXkg6YWN572u6YCJ6aG5DQogICAgICovDQogICAgcHVibGljICRvcHRpb24gPSBhcnJheSgpOw0KDQogICAgLyoqDQogICAgICogQHZhciBhcnJheSDor63oqIANCiAgICAgKi8NCiAgICBwdWJsaWMgJGxhbmcgPSBhcnJheSgpOw0KDQogICAgLyoqDQogICAgICogQHZhciBqc29u57G75Z6LIOivreiogA0KICAgICAqLw0KICAgIHB1YmxpYyAkbGFuZ3MgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBhcnJheSDor63oqIDljIVsaXN0DQogICAgICovDQogICAgcHVibGljICRsYW5ncGFja2xpc3QgPSBhcnJheSgpOw0KDQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcg6Lev5b6EDQogICAgICovDQogICAgcHVibGljICRwYXRoID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nIOWfn+WQjQ0KICAgICAqLw0KICAgIHB1YmxpYyAkaG9zdCA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIHN0cmluZyBjb29raWXkvZznlKjln58NCiAgICAgKi8NCiAgICBwdWJsaWMgJGNvb2tpZXNwYXRoID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nIGd1aWQNCiAgICAgKi8NCiAgICBwdWJsaWMgJGd1aWQgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcg5b2T5YmN6ZO+5o6lDQogICAgICovDQogICAgcHVibGljICRjdXJyZW50dXJsID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nIOW9k+WJjemTvuaOpQ0KICAgICAqLw0KICAgIHB1YmxpYyAkZnVsbGN1cnJlbnR1cmwgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcg5b2T5YmN6ISa5pysDQogICAgICovDQogICAgcHVibGljICRjdXJyZW50c2NyaXB0Ow0KDQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcg5b2T5YmN6ISa5pys5YWo6Lev5b6EDQogICAgICovDQogICAgcHVibGljICRmdWxsY3VycmVudHNjcmlwdDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nIFN5c3RlbeebruW9lQ0KICAgICAqLw0KICAgIHB1YmxpYyAkc3lzdGVtZGlyID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nIEFkbWlu55uu5b2VDQogICAgICovDQogICAgcHVibGljICRhZG1pbmRpciA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIHN0cmluZyDnlKjmiLfnm67lvZUNCiAgICAgKi8NCiAgICBwdWJsaWMgJHVzZXJzZGlyID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nIFN5c3RlbSBVcmwNCiAgICAgKi8NCiAgICBwdWJsaWMgJHN5c3RlbXVybCA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIHN0cmluZyBBZG1pbiBVcmwNCiAgICAgKi8NCiAgICBwdWJsaWMgJGFkbWludXJsID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nIOeUqOaIt1VybA0KICAgICAqLw0KICAgIHB1YmxpYyAkdXNlcnN1cmwgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcgQ2FjaGXnm67lvZUNCiAgICAgKi8NCiAgICBwdWJsaWMgJGNhY2hlZGlyID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nIExvZ3Pnm67lvZUNCiAgICAgKi8NCiAgICBwdWJsaWMgJGxvZ3NkaXIgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcgRGF0YeebruW9lQ0KICAgICAqLw0KICAgIHB1YmxpYyAkZGF0YWRpciA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIHN0cmluZyDpqozor4HnoIHlnLDlnYANCiAgICAgKi8NCiAgICBwdWJsaWMgJHZlcmlmeUNvZGVVcmwgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcg6aqM6K+B56CB5Zyw5Z2A77yI5ou85YaZ6ZSZ6K+v77yJDQogICAgICoNCiAgICAgKiBAZGVwcmVjYXRlZA0KICAgICAqLw0KICAgIHB1YmxpYyAkdmFsaWRjb2RldXJsID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nDQogICAgICovDQogICAgcHVibGljICRmZWVkdXJsID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nDQogICAgICovDQogICAgcHVibGljICRzZWFyY2h1cmwgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcNCiAgICAgKi8NCiAgICBwdWJsaWMgJGFqYXh1cmwgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcNCiAgICAgKi8NCiAgICBwdWJsaWMgJHhtbHJwY3VybCA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIHN0cmluZw0KICAgICAqLw0KICAgIHB1YmxpYyAkYXBpdXJsID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nDQogICAgICovDQogICAgcHVibGljICRjbWR1cmwgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBNZW1iZXJbXSDnlKjmiLfmlbDnu4QNCiAgICAgKi8NCiAgICBwdWJsaWMgJG1lbWJlcnMgPSBhcnJheSgpOw0KDQogICAgLyoqDQogICAgICogQHZhciBNZW1iZXJbXSDnlKjmiLfmlbDnu4TvvIjku6XnlKjmiLflkI3kuLrplK7vvIkNCiAgICAgKi8NCiAgICBwdWJsaWMgJG1lbWJlcnNieW5hbWUgPSBhcnJheSgpOw0KDQogICAgLyoqDQogICAgICogQHZhciBDYXRlZ29yeVtdIOWIhuexu+aVsOe7hCAoJGNhdGVnb3J5c+W3suW6n+W8gykNCiAgICAgKi8NCiAgICBwdWJsaWMgJGNhdGVnb3J5cyA9IGFycmF5KCk7DQoNCiAgICBwdWJsaWMgJGNhdGVnb3JpZXMgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBDYXRlZ29yeVtdIOWIhuexu+aVsOe7hEFMTA0KICAgICAqLw0KICAgIHB1YmxpYyAkY2F0ZWdvcmllc19hbGwgPSBhcnJheSgpOw0KDQogICAgLyoqDQogICAgICogQHZhciBDYXRlZ29yeVtdIOWIhuexu+aVsOe7hO+8iOW3suaOkuW6j++8iSAoJGNhdGVnb3J5c2J5b3JkZXLlt7Llup/lvIMpICBjYXRlZ29yaWVz5byV55SoDQogICAgICovDQogICAgcHVibGljICRjYXRlZ29yeXNieW9yZGVyID0gYXJyYXkoKTsNCg0KICAgIHB1YmxpYyAkY2F0ZWdvcmllc2J5b3JkZXIgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBDYXRlZ29yeVtdIOaMieexu+Wei+WIhuexu+eahDLnu7TmlbDnu4QgLy/mnKzouqvml6DmhI/kuYnkuobvvIznjrDlvJXnlKjoh6okY2F0ZWdvcmllc2J5b3JkZXJfdHlwZQ0KICAgICAqLw0KICAgIHB1YmxpYyAkY2F0ZWdvcmllc190eXBlID0gYXJyYXkoKTsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgQ2F0ZWdvcnlbXSDmjInnsbvlnovliIbnsbsy57u05pWw57uE77yI5bey5o6S5bqP77yJY2F0ZWdvcmllc190eXBl5byV55SoDQogICAgICovDQogICAgcHVibGljICRjYXRlZ29yaWVzYnlvcmRlcl90eXBlID0gYXJyYXkoKTsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgTW9kdWxlW10g5qih5Z2X5pWw57uEDQogICAgICovDQogICAgcHVibGljICRtb2R1bGVzID0gYXJyYXkoKTsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgTW9kdWxlW10g5qih5Z2X5pWw57uE77yI5Lul5paH5Lu25ZCN5Li66ZSu77yJDQogICAgICovDQogICAgcHVibGljICRtb2R1bGVzYnlmaWxlbmFtZSA9IGFycmF5KCk7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIENvbmZpZ1tdIOmFjee9rumAiemhuQ0KICAgICAqLw0KICAgIHB1YmxpYyAkY29uZmlncyA9IGFycmF5KCk7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIFRhZ1tdIOagh+etvuaVsOe7hA0KICAgICAqLw0KICAgIHB1YmxpYyAkdGFncyA9IGFycmF5KCk7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIFRhZ1tdIOagh+etvuaVsOe7hO+8iOS7peagh+etvuWQjeS4uumUru+8iQ0KICAgICAqLw0KICAgIHB1YmxpYyAkdGFnc2J5bmFtZSA9IGFycmF5KCk7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIGFycmF5IOagh+etvuaVsOe7hCBBTEwNCiAgICAgKi8NCiAgICBwdWJsaWMgJHRhZ3NfYWxsID0gYXJyYXkoKTsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgYXJyYXkg5qCH562+5pWw57uEIEJ5IFR5cGUgMue7tOaVsOe7hA0KICAgICAqLw0KICAgIHB1YmxpYyAkdGFnc190eXBlID0gYXJyYXkoKTsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgYXJyYXkg5qCH562+5pWw57uEIEJ5IFR5cGXvvIjku6XmoIfnrb7lkI3kuLrplK7vvIky57u05pWw57uEDQogICAgICovDQogICAgcHVibGljICR0YWdzYnluYW1lX3R5cGUgPSBhcnJheSgpOw0KDQogICAgLyoqDQogICAgICogQHZhciBDb21tZW50W10g6K+E6K665pWw57uEDQogICAgICovDQogICAgcHVibGljICRjb21tZW50cyA9IGFycmF5KCk7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIFBvc3RbXSDmlofnq6DliJfooajmlbDnu4QNCiAgICAgKi8NCiAgICBwdWJsaWMgJHBvc3RzID0gYXJyYXkoKTsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nIOW9k+WJjemhtemdouagh+mimA0KICAgICAqLw0KICAgIHB1YmxpYyAkdGl0bGUgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcg572R56uZ5ZCNDQogICAgICovDQogICAgcHVibGljICRuYW1lID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nIOe9keermeWtkOagh+mimA0KICAgICAqLw0KICAgIHB1YmxpYyAkc3VibmFtZSA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIEFwcCDlvZPliY3kuLvpopgNCiAgICAgKi8NCiAgICBwdWJsaWMgJHRoZW1lID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgYXJyYXkoKSDlvZPliY3kuLvpopjniYjmnKzkv6Hmga8NCiAgICAgKi8NCiAgICBwdWJsaWMgJHRoZW1laW5mbyA9IGFycmF5KCk7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIHN0cmluZyDlvZPliY3kuLvpopjpo47moLwNCiAgICAgKi8NCiAgICBwdWJsaWMgJHN0eWxlID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgTWVtYmVyIOW9k+WJjeeUqOaItw0KICAgICAqLw0KICAgIHB1YmxpYyAkdXNlciA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIENvbmZpZyDnvJPlrZgNCiAgICAgKi8NCiAgICBwdWJsaWMgJGNhY2hlID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgYXJyYXl8bnVsbCDmlbDmja7ooagNCiAgICAgKi8NCiAgICBwdWJsaWMgJHRhYmxlID0gbnVsbDsNCg0KICAgIHB1YmxpYyAkdCA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIGFycmF5fG51bGwg5pWw5o2u6KGo5L+h5oGvDQogICAgICovDQogICAgcHVibGljICRkYXRhaW5mbyA9IG51bGw7DQoNCiAgICBwdWJsaWMgJGQgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBhcnJheXxudWxsIOexu+Wei+W6j+WIlw0KICAgICAqLw0KICAgIHB1YmxpYyAkcG9zdHR5cGUgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBhcnJheXxudWxsIOaTjeS9nOWIl+ihqA0KICAgICAqLw0KICAgIHB1YmxpYyAkYWN0aW9ucyA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIG1peGVkfG51bGx8c3RyaW5nIOW9k+WJjeaTjeS9nA0KICAgICAqLw0KICAgIHB1YmxpYyAkYWN0aW9uID0gbnVsbDsNCg0KICAgIHByb3RlY3RlZCAkaXNpbml0aWFsaXplZCA9IGZhbHNlOyAvL+aYr+WQpuWIneWni+WMluaIkOWKnw0KDQogICAgcHJvdGVjdGVkICRpc2Nvbm5lY3RlZCA9IGZhbHNlOyAvL+aYr+WQpui/nuaOpeaIkOWKnw0KDQogICAgcHJvdGVjdGVkICRpc2xvYWQgPSBmYWxzZTsgLy/mmK/lkKbovb3lhaUNCg0KICAgIHByb3RlY3RlZCAkaXNwcmVsb2FkID0gZmFsc2U7IC8v5piv5ZCm6aKE5Yqg6L29DQoNCiAgICBwcm90ZWN0ZWQgJGlzc2Vzc2lvbiA9IGZhbHNlOyAvL+aYr+WQpuS9v+eUqHNlc3Npb24NCg0KICAgIHB1YmxpYyAkaXNsb2FkbWVtYmVycyA9IGZhbHNlOw0KDQogICAgcHVibGljICRpc2xvYWRjYXRlZ29yaWVzID0gZmFsc2U7DQoNCiAgICBwdWJsaWMgJGlzbG9hZHRhZ3MgPSBmYWxzZTsNCg0KICAgIHB1YmxpYyAkaXNsb2FkbW9kdWxlcyA9IGZhbHNlOw0KDQogICAgcHVibGljICRpc21hbmFnZSA9IGZhbHNlOyAvL+aYr+WQpuWKoOi9veeuoeeQhuaooeW8jw0KDQogICAgcHVibGljICRpc2FwaSA9IGZhbHNlOyAvL+aYr+WQpuWKoOi9vUFQSeaooeW8jw0KDQogICAgcHVibGljICRpc2NtZCA9IGZhbHNlOyAvL+aYr+WQpuWKoOi9vUNNROaooeW8jw0KDQogICAgcHVibGljICRpc2FqYXggPSBmYWxzZTsgLy/mmK/lkKbliqDovb1BSkFY5qih5byPDQoNCiAgICBwdWJsaWMgJGlzeG1scnBjID0gZmFsc2U7IC8v5piv5ZCm5Yqg6L29WE1MLVJQQ+aooeW8jw0KDQogICAgcHVibGljICRpc2h0dHBzID0gZmFsc2U7IC8v5piv5ZCmSFRUUFMNCg0KICAgIHB1YmxpYyAkaXNIdHRwcyA9IGZhbHNlOyAvL+mTvuaOpeiHs2lzaHR0cHMNCg0KICAgIHB1YmxpYyAkaXNkZWJ1ZyA9IGZhbHNlOyAvL+aYr+WQpkRlYnVnIE1vZGUNCg0KICAgIHB1YmxpYyAkaXNsb2dpbiA9IGZhbHNlOyAvL+aYr+WQpkxvZ2luDQoNCiAgICBwdWJsaWMgJGlzbG9nZ2VkaW4gPSBmYWxzZTsgLy/pk77mjqXoh7Npc2xvZ2luDQoNCiAgICAvKioNCiAgICAgKiBAdmFyIFRlbXBsYXRlIOW9k+WJjeaooeadvw0KICAgICAqLw0KICAgIHB1YmxpYyAkdGVtcGxhdGUgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBudWxsIOekvuS8muWMluivhOiuug0KICAgICAqLw0KICAgIHB1YmxpYyAkc29jaWFsY29tbWVudCA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIG51bGwg5qih5p2/5aS06YOoDQogICAgICovDQogICAgcHVibGljICRoZWFkZXIgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBudWxsIOaooeadv+WwvumDqA0KICAgICAqLw0KICAgIHB1YmxpYyAkZm9vdGVyID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgYXJyYXkg5r+A5rS755qE5o+S5Lu25YiX6KGoDQogICAgICovDQogICAgcHVibGljICRhY3RpdmVkYXBwcyA9IGFycmF5KCk7DQoNCiAgICBwdWJsaWMgJGFjdGl2ZWFwcHM7DQoNCiAgICBwdWJsaWMgJGNvb2tpZV90b29rZW5faHR0cG9ubHkgPSB0cnVlOw0KDQogICAgLyoqDQogICAgICogQHZhciBpbnQg566h55CG6aG16Z2i5pi+56S65p2h5pWwDQogICAgICovDQogICAgcHVibGljICRtYW5hZ2Vjb3VudCA9IDUwOw0KDQogICAgLyoqDQogICAgICogQHZhciBudWxsIOeuoeeQhumhtemdouaOkuW6j+S+neaNrg0KICAgICAqLw0KICAgIHB1YmxpYyAkbWFuYWdlb3JkZXIgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBpbnQg6aG156CB5pi+56S65p2h5pWwDQogICAgICovDQogICAgcHVibGljICRwYWdlYmFyY291bnQgPSAxMDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgaW50IOaQnOe0oui/lOWbnuadoeaVsA0KICAgICAqLw0KICAgIHB1YmxpYyAkc2VhcmNoY291bnQgPSAxMDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgaW50IOaWh+eroOWIl+ihqOaYvuekuuadoeaVsA0KICAgICAqLw0KICAgIHB1YmxpYyAkZGlzcGxheWNvdW50ID0gMTA7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIG51bGwg5paH56ug5YiX6KGo5o6S5bqP5L6d5o2uDQogICAgICovDQogICAgcHVibGljICRkaXNwbGF5b3JkZXIgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBpbnQg6K+E6K665pi+56S65pWw6YePDQogICAgICovDQogICAgcHVibGljICRjb21tZW50ZGlzcGxheWNvdW50ID0gMTA7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIGludCBBUEkg5q+P6aG15pyA5aSa5p2h5pWwDQogICAgICovDQogICAgcHVibGljICRhcGlNYXhDb3VudFBlclBhZ2UgPSA1MDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgaW50IOW9k+WJjeWunuS+i+S4i0NTUkYgVG9rZW7ov4fmnJ/ml7bpl7TvvIjlsI/ml7bvvIkNCiAgICAgKi8NCiAgICBwdWJsaWMgJGNzcmZFeHBpcmF0aW9uID0gMTsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgQXBwIOW9k+WJjeS4u+mimOexuw0KICAgICAqLw0KICAgIHB1YmxpYyAkdGhlbWVhcHAgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBpbnQg5YiG57G75pyA5aSn6YCS5b2S5bGC5pWwDQogICAgICovDQogICAgcHVibGljICRjYXRlZ29yeV9yZWN1cnNpb25fbGV2ZWwgPSA1Ow0KDQogICAgLyoqDQogICAgICogQHZhciBpbnQg5YiG57G75a6e6ZmF6YCS5b2S5bGC5pWwDQogICAgICovDQogICAgcHVibGljICRjYXRlZ29yeV9yZWN1cnNpb25fcmVhbF9kZWVwID0gMDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgaW50IOivhOiuuuacgOWkp+mAkuW9kuWxguaVsA0KICAgICAqLw0KICAgIHB1YmxpYyAkY29tbWVudF9yZWN1cnNpb25fbGV2ZWwgPSA0Ow0KDQogICAgLyoqDQogICAgICogQHZhciBodG1sIGpzIGhhc2ggKOS9v+eUqOaXtuivt+eUqOKAnOi/veWKoOKAneWOu+a3u+WKoOiHquW3seeahGhhc2gpDQogICAgICovDQogICAgcHVibGljICRodG1sX2pzX2hhc2ggPSAnJzsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgYWRtaW4ganMgaGFzaCAo5L2/55So5pe26K+355So4oCc6L+95Yqg4oCd5Y675re75Yqg6Ieq5bex55qEaGFzaCkNCiAgICAgKi8NCiAgICBwdWJsaWMgJGFkbWluX2pzX2hhc2ggPSAnJzsNCg0KICAgIC8v6buY6K6k6Lev55SxdXJs5pWw57uEDQogICAgcHVibGljICRyb3V0ZXMgPSBhcnJheSgpOw0KDQogICAgLy/mgLvnvJPlrZjlr7nosaENCiAgICBwdWJsaWMgJGNhY2hlb2JqZWN0ID0gYXJyYXkoKTsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nIOiuvuWumuS4u+mimOS4i+eahOaooeadv+iHquWKqOWhq+WFhee8uuWkseeahGh0bWzmoIfnrb4o6buY6K6k5pivdHJ1ZSkNCiAgICAgKi8NCiAgICBwdWJsaWMgJGF1dG9maWxsX3RlbXBsYXRlX2h0bWx0YWdzID0gdHJ1ZTsNCg0KICAgIGNvbnN0IE9QVElPTl9SRVNFUlZFX0tFWVMgPSAnWkNfREFUQUJBU0VfVFlQRXxaQ19TUUxJVEVfTkFNRXxaQ19TUUxJVEVfUFJFfFpDX01ZU1FMX1NFUlZFUnxaQ19NWVNRTF9VU0VSTkFNRXxaQ19NWVNRTF9QQVNTV09SRHxaQ19NWVNRTF9OQU1FfFpDX01ZU1FMX0NIQVJTRVR8WkNfTVlTUUxfQ09MTEFURXxaQ19NWVNRTF9QUkV8WkNfTVlTUUxfRU5HSU5FfFpDX01ZU1FMX1BPUlR8WkNfTVlTUUxfUEVSU0lTVEVOVHxaQ19NWVNRTF9QT1JUfFpDX1BHU1FMX1NFUlZFUnxaQ19QR1NRTF9VU0VSTkFNRXxaQ19QR1NRTF9QQVNTV09SRHxaQ19QR1NRTF9OQU1FfFpDX1BHU1FMX0NIQVJTRVR8WkNfUEdTUUxfUFJFfFpDX1BHU1FMX1BPUlR8WkNfUEdTUUxfUEVSU0lTVEVOVHxaQ19DTE9TRV9XSE9MRV9TSVRFfFpDX1BFUk1BTkVOVF9ET01BSU5fRk9SQ0VEX1VSTHxaQ19QRVJNQU5FTlRfRE9NQUlOX0ZPUkNFRF9ESVNBQkxFfFpDX0lOU1RBTExfQUZURVJfQ09ORklHJzsNCg0KICAgIC8qKg0KICAgICAqIFpCUOmtlOacr+aWueazleWHveaVsCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLg0KICAgICAqLw0KDQogICAgLyoqDQogICAgICogQGFwaSBGaWx0ZXJfUGx1Z2luX1picF9DYWxsDQogICAgICoNCiAgICAgKiBAcGFyYW0gJG1ldGhvZA0KICAgICAqIEBwYXJhbSAkYXJncw0KICAgICAqDQogICAgICogQHJldHVybiBtaXhlZA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBfX2NhbGwoJG1ldGhvZCwgJGFyZ3MpDQogICAgew0KICAgICAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9aYnBfQ2FsbCddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAgICAgJGZwcmV0dXJuID0gJGZwbmFtZSgkbWV0aG9kLCAkYXJncyk7DQogICAgICAgICAgICBpZiAoJGZwc2lnbmFsID09IFBMVUdJTl9FWElUU0lHTkFMX1JFVFVSTikgew0KICAgICAgICAgICAgICAgICRmcHNpZ25hbCA9IFBMVUdJTl9FWElUU0lHTkFMX05PTkU7DQoNCiAgICAgICAgICAgICAgICByZXR1cm4gJGZwcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKHByZWdfbWF0Y2goJy9HZXQoW2EtekEtWl1bYS16QS1aMC05X10qKUxpc3QvaScsICRtZXRob2QsICRtKSA9PSAxKSB7DQogICAgICAgICAgICAkY2xhc3NuYW1lID0gJG1bMV07DQogICAgICAgICAgICBhcnJheV91bnNoaWZ0KCRhcmdzLCAkY2xhc3NuYW1lKTsNCiAgICAgICAgICAgIGlmIChpc19zdWJjbGFzc19vZigkY2xhc3NuYW1lLCAnQmFzZScpID09IHRydWUpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gY2FsbF91c2VyX2Z1bmNfYXJyYXkoYXJyYXkoJHRoaXMsICdHZXRMaXN0V2l0aEJhc2VPYmplY3QnKSwgJGFyZ3MpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGlmIChwcmVnX21hdGNoKCcvR2V0KFthLXpBLVpdW2EtekEtWjAtOV9dKilCeUFycmF5L2knLCAkbWV0aG9kLCAkbSkgPT0gMSkgew0KICAgICAgICAgICAgJGNsYXNzbmFtZSA9ICRtWzFdOw0KICAgICAgICAgICAgYXJyYXlfdW5zaGlmdCgkYXJncywgJGNsYXNzbmFtZSk7DQogICAgICAgICAgICBpZiAoaXNfc3ViY2xhc3Nfb2YoJGNsYXNzbmFtZSwgJ0Jhc2UnKSA9PSB0cnVlKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIGNhbGxfdXNlcl9mdW5jX2FycmF5KGFycmF5KCR0aGlzLCAnR2V0TGlzdEJ5QXJyYXlXaXRoQmFzZU9iamVjdCcpLCAkYXJncyk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgaWYgKHByZWdfbWF0Y2goJy9HZXQoW2EtekEtWl1bYS16QS1aMC05X10qKUJ5SUQvaScsICRtZXRob2QsICRtKSA9PSAxKSB7DQogICAgICAgICAgICAkY2xhc3NuYW1lID0gJG1bMV07DQogICAgICAgICAgICBhcnJheV91bnNoaWZ0KCRhcmdzLCAkY2xhc3NuYW1lKTsNCiAgICAgICAgICAgIGlmIChpc19zdWJjbGFzc19vZigkY2xhc3NuYW1lLCAnQmFzZScpID09IHRydWUpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gY2FsbF91c2VyX2Z1bmNfYXJyYXkoYXJyYXkoJHRoaXMsICdHZXRTaW5nbGVCeUlEV2l0aEJhc2VPYmplY3QnKSwgJGFyZ3MpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgdHJpZ2dlcl9lcnJvcihnZXRfY2xhc3MoJHRoaXMpIC4gJHRoaXMtPmxhbmdbJ2Vycm9yJ11bODFdIC4gIiAnJG1ldGhvZCcgIiwgRV9VU0VSX1dBUk5JTkcpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOiuvue9ruWPguaVsOWAvA0KICAgICAqDQogICAgICogQHBhcmFtICRuYW1lDQogICAgICogQHBhcmFtICR2YWx1ZQ0KICAgICAqDQogICAgICogQHJldHVybiBtaXhlZA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBfX3NldCgkbmFtZSwgJHZhbHVlKQ0KICAgIHsNCiAgICAgICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fWmJwX1NldCddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAgICAgJGZwcmV0dXJuID0gJGZwbmFtZSgkbmFtZSwgJHZhbHVlKTsNCiAgICAgICAgICAgIGlmICgkZnBzaWduYWwgPT0gUExVR0lOX0VYSVRTSUdOQUxfUkVUVVJOKSB7DQogICAgICAgICAgICAgICAgJGZwc2lnbmFsID0gUExVR0lOX0VYSVRTSUdOQUxfTk9ORTsNCg0KICAgICAgICAgICAgICAgIHJldHVybiAkZnByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgdHJpZ2dlcl9lcnJvcihnZXRfY2xhc3MoJHRoaXMpIC4gJHRoaXMtPmxhbmdbJ2Vycm9yJ11bODFdIC4gIiAnJG5hbWUnICIsIEVfVVNFUl9XQVJOSU5HKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDojrflj5blj4LmlbDlgLwNCiAgICAgKg0KICAgICAqIEBwYXJhbSAkbmFtZQ0KICAgICAqDQogICAgICogQHJldHVybiBtaXhlZA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBfX2dldCgkbmFtZSkNCiAgICB7DQogICAgICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1picF9HZXQnXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgICAgICRmcHJldHVybiA9ICRmcG5hbWUoJG5hbWUpOw0KICAgICAgICAgICAgaWYgKCRmcHNpZ25hbCA9PSBQTFVHSU5fRVhJVFNJR05BTF9SRVRVUk4pIHsNCiAgICAgICAgICAgICAgICAkZnBzaWduYWwgPSBQTFVHSU5fRVhJVFNJR05BTF9OT05FOw0KDQogICAgICAgICAgICAgICAgcmV0dXJuICRmcHJldHVybjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICB0cmlnZ2VyX2Vycm9yKGdldF9jbGFzcygkdGhpcykgLiAkdGhpcy0+bGFuZ1snZXJyb3InXVs4MV0gLiAiICckbmFtZScgIiwgRV9VU0VSX1dBUk5JTkcpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIFpCUOezu+e7n+WIneWni+WMluWPiuWKoOi9vSoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLg0KICAgICAqLw0KDQogICAgLyoqDQogICAgICog6I635Y+W5ZSv5LiA5a6e5L6LLg0KICAgICAqDQogICAgICogQHJldHVybiBudWxsfFpCbG9nUEhQDQogICAgICovDQogICAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiBHZXRJbnN0YW5jZSgpDQogICAgew0KICAgICAgICBpZiAoIWlzc2V0KHNlbGY6OiRwcml2YXRlX3picCkpIHsNCiAgICAgICAgICAgIGlmIChpc3NldCgkR0xPQkFMU1snb3B0aW9uJ11bJ1pDX0dPRFpCUF9GSUxFJ10pICYmIGlzc2V0KCRHTE9CQUxTWydvcHRpb24nXVsnWkNfR09EWkJQX05BTUUnXSkgJiYgaXNfcmVhZGFibGUoWkJQX1BBVEggLiAkR0xPQkFMU1snb3B0aW9uJ11bJ1pDX0dPRFpCUF9GSUxFJ10pKSB7DQogICAgICAgICAgICAgICAgaW5jbHVkZSBaQlBfUEFUSCAuICRHTE9CQUxTWydvcHRpb24nXVsnWkNfR09EWkJQX0ZJTEUnXTsNCiAgICAgICAgICAgICAgICBzZWxmOjokcHJpdmF0ZV96YnAgPSBuZXcgJEdMT0JBTFNbJ29wdGlvbiddWydaQ19HT0RaQlBfTkFNRSddKCk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHNlbGY6OiRwcml2YXRlX3picCA9IG5ldyBzZWxmKCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gc2VsZjo6JHByaXZhdGVfemJwOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWIneWni+WMluaVsOaNruW6k+i/nuaOpS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHR5cGUg5pWw5o2u6L+e5o6l57G75Z6LDQogICAgICoNCiAgICAgKiBAcmV0dXJuIERhdGFiYXNlX19JbnRlcmZhY2UNCiAgICAgKi8NCiAgICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIEluaXRpYWxpemVEQigkdHlwZSkNCiAgICB7DQogICAgICAgIGlmICghdHJpbSgkdHlwZSkpIHsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KDQogICAgICAgICRuZXd0eXBlID0gJ0RhdGFiYXNlX18nIC4gdHJpbSgkdHlwZSk7DQoNCiAgICAgICAgcmV0dXJuIG5ldyAkbmV3dHlwZSgpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOaehOmAoOWHveaVsO+8jOWKoOi9veWfuuacrOmFjee9ruWIsCR6YnAuDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIF9fY29uc3RydWN0KCkNCiAgICB7DQogICAgICAgIGdsb2JhbCAkb3B0aW9uLCAkbGFuZywgJGxhbmdzLCAkYmxvZ3BhdGgsICRibG9naG9zdCwgJGNvb2tpZXNwYXRoLCAkY2FjaGVkaXIsICRsb2dzZGlyLCAkZGF0YWRpciwNCiAgICAgICAgICAgICR0YWJsZSwgJGRhdGFpbmZvLCAkYWN0aW9ucywgJGFjdGlvbiwgJGJsb2d2ZXJzaW9uLCAkYmxvZ3RpdGxlLCAkYmxvZ25hbWUsICRibG9nc3VibmFtZSwgJHJvdXRlcywNCiAgICAgICAgICAgICRibG9ndGhlbWUsICRibG9nc3R5bGUsICRjdXJyZW50dXJsLCAkZnVsbGN1cnJlbnR1cmwsICRjdXJyZW50c2NyaXB0LCAkZnVsbGN1cnJlbnRzY3JpcHQsDQogICAgICAgICAgICAkYWN0aXZlZGFwcHMsICRwb3N0dHlwZSwgJHVzZXJzZGlyLCAkc3lzdGVtZGlyLCAkYWRtaW5kaXIsICR1c2Vyc3VybCwgJHN5c3RlbXVybCwgJGFkbWludXJsOw0KDQogICAgICAgIGlmICgoZGVmaW5lZCgnWkJQX0RFQlVHTU9ERScpICYmIGNvbnN0YW50KCdaQlBfREVCVUdNT0RFJykgPT0gdHJ1ZSkpIHsNCiAgICAgICAgICAgICR0aGlzLT5pc2RlYnVnID0gdHJ1ZTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChaQlBfSE9PS0VSUk9SKSB7DQogICAgICAgICAgICBaQmxvZ0V4Y2VwdGlvbjo6U2V0RXJyb3JIb29rKCk7DQogICAgICAgIH0NCg0KICAgICAgICAvL+WfuuacrOmFjee9ruWKoOi9veWIsCR6YnDlhoUNCiAgICAgICAgJHRoaXMtPnZlcnNpb24gPSAmJGJsb2d2ZXJzaW9uOw0KICAgICAgICAkdGhpcy0+b3B0aW9uID0gJiRvcHRpb247DQogICAgICAgICR0aGlzLT5sYW5nID0gJiRsYW5nOw0KICAgICAgICAkdGhpcy0+bGFuZ3MgPSAmJGxhbmdzOw0KICAgICAgICAkdGhpcy0+cm91dGVzID0gJiRyb3V0ZXM7DQoNCiAgICAgICAgJHRoaXMtPnBhdGggPSAmJGJsb2dwYXRoOw0KICAgICAgICAkdGhpcy0+aG9zdCA9ICYkYmxvZ2hvc3Q7IC8v5q2k5YC85Zyo5ZCO6L655Yid5aeL5YyW5pe25Y+v6IO95Lya5Y+Y5YyWIQ0KICAgICAgICAkdGhpcy0+Y3VycmVudHVybCA9ICYkY3VycmVudHVybDsNCiAgICAgICAgJHRoaXMtPmZ1bGxjdXJyZW50dXJsID0gJiRmdWxsY3VycmVudHVybDsNCiAgICAgICAgJHRoaXMtPmN1cnJlbnRzY3JpcHQgPSAmJGN1cnJlbnRzY3JpcHQ7DQogICAgICAgICR0aGlzLT5mdWxsY3VycmVudHNjcmlwdCA9ICYkZnVsbGN1cnJlbnRzY3JpcHQ7DQogICAgICAgICR0aGlzLT5jb29raWVzcGF0aCA9ICYkY29va2llc3BhdGg7DQogICAgICAgICR0aGlzLT51c2Vyc2RpciA9ICYkdXNlcnNkaXI7DQogICAgICAgICR0aGlzLT5jYWNoZWRpciA9ICYkY2FjaGVkaXI7DQogICAgICAgICR0aGlzLT5sb2dzZGlyID0gJiRsb2dzZGlyOw0KICAgICAgICAkdGhpcy0+ZGF0YWRpciA9ICYkZGF0YWRpcjsNCiAgICAgICAgJHRoaXMtPnN5c3RlbWRpciA9ICYkc3lzdGVtZGlyOw0KICAgICAgICAkdGhpcy0+YWRtaW5kaXIgPSAmJGFkbWluZGlyOw0KICAgICAgICAkdGhpcy0+dXNlcnN1cmwgPSAmJHVzZXJzdXJsOw0KICAgICAgICAkdGhpcy0+c3lzdGVtdXJsID0gJiRzeXN0ZW11cmw7DQogICAgICAgICR0aGlzLT5hZG1pbnVybCA9ICYkYWRtaW51cmw7DQoNCiAgICAgICAgJHRoaXMtPnRhYmxlID0gJiR0YWJsZTsNCiAgICAgICAgJHRoaXMtPmRhdGFpbmZvID0gJiRkYXRhaW5mbzsNCiAgICAgICAgJHRoaXMtPnQgPSAmJHRoaXMtPnRhYmxlOw0KICAgICAgICAkdGhpcy0+ZCA9ICYkdGhpcy0+ZGF0YWluZm87DQogICAgICAgICR0aGlzLT5hY3Rpb25zID0gJiRhY3Rpb25zOw0KICAgICAgICAkdGhpcy0+cG9zdHR5cGUgPSAmJHBvc3R0eXBlOw0KDQogICAgICAgICR0aGlzLT5hY3Rpb24gPSAmJGFjdGlvbjsNCiAgICAgICAgJHRoaXMtPmFjdGl2ZWRhcHBzID0gJiRhY3RpdmVkYXBwczsNCiAgICAgICAgJHRoaXMtPmFjdGl2ZWFwcHMgPSAmJHRoaXMtPmFjdGl2ZWRhcHBzOw0KDQogICAgICAgICR0aGlzLT5ndWlkID0gJiR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfQ0xTSUQnXTsNCg0KICAgICAgICAkdGhpcy0+dGl0bGUgPSAmJGJsb2d0aXRsZTsNCiAgICAgICAgJHRoaXMtPm5hbWUgPSAmJGJsb2duYW1lOw0KICAgICAgICAkdGhpcy0+c3VibmFtZSA9ICYkYmxvZ3N1Ym5hbWU7DQogICAgICAgICR0aGlzLT50aGVtZSA9ICYkYmxvZ3RoZW1lOw0KICAgICAgICAkdGhpcy0+c3R5bGUgPSAmJGJsb2dzdHlsZTsNCg0KICAgICAgICAkdGhpcy0+bWFuYWdlY291bnQgPSAmJHRoaXMtPm9wdGlvblsnWkNfTUFOQUdFX0NPVU5UJ107DQogICAgICAgICR0aGlzLT5tYW5hZ2VvcmRlciA9ICYkdGhpcy0+b3B0aW9uWydaQ19NQU5BR0VfT1JERVInXTsNCiAgICAgICAgJHRoaXMtPnBhZ2ViYXJjb3VudCA9ICYkdGhpcy0+b3B0aW9uWydaQ19QQUdFQkFSX0NPVU5UJ107DQogICAgICAgICR0aGlzLT5zZWFyY2hjb3VudCA9ICYkdGhpcy0+b3B0aW9uWydaQ19TRUFSQ0hfQ09VTlQnXTsNCiAgICAgICAgJHRoaXMtPmRpc3BsYXljb3VudCA9ICYkdGhpcy0+b3B0aW9uWydaQ19ESVNQTEFZX0NPVU5UJ107DQogICAgICAgICR0aGlzLT5kaXNwbGF5b3JkZXIgPSAmJHRoaXMtPm9wdGlvblsnWkNfRElTUExBWV9PUkRFUiddOw0KICAgICAgICAkdGhpcy0+Y29tbWVudGRpc3BsYXljb3VudCA9ICYkdGhpcy0+b3B0aW9uWydaQ19DT01NRU5UU19ESVNQTEFZX0NPVU5UJ107DQoNCiAgICAgICAgJHRoaXMtPmNhdGVnb3JpZXNieW9yZGVyX3R5cGVbMF0gPSBhcnJheSgpOw0KICAgICAgICAkdGhpcy0+Y2F0ZWdvcmllc2J5b3JkZXIgPSAmJHRoaXMtPmNhdGVnb3JpZXNieW9yZGVyX3R5cGVbMF07DQogICAgICAgICR0aGlzLT5jYXRlZ29yaWVzID0gJiR0aGlzLT5jYXRlZ29yaWVzYnlvcmRlcjsNCiAgICAgICAgJHRoaXMtPmNhdGVnb3J5cyA9ICYkdGhpcy0+Y2F0ZWdvcmllczsNCiAgICAgICAgJHRoaXMtPmNhdGVnb3J5c2J5b3JkZXIgPSAmJHRoaXMtPmNhdGVnb3JpZXNieW9yZGVyOw0KDQogICAgICAgICR0aGlzLT50YWdzX3R5cGVbMF0gPSBhcnJheSgpOw0KICAgICAgICAkdGhpcy0+dGFnc2J5bmFtZV90eXBlWzBdID0gYXJyYXkoKTsNCiAgICAgICAgJHRoaXMtPnRhZ3MgPSAmJHRoaXMtPnRhZ3NfdHlwZVswXTsNCiAgICAgICAgJHRoaXMtPnRhZ3NieW5hbWUgPSAmJHRoaXMtPnRhZ3NieW5hbWVfdHlwZVswXTsNCg0KICAgICAgICAkdGhpcy0+dXNlciA9IG5ldyBzdGRDbGFzcygpOw0KICAgICAgICBmb3JlYWNoICgkdGhpcy0+ZGF0YWluZm9bJ01lbWJlciddIGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICAgICAkdGhpcy0+dXNlci0+JGtleSA9ICR2YWx1ZVszXTsNCiAgICAgICAgfQ0KICAgICAgICAkdGhpcy0+dXNlci0+TWV0YXMgPSBuZXcgTWV0YXMoKTsNCg0KICAgICAgICAkdGhpcy0+aXNIdHRwcyA9ICYkdGhpcy0+aXNodHRwczsNCiAgICAgICAgJHRoaXMtPmlzbG9nZ2VkaW4gPSAmJHRoaXMtPmlzbG9naW47DQoNCiAgICAgICAgJHRoaXMtPkJpbmRpbmdDYWNoZSgpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAq5p6Q5p6E5Ye95pWw77yM6YeK5pS+6LWE5rqQLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBfX2Rlc3RydWN0KCkNCiAgICB7DQogICAgICAgICR0aGlzLT5UZXJtaW5hdGUoKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDliJ3lp4vljJYkemJwLg0KICAgICAqDQogICAgICogQHRocm93cyBFeGNlcHRpb24NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBJbml0aWFsaXplKCkNCiAgICB7DQogICAgICAgIGlmICgkdGhpcy0+aXNpbml0aWFsaXplZCkgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgJG9sZFpvbmUgPSAkdGhpcy0+b3B0aW9uWydaQ19USU1FX1pPTkVfTkFNRSddOw0KICAgICAgICBkYXRlX2RlZmF1bHRfdGltZXpvbmVfc2V0KCRvbGRab25lKTsNCg0KICAgICAgICAkb2xkTGFuZyA9ICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfTEFOR1VBR0VQQUNLJ107DQogICAgICAgICR0aGlzLT5Mb2FkTGFuZ3VhZ2UoJ3N5c3RlbScsICcnKTsNCg0KICAgICAgICBpZiAoJHRoaXMtPm9wdGlvblsnWkNfQ0xPU0VfV0hPTEVfU0lURSddID09IHRydWUpIHsNCiAgICAgICAgICAgIEh0dHA1MDMoKTsNCiAgICAgICAgICAgICR0aGlzLT5TaG93RXJyb3IoODIsIF9fRklMRV9fLCBfX0xJTkVfXyk7DQoNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmICghJHRoaXMtPk9wZW5Db25uZWN0KCkpIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgICR0aGlzLT5Db252ZXJ0VGFibGVBbmREYXRhaW5mbygpOw0KDQogICAgICAgICR0aGlzLT5Mb2FkQ29uZmlnc09ubHlTeXN0ZW0odHJ1ZSk7DQogICAgICAgICR0aGlzLT5Mb2FkT3B0aW9uKCk7DQoNCiAgICAgICAgaWYgKCR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfTEFOR1VBR0VQQUNLJ10gPT09ICdTaW1wQ2hpbmVzZScpIHsNCiAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfTEFOR1VBR0VQQUNLJ10gPSAnemgtY24nOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfTEFOR1VBR0VQQUNLJ10gPT09ICdUcmFkQ2hpbmVzZScpIHsNCiAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfTEFOR1VBR0VQQUNLJ10gPSAnemgtdHcnOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCRvbGRMYW5nICE9ICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfTEFOR1VBR0VQQUNLJ10pIHsNCiAgICAgICAgICAgICR0aGlzLT5Mb2FkTGFuZ3VhZ2UoJ3N5c3RlbScsICcnKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChpc3NldCgkdGhpcy0+b3B0aW9uWydaQ19ERUJVR19NT0RFX1dBUk5JTkcnXSkpIHsNCiAgICAgICAgICAgIFpCbG9nRXhjZXB0aW9uOjokaXN3YXJuaW5nID0gKGJvb2wpICR0aGlzLT5vcHRpb25bJ1pDX0RFQlVHX01PREVfV0FSTklORyddOw0KICAgICAgICB9DQogICAgICAgIGlmIChpc3NldCgkdGhpcy0+b3B0aW9uWydaQ19ERUJVR19NT0RFX1NUUklDVCddKSkgew0KICAgICAgICAgICAgWkJsb2dFeGNlcHRpb246OiRpc3N0cmljdCA9IChib29sKSAkdGhpcy0+b3B0aW9uWydaQ19ERUJVR19NT0RFX1NUUklDVCddOw0KICAgICAgICB9DQogICAgICAgIGlmIChpc3NldCgkdGhpcy0+b3B0aW9uWydaQ19ERUJVR19MT0dfRVJST1InXSkpIHsNCiAgICAgICAgICAgIFpCbG9nRXhjZXB0aW9uOjokaXNsb2dlcnJvciA9IChib29sKSAkdGhpcy0+b3B0aW9uWydaQ19ERUJVR19MT0dfRVJST1InXTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChkZWZpbmVkKCdaQlBfREVCVUdNT0RFJykgJiYgY29uc3RhbnQoJ1pCUF9ERUJVR01PREUnKSA9PSB0cnVlKSB7DQogICAgICAgICAgICBaQmxvZ0V4Y2VwdGlvbjo6JGlzd2FybmluZyA9IHRydWU7DQogICAgICAgICAgICBaQmxvZ0V4Y2VwdGlvbjo6JGlzc3RyaWN0ID0gdHJ1ZTsNCiAgICAgICAgICAgIFpCbG9nRXhjZXB0aW9uOjokaXNsb2dlcnJvciA9IHRydWU7DQogICAgICAgIH0NCg0KICAgICAgICAvL+a2iOmZpDE25Y2H57qnMTflj4jpgIDlm54xNuWQjuWGjeWNh+e6pzE35Ye655qEYnVnOw0KICAgICAgICBpZiAoaXNfYXJyYXkoJHRoaXMtPm9wdGlvblsnWkNfQkxPR19IT1NUJ10pICYmIGlzX2FycmF5KCR0aGlzLT5vcHRpb25bJ1pDX1BFUk1BTkVOVF9ET01BSU5fRU5BQkxFJ10pKSB7DQogICAgICAgICAgICBGaXhfMTZfdG9fMTdfYW5kXzE3X3RvXzE2X0Vycm9yKCk7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoZGVmaW5lZCgnWkJQX1BSRVNFVF9IT1NUX1VTRUQnKSkgew0KICAgICAgICAgICAgLy/lpoLmnpznjq/looPlj5jph4/lt7LpooTorr7kuoZibG9naG9zdA0KICAgICAgICAgICAgJHRoaXMtPmhvc3QgPSBydHJpbSgkdGhpcy0+aG9zdCwgJy8nKSAuICcvJzsNCiAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfSE9TVCddID0gJHRoaXMtPmhvc3Q7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAvL1pDX1BFUk1BTkVOVF9ET01BSU5fV0hPTEVfRElTQUJMReS4jeWtmOWcqCDmiJbmmK8gWkNfUEVSTUFORU5UX0RPTUFJTl9XSE9MRV9ESVNBQkxF5a2Y5Zyo5L2G5Li65YGHDQogICAgICAgICAgICAkZG9tYWluX2Rpc2FibGUgPSBHZXRWYWx1ZUluQXJyYXkoJHRoaXMtPm9wdGlvbiwgJ1pDX1BFUk1BTkVOVF9ET01BSU5fV0hPTEVfRElTQUJMRScpOw0KICAgICAgICAgICAgaWYgKCRkb21haW5fZGlzYWJsZSA9PSBmYWxzZSkgew0KICAgICAgICAgICAgICAgICRmb3JjZWRfdXJsID0gR2V0VmFsdWVJbkFycmF5KCR0aGlzLT5vcHRpb24sICdaQ19QRVJNQU5FTlRfRE9NQUlOX0ZPUkNFRF9VUkwnKTsNCiAgICAgICAgICAgICAgICBpZiAoJGZvcmNlZF91cmwgIT0gJycpIHsNCiAgICAgICAgICAgICAgICAgICAgLy/lpoLmnpxaQ19QRVJNQU5FTlRfRE9NQUlOX0ZPUkNFRF9VUkzlrZjlnKgg5LiU5LiN5Li656m6DQogICAgICAgICAgICAgICAgICAgICRmb3JjZWRfdXJsID0gcnRyaW0oJGZvcmNlZF91cmwsICcvJykgLiAnLyc7DQogICAgICAgICAgICAgICAgICAgICR0aGlzLT5ob3N0ID0gKHN0cmluZykgJGZvcmNlZF91cmw7DQogICAgICAgICAgICAgICAgICAgICR0aGlzLT5jb29raWVzcGF0aCA9IHN0cnN0cihzdHJfcmVwbGFjZSgnOi8vJywgJycsICR0aGlzLT5ob3N0KSwgJy8nKTsNCiAgICAgICAgICAgICAgICB9IGVsc2VpZiAoJHRoaXMtPm9wdGlvblsnWkNfUEVSTUFORU5UX0RPTUFJTl9FTkFCTEUnXSA9PSB0cnVlKSB7DQogICAgICAgICAgICAgICAgICAgIC8v5aaC5p6cWkNfUEVSTUFORU5UX0RPTUFJTl9FTkFCTEXlt7LlvIDlkK/nmoTor50NCiAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmhvc3QgPSAkdGhpcy0+b3B0aW9uWydaQ19CTE9HX0hPU1QnXTsNCiAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmhvc3QgPSBydHJpbSgkdGhpcy0+aG9zdCwgJy8nKSAuICcvJzsNCiAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmNvb2tpZXNwYXRoID0gc3Ryc3RyKHN0cl9yZXBsYWNlKCc6Ly8nLCAnJywgJHRoaXMtPmhvc3QpLCAnLycpOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIC8v6buY6K6k6Ieq5Yqo6K+G5Yir5Z+f5ZCNDQogICAgICAgICAgICAgICAgICAgICR0aGlzLT5ob3N0ID0gcnRyaW0oJHRoaXMtPmhvc3QsICcvJykgLiAnLyc7DQogICAgICAgICAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfSE9TVCddID0gJHRoaXMtPmhvc3Q7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAkdGhpcy0+aG9zdCA9IHJ0cmltKCR0aGlzLT5ob3N0LCAnLycpIC4gJy8nOw0KICAgICAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfSE9TVCddID0gJHRoaXMtPmhvc3Q7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19CTE9HX1BST0RVQ1QnXSA9ICdaLUJsb2dQSFAnOw0KICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19CTE9HX1ZFUlNJT04nXSA9IFpDX0JMT0dfVkVSU0lPTjsNCiAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfTk9XX1ZFUlNJT04nXSA9ICR0aGlzLT52ZXJzaW9uOw0KICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19CTE9HX0NPTU1JVCddID0gWkNfQkxPR19DT01NSVQ7DQogICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfUFJPRFVDVF9GVUxMJ10gPSAkdGhpcy0+b3B0aW9uWydaQ19CTE9HX1BST0RVQ1QnXSAuICcgJyAuIFpDX1ZFUlNJT05fRElTUExBWTsNCiAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfQkxPR19QUk9EVUNUX0ZVTExIVE1MJ10gPSAnPGEgaHJlZj0iaHR0cHM6Ly93d3cuemJsb2djbi5jb20vIiB0aXRsZT0iWi1CbG9nUEhQICcgLiBaQ19CTE9HX1ZFUlNJT04gLiAnIiB0YXJnZXQ9Il9ibGFuayIgcmVsPSJub29wZW5lciBub3JlZmZlcnJlciI+JyAuICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfUFJPRFVDVF9GVUxMJ10gLiAnPC9hPic7DQogICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfUFJPRFVDVF9IVE1MJ10gPSAnPGEgaHJlZj0iaHR0cHM6Ly93d3cuemJsb2djbi5jb20vIiB0aXRsZT0iWi1CbG9nUEhQICcgLiBaQ19CTE9HX1ZFUlNJT04gLiAnIiB0YXJnZXQ9Il9ibGFuayIgcmVsPSJub29wZW5lciBub3JlZmZlcnJlciI+JyAuICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfUFJPRFVDVCddIC4gJzwvYT4nOw0KDQogICAgICAgIGlmICgkb2xkWm9uZSAhPSAkdGhpcy0+b3B0aW9uWydaQ19USU1FX1pPTkVfTkFNRSddKSB7DQogICAgICAgICAgICBkYXRlX2RlZmF1bHRfdGltZXpvbmVfc2V0KCR0aGlzLT5vcHRpb25bJ1pDX1RJTUVfWk9ORV9OQU1FJ10pOw0KICAgICAgICB9DQoNCiAgICAgICAgLyppZihpc3NldCgkX0NPT0tJRVsndGltZXpvbmUnXSkpew0KICAgICAgICAgICAgJHR6PUdldFZhcnMoJ3RpbWV6b25lJywnQ09PS0lFJyk7DQogICAgICAgICAgICBpZihpc19udW1lcmljKCR0eikpew0KICAgICAgICAgICAgJHR6PXNwcmludGYoJyUrZCcsLSR0eik7DQogICAgICAgICAgICBkYXRlX2RlZmF1bHRfdGltZXpvbmVfc2V0KCdFdGMvR01UJyAuICR0eik7DQogICAgICAgICAgICAkdGhpcy0+dGltZXpvbmU9ZGF0ZV9kZWZhdWx0X3RpbWV6b25lX2dldCgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAqLw0KDQogICAgICAgIGlmICgkdGhpcy0+b3B0aW9uWydaQ19WRVJTSU9OX0lOX0hFQURFUiddICYmICFoZWFkZXJzX3NlbnQoKSkgew0KICAgICAgICAgICAgaGVhZGVyKCdQcm9kdWN0OicgLiAkdGhpcy0+b3B0aW9uWydaQ19CTE9HX1BST0RVQ1RfRlVMTCddKTsNCiAgICAgICAgfQ0KDQogICAgICAgICRwYXJzZWRIb3N0ID0gcGFyc2VfdXJsKCR0aGlzLT5ob3N0KTsNCiAgICAgICAgaWYgKGlzc2V0KCRwYXJzZWRIb3N0WydzY2hlbWUnXSkgJiYgaXNzZXQoJHBhcnNlZEhvc3RbJ2hvc3QnXSkpIHsNCiAgICAgICAgICAgICR0aGlzLT5mdWxsY3VycmVudHVybCA9ICRwYXJzZWRIb3N0WydzY2hlbWUnXSAuICc6Ly8nIC4gJHBhcnNlZEhvc3RbJ2hvc3QnXTsNCiAgICAgICAgICAgIGlmIChpc3NldCgkcGFyc2VkSG9zdFsncG9ydCddKSkgew0KICAgICAgICAgICAgICAgICR0aGlzLT5mdWxsY3VycmVudHVybCAuPSAnOicgLiAkcGFyc2VkSG9zdFsncG9ydCddOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJHRoaXMtPmZ1bGxjdXJyZW50dXJsID0gJyc7DQogICAgICAgIH0NCiAgICAgICAgJHRoaXMtPmZ1bGxjdXJyZW50dXJsIC49ICR0aGlzLT5jdXJyZW50dXJsOw0KDQogICAgICAgIGlmIChzdHJpcG9zKCR0aGlzLT5ob3N0LCAnaHR0cCcpID09PSAwKSB7DQogICAgICAgICAgICBpZiAoc3RyaXBvcygkdGhpcy0+aG9zdCwgJ2h0dHBzOi8vJykgPT09IDApIHsNCiAgICAgICAgICAgICAgICAkdGhpcy0+aXNodHRwcyA9IHRydWU7DQogICAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkdGhpcy0+aXNodHRwcyA9IChIVFRQX1NDSEVNRSA9PT0gJ2h0dHBzOi8vJyk7DQogICAgICAgIH0NCiAgICAgICAgLy92YXJfZHVtcCgkdGhpcy0+aXNodHRwcyk7ZGllOw0KDQogICAgICAgICR0aGlzLT51c2Vyc3VybCA9ICR0aGlzLT5ob3N0IC4gJ3piX3VzZXJzLyc7DQogICAgICAgICR0aGlzLT5zeXN0ZW11cmwgPSAkdGhpcy0+aG9zdCAuICd6Yl9zeXN0ZW0vJzsNCiAgICAgICAgJHRoaXMtPmFkbWludXJsID0gJHRoaXMtPmhvc3QgLiAnemJfc3lzdGVtL2FkbWluLyc7DQoNCiAgICAgICAgJHRoaXMtPnZlcmlmeUNvZGVVcmwgPSAkdGhpcy0+c3lzdGVtdXJsIC4gJ3NjcmlwdC9jX3ZhbGlkY29kZS5waHAnOw0KICAgICAgICAkdGhpcy0+dmFsaWRjb2RldXJsID0gJiR0aGlzLT52ZXJpZnlDb2RlVXJsOw0KICAgICAgICAkdGhpcy0+ZmVlZHVybCA9ICR0aGlzLT5ob3N0IC4gJ2ZlZWQucGhwJzsNCiAgICAgICAgJHRoaXMtPnNlYXJjaHVybCA9ICR0aGlzLT5ob3N0IC4gJ3NlYXJjaC5waHAnOw0KICAgICAgICAkdGhpcy0+Y21kdXJsID0gJHRoaXMtPnN5c3RlbXVybCAuICdjbWQucGhwJzsNCiAgICAgICAgJHRoaXMtPmFqYXh1cmwgPSAkdGhpcy0+Y21kdXJsIC4gJz9hY3Q9YWpheCZzcmM9JzsNCiAgICAgICAgJHRoaXMtPnhtbHJwY3VybCA9ICR0aGlzLT5zeXN0ZW11cmwgLiAneG1sLXJwYy9pbmRleC5waHAnOw0KICAgICAgICAkdGhpcy0+YXBpdXJsID0gJHRoaXMtPnN5c3RlbXVybCAuICdhcGkucGhwJzsNCg0KICAgICAgICAkdGhpcy0+TG9hZENvbmZpZ3NPbmx5U3lzdGVtKGZhbHNlKTsNCg0KICAgICAgICAkdGhpcy0+TG9hZENhY2hlKCk7DQoNCiAgICAgICAgIWRlZmluZWQoJ1pCUF9JTl9BUEknKSB8fCAkdGhpcy0+aXNhcGkgPSB0cnVlOw0KICAgICAgICAhZGVmaW5lZCgnWkJQX0lOX0NNRCcpIHx8ICR0aGlzLT5pc2NtZCA9IHRydWU7DQogICAgICAgICFkZWZpbmVkKCdaQlBfSU5fQUpBWCcpIHx8ICR0aGlzLT5pc2FqYXggPSB0cnVlOw0KICAgICAgICAhZGVmaW5lZCgnWkJQX0lOX1hNTFJQQycpIHx8ICR0aGlzLT5pc3htbHJwYyA9IHRydWU7DQogICAgICAgICEkdGhpcy0+b3B0aW9uWydaQ19ERUJVR19NT0RFJ10gfHwgJHRoaXMtPmlzZGVidWcgPSB0cnVlOw0KDQogICAgICAgICR0aGlzLT5Mb2FkUG9zdFR5cGUoKTsNCiAgICAgICAgJHRoaXMtPkxvYWRSb3V0ZXMoKTsNCg0KICAgICAgICAkdGhpcy0+dGhlbWVhcHAgPSBuZXcgQXBwKCk7DQogICAgICAgICR0aGlzLT50aGVtZWluZm8gPSAkdGhpcy0+dGhlbWVhcHAtPkdldEluZm9BcnJheSgpOw0KDQogICAgICAgICR0aGlzLT5pc2luaXRpYWxpemVkID0gdHJ1ZTsNCg0KICAgICAgICBpZiAoJHRoaXMtPmlzYXBpKSB7DQogICAgICAgICAgICAvL+aMgui9vUFQSemUmeivr+aYvuekug0KICAgICAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fRGVidWdfRGlzcGxheScsICdBcGlEZWJ1Z0Rpc3BsYXknKTsNCiAgICAgICAgICAgIEFkZF9GaWx0ZXJfUGx1Z2luKCdGaWx0ZXJfUGx1Z2luX1picF9TaG93RXJyb3InLCAnQXBpU2hvd0Vycm9yJyk7DQogICAgICAgICAgICAvL+aMgui9vVRva2Vu6aqM6K+BDQogICAgICAgICAgICBBZGRfRmlsdGVyX1BsdWdpbignRmlsdGVyX1BsdWdpbl9aYnBfUHJlTG9hZCcsICdBcGlUb2tlblZlcmlmeScpOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6K+75Y+W57O757uf6aKE6K6+5paH5Lu26YeM55qEUG9zdFR5cGXphY3nva4NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gTG9hZFBvc3RUeXBlKCkNCiAgICB7DQogICAgICAgIGZvcmVhY2ggKGFycmF5KDAgPT4gJ2FydGljbGUnLCAxID0+ICdwYWdlJykgYXMgJHBvc3RpZCA9PiAkcG9zdG5hbWUpIHsNCiAgICAgICAgICAgICRmaWxlID0gWkJQX1BBVEggLiAnemJfc3lzdGVtL2RlZmVuZC9wb3N0dHlwZV8nIC4gJHBvc3RuYW1lIC4gJy5waHAnOw0KICAgICAgICAgICAgJHRoaXMtPkxvYWRQb3N0VHlwZV9GaWxlKCRmaWxlKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KDQogICAgLyoqDQogICAgICog6K+75Y+W5oyH5a6a5paH5Lu26YeM55qEUG9zdFR5cGXphY3nva4NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gTG9hZFBvc3RUeXBlX0ZpbGUoJGZpbGUpDQogICAgew0KICAgICAgICBpZiAoaXNfcmVhZGFibGUoJGZpbGUpKSB7DQogICAgICAgICAgICAkcG9zdHR5cGUgPSBpbmNsdWRlICRmaWxlOw0KICAgICAgICAgICAgJHRoaXMtPlJlZ1Bvc3RUeXBlKCRwb3N0dHlwZSk7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOivu+WPluezu+e7n+mihOiuvuaWh+S7tumHjOeahOi3r+eUsemFjee9rg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBMb2FkUm91dGVzKCkNCiAgICB7DQogICAgICAgIGZvcmVhY2ggKGFycmF5KDAgPT4gJ2FydGljbGUnLCAxID0+ICdwYWdlJykgYXMgJHBvc3RpZCA9PiAkcG9zdG5hbWUpIHsNCiAgICAgICAgICAgICRmaWxlID0gIFpCUF9QQVRIIC4gJ3piX3N5c3RlbS9kZWZlbmQvcm91dGVzX3Bvc3RfJyAuICRwb3N0bmFtZSAuICcucGhwJzsNCiAgICAgICAgICAgICR0aGlzLT5Mb2FkUm91dGVzX0ZpbGUoJGZpbGUpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6K+75Y+W5oyH5a6a5paH5Lu26YeM55qE6Lev55Sx6YWN572uDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIExvYWRSb3V0ZXNfRmlsZSgkZmlsZSkNCiAgICB7DQogICAgICAgIGlmIChpc19yZWFkYWJsZSgkZmlsZSkpIHsNCiAgICAgICAgICAgICRyb3V0ZSA9IGluY2x1ZGUgJGZpbGU7DQogICAgICAgICAgICBmb3JlYWNoICgkcm91dGUgYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgICAgICAgICAkdGhpcy0+UmVnUm91dGUoJHZhbHVlKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5ZyoSW5pdGlhbGl6ZeWSjOWKoOi9veaJgOacieaPkuS7tmluY2x1ZGXkuYvlkI7vvIzlnKhMb2Fk5LmL5YmN55qE6L+H56iL77yM6KKrY19zeXN0ZW1fYmFzZeiwg+eUqO+8jDEuN+mHjOaWsOWKoOeahA0KICAgICAqDQogICAgICogQHRocm93cyBFeGNlcHRpb24NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBQcmVMb2FkKCkNCiAgICB7DQogICAgICAgIGlmICghJHRoaXMtPmlzaW5pdGlhbGl6ZWQgfHwgJHRoaXMtPmlzcHJlbG9hZCkgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fWmJwX1ByZUxvYWQnXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgICAgICRmcHJldHVybiA9ICRmcG5hbWUoKTsNCiAgICAgICAgfQ0KDQogICAgICAgICR0aGlzLT5pc3ByZWxvYWQgPSB0cnVlOw0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDku47mlbDmja7lupPph4zor7vlj5bkv6Hmga/vvIzlkK/liqjmlbTkuKpaQlAuDQogICAgICoNCiAgICAgKiBAdGhyb3dzIEV4Y2VwdGlvbg0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIExvYWQoKQ0KICAgIHsNCiAgICAgICAgaWYgKCEkdGhpcy0+aXNpbml0aWFsaXplZCB8fCAhJHRoaXMtPmlzcHJlbG9hZCB8fCAkdGhpcy0+aXNsb2FkKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCg0KICAgICAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9aYnBfTG9hZF9QcmUnXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgICAgICRmcHJldHVybiA9ICRmcG5hbWUoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmICghaGVhZGVyc19zZW50KCkpIHsNCiAgICAgICAgICAgIGhlYWRlcignQ29udGVudC10eXBlOiB0ZXh0L2h0bWw7IGNoYXJzZXQ9dXRmLTgnKTsNCiAgICAgICAgfQ0KDQogICAgICAgICR0aGlzLT5Db252ZXJ0VGFibGVBbmREYXRhaW5mbygpOw0KICAgICAgICBpZiAoJHRoaXMtPm9wdGlvblsnWkNfTE9BRE1FTUJFUlNfTEVWRUwnXSA9PSAwKSB7DQogICAgICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19MT0FETUVNQkVSU19MRVZFTCddID0gMTsNCiAgICAgICAgfQ0KICAgICAgICAkdGhpcy0+aXNsb2FkbWVtYmVycyB8fCAkdGhpcy0+TG9hZE1lbWJlcnMoJHRoaXMtPm9wdGlvblsnWkNfTE9BRE1FTUJFUlNfTEVWRUwnXSk7DQogICAgICAgICR0aGlzLT5pc2xvYWRjYXRlZ29yaWVzIHx8ICR0aGlzLT5Mb2FkQ2F0ZWdvcmllcygpOw0KICAgICAgICAvLyR0aGlzLT5pc2xvYWR0YWdzIHx8ICR0aGlzLT5Mb2FkVGFncygpOw0KICAgICAgICAkdGhpcy0+aXNsb2FkbW9kdWxlcyB8fCAkdGhpcy0+TG9hZE1vZHVsZXMoKTsNCiAgICAgICAgJHRoaXMtPlJlZ0J1aWxkTW9kdWxlcygpOw0KDQogICAgICAgIGlmICgkdGhpcy0+Q2hlY2tJc0xvZ2dlZGluKCkgPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICR0aGlzLT5WZXJpZnkoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8v5Yib5bu65qih5p2/57G7DQogICAgICAgICR0aGlzLT50ZW1wbGF0ZSA9ICR0aGlzLT5QcmVwYXJlVGVtcGxhdGUoKTsNCg0KICAgICAgICBBZGRfRmlsdGVyX1BsdWdpbignRmlsdGVyX1BsdWdpbl9Mb2dpbl9IZWFkZXInLCAnSW5jbHVkZV9BZGRvbkFkbWluRm9udCcpOw0KICAgICAgICBBZGRfRmlsdGVyX1BsdWdpbignRmlsdGVyX1BsdWdpbl9PdGhlcl9IZWFkZXInLCAnSW5jbHVkZV9BZGRvbkFkbWluRm9udCcpOw0KICAgICAgICBBZGRfRmlsdGVyX1BsdWdpbignRmlsdGVyX1BsdWdpbl9BZG1pbl9IZWFkZXInLCAnSW5jbHVkZV9BZGRvbkFkbWluRm9udCcpOw0KICAgICAgICBBZGRfRmlsdGVyX1BsdWdpbignRmlsdGVyX1BsdWdpbl9BZG1pbl9IZWFkZXInLCAnSW5jbHVkZV9BZG1pbl9DaGVja01vYmxpZScpOw0KICAgICAgICBBZGRfRmlsdGVyX1BsdWdpbignRmlsdGVyX1BsdWdpbl9BZG1pbl9IZWFkZXInLCAnSW5jbHVkZV9BZG1pbl9VcGRhdGVBcHBBZnRlcicpOw0KICAgICAgICBBZGRfRmlsdGVyX1BsdWdpbignRmlsdGVyX1BsdWdpbl9CYXRjaFBvc3QnLCAnSW5jbHVkZV9CYXRjaFBvc3RfQXJ0aWNsZScpOw0KICAgICAgICBBZGRfRmlsdGVyX1BsdWdpbignRmlsdGVyX1BsdWdpbl9CYXRjaFBvc3QnLCAnSW5jbHVkZV9CYXRjaFBvc3RfUGFnZScpOw0KICAgICAgICBBZGRfRmlsdGVyX1BsdWdpbignRmlsdGVyX1BsdWdpbl9JbmRleF9FbmQnLCAnSW5jbHVkZV9JbmRleF9FbmQnKTsNCiAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fU2VhcmNoX0VuZCcsICdJbmNsdWRlX0luZGV4X0VuZCcpOw0KICAgICAgICBBZGRfRmlsdGVyX1BsdWdpbignRmlsdGVyX1BsdWdpbl9JbmRleF9CZWdpbicsICdJbmNsdWRlX0luZGV4X0JlZ2luJyk7DQogICAgICAgIEFkZF9GaWx0ZXJfUGx1Z2luKCdGaWx0ZXJfUGx1Z2luX1NlYXJjaF9CZWdpbicsICdJbmNsdWRlX0luZGV4X0JlZ2luJyk7DQogICAgICAgIEFkZF9GaWx0ZXJfUGx1Z2luKCdGaWx0ZXJfUGx1Z2luX0ZlZWRfQmVnaW4nLCAnSW5jbHVkZV9JbmRleF9CZWdpbicpOw0KICAgICAgICBBZGRfRmlsdGVyX1BsdWdpbignRmlsdGVyX1BsdWdpbl9aYnBfQ2hlY2tSaWdodHMnLCAnSW5jbHVkZV9Gcm9udGVuZF9DaGVja1JpZ2h0cycpOw0KDQogICAgICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1picF9Mb2FkJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICAgICAkZnBuYW1lKCk7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoJHRoaXMtPmlzbWFuYWdlKSB7DQogICAgICAgICAgICAkdGhpcy0+TG9hZE1hbmFnZSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgLy/ov5vlkI7lj7DmiJblvIDosIPor5XlkI7nmoTliY3lj7DnmoTorr/pl67ov5vooYzoh6rliqjmo4DmtYvmqKHmnb/lubboh6rliqjph43lu7oNCiAgICAgICAgaWYgKCR0aGlzLT5vcHRpb25bJ1pDX0RFQlVHX01PREUnXSB8fCAkdGhpcy0+aXNtYW5hZ2UpIHsNCiAgICAgICAgICAgICR0aGlzLT5DaGVja1RlbXBsYXRlKCk7DQogICAgICAgIH0NCg0KICAgICAgICAkdGhpcy0+UmVmbHVzaExhbmd1YWdlcygpOw0KICAgICAgICAkdGhpcy0+Q29udmVydFRhYmxlQW5kRGF0YWluZm8oKTsNCg0KICAgICAgICBpZiAoJHRoaXMtPnVzZXItPlN0YXR1cyA9PSBaQ19NRU1CRVJfU1RBVFVTX0xPQ0tFRCkgew0KICAgICAgICAgICAgJHRoaXMtPlNob3dFcnJvcig4MCwgX19GSUxFX18sIF9fTElORV9fKTsNCiAgICAgICAgfQ0KICAgICAgICAkdGhpcy0+Q2hlY2tJc0xvZ2dlZGluKCk7DQoNCiAgICAgICAgJHRoaXMtPmlzbG9hZCA9IHRydWU7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOi9veWFpeeuoeeQhi4NCiAgICAgKg0KICAgICAqIEB0aHJvd3MgRXhjZXB0aW9uDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIExvYWRNYW5hZ2UoKQ0KICAgIHsNCiAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fQWRtaW5fUGFnZU1uZ19TdWJNZW51JywgJ0luY2x1ZGVfQWRtaW5fQWRkcGFnZXN1Ym1lbnUnKTsNCiAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fQWRtaW5fVGFnTW5nX1N1Yk1lbnUnLCAnSW5jbHVkZV9BZG1pbl9BZGR0YWdzdWJtZW51Jyk7DQogICAgICAgIEFkZF9GaWx0ZXJfUGx1Z2luKCdGaWx0ZXJfUGx1Z2luX0FkbWluX0NhdGVnb3J5TW5nX1N1Yk1lbnUnLCAnSW5jbHVkZV9BZG1pbl9BZGRjYXRlc3VibWVudScpOw0KICAgICAgICBBZGRfRmlsdGVyX1BsdWdpbignRmlsdGVyX1BsdWdpbl9BZG1pbl9NZW1iZXJNbmdfU3ViTWVudScsICdJbmNsdWRlX0FkbWluX0FkZG1lbXN1Ym1lbnUnKTsNCiAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fQWRtaW5fTW9kdWxlTW5nX1N1Yk1lbnUnLCAnSW5jbHVkZV9BZG1pbl9BZGRtb2RzdWJtZW51Jyk7DQogICAgICAgIEFkZF9GaWx0ZXJfUGx1Z2luKCdGaWx0ZXJfUGx1Z2luX0FkbWluX0NvbW1lbnRNbmdfU3ViTWVudScsICdJbmNsdWRlX0FkbWluX0FkZGNtdHN1Ym1lbnUnKTsNCiAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fQWRtaW5fU2V0dGluZ01uZ19TdWJNZW51JywgJ0luY2x1ZGVfQWRtaW5fQWRkc2V0dGluZ3N1Ym1lbnUnKTsNCiAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fWmJwX0xvYWRNYW5hZ2UnLCAnSW5jbHVkZV9BZG1pbl9VcGRhdGVEQicpOw0KICAgICAgICBBZGRfRmlsdGVyX1BsdWdpbignRmlsdGVyX1BsdWdpbl9BZG1pbl9FbmQnLCAnSW5jbHVkZV9BZG1pbl9DaGVja0h0dHAzMDRPSycpOw0KICAgICAgICBBZGRfRmlsdGVyX1BsdWdpbignRmlsdGVyX1BsdWdpbl9BZG1pbl9IaW50JywgJ0luY2x1ZGVfQWRtaW5fQ2hlY2tXZWFrUGFzc1dvcmQnKTsNCg0KICAgICAgICBpZiAoaXNzZXQoJEdMT0JBTFNbJ3picHZlcnMnXSkpIHsNCiAgICAgICAgICAgICRHTE9CQUxTWyd6YnB2ZXJzJ11bJEdMT0JBTFNbJ2Jsb2d2ZXJzaW9uJ11dID0gWkNfVkVSU0lPTl9ESVNQTEFZIC4gJyBCdWlsZCAnIC4gJEdMT0JBTFNbJ2Jsb2d2ZXJzaW9uJ107DQogICAgICAgIH0NCg0KICAgICAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9aYnBfTG9hZE1hbmFnZSddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAgICAgJGZwbmFtZSgpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog57uI5q2i6L+e5o6l77yM6YeK5pS+6LWE5rqQLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBUZXJtaW5hdGUoKQ0KICAgIHsNCiAgICAgICAgaWYgKCR0aGlzLT5pc2luaXRpYWxpemVkKSB7DQogICAgICAgICAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9aYnBfVGVybWluYXRlJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICAgICAgICAgJGZwbmFtZSgpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAkdGhpcy0+Q2xvc2VDb25uZWN0KCk7DQoNCiAgICAgICAgICAgIGlmIChaQmxvZ0V4Y2VwdGlvbjo6JGlzbG9nZXJyb3IgJiYgaXNfYXJyYXkoJHRoaXMtPmRiLT5lcnJvcikgJiYgIWVtcHR5KCR0aGlzLT5kYi0+ZXJyb3IpKSB7DQogICAgICAgICAgICAgICAgZm9yZWFjaCAoJHRoaXMtPmRiLT5lcnJvciBhcyAkZSkgew0KICAgICAgICAgICAgICAgICAgICBMb2dzKCR0aGlzLT5kYi0+dHlwZSAuICcgZXJyb3IgaWQ6JyAuIFBIUF9FT0wgLiB2YXJfZXhwb3J0KCRlLCB0cnVlKSwgJ0VSUk9SJyk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB1bnNldCgkdGhpcy0+ZGIpOw0KICAgICAgICAgICAgJHRoaXMtPmlzaW5pdGlhbGl6ZWQgPSBmYWxzZTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOi/nuaOpeaVsOaNruW6ky4NCiAgICAgKg0KICAgICAqIEB0aHJvd3MgRXhjZXB0aW9uDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gT3BlbkNvbm5lY3QoKQ0KICAgIHsNCiAgICAgICAgaWYgKCR0aGlzLT5pc2Nvbm5lY3RlZCkgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCEkdGhpcy0+b3B0aW9uWydaQ19EQVRBQkFTRV9UWVBFJ10pIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgIHN3aXRjaCAoJHRoaXMtPm9wdGlvblsnWkNfREFUQUJBU0VfVFlQRSddKSB7DQogICAgICAgICAgICBjYXNlICdzcWxpdGUnOg0KICAgICAgICAgICAgY2FzZSAnc3FsaXRlMyc6DQogICAgICAgICAgICBjYXNlICdwZG9fc3FsaXRlJzoNCiAgICAgICAgICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19TUUxJVEVfTkFNRSddID0gR2V0T3B0aW9uVmFyc0Zyb21FbnYoJHRoaXMtPm9wdGlvblsnWkNfU1FMSVRFX05BTUUnXSk7DQoNCiAgICAgICAgICAgICAgICBpZiAoJHRoaXMtPm9wdGlvblsnWkNfREFUQUJBU0VfVFlQRSddID09ICdzcWxpdGUnICYmIHZlcnNpb25fY29tcGFyZShQSFBfVkVSU0lPTiwgJzUuNC4wJykgPj0gMCkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoZXh0ZW5zaW9uX2xvYWRlZCgnc3FsaXRlMycpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19EQVRBQkFTRV9UWVBFJ10gPSAnc3FsaXRlMyc7DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZWlmIChleHRlbnNpb25fbG9hZGVkKCdwZG9fc3FsaXRlJykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX0RBVEFCQVNFX1RZUEUnXSA9ICdwZG9fc3FsaXRlJzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAkdGhpcy0+ZGIgPSBzZWxmOjpJbml0aWFsaXplREIoJHRoaXMtPm9wdGlvblsnWkNfREFUQUJBU0VfVFlQRSddKTsNCiAgICAgICAgICAgICAgICBpZiAoJHRoaXMtPmRiLT5PcGVuKA0KICAgICAgICAgICAgICAgICAgICBhcnJheSgNCiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5kYXRhZGlyIC4gJycgLiAkdGhpcy0+b3B0aW9uWydaQ19TUUxJVEVfTkFNRSddLA0KICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfU1FMSVRFX1BSRSddLA0KICAgICAgICAgICAgICAgICAgICApDQogICAgICAgICAgICAgICAgKSA9PSBmYWxzZQ0KICAgICAgICAgICAgICAgICkgew0KICAgICAgICAgICAgICAgICAgICAkdGhpcy0+U2hvd0Vycm9yKDY5LCBfX0ZJTEVfXywgX19MSU5FX18pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ3Bvc3RncmVzcWwnOg0KICAgICAgICAgICAgY2FzZSAncGRvX3Bvc3RncmVzcWwnOg0KICAgICAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX1BHU1FMX1NFUlZFUiddID0gR2V0T3B0aW9uVmFyc0Zyb21FbnYoJHRoaXMtPm9wdGlvblsnWkNfUEdTUUxfU0VSVkVSJ10pOw0KICAgICAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX1BHU1FMX1VTRVJOQU1FJ10gPSBHZXRPcHRpb25WYXJzRnJvbUVudigkdGhpcy0+b3B0aW9uWydaQ19QR1NRTF9VU0VSTkFNRSddKTsNCiAgICAgICAgICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19QR1NRTF9QQVNTV09SRCddID0gR2V0T3B0aW9uVmFyc0Zyb21FbnYoJHRoaXMtPm9wdGlvblsnWkNfUEdTUUxfUEFTU1dPUkQnXSk7DQogICAgICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfUEdTUUxfTkFNRSddID0gR2V0T3B0aW9uVmFyc0Zyb21FbnYoJHRoaXMtPm9wdGlvblsnWkNfUEdTUUxfTkFNRSddKTsNCiAgICAgICAgICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19QR1NRTF9QT1JUJ10gPSBHZXRPcHRpb25WYXJzRnJvbUVudigkdGhpcy0+b3B0aW9uWydaQ19QR1NRTF9QT1JUJ10pOw0KDQogICAgICAgICAgICAgICAgaWYgKCR0aGlzLT5vcHRpb25bJ1pDX0RBVEFCQVNFX1RZUEUnXSA9PSAncG9zdGdyZXNxbCcpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCFleHRlbnNpb25fbG9hZGVkKCdwZ3NxbCcpICYmIGV4dGVuc2lvbl9sb2FkZWQoJ3Bkb19wZ3NxbCcpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19EQVRBQkFTRV9UWVBFJ10gPSAncGRvX3Bvc3RncmVzcWwnOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICR0aGlzLT5kYiA9IHNlbGY6OkluaXRpYWxpemVEQigkdGhpcy0+b3B0aW9uWydaQ19EQVRBQkFTRV9UWVBFJ10pOw0KICAgICAgICAgICAgICAgIGlmICgkdGhpcy0+ZGItPk9wZW4oDQogICAgICAgICAgICAgICAgICAgIGFycmF5KA0KICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfUEdTUUxfU0VSVkVSJ10sDQogICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19QR1NRTF9VU0VSTkFNRSddLA0KICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfUEdTUUxfUEFTU1dPUkQnXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX1BHU1FMX05BTUUnXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX1BHU1FMX1BSRSddLA0KICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfUEdTUUxfUE9SVCddLA0KICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfUEdTUUxfUEVSU0lTVEVOVCddLA0KICAgICAgICAgICAgICAgICAgICApDQogICAgICAgICAgICAgICAgKSA9PSBmYWxzZQ0KICAgICAgICAgICAgICAgICkgew0KICAgICAgICAgICAgICAgICAgICAkdGhpcy0+U2hvd0Vycm9yKDY3LCBfX0ZJTEVfXywgX19MSU5FX18pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ215c3FsJzoNCiAgICAgICAgICAgIGNhc2UgJ215c3FsaSc6DQogICAgICAgICAgICBjYXNlICdwZG9fbXlzcWwnOg0KICAgICAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19NWVNRTF9TRVJWRVInXSA9IEdldE9wdGlvblZhcnNGcm9tRW52KCR0aGlzLT5vcHRpb25bJ1pDX01ZU1FMX1NFUlZFUiddKTsNCiAgICAgICAgICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19NWVNRTF9VU0VSTkFNRSddID0gR2V0T3B0aW9uVmFyc0Zyb21FbnYoJHRoaXMtPm9wdGlvblsnWkNfTVlTUUxfVVNFUk5BTUUnXSk7DQogICAgICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfTVlTUUxfUEFTU1dPUkQnXSA9IEdldE9wdGlvblZhcnNGcm9tRW52KCR0aGlzLT5vcHRpb25bJ1pDX01ZU1FMX1BBU1NXT1JEJ10pOw0KICAgICAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX01ZU1FMX05BTUUnXSA9IEdldE9wdGlvblZhcnNGcm9tRW52KCR0aGlzLT5vcHRpb25bJ1pDX01ZU1FMX05BTUUnXSk7DQogICAgICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfTVlTUUxfUE9SVCddID0gR2V0T3B0aW9uVmFyc0Zyb21FbnYoJHRoaXMtPm9wdGlvblsnWkNfTVlTUUxfUE9SVCddKTsNCg0KICAgICAgICAgICAgICAgIGlmICgkdGhpcy0+b3B0aW9uWydaQ19EQVRBQkFTRV9UWVBFJ10gPT0gJ215c3FsJyAmJiAhZXh0ZW5zaW9uX2xvYWRlZCgnbXlzcWwnKSkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoZXh0ZW5zaW9uX2xvYWRlZCgnbXlzcWxpJykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX0RBVEFCQVNFX1RZUEUnXSA9ICdteXNxbGknOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2VpZiAoZXh0ZW5zaW9uX2xvYWRlZCgncGRvX215c3FsJykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX0RBVEFCQVNFX1RZUEUnXSA9ICdwZG9fbXlzcWwnOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICR0aGlzLT5kYiA9IHNlbGY6OkluaXRpYWxpemVEQigkdGhpcy0+b3B0aW9uWydaQ19EQVRBQkFTRV9UWVBFJ10pOw0KICAgICAgICAgICAgICAgIGlmICgkdGhpcy0+ZGItPk9wZW4oDQogICAgICAgICAgICAgICAgICAgIGFycmF5KA0KICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfTVlTUUxfU0VSVkVSJ10sDQogICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19NWVNRTF9VU0VSTkFNRSddLA0KICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfTVlTUUxfUEFTU1dPUkQnXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX01ZU1FMX05BTUUnXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX01ZU1FMX1BSRSddLA0KICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfTVlTUUxfUE9SVCddLA0KICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfTVlTUUxfUEVSU0lTVEVOVCddLA0KICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfTVlTUUxfRU5HSU5FJ10sDQogICAgICAgICAgICAgICAgICAgICkNCiAgICAgICAgICAgICAgICApID09IGZhbHNlDQogICAgICAgICAgICAgICAgKSB7DQogICAgICAgICAgICAgICAgICAgICR0aGlzLT5TaG93RXJyb3IoNjcsIF9fRklMRV9fLCBfX0xJTkVfXyk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICB9DQogICAgICAgIC8vIHV0ZjhtYjTmlK/mjIENCiAgICAgICAgaWYgKCR0aGlzLT5kYi0+dHlwZSA9PSAnbXlzcWwnICYmIHZlcnNpb25fY29tcGFyZSgkdGhpcy0+ZGItPnZlcnNpb24sICc1LjUuMycpIDwgMCkgew0KICAgICAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fRGJTcWxfRmlsdGVyJywgJ3V0Zjg0bWJfZmlsdGVyJyk7DQogICAgICAgICAgICBBZGRfRmlsdGVyX1BsdWdpbignRmlsdGVyX1BsdWdpbl9FZGl0X0JlZ2luJywgJ3V0Zjg0bWJfZml4SHRtbFNwZWNpYWxDaGFycycpOw0KICAgICAgICB9DQogICAgICAgICR0aGlzLT5pc2Nvbm5lY3RlZCA9IHRydWU7DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5a+56KGo5ZCN5ZKM5pWw5o2u57uT5p6E6L+b6KGM6aKE6L2s5o2iLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBDb252ZXJ0VGFibGVBbmREYXRhaW5mbygpDQogICAgew0KICAgICAgICBpZiAoJHRoaXMtPmRiLT5kYnByZSkgew0KICAgICAgICAgICAgJHRoaXMtPnRhYmxlID0gc3RyX3JlcGxhY2UoJyVwcmUlJywgJHRoaXMtPmRiLT5kYnByZSwgJHRoaXMtPnRhYmxlKTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoJHRoaXMtPmRiLT50eXBlID09PSAncG9zdGdyZXNxbCcpIHsNCiAgICAgICAgICAgIGZvcmVhY2ggKCR0aGlzLT5kYXRhaW5mbyBhcyAka2V5ID0+ICYkdmFsdWUpIHsNCiAgICAgICAgICAgICAgICBmb3JlYWNoICgkdmFsdWUgYXMgJGsyID0+ICYkdjIpIHsNCiAgICAgICAgICAgICAgICAgICAgJHYyWzBdID0gc3RydG9sb3dlcigkdjJbMF0pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWFs+mXreaVsOaNruW6k+i/nuaOpS4NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQ2xvc2VDb25uZWN0KCkNCiAgICB7DQogICAgICAgIGlmICgkdGhpcy0+aXNjb25uZWN0ZWQpIHsNCiAgICAgICAgICAgICR0aGlzLT5kYi0+Q2xvc2UoKTsNCiAgICAgICAgICAgICR0aGlzLT5pc2Nvbm5lY3RlZCA9IGZhbHNlOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5ZCv55Soc2Vzc2lvbi4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBTdGFydFNlc3Npb24oKQ0KICAgIHsNCiAgICAgICAgaWYgKHNlc3Npb25fc3RhdHVzKCkgPT0gMSkgew0KICAgICAgICAgICAgc2Vzc2lvbl9zdGFydCgpOw0KICAgICAgICAgICAgJHRoaXMtPmlzc2Vzc2lvbiA9IHRydWU7DQoNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOe7iOatonNlc3Npb24uDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gRW5kU2Vzc2lvbigpDQogICAgew0KICAgICAgICBpZiAoc2Vzc2lvbl9zdGF0dXMoKSA9PSAyKSB7DQogICAgICAgICAgICBzZXNzaW9uX3dyaXRlX2Nsb3NlKCk7DQogICAgICAgICAgICAkdGhpcy0+aXNzZXNzaW9uID0gZmFsc2U7DQoNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIExvYWQgb3IgUmVMb2Fk5o+S5Lu2Q29uZmlnc+ihqC4NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gTG9hZENvbmZpZ3MoKQ0KICAgIHsNCiAgICAgICAgJHRoaXMtPkxvYWRDb25maWdzT25seVN5c3RlbSh0cnVlKTsNCiAgICAgICAgJHRoaXMtPkxvYWRDb25maWdzT25seVN5c3RlbShmYWxzZSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6L295YWl5o+S5Lu2Q29uZmlnc+ihqCBPbmx5IFN5c3RlbSBPcHRpb24uDQogICAgICovDQogICAgcHJpdmF0ZSAkcHJ2Q29uZmlnTGlzdCA9IG51bGw7DQoNCiAgICBwdWJsaWMgZnVuY3Rpb24gTG9hZENvbmZpZ3NPbmx5U3lzdGVtKCRvbmx5c3lzdGVtb3B0aW9uID0gdHJ1ZSkNCiAgICB7DQogICAgICAgIGlmICgkb25seXN5c3RlbW9wdGlvbiA9PSB0cnVlKSB7DQogICAgICAgICAgICAkdGhpcy0+Y29uZmlncyA9IGFycmF5KCk7DQogICAgICAgICAgICAkdGhpcy0+cHJ2Q29uZmlnTGlzdCA9IGFycmF5KCk7DQoNCiAgICAgICAgICAgICRzcWwgPSAkdGhpcy0+ZGItPnNxbC0+Z2V0KCktPnNlbGVjdCgkdGhpcy0+dGFibGVbJ0NvbmZpZyddKTsNCiAgICAgICAgICAgIC8qIEB2YXIgQ29uZmlnW10gJGFycmF5ICovDQogICAgICAgICAgICAkdGhpcy0+cHJ2Q29uZmlnTGlzdCA9ICR0aGlzLT5HZXRMaXN0T3JpZ2luKCRzcWwpOw0KICAgICAgICB9DQogICAgICAgIGlmIChpc19hcnJheSgkdGhpcy0+cHJ2Q29uZmlnTGlzdCkpIHsNCiAgICAgICAgICAgIGlmIChjb3VudCgkdGhpcy0+cHJ2Q29uZmlnTGlzdCkgPT0gMSAmJiAkdGhpcy0+cHJ2Q29uZmlnTGlzdFswXSA9PT0gZmFsc2UpIHsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAkdHlwZSA9ICdDb25maWcnOw0KDQogICAgICAgIGZvcmVhY2ggKCR0aGlzLT5wcnZDb25maWdMaXN0IGFzICRjKSB7DQogICAgICAgICAgICAkbmFtZSA9ICRjWyR0aGlzLT5kWydDb25maWcnXVsnTmFtZSddWzBdXTsNCiAgICAgICAgICAgIGlmICgoJG5hbWUgPT0gJ3N5c3RlbScgJiYgJG9ubHlzeXN0ZW1vcHRpb24gPT0gdHJ1ZSkgfHwgKCRuYW1lICE9ICdzeXN0ZW0nICYmICRvbmx5c3lzdGVtb3B0aW9uID09IGZhbHNlKSkgew0KICAgICAgICAgICAgICAgIGlmICghaXNzZXQoJHRoaXMtPmNvbmZpZ3NbJG5hbWVdKSkgew0KICAgICAgICAgICAgICAgICAgICAkbCA9IG5ldyAkdHlwZSgkbmFtZSk7DQogICAgICAgICAgICAgICAgICAgICR0aGlzLT5jb25maWdzWyRuYW1lXSA9ICRsOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICRsID0gJHRoaXMtPmNvbmZpZ3NbJG5hbWVdOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoZ2V0X2NsYXNzKCRsKSAhPSAkdHlwZSkgew0KICAgICAgICAgICAgICAgICAgICAkbCA9IG5ldyAkdHlwZSgkbmFtZSk7DQogICAgICAgICAgICAgICAgICAgICR0aGlzLT5jb25maWdzWyRuYW1lXSA9ICRsOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoaXNzZXQoJGNbJHRoaXMtPmRbJ0NvbmZpZyddWydLZXknXVswXV0pICYmICRjWyR0aGlzLT5kWydDb25maWcnXVsnS2V5J11bMF1dICE9ICcnKSB7DQogICAgICAgICAgICAgICAgICAgICRsLT5Mb2FkSW5mb0J5QXNzb2NTaW5nbGVXaXRoUHJlKCRjKTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAkbC0+TG9hZEluZm9CeUFzc29jKCRjKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgLy/lsIbor7vlh7rmnaXnmoTmlbDnu4Tlho3mi7zmiJDluo/liJfljJbmlbDmja7lho3lj43luo/liJfljJYNCiAgICAgICAgZm9yZWFjaCAoJHRoaXMtPmNvbmZpZ3MgYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgICAgIGlmIChpc19vYmplY3QoJHZhbHVlKSAmJiAoJGtleSA9PSAnc3lzdGVtJyAmJiAkb25seXN5c3RlbW9wdGlvbiA9PSB0cnVlKSB8fCAoJGtleSAhPSAnc3lzdGVtJyAmJiAkb25seXN5c3RlbW9wdGlvbiA9PSBmYWxzZSkpIHsNCiAgICAgICAgICAgICAgICAkdmFsdWUtPkxvYWRJbmZvQnlBc3NvY1NpbmdsZVdpdGhBZnRlcigpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCRvbmx5c3lzdGVtb3B0aW9uID09IGZhbHNlKSB7DQogICAgICAgICAgICAkdGhpcy0+cHJ2Q29uZmlnTGlzdCA9IGFycmF5KCk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDkv53lrZhDb25maWdz6KGoLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbmFtZSBDb25maWdz6KGo5ZCNDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gU2F2ZUNvbmZpZygkbmFtZSkNCiAgICB7DQogICAgICAgIGlmICghaXNzZXQoJHRoaXMtPmNvbmZpZ3NbJG5hbWVdKSkgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgJHRoaXMtPmNvbmZpZ3NbJG5hbWVdLT5TYXZlKCk7DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5Yig6ZmkQ29uZmlnc+ihqC4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUgQ29uZmlnc+ihqOWQjQ0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIERlbENvbmZpZygkbmFtZSkNCiAgICB7DQogICAgICAgIGlmICghaXNzZXQoJHRoaXMtPmNvbmZpZ3NbJG5hbWVdKSkgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgJHRoaXMtPmNvbmZpZ3NbJG5hbWVdLT5EZWxldGUoKTsNCiAgICAgICAgdW5zZXQoJHRoaXMtPmNvbmZpZ3NbJG5hbWVdKTsNCg0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDojrflj5ZDb25maWdz6KGo5YC8DQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRuYW1lIENvbmZpZ3PooajlkI0NCiAgICAgKg0KICAgICAqIEByZXR1cm4gbWl4ZWQNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQ29uZmlnKCRuYW1lKQ0KICAgIHsNCiAgICAgICAgaWYgKCFpc3NldCgkdGhpcy0+Y29uZmlnc1skbmFtZV0pKSB7DQogICAgICAgICAgICAkbmFtZSA9IEZpbHRlckNvcnJlY3ROYW1lKCRuYW1lKTsNCiAgICAgICAgICAgIGlmICghJG5hbWUpIHsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICR0aGlzLT5jb25maWdzWyRuYW1lXSA9IG5ldyBDb25maWcoJG5hbWUpOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICR0aGlzLT5jb25maWdzWyRuYW1lXTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmn6Xmn5BDb25maWfmmK/lkKblrZjlnKguDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRuYW1lIENvbmZpZ3PooajlkI0NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBIYXNDb25maWcoJG5hbWUpDQogICAgew0KICAgICAgICByZXR1cm4gaXNzZXQoJHRoaXMtPmNvbmZpZ3NbJG5hbWVdKSAmJiAkdGhpcy0+Y29uZmlnc1skbmFtZV0tPkNvdW50SXRlbSgpID4gMDsNCiAgICB9DQoNCiAgICAvLyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KICAgIC8vQ2FjaGXnm7jlhbMNCiAgICBwcml2YXRlICRjYWNoZV9oYXNoID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIOS/neWtmOe8k+WtmC4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBTYXZlQ2FjaGUoKQ0KICAgIHsNCiAgICAgICAgLy8kcz0kdGhpcy0+Y2FjaGVkaXIgLiAnJyAuICR0aGlzLT5ndWlkIC4gJy5jYWNoZSc7DQogICAgICAgIC8vJGM9c2VyaWFsaXplKCR0aGlzLT5jYWNoZSk7DQogICAgICAgIC8vQGZpbGVfcHV0X2NvbnRlbnRzKCRzLCAkYyk7DQogICAgICAgIC8vJHRoaXMtPmNvbmZpZ3NbJ2NhY2hlJ109JHRoaXMtPmNhY2hlOw0KICAgICAgICAkbmV3X2hhc2ggPSBtZDUoJHRoaXMtPkNvbmZpZygnY2FjaGUnKSk7DQogICAgICAgIGlmICgkdGhpcy0+Y2FjaGVfaGFzaCA9PSAkbmV3X2hhc2gpIHsNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9DQoNCiAgICAgICAgJHRoaXMtPlNhdmVDb25maWcoJ2NhY2hlJyk7DQogICAgICAgICR0aGlzLT5jYWNoZV9oYXNoID0gJG5ld19oYXNoOw0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWKoOi9vee8k+WtmC4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBMb2FkQ2FjaGUoKQ0KICAgIHsNCiAgICAgICAgJHRoaXMtPmNhY2hlID0gJHRoaXMtPkNvbmZpZygnY2FjaGUnKTsNCiAgICAgICAgJHRoaXMtPmNhY2hlX2hhc2ggPSBtZDUoJHRoaXMtPkNvbmZpZygnY2FjaGUnKSk7DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5L+d5a2Y6YWN572uLg0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFNhdmVPcHRpb24oKQ0KICAgIHsNCiAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfQkxPR19DTFNJRCddID0gJHRoaXMtPmd1aWQ7DQoNCiAgICAgICAgdW5zZXQoJHRoaXMtPm9wdGlvblsnWkNfUEVSTUFORU5UX0RPTUFJTl9GT1JDRURfRElTQUJMRSddKTsNCiAgICAgICAgdW5zZXQoJHRoaXMtPm9wdGlvblsnWkNfUEVSTUFORU5UX0RPTUFJTl9GT1JDRURfVVJMJ10pOw0KICAgICAgICB1bnNldCgkdGhpcy0+b3B0aW9uWydaQ19DTE9TRV9XSE9MRV9TSVRFJ10pOw0KICAgICAgICB1bnNldCgkdGhpcy0+b3B0aW9uWydaQ19JTlNUQUxMX0FGVEVSX0NPTkZJRyddKTsNCg0KICAgICAgICAkcmVzZXJ2ZV9rZXlzID0gZXhwbG9kZSgnfCcsIHNlbGY6Ok9QVElPTl9SRVNFUlZFX0tFWVMpOw0KDQogICAgICAgIGlmIChmaWxlX2V4aXN0cygkdGhpcy0+dXNlcnNkaXIgLiAnY19vcHRpb24ucGhwJykgPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICRzID0gIjwiOw0KICAgICAgICAgICAgJHMgLj0gIj9waHBcclxuIjsNCiAgICAgICAgICAgICRzIC49ICJyZXR1cm4gIjsNCiAgICAgICAgICAgICRvcHRpb24gPSBhcnJheSgpOw0KICAgICAgICAgICAgZm9yZWFjaCAoJHRoaXMtPm9wdGlvbiBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAgICAgICAgIGlmIChpbl9hcnJheSgka2V5LCAkcmVzZXJ2ZV9rZXlzKSkgew0KICAgICAgICAgICAgICAgICAgICAkb3B0aW9uWyRrZXldID0gJHZhbHVlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgICRzIC49IHZhcl9leHBvcnQoJG9wdGlvbiwgdHJ1ZSk7DQogICAgICAgICAgICAkcyAuPSAiOyI7DQogICAgICAgICAgICBAZmlsZV9wdXRfY29udGVudHMoJHRoaXMtPnVzZXJzZGlyIC4gJ2Nfb3B0aW9uLnBocCcsICRzKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGZvcmVhY2ggKCR0aGlzLT5vcHRpb24gYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgICAgICR0aGlzLT5Db25maWcoJ3N5c3RlbScpLT4ka2V5ID0gJHZhbHVlOw0KICAgICAgICB9DQogICAgICAgIGZvcmVhY2ggKCRyZXNlcnZlX2tleXMgYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgICAgICR0aGlzLT5Db25maWcoJ3N5c3RlbScpLT5EZWxLZXkoJHZhbHVlKTsNCiAgICAgICAgfQ0KDQogICAgICAgICR0aGlzLT5Db25maWcoJ3N5c3RlbScpLT5aQ19CTE9HX0hPU1QgPSBjaHVua19zcGxpdCgkdGhpcy0+Q29uZmlnKCdzeXN0ZW0nKS0+WkNfQkxPR19IT1NULCAxLCAifCIpOw0KDQogICAgICAgICR0aGlzLT5TYXZlQ29uZmlnKCdzeXN0ZW0nKTsNCg0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDovb3lhaXphY3nva4uDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gTG9hZE9wdGlvbigpDQogICAgew0KICAgICAgICAkYXJyYXkgPSAkdGhpcy0+Q29uZmlnKCdzeXN0ZW0nKS0+R2V0RGF0YSgpOw0KDQogICAgICAgIGlmIChlbXB0eSgkYXJyYXkpKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoIWlzX2FycmF5KCRhcnJheSkpIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgICRyZXNlcnZlX2tleXMgPSBleHBsb2RlKCd8Jywgc2VsZjo6T1BUSU9OX1JFU0VSVkVfS0VZUyk7DQoNCiAgICAgICAgZm9yZWFjaCAoJGFycmF5IGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICAgICBpZiAoJGtleSA9PSAnWkNfQkxPR19IT1NUJykgew0KICAgICAgICAgICAgICAgICR2YWx1ZSA9IHN0cl9yZXBsYWNlKCd8JywgJycsICR2YWx1ZSk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmIChpbl9hcnJheSgka2V5LCAkcmVzZXJ2ZV9rZXlzKSkgew0KICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAkdGhpcy0+b3B0aW9uWyRrZXldID0gJHZhbHVlOw0KICAgICAgICB9DQogICAgICAgIGlmICghZXh0ZW5zaW9uX2xvYWRlZCgnZ2QnKSkgew0KICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfQ09NTUVOVF9WRVJJRllfRU5BQkxFJ10gPSBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOeUqOaIt+eZu+W9lemqjOivgeOAgeadg+mZkOajgOafpeWHveaVsCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLg0KICAgICAqLw0KDQogICAgLyoqDQogICAgICog6aqM6K+B5piv5ZCm55m75b2V5oiQ5YqfLg0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIENoZWNrSXNMb2dnZWRpbigpDQogICAgew0KICAgICAgICBpZiAoaXNfc3ViY2xhc3Nfb2YoJHRoaXMtPnVzZXIsICdCYXNlTWVtYmVyJykgJiYgJHRoaXMtPnVzZXItPkxldmVsID4gMCAmJiAhZW1wdHkoJHRoaXMtPnVzZXItPklEKSkgew0KICAgICAgICAgICAgJHRoaXMtPmlzbG9naW4gPSB0cnVlOw0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0NCiAgICAgICAgJHRoaXMtPmlzbG9naW4gPSBmYWxzZTsNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmqjOivgeaTjeS9nOadg+mZkC4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgICAgICRhY3Rpb24g5pON5L2cDQogICAgICogQHBhcmFtIGludHxzdHJpbmcgJGxldmVsDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQ2hlY2tSaWdodHMoJGFjdGlvbiwgJGxldmVsID0gbnVsbCkNCiAgICB7DQogICAgICAgIGlmICgkbGV2ZWwgPT09IG51bGwpIHsNCiAgICAgICAgICAgICRsZXZlbCA9ICR0aGlzLT51c2VyLT5MZXZlbDsNCiAgICAgICAgfQ0KDQogICAgICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1picF9DaGVja1JpZ2h0cyddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAgICAgJGZwcmV0dXJuID0gJGZwbmFtZSgkYWN0aW9uLCAkbGV2ZWwpOw0KICAgICAgICAgICAgaWYgKCRmcHNpZ25hbCA9PSBQTFVHSU5fRVhJVFNJR05BTF9SRVRVUk4pIHsNCiAgICAgICAgICAgICAgICAkZnBzaWduYWwgPSBQTFVHSU5fRVhJVFNJR05BTF9OT05FOw0KDQogICAgICAgICAgICAgICAgcmV0dXJuICRmcHJldHVybjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBpZiAoIWlzc2V0KCR0aGlzLT5hY3Rpb25zWyRhY3Rpb25dKSkgew0KICAgICAgICAgICAgaWYgKGlzX251bWVyaWMoJGFjdGlvbikpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gJGxldmVsIDw9ICRhY3Rpb247DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAkbGV2ZWwgPD0gJHRoaXMtPmFjdGlvbnNbJGFjdGlvbl07DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5qC55o2u55So5oi3562J57qn6aqM6K+B5pON5L2c5p2D6ZmQIDEuNeW8gOWni+WPguaVsOaNoumhuuW6jy4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJGFjdGlvbiDmk43kvZwNCiAgICAgKiBAcGFyYW0gaW50ICAgICRsZXZlbCAg55So5oi3562J57qnDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQ2hlY2tSaWdodHNCeUxldmVsKCRhY3Rpb24sICRsZXZlbCkNCiAgICB7DQogICAgICAgIHJldHVybiAkdGhpcy0+Q2hlY2tSaWdodHMoJGFjdGlvbiwgJGxldmVsKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpqozor4HnlKjmiLfnmbvlvZUuDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gVmVyaWZ5KCkNCiAgICB7DQogICAgICAgIC8vIOWcqOaZrumAmiBXZWIg6aG16Z2i5LitDQogICAgICAgICR1c2VybmFtZSA9IHRyaW0oR2V0VmFycygndXNlcm5hbWVfJyAuIGhhc2goImNyYzMyYiIsICR0aGlzLT5ndWlkKSwgJ0NPT0tJRScpKTsNCiAgICAgICAgJHRva2VuID0gdHJpbShHZXRWYXJzKCd0b2tlbl8nIC4gaGFzaCgiY3JjMzJiIiwgJHRoaXMtPmd1aWQpLCAnQ09PS0lFJykpOw0KICAgICAgICAkdXNlciA9ICR0aGlzLT5WZXJpZnlVc2VyVG9rZW4oJHRva2VuLCAkdXNlcm5hbWUpOw0KDQogICAgICAgIGlmIChpc19vYmplY3QoJHVzZXIpKSB7DQogICAgICAgICAgICAkdGhpcy0+dXNlciA9ICR1c2VyOw0KICAgICAgICAgICAgJHRoaXMtPmlzbG9naW4gPSB0cnVlOw0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0NCiAgICAgICAgJHRoaXMtPnVzZXIgPSBuZXcgTWVtYmVyKCk7DQogICAgICAgICR0aGlzLT51c2VyLT5HdWlkID0gR2V0R3VpZCgpOw0KICAgICAgICAkdGhpcy0+aXNsb2dpbiA9IGZhbHNlOw0KDQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDov5Tlm57nmbvlvZXmiJDlip/lkI7lupTkv53lrZjnmoRjb29raWXkv6Hmga8uDQogICAgICoNCiAgICAgKiBAcGFyYW0gTWVtYmVyICRtIOW3sumqjOi/h+aIkOWKn+eahG1lbWJlcg0KICAgICAqDQogICAgICogQHJldHVybiBzdHJpbmcNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gVmVyaWZ5UmVzdWx0KCRtKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuICR0aGlzLT5HZW5lcmF0ZVVzZXJUb2tlbigkbSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog55Sf5oiQVXNlciBUb2tlbu+8jOeUqOS6jueZu+W9lemqjOivgQ0KICAgICAqDQogICAgICogQHBhcmFtIE1lbWJlciAkdXNlcg0KICAgICAqIEBwYXJhbSBpbnQgICAgJHRpbWUNCiAgICAgKg0KICAgICAqIEByZXR1cm4gc3RyaW5nDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdlbmVyYXRlVXNlclRva2VuKCR1c2VyLCAkdGltZSA9IDApDQogICAgew0KICAgICAgICBpZiAoJHRpbWUgPT09IDApIHsNCiAgICAgICAgICAgICR0aW1lID0gKHRpbWUoKSArIDM2MDAgKiAyNCk7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gQ3JlYXRlV2ViVG9rZW4oJHVzZXItPklELCAkdGltZSwgJHVzZXItPkd1aWQsICR1c2VyLT5QYXNzV29yZF9NRDVQYXRoKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDnlJ/miJBBcGkgVG9rZW7vvIznlKjkuo4gQVBJIOaooeW8j+S4i+eahOeUqOaIt+mqjOivgS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBNZW1iZXIgJHVzZXINCiAgICAgKiBAcGFyYW0gaW50ICAgICR0aW1lDQogICAgICoNCiAgICAgKiBAcmV0dXJuIHN0cmluZw0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZW5lcmF0ZUFwaVRva2VuKCR1c2VyLCAkdGltZSA9IDApDQogICAgew0KICAgICAgICByZXR1cm4gYmFzZTY0X2VuY29kZSgkdXNlci0+TmFtZSAuICd8fHwnIC4gJHRoaXMtPkdlbmVyYXRlVXNlclRva2VuKCR1c2VyLCAoaW50KSAkdGltZSkpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmqjOivgeeUqOaIt+eZu+W9lVRva2VuLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkdG9rZW4NCiAgICAgKiBAcGFyYW0gc3RyaW5nICR1c2VybmFtZQ0KICAgICAqDQogICAgICogQHJldHVybiBNZW1iZXJ8bnVsbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBWZXJpZnlVc2VyVG9rZW4oJHRva2VuLCAkdXNlcm5hbWUpDQogICAgew0KICAgICAgICAkdXNlciA9ICR0aGlzLT5HZXRNZW1iZXJCeU5hbWUoJHVzZXJuYW1lKTsNCiAgICAgICAgaWYgKCR1c2VyLT5JRCAhPSBudWxsKSB7DQogICAgICAgICAgICBpZiAoVmVyaWZ5V2ViVG9rZW4oJHRva2VuLCAkdXNlci0+SUQsICR1c2VyLT5HdWlkLCAkdXNlci0+UGFzc1dvcmRfTUQ1UGF0aCkpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gJHVzZXI7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gbnVsbDsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpqozor4HnlKjmiLfnmbvlvZXvvIjkuIDmrKFNRDXlr4bnoIHvvIkuDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRuYW1lICAg55So5oi35ZCNDQogICAgICogQHBhcmFtIHN0cmluZyAkbWQ1cHcgIG1kNeWKoOWvhuWQjueahOWvhueggQ0KICAgICAqIEBwYXJhbSBNZW1iZXIgJG1lbWJlciDov5Tlm57or7vlj5bmiJDlip/nmoRtZW1iZXLlr7nosaENCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBWZXJpZnlfTUQ1KCRuYW1lLCAkbWQ1cHcsICYkbWVtYmVyKQ0KICAgIHsNCiAgICAgICAgaWYgKCRuYW1lID09ICcnIHx8ICRtZDVwdyA9PSAnJykgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQogICAgICAgICRtZW1iZXIgPSAkdGhpcy0+R2V0TWVtYmVyQnlOYW1lKCRuYW1lKTsNCiAgICAgICAgaWYgKCRtZW1iZXItPklEICE9IG51bGwpIHsNCiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+VmVyaWZ5X0ZpbmFsKCRuYW1lLCBtZDUoJG1kNXB3IC4gJG1lbWJlci0+R3VpZCksICRtZW1iZXIpOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmqjOivgeeUqOaIt+eZu+W9le+8iOWOn+Wni+aYjuaWh+Wvhuegge+8iS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUgICAgICAg55So5oi35ZCNDQogICAgICogQHBhcmFtIHN0cmluZyAkb3JpZ2luYWxwdyDlr4bnoIHmmI7mlocNCiAgICAgKiBAcGFyYW0gTWVtYmVyICRtZW1iZXIgICAgIOi/lOWbnuivu+WPluaIkOWKn+eahG1lbWJlcuWvueixoQ0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFZlcmlmeV9PcmlnaW5hbCgkbmFtZSwgJG9yaWdpbmFscHcsICYkbWVtYmVyID0gbnVsbCkNCiAgICB7DQogICAgICAgIGlmICgkbmFtZSA9PSAnJyB8fCAkb3JpZ2luYWxwdyA9PSAnJykgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQogICAgICAgICRtID0gJHRoaXMtPkdldE1lbWJlckJ5TmFtZSgkbmFtZSk7DQogICAgICAgIGlmICgkbS0+SUQgIT0gbnVsbCkgew0KICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5WZXJpZnlfTUQ1KCRuYW1lLCBtZDUoJG9yaWdpbmFscHcpLCAkbWVtYmVyKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpqozor4HnlKjmiLfnmbvlvZXvvIjmlbDmja7lupPkv53lrZjnmoTmnIDnu4jov5DnrpflkI7lr4bnoIHvvIkuDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRuYW1lICAgICDnlKjmiLflkI0NCiAgICAgKiBAcGFyYW0gc3RyaW5nICRwYXNzd29yZCDkuozmrKHliqDlr4blkI7nmoTlr4bnoIENCiAgICAgKiBAcGFyYW0gb2JqZWN0ICRtZW1iZXIgICDov5Tlm57or7vlj5bmiJDlip/nmoRtZW1iZXLlr7nosaENCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBWZXJpZnlfRmluYWwoJG5hbWUsICRwYXNzd29yZCwgJiRtZW1iZXIgPSBudWxsKQ0KICAgIHsNCiAgICAgICAgaWYgKCRuYW1lID09ICcnIHx8ICRwYXNzd29yZCA9PSAnJykgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQogICAgICAgICRtID0gJHRoaXMtPkdldE1lbWJlckJ5TmFtZSgkbmFtZSk7DQogICAgICAgIGlmICgkbS0+SUQgIT0gbnVsbCkgew0KICAgICAgICAgICAgaWYgKGhhc2hfZXF1YWxzKCRtLT5QYXNzd29yZCwgJHBhc3N3b3JkKSA9PT0gdHJ1ZSkgew0KICAgICAgICAgICAgICAgICRtZW1iZXIgPSAkbTsNCg0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmqjOivgeeUqOaIt+eZu+W9le+8iOS9v+eUqFRva2Vu77yM5pu/5Luj5a+G56CB5L+d5a2Y77yJLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbmFtZSAgIOeUqOaIt+WQjQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHd0ICAgICBXZWJUb2tlbg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHd0X2lkICBXZWJUb2tlbueahElE6K+G5Yir56ymDQogICAgICogQHBhcmFtIG9iamVjdCAkbWVtYmVyIOi/lOWbnuivu+WPluaIkOWKn+eahG1lbWJlcuWvueixoQ0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFZlcmlmeV9Ub2tlbigkbmFtZSwgJHd0LCAkd3RfaWQsICYkbWVtYmVyID0gbnVsbCkNCiAgICB7DQogICAgICAgIGlmICgkbmFtZSA9PSAnJyB8fCAkd3QgPT0gJycpIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KICAgICAgICAkbSA9IG51bGw7DQogICAgICAgICRtID0gJHRoaXMtPkdldE1lbWJlckJ5TmFtZSgkbmFtZSk7DQogICAgICAgIGlmICgkbS0+SUQgIT0gbnVsbCkgew0KICAgICAgICAgICAgaWYgKFZlcmlmeVdlYlRva2VuKCR3dCwgJHd0X2lkLCAkdGhpcy0+Z3VpZCwgJG0tPklELCAkbS0+UGFzc3dvcmQpID09PSB0cnVlKSB7DQogICAgICAgICAgICAgICAgJG1lbWJlciA9ICRtOw0KDQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6aqM6K+BIEFQSSBUb2tlbi4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJGFwaV90b2tlbg0KICAgICAqIEByZXR1cm4gTWVtYmVyfG51bGwNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gVmVyaWZ5QVBJVG9rZW4oJGFwaV90b2tlbikNCiAgICB7DQogICAgICAgICRhcGlfdG9rZW4gPSBiYXNlNjRfZGVjb2RlKCRhcGlfdG9rZW4pOw0KDQogICAgICAgIGlmIChlbXB0eSgkYXBpX3Rva2VuKSkgew0KICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgIH0NCg0KICAgICAgICAvLyDpqozor4HlrZfnrKbkuLLmoLzlvI/kuLoge3VzZXJuYW1lfXx8fHt0b2tlbn0NCiAgICAgICAgJGFwaV90b2tlbl9hcnJheSA9IGV4cGxvZGUoJ3x8fCcsICRhcGlfdG9rZW4pOw0KICAgICAgICBpZiAoY291bnQoJGFwaV90b2tlbl9hcnJheSkgIT09IDIpIHsNCiAgICAgICAgICAgIHJldHVybiBudWxsOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICR0aGlzLT5WZXJpZnlVc2VyVG9rZW4oJGFwaV90b2tlbl9hcnJheVsxXSwgJGFwaV90b2tlbl9hcnJheVswXSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog57O757uf5Yqg6L2955So5oi344CB5YiG57G7562J55qE5Ye95pWwKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiouDQogICAgICovDQoNCiAgICAvKioNCiAgICAgKiDovb3lhaXnlKjmiLfliJfooaguDQogICAgICoNCiAgICAgKiBAcGFyYW0gaW50ICRsZXZlbCDnlKjmiLfnrYnnuqcNCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBMb2FkTWVtYmVycygkbGV2ZWwgPSAwKQ0KICAgIHsNCiAgICAgICAgJGxvYWRtZW1iZXJzX2xldmVsID0gJGxldmVsOw0KICAgICAgICBpZiAoJGxvYWRtZW1iZXJzX2xldmVsIDwgMCkgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgJHdoZXJlID0gbnVsbDsNCiAgICAgICAgaWYgKCRsb2FkbWVtYmVyc19sZXZlbCA+IDApIHsNCiAgICAgICAgICAgICR3aGVyZSA9IGFycmF5KGFycmF5KCc8PScsICdtZW1fTGV2ZWwnLCAkbG9hZG1lbWJlcnNfbGV2ZWwpKTsNCiAgICAgICAgfQ0KICAgICAgICAkdGhpcy0+bWVtYmVycyA9IGFycmF5KCk7DQogICAgICAgICR0aGlzLT5tZW1iZXJzYnluYW1lID0gYXJyYXkoKTsNCiAgICAgICAgJGFycmF5ID0gJHRoaXMtPkdldE1lbWJlckxpc3QobnVsbCwgJHdoZXJlKTsNCg0KICAgICAgICAkdGhpcy0+aXNsb2FkbWVtYmVycyA9IHRydWU7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h+WIl+ihqO+8iOaWh+eroC/or4Torrov4oCm4oCm77yJ5LiA5qyh5oCn5bCG55So5oi36aKE6L295YWl5YiwIG1lbWJlcnMg6YeMLg0KICAgICAqDQogICAgICogQHBhcmFtIGFycmF5ICAkbGlzdCAgICAgICAgIOaWh+eroC/or4TorrrliJfooajmlbDnu4QNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRtZW1faWRfZmllbGQg55So5oi3IElEIOWcqOWvueixoeS4reeahOWtl+auteWQjQ0KICAgICAqDQogICAgICogQHJldHVybiBib29sZWFuDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIExvYWRNZW1iZXJzSW5MaXN0KCRsaXN0LCAkbWVtX2lkX2ZpZWxkID0gJ0F1dGhvcklEJykNCiAgICB7DQogICAgICAgICRtZW1faWRzX25lZWRfbG9hZCA9IGFycmF5KCk7DQoNCiAgICAgICAgZm9yZWFjaCAoJGxpc3QgYXMgJG9iaikgew0KICAgICAgICAgICAgaWYgKCFpc3NldCgkb2JqLT4kbWVtX2lkX2ZpZWxkKSB8fCAoJG9iai0+JG1lbV9pZF9maWVsZCA9PSBudWxsKSkgew0KICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyDlt7Lnu4/ovb3lhaXnmoTnlKjmiLfkuI3ph43mlrDovb3lhaUNCiAgICAgICAgICAgIGlmIChpc3NldCgkdGhpcy0+bWVtYmVyc1skb2JqLT4kbWVtX2lkX2ZpZWxkXSkpIHsNCiAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgJG1lbV9pZHNfbmVlZF9sb2FkW10gPSAkb2JqLT4kbWVtX2lkX2ZpZWxkOw0KICAgICAgICB9DQoNCiAgICAgICAgJG1lbV9pZHNfbmVlZF9sb2FkID0gYXJyYXlfdW5pcXVlKCRtZW1faWRzX25lZWRfbG9hZCk7DQoNCiAgICAgICAgaWYgKGNvdW50KCRtZW1faWRzX25lZWRfbG9hZCkgPT09IDApIHsNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9DQoNCiAgICAgICAgJGFycmF5ID0gJHRoaXMtPkdldE1lbWJlckxpc3QobnVsbCwgYXJyYXkoYXJyYXkoJ0lOJywgJ21lbV9JRCcsICRtZW1faWRzX25lZWRfbG9hZCkpKTsNCg0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDnp4HmnInmlrnms5XkuYvpgJLlvZLliqDovb3liIbnsbsuDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGFycmF5DQogICAgICovDQogICAgcHJpdmF0ZSBmdW5jdGlvbiBMb2FkQ2F0ZWdvcmllc19SZWN1cnNpb24oJGRlZXAsICRpZCwgJiRsdiwgJHR5cGUpDQogICAgew0KICAgICAgICBpZiAoKCRkZWVwICsgMSkgPj0gJHRoaXMtPmNhdGVnb3J5X3JlY3Vyc2lvbl9yZWFsX2RlZXApIHsNCiAgICAgICAgICAgICR0aGlzLT5jYXRlZ29yeV9yZWN1cnNpb25fcmVhbF9kZWVwID0gKCRkZWVwICsgMSk7DQogICAgICAgIH0NCiAgICAgICAgJHN1YmFycmF5ID0gYXJyYXkoKTsNCiAgICAgICAgZm9yICgkaSA9IDA7ICRpIDwgJHRoaXMtPmNhdGVnb3J5X3JlY3Vyc2lvbl9sZXZlbDsgJGkrKykgew0KICAgICAgICAgICAgJG5hbWUgPSAnbHYnIC4gJGk7DQogICAgICAgICAgICAkeyRuYW1lfSA9ICYkbHZbJGldOw0KICAgICAgICB9DQogICAgICAgICRsdmRlZXAgPSAnbHYnIC4gJGRlZXA7DQogICAgICAgICR0aGlzLT5jYXRlZ29yaWVzYnlvcmRlcl90eXBlWyR0eXBlXVskaWRdID0gJiR0aGlzLT5jYXRlZ29yaWVzX2FsbFskaWRdOw0KICAgICAgICBpZiAoJGRlZXAgPCAoJHRoaXMtPmNhdGVnb3J5X3JlY3Vyc2lvbl9sZXZlbCAtIDEpKSB7DQogICAgICAgICAgICAkZGVlcCArPSAxOw0KICAgICAgICAgICAgJGx2ZGVlcG5leHQgPSAnbHYnIC4gJGRlZXA7DQogICAgICAgICAgICBpZiAoaXNzZXQoJHskbHZkZWVwbmV4dH1bJGlkXSkpIHsNCiAgICAgICAgICAgICAgICBmb3JlYWNoICgkeyRsdmRlZXBuZXh0fVskaWRdIGFzICRpZG5vdykgew0KICAgICAgICAgICAgICAgICAgICAkc3ViYXJyYXlbXSA9ICRpZG5vdzsNCiAgICAgICAgICAgICAgICAgICAgJGIgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgZm9yZWFjaCAoJHRoaXMtPmNhdGVnb3JpZXNieW9yZGVyX3R5cGVbJHR5cGVdWyRpZF0tPlN1YkNhdGVnb3JpZXMgYXMgJGtleTIgPT4gJHZhbHVlMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCR2YWx1ZTItPklEID09ICRpZG5vdykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICRiID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBpZiAoJGIgPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5jYXRlZ29yaWVzYnlvcmRlcl90eXBlWyR0eXBlXVskaWRdLT5TdWJDYXRlZ29yaWVzW10gPSAmJHRoaXMtPmNhdGVnb3JpZXNfYWxsWyRpZG5vd107DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgLy8kdGhpcy0+Y2F0ZWdvcmllc2J5b3JkZXJbJGlkXS0+Q2hpbGRyZW5DYXRlZ29yaWVzW10gPSAmJHRoaXMtPmNhdGVnb3JpZXNbJGlkbm93XTsNCiAgICAgICAgICAgICAgICAgICAgJGFycmF5ID0gJHRoaXMtPkxvYWRDYXRlZ29yaWVzX1JlY3Vyc2lvbigkZGVlcCwgJGlkbm93LCAkbHYsICR0eXBlKTsNCiAgICAgICAgICAgICAgICAgICAgZm9yZWFjaCAoJGFycmF5IGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAkc3ViYXJyYXlbXSA9ICR2YWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICAkc3ViYXJyYXkgPSBhcnJheV91bmlxdWUoJHN1YmFycmF5KTsNCiAgICAgICAgZm9yZWFjaCAoJHN1YmFycmF5IGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICAgICAkYiA9IGZhbHNlOw0KICAgICAgICAgICAgZm9yZWFjaCAoJHRoaXMtPmNhdGVnb3JpZXNieW9yZGVyX3R5cGVbJHR5cGVdWyRpZF0tPkNoaWxkcmVuQ2F0ZWdvcmllcyBhcyAka2V5MiA9PiAkdmFsdWUyKSB7DQogICAgICAgICAgICAgICAgaWYgKCR2YWx1ZTItPklEID09ICR2YWx1ZSkgew0KICAgICAgICAgICAgICAgICAgICAkYiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICgkYiA9PSBmYWxzZSkgew0KICAgICAgICAgICAgICAgICR0aGlzLT5jYXRlZ29yaWVzYnlvcmRlcl90eXBlWyR0eXBlXVskaWRdLT5DaGlsZHJlbkNhdGVnb3JpZXNbXSA9ICYkdGhpcy0+Y2F0ZWdvcmllc19hbGxbJHZhbHVlXTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gJHN1YmFycmF5Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOi9veWFpeWIhuexu+WIl+ihqC4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBMb2FkQ2F0ZWdvcmllcygpDQogICAgew0KICAgICAgICAkdGhpcy0+Y2F0ZWdvcmllc19hbGwgPSBhcnJheSgpOw0KDQogICAgICAgICR0aGlzLT5jYXRlZ29yaWVzYnlvcmRlciA9IGFycmF5KCk7DQogICAgICAgICR0aGlzLT5jYXRlZ29yaWVzID0gJiR0aGlzLT5jYXRlZ29yaWVzYnlvcmRlcjsNCg0KICAgICAgICAkdGhpcy0+Y2F0ZWdvcmllc2J5b3JkZXJfdHlwZSA9IGFycmF5KCk7DQogICAgICAgICR0aGlzLT5jYXRlZ29yaWVzX3R5cGUgPSBhcnJheSgpOw0KDQogICAgICAgICR0aGlzLT5jYXRlZ29yeXMgPSAmJHRoaXMtPmNhdGVnb3JpZXM7DQogICAgICAgICR0aGlzLT5jYXRlZ29yeXNieW9yZGVyID0gJiR0aGlzLT5jYXRlZ29yaWVzYnlvcmRlcjsNCg0KICAgICAgICBmb3JlYWNoICgkdGhpcy0+cG9zdHR5cGUgYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgICAgIGlmICghaXNzZXQoJHRoaXMtPmNhdGVnb3JpZXNfdHlwZVska2V5XSkpIHsNCiAgICAgICAgICAgICAgICAkdGhpcy0+Y2F0ZWdvcmllc190eXBlWyRrZXldID0gYXJyYXkoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICghaXNzZXQoJHRoaXMtPmNhdGVnb3JpZXNieW9yZGVyX3R5cGVbJGtleV0pKSB7DQogICAgICAgICAgICAgICAgJHRoaXMtPmNhdGVnb3JpZXNieW9yZGVyX3R5cGVbJGtleV0gPSBhcnJheSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgJGFycmF5ID0gJHRoaXMtPkdldENhdGVnb3J5TGlzdChudWxsLCBudWxsLCBhcnJheSgnY2F0ZV9PcmRlcicgPT4gJ0FTQycpLCBudWxsLCBudWxsKTsNCiAgICAgICAgaWYgKGNvdW50KCRhcnJheSkgPT0gMCkgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgZm9yZWFjaCAoJHRoaXMtPnBvc3R0eXBlIGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICAgICAkbHYgPSBhcnJheSgpOw0KICAgICAgICAgICAgZm9yICgkaSA9IDA7ICRpIDwgJHRoaXMtPmNhdGVnb3J5X3JlY3Vyc2lvbl9sZXZlbDsgJGkrKykgew0KICAgICAgICAgICAgICAgICRuYW1lID0gJ2x2JyAuICRpOw0KICAgICAgICAgICAgICAgICR7JG5hbWV9ID0gYXJyYXkoKTsNCiAgICAgICAgICAgICAgICAkbHZbJGldID0gJiR7JG5hbWV9Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgJGNhdGVnb3JpZXMgPSAkdGhpcy0+Y2F0ZWdvcmllc190eXBlWyRrZXldOw0KDQogICAgICAgICAgICBmb3JlYWNoICgkY2F0ZWdvcmllcyBhcyAkaWQgPT4gJGMpIHsNCiAgICAgICAgICAgICAgICAkbCA9ICdsdicgLiAkYy0+TGV2ZWw7DQogICAgICAgICAgICAgICAgJHskbH1bJGMtPlBhcmVudElEXVtdID0gJGlkOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIWlzc2V0KCRsdjBbMF0pKSB7DQogICAgICAgICAgICAgICAgJGx2MFswXSA9IGFycmF5KCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGZvcmVhY2ggKCRsdjBbMF0gYXMgJGlkMCkgew0KICAgICAgICAgICAgICAgICR0aGlzLT5Mb2FkQ2F0ZWdvcmllc19SZWN1cnNpb24oMCwgJGlkMCwgJGx2LCAka2V5KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgICR0aGlzLT5jYXRlZ29yaWVzX3R5cGUgPSAmJHRoaXMtPmNhdGVnb3JpZXNieW9yZGVyX3R5cGU7DQogICAgICAgICR0aGlzLT5jYXRlZ29yaWVzYnlvcmRlciA9ICYkdGhpcy0+Y2F0ZWdvcmllc2J5b3JkZXJfdHlwZVswXTsNCiAgICAgICAgJHRoaXMtPmNhdGVnb3JpZXMgPSAmJHRoaXMtPmNhdGVnb3JpZXNieW9yZGVyOw0KICAgICAgICAkdGhpcy0+Y2F0ZWdvcnlzID0gJiR0aGlzLT5jYXRlZ29yaWVzOw0KICAgICAgICAkdGhpcy0+Y2F0ZWdvcnlzYnlvcmRlciA9ICYkdGhpcy0+Y2F0ZWdvcmllc2J5b3JkZXI7DQoNCiAgICAgICAgJHRoaXMtPmlzbG9hZGNhdGVnb3JpZXMgPSB0cnVlOw0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDovb3lhaXmoIfnrb7liJfooaguDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gTG9hZFRhZ3MoKQ0KICAgIHsNCiAgICAgICAgJHRoaXMtPnRhZ3NfdHlwZSA9IGFycmF5KCk7DQogICAgICAgICR0aGlzLT50YWdzYnluYW1lX3R5cGUgPSBhcnJheSgpOw0KDQogICAgICAgICR0aGlzLT50YWdzID0gYXJyYXkoKTsNCiAgICAgICAgJHRoaXMtPnRhZ3NieW5hbWUgPSBhcnJheSgpOw0KDQogICAgICAgICR0aGlzLT50YWdzX2FsbCA9IGFycmF5KCk7DQoNCiAgICAgICAgJGFycmF5ID0gJHRoaXMtPkdldFRhZ0xpc3QoKTsNCg0KICAgICAgICBpc3NldCgkdGhpcy0+dGFnc190eXBlWzBdKSB8fCAkdGhpcy0+dGFnc190eXBlWzBdID0gYXJyYXkoKTsNCiAgICAgICAgaXNzZXQoJHRoaXMtPnRhZ3NieW5hbWVfdHlwZVswXSkgfHwgJHRoaXMtPnRhZ3NieW5hbWVfdHlwZVswXSA9IGFycmF5KCk7DQoNCiAgICAgICAgJHRoaXMtPnRhZ3MgPSAmJHRoaXMtPnRhZ3NfdHlwZVswXTsNCiAgICAgICAgJHRoaXMtPnRhZ3NieW5hbWUgPSAmJHRoaXMtPnRhZ3NieW5hbWVfdHlwZVswXTsNCg0KICAgICAgICAkdGhpcy0+aXNsb2FkdGFncyA9IHRydWU7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOi9veWFpeaooeWdl+WIl+ihqC4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBMb2FkTW9kdWxlcygpDQogICAgew0KICAgICAgICAkdGhpcy0+bW9kdWxlcyA9IGFycmF5KCk7DQogICAgICAgICR0aGlzLT5tb2R1bGVzYnlmaWxlbmFtZSA9IGFycmF5KCk7DQogICAgICAgICRhcnJheSA9ICR0aGlzLT5HZXRNb2R1bGVMaXN0KCk7DQoNCiAgICAgICAgJGRpciA9ICR0aGlzLT51c2Vyc2RpciAuICd0aGVtZS8nIC4gJHRoaXMtPnRoZW1lIC4gJy9pbmNsdWRlLyc7DQogICAgICAgIGlmIChmaWxlX2V4aXN0cygkZGlyKSkgew0KICAgICAgICAgICAgJGZpbGVzID0gR2V0RmlsZXNJbkRpcigkZGlyLCAncGhwJyk7DQogICAgICAgICAgICBmb3JlYWNoICgkZmlsZXMgYXMgJHNvcnRuYW1lID0+ICRmdWxsbmFtZSkgew0KICAgICAgICAgICAgICAgICRtID0gbmV3IE1vZHVsZSgpOw0KICAgICAgICAgICAgICAgICRtLT5GaWxlTmFtZSA9ICRzb3J0bmFtZTsNCiAgICAgICAgICAgICAgICAkbS0+TmFtZSA9ICRzb3J0bmFtZTsNCiAgICAgICAgICAgICAgICAkbS0+SHRtbElEID0gJHNvcnRuYW1lOw0KICAgICAgICAgICAgICAgICRtLT5Db250ZW50ID0gZmlsZV9nZXRfY29udGVudHMoJGZ1bGxuYW1lKTsNCiAgICAgICAgICAgICAgICBpZiAoc3RyaXBvcygkbS0+Q29udGVudCwgJzxsaScpICE9PSBmYWxzZSAmJiBzdHJpcG9zKCRtLT5Db250ZW50LCAnPC9saT4nKSAhPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICAgICAgICAgJG0tPlR5cGUgPSAndWwnOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICRtLT5UeXBlID0gJ2Rpdic7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICRtLT5Tb3VyY2UgPSAndGhlbWVpbmNsdWRlXycgLiAkdGhpcy0+dGhlbWU7DQogICAgICAgICAgICAgICAgJG0tPklEID0gKDAgLSAoaW50KSBjcmMzMigkbS0+U291cmNlIC4gJG0tPkZpbGVOYW1lKSk7DQogICAgICAgICAgICAgICAgJHRoaXMtPkFkZENhY2hlKCRtKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgICR0aGlzLT5pc2xvYWRtb2R1bGVzID0gdHJ1ZTsNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6L295YWl5Li76aKY5YiX6KGoLg0KICAgICAqDQogICAgICogQHJldHVybiBBcHBbXQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBMb2FkVGhlbWVzKCkNCiAgICB7DQogICAgICAgICRhbGxUaGVtZXMgPSBhcnJheSgpOw0KICAgICAgICAkZGlycyA9IEdldERpcnNJbkRpcigkdGhpcy0+dXNlcnNkaXIgLiAndGhlbWUvJyk7DQogICAgICAgIG5hdGNhc2Vzb3J0KCRkaXJzKTsNCiAgICAgICAgYXJyYXlfdW5zaGlmdCgkZGlycywgJHRoaXMtPnRoZW1lKTsNCiAgICAgICAgJGRpcnMgPSBhcnJheV91bmlxdWUoJGRpcnMpOw0KICAgICAgICBmb3JlYWNoICgkZGlycyBhcyAkaWQpIHsNCiAgICAgICAgICAgICRhcHAgPSBuZXcgQXBwKCk7DQogICAgICAgICAgICBpZiAoJGFwcC0+TG9hZEluZm9CeVhtbCgndGhlbWUnLCAkaWQpID09IHRydWUpIHsNCiAgICAgICAgICAgICAgICAkYWxsVGhlbWVzW10gPSAkYXBwOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICRhbGxUaGVtZXM7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6L295YWl5o+S5Lu25YiX6KGoLg0KICAgICAqDQogICAgICogQHJldHVybiBBcHBbXQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBMb2FkUGx1Z2lucygpDQogICAgew0KICAgICAgICAkYWxsUGx1Z2lucyA9IGFycmF5KCk7DQogICAgICAgICRkaXJzID0gR2V0RGlyc0luRGlyKCR0aGlzLT51c2Vyc2RpciAuICdwbHVnaW4vJyk7DQogICAgICAgIG5hdGNhc2Vzb3J0KCRkaXJzKTsNCg0KICAgICAgICBmb3JlYWNoICgkZGlycyBhcyAkaWQpIHsNCiAgICAgICAgICAgICRhcHAgPSBuZXcgQXBwKCk7DQogICAgICAgICAgICBpZiAoJGFwcC0+TG9hZEluZm9CeVhtbCgncGx1Z2luJywgJGlkKSA9PSB0cnVlKSB7DQogICAgICAgICAgICAgICAgJGFsbFBsdWdpbnNbXSA9ICRhcHA7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJGFsbFBsdWdpbnM7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6L295YWl5oyH5a6a5bqU55SoLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkdHlwZSDlupTnlKjnsbvlnosodGhlbWV8cGx1Z2luKQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgJGlkICAg5bqU55SoSUQNCiAgICAgKg0KICAgICAqIEByZXR1cm4gQXBwDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIExvYWRBcHAoJHR5cGUsICRpZCkNCiAgICB7DQogICAgICAgICRhcHAgPSBuZXcgQXBwKCk7DQogICAgICAgIGlmICgkYXBwLT5Mb2FkSW5mb0J5WG1sKCR0eXBlLCAkaWQpICE9IHRydWUpIHsNCiAgICAgICAgICAgICRhcHAtPmlzbG9hZGVkID0gZmFsc2U7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJGFwcDsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmo4Dmn6XlupTnlKjmmK/lkKblronoo4XlubblkK/nlKguDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRuYW1lIOW6lOeUqO+8iOaPkuS7tuaIluS4u+mimO+8ieeahElEDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQ2hlY2tQbHVnaW4oJG5hbWUpDQogICAgew0KICAgICAgICByZXR1cm4gaW5fYXJyYXkoJG5hbWUsICR0aGlzLT5hY3RpdmVkYXBwcyk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5qOA5p+l5bqU55So5piv5ZCm5a6J6KOF5bm25ZCv55SoLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbmFtZSDlupTnlKhJRO+8iOaPkuS7tuaIluS4u+mimO+8iQ0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIENoZWNrQXBwKCRuYW1lKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuICR0aGlzLT5DaGVja1BsdWdpbigkbmFtZSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6I635Y+W6aKE5r+A5rS75o+S5Lu25ZCN5pWw57uELg0KICAgICAqDQogICAgICogQHJldHVybiBzdHJpbmdbXQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRQcmVBY3RpdmVQbHVnaW4oKQ0KICAgIHsNCiAgICAgICAgJGFwID0gZXhwbG9kZSgifCIsICR0aGlzLT5vcHRpb25bJ1pDX1VTSU5HX1BMVUdJTl9MSVNUJ10pOw0KICAgICAgICAkYXAgPSBhcnJheV91bmlxdWUoJGFwKTsNCg0KICAgICAgICByZXR1cm4gJGFwOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOi9veWFpeaMh+WumuW6lOeUqOivreiogOWMhS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHR5cGUgICAg5bqU55So57G75Z6LKHN5c3RlbXx0aGVtZXxwbHVnaW4pDQogICAgICogQHBhcmFtIHN0cmluZyAkaWQgICAgICDlupTnlKhJRA0KICAgICAqIEBwYXJhbSBzdHJpbmcgJGRlZmF1bHQg6buY6K6k6K+t6KiADQogICAgICoNCiAgICAgKiBAdGhyb3dzIEV4Y2VwdGlvbg0KICAgICAqDQogICAgICogQHJldHVybiBudWxsDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIExvYWRMYW5ndWFnZSgkdHlwZSwgJGlkLCAkZGVmYXVsdCA9ICcnKQ0KICAgIHsNCiAgICAgICAgJGxhbmd1YWdlUGF0aCA9ICR0aGlzLT5wYXRoOw0KICAgICAgICAkbGFuZ3VhZ2VSZWdFeCA9ICcvXihbMC05QS1aXC1fXSopXC5waHAkL3VpJzsNCiAgICAgICAgJGxhbmd1YWdlTGlzdCA9IGFycmF5KCk7DQogICAgICAgICRsYW5ndWFnZSA9ICcnOw0KICAgICAgICAkZGVmYXVsdCA9IHN0cl9yZXBsYWNlKGFycmF5KCcvJywgJ1xcJyksICcnLCAkZGVmYXVsdCk7DQogICAgICAgICRsYW5ndWFnZVB0ciA9ICYkdGhpcy0+bGFuZzsNCg0KICAgICAgICBpZiAoJGRlZmF1bHQgPT09ICcnKSB7DQogICAgICAgICAgICAkZGVmYXVsdCA9ICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfTEFOR1VBR0VQQUNLJ107DQogICAgICAgIH0NCg0KICAgICAgICAkZGVmYXVsdExhbmd1YWdlTGlzdCA9IGFycmF5KCRkZWZhdWx0LCAnemgtY24nLCAnemgtdHcnLCAnZW4nKTsNCg0KICAgICAgICBzd2l0Y2ggKCR0eXBlKSB7DQogICAgICAgICAgICBjYXNlICdzeXN0ZW0nOg0KICAgICAgICAgICAgICAgICRsYW5ndWFnZVBhdGggLj0gJ3piX3VzZXJzL2xhbmd1YWdlLyc7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdwbHVnaW4nOg0KICAgICAgICAgICAgY2FzZSAndGhlbWUnOg0KICAgICAgICAgICAgICAgICRsYW5ndWFnZVBhdGggLj0gJ3piX3VzZXJzLycgLiAkdHlwZSAuICcvJyAuICRpZCAuICcvbGFuZ3VhZ2UvJzsNCiAgICAgICAgICAgICAgICAkbGFuZ3VhZ2VQdHIgPSAmJHRoaXMtPmxhbmdbJGlkXTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgICAgICAgJGxhbmd1YWdlUGF0aCAuPSAkdHlwZSAuICcvbGFuZ3VhZ2UvJzsNCiAgICAgICAgICAgICAgICAkbGFuZ3VhZ2VQdHIgPSAmJHRoaXMtPmxhbmdbJGlkXTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgfQ0KDQogICAgICAgICRoYW5kbGUgPSBAb3BlbmRpcigkbGFuZ3VhZ2VQYXRoKTsNCiAgICAgICAgJG1hdGNoID0gbnVsbDsNCiAgICAgICAgaWYgKCRoYW5kbGUpIHsNCiAgICAgICAgICAgIHdoaWxlIChmYWxzZSAhPT0gKCRmaWxlID0gcmVhZGRpcigkaGFuZGxlKSkpIHsNCiAgICAgICAgICAgICAgICBpZiAocHJlZ19tYXRjaCgkbGFuZ3VhZ2VSZWdFeCwgJGZpbGUsICRtYXRjaCkpIHsNCiAgICAgICAgICAgICAgICAgICAgJGxhbmd1YWdlTGlzdFtdID0gJG1hdGNoWzFdOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGNsb3NlZGlyKCRoYW5kbGUpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgLy8g6L+Z6YeM5LiN5Lya5omn6KGM5Yiw77yM5Zyob3BlbmRpcuaXtuWwseW3sue7j+aKm+WHukVfV0FSTklORw0KICAgICAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbignQ2Fubm90IG9wZW5kaXIoJyAuICRsYW5ndWFnZVBhdGggLiAnKScpOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKGNvdW50KCRsYW5ndWFnZUxpc3QpID09PSAwKSB7DQogICAgICAgICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKCdObyBsYW5ndWFnZSBpbiAnIC4gJGxhbmd1YWdlUGF0aCk7DQogICAgICAgIH0NCg0KICAgICAgICBmb3IgKCRpID0gMDsgJGkgPCBjb3VudCgkZGVmYXVsdExhbmd1YWdlTGlzdCk7ICRpKyspIHsNCiAgICAgICAgICAgIC8vIOWcqOaViOeOh+S4iu+8jGFycmF5X3NlYXJjaOWSjOWRveWQjeaVsOe7hOayoeacieacrOi0qOWMuuWIq++8jOiHs+WwkeWcqOi/memHjOWmguatpOOAgg0KICAgICAgICAgICAgaWYgKGZhbHNlICE9PSBhcnJheV9zZWFyY2goJGRlZmF1bHRMYW5ndWFnZUxpc3RbJGldLCAkbGFuZ3VhZ2VMaXN0KSkgew0KICAgICAgICAgICAgICAgICRsYW5ndWFnZSA9ICRkZWZhdWx0TGFuZ3VhZ2VMaXN0WyRpXTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBpZiAoJGxhbmd1YWdlID09PSAnJykgew0KICAgICAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbignTGFuZ3VhZ2UgJyAuICRkZWZhdWx0IC4gJyBpcyBub3QgZm91bmQgaW4gJyAuICRsYW5ndWFnZVBhdGgpOw0KICAgICAgICB9DQoNCiAgICAgICAgJGxhbmd1YWdlUGF0aCAuPSAkbGFuZ3VhZ2UgLiAnLnBocCc7DQogICAgICAgICRsYW5ndWFnZVB0ciA9IGluY2x1ZGUgJGxhbmd1YWdlUGF0aDsNCiAgICAgICAgJHRoaXMtPmxhbmdwYWNrbGlzdFtdID0gYXJyYXkoJHR5cGUsICRpZCwgJGxhbmd1YWdlKTsNCiAgICAgICAgaWYgKCR0eXBlID09ICdzeXN0ZW0nKSB7DQogICAgICAgICAgICBpZiAoaXNfcmVhZGFibGUoJHRoaXMtPnN5c3RlbWRpciAuICdkZWZlbmQvZW4ucGhwJykpIHsNCiAgICAgICAgICAgICAgICAkZGVmZW5kX2VuID0gaW5jbHVkZSAkdGhpcy0+c3lzdGVtZGlyIC4gJ2RlZmVuZC9lbi5waHAnOw0KICAgICAgICAgICAgICAgICRub3dsYW5nID0gJGxhbmd1YWdlUHRyOw0KICAgICAgICAgICAgICAgICRsYW5ndWFnZVB0ciA9IGFycmF5X3JlcGxhY2VfcmVjdXJzaXZlKCRkZWZlbmRfZW4sICRub3dsYW5nKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgICR0aGlzLT5sYW5ncyA9IG5ldyBaYnBMYW5ncygkdGhpcy0+bGFuZywgJ2xhbmdzJyk7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIHB1YmxpYyBmdW5jdGlvbiBSZWZsdXNoTGFuZ3VhZ2VzKCkNCiAgICB7DQogICAgICAgICR0aGlzLT5sYW5nWydlcnJvciddWyc3NyddID0gc3RyX3JlcGxhY2UoYXJyYXkoJyVtaW4nLCAnJW1heCcpLCBhcnJheSgkdGhpcy0+b3B0aW9uWydaQ19VU0VSTkFNRV9NSU4nXSwgJHRoaXMtPm9wdGlvblsnWkNfVVNFUk5BTUVfTUFYJ10pLCAkdGhpcy0+bGFuZ1snZXJyb3InXVsnNzcnXSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YeN5paw6K+75Y+W6K+t6KiA5YyFLg0KICAgICAqDQogICAgICogQHRocm93cyBFeGNlcHRpb24NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gUmVsb2FkTGFuZ3VhZ2VzKCkNCiAgICB7DQogICAgICAgICRhcnJheSA9ICR0aGlzLT5sYW5ncGFja2xpc3Q7DQogICAgICAgICR0aGlzLT5sYW5nID0gJHRoaXMtPmxhbmdwYWNrbGlzdCA9IGFycmF5KCk7DQogICAgICAgIGZvcmVhY2ggKCRhcnJheSBhcyAkdikgew0KICAgICAgICAgICAgJHRoaXMtPkxvYWRMYW5ndWFnZSgkdlswXSwgJHZbMV0sICR2WzJdKTsNCiAgICAgICAgfQ0KICAgICAgICAkdGhpcy0+UmVmbHVzaExhbmd1YWdlcygpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWIm+W7uuaooeadv+Wvueixoe+8jOmihOWKoOi9veW3sue8luivkeaooeadvw0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkdGhlbWUg5oyH5a6a5Li76aKY5ZCNDQogICAgICoNCiAgICAgKiBAcmV0dXJuIFRlbXBsYXRlDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFByZXBhcmVUZW1wbGF0ZSgkdGhlbWUgPSBudWxsLCAkdGVtcGxhdGVfZGlybmFtZSA9ICd0ZW1wbGF0ZScpDQogICAgew0KICAgICAgICBpZiAoaXNfbnVsbCgkdGhlbWUpIHx8IGVtcHR5KCR0aGVtZSkpIHsNCiAgICAgICAgICAgICR0aGVtZSA9ICYkdGhpcy0+dGhlbWU7DQogICAgICAgIH0NCg0KICAgICAgICAkdGVtcGxhdGUgPSBuZXcgVGVtcGxhdGUoKTsNCiAgICAgICAgJHRlbXBsYXRlLT5NYWtlVGVtcGxhdGVUYWdzKCk7DQoNCiAgICAgICAgLy/ogIHmjqXlj6PvvIzlj6rmlLl0ZW1wbGF0ZVRhZ3PnmoQNCiAgICAgICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fWmJwX01ha2VUZW1wbGF0ZXRhZ3MnXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgICAgICRmcG5hbWUoJHRlbXBsYXRlLT50ZW1wbGF0ZVRhZ3MpOw0KICAgICAgICB9DQoNCiAgICAgICAgLy/mraTlpITlop7liqDmjqXlj6Plj6/ku6XlnKhMb2Fk5pe277yM5a+5JHRoZW1lLCAkdGVtcGxhdGVfZGlybmFtZeWPguaVsOWPr+S7pei/m+ihjOS/ruaUuQ0KICAgICAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9aYnBfUHJlcGFyZVRlbXBsYXRlJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICAgICAkZnBuYW1lKCR0aGVtZSwgJHRlbXBsYXRlX2Rpcm5hbWUpOw0KICAgICAgICB9DQoNCiAgICAgICAgJHRlbXBsYXRlLT50aGVtZSA9ICR0aGVtZTsNCiAgICAgICAgJHRlbXBsYXRlLT50ZW1wbGF0ZV9kaXJuYW1lID0gJHRlbXBsYXRlX2Rpcm5hbWU7DQoNCiAgICAgICAgJHRlbXBsYXRlLT5TZXRQYXRoKCk7DQoNCiAgICAgICAgJHRlbXBsYXRlLT5Mb2FkVGVtcGxhdGVzKCk7DQoNCiAgICAgICAgcmV0dXJuICR0ZW1wbGF0ZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpkojlr7nmnInlkIzkuIDkuLvpopjkuIvmnInlpJrlpZfmqKHmnb/nmoTop6PmnpANCiAgICAgKiDnm7TmjqXlnKjmjqXlj6PkuK3nm7TmjqXosIPnlKgkemJwLT5CdWlsZFRlbXBsYXRlTW9yZei/m+ihjOmHjeaWsOe8luivkeWFtuWug+aooeadvw0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBCdWlsZFRlbXBsYXRlKCkNCiAgICB7DQogICAgICAgICR0aGlzLT5CdWlsZFRlbXBsYXRlX09uY2UoKTsNCg0KICAgICAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9aYnBfQnVpbGRUZW1wbGF0ZV9FbmQnXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgICAgICRmcG5hbWUoJHRoaXMtPnRlbXBsYXRlKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOW/q+aNt+mHjeaWsOe8luivkeaMh+WumuS4u+mimOaooeadv+ebruW9leWQjeeahOaooeadvw0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEJ1aWxkVGVtcGxhdGVNb3JlKCR0aGVtZSA9IG51bGwsICR0ZW1wbGF0ZV9kaXJuYW1lID0gJ3RlbXBsYXRlJykNCiAgICB7DQogICAgICAgIGlmIChpc19udWxsKCR0aGVtZSkgfHwgZW1wdHkoJHRoZW1lKSkgew0KICAgICAgICAgICAgJHRoZW1lID0gJiR0aGlzLT50aGVtZTsNCiAgICAgICAgfQ0KICAgICAgICAkdGhpcy0+dGVtcGxhdGUtPnRoZW1lID0gJHRoZW1lOw0KICAgICAgICAkdGhpcy0+dGVtcGxhdGUtPnRlbXBsYXRlX2Rpcm5hbWUgPSAkdGVtcGxhdGVfZGlybmFtZTsNCiAgICAgICAgJHRoaXMtPnRlbXBsYXRlLT5TZXRQYXRoKCk7DQogICAgICAgIHJldHVybiAkdGhpcy0+QnVpbGRUZW1wbGF0ZV9PbmNlKCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5qih5p2/6Kej5p6QLg0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHJpdmF0ZSBmdW5jdGlvbiBCdWlsZFRlbXBsYXRlX09uY2UoKQ0KICAgIHsNCiAgICAgICAgJHRoaXMtPnRlbXBsYXRlLT5Mb2FkVGVtcGxhdGVzKCk7DQoNCiAgICAgICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fWmJwX0J1aWxkVGVtcGxhdGUnXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgICAgICRmcG5hbWUoJHRoaXMtPnRlbXBsYXRlLT50ZW1wbGF0ZXMpOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICR0aGlzLT50ZW1wbGF0ZS0+QnVpbGRUZW1wbGF0ZSgpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOabtOaWsOaooeadv+e8k+WtmC4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBib29sICRvbmx5Y2hlY2sgIOS4uuecn+eahOivne+8jOWPquWIpOaWreaYr+WQpumcgOimgeiAjOS4jUJ1aWxkDQogICAgICogQHBhcmFtIGJvb2wgJGZvcmNlYnVpbGQNCiAgICAgKg0KICAgICAqIEByZXR1cm4gdHJ1ZSBvciBmYWxzZQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBDaGVja1RlbXBsYXRlKCRvbmx5Y2hlY2sgPSBmYWxzZSwgJGZvcmNlYnVpbGQgPSBmYWxzZSkNCiAgICB7DQogICAgICAgICR0aGlzLT50ZW1wbGF0ZS0+TG9hZFRlbXBsYXRlcygpOw0KICAgICAgICAkcyA9IGltcGxvZGUoJHRoaXMtPnRlbXBsYXRlLT50ZW1wbGF0ZXMpOw0KICAgICAgICAkbWQ1ID0gbWQ1KCRzKTsNCg0KICAgICAgICAvL+acrOWHveaVsOeahOi/lOWbnuWAvOW+iOacieaEj+aAne+8jOS4umZhbHNl6KGo56S66ZyA6KaBcmVidWlsZCDkuLp0cnVl6KGo56S65bey6YeN5bu65a6M5oiQ5oiW5piv5LiN6ZyA6KaBcmVidWlsZA0KICAgICAgICAvLyR6YnAtPkNoZWNrVGVtcGxhdGUodHJ1ZSkgPT0gZmFsc2Ug55qE5oSP5oCd77yM5bCx5piv5Yik5pat5qih5p2/6ZyA6ZyA6KaB6YeN5Yi35paw5ZCX77yfDQoNCiAgICAgICAgJGFycmF5X21kNSA9IHVuc2VyaWFsaXplKCR0aGlzLT5jYWNoZS0+dGVtcGxhdGVzX21kNV9hcnJheSk7DQogICAgICAgIGlmICghaXNfYXJyYXkoJGFycmF5X21kNSkpIHsNCiAgICAgICAgICAgICRhcnJheV9tZDUgPSBhcnJheSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgJG5ld19tZDUgPSBHZXRWYWx1ZUluQXJyYXkoJGFycmF5X21kNSwgJHRoaXMtPnRlbXBsYXRlLT50ZW1wbGF0ZV9kaXJuYW1lKTsNCg0KICAgICAgICAvL+WmguaenOWvueavlOS4jeS4gOagtywkb25seWNoZWNr5bCx5pyJ55So5LqGDQogICAgICAgIGlmICgkbWQ1ICE9ICRuZXdfbWQ1KSB7DQogICAgICAgICAgICBpZiAoJG9ubHljaGVjayA9PSB0cnVlICYmICRmb3JjZWJ1aWxkID09IGZhbHNlKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgJHRoaXMtPkJ1aWxkVGVtcGxhdGUoKTsNCiAgICAgICAgICAgICRhcnJheV9tZDVbJHRoaXMtPnRlbXBsYXRlLT50ZW1wbGF0ZV9kaXJuYW1lXSA9ICRtZDU7DQogICAgICAgICAgICAkdGhpcy0+Y2FjaGUtPnRlbXBsYXRlc19tZDVfYXJyYXkgPSBzZXJpYWxpemUoJGFycmF5X21kNSk7DQogICAgICAgICAgICAkdGhpcy0+U2F2ZUNhY2hlKCk7DQoNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9DQogICAgICAgIC8v5aaC5p6c5a+55q+U5LiA5qC355qE6K+d77yMJGZvcmNlYnVpbGTlsLHmnInnlKjkuoYNCiAgICAgICAgaWYgKCRtZDUgPT0gJG5ld19tZDUpIHsNCiAgICAgICAgICAgIGlmICgkb25seWNoZWNrID09IHRydWUgJiYgJGZvcmNlYnVpbGQgPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICgkZm9yY2VidWlsZCA9PSB0cnVlKSB7DQogICAgICAgICAgICAgICAgJHRoaXMtPkJ1aWxkVGVtcGxhdGUoKTsNCiAgICAgICAgICAgICAgICAkYXJyYXlfbWQ1WyR0aGlzLT50ZW1wbGF0ZS0+dGVtcGxhdGVfZGlybmFtZV0gPSAkbWQ1Ow0KICAgICAgICAgICAgICAgICR0aGlzLT5jYWNoZS0+dGVtcGxhdGVzX21kNV9hcnJheSA9IHNlcmlhbGl6ZSgkYXJyYXlfbWQ1KTsNCiAgICAgICAgICAgICAgICAkdGhpcy0+U2F2ZUNhY2hlKCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gdHJ1ZTsNCg0KICAgICAgICAvKg0KICAgICAgICAvL+WmguaenOWvueavlOS4jeS4gOagtywkb25seWNoZWNr5bCx5pyJ55So5LqGDQogICAgICAgIGlmICgkbWQ1ICE9ICR0aGlzLT5jYWNoZS0+dGVtcGxhdGVzX21kNSkgew0KICAgICAgICAgICAgaWYgKCRvbmx5Y2hlY2sgPT0gdHJ1ZSAmJiAkZm9yY2VidWlsZCA9PSBmYWxzZSkgew0KICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgICR0aGlzLT5CdWlsZFRlbXBsYXRlKCk7DQogICAgICAgICAgICAkdGhpcy0+Y2FjaGUtPnRlbXBsYXRlc19tZDUgPSAkbWQ1Ow0KICAgICAgICAgICAgJHRoaXMtPlNhdmVDYWNoZSgpOw0KDQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KICAgICAgICAvL+WmguaenOWvueavlOS4gOagt+eahOivne+8jCRmb3JjZWJ1aWxk5bCx5pyJ55So5LqGDQogICAgICAgIGlmICgkbWQ1ID09ICR0aGlzLT5jYWNoZS0+dGVtcGxhdGVzX21kNSkgew0KICAgICAgICAgICAgaWYgKCRmb3JjZWJ1aWxkID09IHRydWUpIHsNCiAgICAgICAgICAgICAgICAkdGhpcy0+QnVpbGRUZW1wbGF0ZSgpOw0KICAgICAgICAgICAgICAgICR0aGlzLT5jYWNoZS0+dGVtcGxhdGVzX21kNSA9ICRtZDU7DQogICAgICAgICAgICAgICAgJHRoaXMtPlNhdmVDYWNoZSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICovDQogICAgfQ0KDQogICAgLyoqDQogICAgICog55Sf5oiQ5omA5pyJ6L+bUmVhZHkgTGlzdOeahOaooeWdl+eahENvbnRlbnTlhoXlrrnlubbkv53lrZguDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEJ1aWxkTW9kdWxlKCkNCiAgICB7DQogICAgICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1picF9CdWlsZE1vZHVsZSddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAgICAgJGZwbmFtZSgpOw0KICAgICAgICB9DQogICAgICAgIE1vZHVsZUJ1aWxkZXI6OkJ1aWxkKCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6I635Y+W5b2T5YmN5qih5p2/5a+55YOPDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uICZHZXRUZW1wbGF0ZSgpDQogICAgew0KICAgICAgICBpZiAoSVNfQ0xJICYmIChJU19XT1JLRVJNQU4gfHwgSVNfU1dPT0xFKSkgew0KICAgICAgICAgICAgJHRlbXBsYXRlID0gY2xvbmUgJHRoaXMtPnRlbXBsYXRlOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJHRlbXBsYXRlID0gJiR0aGlzLT50ZW1wbGF0ZTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAkdGVtcGxhdGU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YeN5bu65qih5Z2XLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbW9kdWxlRmlsZU5hbWUg5qih5Z2X5ZCNDQogICAgICogQHBhcmFtIHN0cmluZyAkbW9kdWxlRnVuY3Rpb24g55So5oi35Ye95pWwDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFJlZ0J1aWxkTW9kdWxlKCRtb2R1bGVGaWxlTmFtZSwgJG1vZHVsZUZ1bmN0aW9uKQ0KICAgIHsNCiAgICAgICAgTW9kdWxlQnVpbGRlcjo6UmVnKCRtb2R1bGVGaWxlTmFtZSwgJG1vZHVsZUZ1bmN0aW9uKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDns7vnu5/pu5jorqTms6jlhozmqKHlnZcuDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFJlZ0J1aWxkTW9kdWxlcygpDQogICAgew0KICAgICAgICAkdGhpcy0+UmVnQnVpbGRNb2R1bGUoJ2NhdGFsb2cnLCAnTW9kdWxlQnVpbGRlcjo6Q2F0YWxvZycpOw0KICAgICAgICAkdGhpcy0+UmVnQnVpbGRNb2R1bGUoJ2NhbGVuZGFyJywgJ01vZHVsZUJ1aWxkZXI6OkNhbGVuZGFyJyk7DQogICAgICAgICR0aGlzLT5SZWdCdWlsZE1vZHVsZSgnY29tbWVudHMnLCAnTW9kdWxlQnVpbGRlcjo6Q29tbWVudHMnKTsNCiAgICAgICAgJHRoaXMtPlJlZ0J1aWxkTW9kdWxlKCdwcmV2aW91cycsICdNb2R1bGVCdWlsZGVyOjpMYXRlc3RBcnRpY2xlcycpOw0KICAgICAgICAkdGhpcy0+UmVnQnVpbGRNb2R1bGUoJ2FyY2hpdmVzJywgJ01vZHVsZUJ1aWxkZXI6OkFyY2hpdmVzJyk7DQogICAgICAgICR0aGlzLT5SZWdCdWlsZE1vZHVsZSgnbmF2YmFyJywgJ01vZHVsZUJ1aWxkZXI6Ok5hdmJhcicpOw0KICAgICAgICAkdGhpcy0+UmVnQnVpbGRNb2R1bGUoJ3RhZ3MnLCAnTW9kdWxlQnVpbGRlcjo6VGFnTGlzdCcpOw0KICAgICAgICAkdGhpcy0+UmVnQnVpbGRNb2R1bGUoJ3N0YXRpc3RpY3MnLCAnTW9kdWxlQnVpbGRlcjo6U3RhdGlzdGljcycpOw0KICAgICAgICAkdGhpcy0+UmVnQnVpbGRNb2R1bGUoJ2F1dGhvcnMnLCAnTW9kdWxlQnVpbGRlcjo6QXV0aG9ycycpOw0KDQogICAgICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1picF9SZWdCdWlsZE1vZHVsZXMnXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgICAgICRmcG5hbWUoKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOa3u+WKoOi/m+WFpUJ1aWxkIFJlYWR55YiX6KGo55qE5qih5Z2XLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbW9kdWxlRmlsZU5hbWUg5qih5Z2X5ZCNDQogICAgICogQHBhcmFtIG51bGwgICAkcGFyYW1ldGVycyAgICAg5qih5Z2X5Y+C5pWwDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEFkZEJ1aWxkTW9kdWxlKCRtb2R1bGVGaWxlTmFtZSwgJHBhcmFtZXRlcnMgPSBudWxsKQ0KICAgIHsNCiAgICAgICAgJHAgPSBmdW5jX2dldF9hcmdzKCk7DQogICAgICAgIGlmICgkbW9kdWxlRmlsZU5hbWUgPT0gJ2FyY2hpdmVzJyAmJiAkdGhpcy0+b3B0aW9uWydaQ19MQVJHRV9EQVRBJ10gPT0gZmFsc2UgJiYgaXNzZXQoJHRoaXMtPm1vZHVsZXNieWZpbGVuYW1lWydhcmNoaXZlcyddKSkgew0KICAgICAgICAgICAgaWYgKCR0aGlzLT5tb2R1bGVzYnlmaWxlbmFtZVsnYXJjaGl2ZXMnXS0+R2V0U2lkZUJhckluVXNlZCgpID09IGFycmF5KCkpIHsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgY2FsbF91c2VyX2Z1bmNfYXJyYXkoYXJyYXkoJ01vZHVsZUJ1aWxkZXInLCAnQWRkJyksICRwKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDliKDpmaTov5vlhaVCdWlsZCBSZWFkeeWIl+ihqOaooeWdly4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG1vZHVsZUZpbGVOYW1lIOaooeWdl+WQjQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBEZWxCdWlsZE1vZHVsZSgkbW9kdWxlRmlsZU5hbWUpDQogICAgew0KICAgICAgICBNb2R1bGVCdWlsZGVyOjpEZWwoJG1vZHVsZUZpbGVOYW1lKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmn6Xor6LmjIflrprmlbDmja7nu5PmnoTnmoRzcWzlubbov5Tlm55CYXNl5a+56LGh5YiX6KGoLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZ3xhcnJheSAkdGFibGUgICAg5pWw5o2u6KGoDQogICAgICogQHBhcmFtIGFycmF5ICAgICAgICAkZGF0YWluZm8g5pWw5o2u5a2X5q61DQogICAgICogQHBhcmFtIHN0cmluZyAgICAgICAkc3FsICAgICAgU1FM5pON5L2c6K+t5Y+lDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGFycmF5DQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldExpc3RDdXN0b20oJHRhYmxlLCAkZGF0YWluZm8sICRzcWwpDQogICAgew0KICAgICAgICAkYXJyYXkgPSBudWxsOw0KICAgICAgICAkbGlzdCA9IGFycmF5KCk7DQogICAgICAgICRhcnJheSA9ICR0aGlzLT5kYi0+UXVlcnkoJHNxbCk7DQogICAgICAgIGlmICghaXNzZXQoJGFycmF5KSkgew0KICAgICAgICAgICAgcmV0dXJuIGFycmF5KCk7DQogICAgICAgIH0NCiAgICAgICAgZm9yZWFjaCAoJGFycmF5IGFzICRhKSB7DQogICAgICAgICAgICAkbCA9IG5ldyBCYXNlKCR0YWJsZSwgJGRhdGFpbmZvKTsNCiAgICAgICAgICAgICRsLT5Mb2FkSW5mb0J5QXNzb2MoJGEpOw0KICAgICAgICAgICAgJGxpc3RbXSA9ICRsOw0KICAgICAgICAgICAgdW5zZXQoJGwpOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICRsaXN0Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOafpeivoklE5pWw5o2u55qE5oyH5a6a5pWw5o2u57uT5p6E55qEc3Fs5bm26L+U5ZueQmFzZeWvueixoeWIl+ihqC4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgICAgICAgJHRhYmxlICAgICAg5pWw5o2u6KGoDQogICAgICogQHBhcmFtIGFycmF5ICAgICAgICAkZGF0YWluZm8gICDmlbDmja7lrZfmrrUNCiAgICAgKiBAcGFyYW0gYXJyYXkgICAgICAgICRhcnJheSAgICAgIElE5pWw57uEDQogICAgICogQHBhcmFtIHN0cmluZ3xhcnJheSAkZmllbGRfbmFtZSDlrZfmrrXlkI0gKOWmguaenCRhcnJheeaYr+WvueixoeaVsOaNru+8jOmCoyRmaWVsZF9uYW1l5bCx5Y+Y5Li6c3RyaW5n5pWw57uEKQ0KICAgICAqDQogICAgICogQHJldHVybiBCYXNlW10NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0TGlzdEN1c3RvbUJ5QXJyYXkoJHRhYmxlLCAkZGF0YWluZm8sICRhcnJheSwgJGZpZWxkX25hbWUgPSAnSUQnKQ0KICAgIHsNCiAgICAgICAgaWYgKCFpc19hcnJheSgkYXJyYXkpKSB7DQogICAgICAgICAgICByZXR1cm4gYXJyYXkoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChjb3VudCgkYXJyYXkpID09IDApIHsNCiAgICAgICAgICAgIHJldHVybiBhcnJheSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgJHdoZXJlID0gJGxpc3QgPSBhcnJheSgpOw0KICAgICAgICAkaXNfYXJyYXlfb2JqZWN0ID0gZmFsc2U7DQogICAgICAgIGZvcmVhY2ggKCRhcnJheSBhcyAkYW55KSB7DQogICAgICAgICAgICBpZiAoaXNfb2JqZWN0KCRhbnkpKSB7DQogICAgICAgICAgICAgICAgJGlzX2FycmF5X29iamVjdCA9IHRydWU7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgaWYgKCRpc19hcnJheV9vYmplY3QpIHsNCiAgICAgICAgICAgIGlmIChpc19hcnJheSgkZmllbGRfbmFtZSkpIHsNCiAgICAgICAgICAgICAgICBpZiAoY291bnQoJGZpZWxkX25hbWUpID09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgJGFycmF5X2ZpZWxkX25hbWUgPSBrZXkoJGZpZWxkX25hbWUpOw0KICAgICAgICAgICAgICAgICAgICAkZmllbGRfbmFtZSA9ICRmaWVsZF9uYW1lWyRhcnJheV9maWVsZF9uYW1lXTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAkYXJyYXlfZmllbGRfbmFtZSA9ICRmaWVsZF9uYW1lWzBdOw0KICAgICAgICAgICAgICAgICAgICAkZmllbGRfbmFtZSA9ICRmaWVsZF9uYW1lWzFdOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgJGFycmF5X2ZpZWxkX25hbWUgPSAkZmllbGRfbmFtZTsNCiAgICAgICAgICAgICAgICAkZmllbGRfbmFtZSA9ICdJRCc7DQogICAgICAgICAgICB9DQogICAgICAgICAgICAkYXJyYXkyID0gYXJyYXkoKTsNCiAgICAgICAgICAgIGZvcmVhY2ggKCRhcnJheSBhcyAkYW55KSB7DQogICAgICAgICAgICAgICAgJGFycmF5MltdID0gJGFueS0+JGFycmF5X2ZpZWxkX25hbWU7DQogICAgICAgICAgICB9DQogICAgICAgICAgICAkYXJyYXkgPSAkYXJyYXkyOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKGVtcHR5KCRhcnJheSkpIHsNCiAgICAgICAgICAgIHJldHVybiAkbGlzdDsNCiAgICAgICAgfQ0KICAgICAgICAkYXJyYXkgPSBhcnJheV91bmlxdWUoJGFycmF5KTsNCg0KICAgICAgICAkd2hlcmVbXSA9IGFycmF5KCdJTicsICRkYXRhaW5mb1skZmllbGRfbmFtZV1bMF0sIGltcGxvZGUoJywnLCAkYXJyYXkpKTsNCiAgICAgICAgJHNxbCA9ICR0aGlzLT5kYi0+c3FsLT5TZWxlY3QoJHRhYmxlLCAnKicsICR3aGVyZSk7DQogICAgICAgICRvYmplY3RzID0gJHRoaXMtPmRiLT5RdWVyeSgkc3FsKTsNCiAgICAgICAgaWYgKCFpc3NldCgkb2JqZWN0cykpIHsNCiAgICAgICAgICAgIHJldHVybiAkbGlzdDsNCiAgICAgICAgfQ0KICAgICAgICBmb3JlYWNoICgkb2JqZWN0cyBhcyAkYSkgew0KICAgICAgICAgICAgJGwgPSBuZXcgQmFzZSgkdGFibGUsICRkYXRhaW5mbyk7DQogICAgICAgICAgICAkbC0+TG9hZEluZm9CeUFzc29jKCRhKTsNCiAgICAgICAgICAgICRsaXN0W10gPSAkbDsNCiAgICAgICAgICAgIHVuc2V0KCRsKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAkbGlzdDsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDlt7LmlLnlkI1HZXRMaXN0VHlwZSwxLjXniYjkuK3miZTmjonmnInmrafkuYnnmoRHZXRMaXN0Lg0KICAgICAqDQogICAgICogQHBhcmFtICRjbGFzc25hbWUNCiAgICAgKiBAcGFyYW0gJHNxbA0KICAgICAqDQogICAgICogQHJldHVybiBCYXNlW10NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0TGlzdFR5cGUoJGNsYXNzbmFtZSwgJHNxbCkNCiAgICB7DQogICAgICAgIGlmIChpc19vYmplY3QoJHNxbCkgJiYgZ2V0X3BhcmVudF9jbGFzcygkc3FsKSA9PSAnU1FMX19HbG9iYWwnKSB7DQogICAgICAgICAgICAkc3FsID0gJHNxbC0+c3FsOw0KICAgICAgICB9DQogICAgICAgICRhcnJheSA9IG51bGw7DQogICAgICAgICRsaXN0ID0gYXJyYXkoKTsNCiAgICAgICAgJGFycmF5ID0gJHRoaXMtPmRiLT5RdWVyeSgkc3FsKTsNCiAgICAgICAgaWYgKCFpc3NldCgkYXJyYXkpKSB7DQogICAgICAgICAgICByZXR1cm4gYXJyYXkoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGZvcmVhY2ggKCRhcnJheSBhcyAkYSkgew0KICAgICAgICAgICAgaWYgKGlzX2FycmF5KCRhKSkgew0KICAgICAgICAgICAgICAgIC8qKiBAdmFyIEJhc2UgJGwgKi8NCiAgICAgICAgICAgICAgICAkbCA9IG5ldyAkY2xhc3NuYW1lKCk7DQogICAgICAgICAgICAgICAgJGwtPkxvYWRJbmZvQnlBc3NvYygkYSk7DQogICAgICAgICAgICAgICAgaWYgKGlzX3N1YmNsYXNzX29mKCRjbGFzc25hbWUsICdCYXNlUG9zdCcpID09IHRydWUpIHsNCiAgICAgICAgICAgICAgICAgICAgJG5ld3R5cGUgPSAkdGhpcy0+R2V0UG9zdFR5cGVfQ2xhc3NOYW1lKCRsLT5UeXBlKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCRuZXd0eXBlICE9ICRjbGFzc25hbWUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVuc2V0KCRsKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICRsID0gbmV3ICRuZXd0eXBlOw0KICAgICAgICAgICAgICAgICAgICAgICAgJGwtPkxvYWRJbmZvQnlBc3NvYygkYSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgJGlkID0gJGwtPkdldElkTmFtZSgpOw0KICAgICAgICAgICAgICAgIGlmICgkdGhpcy0+Q2hlY2tDYWNoZSgkY2xhc3NuYW1lLCAkbC0+JGlkKSA9PSBmYWxzZSkgew0KICAgICAgICAgICAgICAgICAgICAkdGhpcy0+QWRkQ2FjaGUoJGwpOw0KICAgICAgICAgICAgICAgICAgICAkbGlzdFtdID0gJGw7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgJG4gPSAmJHRoaXMtPkdldENhY2hlKCRjbGFzc25hbWUsICRsLT4kaWQpOw0KICAgICAgICAgICAgICAgICAgICAkbGlzdFtdID0gJG47DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHVuc2V0KCRsLCAkbik7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJGxpc3Q7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogR2V0TGlzdE9yaWdpbi4NCiAgICAgKg0KICAgICAqIEBwYXJhbSAkc3FsDQogICAgICoNCiAgICAgKiBAcmV0dXJuIEJhc2VbXQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRMaXN0T3JpZ2luKCRzcWwpDQogICAgew0KICAgICAgICBpZiAoaXNfb2JqZWN0KCRzcWwpICYmIGdldF9wYXJlbnRfY2xhc3MoJHNxbCkgPT0gJ1NRTF9fR2xvYmFsJykgew0KICAgICAgICAgICAgJHNxbCA9ICRzcWwtPnNxbDsNCiAgICAgICAgfQ0KICAgICAgICAkYXJyYXkgPSBudWxsOw0KICAgICAgICAkbGlzdCA9IGFycmF5KCk7DQogICAgICAgICRhcnJheSA9ICR0aGlzLT5kYi0+UXVlcnkoJHNxbCk7DQogICAgICAgIGlmICghaXNzZXQoJGFycmF5KSkgew0KICAgICAgICAgICAgcmV0dXJuIGFycmF5KCk7DQogICAgICAgIH0NCiAgICAgICAgZm9yZWFjaCAoJGFycmF5IGFzICRhKSB7DQogICAgICAgICAgICAkbGlzdFtdID0gJGE7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJGxpc3Q7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5p+l6K+iSUTmlbDmja7nmoTmjIflrprnsbvlnovnmoRzcWzlubbov5Tlm57mjIflrprnsbvlnovlr7nosaHliJfooaguDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRjbGFzc25hbWUgIOexu+Weiw0KICAgICAqIEBwYXJhbSBtaXhlZCAgJGFycmF5IElE5pWw57uEDQogICAgICogQHBhcmFtIHN0cmluZyAkZmllbGRfbmFtZSDlrZfmrrXlkI0gKOWmguaenCRhcnJheeaYr+WvueixoeaVsOaNru+8jOmCoyRmaWVsZF9uYW1l5bCx5Y+Y5Li6c3RyaW5n5pWw57uEKQ0KICAgICAqDQogICAgICogQHJldHVybiBCYXNlW10NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0TGlzdFR5cGVCeUFycmF5KCRjbGFzc25hbWUsICRhcnJheSwgJGZpZWxkX25hbWUgPSAnSUQnKQ0KICAgIHsNCiAgICAgICAgaWYgKCFpc19hcnJheSgkYXJyYXkpKSB7DQogICAgICAgICAgICByZXR1cm4gYXJyYXkoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChjb3VudCgkYXJyYXkpID09IDApIHsNCiAgICAgICAgICAgIHJldHVybiBhcnJheSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgJHdoZXJlID0gJGxpc3QgPSBhcnJheSgpOw0KICAgICAgICAvLyRhcnJheeWmguaenOaYr0Jhc2VPYmplY3TmlbDnu4TnmoTor50s5Y+v5Lul6YeN57uE55Sf5oiQ5pawJGFycmF5LCRmaWVsZF9uYW1l5q2k5pe25Y+v5Y+Y5oiQ5pWw57uEDQogICAgICAgIC8v5aaC5p6cJGZpZWxkX25hbWXmmK/mlbDnu4TvvIzpgqPkuYgkZmllbGRfbmFtZVswXeaYr+aMhyRhcnJheeeahGZpZWxkX25hbWUsJGZpZWxkX25hbWVbMV3mjIfopoHmn6Xlr7vnmoRmaWVsZF9uYW1lDQogICAgICAgICRpc19hcnJheV9vYmplY3QgPSBmYWxzZTsNCiAgICAgICAgZm9yZWFjaCAoJGFycmF5IGFzICRhbnkpIHsNCiAgICAgICAgICAgIGlmIChpc19vYmplY3QoJGFueSkpIHsNCiAgICAgICAgICAgICAgICAkaXNfYXJyYXlfb2JqZWN0ID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBpZiAoJGlzX2FycmF5X29iamVjdCkgew0KICAgICAgICAgICAgaWYgKGlzX2FycmF5KCRmaWVsZF9uYW1lKSkgew0KICAgICAgICAgICAgICAgIGlmIChjb3VudCgkZmllbGRfbmFtZSkgPT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAkYXJyYXlfZmllbGRfbmFtZSA9IGtleSgkZmllbGRfbmFtZSk7DQogICAgICAgICAgICAgICAgICAgICRmaWVsZF9uYW1lID0gJGZpZWxkX25hbWVbJGFycmF5X2ZpZWxkX25hbWVdOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICRhcnJheV9maWVsZF9uYW1lID0gJGZpZWxkX25hbWVbMF07DQogICAgICAgICAgICAgICAgICAgICRmaWVsZF9uYW1lID0gJGZpZWxkX25hbWVbMV07DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAkYXJyYXlfZmllbGRfbmFtZSA9ICRmaWVsZF9uYW1lOw0KICAgICAgICAgICAgICAgICRmaWVsZF9uYW1lID0gJ0lEJzsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgICRhcnJheTIgPSBhcnJheSgpOw0KICAgICAgICAgICAgZm9yZWFjaCAoJGFycmF5IGFzICRhbnkpIHsNCiAgICAgICAgICAgICAgICAkYXJyYXkyW10gPSAkYW55LT4kYXJyYXlfZmllbGRfbmFtZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgICRhcnJheSA9ICRhcnJheTI7DQogICAgICAgIH0NCg0KICAgICAgICAkYXJyYXkgPSBhcnJheV91bmlxdWUoJGFycmF5KTsNCiAgICAgICAgJGNhY2hlID0gJiR0aGlzLT5HZXRDYWNoZSgkY2xhc3NuYW1lKTsNCiAgICAgICAgZm9yZWFjaCAoJGNhY2hlIGFzICRvKSB7DQogICAgICAgICAgICAkdjEgPSAkby0+JGZpZWxkX25hbWU7DQogICAgICAgICAgICBmb3JlYWNoICgkYXJyYXkgYXMgJGsyID0+ICR2Mikgew0KICAgICAgICAgICAgICAgIGlmICgkdjEgPT0gJHYyKSB7DQogICAgICAgICAgICAgICAgICAgIHVuc2V0KCRhcnJheVskazJdKTsNCiAgICAgICAgICAgICAgICAgICAgJGxpc3RbXSA9ICRvOw0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgaWYgKGVtcHR5KCRhcnJheSkpIHsNCiAgICAgICAgICAgIHJldHVybiAkbGlzdDsNCiAgICAgICAgfQ0KDQogICAgICAgICRvID0gbmV3ICRjbGFzc25hbWU7DQogICAgICAgICR0YWJsZSA9ICYkby0+R2V0VGFibGUoKTsNCiAgICAgICAgJGRhdGFpbmZvID0gJiRvLT5HZXREYXRhSW5mbygpOw0KICAgICAgICAkd2hlcmVbXSA9IGFycmF5KCdJTicsICRkYXRhaW5mb1skZmllbGRfbmFtZV1bMF0sIGltcGxvZGUoJywnLCAkYXJyYXkpKTsNCiAgICAgICAgJHNxbCA9ICR0aGlzLT5kYi0+c3FsLT5TZWxlY3QoJHRhYmxlLCAnKicsICR3aGVyZSk7DQogICAgICAgICRvYmplY3RzID0gJHRoaXMtPmRiLT5RdWVyeSgkc3FsKTsNCiAgICAgICAgaWYgKCFpc3NldCgkb2JqZWN0cykpIHsNCiAgICAgICAgICAgIHJldHVybiAkbGlzdDsNCiAgICAgICAgfQ0KICAgICAgICBmb3JlYWNoICgkb2JqZWN0cyBhcyAkYSkgew0KICAgICAgICAgICAgLyoqIEB2YXIgQmFzZSAkbCAqLw0KICAgICAgICAgICAgJGwgPSBuZXcgJGNsYXNzbmFtZSgpOw0KICAgICAgICAgICAgJGwtPkxvYWRJbmZvQnlBc3NvYygkYSk7DQogICAgICAgICAgICBpZiAoaXNfc3ViY2xhc3Nfb2YoJGNsYXNzbmFtZSwgJ0Jhc2VQb3N0JykgPT0gdHJ1ZSkgew0KICAgICAgICAgICAgICAgICRuZXd0eXBlID0gJHRoaXMtPkdldFBvc3RUeXBlX0NsYXNzTmFtZSgkbC0+VHlwZSk7DQogICAgICAgICAgICAgICAgaWYgKCRuZXd0eXBlICE9ICRjbGFzc25hbWUpIHsNCiAgICAgICAgICAgICAgICAgICAgdW5zZXQoJGwpOw0KICAgICAgICAgICAgICAgICAgICAkbCA9IG5ldyAkbmV3dHlwZTsNCiAgICAgICAgICAgICAgICAgICAgJGwtPkxvYWRJbmZvQnlBc3NvYygkYSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgJGlkID0gJGwtPkdldElkTmFtZSgpOw0KICAgICAgICAgICAgaWYgKCR0aGlzLT5DaGVja0NhY2hlKCRjbGFzc25hbWUsICRsLT4kaWQpID09IGZhbHNlKSB7DQogICAgICAgICAgICAgICAgJHRoaXMtPkFkZENhY2hlKCRsKTsNCiAgICAgICAgICAgICAgICAkbGlzdFtdID0gJGw7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICRuID0gJiR0aGlzLT5HZXRDYWNoZSgkY2xhc3NuYW1lLCAkbC0+JGlkKTsNCiAgICAgICAgICAgICAgICAkbGlzdFtdID0gJG47DQogICAgICAgICAgICB9DQogICAgICAgICAgICB1bnNldCgkbCwgJG4pOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICRsaXN0Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmtlOacr+aWueazleaMh+WumueahOivu+WPlkxpc3TnmoTnp4HmnInmlrnms5UNCiAgICAgKi8NCiAgICBwcm90ZWN0ZWQgZnVuY3Rpb24gR2V0TGlzdFdpdGhCYXNlT2JqZWN0KCRjbGFzc25hbWUsICRzZWxlY3QgPSBudWxsLCAkd2hlcmUgPSBudWxsLCAkb3JkZXIgPSBudWxsLCAkbGltaXQgPSBudWxsLCAkb3B0aW9uID0gbnVsbCkNCiAgICB7DQogICAgICAgIGlmIChpc19vYmplY3QoJHNlbGVjdCkgJiYgZ2V0X3BhcmVudF9jbGFzcygkc2VsZWN0KSA9PSAnU1FMX19HbG9iYWwnKSB7DQogICAgICAgICAgICAkc3FsID0gJHNlbGVjdC0+c3FsOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJG8gPSBuZXcgJGNsYXNzbmFtZTsNCiAgICAgICAgICAgICR0YWJsZSA9ICYkby0+R2V0VGFibGUoKTsNCiAgICAgICAgICAgICRzcWwgPSAkdGhpcy0+ZGItPnNxbC0+U2VsZWN0KCR0YWJsZSwgJHNlbGVjdCwgJHdoZXJlLCAkb3JkZXIsICRsaW1pdCwgJG9wdGlvbik7DQogICAgICAgIH0NCg0KICAgICAgICAvKiogQHZhciBCYXNlT2JqZWN0c1tdICRhcnJheSAqLw0KICAgICAgICAkYXJyYXkgPSAkdGhpcy0+R2V0TGlzdFR5cGUoJGNsYXNzbmFtZSwgJHNxbCk7DQogICAgICAgIGlmIChpc3NldCgkb3B0aW9uWydwYWdlYmFyJ10pICYmIGlzX29iamVjdCgkb3B0aW9uWydwYWdlYmFyJ10pKSB7DQogICAgICAgICAgICAkb3B0aW9uWydwYWdlYmFyJ10tPkN1cnJlbnRDb3VudCA9IGNvdW50KCRhcnJheSk7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJGFycmF5Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmtlOacr+aWueazleaMh+WumueahOivu+WPlkxpc3RCeUFycmF555qE56eB5pyJ5pa55rOVDQogICAgICovDQogICAgcHJvdGVjdGVkIGZ1bmN0aW9uIEdldExpc3RCeUFycmF5V2l0aEJhc2VPYmplY3QoJGNsYXNzbmFtZSwgJGFycmF5LCAkZmllbGRfbmFtZSA9ICdJRCcpDQogICAgew0KICAgICAgICByZXR1cm4gJHRoaXMtPkdldExpc3RUeXBlQnlBcnJheSgkY2xhc3NuYW1lLCAkYXJyYXksICRmaWVsZF9uYW1lKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDprZTmnK/mlrnms5XmjIflrprnmoTor7vlj5ZTaW5nbGVCeUlE55qE56eB5pyJ5pa55rOVDQogICAgICovDQogICAgcHJvdGVjdGVkIGZ1bmN0aW9uIEdldFNpbmdsZUJ5SURXaXRoQmFzZU9iamVjdCgkY2xhc3NuYW1lLCAkaWQpDQogICAgew0KICAgICAgICByZXR1cm4gJHRoaXMtPkdldFNvbWVUaGluZygkdGhpcy0+R2V0Q2FjaGUoJGNsYXNzbmFtZSksICdJRCcsICRpZCwgJGNsYXNzbmFtZSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogQHBhcmFtIG1peGVkICRzZWxlY3QNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJHdoZXJlDQogICAgICogQHBhcmFtIG1peGVkICRvcmRlcg0KICAgICAqIEBwYXJhbSBtaXhlZCAkbGltaXQNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJG9wdGlvbg0KICAgICAqDQogICAgICogQHJldHVybiBQb3N0W10NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0UG9zdExpc3QoJHNlbGVjdCA9IG51bGwsICR3aGVyZSA9IG51bGwsICRvcmRlciA9IG51bGwsICRsaW1pdCA9IG51bGwsICRvcHRpb24gPSBudWxsKQ0KICAgIHsNCiAgICAgICAgaWYgKGlzX29iamVjdCgkc2VsZWN0KSAmJiBnZXRfcGFyZW50X2NsYXNzKCRzZWxlY3QpID09ICdTUUxfX0dsb2JhbCcpIHsNCiAgICAgICAgICAgICRzcWwgPSAkc2VsZWN0LT5zcWw7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkc3FsID0gJHRoaXMtPmRiLT5zcWwtPlNlbGVjdCgkdGhpcy0+dGFibGVbJ1Bvc3QnXSwgJHNlbGVjdCwgJHdoZXJlLCAkb3JkZXIsICRsaW1pdCwgJG9wdGlvbik7DQogICAgICAgIH0NCg0KICAgICAgICAvKiogQHZhciBQb3N0W10gJGFycmF5ICovDQogICAgICAgICRhcnJheSA9ICR0aGlzLT5HZXRMaXN0VHlwZSgnUG9zdCcsICRzcWwsICRvcHRpb24pOw0KICAgICAgICBpZiAoaXNzZXQoJG9wdGlvblsncGFnZWJhciddKSAmJiBpc19vYmplY3QoJG9wdGlvblsncGFnZWJhciddKSkgew0KICAgICAgICAgICAgJG9wdGlvblsncGFnZWJhciddLT5DdXJyZW50Q291bnQgPSBjb3VudCgkYXJyYXkpOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICRhcnJheTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJHNlbGVjdA0KICAgICAqIEBwYXJhbSBtaXhlZCAkd2hlcmUNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJG9yZGVyDQogICAgICogQHBhcmFtIG1peGVkICRsaW1pdA0KICAgICAqIEBwYXJhbSBtaXhlZCAkb3B0aW9uDQogICAgICogQHBhcmFtIG1peGVkICRyZWFkdGFncw0KICAgICAqDQogICAgICogQHJldHVybiBQb3N0W10NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0QXJ0aWNsZUxpc3QoJHNlbGVjdCA9IG51bGwsICR3aGVyZSA9IG51bGwsICRvcmRlciA9IG51bGwsICRsaW1pdCA9IG51bGwsICRvcHRpb24gPSBudWxsLCAkcmVhZHRhZ3MgPSB0cnVlKQ0KICAgIHsNCiAgICAgICAgaWYgKGVtcHR5KCR3aGVyZSkpIHsNCiAgICAgICAgICAgICR3aGVyZSA9IGFycmF5KCk7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoaXNfYXJyYXkoJHdoZXJlKSkgew0KICAgICAgICAgICAgYXJyYXlfdW5zaGlmdCgkd2hlcmUsIGFycmF5KCc9JywgJ2xvZ19UeXBlJywgJzAnKSk7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoaXNfb2JqZWN0KCRzZWxlY3QpICYmIGdldF9wYXJlbnRfY2xhc3MoJHNlbGVjdCkgPT0gJ1NRTF9fR2xvYmFsJykgew0KICAgICAgICAgICAgJHNxbCA9ICRzZWxlY3QtPnNxbDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICRzcWwgPSAkdGhpcy0+ZGItPnNxbC0+U2VsZWN0KCR0aGlzLT50YWJsZVsnUG9zdCddLCAkc2VsZWN0LCAkd2hlcmUsICRvcmRlciwgJGxpbWl0LCAkb3B0aW9uKTsNCiAgICAgICAgfQ0KDQoNCiAgICAgICAgLyoqIEB2YXIgUG9zdFtdICRhcnJheSAqLw0KICAgICAgICAkYXJyYXkgPSAkdGhpcy0+R2V0TGlzdFR5cGUoJ1Bvc3QnLCAkc3FsLCAkb3B0aW9uKTsNCiAgICAgICAgaWYgKGlzc2V0KCRvcHRpb25bJ3BhZ2ViYXInXSkgJiYgaXNfb2JqZWN0KCRvcHRpb25bJ3BhZ2ViYXInXSkpIHsNCiAgICAgICAgICAgICRvcHRpb25bJ3BhZ2ViYXInXS0+Q3VycmVudENvdW50ID0gY291bnQoJGFycmF5KTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmICgkcmVhZHRhZ3MpIHsNCiAgICAgICAgICAgICR0YWdzdHJpbmcgPSAnJzsNCiAgICAgICAgICAgIGZvcmVhY2ggKCRhcnJheSBhcyAkYSkgew0KICAgICAgICAgICAgICAgICR0YWdzdHJpbmcgLj0gJGEtPlRhZzsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgICR0aGlzLT5Mb2FkVGFnc0J5SURTdHJpbmcoJHRhZ3N0cmluZyk7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJGFycmF5Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBwYXJhbSBtaXhlZCAkc2VsZWN0DQogICAgICogQHBhcmFtIG1peGVkICR3aGVyZQ0KICAgICAqIEBwYXJhbSBtaXhlZCAkb3JkZXINCiAgICAgKiBAcGFyYW0gbWl4ZWQgJGxpbWl0DQogICAgICogQHBhcmFtIG1peGVkICRvcHRpb24NCiAgICAgKg0KICAgICAqIEByZXR1cm4gUG9zdFtdDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFBhZ2VMaXN0KCRzZWxlY3QgPSBudWxsLCAkd2hlcmUgPSBudWxsLCAkb3JkZXIgPSBudWxsLCAkbGltaXQgPSBudWxsLCAkb3B0aW9uID0gbnVsbCkNCiAgICB7DQogICAgICAgIGlmIChlbXB0eSgkd2hlcmUpKSB7DQogICAgICAgICAgICAkd2hlcmUgPSBhcnJheSgpOw0KICAgICAgICB9DQogICAgICAgIGlmIChpc19hcnJheSgkd2hlcmUpKSB7DQogICAgICAgICAgICBhcnJheV91bnNoaWZ0KCR3aGVyZSwgYXJyYXkoJz0nLCAnbG9nX1R5cGUnLCAnMScpKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChpc19vYmplY3QoJHNlbGVjdCkgJiYgZ2V0X3BhcmVudF9jbGFzcygkc2VsZWN0KSA9PSAnU1FMX19HbG9iYWwnKSB7DQogICAgICAgICAgICAkc3FsID0gJHNlbGVjdC0+c3FsOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJHNxbCA9ICR0aGlzLT5kYi0+c3FsLT5TZWxlY3QoJHRoaXMtPnRhYmxlWydQb3N0J10sICRzZWxlY3QsICR3aGVyZSwgJG9yZGVyLCAkbGltaXQsICRvcHRpb24pOw0KICAgICAgICB9DQoNCiAgICAgICAgLyoqIEB2YXIgUG9zdFtdICRhcnJheSAqLw0KICAgICAgICAkYXJyYXkgPSAkdGhpcy0+R2V0TGlzdFR5cGUoJ1Bvc3QnLCAkc3FsKTsNCiAgICAgICAgaWYgKGlzc2V0KCRvcHRpb25bJ3BhZ2ViYXInXSkgJiYgaXNfb2JqZWN0KCRvcHRpb25bJ3BhZ2ViYXInXSkpIHsNCiAgICAgICAgICAgICRvcHRpb25bJ3BhZ2ViYXInXS0+Q3VycmVudENvdW50ID0gY291bnQoJGFycmF5KTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAkYXJyYXk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogQHBhcmFtIG1peGVkICRzZWxlY3QNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJHdoZXJlDQogICAgICogQHBhcmFtIG1peGVkICRvcmRlcg0KICAgICAqIEBwYXJhbSBtaXhlZCAkbGltaXQNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJG9wdGlvbg0KICAgICAqDQogICAgICogQHJldHVybiBDb21tZW50W10NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0Q29tbWVudExpc3QoJHNlbGVjdCA9IG51bGwsICR3aGVyZSA9IG51bGwsICRvcmRlciA9IG51bGwsICRsaW1pdCA9IG51bGwsICRvcHRpb24gPSBudWxsKQ0KICAgIHsNCiAgICAgICAgaWYgKGlzX29iamVjdCgkc2VsZWN0KSAmJiBnZXRfcGFyZW50X2NsYXNzKCRzZWxlY3QpID09ICdTUUxfX0dsb2JhbCcpIHsNCiAgICAgICAgICAgICRzcWwgPSAkc2VsZWN0LT5zcWw7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkc3FsID0gJHRoaXMtPmRiLT5zcWwtPlNlbGVjdCgkdGhpcy0+dGFibGVbJ0NvbW1lbnQnXSwgJHNlbGVjdCwgJHdoZXJlLCAkb3JkZXIsICRsaW1pdCwgJG9wdGlvbik7DQogICAgICAgIH0NCg0KICAgICAgICAvKiogQHZhciBDb21tZW50W10gJGFycmF5ICovDQogICAgICAgICRhcnJheSA9ICR0aGlzLT5HZXRMaXN0VHlwZSgnQ29tbWVudCcsICRzcWwpOw0KICAgICAgICBpZiAoaXNzZXQoJG9wdGlvblsncGFnZWJhciddKSAmJiBpc19vYmplY3QoJG9wdGlvblsncGFnZWJhciddKSkgew0KICAgICAgICAgICAgJG9wdGlvblsncGFnZWJhciddLT5DdXJyZW50Q291bnQgPSBjb3VudCgkYXJyYXkpOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICRhcnJheTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJHNlbGVjdA0KICAgICAqIEBwYXJhbSBtaXhlZCAkd2hlcmUNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJG9yZGVyDQogICAgICogQHBhcmFtIG1peGVkICRsaW1pdA0KICAgICAqIEBwYXJhbSBtaXhlZCAkb3B0aW9uDQogICAgICoNCiAgICAgKiBAcmV0dXJuIE1lbWJlcltdfEJhc2VbXQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRNZW1iZXJMaXN0KCRzZWxlY3QgPSBudWxsLCAkd2hlcmUgPSBudWxsLCAkb3JkZXIgPSBudWxsLCAkbGltaXQgPSBudWxsLCAkb3B0aW9uID0gbnVsbCkNCiAgICB7DQogICAgICAgIGlmIChpc19vYmplY3QoJHNlbGVjdCkgJiYgZ2V0X3BhcmVudF9jbGFzcygkc2VsZWN0KSA9PSAnU1FMX19HbG9iYWwnKSB7DQogICAgICAgICAgICAkc3FsID0gJHNlbGVjdC0+c3FsOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJHNxbCA9ICR0aGlzLT5kYi0+c3FsLT5TZWxlY3QoJHRoaXMtPnRhYmxlWydNZW1iZXInXSwgJHNlbGVjdCwgJHdoZXJlLCAkb3JkZXIsICRsaW1pdCwgJG9wdGlvbik7DQogICAgICAgIH0NCg0KICAgICAgICAkYXJyYXkgPSAkdGhpcy0+R2V0TGlzdFR5cGUoJ01lbWJlcicsICRzcWwpOw0KICAgICAgICBpZiAoaXNzZXQoJG9wdGlvblsncGFnZWJhciddKSAmJiBpc19vYmplY3QoJG9wdGlvblsncGFnZWJhciddKSkgew0KICAgICAgICAgICAgJG9wdGlvblsncGFnZWJhciddLT5DdXJyZW50Q291bnQgPSBjb3VudCgkYXJyYXkpOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICRhcnJheTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJHNlbGVjdA0KICAgICAqIEBwYXJhbSBtaXhlZCAkd2hlcmUNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJG9yZGVyDQogICAgICogQHBhcmFtIG1peGVkICRsaW1pdA0KICAgICAqIEBwYXJhbSBtaXhlZCAkb3B0aW9uDQogICAgICoNCiAgICAgKiBAcmV0dXJuIFRhZ1tdfEJhc2VbXQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRUYWdMaXN0KCRzZWxlY3QgPSBudWxsLCAkd2hlcmUgPSBudWxsLCAkb3JkZXIgPSBudWxsLCAkbGltaXQgPSBudWxsLCAkb3B0aW9uID0gbnVsbCkNCiAgICB7DQogICAgICAgIGlmIChpc19vYmplY3QoJHNlbGVjdCkgJiYgZ2V0X3BhcmVudF9jbGFzcygkc2VsZWN0KSA9PSAnU1FMX19HbG9iYWwnKSB7DQogICAgICAgICAgICAkc3FsID0gJHNlbGVjdC0+c3FsOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJHNxbCA9ICR0aGlzLT5kYi0+c3FsLT5TZWxlY3QoJHRoaXMtPnRhYmxlWydUYWcnXSwgJHNlbGVjdCwgJHdoZXJlLCAkb3JkZXIsICRsaW1pdCwgJG9wdGlvbik7DQogICAgICAgIH0NCg0KICAgICAgICAkYXJyYXkgPSAkdGhpcy0+R2V0TGlzdFR5cGUoJ1RhZycsICRzcWwpOw0KICAgICAgICBpZiAoaXNzZXQoJG9wdGlvblsncGFnZWJhciddKSAmJiBpc19vYmplY3QoJG9wdGlvblsncGFnZWJhciddKSkgew0KICAgICAgICAgICAgJG9wdGlvblsncGFnZWJhciddLT5DdXJyZW50Q291bnQgPSBjb3VudCgkYXJyYXkpOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICRhcnJheTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJHNlbGVjdA0KICAgICAqIEBwYXJhbSBtaXhlZCAkd2hlcmUNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJG9yZGVyDQogICAgICogQHBhcmFtIG1peGVkICRsaW1pdA0KICAgICAqIEBwYXJhbSBtaXhlZCAkb3B0aW9uDQogICAgICoNCiAgICAgKiBAcmV0dXJuIENhdGVnb3J5W118QmFzZVtdDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldENhdGVnb3J5TGlzdCgkc2VsZWN0ID0gbnVsbCwgJHdoZXJlID0gbnVsbCwgJG9yZGVyID0gbnVsbCwgJGxpbWl0ID0gbnVsbCwgJG9wdGlvbiA9IG51bGwpDQogICAgew0KICAgICAgICBpZiAoaXNfb2JqZWN0KCRzZWxlY3QpICYmIGdldF9wYXJlbnRfY2xhc3MoJHNlbGVjdCkgPT0gJ1NRTF9fR2xvYmFsJykgew0KICAgICAgICAgICAgJHNxbCA9ICRzZWxlY3QtPnNxbDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICRzcWwgPSAkdGhpcy0+ZGItPnNxbC0+U2VsZWN0KCR0aGlzLT50YWJsZVsnQ2F0ZWdvcnknXSwgJHNlbGVjdCwgJHdoZXJlLCAkb3JkZXIsICRsaW1pdCwgJG9wdGlvbik7DQogICAgICAgIH0NCg0KICAgICAgICAkYXJyYXkgPSAkdGhpcy0+R2V0TGlzdFR5cGUoJ0NhdGVnb3J5JywgJHNxbCk7DQogICAgICAgIGlmIChpc3NldCgkb3B0aW9uWydwYWdlYmFyJ10pICYmIGlzX29iamVjdCgkb3B0aW9uWydwYWdlYmFyJ10pKSB7DQogICAgICAgICAgICAkb3B0aW9uWydwYWdlYmFyJ10tPkN1cnJlbnRDb3VudCA9IGNvdW50KCRhcnJheSk7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJGFycmF5Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBwYXJhbSBtaXhlZCAkc2VsZWN0DQogICAgICogQHBhcmFtIG1peGVkICR3aGVyZQ0KICAgICAqIEBwYXJhbSBtaXhlZCAkb3JkZXINCiAgICAgKiBAcGFyYW0gbWl4ZWQgJGxpbWl0DQogICAgICogQHBhcmFtIG1peGVkICRvcHRpb24NCiAgICAgKg0KICAgICAqIEByZXR1cm4gTW9kdWxlW118QmFzZVtdDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldE1vZHVsZUxpc3QoJHNlbGVjdCA9IG51bGwsICR3aGVyZSA9IG51bGwsICRvcmRlciA9IG51bGwsICRsaW1pdCA9IG51bGwsICRvcHRpb24gPSBudWxsKQ0KICAgIHsNCiAgICAgICAgaWYgKGlzX29iamVjdCgkc2VsZWN0KSAmJiBnZXRfcGFyZW50X2NsYXNzKCRzZWxlY3QpID09ICdTUUxfX0dsb2JhbCcpIHsNCiAgICAgICAgICAgICRzcWwgPSAkc2VsZWN0LT5zcWw7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkc3FsID0gJHRoaXMtPmRiLT5zcWwtPlNlbGVjdCgkdGhpcy0+dGFibGVbJ01vZHVsZSddLCAkc2VsZWN0LCAkd2hlcmUsICRvcmRlciwgJGxpbWl0LCAkb3B0aW9uKTsNCiAgICAgICAgfQ0KDQogICAgICAgICRhcnJheSA9ICR0aGlzLT5HZXRMaXN0VHlwZSgnTW9kdWxlJywgJHNxbCk7DQogICAgICAgIGlmIChpc3NldCgkb3B0aW9uWydwYWdlYmFyJ10pICYmIGlzX29iamVjdCgkb3B0aW9uWydwYWdlYmFyJ10pKSB7DQogICAgICAgICAgICAkb3B0aW9uWydwYWdlYmFyJ10tPkN1cnJlbnRDb3VudCA9IGNvdW50KCRhcnJheSk7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJGFycmF5Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBwYXJhbSBtaXhlZCAkc2VsZWN0DQogICAgICogQHBhcmFtIG1peGVkICR3aGVyZQ0KICAgICAqIEBwYXJhbSBtaXhlZCAkb3JkZXINCiAgICAgKiBAcGFyYW0gbWl4ZWQgJGxpbWl0DQogICAgICogQHBhcmFtIG1peGVkICRvcHRpb24NCiAgICAgKg0KICAgICAqIEByZXR1cm4gVXBsb2FkW118QmFzZVtdDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFVwbG9hZExpc3QoJHNlbGVjdCA9IG51bGwsICR3aGVyZSA9IG51bGwsICRvcmRlciA9IG51bGwsICRsaW1pdCA9IG51bGwsICRvcHRpb24gPSBudWxsKQ0KICAgIHsNCiAgICAgICAgaWYgKGlzX29iamVjdCgkc2VsZWN0KSAmJiBnZXRfcGFyZW50X2NsYXNzKCRzZWxlY3QpID09ICdTUUxfX0dsb2JhbCcpIHsNCiAgICAgICAgICAgICRzcWwgPSAkc2VsZWN0LT5zcWw7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkc3FsID0gJHRoaXMtPmRiLT5zcWwtPlNlbGVjdCgkdGhpcy0+dGFibGVbJ1VwbG9hZCddLCAkc2VsZWN0LCAkd2hlcmUsICRvcmRlciwgJGxpbWl0LCAkb3B0aW9uKTsNCiAgICAgICAgfQ0KDQogICAgICAgICRhcnJheSA9ICR0aGlzLT5HZXRMaXN0VHlwZSgnVXBsb2FkJywgJHNxbCk7DQogICAgICAgIGlmIChpc3NldCgkb3B0aW9uWydwYWdlYmFyJ10pICYmIGlzX29iamVjdCgkb3B0aW9uWydwYWdlYmFyJ10pKSB7DQogICAgICAgICAgICAkb3B0aW9uWydwYWdlYmFyJ10tPkN1cnJlbnRDb3VudCA9IGNvdW50KCRhcnJheSk7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJGFycmF5Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h0lE5pWw57uE6I635Y+W5paH56ug5a6e5L6LLg0KICAgICAqDQogICAgICogQHBhcmFtIG1peGVkW10gJGFycmF5DQogICAgICoNCiAgICAgKiBAcmV0dXJuIFBvc3RbXXxCYXNlW10gUG9zdHMNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0UG9zdEJ5QXJyYXkoJGFycmF5LCAkZmllbGRfbmFtZSA9ICdJRCcpDQogICAgew0KICAgICAgICAkcG9zdHMgPSAkdGhpcy0+R2V0TGlzdFR5cGVCeUFycmF5KCdQb3N0JywgJGFycmF5LCAkZmllbGRfbmFtZSk7DQoNCiAgICAgICAgcmV0dXJuICRwb3N0czsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4dJROaVsOe7hOiOt+WPluivhOiuuuWunuS+iy4NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0Q29tbWVudEJ5QXJyYXkoJGFycmF5LCAkZmllbGRfbmFtZSA9ICdJRCcpDQogICAgew0KICAgICAgICAkcG9zdHMgPSAkdGhpcy0+R2V0TGlzdFR5cGVCeUFycmF5KCdDb21tZW50JywgJGFycmF5LCAkZmllbGRfbmFtZSk7DQoNCiAgICAgICAgcmV0dXJuICRwb3N0czsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4dJROaVsOe7hOiOt+WPlk1lbWJlcuWunuS+iy4NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0TWVtYmVyQnlBcnJheSgkYXJyYXksICRmaWVsZF9uYW1lID0gJ0lEJykNCiAgICB7DQogICAgICAgICRwb3N0cyA9ICR0aGlzLT5HZXRMaXN0VHlwZUJ5QXJyYXkoJ01lbWJlcicsICRhcnJheSwgJGZpZWxkX25hbWUpOw0KDQogICAgICAgIHJldHVybiAkcG9zdHM7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YCa6L+HSUTmlbDnu4Tojrflj5ZDYXRlZ29yeeWunuS+iy4NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0Q2F0ZWdvcnlCeUFycmF5KCRhcnJheSwgJGZpZWxkX25hbWUgPSAnSUQnKQ0KICAgIHsNCiAgICAgICAgJHBvc3RzID0gJHRoaXMtPkdldExpc3RUeXBlQnlBcnJheSgnQ2F0ZWdvcnknLCAkYXJyYXksICRmaWVsZF9uYW1lKTsNCg0KICAgICAgICByZXR1cm4gJHBvc3RzOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h0lE5pWw57uE6I635Y+WVGFn5a6e5L6LLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRUYWdCeUFycmF5KCRhcnJheSwgJGZpZWxkX25hbWUgPSAnSUQnKQ0KICAgIHsNCiAgICAgICAgJHBvc3RzID0gJHRoaXMtPkdldExpc3RUeXBlQnlBcnJheSgnVGFnJywgJGFycmF5LCAkZmllbGRfbmFtZSk7DQoNCiAgICAgICAgcmV0dXJuICRwb3N0czsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4dJROaVsOe7hOiOt+WPlk1vZHVsZeWunuS+iy4NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0TW9kdWxlQnlBcnJheSgkYXJyYXksICRmaWVsZF9uYW1lID0gJ0lEJykNCiAgICB7DQogICAgICAgICRwb3N0cyA9ICR0aGlzLT5HZXRMaXN0VHlwZUJ5QXJyYXkoJ01vZHVsZScsICRhcnJheSwgJGZpZWxkX25hbWUpOw0KDQogICAgICAgIHJldHVybiAkcG9zdHM7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YCa6L+HSUTmlbDnu4Tojrflj5ZVcGxvYWTlrp7kvosuDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFVwbG9hZEJ5QXJyYXkoJGFycmF5LCAkZmllbGRfbmFtZSA9ICdJRCcpDQogICAgew0KICAgICAgICAkcG9zdHMgPSAkdGhpcy0+R2V0TGlzdFR5cGVCeUFycmF5KCdVcGxvYWQnLCAkYXJyYXksICRmaWVsZF9uYW1lKTsNCg0KICAgICAgICByZXR1cm4gJHBvc3RzOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBwYXJhbSAkc3FsDQogICAgICoNCiAgICAgKiBAcmV0dXJuIG1peGVkDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIGdldF9yZXN1bHRzKCRzcWwpDQogICAgew0KICAgICAgICByZXR1cm4gJHRoaXMtPmRiLT5RdWVyeSgkc3FsKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmoLnmja7liKvlkI3lvpfliLDnm7jlupTmlbDmja4uDQogICAgICoNCiAgICAgKiBAcGFyYW0gQmFzZVtdfHN0cmluZyAmJG9iamVjdCAgIOe8k+WtmOWvueixoQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgICAgICAgICRjbGFzc05hbWUNCiAgICAgKiBAcGFyYW0gc3RyaW5nICAgICAgICAkdmFsDQogICAgICogQHBhcmFtIHN0cmluZyAgICAgICAgJGJhY2tBdHRyICDmjIflrprlrZfmrrXvvIzlpoLmnpzkuLpudWxs77yM5bCx55Sob3B0aW9uWydaQ19BTElBU19CQUNLX0FUVFInXQ0KICAgICAqDQogICAgICogQHJldHVybiBCYXNlfG51bGwNCiAgICAgKi8NCiAgICBwcml2YXRlIGZ1bmN0aW9uIEdldFNvbWVUaGluZ0J5QWxpYXNPck5hbWUoJG9iamVjdCwgJGNsYXNzTmFtZSwgJHZhbCwgJGJhY2tBdHRyID0gbnVsbCkNCiAgICB7DQogICAgICAgICRyZXQgPSAkdGhpcy0+R2V0U29tZVRoaW5nKCRvYmplY3QsICdBbGlhcycsICR2YWwsICRjbGFzc05hbWUpOw0KDQogICAgICAgIGlmICghaXNfbnVsbCgkcmV0KSkgew0KICAgICAgICAgICAgcmV0dXJuICRyZXQ7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBpZiAoaXNfbnVsbCgkYmFja0F0dHIpKSB7DQogICAgICAgICAgICAgICAgJGJhY2tBdHRyID0gJHRoaXMtPm9wdGlvblsnWkNfQUxJQVNfQkFDS19BVFRSJ107DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+R2V0U29tZVRoaW5nKCRvYmplY3QsICRiYWNrQXR0ciwgJHZhbCwgJGNsYXNzTmFtZSk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmoLnmja5JROW+l+WIsOebuOW6lOaVsOaNri4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBCYXNlW10gICAgICYkb2JqZWN0ICAg57yT5a2Y5a+56LGhDQogICAgICogQHBhcmFtIHN0cmluZyAgICAgJGNsYXNzTmFtZSDmib7kuI3liLBJROaXtuWIneWni+WMluWvueixoeeahOexu+WQjQ0KICAgICAqIEBwYXJhbSBpbnR8c3RyaW5nICRpZCAgICAgICAg5LiO5q2k57G755u45YWz55qESUQNCiAgICAgKg0KICAgICAqIEByZXR1cm4gQmFzZXxudWxsDQogICAgICovDQogICAgcHJpdmF0ZSBmdW5jdGlvbiBHZXRTb21lVGhpbmdCeUlkKCYkb2JqZWN0LCAkY2xhc3NOYW1lLCAkaWQpDQogICAgew0KICAgICAgICBpZiAoZW1wdHkoJGlkKSkgew0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKGFycmF5X2tleV9leGlzdHMoJGlkLCAkb2JqZWN0KSkgew0KICAgICAgICAgICAgcmV0dXJuICRvYmplY3RbJGlkXTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICRwID0gbmV3ICRjbGFzc05hbWUoKTsNCiAgICAgICAgICAgIGlmICgkcC0+TG9hZEluZm9CeUlEKCRpZCkpIHsNCiAgICAgICAgICAgICAgICBpZiAoaXNfc3ViY2xhc3Nfb2YoJGNsYXNzTmFtZSwgJ0Jhc2VQb3N0JykgPT0gdHJ1ZSkgew0KICAgICAgICAgICAgICAgICAgICAkbmV3dHlwZSA9ICR0aGlzLT5HZXRQb3N0VHlwZV9DbGFzc05hbWUoJHAtPlR5cGUpOw0KICAgICAgICAgICAgICAgICAgICBpZiAoJG5ld3R5cGUgIT0gJGNsYXNzTmFtZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgJHAgPSAkcC0+Q2xvbmVkKHRydWUsICRuZXd0eXBlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAkdGhpcy0+QWRkQ2FjaGUoJHApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gJHA7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmoLnmja7lsZ7mgKflgLzlvpfliLDnm7jlupTmlbDmja4uDQogICAgICoNCiAgICAgKiBAcGFyYW0gQmFzZVtdICYkb2JqZWN0IOe8k+WtmOWvueixoQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgICAgICAgICRjbGFzc05hbWUg5a+56LGh5pyq5om+5Yiw5pe277yM5Yid5aeL5YyW57G75ZCNDQogICAgICogQHBhcmFtIHN0cmluZyAkYXR0ciAgICDlsZ7mgKflkI0NCiAgICAgKiBAcGFyYW0gbWl4ZWQgICR2YWwgICAgIOimgeafpeaJvueahOWAvA0KICAgICAqDQogICAgICogQHJldHVybiBudWxsDQogICAgICovDQogICAgcHJpdmF0ZSBmdW5jdGlvbiBHZXRTb21lVGhpbmdCeUF0dHIoJiRvYmplY3QsICRjbGFzc05hbWUsICRhdHRyLCAkdmFsKQ0KICAgIHsNCiAgICAgICAgJGNhY2hlT2JqZWN0ID0gbnVsbDsNCiAgICAgICAgaWYgKGlzX2FycmF5KCRvYmplY3QpKSB7DQogICAgICAgICAgICAkY2FjaGVPYmplY3QgPSAmJG9iamVjdDsNCiAgICAgICAgfSBlbHNlaWYgKCRjbGFzc05hbWUgIT0gJycpIHsNCiAgICAgICAgICAgICRjYWNoZU9iamVjdCA9ICYkdGhpcy0+R2V0Q2FjaGUoJGNsYXNzTmFtZSk7DQogICAgICAgIH0NCg0KICAgICAgICAvL+WmguaenOaYr+WkmumHjeWxnuaAp+WSjOWAvOafpeivog0KICAgICAgICBpZiAoaXNfYXJyYXkoJGF0dHIpICYmIGlzX2FycmF5KCR2YWwpKSB7DQogICAgICAgICAgICAkdmFsMSA9IHRyaW0oJHZhbFswXSk7DQogICAgICAgICAgICAkdmFsMiA9IHRyaW0oJHZhbFsxXSk7DQogICAgICAgICAgICAkdmFsMyA9IGlzc2V0KCR2YWxbMl0pID8gJHZhbFsyXSA6IG51bGw7DQogICAgICAgICAgICAkYXR0cjEgPSAkYXR0clswXTsNCiAgICAgICAgICAgICRhdHRyMiA9ICRhdHRyWzFdOw0KICAgICAgICAgICAgJGF0dHIzID0gaXNzZXQoJGF0dHJbMl0pID8gJGF0dHJbMl0gOiBudWxsOw0KICAgICAgICAgICAgZm9yZWFjaCAoJGNhY2hlT2JqZWN0IGFzICRrZXkgPT4gJiR2YWx1ZSkgew0KICAgICAgICAgICAgICAgIGlmIChpc19udWxsKCR2YWx1ZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmICgkYXR0cjMgIT09IG51bGwgJiYgJHZhbHVlLT4kYXR0cjEgPT0gJHZhbDEgJiYgJHZhbHVlLT4kYXR0cjIgPT0gJHZhbDIgJiYgJHZhbHVlLT4kYXR0cjMgPT0gJHZhbDMpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICR2YWx1ZTsNCiAgICAgICAgICAgICAgICB9IGVsc2VpZiAoJHZhbHVlLT4kYXR0cjEgPT0gJHZhbDEgJiYgJHZhbHVlLT4kYXR0cjIgPT0gJHZhbDIpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICR2YWx1ZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkdmFsID0gdHJpbSgkdmFsKTsNCiAgICAgICAgICAgIGZvcmVhY2ggKCRjYWNoZU9iamVjdCBhcyAka2V5ID0+ICYkdmFsdWUpIHsNCiAgICAgICAgICAgICAgICBpZiAoaXNfbnVsbCgkdmFsdWUpKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoJHZhbHVlLT4kYXR0ciA9PSAkdmFsKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiAkdmFsdWU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6I635Y+W5pWw5o2u6YCa55So5Ye95pWwLg0KICAgICAqDQogICAgICogQHBhcmFtIEJhc2VbXXxzdHJpbmcgJG9iamVjdCAgICDnvJPlrZjlr7nosaHvvIhzdHJpbmcgLyBvYmplY3TvvIkNCiAgICAgKiBAcGFyYW0gc3RyaW5nICAgICAgICAkYXR0ciAgICAgIOassuafpeaJvueahOWxnuaApw0KICAgICAqIEBwYXJhbSBtaXhlZCAgICAgICAgICR2YWwgICAgICAg6KaB5p+l5om+5YaF5a65DQogICAgICogQHBhcmFtIHN0cmluZyAgICAgICAgJGNsYXNzTmFtZSDlr7nosaHmnKrmib7liLDml7bvvIzliJ3lp4vljJbnsbvlkI0NCiAgICAgKg0KICAgICAqIEByZXR1cm4gQmFzZXxudWxsDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFNvbWVUaGluZygkb2JqZWN0LCAkYXR0ciwgJHZhbCwgJGNsYXNzTmFtZSkNCiAgICB7DQogICAgICAgICRjYWNoZU9iamVjdCA9IG51bGw7DQogICAgICAgIGlmIChpc19hcnJheSgkb2JqZWN0KSkgew0KICAgICAgICAgICAgJGNhY2hlT2JqZWN0ID0gJiRvYmplY3Q7DQogICAgICAgIH0gZWxzZWlmIChwcm9wZXJ0eV9leGlzdHMoJHRoaXMsICRvYmplY3QpKSB7DQogICAgICAgICAgICAkY2FjaGVPYmplY3QgPSAmJHRoaXMtPiRvYmplY3Q7DQogICAgICAgIH0gZWxzZWlmICgkY2xhc3NOYW1lICE9ICcnKSB7DQogICAgICAgICAgICAkY2FjaGVPYmplY3QgPSAmJHRoaXMtPkdldENhY2hlKCRjbGFzc05hbWUpOw0KICAgICAgICB9DQogICAgICAgIGlmICgkYXR0ciA9PSAnSUQnKSB7DQogICAgICAgICAgICAkcmV0ID0gJHRoaXMtPkdldFNvbWVUaGluZ0J5SWQoJGNhY2hlT2JqZWN0LCAkY2xhc3NOYW1lLCAkdmFsKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICRyZXQgPSAkdGhpcy0+R2V0U29tZVRoaW5nQnlBdHRyKCRjYWNoZU9iamVjdCwgJGNsYXNzTmFtZSwgJGF0dHIsICR2YWwpOw0KICAgICAgICB9DQogICAgICAgIGlmICgkcmV0ID09PSBudWxsICYmICFpc19udWxsKCRjbGFzc05hbWUpKSB7DQogICAgICAgICAgICAvKiogQHZhciBCYXNlICRyZXQgKi8NCiAgICAgICAgICAgICRyZXQgPSBuZXcgJGNsYXNzTmFtZSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICRyZXQ7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YCa6L+HSUTojrflj5bmlofnq6Dlrp7kvosuDQogICAgICoNCiAgICAgKiBAcGFyYW0gaW50ICRpZA0KICAgICAqDQogICAgICogQHJldHVybiBQb3N0fEJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0UG9zdEJ5SUQoJGlkKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuICR0aGlzLT5HZXRTb21lVGhpbmcoJHRoaXMtPkdldENhY2hlKCdQb3N0JyksICdJRCcsICRpZCwgJ1Bvc3QnKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4dJROiOt+WPluWIhuexu+WunuS+iy4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBpbnQgJGlkDQogICAgICoNCiAgICAgKiBAcmV0dXJuIENhdGVnb3J5fEJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0Q2F0ZWdvcnlCeUlEKCRpZCkNCiAgICB7DQogICAgICAgIHJldHVybiAkdGhpcy0+R2V0U29tZVRoaW5nKCR0aGlzLT5HZXRDYWNoZSgnQ2F0ZWdvcnknKSwgJ0lEJywgJGlkLCAnQ2F0ZWdvcnknKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4fliIbnsbvlkI3ojrflj5bliIbnsbvlrp7kvosuDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRuYW1lDQogICAgICoNCiAgICAgKiBAcmV0dXJuIENhdGVnb3J5fEJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0Q2F0ZWdvcnlCeU5hbWUoJG5hbWUsICR0eXBlID0gMCkNCiAgICB7DQogICAgICAgIGlmICgkdHlwZSA9PT0gbnVsbCkgew0KICAgICAgICAgICAgJGNhdGVnb3J5cyA9ICYkdGhpcy0+Y2F0ZWdvcmllc19hbGw7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkY2F0ZWdvcnlzID0gJiR0aGlzLT5jYXRlZ29yaWVzYnlvcmRlcl90eXBlWyR0eXBlXTsNCiAgICAgICAgfQ0KICAgICAgICBmb3JlYWNoICgkY2F0ZWdvcnlzIGFzICRrZXkgPT4gJGMpIHsNCiAgICAgICAgICAgIGlmICgkbmFtZSA9PSAkYy0+TmFtZSkgew0KICAgICAgICAgICAgICAgIHJldHVybiAkYzsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gbmV3IENhdGVnb3J5Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h+WIhuexu+WIq+WQjeiOt+WPluWIhuexu+WunuS+iy4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUNCiAgICAgKiBAcGFyYW0gbnVsbCAgICRiYWNrS2V5DQogICAgICoNCiAgICAgKiBAcmV0dXJuIENhdGVnb3J5fEJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0Q2F0ZWdvcnlCeUFsaWFzKCRuYW1lLCAkdHlwZSA9IDApDQogICAgew0KICAgICAgICBpZiAoJHR5cGUgPT09IG51bGwpIHsNCiAgICAgICAgICAgICRjYXRlZ29yeXMgPSAmJHRoaXMtPmNhdGVnb3JpZXNfYWxsOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJGNhdGVnb3J5cyA9ICYkdGhpcy0+Y2F0ZWdvcmllc2J5b3JkZXJfdHlwZVskdHlwZV07DQogICAgICAgIH0NCiAgICAgICAgZm9yZWFjaCAoJGNhdGVnb3J5cyBhcyAka2V5ID0+ICRjKSB7DQogICAgICAgICAgICBpZiAoJG5hbWUgPT0gJGMtPkFsaWFzKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICRjOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHJldHVybiBuZXcgQ2F0ZWdvcnk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5LiO6ICB54mI5pys5L+d5oyB5YW85a655Ye95pWwLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbmFtZQ0KICAgICAqDQogICAgICogQHJldHVybiBDYXRlZ29yeQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRDYXRlZ29yeUJ5QWxpYXNPck5hbWUoJG5hbWUsICR0eXBlID0gMCkNCiAgICB7DQogICAgICAgIGlmICgkdHlwZSA9PT0gbnVsbCkgew0KICAgICAgICAgICAgJGNhdGVnb3J5cyA9ICYkdGhpcy0+Y2F0ZWdvcmllc19hbGw7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkY2F0ZWdvcnlzID0gJiR0aGlzLT5jYXRlZ29yaWVzYnlvcmRlcl90eXBlWyR0eXBlXTsNCiAgICAgICAgfQ0KICAgICAgICBmb3JlYWNoICgkY2F0ZWdvcnlzIGFzICRrZXkgPT4gJGMpIHsNCiAgICAgICAgICAgIGlmICgkbmFtZSA9PSAkYy0+QWxpYXMgfHwgJG5hbWUgPT0gJGMtPk5hbWUpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gJGM7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIG5ldyBDYXRlZ29yeTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4dJROiOt+WPluaooeWdl+WunuS+iy4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBpbnQgJGlkDQogICAgICoNCiAgICAgKiBAcmV0dXJuIE1vZHVsZXxCYXNlDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldE1vZHVsZUJ5SUQoJGlkKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuICR0aGlzLT5HZXRTb21lVGhpbmcoJHRoaXMtPkdldENhY2hlKCdNb2R1bGUnKSwgJ0lEJywgJGlkLCAnTW9kdWxlJyk7IC8vIFdoYXQgdGhlIGZ1Y2s/DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YCa6L+HRmlsZU5hbWXojrflj5bmqKHlnZflrp7kvosuDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRmbg0KICAgICAqDQogICAgICogQHJldHVybiBNb2R1bGV8QmFzZQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRNb2R1bGVCeUZpbGVOYW1lKCRmbikNCiAgICB7DQogICAgICAgIHJldHVybiAkdGhpcy0+R2V0U29tZVRoaW5nKCdtb2R1bGVzYnlmaWxlbmFtZScsICdGaWxlTmFtZScsICRmbiwgJ01vZHVsZScpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h0lE6I635Y+W55So5oi35a6e5L6LLg0KICAgICAqDQogICAgICogQHBhcmFtIGludCAkaWQNCiAgICAgKg0KICAgICAqIEByZXR1cm4gTWVtYmVyfEJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0TWVtYmVyQnlJRCgkaWQpDQogICAgew0KICAgICAgICAvKiogQHZhciBNZW1iZXIgJHJldCAqLw0KICAgICAgICAkcmV0ID0gJHRoaXMtPkdldFNvbWVUaGluZygkdGhpcy0+R2V0Q2FjaGUoJ01lbWJlcicpLCAnSUQnLCAkaWQsICdNZW1iZXInKTsNCiAgICAgICAgaWYgKCRyZXQtPklEID09IG51bGwpIHsNCiAgICAgICAgICAgICRyZXQtPkd1aWQgPSBHZXRHdWlkKCk7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJHJldDsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4fnlKjmiLflkI3ojrflj5bnlKjmiLflrp7kvoso5LiN5Yy65YiG5aSn5bCP5YaZKS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUNCiAgICAgKg0KICAgICAqIEByZXR1cm4gTWVtYmVyfEJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0TWVtYmVyQnlOYW1lKCRuYW1lKQ0KICAgIHsNCiAgICAgICAgJG5hbWUgPSB0cmltKCRuYW1lKTsNCiAgICAgICAgaWYgKCEkbmFtZSB8fCAhQ2hlY2tSZWdFeHAoJG5hbWUsICdbdXNlcm5hbWVdJykpIHsNCiAgICAgICAgICAgIHJldHVybiBuZXcgTWVtYmVyKCk7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoaXNzZXQoJHRoaXMtPm1lbWJlcnNieW5hbWVbJG5hbWVdKSkgew0KICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5tZW1iZXJzYnluYW1lWyRuYW1lXTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICRhcnJheSA9IGFycmF5X2tleXMoJHRoaXMtPm1lbWJlcnNieW5hbWUpOw0KICAgICAgICAgICAgZm9yZWFjaCAoJGFycmF5IGFzICRrID0+ICR2KSB7DQogICAgICAgICAgICAgICAgaWYgKHN0cmNhc2VjbXAoJG5hbWUsICR2KSA9PSAwKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiAkdGhpcy0+bWVtYmVyc2J5bmFtZVskdl07DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgJGxpa2UgPSAoJHRoaXMtPmRiLT50eXBlID09ICdwZ3NxbCcpID8gJ0lMSUtFJyA6ICdMSUtFJzsNCiAgICAgICAgJHNxbCA9ICR0aGlzLT5kYi0+c3FsLT5TZWxlY3QoJHRoaXMtPnRhYmxlWydNZW1iZXInXSwgJyonLCBhcnJheShhcnJheSgkbGlrZSwgJ21lbV9OYW1lJywgJG5hbWUpKSwgYXJyYXkoJ21lbV9JRCcgPT4gJ0FTQycpLCAxLCBudWxsKTsNCg0KICAgICAgICAvKiogQHZhciBNZW1iZXJbXSAkYW0gKi8NCiAgICAgICAgJGFtID0gJHRoaXMtPkdldExpc3RUeXBlKCdNZW1iZXInLCAkc3FsKTsNCiAgICAgICAgaWYgKGNvdW50KCRhbSkgPiAwKSB7DQogICAgICAgICAgICAkbSA9ICRhbVswXTsNCg0KICAgICAgICAgICAgcmV0dXJuICRtOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIG5ldyBNZW1iZXIoKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4fojrflj5bnlKjmiLflkI3miJbliKvlkI3lrp7kvoso5LiN5Yy65YiG5aSn5bCP5YaZKS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUNCiAgICAgKg0KICAgICAqIEByZXR1cm4gTWVtYmVyfEJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0TWVtYmVyQnlOYW1lT3JBbGlhcygkbmFtZSkNCiAgICB7DQogICAgICAgICRuYW1lID0gdHJpbSgkbmFtZSk7DQogICAgICAgIGlmICghJG5hbWUgfHwgIShDaGVja1JlZ0V4cCgkbmFtZSwgJ1t1c2VybmFtZV0nKSB8fCBDaGVja1JlZ0V4cCgkbmFtZSwgJ1tuaWNrbmFtZV0nKSkpIHsNCiAgICAgICAgICAgIHJldHVybiBuZXcgTWVtYmVyKCk7DQogICAgICAgIH0NCg0KICAgICAgICBmb3JlYWNoICgkdGhpcy0+bWVtYmVycyBhcyAka2V5ID0+ICYkdmFsdWUpIHsNCiAgICAgICAgICAgIGlmIChzdHJjYXNlY21wKCR2YWx1ZS0+TmFtZSwgJG5hbWUpID09IDAgfHwgc3RyY2FzZWNtcCgkdmFsdWUtPkFsaWFzLCAkbmFtZSkgPT0gMCkgew0KICAgICAgICAgICAgICAgIHJldHVybiAkdmFsdWU7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAkbGlrZSA9ICgkdGhpcy0+ZGItPnR5cGUgPT0gJ3Bnc3FsJykgPyAnSUxJS0UnIDogJ0xJS0UnOw0KDQogICAgICAgICRzcWwgPSAkdGhpcy0+ZGItPnNxbC0+Z2V0KCktPnNlbGVjdCgkdGhpcy0+dGFibGVbJ01lbWJlciddKS0+d2hlcmUoDQogICAgICAgICAgICBhcnJheSgNCiAgICAgICAgICAgICAgICAiJGxpa2UgYXJyYXkiLCBhcnJheSgNCiAgICAgICAgICAgICAgICAgICAgYXJyYXkoJ21lbV9OYW1lJywgJG5hbWUpLA0KICAgICAgICAgICAgICAgICAgICBhcnJheSgnbWVtX0FsaWFzJywgJG5hbWUpLA0KICAgICAgICAgICAgICAgICkNCiAgICAgICAgICAgICkNCiAgICAgICAgKS0+b3JkZXJCeShhcnJheSgnbWVtX0lEJyA9PiAnYXNjJykpLT5saW1pdCgxKS0+c3FsOw0KDQogICAgICAgIC8qKiBAdmFyIE1lbWJlcltdICRhbSAqLw0KICAgICAgICAkYW0gPSAkdGhpcy0+R2V0TGlzdFR5cGUoJ01lbWJlcicsICRzcWwpOw0KICAgICAgICBpZiAoY291bnQoJGFtKSA+IDApIHsNCiAgICAgICAgICAgICRtID0gJGFtWzBdOw0KDQogICAgICAgICAgICByZXR1cm4gJG07DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gbmV3IE1lbWJlcigpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h+iOt+WPlueUqOaIt+eahOWIq+WQjeeahOWunuS+iyjkuI3ljLrliIblpKflsI/lhpkpLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbmFtZQ0KICAgICAqDQogICAgICogQHJldHVybiBNZW1iZXJ8QmFzZQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRNZW1iZXJCeUFsaWFzKCRuYW1lKQ0KICAgIHsNCiAgICAgICAgJG5hbWUgPSB0cmltKCRuYW1lKTsNCiAgICAgICAgaWYgKCEkbmFtZSB8fCAhKENoZWNrUmVnRXhwKCRuYW1lLCAnW25pY2tuYW1lXScpKSkgew0KICAgICAgICAgICAgcmV0dXJuIG5ldyBNZW1iZXIoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGZvcmVhY2ggKCR0aGlzLT5tZW1iZXJzIGFzICRrZXkgPT4gJiR2YWx1ZSkgew0KICAgICAgICAgICAgaWYgKHN0cmNhc2VjbXAoJHZhbHVlLT5BbGlhcywgJG5hbWUpID09IDApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gJHZhbHVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgJGxpa2UgPSAoJHRoaXMtPmRiLT50eXBlID09ICdwZ3NxbCcpID8gJ0lMSUtFJyA6ICdMSUtFJzsNCg0KICAgICAgICAkc3FsID0gJHRoaXMtPmRiLT5zcWwtPmdldCgpLT5zZWxlY3QoJHRoaXMtPnRhYmxlWydNZW1iZXInXSktPndoZXJlKA0KICAgICAgICAgICAgYXJyYXkoDQogICAgICAgICAgICAgICAgYXJyYXkoJz0nLCAnbWVtX0FsaWFzJywgJG5hbWUpDQogICAgICAgICAgICApDQogICAgICAgICktPm9yZGVyQnkoYXJyYXkoJ21lbV9JRCcgPT4gJ2FzYycpKS0+bGltaXQoMSktPnNxbDsNCg0KICAgICAgICAvKiogQHZhciBNZW1iZXJbXSAkYW0gKi8NCiAgICAgICAgJGFtID0gJHRoaXMtPkdldExpc3RUeXBlKCdNZW1iZXInLCAkc3FsKTsNCiAgICAgICAgaWYgKGNvdW50KCRhbSkgPiAwKSB7DQogICAgICAgICAgICAkbSA9ICRhbVswXTsNCg0KICAgICAgICAgICAgcmV0dXJuICRtOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIG5ldyBNZW1iZXIoKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4fpgq7nrrHlkI3ojrflj5bnlKjmiLflrp7kvoso5LiN5Yy65YiG5aSn5bCP5YaZKS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJGVtYWlsDQogICAgICoNCiAgICAgKiBAcmV0dXJuIE1lbWJlcg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRNZW1iZXJCeUVtYWlsKCRlbWFpbCkNCiAgICB7DQogICAgICAgICRlbWFpbCA9IHN0cnRvbG93ZXIodHJpbSgkZW1haWwpKTsNCiAgICAgICAgaWYgKCEkZW1haWwgfHwgIUNoZWNrUmVnRXhwKCRlbWFpbCwgJ1tlbWFpbF0nKSkgew0KICAgICAgICAgICAgcmV0dXJuIG5ldyBNZW1iZXIoKTsNCiAgICAgICAgfQ0KDQogICAgICAgICRzcWwgPSAkdGhpcy0+ZGItPnNxbC0+U2VsZWN0KCR0aGlzLT50YWJsZVsnTWVtYmVyJ10sICcqJywgYXJyYXkoYXJyYXkoJ0xJS0UnLCAnbWVtX0VtYWlsJywgJGVtYWlsKSksIG51bGwsIDEsIG51bGwpOw0KICAgICAgICAvKiogQHZhciBNZW1iZXJbXSAkYW0gKi8NCiAgICAgICAgJGFtID0gJHRoaXMtPkdldExpc3RUeXBlKCdNZW1iZXInLCAkc3FsKTsNCiAgICAgICAgaWYgKGNvdW50KCRhbSkgPiAwKSB7DQogICAgICAgICAgICAkbSA9ICRhbVswXTsNCg0KICAgICAgICAgICAgcmV0dXJuICRtOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIG5ldyBNZW1iZXIoKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmo4Dmn6XmjIflrprlkI3np7DnmoTnlKjmiLfmmK/lkKblrZjlnKgo5LiN5Yy65YiG5aSn5bCP5YaZKS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSAkbmFtZQ0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIENoZWNrTWVtYmVyTmFtZUV4aXN0KCRuYW1lKQ0KICAgIHsNCiAgICAgICAgJG0gPSAkdGhpcy0+R2V0TWVtYmVyQnlOYW1lKCRuYW1lKTsNCg0KICAgICAgICByZXR1cm4gJG0tPklEICE9IG51bGw7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5qOA5p+l5oyH5a6a5ZCN56ew5oiW5Yir5ZCN55qE55So5oi35piv5ZCm5a2Y5ZyoKOS4jeWMuuWIhuWkp+Wwj+WGmSkuDQogICAgICoNCiAgICAgKiBAcGFyYW0gJG5hbWUNCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBDaGVja01lbWJlckJ5TmFtZU9yQWxpYXNFeGlzdCgkbmFtZSkNCiAgICB7DQogICAgICAgICRtID0gJHRoaXMtPkdldE1lbWJlckJ5TmFtZU9yQWxpYXMoJG5hbWUpOw0KDQogICAgICAgIHJldHVybiAkbS0+SUQgPiAwOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOajgOafpeaMh+WumumCrueuseeahOeUqOaIt+aYr+WQpuWtmOWcqCjkuI3ljLrliIblpKflsI/lhpkpLg0KICAgICAqDQogICAgICogQHBhcmFtICRlbWFpbA0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIENoZWNrTWVtYmVyQnlFbWFpbEV4aXN0KCRlbWFpbCkNCiAgICB7DQogICAgICAgICRtID0gJHRoaXMtPkdldE1lbWJlckJ5RW1haWwoJGVtYWlsKTsNCg0KICAgICAgICByZXR1cm4gJG0tPklEID4gMDsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4dJROiOt+WPluivhOiuuuWunuS+iy4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBpbnQgJGlkDQogICAgICoNCiAgICAgKiBAcmV0dXJuIENvbW1lbnR8QmFzZQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRDb21tZW50QnlJRCgkaWQpDQogICAgew0KICAgICAgICByZXR1cm4gJHRoaXMtPkdldFNvbWVUaGluZygkdGhpcy0+R2V0Q2FjaGUoJ0NvbW1lbnQnKSwgJ0lEJywgJGlkLCAnQ29tbWVudCcpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h0lE6I635Y+W6ZmE5Lu25a6e5L6LLg0KICAgICAqDQogICAgICogQHBhcmFtIGludCAkaWQNCiAgICAgKg0KICAgICAqIEByZXR1cm4gVXBsb2FkfEJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0VXBsb2FkQnlJRCgkaWQpDQogICAgew0KICAgICAgICByZXR1cm4gJHRoaXMtPkdldFNvbWVUaGluZygkdGhpcy0+R2V0Q2FjaGUoJ1VwbG9hZCcpLCAnSUQnLCAkaWQsICdVcGxvYWQnKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4d0YWfliKvlkI3ojrflj5Z0YWflrp7kvosuKOWFiOi1sGNhY2hlb2JqZWN05YaN6LWw5p+l5pWw5o2u5bqTKQ0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbmFtZQ0KICAgICAqIEBwYXJhbSBudWxsICAgJGJhY2tLZXkNCiAgICAgKg0KICAgICAqIEByZXR1cm4gVGFnfEJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0VGFnQnlBbGlhcygkbmFtZSwgJHR5cGUgPSAwKQ0KICAgIHsNCiAgICAgICAgJHJldCA9ICR0aGlzLT5HZXRTb21lVGhpbmdCeUF0dHIoJHRoaXMtPnRhZ3NfYWxsLCAnVGFnJywgYXJyYXkoJ0FsaWFzJywgJ1R5cGUnKSwgYXJyYXkoJG5hbWUsICR0eXBlKSk7DQogICAgICAgIGlmIChpc19vYmplY3QoJHJldCkgJiYgJHJldC0+SUQgPj0gMCkgew0KICAgICAgICAgICAgcmV0dXJuICRyZXQ7DQogICAgICAgIH0NCg0KICAgICAgICAkYSA9IGFycmF5KCk7DQogICAgICAgICRhW10gPSBhcnJheSgnPScsICd0YWdfQWxpYXMnLCAkbmFtZSk7DQogICAgICAgICRhW10gPSBhcnJheSgnPScsICd0YWdfVHlwZScsICR0eXBlKTsNCiAgICAgICAgJGFycmF5ID0gJHRoaXMtPkdldFRhZ0xpc3QoJyonLCBhcnJheSgkYSksICcnLCAxLCAnJyk7DQogICAgICAgIGlmIChjb3VudCgkYXJyYXkpID09IDApIHsNCiAgICAgICAgICAgIHJldHVybiBuZXcgVGFnKCk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICByZXR1cm4gJGFycmF5WzBdOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YCa6L+HdGFn5ZCN6I635Y+WdGFn5a6e5L6LLijlhYjotbBjYWNoZW9iamVjdOWGjei1sOafpeaVsOaNruW6kykNCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUNCiAgICAgKiBAcGFyYW0gbnVsbCAgICRiYWNrS2V5DQogICAgICoNCiAgICAgKiBAcmV0dXJuIFRhZ3xCYXNlDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFRhZ0J5TmFtZSgkbmFtZSwgJHR5cGUgPSAwKQ0KICAgIHsNCiAgICAgICAgJHJldCA9ICR0aGlzLT5HZXRTb21lVGhpbmdCeUF0dHIoJHRoaXMtPnRhZ3NfYWxsLCAnVGFnJywgYXJyYXkoJ05hbWUnLCAnVHlwZScpLCBhcnJheSgkbmFtZSwgJHR5cGUpKTsNCiAgICAgICAgaWYgKGlzX29iamVjdCgkcmV0KSAmJiAkcmV0LT5JRCA+PSAwKSB7DQogICAgICAgICAgICByZXR1cm4gJHJldDsNCiAgICAgICAgfQ0KDQogICAgICAgICRhID0gYXJyYXkoKTsNCiAgICAgICAgJGFbXSA9IGFycmF5KCc9JywgJ3RhZ19OYW1lJywgJG5hbWUpOw0KICAgICAgICAkYVtdID0gYXJyYXkoJz0nLCAndGFnX1R5cGUnLCAkdHlwZSk7DQogICAgICAgICRhcnJheSA9ICR0aGlzLT5HZXRUYWdMaXN0KCcqJywgYXJyYXkoJGEpLCAnJywgMSwgJycpOw0KICAgICAgICBpZiAoY291bnQoJGFycmF5KSA9PSAwKSB7DQogICAgICAgICAgICByZXR1cm4gbmV3IFRhZygpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgcmV0dXJuICRhcnJheVswXTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h3RhZ+eahOWIq+WQjeaIluaYr+WQjeensOiOt+WPlnRhZ+WunuS+iy4o5p+l5pWw5o2u5bqT6Z2e6LWwY2FjaGVvYmplY3QpDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRuYW1lDQogICAgICoNCiAgICAgKiBAcmV0dXJuIFRhZ3xCYXNlDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFRhZ0J5QWxpYXNPck5hbWUoJG5hbWUsICR0eXBlID0gMCkNCiAgICB7DQogICAgICAgIC8vcmV0dXJuICR0aGlzLT5HZXRUYWdCeUFsaWFzKCRuYW1lLCAnTmFtZScpOw0KICAgICAgICAkYSA9IGFycmF5KCk7DQogICAgICAgICRhW10gPSBhcnJheSgndGFnX0FsaWFzJywgJG5hbWUpOw0KICAgICAgICAkYVtdID0gYXJyYXkoJ3RhZ19OYW1lJywgJG5hbWUpOw0KICAgICAgICAkYiA9IGFycmF5KCc9JywgJ3RhZ19UeXBlJywgJHR5cGUpOw0KICAgICAgICAkYXJyYXkgPSAkdGhpcy0+R2V0VGFnTGlzdCgnKicsIGFycmF5KGFycmF5KCdhcnJheScsICRhKSwgJGIpLCAnJywgMSwgJycpOw0KICAgICAgICBpZiAoY291bnQoJGFycmF5KSA9PSAwKSB7DQogICAgICAgICAgICByZXR1cm4gbmV3IFRhZygpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgcmV0dXJuICRhcnJheVswXTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h0lE6I635Y+WdGFn5a6e5L6LLg0KICAgICAqDQogICAgICogQHBhcmFtIGludCAkaWQNCiAgICAgKg0KICAgICAqIEByZXR1cm4gVGFnfEJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0VGFnQnlJRCgkaWQpDQogICAgew0KICAgICAgICAkcmV0ID0gJHRoaXMtPkdldFNvbWVUaGluZygkdGhpcy0+R2V0Q2FjaGUoJ1RhZycpLCAnSUQnLCAkaWQsICdUYWcnKTsNCg0KICAgICAgICByZXR1cm4gJHJldDsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4fnsbvkvLwnezF9ezJ9ezN9ezR9J+i9veWFpXRhZ3MuDQogICAgICoNCiAgICAgKiBAcGFyYW0gJHMNCiAgICAgKg0KICAgICAqIEByZXR1cm4gYXJyYXkNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gTG9hZFRhZ3NCeUlEU3RyaW5nKCRzKQ0KICAgIHsNCiAgICAgICAgJHMgPSB0cmltKCRzKTsNCiAgICAgICAgaWYgKCRzID09PSAnJykgew0KICAgICAgICAgICAgcmV0dXJuIGFycmF5KCk7DQogICAgICAgIH0NCg0KICAgICAgICAkcyA9IHN0cl9yZXBsYWNlKCd9eycsICd8JywgJHMpOw0KICAgICAgICAkcyA9IHN0cl9yZXBsYWNlKGFycmF5KCd7JywgJ30nKSwgJycsICRzKTsNCiAgICAgICAgJGEgPSBleHBsb2RlKCd8JywgJHMpOw0KICAgICAgICAkYiA9IGFycmF5KCk7DQogICAgICAgIGZvcmVhY2ggKCRhIGFzICYkdmFsdWUpIHsNCiAgICAgICAgICAgICR2YWx1ZSA9IHRyaW0oJHZhbHVlKTsNCiAgICAgICAgICAgIGlmICgkdmFsdWUpIHsNCiAgICAgICAgICAgICAgICAkYltdID0gJHZhbHVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgICR0ID0gYXJyYXlfdW5pcXVlKCRiKTsNCg0KICAgICAgICBpZiAoY291bnQoJHQpID09PSAwKSB7DQogICAgICAgICAgICByZXR1cm4gYXJyYXkoKTsNCiAgICAgICAgfQ0KDQogICAgICAgICRjID0gYXJyYXkoKTsNCiAgICAgICAgJGQgPSBhcnJheSgpOw0KICAgICAgICBmb3JlYWNoICgkdCBhcyAkdikgew0KICAgICAgICAgICAgaWYgKGFycmF5X2tleV9leGlzdHMoJHYsICR0aGlzLT50YWdzX2FsbCkgPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICAgICAkY1tdID0gJHY7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICRkWyR2XSA9ICYkdGhpcy0+dGFnc19hbGxbJHZdOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKGNvdW50KCRjKSA9PT0gMCkgew0KICAgICAgICAgICAgcmV0dXJuICRkOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJHQgPSBhcnJheSgpOw0KICAgICAgICAgICAgJGFycmF5ID0gJHRoaXMtPkdldFRhZ0xpc3QoJycsIGFycmF5KGFycmF5KCdJTicsICd0YWdfSUQnLCAkYykpLCAnJywgJycsICcnKTsNCiAgICAgICAgICAgIGZvcmVhY2ggKCRhcnJheSBhcyAkdikgew0KICAgICAgICAgICAgICAgICR0WyR2LT5JRF0gPSAmJHRoaXMtPnRhZ3NfYWxsWyR2LT5JRF07DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiBhcnJheV9tZXJnZSgkZCwgJHQpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YCa6L+H57G75Ly8J2FhYSxiYmIsY2NjLGRkZCfovb3lhaV0YWdzLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkcyDmoIfnrb7lkI3lrZfnrKbkuLLvvIzlpoInYWFhLGJiYixjY2MsZGRkDQogICAgICogQHBhcmFtIGludCAkcG9zdHR5cGUgdHlwZQ0KICAgICAqDQogICAgICogQHJldHVybiBhcnJheQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBMb2FkVGFnc0J5TmFtZVN0cmluZygkcywgJHBvc3R0eXBlID0gMCkNCiAgICB7DQogICAgICAgICRzID0gdHJpbSgkcyk7DQogICAgICAgICRzID0gc3RyX3JlcGxhY2UoYXJyYXkoJzsnLCAn77yMJywgJ+OAgScpLCAnLCcsICRzKTsNCiAgICAgICAgJHMgPSB0cmltKCRzKTsNCiAgICAgICAgJHMgPSBzdHJpcF90YWdzKCRzKTsNCiAgICAgICAgaWYgKCRzID09PSAnJyB8fCAkcyA9PT0gJywnKSB7DQogICAgICAgICAgICByZXR1cm4gYXJyYXkoKTsNCiAgICAgICAgfQ0KICAgICAgICAkcyA9IGV4cGxvZGUoJywnLCAkcyk7DQogICAgICAgICR0ID0gYXJyYXlfdW5pcXVlKCRzKTsNCiAgICAgICAgaWYgKGNvdW50KCR0KSA9PT0gMCkgew0KICAgICAgICAgICAgcmV0dXJuIGFycmF5KCk7DQogICAgICAgIH0NCg0KICAgICAgICAkdW5sb2FkX3RhZ3MgPSBhcnJheSgpOw0KICAgICAgICAkZXhpc3RfdGFncyA9IGFycmF5KCk7DQogICAgICAgIGZvcmVhY2ggKCR0IGFzICRuYW1lKSB7DQogICAgICAgICAgICAkbmFtZSA9IHRyaW0oJG5hbWUpOw0KICAgICAgICAgICAgaWYgKGlzc2V0KCR0aGlzLT50YWdzYnluYW1lX3R5cGVbJHBvc3R0eXBlXVskbmFtZV0pID09IGZhbHNlKSB7DQogICAgICAgICAgICAgICAgJHVubG9hZF90YWdzW10gPSBhcnJheSgndGFnX05hbWUnLCAkbmFtZSk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICRleGlzdF90YWdzWyRuYW1lXSA9ICYkdGhpcy0+dGFnc2J5bmFtZV90eXBlWyRwb3N0dHlwZV1bJG5hbWVdOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKGNvdW50KCR1bmxvYWRfdGFncykgPT0gMCkgew0KICAgICAgICAgICAgcmV0dXJuICRleGlzdF90YWdzOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJGFycmF5ID0gJHRoaXMtPkdldFRhZ0xpc3QoJycsIGFycmF5KGFycmF5KCc9JywgJ3RhZ19UeXBlJywgJHBvc3R0eXBlKSwgYXJyYXkoJ2FycmF5JywgJHVubG9hZF90YWdzKSksICcnLCAnJywgJycpOw0KICAgICAgICAgICAgZm9yZWFjaCAoJGFycmF5IGFzICR0YWcpIHsNCiAgICAgICAgICAgICAgICAkZXhpc3RfdGFnc1skdGFnLT5OYW1lXSA9ICYkdGhpcy0+dGFnc2J5bmFtZV90eXBlWyRwb3N0dHlwZV1bJHRhZy0+TmFtZV07DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gJGV4aXN0X3RhZ3M7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4fmlbDnu4RhcnJheVsxMTEsMzMzLDQ0NCw1NTUsNjY2Xei9rOaNouaIkOWtmOWCqOS4si4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBhcnJheSAkYXJyYXkg5qCH562+SUTmlbDnu4QNCiAgICAgKg0KICAgICAqIEByZXR1cm4gc3RyaW5nDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIENvbnZlcnRUYWdJRHRvU3RyaW5nKCRhcnJheSkNCiAgICB7DQogICAgICAgICRzID0gJyc7DQogICAgICAgIGZvcmVhY2ggKCRhcnJheSBhcyAkYSkgew0KICAgICAgICAgICAgJHMgLj0gJ3snIC4gJGEgLiAnfSc7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJHM7DQogICAgfQ0KDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFRvcEFydGljbGUoJHR5cGUgPSAwKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuICR0aGlzLT5HZXRUb3BQb3N0KCR0eXBlKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDojrflj5blhajpg6jnva7pobbmlofnq6DvvIjkvJjlhYjku45jYWNoZemHjOivu+aVsOe7hO+8iS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBpbnQgJHR5cGUNCiAgICAgKg0KICAgICAqIEByZXR1cm4gYXJyYXkNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0VG9wUG9zdCgkdHlwZSA9IDApDQogICAgew0KICAgICAgICAkdmFybmFtZSA9ICd0b3BfcG9zdF9hcnJheV8nIC4gJHR5cGU7DQogICAgICAgIGlmICgkdGhpcy0+Y2FjaGUtPkhhc0tleSgkdmFybmFtZSkgPT0gZmFsc2UpIHsNCiAgICAgICAgICAgIHJldHVybiBhcnJheSgpOw0KICAgICAgICB9DQogICAgICAgIGlmICghaXNfc3RyaW5nKCR0aGlzLT5jYWNoZS0+JHZhcm5hbWUpKSB7DQogICAgICAgICAgICByZXR1cm4gYXJyYXkoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIEAkYXJ0aWNsZXNfdG9wX25vdG9yZGVyX2lkYXJyYXkgPSB1bnNlcmlhbGl6ZSgkdGhpcy0+Y2FjaGUtPiR2YXJuYW1lKTsNCiAgICAgICAgaWYgKCFpc19hcnJheSgkYXJ0aWNsZXNfdG9wX25vdG9yZGVyX2lkYXJyYXkpKSB7DQogICAgICAgICAgICBDb3VudFRvcFBvc3QoJHR5cGUsIG51bGwsIG51bGwpOw0KICAgICAgICAgICAgQCRhcnRpY2xlc190b3Bfbm90b3JkZXJfaWRhcnJheSA9IHVuc2VyaWFsaXplKCR0aGlzLT5jYWNoZS0+JHZhcm5hbWUpOw0KICAgICAgICB9DQoNCiAgICAgICAgJGFydGljbGVzX3RvcF9ub3RvcmRlciA9IGFycmF5KCk7DQogICAgICAgIGlmIChpc19hcnJheSgkYXJ0aWNsZXNfdG9wX25vdG9yZGVyX2lkYXJyYXkpKSB7DQogICAgICAgICAgICAkYXJ0aWNsZXNfdG9wX25vdG9yZGVyID0gJHRoaXMtPkdldFBvc3RCeUFycmF5KCRhcnRpY2xlc190b3Bfbm90b3JkZXJfaWRhcnJheSk7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJGFydGljbGVzX3RvcF9ub3RvcmRlcjsNCiAgICB9DQoNCiAgICAvLyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KICAgIC8v6aqM6K+B55u45YWzDQoNCiAgICAvKioNCiAgICAgKiDojrflj5bor4TorrprZXkuDQogICAgICoNCiAgICAgKiBAcGFyYW0gJGlkDQogICAgICoNCiAgICAgKiBAcmV0dXJuIHN0cmluZw0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRDbXRLZXkoJGlkKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuIG1kNSgkdGhpcy0+Z3VpZCAuICRpZCAuIGRhdGUoJ1ltZGgnKSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6aqM6K+B6K+E6K66a2V5Lg0KICAgICAqDQogICAgICogQHBhcmFtICRpZA0KICAgICAqIEBwYXJhbSAka2V5DQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gVmFsaWRDbXRLZXkoJGlkLCAka2V5KQ0KICAgIHsNCiAgICAgICAgJG5vd2tleSA9IG1kNSgkdGhpcy0+Z3VpZCAuICRpZCAuIGRhdGUoJ1ltZGgnKSk7DQogICAgICAgICRub3drZXkyID0gbWQ1KCR0aGlzLT5ndWlkIC4gJGlkIC4gZGF0ZSgnWW1kaCcsICh0aW1lKCkgLSAoMzYwMCAqIDEpKSkpOw0KDQogICAgICAgIHJldHVybiAka2V5ID09ICRub3drZXkgfHwgJGtleSA9PSAkbm93a2V5MjsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDojrflj5ZDU1JGIFRva2VuLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkaWQg5bqU55SoSUTvvIzlj6/ku6Xkv53or4Hmr4/kuKrlupTnlKjojrflj5bkuI3lkIznmoRUb2tlbg0KICAgICAqDQogICAgICogQHJldHVybiBzdHJpbmcNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0Q1NSRlRva2VuKCRpZCA9ICcnKQ0KICAgIHsNCiAgICAgICAgJG9sZFpvbmUgPSBkYXRlX2RlZmF1bHRfdGltZXpvbmVfZ2V0KCk7DQogICAgICAgIGRhdGVfZGVmYXVsdF90aW1lem9uZV9zZXQoJHRoaXMtPm9wdGlvblsnWkNfVElNRV9aT05FX05BTUUnXSk7DQoNCiAgICAgICAgJHRpbWUgPSBkYXRlKCdZbWRoJyk7DQogICAgICAgICRzID0gJHRoaXMtPnVzZXItPklEIC4gJHRoaXMtPnVzZXItPlBhc3N3b3JkIC4gJHRoaXMtPnVzZXItPlN0YXR1czsNCg0KICAgICAgICBkYXRlX2RlZmF1bHRfdGltZXpvbmVfc2V0KCRvbGRab25lKTsNCiAgICAgICAgcmV0dXJuIG1kNSgkdGhpcy0+Z3VpZCAuICRzIC4gJGlkIC4gJHRpbWUpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmqjOivgUNTUkYgVG9rZW4uDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICR0b2tlbg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJGlkICAgIOW6lOeUqElE77yM5Y+v5Li65q+P5Liq5bqU55So55Sf5oiQ5LiA5Liq5LiT5bGedG9rZW4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBWZXJpZnlDU1JGVG9rZW4oJHRva2VuLCAkaWQgPSAnJykNCiAgICB7DQogICAgICAgICRvbGRab25lID0gZGF0ZV9kZWZhdWx0X3RpbWV6b25lX2dldCgpOw0KICAgICAgICBkYXRlX2RlZmF1bHRfdGltZXpvbmVfc2V0KCR0aGlzLT5vcHRpb25bJ1pDX1RJTUVfWk9ORV9OQU1FJ10pOw0KDQogICAgICAgICR1c2VyU3RyaW5nID0gJHRoaXMtPnVzZXItPklEIC4gJHRoaXMtPnVzZXItPlBhc3N3b3JkIC4gJHRoaXMtPnVzZXItPlN0YXR1czsNCiAgICAgICAgJHRva2VuU3RyaW5nID0gJHRoaXMtPmd1aWQgLiAkdXNlclN0cmluZyAuICRpZDsNCg0KICAgICAgICBmb3IgKCRpID0gMDsgJGkgPD0gJHRoaXMtPmNzcmZFeHBpcmF0aW9uOyAkaSsrKSB7DQogICAgICAgICAgICBpZiAoJHRva2VuID09PSBtZDUoJHRva2VuU3RyaW5nIC4gZGF0ZSgnWW1kaCcsICh0aW1lKCkgLSAoMzYwMCAqICRpKSkpKSkgew0KICAgICAgICAgICAgICAgIGRhdGVfZGVmYXVsdF90aW1lem9uZV9zZXQoJG9sZFpvbmUpOw0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgZGF0ZV9kZWZhdWx0X3RpbWV6b25lX3NldCgkb2xkWm9uZSk7DQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmmL7npLrpqozor4HnoIENCiAgICAgKg0KICAgICAqIEBhcGkgRmlsdGVyX1BsdWdpbl9aYnBfU2hvd1ZhbGlkQ29kZSDlpoLor6XmjqXlj6PmnKrooqvmjILovb3liJnmmL7npLrpu5jorqTpqozor4Hlm77niYcNCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJGlkIOWRveWQjeS6i+S7tg0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFNob3dWYWxpZENvZGUoJGlkID0gJycpDQogICAgew0KICAgICAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9aYnBfU2hvd1ZhbGlkQ29kZSddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAgICAgcmV0dXJuICRmcG5hbWUoJGlkKTsgLy8qDQogICAgICAgIH0NCg0KICAgICAgICAkX3ZjID0gbmV3IFZhbGlkYXRlQ29kZSgpOw0KICAgICAgICAkX3ZjLT5HZXRJbWcoKTsNCiAgICAgICAgc2V0Y29va2llKCdjYXB0Y2hhXycgLiBjcmMzMigkdGhpcy0+Z3VpZCAuICRpZCksIG1kNSgkdGhpcy0+Z3VpZCAuIGRhdGUoIlltZGgiKSAuICRfdmMtPkdldENvZGUoKSksIG51bGwsICR0aGlzLT5jb29raWVzcGF0aCk7DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5q+U5a+56aqM6K+B56CBDQogICAgICoNCiAgICAgKiBAYXBpIEZpbHRlcl9QbHVnaW5fWmJwX0NoZWNrVmFsaWRDb2RlIOWmguivpeaOpeWPo+acquiiq+aMgui9veWImeavlOWvuem7mOiupOmqjOivgeeggQ0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkdmVyaWZ5Q29kZSDpqozor4HnoIHmlbDlgLwNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRpZCAgICAgICAgIOWRveWQjeS6i+S7tg0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIENoZWNrVmFsaWRDb2RlKCR2ZXJpZnlDb2RlLCAkaWQgPSAnJykNCiAgICB7DQogICAgICAgICR2ZXJpZnlDb2RlID0gc3RydG9sb3dlcigkdmVyaWZ5Q29kZSk7DQogICAgICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1picF9DaGVja1ZhbGlkQ29kZSddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAgICAgcmV0dXJuICRmcG5hbWUoJHZlcmlmeUNvZGUsICRpZCk7IC8vKg0KICAgICAgICB9DQoNCiAgICAgICAgJG9yaWdpbmFsID0gR2V0VmFycygnY2FwdGNoYV8nIC4gY3JjMzIoJHRoaXMtPmd1aWQgLiAkaWQpLCAnQ09PS0lFJyk7DQogICAgICAgIHNldGNvb2tpZSgnY2FwdGNoYV8nIC4gY3JjMzIoJHRoaXMtPmd1aWQgLiAkaWQpLCAnJywgKHRpbWUoKSAtIDM2MDApLCAkdGhpcy0+Y29va2llc3BhdGgpOw0KDQogICAgICAgIHJldHVybiBtZDUoJHRoaXMtPmd1aWQgLiBkYXRlKCJZbWRoIikgLiBzdHJ0b2xvd2VyKCR2ZXJpZnlDb2RlKSkgPT0gJG9yaWdpbmFsDQogICAgICAgICAgICB8fA0KICAgICAgICAgICAgbWQ1KCR0aGlzLT5ndWlkIC4gZGF0ZSgiWW1kaCIsICh0aW1lKCkgLSAoMzYwMCAqIDEpKSkgLiBzdHJ0b2xvd2VyKCR2ZXJpZnlDb2RlKSkgPT0gJG9yaWdpbmFsOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWQkeWvvOiIquiPnOWNlea3u+WKoOebuOW6lOadoeebri4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHR5cGUgJHR5cGU9Y2F0ZWdvcnksdGFnLHBhZ2UsaXRlbQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgJGlkDQogICAgICogQHBhcmFtIHN0cmluZyAkbmFtZQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHVybA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBBZGRJdGVtVG9OYXZiYXIoJHR5cGUsICRpZCwgJG5hbWUsICR1cmwpDQogICAgew0KICAgICAgICBpZiAoISR0eXBlKSB7DQogICAgICAgICAgICAkdHlwZSA9ICdpdGVtJzsNCiAgICAgICAgfQ0KDQogICAgICAgICRtID0gJHRoaXMtPm1vZHVsZXNieWZpbGVuYW1lWyduYXZiYXInXTsNCiAgICAgICAgJHMgPSAkbS0+Q29udGVudDsNCg0KICAgICAgICAkYSA9ICc8bGkgaWQ9Im5hdmJhci0nIC4gJHR5cGUgLiAnLScgLiAkaWQgLiAnIj48YSBocmVmPSInIC4gJHVybCAuICciPicgLiAkbmFtZSAuICc8L2E+PC9saT4nOw0KDQogICAgICAgIGlmICgkdGhpcy0+Q2hlY2tJdGVtVG9OYXZiYXIoJHR5cGUsICRpZCkpIHsNCiAgICAgICAgICAgICRzID0gcHJlZ19yZXBsYWNlKCcvPGxpIGlkPSJuYXZiYXItJyAuICR0eXBlIC4gJy0nIC4gJGlkIC4gJyI+Lio/PFwvbGk+LycsICRhLCAkcyk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkcyAuPSAnPGxpIGlkPSJuYXZiYXItJyAuICR0eXBlIC4gJy0nIC4gJGlkIC4gJyI+PGEgaHJlZj0iJyAuICR1cmwgLiAnIj4nIC4gJG5hbWUgLiAnPC9hPjwvbGk+JzsNCiAgICAgICAgfQ0KDQogICAgICAgICRtLT5Db250ZW50ID0gJHM7DQogICAgICAgICRtLT5TYXZlKCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5Yig6Zmk5a+86Iiq6I+c5Y2V5Lit55u45bqU5p2h55uuLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkdHlwZQ0KICAgICAqIEBwYXJhbSAkaWQNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gRGVsSXRlbVRvTmF2YmFyKCR0eXBlLCAkaWQpDQogICAgew0KICAgICAgICBpZiAoISR0eXBlKSB7DQogICAgICAgICAgICAkdHlwZSA9ICdpdGVtJzsNCiAgICAgICAgfQ0KDQogICAgICAgICRtID0gJHRoaXMtPm1vZHVsZXNieWZpbGVuYW1lWyduYXZiYXInXTsNCiAgICAgICAgJHMgPSAkbS0+Q29udGVudDsNCg0KICAgICAgICAkcyA9IHByZWdfcmVwbGFjZSgnLzxsaSBpZD0ibmF2YmFyLScgLiAkdHlwZSAuICctJyAuICRpZCAuICciPi4qPzxcL2xpPi8nLCAnJywgJHMpOw0KDQogICAgICAgICRtLT5Db250ZW50ID0gJHM7DQogICAgICAgICRtLT5TYXZlKCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5qOA5p+l5p2h55uu5piv5ZCm5Zyo5a+86Iiq6I+c5Y2V5LitLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkdHlwZQ0KICAgICAqIEBwYXJhbSAkaWQNCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBDaGVja0l0ZW1Ub05hdmJhcigkdHlwZSwgJGlkKQ0KICAgIHsNCiAgICAgICAgaWYgKCEkdHlwZSkgew0KICAgICAgICAgICAgJHR5cGUgPSAnaXRlbSc7DQogICAgICAgIH0NCg0KICAgICAgICAkbSA9ICR0aGlzLT5tb2R1bGVzYnlmaWxlbmFtZVsnbmF2YmFyJ107DQogICAgICAgICRzID0gJG0tPkNvbnRlbnQ7DQoNCiAgICAgICAgcmV0dXJuIChib29sKSBzdHJwb3MoJHMsICdpZD0ibmF2YmFyLScgLiAkdHlwZSAuICctJyAuICRpZCAuICciJyk7DQogICAgfQ0KDQogICAgLy8kc2lnbmFsID0gZ29vZCxiYWQsdGlwcw0KICAgIHByaXZhdGUgJGhpbnRzID0gYXJyYXkoKTsNCg0KICAgIC8qKg0KICAgICAqIOiuvue9ruaPkOekuua2iOaBr+W5tuWtmOWFpUNvb2tpZS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHNpZ25hbCAg5o+Q56S657G75Z6L77yIZ29vZHxiYWR8dGlwc++8iQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgJGNvbnRlbnQg5o+Q56S65YaF5a65DQogICAgICogQHBhcmFtIGludCAkZGVsYXkg5bu25pe25pe26Ze0DQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFNldEhpbnQoJHNpZ25hbCwgJGNvbnRlbnQgPSAnJywgJGRlbGF5ID0gMTApDQogICAgew0KICAgICAgICBpZiAoJGNvbnRlbnQgPT0gJycpIHsNCiAgICAgICAgICAgIGlmIChzdWJzdHIoJHNpZ25hbCwgMCwgNCkgPT0gJ2dvb2QnKSB7DQogICAgICAgICAgICAgICAgJGNvbnRlbnQgPSAkdGhpcy0+bGFuZ1snbXNnJ11bJ29wZXJhdGlvbl9zdWNjZWVkJ107DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmIChzdWJzdHIoJHNpZ25hbCwgMCwgMykgPT0gJ2JhZCcpIHsNCiAgICAgICAgICAgICAgICAkY29udGVudCA9ICR0aGlzLT5sYW5nWydtc2cnXVsnb3BlcmF0aW9uX2ZhaWxlZCddOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgICRjb250ZW50ID0gc3Vic3RyKCRjb250ZW50LCAwLCAyNTUpOw0KICAgICAgICBmb3IgKCRpID0gMTsgJGkgPD0gMTA7ICRpKyspIHsNCiAgICAgICAgICAgIGlmIChpc3NldCgkdGhpcy0+aGludHNbJGldKSkgew0KICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgJGhpbnQgPSBuZXcgc3RkQ2xhc3M7DQogICAgICAgICAgICAkaGludC0+c2lnbmFsID0gJHNpZ25hbDsNCiAgICAgICAgICAgICRoaW50LT5jb250ZW50ID0gJGNvbnRlbnQ7DQogICAgICAgICAgICAkaGludC0+ZGVsYXkgPSAkZGVsYXk7DQogICAgICAgICAgICAkdGhpcy0+aGludHNbJGldID0gJGhpbnQ7DQogICAgICAgICAgICBzZXRjb29raWUoImhpbnRfc2lnbmFsIiAuICRpLCBqc29uX2VuY29kZSgkaGludCksIDAsICR0aGlzLT5jb29raWVzcGF0aCk7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOaPkOWPlkNvb2tpZeS4reeahOaPkOekuua2iOaBry4NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0SGludCgpDQogICAgew0KICAgICAgICBmb3IgKCRpID0gMTsgJGkgPD0gMTA7ICRpKyspIHsNCiAgICAgICAgICAgIGlmIChpc3NldCgkdGhpcy0+aGludHNbJGldKSAmJiBpc19vYmplY3QoJHRoaXMtPmhpbnRzWyRpXSkpIHsNCiAgICAgICAgICAgICAgICAkdGhpcy0+U2hvd0hpbnQoJHRoaXMtPmhpbnRzWyRpXSk7DQogICAgICAgICAgICAgICAgc2V0Y29va2llKCJoaW50X3NpZ25hbCIgLiAkaSwgJycsICh0aW1lKCkgLSAzNjAwKSwgJHRoaXMtPmNvb2tpZXNwYXRoKTsNCiAgICAgICAgICAgICAgICB1bnNldCgkX0NPT0tJRVsiaGludF9zaWduYWwiIC4gJGldKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBmb3IgKCRpID0gMTsgJGkgPD0gMTA7ICRpKyspIHsNCiAgICAgICAgICAgICRzaWduYWwgPSBHZXRWYXJzKCdoaW50X3NpZ25hbCcgLiAkaSwgJ0NPT0tJRScpOw0KICAgICAgICAgICAgJGhpbnQgPSAoZW1wdHkoJHNpZ25hbCkpID8gbnVsbCA6IGpzb25fZGVjb2RlKCRzaWduYWwpOw0KICAgICAgICAgICAgaWYgKCRoaW50ICE9PSBudWxsKSB7DQogICAgICAgICAgICAgICAgJHRoaXMtPlNob3dIaW50KCRoaW50KTsNCiAgICAgICAgICAgICAgICBzZXRjb29raWUoImhpbnRfc2lnbmFsIiAuICRpLCAnJywgKHRpbWUoKSAtIDM2MDApLCAkdGhpcy0+Y29va2llc3BhdGgpOw0KICAgICAgICAgICAgICAgIHVuc2V0KCRfQ09PS0lFWyJoaW50X3NpZ25hbCIgLiAkaV0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog55Sx5o+Q56S65raI5oGv6L6T5Ye6SFRNTC4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHNpZ25hbCAg5o+Q56S657G75Z6L77yIZ29vZHxiYWR8dGlwc++8iQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgJGNvbnRlbnQg5o+Q56S65YaF5a65DQogICAgICogQHBhcmFtIGludCAkZGVsYXkg5bu25pe25pe26Ze0DQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFNob3dIaW50KCRzaWduYWwsICRjb250ZW50ID0gJycsICRkZWxheSA9IDEwKQ0KICAgIHsNCiAgICAgICAgLy8xLjflop7liqAkc2lnbmFs5Li6anNvbuexu+Weiw0KICAgICAgICAkaGludCA9ICRzaWduYWw7DQogICAgICAgIGlmIChpc19vYmplY3QoJGhpbnQpKSB7DQogICAgICAgICAgICAkc2lnbmFsID0gJGhpbnQtPnNpZ25hbDsNCiAgICAgICAgICAgICRjb250ZW50ID0gJGhpbnQtPmNvbnRlbnQ7DQogICAgICAgICAgICAkZGVsYXkgPSAkaGludC0+ZGVsYXk7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoJGNvbnRlbnQgPT0gJycpIHsNCiAgICAgICAgICAgIGlmIChzdWJzdHIoJHNpZ25hbCwgMCwgNCkgPT0gJ2dvb2QnIHx8IHN1YnN0cigkc2lnbmFsLCAwLCA3KSA9PSAnc3VjY2VlZCcpIHsNCiAgICAgICAgICAgICAgICAkY29udGVudCA9ICR0aGlzLT5sYW5nWydtc2cnXVsnb3BlcmF0aW9uX3N1Y2NlZWQnXTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKHN1YnN0cigkc2lnbmFsLCAwLCAzKSA9PSAnYmFkJyB8fCBzdWJzdHIoJHNpZ25hbCwgMCwgNikgPT0gJ2ZhaWxlZCcpIHsNCiAgICAgICAgICAgICAgICAkY29udGVudCA9ICR0aGlzLT5sYW5nWydtc2cnXVsnb3BlcmF0aW9uX2ZhaWxlZCddOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgICRkZWxheSA9ICgkZGVsYXkgKiAxMDAwKTsNCiAgICAgICAgZWNobyAiPGRpdiBjbGFzcz1cImhpbnRcIj48cCBjbGFzcz1cImhpbnQgaGludF8kc2lnbmFsXCIgZGF0YS1kZWxheT1cIiRkZWxheVwiPiRjb250ZW50PC9wPjwvZGl2PiI7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5o+Q56S65raI5oGvIEpT54mILg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkc2lnbmFsICDmj5DnpLrnsbvlnovvvIhnb29kfGJhZHx0aXBz77yJDQogICAgICogQHBhcmFtIHN0cmluZyAkY29udGVudCDmj5DnpLrlhoXlrrkNCiAgICAgKiBAcGFyYW0gaW50ICRkZWxheSDlu7bml7bml7bpl7QNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gU2hvd0hpbnRfSlMoJHNpZ25hbCwgJGNvbnRlbnQgPSAnJywgJGRlbGF5ID0gMTApDQogICAgew0KICAgICAgICAvLzEuN+WinuWKoCRzaWduYWzkuLpqc29u57G75Z6LDQogICAgICAgICRoaW50ID0gJHNpZ25hbDsNCiAgICAgICAgaWYgKGlzX29iamVjdCgkaGludCkpIHsNCiAgICAgICAgICAgICRzaWduYWwgPSAkaGludC0+c2lnbmFsOw0KICAgICAgICAgICAgJGNvbnRlbnQgPSAkaGludC0+Y29udGVudDsNCiAgICAgICAgICAgICRkZWxheSA9ICRoaW50LT5kZWxheTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmICgkY29udGVudCA9PSAnJykgew0KICAgICAgICAgICAgaWYgKHN1YnN0cigkc2lnbmFsLCAwLCA0KSA9PSAnZ29vZCcgfHwgc3Vic3RyKCRzaWduYWwsIDAsIDcpID09ICdzdWNjZWVkJykgew0KICAgICAgICAgICAgICAgICRjb250ZW50ID0gJHRoaXMtPmxhbmdbJ21zZyddWydvcGVyYXRpb25fc3VjY2VlZCddOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoc3Vic3RyKCRzaWduYWwsIDAsIDMpID09ICdiYWQnIHx8IHN1YnN0cigkc2lnbmFsLCAwLCA2KSA9PSAnZmFpbGVkJykgew0KICAgICAgICAgICAgICAgICRjb250ZW50ID0gJHRoaXMtPmxhbmdbJ21zZyddWydvcGVyYXRpb25fZmFpbGVkJ107DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgJGRlbGF5ID0gKCRkZWxheSAqIDEwMDAwKTsNCiAgICAgICAgZWNobyAiPHNjcmlwdCB0eXBlPSd0ZXh0L2phdmFzY3JpcHQnPiQoJy5tYWluJykucHJlcGVuZCgnPGRpdiBjbGFzcz1cImhpbnRcIj48cCBjbGFzcz1cImhpbnQgaGludF8iIC4gJHNpZ25hbCAuICJcIiBkYXRhLWRlbGF5PVwiIiAuICRkZWxheSAuICJcIj4iOw0KICAgICAgICBlY2hvIHN0cl9yZXBsYWNlKCInIiwgIlwnIiwgJGNvbnRlbnQpOw0KICAgICAgICBlY2hvICI8L3A+PC9kaXY+Jyk7PC9zY3JpcHQ+IjsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmmL7npLrplJnor6/kv6Hmga8uDQogICAgICoNCiAgICAgKiBAYXBpIEZpbHRlcl9QbHVnaW5fWmJwX1Nob3dFcnJvcg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZy9pbnQgJGVycm9yVGV4dA0KICAgICAqIEBwYXJhbSBudWxsICAgICAgICRmaWxlDQogICAgICogQHBhcmFtIG51bGwgICAgICAgJGxpbmUNCiAgICAgKg0KICAgICAqIEB0aHJvd3MgRXhjZXB0aW9uDQogICAgICoNCiAgICAgKiBAcmV0dXJuIG1peGVkDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFNob3dFcnJvcigkZXJyb3JUZXh0LCAkZmlsZSA9IG51bGwsICRsaW5lID0gbnVsbCwgJG1vcmVpbmZvID0gbnVsbCkNCiAgICB7DQogICAgICAgICRhcmdzID0gZnVuY19nZXRfYXJncygpOw0KICAgICAgICAkZXJyb3JDb2RlID0gMDsNCiAgICAgICAgaWYgKGlzX251bWVyaWMoJGVycm9yVGV4dCkpIHsNCiAgICAgICAgICAgICRlcnJvckNvZGUgPSAoaW50KSAkZXJyb3JUZXh0Ow0KICAgICAgICAgICAgJGVycm9yVGV4dCA9ICR0aGlzLT5sYW5nWydlcnJvciddWyRlcnJvclRleHRdOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCRlcnJvckNvZGUgPT0gMikgew0KICAgICAgICAgICAgSHR0cDQwNCgpOw0KICAgICAgICB9DQoNCiAgICAgICAgJHpiZSA9IFpCbG9nRXhjZXB0aW9uOjpHZXRJbnN0YW5jZSgpOw0KICAgICAgICAkemJlLT5tZXNzYWdlID0gJGVycm9yVGV4dDsNCiAgICAgICAgJHpiZS0+bWVzc2FnZWZ1bGwgPSAkZXJyb3JUZXh0IC4gJyAoc2V0X2V4Y2VwdGlvbl9oYW5kbGVyKSAnOw0KICAgICAgICAkemJlLT50eXBlID0gJGVycm9yQ29kZTsNCiAgICAgICAgJHpiZS0+Y29kZSA9ICRlcnJvckNvZGU7DQogICAgICAgICR6YmUtPmZpbGUgPSAkZmlsZTsNCiAgICAgICAgJHpiZS0+bGluZSA9ICRsaW5lOw0KICAgICAgICAkemJlLT5tb3JlaW5mbyA9ICRtb3JlaW5mbzsNCg0KICAgICAgICBpZiAoc3RyaXBvcygneycgLiBzaGExKCdtdXN0c2hvd2Vycm9yJykgLiAnfScsICRlcnJvclRleHQpID09PSAwKSB7DQogICAgICAgICAgICAkZXJyb3JUZXh0ID0gc3RyX3JlcGxhY2UoJ3snIC4gc2hhMSgnbXVzdHNob3dlcnJvcicpIC4gJ30nLCAnJywgJGVycm9yVGV4dCk7DQogICAgICAgICAgICAkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9EZWJ1Z19EaXNwbGF5J10gPSBhcnJheSgpOw0KICAgICAgICAgICAgJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fRGVidWdfSGFuZGxlciddID0gYXJyYXkoKTsNCg0KICAgICAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbigkZXJyb3JUZXh0KTsNCiAgICAgICAgfQ0KDQogICAgICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1picF9TaG93RXJyb3InXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgICAgIGFycmF5X3NoaWZ0KCRhcmdzKTsNCiAgICAgICAgICAgIGFycmF5X3Vuc2hpZnQoJGFyZ3MsICRlcnJvclRleHQpOw0KICAgICAgICAgICAgYXJyYXlfdW5zaGlmdCgkYXJncywgJGVycm9yQ29kZSk7DQogICAgICAgICAgICAvLyRmcHJldHVybiA9ICRmcG5hbWUoJGVycm9yQ29kZSwgJGVycm9yVGV4dCwgJGZpbGUsICRsaW5lLCAkbW9yZWluZm8pOw0KICAgICAgICAgICAgJGZwcmV0dXJuID0gY2FsbF91c2VyX2Z1bmNfYXJyYXkoJGZwbmFtZSwgJGFyZ3MpOw0KICAgICAgICAgICAgaWYgKCRmcHNpZ25hbCA9PSBQTFVHSU5fRVhJVFNJR05BTF9SRVRVUk4pIHsNCiAgICAgICAgICAgICAgICAkZnBzaWduYWwgPSBQTFVHSU5fRVhJVFNJR05BTF9OT05FOw0KDQogICAgICAgICAgICAgICAgcmV0dXJuICRmcHJldHVybjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oJGVycm9yVGV4dCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5qOA5rWL572R56uZ5YWz6Zet77yM5aaC5p6c5YWz6Zet77yM5YiZ5oqb5Ye66ZSZ6K+vLg0KICAgICAqDQogICAgICogQHRocm93cyBFeGNlcHRpb24NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQ2hlY2tTaXRlQ2xvc2VkKCkNCiAgICB7DQogICAgICAgIGlmICgkdGhpcy0+b3B0aW9uWydaQ19DTE9TRV9TSVRFJ10pIHsNCiAgICAgICAgICAgIEh0dHA1MDMoKTsNCiAgICAgICAgICAgICR0aGlzLT5TaG93RXJyb3IoODIsIF9fRklMRV9fLCBfX0xJTkVfXyk7DQogICAgICAgICAgICBleGl0Ow0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6Lez6L2s5Yiw5a6J6KOF6aG16Z2iLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBSZWRpcmVjdEluc3RhbGwoKQ0KICAgIHsNCiAgICAgICAgaWYgKCEkdGhpcy0+b3B0aW9uWydaQ19EQVRBQkFTRV9UWVBFJ10pIHsNCiAgICAgICAgICAgICRzID0gJF9TRVJWRVJbJ1FVRVJZX1NUUklORyddOw0KICAgICAgICAgICAgJHMgPSBlbXB0eSgkcykgPyAnJyA6ICc/JyAuICRzOw0KICAgICAgICAgICAgUmVkaXJlY3QzMDIoJy4vemJfaW5zdGFsbC9pbmRleC5waHAnIC4gJHMpOw0KICAgICAgICB9DQogICAgICAgIGlmIChpc3NldCgkdGhpcy0+b3B0aW9uWydaQ19JTlNUQUxMX0FGVEVSX0NPTkZJRyddKSAmJiAkdGhpcy0+b3B0aW9uWydaQ19JTlNUQUxMX0FGVEVSX0NPTkZJRyddID09IHRydWUpIHsNCiAgICAgICAgICAgICRyID0gJHRoaXMtPmRiLT5FeGlzdFRhYmxlKCRHTE9CQUxTWyd0YWJsZSddWydDb25maWcnXSk7DQogICAgICAgICAgICBpZiAoJHIgPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICAgICBSZWRpcmVjdDMwMignLi96Yl9pbnN0YWxsL2luZGV4LnBocCcpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5rOo5YaMUG9zdFR5cGUuDQogICAgICoNCiAgICAgKiBAcGFyYW0gJHR5cGVJZA0KICAgICAqIEBwYXJhbSAkbmFtZQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHVybFJ1bGUgICAgICDpu5jorqTmmK9hcnJheSgpIOS4ulVybCBSdWxl57uE5ZCI55qE5pWw57uEDQogICAgICogQHBhcmFtIHN0cmluZyAkdGVtcGxhdGUgICAgIOm7mOiupOaooeadv+WQjeaYr2FycmF5KCkg5Li65LiA5Liq57uE5ZCI5pWw57uEDQogICAgICogQHBhcmFtIHN0cmluZyAkY2xhc3NOYW1lICAgIOm7mOiupOexu+WQjQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgJGFjdGlvbnMgICAgICDpu5jorqRBY3Rpb25zIOW6lOaYr2FycmF5KCkNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRyb3V0ZXMgICAgICAg6buY6K6kUm91dGVzIOW6lOaYr2FycmF5KCkNCiAgICAgKg0KICAgICAqIEB0aHJvd3MgRXhjZXB0aW9uDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFJlZ1Bvc3RUeXBlKCR0eXBlSWQsICRuYW1lID0gJycsICR1cmxSdWxlID0gYXJyYXkoKSwgJHRlbXBsYXRlID0gYXJyYXkoKSwgJGNsYXNzTmFtZSA9ICdQb3N0JywgJGFjdGlvbnMgPSBhcnJheSgpLCAkcm91dGVzID0gYXJyYXkoKSkNCiAgICB7DQogICAgICAgIC8qIOi/meS4pOS4quWPguaVsOWcqDEuN+mHjOW3sue7j+W6n+W8gw0KICAgICAgICAqIEBwYXJhbSBzdHJpbmcgJGNhdGVnb3J5VHlwZSDlvZPliY3mlofnq6DnsbvnmoTliIbnsbtUeXBlIC8v5bey5bqf5byDDQogICAgICAgICogQHBhcmFtIHN0cmluZyAkdGFnVHlwZSAgICAgIOW9k+WJjeaWh+eroOexu+eahOagh+etvlR5cGUgLy/lt7Llup/lvIMNCiAgICAgICAgKi8NCg0KICAgICAgICAvL+WmguaenOWPquacieS4gOS4quWPguaVsO+8jOS4lOesrOS4gOS4quWPguaVsOaYr2FycmF5KCnnmoTor53vvIzpgqPlsLHnm7TmjqXotYvlgLwNCiAgICAgICAgaWYgKGlzX2FycmF5KCR0eXBlSWQpKSB7DQogICAgICAgICAgICAkaWQgPSAkdHlwZUlkWydpZCddOw0KICAgICAgICAgICAgaWYgKCFpc3NldCgkdHlwZUlkWydjbGFzc25hbWUnXSkgfHwgJHR5cGVJZFsnY2xhc3NuYW1lJ10gPT0gJycpIHsNCiAgICAgICAgICAgICAgICAkdHlwZUlkWydjbGFzc25hbWUnXSA9ICdQb3N0JzsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgICR0eXBlSWRbJ25hbWUnXSA9IHN0cnRvbG93ZXIodHJpbSgkdHlwZUlkWyduYW1lJ10pKTsNCiAgICAgICAgICAgICR0aGlzLT5wb3N0dHlwZVskaWRdID0gJHR5cGVJZDsNCiAgICAgICAgICAgIGlmICghaXNzZXQoJHRoaXMtPnRhZ3NfdHlwZVskaWRdKSkgew0KICAgICAgICAgICAgICAgICR0aGlzLT50YWdzX3R5cGVbJGlkXSA9IGFycmF5KCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoIWlzc2V0KCR0aGlzLT50YWdzYnluYW1lX3R5cGVbJGlkXSkpIHsNCiAgICAgICAgICAgICAgICAkdGhpcy0+dGFnc2J5bmFtZV90eXBlWyRpZF0gPSBhcnJheSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKCFpc3NldCgkdGhpcy0+Y2F0ZWdvcmllc2J5b3JkZXJfdHlwZVskaWRdKSkgew0KICAgICAgICAgICAgICAgICR0aGlzLT5jYXRlZ29yaWVzYnlvcmRlcl90eXBlWyRpZF0gPSBhcnJheSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0NCg0KDQogICAgICAgICR1cnMgPSBhcnJheSgpOw0KICAgICAgICAkdXJzWydzaW5nbGVfdXJscnVsZSddID0gJHRoaXMtPm9wdGlvblsnWkNfUEFHRV9SRUdFWCddOw0KICAgICAgICAkdXJzWydsaXN0X3VybHJ1bGUnXSA9ICcnOw0KICAgICAgICAkdXJzWydsaXN0X2NhdGVnb3J5X3VybHJ1bGUnXSA9ICcnOw0KICAgICAgICAkdXJzWydsaXN0X2F1dGhvcl91cmxydWxlJ10gPSAnJzsNCiAgICAgICAgJHVyc1snbGlzdF9kYXRlX3VybHJ1bGUnXSA9ICcnOw0KICAgICAgICAkdXJzWydsaXN0X3RhZ191cmxydWxlJ10gPSAnJzsNCiAgICAgICAgJHVyc1snc2VhcmNoX3VybHJ1bGUnXSA9ICcnOw0KICAgICAgICBpZiAoIWlzX2FycmF5KCR1cmxSdWxlKSkgew0KICAgICAgICAgICAgaWYgKGlzX3N0cmluZygkdXJsUnVsZSkgJiYgJHVybFJ1bGUgIT0gJycpIHsNCiAgICAgICAgICAgICAgICAkdXJzWydzaW5nbGVfdXJscnVsZSddID0gJHVybFJ1bGU7DQogICAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkdXJzID0gYXJyYXlfbWVyZ2UoJHVycywgJHVybFJ1bGUpOw0KICAgICAgICB9DQoNCiAgICAgICAgJHR5cGVJZCA9IChpbnQpICR0eXBlSWQ7DQogICAgICAgICRuYW1lID0gc3RydG9sb3dlcih0cmltKCRuYW1lKSk7DQogICAgICAgIGlmICgkdHlwZUlkID4gOTkpIHsNCiAgICAgICAgICAgIGlmIChpc3NldCgkdGhpcy0+cG9zdHR5cGVbJHR5cGVJZF0pKSB7DQogICAgICAgICAgICAgICAgJHRoaXMtPlNob3dFcnJvcig4NywgX19GSUxFX18sIF9fTElORV9fKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICAkdHBzID0gYXJyYXkoKTsNCiAgICAgICAgJHRwc1sndGVtcGxhdGUnXSA9ICR0aGlzLT5vcHRpb25bJ1pDX1BPU1RfREVGQVVMVF9URU1QTEFURSddOw0KICAgICAgICAkdHBzWydsaXN0X3RlbXBsYXRlJ10gPSAkdGhpcy0+b3B0aW9uWydaQ19JTkRFWF9ERUZBVUxUX1RFTVBMQVRFJ107DQogICAgICAgICR0cHNbJ2NhdGVnb3J5X3RlbXBsYXRlJ10gPSAkdGhpcy0+b3B0aW9uWydaQ19JTkRFWF9ERUZBVUxUX1RFTVBMQVRFJ107DQogICAgICAgICR0cHNbJ3RhZ190ZW1wbGF0ZSddID0gJHRoaXMtPm9wdGlvblsnWkNfSU5ERVhfREVGQVVMVF9URU1QTEFURSddOw0KICAgICAgICAkdHBzWydhdXRob3JfdGVtcGxhdGUnXSA9ICR0aGlzLT5vcHRpb25bJ1pDX0lOREVYX0RFRkFVTFRfVEVNUExBVEUnXTsNCiAgICAgICAgJHRwc1snZGF0ZV90ZW1wbGF0ZSddID0gJHRoaXMtPm9wdGlvblsnWkNfSU5ERVhfREVGQVVMVF9URU1QTEFURSddOw0KICAgICAgICAkdHBzWydzZWFyY2hfdGVtcGxhdGUnXSA9ICR0aGlzLT5vcHRpb25bJ1pDX1NFQVJDSF9ERUZBVUxUX1RFTVBMQVRFJ107DQoNCiAgICAgICAgaWYgKCFpc19hcnJheSgkdGVtcGxhdGUpKSB7DQogICAgICAgICAgICBpZiAoaXNfc3RyaW5nKCR0ZW1wbGF0ZSkgJiYgJHRlbXBsYXRlICE9ICcnKSB7DQogICAgICAgICAgICAgICAgJHRwc1sndGVtcGxhdGUnXSA9ICR0ZW1wbGF0ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICR0cHMgPSBhcnJheV9tZXJnZSgkdHBzLCAkdGVtcGxhdGUpOw0KICAgICAgICB9DQoNCiAgICAgICAgJHRoaXMtPnBvc3R0eXBlWyR0eXBlSWRdID0gYXJyYXkoJ25hbWUnID0+ICRuYW1lLCAnY2xhc3NuYW1lJyA9PiAkY2xhc3NOYW1lKTsNCiAgICAgICAgJHRoaXMtPnBvc3R0eXBlWyR0eXBlSWRdID0gYXJyYXlfbWVyZ2UoJHRoaXMtPnBvc3R0eXBlWyR0eXBlSWRdLCAkdHBzLCAkdXJzKTsNCg0KICAgICAgICAkcG9zdF9hY3Rpb25zID0gYXJyYXkoJ25ldycgPT4gJ0FydGljbGVOZXcnLCAnZWRpdCcgPT4gJ0FydGljbGVFZHQnLCAnZGVsJyA9PiAnQXJ0aWNsZURlbCcsICdwb3N0JyA9PiAnQXJ0aWNsZVBzdCcsICdwdWJsaXNoJyA9PiAnQXJ0aWNsZVB1YicsICdtYW5hZ2UnID0+ICdBcnRpY2xlTW5nJywgJ2FsbCcgPT4gJ0FydGljbGVBbGwnLCAndmlldycgPT4gJ3ZpZXcnLCAnc2VhcmNoJyA9PiAnc2VhcmNoJyk7DQoNCiAgICAgICAgaWYgKGVtcHR5KCRhY3Rpb25zKSB8fCBpc19hcnJheSgkYWN0aW9ucykgPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICRhY3Rpb25zID0gJHBvc3RfYWN0aW9uczsNCiAgICAgICAgfQ0KDQogICAgICAgIGZvcmVhY2ggKCRwb3N0X2FjdGlvbnMgYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgICAgIGlmICghaXNzZXQoJGFjdGlvbnNbJGtleV0pKSB7DQogICAgICAgICAgICAgICAgJGFjdGlvbnNbJGtleV0gPSAkdmFsdWU7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgJHRoaXMtPnBvc3R0eXBlWyR0eXBlSWRdWydhY3Rpb25zJ10gPSAkYWN0aW9uczsNCg0KICAgICAgICBpZiAoIWlzc2V0KCR0aGlzLT50YWdzX3R5cGVbJHR5cGVJZF0pKSB7DQogICAgICAgICAgICAkdGhpcy0+dGFnc190eXBlWyR0eXBlSWRdID0gYXJyYXkoKTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoIWlzc2V0KCR0aGlzLT50YWdzYnluYW1lX3R5cGVbJHR5cGVJZF0pKSB7DQogICAgICAgICAgICAkdGhpcy0+dGFnc2J5bmFtZV90eXBlWyR0eXBlSWRdID0gYXJyYXkoKTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoIWlzc2V0KCR0aGlzLT5jYXRlZ29yaWVzYnlvcmRlcl90eXBlWyR0eXBlSWRdKSkgew0KICAgICAgICAgICAgJHRoaXMtPmNhdGVnb3JpZXNieW9yZGVyX3R5cGVbJHR5cGVJZF0gPSBhcnJheSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6K6+572uUG9zdFR5cGUuDQogICAgICoNCiAgICAgKiBAcGFyYW0gJHR5cGVJZA0KICAgICAqIEBwYXJhbSAkbmFtZQ0KICAgICAqIEBwYXJhbSAkdmFsdWUNCiAgICAgKg0KICAgICAqIEB0aHJvd3MgRXhjZXB0aW9uDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFNldFBvc3RUeXBlKCR0eXBlaWQsICRuYW1lLCAkdmFsdWUpDQogICAgew0KICAgICAgICAkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJG5hbWVdID0gJHZhbHVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOiOt+WPllBvc3RUeXBl5L+h5oGvKOWmguaenOaYr+S/ruaUueeahOivneivt+ebtOaOpee8lui+kSR6YnAtPnBvc3R0eXBlKQ0KICAgICAqDQogICAgICogQHBhcmFtICRrZXkNCiAgICAgKg0KICAgICAqIEBwYXJhbSAkdHlwZWlkDQogICAgICoNCiAgICAgKiBAcmV0dXJuIHN0cmluZw0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRQb3N0VHlwZSgkdHlwZWlkLCAka2V5KQ0KICAgIHsNCiAgICAgICAgaWYgKCRrZXkgPT0gbnVsbCB8fCBlbXB0eSgka2V5KSkgew0KICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoJ25hbWUnID09ICRrZXkpIHsNCiAgICAgICAgICAgIGlmIChpc3NldCgkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJ25hbWUnXSkpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gc3RydG9sb3dlcigkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJ25hbWUnXSk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiAnJzsNCiAgICAgICAgfSBlbHNlaWYgKCdzaW5nbGVfdXJscnVsZScgPT0gJGtleSkgew0KICAgICAgICAgICAgaWYgKGlzc2V0KCR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVsnc2luZ2xlX3VybHJ1bGUnXSkpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWydzaW5nbGVfdXJscnVsZSddOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gJHRoaXMtPm9wdGlvblsnWkNfUEFHRV9SRUdFWCddOw0KICAgICAgICB9IGVsc2VpZiAoJ2NsYXNzbmFtZScgPT0gJGtleSkgew0KICAgICAgICAgICAgaWYgKGlzc2V0KCR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVsnY2xhc3NuYW1lJ10pICYmICFlbXB0eSgkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJ2NsYXNzbmFtZSddKSkgew0KICAgICAgICAgICAgICAgIHJldHVybiAkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJ2NsYXNzbmFtZSddOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gJ1Bvc3QnOw0KICAgICAgICB9IGVsc2VpZiAoJ2FjdGlvbnMnID09ICRrZXkpIHsNCiAgICAgICAgICAgICRhY3Rpb25zID0gYXJyYXkoKTsNCiAgICAgICAgICAgIGlmIChpc3NldCgkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJ2FjdGlvbnMnXSkpIHsNCiAgICAgICAgICAgICAgICAkYWN0aW9ucyA9ICR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVsnYWN0aW9ucyddOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgJHBvc3RfYWN0aW9ucyA9ICR0aGlzLT5wb3N0dHlwZVswXVsnYWN0aW9ucyddOw0KICAgICAgICAgICAgaWYgKGlzX2FycmF5KCRhY3Rpb25zKSAmJiBlbXB0eSgkYWN0aW9ucykgPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICAgICBmb3JlYWNoICgkcG9zdF9hY3Rpb25zIGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICghaXNzZXQoJGFjdGlvbnNbJGtleV0pKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAkYWN0aW9uc1ska2V5XSA9ICR2YWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICByZXR1cm4gJGFjdGlvbnM7DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gJHBvc3RfYWN0aW9uczsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGlmIChpc3NldCgkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJGtleV0pKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVska2V5XTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOiuvue9rlBvc3RUeXBl5LiLQXJyYXnpobnnm67kv6Hmga8NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gU2V0UG9zdFR5cGVfU3ViKCR0eXBlaWQsICRuYW1lLCAkc3VibmFtZSwgJHZhbHVlKQ0KICAgIHsNCiAgICAgICAgJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWyRuYW1lXVskc3VibmFtZV0gPSAkdmFsdWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6I635Y+WUG9zdFR5cGXkuItBcnJheemhueebruS/oeaBrw0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRQb3N0VHlwZV9TdWIoJHR5cGVpZCwgJG5hbWUsICRzdWJuYW1lKQ0KICAgIHsNCiAgICAgICAgaWYgKGlzc2V0KCR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVskbmFtZV1bJHN1Ym5hbWVdKSkgew0KICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVskbmFtZV1bJHN1Ym5hbWVdOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiBudWxsOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBwYXJhbSAkdHlwZWlkDQogICAgICoNCiAgICAgKiBAcmV0dXJuIHN0cmluZw0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRQb3N0VHlwZV9OYW1lKCR0eXBlaWQpDQogICAgew0KICAgICAgICBpZiAoaXNzZXQoJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdKSkgew0KICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVsnbmFtZSddOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICcnOw0KICAgIH0NCg0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRQb3N0VHlwZV9DbGFzc05hbWUoJHR5cGVpZCkNCiAgICB7DQogICAgICAgIGlmIChpc3NldCgkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF0pKSB7DQogICAgICAgICAgICByZXR1cm4gJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWydjbGFzc25hbWUnXTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAnUG9zdCc7DQogICAgfQ0KDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFBvc3RUeXBlX1VybFJ1bGUoJHR5cGVpZCkNCiAgICB7DQogICAgICAgIGlmIChpc3NldCgkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF0pKSB7DQogICAgICAgICAgICByZXR1cm4gJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWydzaW5nbGVfdXJscnVsZSddOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICR0aGlzLT5vcHRpb25bJ1pDX1BBR0VfUkVHRVgnXTsNCiAgICB9DQoNCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0UG9zdFR5cGVfVGVtcGxhdGUoJHR5cGVpZCkNCiAgICB7DQogICAgICAgIGlmIChpc3NldCgkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF0pKSB7DQogICAgICAgICAgICByZXR1cm4gJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWyd0ZW1wbGF0ZSddOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICR0aGlzLT5vcHRpb25bJ1pDX1BPU1RfREVGQVVMVF9URU1QTEFURSddOw0KICAgIH0NCg0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRQb3N0VHlwZV9DYXRlZ29yeVR5cGUoJHR5cGVpZCkNCiAgICB7DQogICAgICAgIGlmIChpc3NldCgkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF0pKSB7DQogICAgICAgICAgICByZXR1cm4gJHR5cGVpZDsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRQb3N0VHlwZV9UYWdUeXBlKCR0eXBlaWQpDQogICAgew0KICAgICAgICBpZiAoaXNzZXQoJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdKSkgew0KICAgICAgICAgICAgcmV0dXJuICR0eXBlaWQ7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDms6jlhoxBY3Rpb24uDQogICAgICoNCiAgICAgKiBAcGFyYW0gJG5hbWUNCiAgICAgKiBAcGFyYW0gJGxldmVsDQogICAgICogQHBhcmFtICR0aXRsZQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBSZWdBY3Rpb24oJG5hbWUsICRsZXZlbCwgJHRpdGxlKQ0KICAgIHsNCiAgICAgICAgJHRoaXMtPmFjdGlvbnNbJG5hbWVdID0gJGxldmVsOw0KICAgICAgICAkdGhpcy0+bGFuZ1snYWN0aW9ucyddWyRuYW1lXSA9ICR0aXRsZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDojrflvpdBY3Rpb27mnYPpmZDms6jph4ouDQogICAgICoNCiAgICAgKiBAcGFyYW0gJG5hbWUNCiAgICAgKg0KICAgICAqIEByZXR1cm4gbWl4ZWQNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0QWN0aW9uTmFtZSgkbmFtZSkNCiAgICB7DQogICAgICAgIHJldHVybiBHZXRWYWx1ZUluQXJyYXkoJHRoaXMtPmxhbmdbJ2FjdGlvbnMnXSwgJG5hbWUsICRuYW1lKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDms6jlhozot6/nlLHlh73mlbANCiAgICAgKg0KICAgICAqIEBwYXJhbSAkYXJyYXkg5pWw5o2u5pWw57uEKOivpue7hue7k+aehOWcqOWIneWni+WMluS4reacieivtOaYjikNCiAgICAgKiBAcGFyYW0gJHByZXBlbmQg5rOo5YaM6Lev55Sx5pe25o+S6Zif5Zyo5YmN6L65DQogICAgICoNCiAgICAgKiBAcmV0dXJuIG1peGVkDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFJlZ1JvdXRlKCRhcnJheSwgJHByZXBlbmQgPSBmYWxzZSkNCiAgICB7DQogICAgICAgICRyb3V0ZXMgPSAmJHRoaXMtPnJvdXRlczsNCiAgICAgICAgJG5ld19uYW1lID0gJGFycmF5Wyd0eXBlJ10gLiAnXycgLiAkYXJyYXlbJ25hbWUnXTsNCg0KICAgICAgICAkcG9zdGlkID0gR2V0VmFsdWVJbkFycmF5KCRhcnJheSwgJ3Bvc3R0eXBlJywgMCk7DQogICAgICAgICRwb3N0bmFtZSA9ICR0aGlzLT5HZXRQb3N0VHlwZSgkcG9zdGlkLCAnbmFtZScpOw0KICAgICAgICBpZiAoIWlzX251bGwoJHBvc3RpZCkgJiYgZW1wdHkoJGFycmF5Wyd1cmxydWxlJ10pKSB7DQogICAgICAgICAgICAkcHJlZml4X25hbWUgPSAncG9zdF8nIC4gJHBvc3RuYW1lIC4gJ18nOw0KICAgICAgICAgICAgJHByZWZpeF9ydWxlbmFtZSA9IHN0cl9pcmVwbGFjZSgkcHJlZml4X25hbWUsICcnLCAkYXJyYXlbJ25hbWUnXSk7DQogICAgICAgICAgICAkcnVsZW5hbWUgPSAkcHJlZml4X3J1bGVuYW1lIC4gJ191cmxydWxlJzsNCiAgICAgICAgICAgIGlmIChpc3NldCgkdGhpcy0+cG9zdHR5cGVbJHBvc3RpZF1bJHJ1bGVuYW1lXSkpIHsNCiAgICAgICAgICAgICAgICAkYXJyYXlbJ3VybHJ1bGUnXSA9ICR0aGlzLT5wb3N0dHlwZVskcG9zdGlkXVskcnVsZW5hbWVdOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCRwcmVwZW5kID09IGZhbHNlKSB7DQogICAgICAgICAgICAkcm91dGVzWyRuZXdfbmFtZV0gPSAkYXJyYXk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICB1bnNldCgkcm91dGVzWyRuZXdfbmFtZV0pOw0KICAgICAgICAgICAgJG5ld19hcnJheSA9IGFycmF5KCRuZXdfbmFtZSA9PiAkYXJyYXkpOw0KICAgICAgICAgICAgJHJvdXRlcyA9IGFycmF5X21lcmdlKCRuZXdfYXJyYXksICRyb3V0ZXMpOw0KICAgICAgICB9DQoNCiAgICAgICAgLy/lsIbot6/nlLHop4TliJnlhpnlhaVQb3N0VHlwZeaVsOe7hOmHjCAvL+i/mOmcgOimgeWIpOaWreadoeS7tumAieaLqeWGmeWFpQ0KICAgICAgICBpZiAoIWlzX251bGwoJHBvc3RpZCkpIHsNCiAgICAgICAgICAgICRiID0gZmFsc2U7DQogICAgICAgICAgICBpZiAoJGFycmF5Wyd0eXBlJ10gIT0gJ2RlZmF1bHQnKSB7DQogICAgICAgICAgICAgICAgaWYgKCR0aGlzLT5vcHRpb25bJ1pDX1NUQVRJQ19NT0RFJ10gPT0gJ1JFV1JJVEUnICYmICRhcnJheVsndHlwZSddID09ICdyZXdyaXRlJykgew0KICAgICAgICAgICAgICAgICAgICAkYiA9IHRydWU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmICgkdGhpcy0+b3B0aW9uWydaQ19TVEFUSUNfTU9ERSddID09ICdBQ1RJVkUnICYmICRhcnJheVsndHlwZSddID09ICdhY3RpdmUnKSB7DQogICAgICAgICAgICAgICAgICAgICRiID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIGlmIChpc3NldCgkYXJyYXlbJ29ubHlfYWN0aXZlJ10pICYmICRhcnJheVsnb25seV9hY3RpdmUnXSA9PSB0cnVlICYmICR0aGlzLT5vcHRpb25bJ1pDX1NUQVRJQ19NT0RFJ10gPT0gJ0FDVElWRScpIHsNCiAgICAgICAgICAgICAgICAgICAgJGIgPSB0cnVlOw0KICAgICAgICAgICAgICAgIH0gZWxzZWlmIChpc3NldCgkYXJyYXlbJ29ubHlfcmV3cml0ZSddKSAmJiAkYXJyYXlbJ29ubHlfcmV3cml0ZSddID09IHRydWUgJiYgJHRoaXMtPm9wdGlvblsnWkNfU1RBVElDX01PREUnXSA9PSAnUkVXUklURScpIHsNCiAgICAgICAgICAgICAgICAgICAgJGIgPSB0cnVlOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICRiID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoJGIpIHsNCiAgICAgICAgICAgICAgICAkdGhpcy0+U2V0UG9zdFR5cGVfU3ViKCRwb3N0aWQsICdyb3V0ZXMnLCAkYXJyYXlbJ25hbWUnXSwgYXJyYXkoJGFycmF5Wyd0eXBlJ10gPT4gJGFycmF5WyduYW1lJ10pKTsNCg0KICAgICAgICAgICAgICAgIGlmICghZW1wdHkoJGFycmF5Wyd1cmxydWxlJ10pKSB7ICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICRwcmVmaXhfbmFtZSA9ICdwb3N0XycgLiAkcG9zdG5hbWUgLiAnXyc7DQogICAgICAgICAgICAgICAgICAgICRwcmVmaXhfcnVsZW5hbWUgPSBzdHJfaXJlcGxhY2UoJHByZWZpeF9uYW1lLCAnJywgJGFycmF5WyduYW1lJ10pOw0KICAgICAgICAgICAgICAgICAgICAkcnVsZW5hbWUgPSAkcHJlZml4X3J1bGVuYW1lIC4gJ191cmxydWxlJzsNCiAgICAgICAgICAgICAgICAgICAgJHRoaXMtPlNldFBvc3RUeXBlKCRwb3N0aWQsICRydWxlbmFtZSwgJGFycmF5Wyd1cmxydWxlJ10pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDojrflj5bot6/nlLHlh73mlbANCiAgICAgKg0KICAgICAqIEBwYXJhbSAkdHlwZSDot6/nlLHnsbvlnosNCiAgICAgKiBAcGFyYW0gJG5hbWUg5ZCN56ewDQogICAgICoNCiAgICAgKiBAcmV0dXJuIG1peGVkDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFJvdXRlKCR0eXBlLCAkbmFtZSA9IG51bGwpDQogICAgew0KICAgICAgICAkcm91dGVzID0gJiR0aGlzLT5yb3V0ZXM7DQogICAgICAgIGlmIChpc19hcnJheSgkdHlwZSkpIHsNCiAgICAgICAgICAgICRuYW1lID0gY3VycmVudCgkdHlwZSk7DQogICAgICAgICAgICAkdHlwZSA9IGtleSgkdHlwZSk7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGlzc2V0KCRyb3V0ZXNbJHR5cGUgLiAnXycgLiAkbmFtZV0pKSB7DQogICAgICAgICAgICByZXR1cm4gJHJvdXRlc1skdHlwZSAuICdfJyAuICRuYW1lXTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWIoOmZpOi3r+eUseWHveaVsA0KICAgICAqDQogICAgICogQHBhcmFtICR0eXBlIOi3r+eUseexu+Weiw0KICAgICAqIEBwYXJhbSAkbmFtZSDlkI3np7ANCiAgICAgKg0KICAgICAqIEByZXR1cm4gbWl4ZWQNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gUmVtb3ZlUm91dGUoJHR5cGUsICRuYW1lID0gbnVsbCkNCiAgICB7DQogICAgICAgICRyb3V0ZXMgPSAmJHRoaXMtPnJvdXRlczsNCiAgICAgICAgaWYgKGlzX2FycmF5KCR0eXBlKSkgew0KICAgICAgICAgICAgJG5hbWUgPSBjdXJyZW50KCR0eXBlKTsNCiAgICAgICAgICAgICR0eXBlID0ga2V5KCR0eXBlKTsNCiAgICAgICAgfQ0KICAgICAgICB1bnNldCgkcm91dGVzWyR0eXBlIC4gJ18nIC4gJG5hbWVdKTsNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5riF56m65pW05Liq6Lev55SxIOaIliDmjIflrprot6/nlLHnsbvlnovnmoQNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQ2xlYXJSb3V0ZSgkcm91dGVfdHlwZSA9ICcnKQ0KICAgIHsNCiAgICAgICAgaWYgKCFlbXB0eSgkcm91dGVfdHlwZSkpIHsNCiAgICAgICAgICAgIGZvcmVhY2ggKCR0aGlzLT5yb3V0ZXMgYXMgJG5hbWUgPT4gJHZhbHVlKSB7DQogICAgICAgICAgICAgICAgaWYgKHN0cmlwb3MoJG5hbWUsICRyb3V0ZV90eXBlIC4gJ18nKSA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICB1bnNldCgkdGhpcy0+cm91dGVzWyRuYW1lXSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJHRoaXMtPnJvdXRlcyA9IGFycmF5KCk7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICAvL+S4vuS+i++8mmJhY2tlbmQtdWksLCwNCiAgICBwcm90ZWN0ZWQgJHByb3RlY3RfZXhjbHVzaXZlID0gYXJyYXkoKTsNCg0KICAgIC8qKg0KICAgICAqIOmAmuefpeezu+e7n+aOp+WItuadgy4NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gU2V0RXhjbHVzaXZlKCRmdW5jdGlvbiwgJGFwcGlkKQ0KICAgIHsNCiAgICAgICAgaWYgKCRhcHBpZCA9PSBmYWxzZSkgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQogICAgICAgICR0aGlzLT5wcm90ZWN0X2V4Y2x1c2l2ZVskZnVuY3Rpb25dID0gJGFwcGlkOw0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOafpeivouezu+e7n+aOp+WItuadgy4NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gSXNFeGNsdXNpdmUoJGZ1bmN0aW9uKQ0KICAgIHsNCiAgICAgICAgaWYgKGlzc2V0KCR0aGlzLT5wcm90ZWN0X2V4Y2x1c2l2ZVskZnVuY3Rpb25dKSkgew0KICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5wcm90ZWN0X2V4Y2x1c2l2ZVskZnVuY3Rpb25dOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOe7keWumnpicOS5i+WJjeeLrOeri+eahOadguS5seeahOWFqOWxgOWvueixoeaVsOe7hOWIsOaAu+e8k+WtmOWvueixoeS4ii4NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQmluZGluZ0NhY2hlKCkNCiAgICB7DQogICAgICAgICRjYWNoZW9iamVjdCA9ICYkdGhpcy0+Y2FjaGVvYmplY3Q7DQogICAgICAgIC8vcG9zdOexu+WPiuWFtua0vueUn+exu+mDveWQjOeUqOi/meS4gOS4que8k+WtmA0KICAgICAgICAkY2FjaGVvYmplY3RbJ1Bvc3QnXSA9ICYkdGhpcy0+cG9zdHM7DQogICAgICAgICRjYWNoZW9iamVjdFsnTWVtYmVyJ10gPSAmJHRoaXMtPm1lbWJlcnM7DQogICAgICAgIC8v5ZCM57G757yT5a2Y77yaJHRoaXMtPm1lbWJlcnNieW5hbWUNCiAgICAgICAgJGNhY2hlb2JqZWN0WydDYXRlZ29yeSddID0gJiR0aGlzLT5jYXRlZ29yaWVzX2FsbDsNCiAgICAgICAgLy/lkIznsbvnvJPlrZjvvJokdGhpcy0+Y2F0ZWdvcmllc190eXBlDQogICAgICAgICRjYWNoZW9iamVjdFsnVGFnJ10gPSAmJHRoaXMtPnRhZ3NfYWxsOw0KICAgICAgICAvL+WQjOexu+e8k+WtmO+8miR0aGlzLT50YWdzX3R5cGUNCiAgICAgICAgLy/lkIznsbvnvJPlrZjvvJokdGhpcy0+dGFnc2J5bmFtZV90eXBlDQogICAgICAgICRjYWNoZW9iamVjdFsnTW9kdWxlJ10gPSAmJHRoaXMtPm1vZHVsZXM7DQogICAgICAgIC8v5ZCM57G757yT5a2Y77yaJHRoaXMtPm1vZHVsZXNieWZpbGVuYW1lDQogICAgICAgICRjYWNoZW9iamVjdFsnQ29tbWVudCddID0gJiR0aGlzLT5jb21tZW50czsNCiAgICAgICAgJGNhY2hlb2JqZWN0WydVcGxvYWQnXSA9IGFycmF5KCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5bCG5a+56LGh6ZmE5Yqg5Yiw5oC757yT5a2Y5a+56LGh5LiKLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBBZGRDYWNoZSgmJG9iamVjdCkNCiAgICB7DQogICAgICAgICRjbGFzc25hbWUgPSBnZXRfY2xhc3MoJG9iamVjdCk7DQogICAgICAgIGlmIChpc19zdWJjbGFzc19vZigkb2JqZWN0LCAnQmFzZScpID09IGZhbHNlICYmICRjbGFzc25hbWUgIT0gJ0Jhc2UnKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCiAgICAgICAgJGNhY2hlb2JqZWN0ID0gJiR0aGlzLT5jYWNoZW9iamVjdDsNCiAgICAgICAgaWYgKGlzX3N1YmNsYXNzX29mKCRjbGFzc25hbWUsICdCYXNlUG9zdCcpID09IHRydWUpIHsNCiAgICAgICAgICAgICRjbGFzc25hbWUgPSAnUG9zdCc7DQogICAgICAgIH0NCiAgICAgICAgaWYgKCFpc3NldCgkY2FjaGVvYmplY3RbJGNsYXNzbmFtZV0pKSB7DQogICAgICAgICAgICAkY2FjaGVvYmplY3RbJGNsYXNzbmFtZV0gPSBhcnJheSgpOw0KICAgICAgICB9DQogICAgICAgIGlmIChlbXB0eSgkb2JqZWN0LT5JRCkpIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgICRjYWNoZW9iamVjdFskY2xhc3NuYW1lXVskb2JqZWN0LT5JRF0gPSAkb2JqZWN0Ow0KDQogICAgICAgIHN3aXRjaCAoJGNsYXNzbmFtZSkgew0KICAgICAgICAgICAgY2FzZSAnTW9kdWxlJzoNCiAgICAgICAgICAgICAgICAkdGhpcy0+bW9kdWxlc2J5ZmlsZW5hbWVbJG9iamVjdC0+RmlsZU5hbWVdID0gJiRjYWNoZW9iamVjdFskY2xhc3NuYW1lXVskb2JqZWN0LT5JRF07DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdUYWcnOg0KICAgICAgICAgICAgICAgIC8vaXNzZXQoJHRoaXMtPnRhZ3NfdHlwZVskb2JqZWN0LT5UeXBlXSkgfHwgJHRoaXMtPnRhZ3NfdHlwZVskb2JqZWN0LT5UeXBlXSA9IGFycmF5KCk7DQogICAgICAgICAgICAgICAgJHRoaXMtPnRhZ3NfdHlwZVskb2JqZWN0LT5UeXBlXVskb2JqZWN0LT5JRF0gPSAmJGNhY2hlb2JqZWN0WyRjbGFzc25hbWVdWyRvYmplY3QtPklEXTsNCiAgICAgICAgICAgICAgICAvL2lzc2V0KCR0aGlzLT50YWdzYnluYW1lX3R5cGVbJG9iamVjdC0+VHlwZV0pIHx8ICR0aGlzLT50YWdzYnluYW1lX3R5cGVbJG9iamVjdC0+VHlwZV0gPSBhcnJheSgpOw0KICAgICAgICAgICAgICAgICR0aGlzLT50YWdzYnluYW1lX3R5cGVbJG9iamVjdC0+VHlwZV1bJG9iamVjdC0+TmFtZV0gPSAmJGNhY2hlb2JqZWN0WyRjbGFzc25hbWVdWyRvYmplY3QtPklEXTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ0NhdGVnb3J5JzoNCiAgICAgICAgICAgICAgICAvL2lzc2V0KCR0aGlzLT5jYXRlZ29yaWVzX3R5cGVbJG9iamVjdC0+VHlwZV0pIHx8ICR0aGlzLT5jYXRlZ29yaWVzX3R5cGVbJG9iamVjdC0+VHlwZV0gPSBhcnJheSgpOw0KICAgICAgICAgICAgICAgICR0aGlzLT5jYXRlZ29yaWVzX3R5cGVbJG9iamVjdC0+VHlwZV1bJG9iamVjdC0+SURdID0gJiRjYWNoZW9iamVjdFskY2xhc3NuYW1lXVskb2JqZWN0LT5JRF07DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdNZW1iZXInOg0KICAgICAgICAgICAgICAgICR0aGlzLT5tZW1iZXJzYnluYW1lWyRvYmplY3QtPk5hbWVdID0gJiRjYWNoZW9iamVjdFskY2xhc3NuYW1lXVskb2JqZWN0LT5JRF07DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5bCG5a+56LGh6ZmE5LuO5oC757yT5a2Y5a+56LGh5LiK5Yig6Zmk5o6JLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBSZW1vdmVDYWNoZSgmJG9iamVjdCkNCiAgICB7DQogICAgICAgICRjbGFzc25hbWUgPSBnZXRfY2xhc3MoJG9iamVjdCk7DQogICAgICAgIGlmIChpc19zdWJjbGFzc19vZigkb2JqZWN0LCAnQmFzZScpID09IGZhbHNlICYmICRjbGFzc25hbWUgIT0gJ0Jhc2UnKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCiAgICAgICAgJGNhY2hlb2JqZWN0ID0gJiR0aGlzLT5jYWNoZW9iamVjdDsNCiAgICAgICAgaWYgKGlzX3N1YmNsYXNzX29mKCRjbGFzc25hbWUsICdCYXNlUG9zdCcpID09IHRydWUpIHsNCiAgICAgICAgICAgICRjbGFzc25hbWUgPSAnUG9zdCc7DQogICAgICAgIH0NCiAgICAgICAgaWYgKCFpc3NldCgkY2FjaGVvYmplY3RbJGNsYXNzbmFtZV0pKSB7DQogICAgICAgICAgICAkY2FjaGVvYmplY3RbJGNsYXNzbmFtZV0gPSBhcnJheSgpOw0KICAgICAgICB9DQogICAgICAgIGlmIChlbXB0eSgkb2JqZWN0LT5JRCkpIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgIHN3aXRjaCAoJGNsYXNzbmFtZSkgew0KICAgICAgICAgICAgY2FzZSAnTW9kdWxlJzoNCiAgICAgICAgICAgICAgICB1bnNldCgkdGhpcy0+bW9kdWxlc2J5ZmlsZW5hbWVbJG9iamVjdC0+RmlsZU5hbWVdKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ01lbWJlcic6DQogICAgICAgICAgICAgICAgdW5zZXQoJHRoaXMtPm1lbWJlcnNieW5hbWVbJG9iamVjdC0+TmFtZV0pOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnVGFnJzoNCiAgICAgICAgICAgICAgICB1bnNldCgkdGhpcy0+dGFnc190eXBlWyRvYmplY3QtPlR5cGVdWyRvYmplY3QtPklEXSk7DQogICAgICAgICAgICAgICAgdW5zZXQoJHRoaXMtPnRhZ3NieW5hbWVfdHlwZVskb2JqZWN0LT5UeXBlXVskb2JqZWN0LT5OYW1lXSk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdDYXRlZ29yeSc6DQogICAgICAgICAgICAgICAgdW5zZXQoJHRoaXMtPmNhdGVnb3JpZXNfdHlwZVskb2JqZWN0LT5UeXBlXVskb2JqZWN0LT5JRF0pOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICB9DQogICAgICAgIHVuc2V0KCRjYWNoZW9iamVjdFskY2xhc3NuYW1lXVskb2JqZWN0LT5JRF0pOw0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWwhlBvc3Tnsbvlr7nosaHpmYTliqDliLBQb3N057yT5a2Y5a+56LGh5LiKLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBBZGRQb3N0Q2FjaGUoJiRvYmplY3QpDQogICAgew0KICAgICAgICByZXR1cm4gJHRoaXMtPkFkZENhY2hlKCRvYmplY3QpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWwhlBvc3Tnsbvlr7nosaHpmYTku45Qb3N057yT5a2Y5a+56LGh5LiK5Yig6Zmk5o6JLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBSZW1vdmVQb3N0Q2FjaGUoJiRvYmplY3QpDQogICAgew0KICAgICAgICByZXR1cm4gJHRoaXMtPlJlbW92ZUNhY2hlKCRvYmplY3QpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOafpeivouWvueixoeeahElE55qE5YC85piv5ZCm5a2Y5Zyo5LqO5oC757yT5a2Y5a+56LGh5LiKLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBDaGVja0NhY2hlKCRjbGFzc25hbWUsICRpZHZhbHVlID0gbnVsbCkNCiAgICB7DQogICAgICAgIC8v5aaC5p6c5Y+q57uZ5LqG56ys5LiA5Liq5Y+C5pWw77yM5LiU5pivb2JqZWN055qE6K+dDQogICAgICAgIGlmIChpc19vYmplY3QoJGNsYXNzbmFtZSkpIHsNCiAgICAgICAgICAgIGlmIChpc19zdWJjbGFzc19vZigkY2xhc3NuYW1lLCAnQmFzZScpID09IGZhbHNlICYmIGdldF9jbGFzcygkY2xhc3NuYW1lKSAhPSAnQmFzZScpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICB9DQogICAgICAgICAgICAkaWRuYW1lID0gJGNsYXNzbmFtZS0+R2V0SWROYW1lKCk7DQogICAgICAgICAgICAkaWR2YWx1ZSA9ICRjbGFzc25hbWUtPiRpZG5hbWU7DQogICAgICAgICAgICAkY2xhc3NuYW1lID0gZ2V0X2NsYXNzKCRjbGFzc25hbWUpOw0KICAgICAgICB9DQogICAgICAgIGlmIChpc19zdWJjbGFzc19vZigkY2xhc3NuYW1lLCAnQmFzZScpID09IGZhbHNlICYmICRjbGFzc25hbWUgIT0gJ0Jhc2UnKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCiAgICAgICAgJGNhY2hlb2JqZWN0ID0gJiR0aGlzLT5jYWNoZW9iamVjdDsNCiAgICAgICAgaWYgKGlzX3N1YmNsYXNzX29mKCRjbGFzc25hbWUsICdCYXNlUG9zdCcpID09IHRydWUpIHsNCiAgICAgICAgICAgICRjbGFzc25hbWUgPSAnUG9zdCc7DQogICAgICAgIH0NCiAgICAgICAgaWYgKCFpc3NldCgkY2FjaGVvYmplY3RbJGNsYXNzbmFtZV0pKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gYXJyYXlfa2V5X2V4aXN0cygkaWR2YWx1ZSwgJGNhY2hlb2JqZWN0WyRjbGFzc25hbWVdKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDojrflj5bmjIflrppjbGFzc25hbWXnmoTnvJPlrZjmlbDnu4TvvIzmjIflrprkuoYkaWR2YWx1ZeWwsei/lOWbnuWNleS4queahG9iamVjdO+8jOS4jeaMh+WumuWwsei/lOWbnm9iamVjdHMNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gJkdldENhY2hlKCRjbGFzc25hbWUsICRpZHZhbHVlID0gbnVsbCkNCiAgICB7DQogICAgICAgICRjYWNoZW9iamVjdCA9ICYkdGhpcy0+Y2FjaGVvYmplY3Q7DQogICAgICAgIGlmIChpc19zdWJjbGFzc19vZigkY2xhc3NuYW1lLCAnQmFzZVBvc3QnKSA9PSB0cnVlKSB7DQogICAgICAgICAgICAkY2xhc3NuYW1lID0gJ1Bvc3QnOw0KICAgICAgICB9DQogICAgICAgIGlmICghaXNzZXQoJGNhY2hlb2JqZWN0WyRjbGFzc25hbWVdKSkgew0KICAgICAgICAgICAgJGNhY2hlb2JqZWN0WyRjbGFzc25hbWVdID0gYXJyYXkoKTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoIWlzX251bGwoJGlkdmFsdWUpKSB7DQogICAgICAgICAgICBpZiAoYXJyYXlfa2V5X2V4aXN0cygkaWR2YWx1ZSwgJGNhY2hlb2JqZWN0WyRjbGFzc25hbWVdKSkgew0KICAgICAgICAgICAgICAgIHJldHVybiAkY2FjaGVvYmplY3RbJGNsYXNzbmFtZV1bJGlkdmFsdWVdOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAkbnVsbCA9IG51bGw7DQogICAgICAgICAgICAgICAgcmV0dXJuICRudWxsOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHJldHVybiAkY2FjaGVvYmplY3RbJGNsYXNzbmFtZV07DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5Lul5LiL6YOo5YiG5Li65bey5bqf5byD77yM5L2G6ICD6JmR5Yiw5YW85a655oCn5L+d55WZ55qE5Luj56CBKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiouDQogICAgICovDQoNCiAgICAvKioNCiAgICAgKiDmo4DmtYvlvZPliY11cmzvvIzlpoLmnpzkuI3nrKblkIjorr7nva7lsLHot7PovazliLDlm7rlrprln5/lkI3nmoTpk77mjqUuDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFJlZGlyZWN0UGVybWFuZW50RG9tYWluKCkNCiAgICB7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5qOA5p+l5bm25byA5ZCvR3ppcOWOi+e8qS4NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQ2hlY2tHemlwKCkNCiAgICB7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5ZCv55SoR3ppcC4NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gU3RhcnRHemlwKCkNCiAgICB7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6aqM6K+B55So5oi355m75b2V77yITUQ15YqgemJwLT5ndWlk55uQ5ZCO55qE5a+G56CB77yJLg0KICAgICAqDQogICAgICogQGRlcHJlY2F0ZWQNCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUgICAgICAgICDnlKjmiLflkI0NCiAgICAgKiBAcGFyYW0gc3RyaW5nICRwc19wYXRoX2hhc2ggTUQ15YqgemJwLT5ndWlk55uQ5ZCO55qE5a+G56CBDQogICAgICogQHBhcmFtIG9iamVjdCAkbWVtYmVyICAgICAgIOi/lOWbnuivu+WPluaIkOWKn+eahG1lbWJlcuWvueixoQ0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFZlcmlmeV9NRDVQYXRoKCRuYW1lLCAkcHNfcGF0aF9oYXNoLCAmJG1lbWJlciA9IG51bGwpDQogICAgew0KICAgICAgICBpZiAoJG5hbWUgPT0gJycgfHwgJHBzX3BhdGhfaGFzaCA9PSAnJykgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQogICAgICAgICRtID0gJHRoaXMtPkdldE1lbWJlckJ5TmFtZSgkbmFtZSk7DQogICAgICAgIGlmICgkbS0+SUQgIT0gbnVsbCkgew0KICAgICAgICAgICAgaWYgKCRtLT5QYXNzV29yZF9NRDVQYXRoID09ICRwc19wYXRoX2hhc2gpIHsNCiAgICAgICAgICAgICAgICAkbWVtYmVyID0gJG07DQoNCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDojrflj5ZDU1JGIFRva2Vu55qE6ZSZ6K+v5Yir5ZCNLg0KICAgICAqDQogICAgICogQGRlcHJlY2F0ZWQgVXNlIGBgR2V0Q1NSRlRva2VuYGANCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJGlkIOW6lOeUqElE77yM5Y+v5Lul5L+d6K+B5q+P5Liq5bqU55So6I635Y+W5LiN5ZCM55qEVG9rZW4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gc3RyaW5nDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFRva2VuKCRpZCA9ICcnKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuICR0aGlzLT5HZXRDU1JGVG9rZW4oJGlkKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpqozor4FDU1JGIFRva2Vu55qE6ZSZ6K+v5Yir5ZCNLg0KICAgICAqDQogICAgICogQGRlcHJlY2F0ZWQgVXNlIGBgVmVyaWZ5Q1NSRlRva2VuYGANCiAgICAgKg0KICAgICAqIEBwYXJhbSAkdA0KICAgICAqIEBwYXJhbSAkaWQNCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBWYWxpZFRva2VuKCR0LCAkaWQgPSAnJykNCiAgICB7DQogICAgICAgIHJldHVybiAkdGhpcy0+VmVyaWZ5Q1NSRlRva2VuKCR0LCAkaWQpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBkZXByZWNhdGVkDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gTG9hZENhdGVnb3J5cygpDQogICAgew0KICAgICAgICByZXR1cm4gJHRoaXMtPkxvYWRDYXRlZ29yaWVzKCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogQGRlcHJlY2F0ZWQNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0QWN0aW9uRGVzY3JpcHRpb24oJG5hbWUpDQogICAgew0KICAgICAgICByZXR1cm4gJHRoaXMtPkdldEFjdGlvbk5hbWUoJG5hbWUpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOiOt+WPluS8muivnVdlYlRva2VuLg0KICAgICAqDQogICAgICogQGRlcHJlY2F0ZWQg5q+r5peg5oSP5LmJ77yM5Y2z5bCG5bqf5byDDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICR3dF9pZA0KICAgICAqIEBwYXJhbSBpbnQgICAgJGRheSAgIOm7mOiupDHlpKnmnInmlYjmnJ/vvIwx5bCP5pe25Li6MS8yNO+8jDHliIbpkp/kuLoxLygyNCo2MCkNCiAgICAgKg0KICAgICAqIEByZXR1cm4gc3RyaW5nDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFdlYlRva2VuKCR3dF9pZCA9ICcnLCAkZGF5ID0gMSkNCiAgICB7DQogICAgICAgICR0ID0gKGludHZhbCgkZGF5ICogMjQgKiAzNjAwKSArIHRpbWUoKSk7DQoNCiAgICAgICAgcmV0dXJuIENyZWF0ZVdlYlRva2VuKCR3dF9pZCwgJHQsICR0aGlzLT5ndWlkLCAkdGhpcy0+dXNlci0+U3RhdHVzLCAkdGhpcy0+dXNlci0+SUQsICR0aGlzLT51c2VyLT5QYXNzd29yZCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6aqM6K+B5Lya6K+dV2ViVG9rZW4uDQogICAgICoNCiAgICAgKiBAZGVwcmVjYXRlZCDmr6vml6DmhI/kuYnvvIzljbPlsIblup/lvIMNCiAgICAgKg0KICAgICAqIEBwYXJhbSAkd3QNCiAgICAgKiBAcGFyYW0gJHd0X2lkDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gVmFsaWRXZWJUb2tlbigkd3QsICR3dF9pZCA9ICcnKQ0KICAgIHsNCiAgICAgICAgaWYgKFZlcmlmeVdlYlRva2VuKCR3dCwgJHd0X2lkLCAkdGhpcy0+Z3VpZCwgJHRoaXMtPnVzZXItPlN0YXR1cywgJHRoaXMtPnVzZXItPklELCAkdGhpcy0+dXNlci0+UGFzc3dvcmQpID09PSB0cnVlKSB7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICB9DQoNCn0NCg==</file>
</files>
