<files codepage='65001' xmlns:dt='urn:schemas-microsoft-com:datatypes'>
	<file name='zb_system\function\lib\metas.php' crc32='1E566597'  dt:dt='bin.base64'>PD9waHANCg0KaWYgKCFkZWZpbmVkKCdaQlBfUEFUSCcpKSB7DQogICAgZXhpdCgnQWNjZXNzIGRlbmllZCcpOw0KfQ0KDQovKioNCiAqIOaJqeWxleWGheWuueexuy4NCiAqDQogKiBAcHJvcGVydHkgc3RyaW5nIE5hbWUNCiAqIEBwcm9wZXJ0eSBpbnR8c3RyaW5nIENvdW50DQogKiBAcHJvcGVydHkgc3RyaW5nIFVybA0KICovDQpjbGFzcyBNZXRhcw0Kew0KDQogICAgLyoqDQogICAgICogQHZhciBhcnJheSDlrZjlgqhNZXRhc+ebuOW6lOaVsOWAvOeahOaVsOe7hA0KICAgICAqLw0KICAgIHByaXZhdGUgJHBfZGF0YSA9IGFycmF5KCk7DQoNCiAgICAvKioNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRuYW1lIGtleeWQjQ0KICAgICAqIEBwYXJhbSAkdmFsdWUNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gX19zZXQoJG5hbWUsICR2YWx1ZSkNCiAgICB7DQogICAgICAgICR0aGlzLT5wX2RhdGFbJG5hbWVdID0gJHZhbHVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUga2V55ZCNDQogICAgICoNCiAgICAgKiBAcmV0dXJuIG51bGwNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gX19nZXQoJG5hbWUpDQogICAgew0KICAgICAgICBpZiAoIWlzc2V0KCR0aGlzLT5wX2RhdGFbJG5hbWVdKSkgew0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICR0aGlzLT5wX2RhdGFbJG5hbWVdOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBwYXJhbSAkbmFtZQ0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIF9faXNzZXQoJG5hbWUpDQogICAgew0KICAgICAgICByZXR1cm4gaXNzZXQoJHRoaXMtPnBfZGF0YVskbmFtZV0pOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBwYXJhbSAkbmFtZQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBfX3Vuc2V0KCRuYW1lKQ0KICAgIHsNCiAgICAgICAgdW5zZXQoJHRoaXMtPnBfZGF0YVskbmFtZV0pOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWwhuaVsOe7hOaVsOaNrui9rOaNouS4uk1ldGFz5a6e5L6LLg0KICAgICAqDQogICAgICogQHBhcmFtIGFycmF5ICRhDQogICAgICoNCiAgICAgKiBAcmV0dXJuIE1ldGFzDQogICAgICovDQogICAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiBDb252ZXJ0QXJyYXkoJGEpDQogICAgew0KICAgICAgICAkbSA9IG5ldyBzZWxmKCk7DQogICAgICAgIGlmIChpc19hcnJheSgkYSkpIHsNCiAgICAgICAgICAgICRtLT5wX2RhdGEgPSAkYTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAkbTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDojrflj5ZEYXRh5pWw5o2uLg0KICAgICAqDQogICAgICogQHJldHVybiBhcnJheQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXREYXRhKCkNCiAgICB7DQogICAgICAgIHJldHVybiAkdGhpcy0+cF9kYXRhOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOS+neaNrnpicOiuvue9ruabv+aNouetvuagh+S4umhvc3TlgLzmiJbmmK/lm7rlrprln5/lkI0uDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICR2YWx1ZQ0KICAgICAqDQogICAgICogQHJldHVybiBzdHJpbmcNCiAgICAgKi8NCiAgICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIFJlcGxhY2VUYWcySG9zdCgkdmFsdWUpDQogICAgew0KICAgICAgICBnbG9iYWwgJGJsb2dob3N0Ow0KDQogICAgICAgIHJldHVybiBzdHJfcmVwbGFjZSgneyNaQ19CTE9HX0hPU1QjfScsICRibG9naG9zdCwgJHZhbHVlKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDkvp3mja56YnDorr7nva7mm7/mjaJob3N05YC85Li6562+5qCHLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkdmFsdWUNCiAgICAgKg0KICAgICAqIEByZXR1cm4gc3RyaW5nDQogICAgICovDQogICAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiBSZXBsYWNlSG9zdDJUYWcoJHZhbHVlKQ0KICAgIHsNCiAgICAgICAgZ2xvYmFsICRibG9naG9zdDsNCg0KICAgICAgICByZXR1cm4gc3RyX3JlcGxhY2UoJGJsb2dob3N0LCAneyNaQ19CTE9HX0hPU1QjfScsICR2YWx1ZSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5qOA5p+lRGF0YeWxnuaAp++8iOaVsOe7hO+8ieWxnuaAp+WAvOaYr+aYr+WQpuWtmOWcqOebuOW6lGtleS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUga2V55ZCNDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gSGFzS2V5KCRuYW1lKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuIGFycmF5X2tleV9leGlzdHMoJG5hbWUsICR0aGlzLT5wX2RhdGEpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOajgOafpURhdGHlsZ7mgKfvvIjmlbDnu4TvvInkuK3nmoTljZXlhYPmlbDnm64uDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGludA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBDb3VudEl0ZW0oKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuIGNvdW50KCR0aGlzLT5wX2RhdGEpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWIoOmZpERhdGHlsZ7mgKfvvIjmlbDnu4TvvInkuK3nmoTnm7jlupTpobkuDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRuYW1lIGtleeWQjQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBEZWwoJG5hbWUpDQogICAgew0KICAgICAgICB1bnNldCgkdGhpcy0+cF9kYXRhWyRuYW1lXSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5bCGRGF0YeWxnuaAp++8iOaVsOe7hO+8ieWAvOW6j+WIl+WMli4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gc3RyaW5nIOi/lOWbnuW6j+WIl+WMlueahOWAvA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBTZXJpYWxpemUoKQ0KICAgIHsNCiAgICAgICAgaWYgKGNvdW50KCR0aGlzLT5wX2RhdGEpID09IDApIHsNCiAgICAgICAgICAgIHJldHVybiAnJzsNCiAgICAgICAgfQ0KDQogICAgICAgICRkYXRhID0gJHRoaXMtPnBfZGF0YTsNCiAgICAgICAgZm9yZWFjaCAoJGRhdGEgYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgICAgIGlmIChpc19zdHJpbmcoJHZhbHVlKSkgew0KICAgICAgICAgICAgICAgICRkYXRhWyRrZXldID0gc2VsZjo6UmVwbGFjZUhvc3QyVGFnKCR2YWx1ZSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAvL3JldHVybiBqc29uX2VuY29kZSgkZGF0YSk7DQogICAgICAgIHJldHVybiBzZXJpYWxpemUoJGRhdGEpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWwhuW6j+WIl+WMlueahOWAvOWPjeW6j+WIl+WMluWQjui1i+S6iERhdGHlsZ7mgKflgLwNCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHMg5bqP5YiX5YyW5YC8DQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gVW5zZXJpYWxpemUoJHMpDQogICAgew0KICAgICAgICBpZiAoJHMgPT0gJycpIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vaWYoc3RycG9zKCRzLCd7Jyk9PT0wKXsNCiAgICAgICAgLy8kdGhpcy0+cF9kYXRhPWpzb25fZGVjb2RlKCRzLHRydWUpOw0KICAgICAgICAvL31lbHNlew0KICAgICAgICBAJHRoaXMtPnBfZGF0YSA9IHVuc2VyaWFsaXplKCRzKTsNCiAgICAgICAgLy99DQogICAgICAgIGlmIChpc19hcnJheSgkdGhpcy0+cF9kYXRhKSkgew0KICAgICAgICAgICAgaWYgKGNvdW50KCR0aGlzLT5wX2RhdGEpID09IDApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgZm9yZWFjaCAoJHRoaXMtPnBfZGF0YSBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAgICAgICAgIGlmIChpc19zdHJpbmcoJHZhbHVlKSkgew0KICAgICAgICAgICAgICAgICAgICAkdGhpcy0+cF9kYXRhWyRrZXldID0gc2VsZjo6UmVwbGFjZVRhZzJIb3N0KCR2YWx1ZSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJHRoaXMtPnBfZGF0YSA9IGFycmF5KCk7DQoNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KfQ0K</file>
	<file name='zb_system\function\lib\zblogphp.php' crc32='DD416665'  dt:dt='bin.base64'>PD9waHANCg0KaWYgKCFkZWZpbmVkKCdaQlBfUEFUSCcpKSB7DQogICAgZXhpdCgnQWNjZXNzIGRlbmllZCcpOw0KfQ0KLyoqDQogKiB6YnDlhajlsYDmk43kvZznsbsuDQogKi8NCmNsYXNzIFpCbG9nUEhQDQp7DQoNCiAgICBwcml2YXRlIHN0YXRpYyAkcHJpdmF0ZV96YnAgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcg54mI5pys5Y+3DQogICAgICovDQogICAgcHVibGljICR2ZXJzaW9uID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgRGF0YWJhc2VfX0ludGVyZmFjZSDmlbDmja7lupMNCiAgICAgKi8NCiAgICBwdWJsaWMgJGRiID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgYXJyYXkg6YWN572u6YCJ6aG5DQogICAgICovDQogICAgcHVibGljICRvcHRpb24gPSBhcnJheSgpOw0KDQogICAgLyoqDQogICAgICogQHZhciBhcnJheSDor63oqIANCiAgICAgKi8NCiAgICBwdWJsaWMgJGxhbmcgPSBhcnJheSgpOw0KDQogICAgLyoqDQogICAgICogQHZhciBqc29u57G75Z6LIOivreiogA0KICAgICAqLw0KICAgIHB1YmxpYyAkbGFuZ3MgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBhcnJheSDor63oqIDljIVsaXN0DQogICAgICovDQogICAgcHVibGljICRsYW5ncGFja2xpc3QgPSBhcnJheSgpOw0KDQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcg6Lev5b6EDQogICAgICovDQogICAgcHVibGljICRwYXRoID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nIOWfn+WQjQ0KICAgICAqLw0KICAgIHB1YmxpYyAkaG9zdCA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIHN0cmluZyBjb29raWXkvZznlKjln58NCiAgICAgKi8NCiAgICBwdWJsaWMgJGNvb2tpZXNwYXRoID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nIGd1aWQNCiAgICAgKi8NCiAgICBwdWJsaWMgJGd1aWQgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcg5b2T5YmN6ZO+5o6lDQogICAgICovDQogICAgcHVibGljICRjdXJyZW50dXJsID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nIOW9k+WJjemTvuaOpQ0KICAgICAqLw0KICAgIHB1YmxpYyAkZnVsbGN1cnJlbnR1cmwgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcgU3lzdGVt55uu5b2VDQogICAgICovDQogICAgcHVibGljICRzeXN0ZW1kaXIgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcgQWRtaW7nm67lvZUNCiAgICAgKi8NCiAgICBwdWJsaWMgJGFkbWluZGlyID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nIOeUqOaIt+ebruW9lQ0KICAgICAqLw0KICAgIHB1YmxpYyAkdXNlcnNkaXIgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcgU3lzdGVtIFVybA0KICAgICAqLw0KICAgIHB1YmxpYyAkc3lzdGVtdXJsID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nIEFkbWluIFVybA0KICAgICAqLw0KICAgIHB1YmxpYyAkYWRtaW51cmwgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcg55So5oi3VXJsDQogICAgICovDQogICAgcHVibGljICR1c2Vyc3VybCA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIHN0cmluZyBDYWNoZeebruW9lQ0KICAgICAqLw0KICAgIHB1YmxpYyAkY2FjaGVkaXIgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcgTG9nc+ebruW9lQ0KICAgICAqLw0KICAgIHB1YmxpYyAkbG9nc2RpciA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIHN0cmluZyBEYXRh55uu5b2VDQogICAgICovDQogICAgcHVibGljICRkYXRhZGlyID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nIOmqjOivgeeggeWcsOWdgA0KICAgICAqLw0KICAgIHB1YmxpYyAkdmVyaWZ5Q29kZVVybCA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIHN0cmluZyDpqozor4HnoIHlnLDlnYDvvIjmi7zlhpnplJnor6/vvIkNCiAgICAgKg0KICAgICAqIEBkZXByZWNhdGVkDQogICAgICovDQogICAgcHVibGljICR2YWxpZGNvZGV1cmwgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcNCiAgICAgKi8NCiAgICBwdWJsaWMgJGZlZWR1cmwgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcNCiAgICAgKi8NCiAgICBwdWJsaWMgJHNlYXJjaHVybCA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIHN0cmluZw0KICAgICAqLw0KICAgIHB1YmxpYyAkYWpheHVybCA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIHN0cmluZw0KICAgICAqLw0KICAgIHB1YmxpYyAkeG1scnBjdXJsID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nDQogICAgICovDQogICAgcHVibGljICRhcGl1cmwgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcNCiAgICAgKi8NCiAgICBwdWJsaWMgJGNtZHVybCA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIE1lbWJlcltdIOeUqOaIt+aVsOe7hA0KICAgICAqLw0KICAgIHB1YmxpYyAkbWVtYmVycyA9IGFycmF5KCk7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIE1lbWJlcltdIOeUqOaIt+aVsOe7hO+8iOS7peeUqOaIt+WQjeS4uumUru+8iQ0KICAgICAqLw0KICAgIHB1YmxpYyAkbWVtYmVyc2J5bmFtZSA9IGFycmF5KCk7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIENhdGVnb3J5W10g5YiG57G75pWw57uEICgkY2F0ZWdvcnlz5bey5bqf5byDKQ0KICAgICAqLw0KICAgIHB1YmxpYyAkY2F0ZWdvcnlzID0gYXJyYXkoKTsNCg0KICAgIHB1YmxpYyAkY2F0ZWdvcmllcyA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIENhdGVnb3J5W10g5YiG57G75pWw57uEQUxMDQogICAgICovDQogICAgcHVibGljICRjYXRlZ29yaWVzX2FsbCA9IGFycmF5KCk7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIENhdGVnb3J5W10g5YiG57G75pWw57uE77yI5bey5o6S5bqP77yJICgkY2F0ZWdvcnlzYnlvcmRlcuW3suW6n+W8gykgIGNhdGVnb3JpZXPlvJXnlKgNCiAgICAgKi8NCiAgICBwdWJsaWMgJGNhdGVnb3J5c2J5b3JkZXIgPSBhcnJheSgpOw0KDQogICAgcHVibGljICRjYXRlZ29yaWVzYnlvcmRlciA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIENhdGVnb3J5W10g5oyJ57G75Z6L5YiG57G755qEMue7tOaVsOe7hCAvL+acrOi6q+aXoOaEj+S5ieS6hu+8jOeOsOW8leeUqOiHqiRjYXRlZ29yaWVzYnlvcmRlcl90eXBlDQogICAgICovDQogICAgcHVibGljICRjYXRlZ29yaWVzX3R5cGUgPSBhcnJheSgpOw0KDQogICAgLyoqDQogICAgICogQHZhciBDYXRlZ29yeVtdIOaMieexu+Wei+WIhuexuzLnu7TmlbDnu4TvvIjlt7LmjpLluo/vvIljYXRlZ29yaWVzX3R5cGXlvJXnlKgNCiAgICAgKi8NCiAgICBwdWJsaWMgJGNhdGVnb3JpZXNieW9yZGVyX3R5cGUgPSBhcnJheSgpOw0KDQogICAgLyoqDQogICAgICogQHZhciBNb2R1bGVbXSDmqKHlnZfmlbDnu4QNCiAgICAgKi8NCiAgICBwdWJsaWMgJG1vZHVsZXMgPSBhcnJheSgpOw0KDQogICAgLyoqDQogICAgICogQHZhciBNb2R1bGVbXSDmqKHlnZfmlbDnu4TvvIjku6Xmlofku7blkI3kuLrplK7vvIkNCiAgICAgKi8NCiAgICBwdWJsaWMgJG1vZHVsZXNieWZpbGVuYW1lID0gYXJyYXkoKTsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgQ29uZmlnW10g6YWN572u6YCJ6aG5DQogICAgICovDQogICAgcHVibGljICRjb25maWdzID0gYXJyYXkoKTsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgVGFnW10g5qCH562+5pWw57uEDQogICAgICovDQogICAgcHVibGljICR0YWdzID0gYXJyYXkoKTsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgVGFnW10g5qCH562+5pWw57uE77yI5Lul5qCH562+5ZCN5Li66ZSu77yJDQogICAgICovDQogICAgcHVibGljICR0YWdzYnluYW1lID0gYXJyYXkoKTsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgYXJyYXkg5qCH562+5pWw57uEIEFMTA0KICAgICAqLw0KICAgIHB1YmxpYyAkdGFnc19hbGwgPSBhcnJheSgpOw0KDQogICAgLyoqDQogICAgICogQHZhciBhcnJheSDmoIfnrb7mlbDnu4QgQnkgVHlwZSAy57u05pWw57uEDQogICAgICovDQogICAgcHVibGljICR0YWdzX3R5cGUgPSBhcnJheSgpOw0KDQogICAgLyoqDQogICAgICogQHZhciBhcnJheSDmoIfnrb7mlbDnu4QgQnkgVHlwZe+8iOS7peagh+etvuWQjeS4uumUru+8iTLnu7TmlbDnu4QNCiAgICAgKi8NCiAgICBwdWJsaWMgJHRhZ3NieW5hbWVfdHlwZSA9IGFycmF5KCk7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIENvbW1lbnRbXSDor4TorrrmlbDnu4QNCiAgICAgKi8NCiAgICBwdWJsaWMgJGNvbW1lbnRzID0gYXJyYXkoKTsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgUG9zdFtdIOaWh+eroOWIl+ihqOaVsOe7hA0KICAgICAqLw0KICAgIHB1YmxpYyAkcG9zdHMgPSBhcnJheSgpOw0KDQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcg5b2T5YmN6aG16Z2i5qCH6aKYDQogICAgICovDQogICAgcHVibGljICR0aXRsZSA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIHN0cmluZyDnvZHnq5nlkI0NCiAgICAgKi8NCiAgICBwdWJsaWMgJG5hbWUgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcg572R56uZ5a2Q5qCH6aKYDQogICAgICovDQogICAgcHVibGljICRzdWJuYW1lID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgQXBwIOW9k+WJjeS4u+mimA0KICAgICAqLw0KICAgIHB1YmxpYyAkdGhlbWUgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBhcnJheSgpIOW9k+WJjeS4u+mimOeJiOacrOS/oeaBrw0KICAgICAqLw0KICAgIHB1YmxpYyAkdGhlbWVpbmZvID0gYXJyYXkoKTsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nIOW9k+WJjeS4u+mimOmjjuagvA0KICAgICAqLw0KICAgIHB1YmxpYyAkc3R5bGUgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBNZW1iZXIg5b2T5YmN55So5oi3DQogICAgICovDQogICAgcHVibGljICR1c2VyID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgQ29uZmlnIOe8k+WtmA0KICAgICAqLw0KICAgIHB1YmxpYyAkY2FjaGUgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBhcnJheXxudWxsIOaVsOaNruihqA0KICAgICAqLw0KICAgIHB1YmxpYyAkdGFibGUgPSBudWxsOw0KDQogICAgcHVibGljICR0ID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgYXJyYXl8bnVsbCDmlbDmja7ooajkv6Hmga8NCiAgICAgKi8NCiAgICBwdWJsaWMgJGRhdGFpbmZvID0gbnVsbDsNCg0KICAgIHB1YmxpYyAkZCA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIGFycmF5fG51bGwg57G75Z6L5bqP5YiXDQogICAgICovDQogICAgcHVibGljICRwb3N0dHlwZSA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIGFycmF5fG51bGwg5pON5L2c5YiX6KGoDQogICAgICovDQogICAgcHVibGljICRhY3Rpb25zID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgbWl4ZWR8bnVsbHxzdHJpbmcg5b2T5YmN5pON5L2cDQogICAgICovDQogICAgcHVibGljICRhY3Rpb24gPSBudWxsOw0KDQogICAgcHJpdmF0ZSAkaXNpbml0aWFsaXplZCA9IGZhbHNlOyAvL+aYr+WQpuWIneWni+WMluaIkOWKnw0KDQogICAgcHJpdmF0ZSAkaXNjb25uZWN0ZWQgPSBmYWxzZTsgLy/mmK/lkKbov57mjqXmiJDlip8NCg0KICAgIHByaXZhdGUgJGlzbG9hZCA9IGZhbHNlOyAvL+aYr+WQpui9veWFpQ0KDQogICAgcHJpdmF0ZSAkaXNwcmVsb2FkID0gZmFsc2U7IC8v5piv5ZCm6aKE5Yqg6L29DQoNCiAgICBwcml2YXRlICRpc3Nlc3Npb24gPSBmYWxzZTsgLy/mmK/lkKbkvb/nlKhzZXNzaW9uDQoNCiAgICBwdWJsaWMgJGlzbWFuYWdlID0gZmFsc2U7IC8v5piv5ZCm5Yqg6L29566h55CG5qih5byPDQoNCiAgICBwdWJsaWMgJGlzYXBpID0gZmFsc2U7IC8v5piv5ZCm5Yqg6L29QVBJ5qih5byPDQoNCiAgICBwdWJsaWMgJGlzY21kID0gZmFsc2U7IC8v5piv5ZCm5Yqg6L29Q01E5qih5byPDQoNCiAgICBwdWJsaWMgJGlzYWpheCA9IGZhbHNlOyAvL+aYr+WQpuWKoOi9vUFKQVjmqKHlvI8NCg0KICAgIHB1YmxpYyAkaXN4bWxycGMgPSBmYWxzZTsgLy/mmK/lkKbliqDovb1YTUwtUlBD5qih5byPDQoNCiAgICBwdWJsaWMgJGlzaHR0cHMgPSBmYWxzZTsgLy/pk77mjqXoh7Npc0h0dHBzDQoNCiAgICBwdWJsaWMgJGlzSHR0cHMgPSBmYWxzZTsgLy/mmK/lkKZIVFRQUw0KDQogICAgcHVibGljICRpc2RlYnVnID0gZmFsc2U7IC8v5piv5ZCmRGVidWcgTW9kZQ0KDQogICAgcHVibGljICRpc2xvZ2luID0gZmFsc2U7IC8v5piv5ZCmTG9naW4NCg0KICAgIC8qKg0KICAgICAqIEB2YXIgVGVtcGxhdGUg5b2T5YmN5qih5p2/DQogICAgICovDQogICAgcHVibGljICR0ZW1wbGF0ZSA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIG51bGwg56S+5Lya5YyW6K+E6K66DQogICAgICovDQogICAgcHVibGljICRzb2NpYWxjb21tZW50ID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgbnVsbCDmqKHmnb/lpLTpg6gNCiAgICAgKi8NCiAgICBwdWJsaWMgJGhlYWRlciA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIG51bGwg5qih5p2/5bC+6YOoDQogICAgICovDQogICAgcHVibGljICRmb290ZXIgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBhcnJheSDmv4DmtLvnmoTmj5Lku7bliJfooagNCiAgICAgKi8NCiAgICBwdWJsaWMgJGFjdGl2ZWRhcHBzID0gYXJyYXkoKTsNCg0KICAgIHB1YmxpYyAkYWN0aXZlYXBwczsNCg0KICAgIHB1YmxpYyAkY29va2llX3Rvb2tlbl9odHRwb25seSA9IHRydWU7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIGludCDnrqHnkIbpobXpnaLmmL7npLrmnaHmlbANCiAgICAgKi8NCiAgICBwdWJsaWMgJG1hbmFnZWNvdW50ID0gNTA7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIGludCDpobXnoIHmmL7npLrmnaHmlbANCiAgICAgKi8NCiAgICBwdWJsaWMgJHBhZ2ViYXJjb3VudCA9IDEwOw0KDQogICAgLyoqDQogICAgICogQHZhciBpbnQg5pCc57Si6L+U5Zue5p2h5pWwDQogICAgICovDQogICAgcHVibGljICRzZWFyY2hjb3VudCA9IDEwOw0KDQogICAgLyoqDQogICAgICogQHZhciBpbnQg5paH56ug5YiX6KGo5pi+56S65p2h5pWwDQogICAgICovDQogICAgcHVibGljICRkaXNwbGF5Y291bnQgPSAxMDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgaW50IOivhOiuuuaYvuekuuaVsOmHjw0KICAgICAqLw0KICAgIHB1YmxpYyAkY29tbWVudGRpc3BsYXljb3VudCA9IDEwOw0KDQogICAgLyoqDQogICAgICogQHZhciBpbnQgQVBJIOavj+mhteacgOWkmuadoeaVsA0KICAgICAqLw0KICAgIHB1YmxpYyAkYXBpTWF4Q291bnRQZXJQYWdlID0gNTA7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIGludCDlvZPliY3lrp7kvovkuItDU1JGIFRva2Vu6L+H5pyf5pe26Ze077yI5bCP5pe277yJDQogICAgICovDQogICAgcHVibGljICRjc3JmRXhwaXJhdGlvbiA9IDE7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIEFwcCDlvZPliY3kuLvpopjnsbsNCiAgICAgKi8NCiAgICBwdWJsaWMgJHRoZW1lYXBwID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgaW50IOWIhuexu+acgOWkp+mAkuW9kuWxguaVsA0KICAgICAqLw0KICAgIHB1YmxpYyAkY2F0ZWdvcnlfcmVjdXJzaW9uX2xldmVsID0gNTsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgaW50IOWIhuexu+WunumZhemAkuW9kuWxguaVsA0KICAgICAqLw0KICAgIHB1YmxpYyAkY2F0ZWdvcnlfcmVjdXJzaW9uX3JlYWxfZGVlcCA9IDA7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIGludCDor4TorrrmnIDlpKfpgJLlvZLlsYLmlbANCiAgICAgKi8NCiAgICBwdWJsaWMgJGNvbW1lbnRfcmVjdXJzaW9uX2xldmVsID0gNDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgaHRtbCBqcyBoYXNoICjkvb/nlKjml7bor7fnlKjigJzov73liqDigJ3ljrvmt7vliqDoh6rlt7HnmoRoYXNoKQ0KICAgICAqLw0KICAgIHB1YmxpYyAkaHRtbF9qc19oYXNoID0gJyc7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIGFkbWluIGpzIGhhc2ggKOS9v+eUqOaXtuivt+eUqOKAnOi/veWKoOKAneWOu+a3u+WKoOiHquW3seeahGhhc2gpDQogICAgICovDQogICAgcHVibGljICRhZG1pbl9qc19oYXNoID0gJyc7DQoNCiAgICAvL+m7mOiupOi3r+eUsXVybOaVsOe7hA0KICAgIHB1YmxpYyAkcm91dGVzID0gYXJyYXkoKTsNCg0KICAgIC8v5oC757yT5a2Y5a+56LGhDQogICAgcHVibGljICRjYWNoZW9iamVjdCA9IGFycmF5KCk7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIHN0cmluZyDorr7lrprkuLvpopjkuIvnmoTmqKHmnb/oh6rliqjloavlhYXnvLrlpLHnmoRodG1s5qCH562+KOm7mOiupOaYr3RydWUpDQogICAgICovDQogICAgcHVibGljICRhdXRvZmlsbF90ZW1wbGF0ZV9odG1sdGFncyA9IHRydWU7DQoNCiAgICBjb25zdCBPUFRJT05fUkVTRVJWRV9LRVlTID0gJ1pDX0RBVEFCQVNFX1RZUEV8WkNfU1FMSVRFX05BTUV8WkNfU1FMSVRFX1BSRXxaQ19NWVNRTF9TRVJWRVJ8WkNfTVlTUUxfVVNFUk5BTUV8WkNfTVlTUUxfUEFTU1dPUkR8WkNfTVlTUUxfTkFNRXxaQ19NWVNRTF9DSEFSU0VUfFpDX01ZU1FMX0NPTExBVEV8WkNfTVlTUUxfUFJFfFpDX01ZU1FMX0VOR0lORXxaQ19NWVNRTF9QT1JUfFpDX01ZU1FMX1BFUlNJU1RFTlR8WkNfTVlTUUxfUE9SVHxaQ19QR1NRTF9TRVJWRVJ8WkNfUEdTUUxfVVNFUk5BTUV8WkNfUEdTUUxfUEFTU1dPUkR8WkNfUEdTUUxfTkFNRXxaQ19QR1NRTF9DSEFSU0VUfFpDX1BHU1FMX1BSRXxaQ19QR1NRTF9QT1JUfFpDX1BHU1FMX1BFUlNJU1RFTlR8WkNfQ0xPU0VfV0hPTEVfU0lURXxaQ19QRVJNQU5FTlRfRE9NQUlOX0ZPUkNFRF9VUkx8WkNfUEVSTUFORU5UX0RPTUFJTl9XSE9MRV9ESVNBQkxFJzsNCg0KICAgIC8qKg0KICAgICAqIOiOt+WPluWUr+S4gOWunuS+iy4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gbnVsbHxaQmxvZ1BIUA0KICAgICAqLw0KICAgIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gR2V0SW5zdGFuY2UoKQ0KICAgIHsNCiAgICAgICAgaWYgKCFpc3NldChzZWxmOjokcHJpdmF0ZV96YnApKSB7DQogICAgICAgICAgICBpZiAoaXNzZXQoJEdMT0JBTFNbJ29wdGlvbiddWydaQ19HT0RaQlBfRklMRSddKSAmJiBpc3NldCgkR0xPQkFMU1snb3B0aW9uJ11bJ1pDX0dPRFpCUF9OQU1FJ10pICYmIGlzX3JlYWRhYmxlKFpCUF9QQVRIIC4gJEdMT0JBTFNbJ29wdGlvbiddWydaQ19HT0RaQlBfRklMRSddKSkgew0KICAgICAgICAgICAgICAgIGluY2x1ZGUgWkJQX1BBVEggLiAkR0xPQkFMU1snb3B0aW9uJ11bJ1pDX0dPRFpCUF9GSUxFJ107DQogICAgICAgICAgICAgICAgc2VsZjo6JHByaXZhdGVfemJwID0gbmV3ICRHTE9CQUxTWydvcHRpb24nXVsnWkNfR09EWkJQX05BTUUnXSgpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBzZWxmOjokcHJpdmF0ZV96YnAgPSBuZXcgc2VsZigpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIHNlbGY6OiRwcml2YXRlX3picDsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDliJ3lp4vljJbmlbDmja7lupPov57mjqUuDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICR0eXBlIOaVsOaNrui/nuaOpeexu+Weiw0KICAgICAqDQogICAgICogQHJldHVybiBEYXRhYmFzZV9fSW50ZXJmYWNlDQogICAgICovDQogICAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiBJbml0aWFsaXplREIoJHR5cGUpDQogICAgew0KICAgICAgICBpZiAoIXRyaW0oJHR5cGUpKSB7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCg0KICAgICAgICAkbmV3dHlwZSA9ICdEYXRhYmFzZV9fJyAuIHRyaW0oJHR5cGUpOw0KDQogICAgICAgIHJldHVybiBuZXcgJG5ld3R5cGUoKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmnoTpgKDlh73mlbDvvIzliqDovb3ln7rmnKzphY3nva7liLAkemJwLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBfX2NvbnN0cnVjdCgpDQogICAgew0KICAgICAgICBnbG9iYWwgJG9wdGlvbiwgJGxhbmcsICRsYW5ncywgJGJsb2dwYXRoLCAkYmxvZ2hvc3QsICRjb29raWVzcGF0aCwgICRjYWNoZWRpciwgJGxvZ3NkaXIsICRkYXRhZGlyLA0KICAgICAgICAgICAgJHRhYmxlLCAkZGF0YWluZm8sICRhY3Rpb25zLCAkYWN0aW9uLCAkYmxvZ3ZlcnNpb24sICRibG9ndGl0bGUsICRibG9nbmFtZSwgJGJsb2dzdWJuYW1lLCAkcm91dGVzLA0KICAgICAgICAgICAgJGJsb2d0aGVtZSwgJGJsb2dzdHlsZSwgJGN1cnJlbnR1cmwsICRhY3RpdmVkYXBwcywgJHBvc3R0eXBlLCAkZnVsbGN1cnJlbnR1cmwsDQogICAgICAgICAgICAkdXNlcnNkaXIsICRzeXN0ZW1kaXIsICRhZG1pbmRpciwgJHVzZXJzdXJsLCAkc3lzdGVtdXJsLCAkYWRtaW51cmw7DQoNCiAgICAgICAgaWYgKFpCUF9IT09LRVJST1IpIHsNCiAgICAgICAgICAgIFpCbG9nRXhjZXB0aW9uOjpTZXRFcnJvckhvb2soKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8v5Z+65pys6YWN572u5Yqg6L295YiwJHpicOWGhQ0KICAgICAgICAkdGhpcy0+dmVyc2lvbiA9ICYkYmxvZ3ZlcnNpb247DQogICAgICAgICR0aGlzLT5vcHRpb24gPSAmJG9wdGlvbjsNCiAgICAgICAgJHRoaXMtPmxhbmcgPSAmJGxhbmc7DQogICAgICAgICR0aGlzLT5sYW5ncyA9ICYkbGFuZ3M7DQogICAgICAgICR0aGlzLT5yb3V0ZXMgPSAmJHJvdXRlczsNCg0KICAgICAgICAkdGhpcy0+cGF0aCA9ICYkYmxvZ3BhdGg7DQogICAgICAgICR0aGlzLT5ob3N0ID0gJiRibG9naG9zdDsgLy/mraTlgLzlnKjlkI7ovrnliJ3lp4vljJbml7blj6/og73kvJrlj5jljJYhDQogICAgICAgICR0aGlzLT5jdXJyZW50dXJsID0gJiRjdXJyZW50dXJsOw0KICAgICAgICAkdGhpcy0+ZnVsbGN1cnJlbnR1cmwgPSAmJGZ1bGxjdXJyZW50dXJsOw0KICAgICAgICAkdGhpcy0+Y29va2llc3BhdGggPSAmJGNvb2tpZXNwYXRoOw0KICAgICAgICAkdGhpcy0+dXNlcnNkaXIgPSAmJHVzZXJzZGlyOw0KICAgICAgICAkdGhpcy0+Y2FjaGVkaXIgPSAmJGNhY2hlZGlyOw0KICAgICAgICAkdGhpcy0+bG9nc2RpciA9ICYkbG9nc2RpcjsNCiAgICAgICAgJHRoaXMtPmRhdGFkaXIgPSAmJGRhdGFkaXI7DQogICAgICAgICR0aGlzLT5zeXN0ZW1kaXIgPSAmJHN5c3RlbWRpcjsNCiAgICAgICAgJHRoaXMtPmFkbWluZGlyID0gJiRhZG1pbmRpcjsNCiAgICAgICAgJHRoaXMtPnVzZXJzdXJsID0gJiR1c2Vyc3VybDsNCiAgICAgICAgJHRoaXMtPnN5c3RlbXVybCA9ICYkc3lzdGVtdXJsOw0KICAgICAgICAkdGhpcy0+YWRtaW51cmwgPSAmJGFkbWludXJsOw0KDQogICAgICAgICR0aGlzLT50YWJsZSA9ICYkdGFibGU7DQogICAgICAgICR0aGlzLT5kYXRhaW5mbyA9ICYkZGF0YWluZm87DQogICAgICAgICR0aGlzLT50ID0gJiR0aGlzLT50YWJsZTsNCiAgICAgICAgJHRoaXMtPmQgPSAmJHRoaXMtPmRhdGFpbmZvOw0KICAgICAgICAkdGhpcy0+YWN0aW9ucyA9ICYkYWN0aW9uczsNCiAgICAgICAgJHRoaXMtPnBvc3R0eXBlID0gJiRwb3N0dHlwZTsNCg0KICAgICAgICAkdGhpcy0+YWN0aW9uID0gJiRhY3Rpb247DQogICAgICAgICR0aGlzLT5hY3RpdmVkYXBwcyA9ICYkYWN0aXZlZGFwcHM7DQogICAgICAgICR0aGlzLT5hY3RpdmVhcHBzID0gJiR0aGlzLT5hY3RpdmVkYXBwczsNCg0KICAgICAgICAkdGhpcy0+Z3VpZCA9ICYkdGhpcy0+b3B0aW9uWydaQ19CTE9HX0NMU0lEJ107DQoNCiAgICAgICAgJHRoaXMtPnRpdGxlID0gJiRibG9ndGl0bGU7DQogICAgICAgICR0aGlzLT5uYW1lID0gJiRibG9nbmFtZTsNCiAgICAgICAgJHRoaXMtPnN1Ym5hbWUgPSAmJGJsb2dzdWJuYW1lOw0KICAgICAgICAkdGhpcy0+dGhlbWUgPSAmJGJsb2d0aGVtZTsNCiAgICAgICAgJHRoaXMtPnN0eWxlID0gJiRibG9nc3R5bGU7DQoNCiAgICAgICAgJHRoaXMtPm1hbmFnZWNvdW50ID0gJiR0aGlzLT5vcHRpb25bJ1pDX01BTkFHRV9DT1VOVCddOw0KICAgICAgICAkdGhpcy0+cGFnZWJhcmNvdW50ID0gJiR0aGlzLT5vcHRpb25bJ1pDX1BBR0VCQVJfQ09VTlQnXTsNCiAgICAgICAgJHRoaXMtPnNlYXJjaGNvdW50ID0gJiR0aGlzLT5vcHRpb25bJ1pDX1NFQVJDSF9DT1VOVCddOw0KICAgICAgICAkdGhpcy0+ZGlzcGxheWNvdW50ID0gJiR0aGlzLT5vcHRpb25bJ1pDX0RJU1BMQVlfQ09VTlQnXTsNCiAgICAgICAgJHRoaXMtPmNvbW1lbnRkaXNwbGF5Y291bnQgPSAmJHRoaXMtPm9wdGlvblsnWkNfQ09NTUVOVFNfRElTUExBWV9DT1VOVCddOw0KDQogICAgICAgICR0aGlzLT5jYXRlZ29yaWVzYnlvcmRlcl90eXBlWzBdID0gYXJyYXkoKTsNCiAgICAgICAgJHRoaXMtPmNhdGVnb3JpZXNieW9yZGVyID0gJiR0aGlzLT5jYXRlZ29yaWVzYnlvcmRlcl90eXBlWzBdOw0KICAgICAgICAkdGhpcy0+Y2F0ZWdvcmllcyA9ICYkdGhpcy0+Y2F0ZWdvcmllc2J5b3JkZXI7DQogICAgICAgICR0aGlzLT5jYXRlZ29yeXMgPSAmJHRoaXMtPmNhdGVnb3JpZXM7DQogICAgICAgICR0aGlzLT5jYXRlZ29yeXNieW9yZGVyID0gJiR0aGlzLT5jYXRlZ29yaWVzYnlvcmRlcjsNCg0KICAgICAgICAkdGhpcy0+dGFnc190eXBlWzBdID0gYXJyYXkoKTsNCiAgICAgICAgJHRoaXMtPnRhZ3NieW5hbWVfdHlwZVswXSA9IGFycmF5KCk7DQogICAgICAgICR0aGlzLT50YWdzID0gJiR0aGlzLT50YWdzX3R5cGVbMF07DQogICAgICAgICR0aGlzLT50YWdzYnluYW1lID0gJiR0aGlzLT50YWdzYnluYW1lX3R5cGVbMF07DQoNCiAgICAgICAgJHRoaXMtPnVzZXIgPSBuZXcgc3RkQ2xhc3MoKTsNCiAgICAgICAgZm9yZWFjaCAoJHRoaXMtPmRhdGFpbmZvWydNZW1iZXInXSBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAgICAgJHRoaXMtPnVzZXItPiRrZXkgPSAkdmFsdWVbM107DQogICAgICAgIH0NCiAgICAgICAgJHRoaXMtPnVzZXItPk1ldGFzID0gbmV3IE1ldGFzKCk7DQoNCiAgICAgICAgJHRoaXMtPmlzaHR0cHMgPSAmJHRoaXMtPmlzSHR0cHM7DQoNCiAgICAgICAgJHRoaXMtPkJpbmRpbmdDYWNoZSgpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAq5p6Q5p6E5Ye95pWw77yM6YeK5pS+6LWE5rqQLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBfX2Rlc3RydWN0KCkNCiAgICB7DQogICAgICAgICR0aGlzLT5UZXJtaW5hdGUoKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBAYXBpIEZpbHRlcl9QbHVnaW5fWmJwX0NhbGwNCiAgICAgKg0KICAgICAqIEBwYXJhbSAkbWV0aG9kDQogICAgICogQHBhcmFtICRhcmdzDQogICAgICoNCiAgICAgKiBAcmV0dXJuIG1peGVkDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIF9fY2FsbCgkbWV0aG9kLCAkYXJncykNCiAgICB7DQogICAgICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1picF9DYWxsJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICAgICAkZnByZXR1cm4gPSAkZnBuYW1lKCRtZXRob2QsICRhcmdzKTsNCiAgICAgICAgICAgIGlmICgkZnBzaWduYWwgPT0gUExVR0lOX0VYSVRTSUdOQUxfUkVUVVJOKSB7DQogICAgICAgICAgICAgICAgJGZwc2lnbmFsID0gUExVR0lOX0VYSVRTSUdOQUxfTk9ORTsNCg0KICAgICAgICAgICAgICAgIHJldHVybiAkZnByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgdHJpZ2dlcl9lcnJvcigkdGhpcy0+bGFuZ1snZXJyb3InXVs4MV0sIEVfVVNFUl9XQVJOSU5HKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDorr7nva7lj4LmlbDlgLwNCiAgICAgKg0KICAgICAqIEBwYXJhbSAkbmFtZQ0KICAgICAqIEBwYXJhbSAkdmFsdWUNCiAgICAgKg0KICAgICAqIEByZXR1cm4gbWl4ZWQNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gX19zZXQoJG5hbWUsICR2YWx1ZSkNCiAgICB7DQogICAgICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1picF9TZXQnXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgICAgICRmcHJldHVybiA9ICRmcG5hbWUoJG5hbWUsICR2YWx1ZSk7DQogICAgICAgICAgICBpZiAoJGZwc2lnbmFsID09IFBMVUdJTl9FWElUU0lHTkFMX1JFVFVSTikgew0KICAgICAgICAgICAgICAgICRmcHNpZ25hbCA9IFBMVUdJTl9FWElUU0lHTkFMX05PTkU7DQoNCiAgICAgICAgICAgICAgICByZXR1cm4gJGZwcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHRyaWdnZXJfZXJyb3IoJHRoaXMtPmxhbmdbJ2Vycm9yJ11bODFdLCBFX1VTRVJfV0FSTklORyk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6I635Y+W5Y+C5pWw5YC8DQogICAgICoNCiAgICAgKiBAcGFyYW0gJG5hbWUNCiAgICAgKg0KICAgICAqIEByZXR1cm4gbWl4ZWQNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gX19nZXQoJG5hbWUpDQogICAgew0KICAgICAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9aYnBfR2V0J10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICAgICAkZnByZXR1cm4gPSAkZnBuYW1lKCRuYW1lKTsNCiAgICAgICAgICAgIGlmICgkZnBzaWduYWwgPT0gUExVR0lOX0VYSVRTSUdOQUxfUkVUVVJOKSB7DQogICAgICAgICAgICAgICAgJGZwc2lnbmFsID0gUExVR0lOX0VYSVRTSUdOQUxfTk9ORTsNCg0KICAgICAgICAgICAgICAgIHJldHVybiAkZnByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgdHJpZ2dlcl9lcnJvcigkdGhpcy0+bGFuZ1snZXJyb3InXVs4MV0sIEVfVVNFUl9XQVJOSU5HKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDliJ3lp4vljJYkemJwLg0KICAgICAqDQogICAgICogQHRocm93cyBFeGNlcHRpb24NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBJbml0aWFsaXplKCkNCiAgICB7DQogICAgICAgIGlmICgkdGhpcy0+aXNpbml0aWFsaXplZCkgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgJG9sZFpvbmUgPSAkdGhpcy0+b3B0aW9uWydaQ19USU1FX1pPTkVfTkFNRSddOw0KICAgICAgICBkYXRlX2RlZmF1bHRfdGltZXpvbmVfc2V0KCRvbGRab25lKTsNCg0KICAgICAgICAkb2xkTGFuZyA9ICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfTEFOR1VBR0VQQUNLJ107DQogICAgICAgICR0aGlzLT5Mb2FkTGFuZ3VhZ2UoJ3N5c3RlbScsICcnKTsNCg0KICAgICAgICBpZiAoJHRoaXMtPm9wdGlvblsnWkNfQ0xPU0VfV0hPTEVfU0lURSddID09IHRydWUpIHsNCiAgICAgICAgICAgIEh0dHA1MDMoKTsNCiAgICAgICAgICAgICR0aGlzLT5TaG93RXJyb3IoODIsIF9fRklMRV9fLCBfX0xJTkVfXyk7DQoNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmICghJHRoaXMtPk9wZW5Db25uZWN0KCkpIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgICR0aGlzLT5Db252ZXJ0VGFibGVBbmREYXRhaW5mbygpOw0KDQogICAgICAgICR0aGlzLT5Mb2FkQ29uZmlnc09ubHlTeXN0ZW0odHJ1ZSk7DQogICAgICAgICR0aGlzLT5Mb2FkT3B0aW9uKCk7DQoNCiAgICAgICAgaWYgKCR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfTEFOR1VBR0VQQUNLJ10gPT09ICdTaW1wQ2hpbmVzZScpIHsNCiAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfTEFOR1VBR0VQQUNLJ10gPSAnemgtY24nOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfTEFOR1VBR0VQQUNLJ10gPT09ICdUcmFkQ2hpbmVzZScpIHsNCiAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfTEFOR1VBR0VQQUNLJ10gPSAnemgtdHcnOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCRvbGRMYW5nICE9ICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfTEFOR1VBR0VQQUNLJ10pIHsNCiAgICAgICAgICAgICR0aGlzLT5Mb2FkTGFuZ3VhZ2UoJ3N5c3RlbScsICcnKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChpc3NldCgkdGhpcy0+b3B0aW9uWydaQ19ERUJVR19NT0RFX1dBUk5JTkcnXSkpIHsNCiAgICAgICAgICAgIFpCbG9nRXhjZXB0aW9uOjokaXN3YXJuaW5nID0gKGJvb2wpICR0aGlzLT5vcHRpb25bJ1pDX0RFQlVHX01PREVfV0FSTklORyddOw0KICAgICAgICB9DQogICAgICAgIGlmIChpc3NldCgkdGhpcy0+b3B0aW9uWydaQ19ERUJVR19NT0RFX1NUUklDVCddKSkgew0KICAgICAgICAgICAgWkJsb2dFeGNlcHRpb246OiRpc3N0cmljdCA9IChib29sKSAkdGhpcy0+b3B0aW9uWydaQ19ERUJVR19NT0RFX1NUUklDVCddOw0KICAgICAgICB9DQogICAgICAgIGlmIChpc3NldCgkdGhpcy0+b3B0aW9uWydaQ19ERUJVR19MT0dfRVJST1InXSkpIHsNCiAgICAgICAgICAgIFpCbG9nRXhjZXB0aW9uOjokaXNsb2dlcnJvciA9IChib29sKSAkdGhpcy0+b3B0aW9uWydaQ19ERUJVR19MT0dfRVJST1InXTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vWkNfUEVSTUFORU5UX0RPTUFJTl9XSE9MRV9ESVNBQkxF5LiN5a2Y5ZyoIOaIluaYryBaQ19QRVJNQU5FTlRfRE9NQUlOX1dIT0xFX0RJU0FCTEXlrZjlnKjkvYbkuLrlgYcNCiAgICAgICAgJGRvbWFpbl9kaXNhYmxlID0gR2V0VmFsdWVJbkFycmF5KCR0aGlzLT5vcHRpb24sICdaQ19QRVJNQU5FTlRfRE9NQUlOX1dIT0xFX0RJU0FCTEUnKTsNCiAgICAgICAgaWYgKCRkb21haW5fZGlzYWJsZSA9PSBmYWxzZSkgew0KICAgICAgICAgICAgJGZvcmNlZF91cmwgPSBHZXRWYWx1ZUluQXJyYXkoJHRoaXMtPm9wdGlvbiwgJ1pDX1BFUk1BTkVOVF9ET01BSU5fRk9SQ0VEX1VSTCcpOw0KICAgICAgICAgICAgaWYgKCRmb3JjZWRfdXJsICE9ICcnKSB7DQogICAgICAgICAgICAgICAgLy/lpoLmnpxaQ19QRVJNQU5FTlRfRE9NQUlOX0ZPUkNFRF9VUkzlrZjlnKgg5LiU5LiN5Li656m6DQogICAgICAgICAgICAgICAgJHRoaXMtPmhvc3QgPSAoc3RyaW5nKSAkZm9yY2VkX3VybDsNCiAgICAgICAgICAgICAgICAkdGhpcy0+Y29va2llc3BhdGggPSBzdHJzdHIoc3RyX3JlcGxhY2UoJzovLycsICcnLCAkdGhpcy0+aG9zdCksICcvJyk7DQogICAgICAgICAgICB9IGVsc2VpZiAoJHRoaXMtPm9wdGlvblsnWkNfUEVSTUFORU5UX0RPTUFJTl9FTkFCTEUnXSA9PSB0cnVlKSB7DQogICAgICAgICAgICAgICAgLy/lpoLmnpxaQ19QRVJNQU5FTlRfRE9NQUlOX0VOQUJMReW3suW8gOWQr+eahOivnQ0KICAgICAgICAgICAgICAgICR0aGlzLT5ob3N0ID0gJHRoaXMtPm9wdGlvblsnWkNfQkxPR19IT1NUJ107DQogICAgICAgICAgICAgICAgJHRoaXMtPmNvb2tpZXNwYXRoID0gc3Ryc3RyKHN0cl9yZXBsYWNlKCc6Ly8nLCAnJywgJHRoaXMtPmhvc3QpLCAnLycpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAvL+m7mOiupOiHquWKqOivhuWIq+Wfn+WQjQ0KICAgICAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfSE9TVCddID0gJHRoaXMtPmhvc3Q7DQogICAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19CTE9HX0hPU1QnXSA9ICR0aGlzLT5ob3N0Ow0KICAgICAgICB9DQoNCiAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfQkxPR19QUk9EVUNUJ10gPSAnWi1CbG9nUEhQJzsNCiAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfQkxPR19WRVJTSU9OJ10gPSBaQ19CTE9HX1ZFUlNJT047DQogICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX05PV19WRVJTSU9OJ10gPSAkdGhpcy0+dmVyc2lvbjsgIC8vWkNfTEFTVF9WRVJTSU9ODQogICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfUFJPRFVDVF9GVUxMJ10gPSAkdGhpcy0+b3B0aW9uWydaQ19CTE9HX1BST0RVQ1QnXSAuICcgJyAuIFpDX1ZFUlNJT05fRElTUExBWTsNCiAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfQkxPR19QUk9EVUNUX0ZVTExIVE1MJ10gPSAnPGEgaHJlZj0iaHR0cHM6Ly93d3cuemJsb2djbi5jb20vIiB0aXRsZT0iWi1CbG9nUEhQICcgLiBaQ19CTE9HX1ZFUlNJT04gLiAnIiB0YXJnZXQ9Il9ibGFuayI+JyAuICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfUFJPRFVDVF9GVUxMJ10gLiAnPC9hPic7DQogICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfUFJPRFVDVF9IVE1MJ10gPSAnPGEgaHJlZj0iaHR0cHM6Ly93d3cuemJsb2djbi5jb20vIiB0aXRsZT0iWi1CbG9nUEhQICcgLiBaQ19CTE9HX1ZFUlNJT04gLiAnIiB0YXJnZXQ9Il9ibGFuayI+JyAuICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfUFJPRFVDVCddIC4gJzwvYT4nOw0KDQogICAgICAgIGlmICgkb2xkWm9uZSAhPSAkdGhpcy0+b3B0aW9uWydaQ19USU1FX1pPTkVfTkFNRSddKSB7DQogICAgICAgICAgICBkYXRlX2RlZmF1bHRfdGltZXpvbmVfc2V0KCR0aGlzLT5vcHRpb25bJ1pDX1RJTUVfWk9ORV9OQU1FJ10pOw0KICAgICAgICB9DQoNCiAgICAgICAgLyppZihpc3NldCgkX0NPT0tJRVsndGltZXpvbmUnXSkpew0KICAgICAgICAgICAgJHR6PUdldFZhcnMoJ3RpbWV6b25lJywnQ09PS0lFJyk7DQogICAgICAgICAgICBpZihpc19udW1lcmljKCR0eikpew0KICAgICAgICAgICAgJHR6PXNwcmludGYoJyUrZCcsLSR0eik7DQogICAgICAgICAgICBkYXRlX2RlZmF1bHRfdGltZXpvbmVfc2V0KCdFdGMvR01UJyAuICR0eik7DQogICAgICAgICAgICAkdGhpcy0+dGltZXpvbmU9ZGF0ZV9kZWZhdWx0X3RpbWV6b25lX2dldCgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAqLw0KDQogICAgICAgIGlmICgkdGhpcy0+b3B0aW9uWydaQ19WRVJTSU9OX0lOX0hFQURFUiddICYmICFoZWFkZXJzX3NlbnQoKSkgew0KICAgICAgICAgICAgaGVhZGVyKCdQcm9kdWN0OicgLiAkdGhpcy0+b3B0aW9uWydaQ19CTE9HX1BST0RVQ1RfRlVMTCddKTsNCiAgICAgICAgfQ0KDQogICAgICAgICRwYXJzZWRIb3N0ID0gcGFyc2VfdXJsKCR0aGlzLT5ob3N0KTsNCiAgICAgICAgaWYgKGlzc2V0KCRwYXJzZWRIb3N0WydzY2hlbWUnXSkgJiYgaXNzZXQoJHBhcnNlZEhvc3RbJ2hvc3QnXSkpIHsNCiAgICAgICAgICAgICR0aGlzLT5mdWxsY3VycmVudHVybCA9ICRwYXJzZWRIb3N0WydzY2hlbWUnXSAuICc6Ly8nIC4gJHBhcnNlZEhvc3RbJ2hvc3QnXTsNCiAgICAgICAgICAgIGlmIChpc3NldCgkcGFyc2VkSG9zdFsncG9ydCddKSkgew0KICAgICAgICAgICAgICAgICR0aGlzLT5mdWxsY3VycmVudHVybCAuPSAnOicgLiAkcGFyc2VkSG9zdFsncG9ydCddOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJHRoaXMtPmZ1bGxjdXJyZW50dXJsID0gJyc7DQogICAgICAgIH0NCiAgICAgICAgJHRoaXMtPmZ1bGxjdXJyZW50dXJsIC49ICR0aGlzLT5jdXJyZW50dXJsOw0KDQogICAgICAgIGlmIChzdHJpcG9zKCR0aGlzLT5ob3N0LCAnaHR0cCcpID09PSAwKSB7DQogICAgICAgICAgICBpZiAoc3RyaXBvcygkdGhpcy0+aG9zdCwgJ2h0dHBzOi8vJykgPT09IDApIHsNCiAgICAgICAgICAgICAgICAkdGhpcy0+aXNIdHRwcyA9IHRydWU7DQogICAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkdGhpcy0+aXNIdHRwcyA9IChIVFRQX1NDSEVNRSA9PT0gJ2h0dHBzOi8vJyk7DQogICAgICAgIH0NCiAgICAgICAgLy92YXJfZHVtcCgkdGhpcy0+aXNIdHRwcyk7ZGllOw0KDQogICAgICAgICR0aGlzLT52ZXJpZnlDb2RlVXJsID0gJHRoaXMtPnN5c3RlbXVybCAuICdzY3JpcHQvY192YWxpZGNvZGUucGhwJzsNCiAgICAgICAgJHRoaXMtPnZhbGlkY29kZXVybCA9ICYkdGhpcy0+dmVyaWZ5Q29kZVVybDsNCiAgICAgICAgJHRoaXMtPmZlZWR1cmwgPSAkdGhpcy0+aG9zdCAuICdmZWVkLnBocCc7DQogICAgICAgICR0aGlzLT5zZWFyY2h1cmwgPSAkdGhpcy0+aG9zdCAuICdzZWFyY2gucGhwJzsNCiAgICAgICAgJHRoaXMtPmNtZHVybCA9ICR0aGlzLT5zeXN0ZW11cmwgLiAnY21kLnBocCc7DQogICAgICAgICR0aGlzLT5hamF4dXJsID0gJHRoaXMtPmNtZHVybCAuICc/YWN0PWFqYXgmc3JjPSc7DQogICAgICAgICR0aGlzLT54bWxycGN1cmwgPSAkdGhpcy0+c3lzdGVtdXJsIC4gJ3htbC1ycGMvaW5kZXgucGhwJzsNCiAgICAgICAgJHRoaXMtPmFwaXVybCA9ICR0aGlzLT5zeXN0ZW11cmwgLiAnYXBpLnBocCc7DQoNCiAgICAgICAgJHRoaXMtPkxvYWRDb25maWdzT25seVN5c3RlbShmYWxzZSk7DQoNCiAgICAgICAgJHRoaXMtPkxvYWRDYWNoZSgpOw0KDQogICAgICAgICFkZWZpbmVkKCdaQlBfSU5fQVBJJykgfHwgJHRoaXMtPmlzYXBpID0gdHJ1ZTsNCiAgICAgICAgIWRlZmluZWQoJ1pCUF9JTl9DTUQnKSB8fCAkdGhpcy0+aXNjbWQgPSB0cnVlOw0KICAgICAgICAhZGVmaW5lZCgnWkJQX0lOX0FKQVgnKSB8fCAkdGhpcy0+aXNhamF4ID0gdHJ1ZTsNCiAgICAgICAgIWRlZmluZWQoJ1pCUF9JTl9YTUxSUEMnKSB8fCAkdGhpcy0+aXN4bWxycGMgPSB0cnVlOw0KICAgICAgICAhJHRoaXMtPm9wdGlvblsnWkNfREVCVUdfTU9ERSddIHx8ICR0aGlzLT5pc2RlYnVnID0gdHJ1ZTsNCg0KICAgICAgICAkdGhpcy0+TG9hZFBvc3RUeXBlKCk7DQogICAgICAgICR0aGlzLT5Mb2FkUm91dGVzKCk7DQoNCiAgICAgICAgJHRoaXMtPnRoZW1lYXBwID0gbmV3IEFwcCgpOw0KICAgICAgICAkdGhpcy0+dGhlbWVpbmZvID0gJHRoaXMtPnRoZW1lYXBwLT5HZXRJbmZvQXJyYXkoKTsNCg0KICAgICAgICAkdGhpcy0+aXNpbml0aWFsaXplZCA9IHRydWU7DQoNCiAgICAgICAgaWYgKCR0aGlzLT5pc2FwaSkgew0KICAgICAgICAgICAgLy/mjILovb1BUEnplJnor6/mmL7npLoNCiAgICAgICAgICAgIEFkZF9GaWx0ZXJfUGx1Z2luKCdGaWx0ZXJfUGx1Z2luX0RlYnVnX0Rpc3BsYXknLCAnQXBpRGVidWdEaXNwbGF5Jyk7DQogICAgICAgICAgICAvL+aMgui9vVRva2Vu6aqM6K+BDQogICAgICAgICAgICBBZGRfRmlsdGVyX1BsdWdpbignRmlsdGVyX1BsdWdpbl9aYnBfUHJlTG9hZCcsICdBcGlUb2tlblZlcmlmeScpOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6K+75Y+W5paH5Lu26YeM55qEUG9zdFR5cGXphY3nva4o5Lul5ZCO5Y+v6IO95Lya5pS+6L+b5pWw5o2u5bqT6YeMKQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBMb2FkUG9zdFR5cGUoKQ0KICAgIHsNCiAgICAgICAgZm9yZWFjaCAoYXJyYXkoMCA9PiAnYXJ0aWNsZScsIDEgPT4gJ3BhZ2UnKSBhcyAkcG9zdGlkID0+ICRwb3N0bmFtZSkgew0KICAgICAgICAgICAgJHBvc3R0eXBlID0gaW5jbHVkZSBaQlBfUEFUSCAuICd6Yl9zeXN0ZW0vZGVmZW5kL3Bvc3R0eXBlXycgLiAkcG9zdG5hbWUgLiAnLnBocCc7DQogICAgICAgICAgICBpZiAoZW1wdHkoJHBvc3R0eXBlWydzaW5nbGVfdXJscnVsZSddKSkgew0KICAgICAgICAgICAgICAgIGlmICgkcG9zdGlkID09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgJHBvc3R0eXBlWydzaW5nbGVfdXJscnVsZSddID0gJHRoaXMtPm9wdGlvblsnWkNfQVJUSUNMRV9SRUdFWCddOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICRwb3N0dHlwZVsnc2luZ2xlX3VybHJ1bGUnXSA9ICR0aGlzLT5vcHRpb25bJ1pDX1BBR0VfUkVHRVgnXTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbXB0eSgkcG9zdHR5cGVbJ2xpc3RfdXJscnVsZSddKSA/ICRwb3N0dHlwZVsnbGlzdF91cmxydWxlJ10gPSAkdGhpcy0+b3B0aW9uWydaQ19JTkRFWF9SRUdFWCddIDogbnVsbDsNCiAgICAgICAgICAgIGVtcHR5KCRwb3N0dHlwZVsnbGlzdF9jYXRlZ29yeV91cmxydWxlJ10pID8gJHBvc3R0eXBlWydsaXN0X2NhdGVnb3J5X3VybHJ1bGUnXSA9ICR0aGlzLT5vcHRpb25bJ1pDX0NBVEVHT1JZX1JFR0VYJ10gOiBudWxsOw0KICAgICAgICAgICAgZW1wdHkoJHBvc3R0eXBlWydsaXN0X2F1dGhvcl91cmxydWxlJ10pID8gJHBvc3R0eXBlWydsaXN0X2F1dGhvcl91cmxydWxlJ10gPSAkdGhpcy0+b3B0aW9uWydaQ19BVVRIT1JfUkVHRVgnXSA6IG51bGw7DQogICAgICAgICAgICBlbXB0eSgkcG9zdHR5cGVbJ2xpc3RfZGF0ZV91cmxydWxlJ10pID8gJHBvc3R0eXBlWydsaXN0X2RhdGVfdXJscnVsZSddID0gJHRoaXMtPm9wdGlvblsnWkNfREFURV9SRUdFWCddIDogbnVsbDsNCiAgICAgICAgICAgIGVtcHR5KCRwb3N0dHlwZVsnbGlzdF90YWdfdXJscnVsZSddKSA/ICRwb3N0dHlwZVsnbGlzdF90YWdfdXJscnVsZSddID0gJHRoaXMtPm9wdGlvblsnWkNfVEFHU19SRUdFWCddIDogbnVsbDsNCiAgICAgICAgICAgIGVtcHR5KCRwb3N0dHlwZVsnc2VhcmNoX3VybHJ1bGUnXSkgPyAkcG9zdHR5cGVbJ3NlYXJjaF91cmxydWxlJ10gPSAkdGhpcy0+b3B0aW9uWydaQ19TRUFSQ0hfUkVHRVgnXSA6IG51bGw7DQoNCiAgICAgICAgICAgICR0aGlzLT5wb3N0dHlwZVskcG9zdGlkXSA9ICRwb3N0dHlwZTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOivu+WPluaWh+S7tumHjOeahOi3r+eUsemFjee9rijku6XlkI7lj6/og73kvJrmlL7ov5vmlbDmja7lupPph4wpDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIExvYWRSb3V0ZXMoKQ0KICAgIHsNCiAgICAgICAgZm9yZWFjaCAoYXJyYXkoMCA9PiAnYXJ0aWNsZScsIDEgPT4gJ3BhZ2UnKSBhcyAkcG9zdGlkID0+ICRwb3N0bmFtZSkgew0KICAgICAgICAgICAgaWYgKCFpc19yZWFkYWJsZSgkZmlsZSA9IFpCUF9QQVRIIC4gJ3piX3N5c3RlbS9kZWZlbmQvcm91dGVzX3Bvc3RfJyAuICRwb3N0bmFtZSAuICcucGhwJykpIHsNCiAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgICRyb3V0ZSA9IGluY2x1ZGUgJGZpbGU7DQogICAgICAgICAgICBmb3JlYWNoICgkcm91dGUgYXMgJGtleTIgPT4gJHZhbHVlMikgew0KICAgICAgICAgICAgICAgIGlmIChlbXB0eSgkdmFsdWUyWyd1cmxydWxlJ10pKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICgkdmFsdWUyWyduYW1lJ10gPT0gJ3Bvc3RfJyAuICRwb3N0bmFtZSAuICdfc2luZ2xlJykgew0KICAgICAgICAgICAgICAgICAgICAgICAgJHZhbHVlMlsndXJscnVsZSddID0gJHRoaXMtPkdldFBvc3RUeXBlKCRwb3N0aWQsICdzaW5nbGVfdXJscnVsZScpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGlmICgkdmFsdWUyWyduYW1lJ10gPT0gJ3Bvc3RfJyAuICRwb3N0bmFtZSAuICdfbGlzdCcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICR2YWx1ZTJbJ3VybHJ1bGUnXSA9ICR0aGlzLT5HZXRQb3N0VHlwZSgkcG9zdGlkLCAnbGlzdF91cmxydWxlJyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYgKCR2YWx1ZTJbJ25hbWUnXSA9PSAncG9zdF8nIC4gJHBvc3RuYW1lIC4gJ19saXN0X29ubHlfYWN0aXZlJykgew0KICAgICAgICAgICAgICAgICAgICAgICAgJHZhbHVlMlsndXJscnVsZSddID0gJHRoaXMtPkdldFBvc3RUeXBlKCRwb3N0aWQsICdsaXN0X3VybHJ1bGUnKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBpZiAoJHZhbHVlMlsnbmFtZSddID09ICdwb3N0XycgLiAkcG9zdG5hbWUgLiAnX2xpc3RfY2F0ZWdvcnknKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAkdmFsdWUyWyd1cmxydWxlJ10gPSAkdGhpcy0+R2V0UG9zdFR5cGUoJHBvc3RpZCwgJ2xpc3RfY2F0ZWdvcnlfdXJscnVsZScpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGlmICgkdmFsdWUyWyduYW1lJ10gPT0gJ3Bvc3RfJyAuICRwb3N0bmFtZSAuICdfbGlzdF9hdXRob3InKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAkdmFsdWUyWyd1cmxydWxlJ10gPSAkdGhpcy0+R2V0UG9zdFR5cGUoJHBvc3RpZCwgJ2xpc3RfYXV0aG9yX3VybHJ1bGUnKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBpZiAoJHZhbHVlMlsnbmFtZSddID09ICdwb3N0XycgLiAkcG9zdG5hbWUgLiAnX2xpc3RfZGF0ZScpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICR2YWx1ZTJbJ3VybHJ1bGUnXSA9ICR0aGlzLT5HZXRQb3N0VHlwZSgkcG9zdGlkLCAnbGlzdF9kYXRlX3VybHJ1bGUnKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBpZiAoJHZhbHVlMlsnbmFtZSddID09ICdwb3N0XycgLiAkcG9zdG5hbWUgLiAnX2xpc3RfdGFnJykgew0KICAgICAgICAgICAgICAgICAgICAgICAgJHZhbHVlMlsndXJscnVsZSddID0gJHRoaXMtPkdldFBvc3RUeXBlKCRwb3N0aWQsICdsaXN0X3RhZ191cmxydWxlJyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYgKCR2YWx1ZTJbJ25hbWUnXSA9PSAncG9zdF8nIC4gJHBvc3RuYW1lIC4gJ19zZWFyY2gnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAkdmFsdWUyWyd1cmxydWxlJ10gPSAkdGhpcy0+R2V0UG9zdFR5cGUoJHBvc3RpZCwgJ3NlYXJjaF91cmxydWxlJyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgJHRoaXMtPnJvdXRlc1ska2V5Ml0gPSAkdmFsdWUyOw0KICAgICAgICAgICAgICAgIGlmICgkdmFsdWUyWyd0eXBlJ10gIT0gJ3Jld3JpdGUnIHx8ICgkdGhpcy0+b3B0aW9uWydaQ19TVEFUSUNfTU9ERSddID09ICdSRVdSSVRFJyAmJiAkdmFsdWUyWyd0eXBlJ10gPT0gJ3Jld3JpdGUnKSkgew0KICAgICAgICAgICAgICAgICAgICAkdGhpcy0+U2V0UG9zdFR5cGVfU3ViKCRwb3N0aWQsICdyb3V0ZXMnLCAkdmFsdWUyWyduYW1lJ10sIGFycmF5KCR2YWx1ZTJbJ3R5cGUnXSA9PiAkdmFsdWUyWyduYW1lJ10pKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgLy92YXJfZXhwb3J0KCR0aGlzLT5wb3N0dHlwZSk7DQogICAgICAgIC8vdmFyX2V4cG9ydCgkdGhpcy0+cm91dGVzKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDlnKhJbml0aWFsaXpl5ZKM5Yqg6L295omA5pyJ5o+S5Lu2aW5jbHVkZeS5i+WQju+8jOWcqExvYWTkuYvliY3nmoTov4fnqIvvvIzooqtjX3N5c3RlbV9iYXNl6LCD55So77yMMS436YeM5paw5Yqg55qEDQogICAgICoNCiAgICAgKiBAdGhyb3dzIEV4Y2VwdGlvbg0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFByZUxvYWQoKQ0KICAgIHsNCiAgICAgICAgaWYgKCEkdGhpcy0+aXNpbml0aWFsaXplZCB8fCAkdGhpcy0+aXNwcmVsb2FkKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCg0KICAgICAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9aYnBfUHJlTG9hZCddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAgICAgJGZwcmV0dXJuID0gJGZwbmFtZSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgLy/mraTlpITmjqXlj6PlupTor6XlnKjkuIvkuIDniYjmnKznp7vpmaTvvIzor7fkuI3opoHlho3kvb/nlKjkuobvvIHvvIHvvIENCiAgICAgICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fWmJwX0xvYWRfUHJlJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICAgICAkZnByZXR1cm4gPSAkZnBuYW1lKCk7DQogICAgICAgIH0NCg0KICAgICAgICAkdGhpcy0+aXNwcmVsb2FkID0gdHJ1ZTsNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5LuO5pWw5o2u5bqT6YeM6K+75Y+W5L+h5oGv77yM5ZCv5Yqo5pW05LiqWkJQLg0KICAgICAqDQogICAgICogQHRocm93cyBFeGNlcHRpb24NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBMb2FkKCkNCiAgICB7DQogICAgICAgIGlmICghJHRoaXMtPmlzaW5pdGlhbGl6ZWQgfHwgISR0aGlzLT5pc3ByZWxvYWQgfHwgJHRoaXMtPmlzbG9hZCkgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCFoZWFkZXJzX3NlbnQoKSkgew0KICAgICAgICAgICAgaGVhZGVyKCdDb250ZW50LXR5cGU6IHRleHQvaHRtbDsgY2hhcnNldD11dGYtOCcpOw0KICAgICAgICB9DQoNCiAgICAgICAgJHRoaXMtPkNvbnZlcnRUYWJsZUFuZERhdGFpbmZvKCk7DQogICAgICAgIGlmICgkdGhpcy0+b3B0aW9uWydaQ19MT0FETUVNQkVSU19MRVZFTCddID09IDApIHsNCiAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX0xPQURNRU1CRVJTX0xFVkVMJ10gPSAxOw0KICAgICAgICB9DQogICAgICAgICR0aGlzLT5Mb2FkTWVtYmVycygkdGhpcy0+b3B0aW9uWydaQ19MT0FETUVNQkVSU19MRVZFTCddKTsNCiAgICAgICAgJHRoaXMtPkxvYWRDYXRlZ29yaWVzKCk7DQogICAgICAgIC8vJHRoaXMtPkxvYWRUYWdzKCk7DQogICAgICAgICR0aGlzLT5Mb2FkTW9kdWxlcygpOw0KICAgICAgICAkdGhpcy0+UmVnQnVpbGRNb2R1bGVzKCk7DQoNCiAgICAgICAgaWYgKCEoaXNfc3ViY2xhc3Nfb2YoJHRoaXMtPnVzZXIsICdCYXNlTWVtYmVyJykgJiYgJHRoaXMtPnVzZXItPkxldmVsID4gMCAmJiAhZW1wdHkoJHRoaXMtPnVzZXItPklEKSkpIHsNCiAgICAgICAgICAgICR0aGlzLT5WZXJpZnkoKTsNCiAgICAgICAgICAgICR0aGlzLT5pc2xvZ2luID0gZW1wdHkoJHRoaXMtPnVzZXItPklEKSA/IGZhbHNlIDogdHJ1ZTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8v5Yib5bu65qih5p2/57G7DQogICAgICAgICR0aGlzLT50ZW1wbGF0ZSA9ICR0aGlzLT5QcmVwYXJlVGVtcGxhdGUoKTsNCg0KICAgICAgICBpZiAoJHRoaXMtPmlzbWFuYWdlKSB7DQogICAgICAgICAgICAkdGhpcy0+TG9hZE1hbmFnZSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fTG9naW5fSGVhZGVyJywgJ0luY2x1ZGVfQWRkb25BZG1pbkZvbnQnKTsNCiAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fT3RoZXJfSGVhZGVyJywgJ0luY2x1ZGVfQWRkb25BZG1pbkZvbnQnKTsNCiAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fQWRtaW5fSGVhZGVyJywgJ0luY2x1ZGVfQWRkb25BZG1pbkZvbnQnKTsNCiAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fQmF0Y2hQb3N0JywgJ0luY2x1ZGVfQmF0Y2hQb3N0X0FydGljbGUnKTsNCiAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fQmF0Y2hQb3N0JywgJ0luY2x1ZGVfQmF0Y2hQb3N0X1BhZ2UnKTsNCiAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fSW5kZXhfRW5kJywgJ0luY2x1ZGVfSW5kZXhfRW5kJyk7DQogICAgICAgIEFkZF9GaWx0ZXJfUGx1Z2luKCdGaWx0ZXJfUGx1Z2luX1NlYXJjaF9FbmQnLCAnSW5jbHVkZV9JbmRleF9FbmQnKTsNCiAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fSW5kZXhfQmVnaW4nLCAnSW5jbHVkZV9JbmRleF9CZWdpbicpOw0KICAgICAgICBBZGRfRmlsdGVyX1BsdWdpbignRmlsdGVyX1BsdWdpbl9TZWFyY2hfQmVnaW4nLCAnSW5jbHVkZV9JbmRleF9CZWdpbicpOw0KICAgICAgICBBZGRfRmlsdGVyX1BsdWdpbignRmlsdGVyX1BsdWdpbl9GZWVkX0JlZ2luJywgJ0luY2x1ZGVfSW5kZXhfQmVnaW4nKTsNCiAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fWmJwX0NoZWNrUmlnaHRzJywgJ0luY2x1ZGVfRnJvbnRlbmRfQ2hlY2tSaWdodHMnKTsNCg0KICAgICAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9aYnBfTG9hZCddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAgICAgJGZwbmFtZSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCR0aGlzLT51c2VyLT5TdGF0dXMgPT0gWkNfTUVNQkVSX1NUQVRVU19MT0NLRUQpIHsNCiAgICAgICAgICAgICR0aGlzLT5TaG93RXJyb3IoODAsIF9fRklMRV9fLCBfX0xJTkVfXyk7DQogICAgICAgIH0NCg0KICAgICAgICAvL+i/m+WQjuWPsOaXtuW3suiHquWKqOajgOa1i+aooeadv+W5tuiHquWKqOmHjeW7uuS6hu+8jOaJgOS7pei/memHjOWPqumSiOWvueW8gOiwg+ivleWQjueahOWJjeWPsOeahOiuv+mXrui/m+ihjA0KICAgICAgICBpZiAoJHRoaXMtPm9wdGlvblsnWkNfREVCVUdfTU9ERSddIHx8ICR0aGlzLT5pc21hbmFnZSkgew0KICAgICAgICAgICAgJHRoaXMtPkNoZWNrVGVtcGxhdGUoKTsNCiAgICAgICAgfQ0KDQogICAgICAgICR0aGlzLT5SZWZsdXNoTGFuZ3VhZ2VzKCk7DQogICAgICAgICR0aGlzLT5Db252ZXJ0VGFibGVBbmREYXRhaW5mbygpOw0KDQogICAgICAgICR0aGlzLT5pc2xvZ2luID0gZW1wdHkoJHRoaXMtPnVzZXItPklEKSA/IGZhbHNlIDogdHJ1ZTsNCiAgICAgICAgJHRoaXMtPmlzbG9hZCA9IHRydWU7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOi9veWFpeeuoeeQhi4NCiAgICAgKg0KICAgICAqIEB0aHJvd3MgRXhjZXB0aW9uDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIExvYWRNYW5hZ2UoKQ0KICAgIHsNCiAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fQWRtaW5fUGFnZU1uZ19TdWJNZW51JywgJ0luY2x1ZGVfQWRtaW5fQWRkcGFnZXN1Ym1lbnUnKTsNCiAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fQWRtaW5fVGFnTW5nX1N1Yk1lbnUnLCAnSW5jbHVkZV9BZG1pbl9BZGR0YWdzdWJtZW51Jyk7DQogICAgICAgIEFkZF9GaWx0ZXJfUGx1Z2luKCdGaWx0ZXJfUGx1Z2luX0FkbWluX0NhdGVnb3J5TW5nX1N1Yk1lbnUnLCAnSW5jbHVkZV9BZG1pbl9BZGRjYXRlc3VibWVudScpOw0KICAgICAgICBBZGRfRmlsdGVyX1BsdWdpbignRmlsdGVyX1BsdWdpbl9BZG1pbl9NZW1iZXJNbmdfU3ViTWVudScsICdJbmNsdWRlX0FkbWluX0FkZG1lbXN1Ym1lbnUnKTsNCiAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fQWRtaW5fTW9kdWxlTW5nX1N1Yk1lbnUnLCAnSW5jbHVkZV9BZG1pbl9BZGRtb2RzdWJtZW51Jyk7DQogICAgICAgIEFkZF9GaWx0ZXJfUGx1Z2luKCdGaWx0ZXJfUGx1Z2luX0FkbWluX0NvbW1lbnRNbmdfU3ViTWVudScsICdJbmNsdWRlX0FkbWluX0FkZGNtdHN1Ym1lbnUnKTsNCiAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fQWRtaW5fU2V0dGluZ01uZ19TdWJNZW51JywgJ0luY2x1ZGVfQWRtaW5fQWRkc2V0dGluZ3N1Ym1lbnUnKTsNCiAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fWmJwX0xvYWRNYW5hZ2UnLCAnSW5jbHVkZV9BZG1pbl9VcGRhdGVEQicpOw0KICAgICAgICBBZGRfRmlsdGVyX1BsdWdpbignRmlsdGVyX1BsdWdpbl9BZG1pbl9FbmQnLCAnSW5jbHVkZV9BZG1pbl9DaGVja0h0dHAzMDRPSycpOw0KDQogICAgICAgIGlmIChpc3NldCgkR0xPQkFMU1snemJwdmVycyddKSkgew0KICAgICAgICAgICAgJEdMT0JBTFNbJ3picHZlcnMnXVskR0xPQkFMU1snYmxvZ3ZlcnNpb24nXV0gPSBaQ19WRVJTSU9OX0RJU1BMQVkgLiAnIEJ1aWxkICcgLiAkR0xPQkFMU1snYmxvZ3ZlcnNpb24nXTsNCiAgICAgICAgfQ0KDQogICAgICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1picF9Mb2FkTWFuYWdlJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICAgICAkZnBuYW1lKCk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDnu4jmraLov57mjqXvvIzph4rmlL7otYTmupAuDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFRlcm1pbmF0ZSgpDQogICAgew0KICAgICAgICBpZiAoJHRoaXMtPmlzaW5pdGlhbGl6ZWQpIHsNCiAgICAgICAgICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1picF9UZXJtaW5hdGUnXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgICAgICAgICAkZnBuYW1lKCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICR0aGlzLT5DbG9zZUNvbm5lY3QoKTsNCiAgICAgICAgICAgIHVuc2V0KCR0aGlzLT5kYik7DQogICAgICAgICAgICAkdGhpcy0+aXNpbml0aWFsaXplZCA9IGZhbHNlOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6L+e5o6l5pWw5o2u5bqTLg0KICAgICAqDQogICAgICogQHRocm93cyBFeGNlcHRpb24NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBPcGVuQ29ubmVjdCgpDQogICAgew0KICAgICAgICBpZiAoJHRoaXMtPmlzY29ubmVjdGVkKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoISR0aGlzLT5vcHRpb25bJ1pDX0RBVEFCQVNFX1RZUEUnXSkgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgc3dpdGNoICgkdGhpcy0+b3B0aW9uWydaQ19EQVRBQkFTRV9UWVBFJ10pIHsNCiAgICAgICAgICAgIGNhc2UgJ3NxbGl0ZSc6DQogICAgICAgICAgICBjYXNlICdzcWxpdGUzJzoNCiAgICAgICAgICAgIGNhc2UgJ3Bkb19zcWxpdGUnOg0KICAgICAgICAgICAgICAgICR0aGlzLT5kYiA9IHNlbGY6OkluaXRpYWxpemVEQigkdGhpcy0+b3B0aW9uWydaQ19EQVRBQkFTRV9UWVBFJ10pOw0KICAgICAgICAgICAgICAgIGlmICgkdGhpcy0+ZGItPk9wZW4oDQogICAgICAgICAgICAgICAgICAgIGFycmF5KCR0aGlzLT5kYXRhZGlyIC4gJycgLiAkdGhpcy0+b3B0aW9uWydaQ19TUUxJVEVfTkFNRSddLA0KICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfU1FMSVRFX1BSRSddLA0KICAgICAgICAgICAgICAgICAgICApDQogICAgICAgICAgICAgICAgKSA9PSBmYWxzZQ0KICAgICAgICAgICAgICAgICkgew0KICAgICAgICAgICAgICAgICAgICAkdGhpcy0+U2hvd0Vycm9yKDY5LCBfX0ZJTEVfXywgX19MSU5FX18pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ3Bvc3RncmVzcWwnOg0KICAgICAgICAgICAgY2FzZSAncGRvX3Bvc3RncmVzcWwnOg0KICAgICAgICAgICAgICAgICR0aGlzLT5kYiA9IHNlbGY6OkluaXRpYWxpemVEQigkdGhpcy0+b3B0aW9uWydaQ19EQVRBQkFTRV9UWVBFJ10pOw0KICAgICAgICAgICAgICAgIGlmICgkdGhpcy0+ZGItPk9wZW4oDQogICAgICAgICAgICAgICAgICAgIGFycmF5KCR0aGlzLT5vcHRpb25bJ1pDX1BHU1FMX1NFUlZFUiddLA0KICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfUEdTUUxfVVNFUk5BTUUnXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX1BHU1FMX1BBU1NXT1JEJ10sDQogICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19QR1NRTF9OQU1FJ10sDQogICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19QR1NRTF9QUkUnXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX1BHU1FMX1BPUlQnXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX1BHU1FMX1BFUlNJU1RFTlQnXSwNCiAgICAgICAgICAgICAgICAgICAgKQ0KICAgICAgICAgICAgICAgICkgPT0gZmFsc2UNCiAgICAgICAgICAgICAgICApIHsNCiAgICAgICAgICAgICAgICAgICAgJHRoaXMtPlNob3dFcnJvcig2NywgX19GSUxFX18sIF9fTElORV9fKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdteXNxbCc6DQogICAgICAgICAgICBjYXNlICdteXNxbGknOg0KICAgICAgICAgICAgY2FzZSAncGRvX215c3FsJzoNCiAgICAgICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgICAgICAgaWYgKCR0aGlzLT5vcHRpb25bJ1pDX0RBVEFCQVNFX1RZUEUnXSA9PSAnbXlzcWwnICYmIHZlcnNpb25fY29tcGFyZShQSFBfVkVSU0lPTiwgJzcuMC4wJykgPj0gMCkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoZXh0ZW5zaW9uX2xvYWRlZCgnbXlzcWxpJykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX0RBVEFCQVNFX1RZUEUnXSA9ICdteXNxbGknOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2VpZiAoZXh0ZW5zaW9uX2xvYWRlZCgncGRvX215c3FsJykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX0RBVEFCQVNFX1RZUEUnXSA9ICdwZG9fbXlzcWwnOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICR0aGlzLT5kYiA9IHNlbGY6OkluaXRpYWxpemVEQigkdGhpcy0+b3B0aW9uWydaQ19EQVRBQkFTRV9UWVBFJ10pOw0KICAgICAgICAgICAgICAgIGlmICgkdGhpcy0+ZGItPk9wZW4oDQogICAgICAgICAgICAgICAgICAgIGFycmF5KA0KICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfTVlTUUxfU0VSVkVSJ10sDQogICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19NWVNRTF9VU0VSTkFNRSddLA0KICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfTVlTUUxfUEFTU1dPUkQnXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX01ZU1FMX05BTUUnXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX01ZU1FMX1BSRSddLA0KICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfTVlTUUxfUE9SVCddLA0KICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfTVlTUUxfUEVSU0lTVEVOVCddLA0KICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfTVlTUUxfRU5HSU5FJ10sDQogICAgICAgICAgICAgICAgICAgICkNCiAgICAgICAgICAgICAgICApID09IGZhbHNlDQogICAgICAgICAgICAgICAgKSB7DQogICAgICAgICAgICAgICAgICAgICR0aGlzLT5TaG93RXJyb3IoNjcsIF9fRklMRV9fLCBfX0xJTkVfXyk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICB9DQogICAgICAgIC8vIHV0ZjhtYjTmlK/mjIENCiAgICAgICAgaWYgKCR0aGlzLT5kYi0+dHlwZSA9PSAnbXlzcWwnICYmIHZlcnNpb25fY29tcGFyZSgkdGhpcy0+ZGItPnZlcnNpb24sICc1LjUuMycpIDwgMCkgew0KICAgICAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fRGJTcWxfRmlsdGVyJywgJ3V0Zjg0bWJfZmlsdGVyJyk7DQogICAgICAgICAgICBBZGRfRmlsdGVyX1BsdWdpbignRmlsdGVyX1BsdWdpbl9FZGl0X0JlZ2luJywgJ3V0Zjg0bWJfZml4SHRtbFNwZWNpYWxDaGFycycpOw0KICAgICAgICB9DQogICAgICAgICR0aGlzLT5pc2Nvbm5lY3RlZCA9IHRydWU7DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5a+56KGo5ZCN5ZKM5pWw5o2u57uT5p6E6L+b6KGM6aKE6L2s5o2iLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBDb252ZXJ0VGFibGVBbmREYXRhaW5mbygpDQogICAgew0KICAgICAgICBpZiAoJHRoaXMtPmRiLT5kYnByZSkgew0KICAgICAgICAgICAgJHRoaXMtPnRhYmxlID0gc3RyX3JlcGxhY2UoJyVwcmUlJywgJHRoaXMtPmRiLT5kYnByZSwgJHRoaXMtPnRhYmxlKTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoJHRoaXMtPmRiLT50eXBlID09PSAncG9zdGdyZXNxbCcpIHsNCiAgICAgICAgICAgIGZvcmVhY2ggKCR0aGlzLT5kYXRhaW5mbyBhcyAka2V5ID0+ICYkdmFsdWUpIHsNCiAgICAgICAgICAgICAgICBmb3JlYWNoICgkdmFsdWUgYXMgJGsyID0+ICYkdjIpIHsNCiAgICAgICAgICAgICAgICAgICAgJHYyWzBdID0gc3RydG9sb3dlcigkdjJbMF0pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWFs+mXreaVsOaNruW6k+i/nuaOpS4NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQ2xvc2VDb25uZWN0KCkNCiAgICB7DQogICAgICAgIGlmICgkdGhpcy0+aXNjb25uZWN0ZWQpIHsNCiAgICAgICAgICAgICR0aGlzLT5kYi0+Q2xvc2UoKTsNCiAgICAgICAgICAgICR0aGlzLT5pc2Nvbm5lY3RlZCA9IGZhbHNlOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5ZCv55Soc2Vzc2lvbi4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBTdGFydFNlc3Npb24oKQ0KICAgIHsNCiAgICAgICAgaWYgKHNlc3Npb25fc3RhdHVzKCkgPT0gMSkgew0KICAgICAgICAgICAgc2Vzc2lvbl9zdGFydCgpOw0KICAgICAgICAgICAgJHRoaXMtPmlzc2Vzc2lvbiA9IHRydWU7DQoNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOe7iOatonNlc3Npb24uDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gRW5kU2Vzc2lvbigpDQogICAgew0KICAgICAgICBpZiAoc2Vzc2lvbl9zdGF0dXMoKSA9PSAyKSB7DQogICAgICAgICAgICBzZXNzaW9uX3dyaXRlX2Nsb3NlKCk7DQogICAgICAgICAgICAkdGhpcy0+aXNzZXNzaW9uID0gZmFsc2U7DQoNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIExvYWQgb3IgUmVMb2Fk5o+S5Lu2Q29uZmlnc+ihqC4NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gTG9hZENvbmZpZ3MoKQ0KICAgIHsNCiAgICAgICAgJHRoaXMtPkxvYWRDb25maWdzT25seVN5c3RlbSh0cnVlKTsNCiAgICAgICAgJHRoaXMtPkxvYWRDb25maWdzT25seVN5c3RlbShmYWxzZSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6L295YWl5o+S5Lu2Q29uZmlnc+ihqCBPbmx5IFN5c3RlbSBPcHRpb24uDQogICAgICovDQogICAgcHJpdmF0ZSAkcHJ2Q29uZmlnTGlzdCA9IG51bGw7DQoNCiAgICBwdWJsaWMgZnVuY3Rpb24gTG9hZENvbmZpZ3NPbmx5U3lzdGVtKCRvbmx5c3lzdGVtb3B0aW9uID0gdHJ1ZSkNCiAgICB7DQogICAgICAgIGlmICgkb25seXN5c3RlbW9wdGlvbiA9PSB0cnVlKSB7DQogICAgICAgICAgICAkdGhpcy0+Y29uZmlncyA9IGFycmF5KCk7DQogICAgICAgICAgICAkdGhpcy0+cHJ2Q29uZmlnTGlzdCA9IGFycmF5KCk7DQoNCiAgICAgICAgICAgICRzcWwgPSAkdGhpcy0+ZGItPnNxbC0+Z2V0KCktPnNlbGVjdCgkdGhpcy0+dGFibGVbJ0NvbmZpZyddKTsNCiAgICAgICAgICAgIC8qIEB2YXIgQ29uZmlnW10gJGFycmF5ICovDQogICAgICAgICAgICAkdGhpcy0+cHJ2Q29uZmlnTGlzdCA9ICR0aGlzLT5HZXRMaXN0T3JpZ2luKCRzcWwpOw0KICAgICAgICB9DQoNCiAgICAgICAgJHR5cGUgPSAnQ29uZmlnJzsNCg0KICAgICAgICBmb3JlYWNoICgkdGhpcy0+cHJ2Q29uZmlnTGlzdCBhcyAkYykgew0KICAgICAgICAgICAgJG5hbWUgPSAkY1skdGhpcy0+ZFsnQ29uZmlnJ11bJ05hbWUnXVswXV07DQogICAgICAgICAgICBpZiAoKCRuYW1lID09ICdzeXN0ZW0nICYmICRvbmx5c3lzdGVtb3B0aW9uID09IHRydWUpIHx8ICgkbmFtZSAhPSAnc3lzdGVtJyAmJiAkb25seXN5c3RlbW9wdGlvbiA9PSBmYWxzZSkpIHsNCiAgICAgICAgICAgICAgICBpZiAoIWlzc2V0KCR0aGlzLT5jb25maWdzWyRuYW1lXSkpIHsNCiAgICAgICAgICAgICAgICAgICAgJGwgPSBuZXcgJHR5cGUoJG5hbWUpOw0KICAgICAgICAgICAgICAgICAgICAkdGhpcy0+Y29uZmlnc1skbmFtZV0gPSAkbDsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAkbCA9ICR0aGlzLT5jb25maWdzWyRuYW1lXTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKGdldF9jbGFzcygkbCkgIT0gJHR5cGUpIHsNCiAgICAgICAgICAgICAgICAgICAgJGwgPSBuZXcgJHR5cGUoJG5hbWUpOw0KICAgICAgICAgICAgICAgICAgICAkdGhpcy0+Y29uZmlnc1skbmFtZV0gPSAkbDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKGlzc2V0KCRjWyR0aGlzLT5kWydDb25maWcnXVsnS2V5J11bMF1dKSAmJiAkY1skdGhpcy0+ZFsnQ29uZmlnJ11bJ0tleSddWzBdXSAhPSAnJykgew0KICAgICAgICAgICAgICAgICAgICAkbC0+TG9hZEluZm9CeUFzc29jU2luZ2xlV2l0aFByZSgkYyk7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgJGwtPkxvYWRJbmZvQnlBc3NvYygkYyk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIC8v5bCG6K+75Ye65p2l55qE5pWw57uE5YaN5ou85oiQ5bqP5YiX5YyW5pWw5o2u5YaN5Y+N5bqP5YiX5YyWDQogICAgICAgIGZvcmVhY2ggKCR0aGlzLT5jb25maWdzIGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICAgICBpZiAoaXNfb2JqZWN0KCR2YWx1ZSkgJiYgKCRrZXkgPT0gJ3N5c3RlbScgJiYgJG9ubHlzeXN0ZW1vcHRpb24gPT0gdHJ1ZSkgfHwgKCRrZXkgIT0gJ3N5c3RlbScgJiYgJG9ubHlzeXN0ZW1vcHRpb24gPT0gZmFsc2UpKSB7DQogICAgICAgICAgICAgICAgJHZhbHVlLT5Mb2FkSW5mb0J5QXNzb2NTaW5nbGVXaXRoQWZ0ZXIoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIGlmICgkb25seXN5c3RlbW9wdGlvbiA9PSBmYWxzZSkgew0KICAgICAgICAgICAgJHRoaXMtPnBydkNvbmZpZ0xpc3QgPSBhcnJheSgpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5L+d5a2YQ29uZmlnc+ihqC4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUgQ29uZmlnc+ihqOWQjQ0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFNhdmVDb25maWcoJG5hbWUpDQogICAgew0KICAgICAgICBpZiAoIWlzc2V0KCR0aGlzLT5jb25maWdzWyRuYW1lXSkpIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgICR0aGlzLT5jb25maWdzWyRuYW1lXS0+U2F2ZSgpOw0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWIoOmZpENvbmZpZ3PooaguDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRuYW1lIENvbmZpZ3PooajlkI0NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBEZWxDb25maWcoJG5hbWUpDQogICAgew0KICAgICAgICBpZiAoIWlzc2V0KCR0aGlzLT5jb25maWdzWyRuYW1lXSkpIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgICR0aGlzLT5jb25maWdzWyRuYW1lXS0+RGVsZXRlKCk7DQogICAgICAgIHVuc2V0KCR0aGlzLT5jb25maWdzWyRuYW1lXSk7DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6I635Y+WQ29uZmlnc+ihqOWAvA0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbmFtZSBDb25maWdz6KGo5ZCNDQogICAgICoNCiAgICAgKiBAcmV0dXJuIG1peGVkDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIENvbmZpZygkbmFtZSkNCiAgICB7DQogICAgICAgIGlmICghaXNzZXQoJHRoaXMtPmNvbmZpZ3NbJG5hbWVdKSkgew0KICAgICAgICAgICAgJG5hbWUgPSBGaWx0ZXJDb3JyZWN0TmFtZSgkbmFtZSk7DQogICAgICAgICAgICBpZiAoISRuYW1lKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAkdGhpcy0+Y29uZmlnc1skbmFtZV0gPSBuZXcgQ29uZmlnKCRuYW1lKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAkdGhpcy0+Y29uZmlnc1skbmFtZV07DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5p+l5p+QQ29uZmln5piv5ZCm5a2Y5ZyoLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbmFtZSBDb25maWdz6KGo5ZCNDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gSGFzQ29uZmlnKCRuYW1lKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuIGlzc2V0KCR0aGlzLT5jb25maWdzWyRuYW1lXSkgJiYgJHRoaXMtPmNvbmZpZ3NbJG5hbWVdLT5Db3VudEl0ZW0oKSA+IDA7DQogICAgfQ0KDQogICAgLy8jIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCiAgICAvL0NhY2hl55u45YWzDQogICAgcHJpdmF0ZSAkY2FjaGVfaGFzaCA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiDkv53lrZjnvJPlrZguDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gU2F2ZUNhY2hlKCkNCiAgICB7DQogICAgICAgIC8vJHM9JHRoaXMtPmNhY2hlZGlyIC4gJycgLiAkdGhpcy0+Z3VpZCAuICcuY2FjaGUnOw0KICAgICAgICAvLyRjPXNlcmlhbGl6ZSgkdGhpcy0+Y2FjaGUpOw0KICAgICAgICAvL0BmaWxlX3B1dF9jb250ZW50cygkcywgJGMpOw0KICAgICAgICAvLyR0aGlzLT5jb25maWdzWydjYWNoZSddPSR0aGlzLT5jYWNoZTsNCiAgICAgICAgJG5ld19oYXNoID0gbWQ1KCR0aGlzLT5Db25maWcoJ2NhY2hlJykpOw0KICAgICAgICBpZiAoJHRoaXMtPmNhY2hlX2hhc2ggPT0gJG5ld19oYXNoKSB7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KDQogICAgICAgICR0aGlzLT5TYXZlQ29uZmlnKCdjYWNoZScpOw0KICAgICAgICAkdGhpcy0+Y2FjaGVfaGFzaCA9ICRuZXdfaGFzaDsNCg0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDliqDovb3nvJPlrZguDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gTG9hZENhY2hlKCkNCiAgICB7DQogICAgICAgICR0aGlzLT5jYWNoZSA9ICR0aGlzLT5Db25maWcoJ2NhY2hlJyk7DQogICAgICAgICR0aGlzLT5jYWNoZV9oYXNoID0gbWQ1KCR0aGlzLT5Db25maWcoJ2NhY2hlJykpOw0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOS/neWtmOmFjee9ri4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBTYXZlT3B0aW9uKCkNCiAgICB7DQogICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfQ0xTSUQnXSA9ICR0aGlzLT5ndWlkOw0KDQogICAgICAgIHVuc2V0KCR0aGlzLT5vcHRpb25bJ1pDX1BFUk1BTkVOVF9ET01BSU5fV0hPTEVfRElTQUJMRSddKTsNCiAgICAgICAgdW5zZXQoJHRoaXMtPm9wdGlvblsnWkNfUEVSTUFORU5UX0RPTUFJTl9GT1JDRURfVVJMJ10pOw0KDQogICAgICAgICRyZXNlcnZlX2tleXMgPSBleHBsb2RlKCd8Jywgc2VsZjo6T1BUSU9OX1JFU0VSVkVfS0VZUyk7DQoNCiAgICAgICAgaWYgKGZpbGVfZXhpc3RzKCR0aGlzLT51c2Vyc2RpciAuICdjX29wdGlvbi5waHAnKSA9PSBmYWxzZSkgew0KICAgICAgICAgICAgJHMgPSAiPCI7DQogICAgICAgICAgICAkcyAuPSAiP3BocFxyXG4iOw0KICAgICAgICAgICAgJHMgLj0gInJldHVybiAiOw0KICAgICAgICAgICAgJG9wdGlvbiA9IGFycmF5KCk7DQogICAgICAgICAgICBmb3JlYWNoICgkdGhpcy0+b3B0aW9uIGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICAgICAgICAgaWYgKGluX2FycmF5KCRrZXksICRyZXNlcnZlX2tleXMpKSB7DQogICAgICAgICAgICAgICAgICAgICRvcHRpb25bJGtleV0gPSAkdmFsdWU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgJHMgLj0gdmFyX2V4cG9ydCgkb3B0aW9uLCB0cnVlKTsNCiAgICAgICAgICAgICRzIC49ICI7IjsNCiAgICAgICAgICAgIEBmaWxlX3B1dF9jb250ZW50cygkdGhpcy0+dXNlcnNkaXIgLiAnY19vcHRpb24ucGhwJywgJHMpOw0KICAgICAgICB9DQoNCiAgICAgICAgZm9yZWFjaCAoJHRoaXMtPm9wdGlvbiBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAgICAgJHRoaXMtPkNvbmZpZygnc3lzdGVtJyktPiRrZXkgPSAkdmFsdWU7DQogICAgICAgIH0NCiAgICAgICAgZm9yZWFjaCAoJHJlc2VydmVfa2V5cyBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAgICAgJHRoaXMtPkNvbmZpZygnc3lzdGVtJyktPkRlbEtleSgkdmFsdWUpOw0KICAgICAgICB9DQoNCiAgICAgICAgJHRoaXMtPkNvbmZpZygnc3lzdGVtJyktPlpDX0JMT0dfSE9TVCA9IGNodW5rX3NwbGl0KCR0aGlzLT5Db25maWcoJ3N5c3RlbScpLT5aQ19CTE9HX0hPU1QsIDEsICJ8Iik7DQoNCiAgICAgICAgJHRoaXMtPlNhdmVDb25maWcoJ3N5c3RlbScpOw0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOi9veWFpemFjee9ri4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBMb2FkT3B0aW9uKCkNCiAgICB7DQogICAgICAgICRhcnJheSA9ICR0aGlzLT5Db25maWcoJ3N5c3RlbScpLT5HZXREYXRhKCk7DQoNCiAgICAgICAgaWYgKGVtcHR5KCRhcnJheSkpIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmICghaXNfYXJyYXkoJGFycmF5KSkgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgJHJlc2VydmVfa2V5cyA9IGV4cGxvZGUoJ3wnLCBzZWxmOjpPUFRJT05fUkVTRVJWRV9LRVlTKTsNCg0KICAgICAgICBmb3JlYWNoICgkYXJyYXkgYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgICAgIGlmICgka2V5ID09ICdaQ19CTE9HX0hPU1QnKSB7DQogICAgICAgICAgICAgICAgJHZhbHVlID0gc3RyX3JlcGxhY2UoJ3wnLCAnJywgJHZhbHVlKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKGluX2FycmF5KCRrZXksICRyZXNlcnZlX2tleXMpKSB7DQogICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJGtleV0gPSAkdmFsdWU7DQogICAgICAgIH0NCiAgICAgICAgaWYgKCFleHRlbnNpb25fbG9hZGVkKCdnZCcpKSB7DQogICAgICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19DT01NRU5UX1ZFUklGWV9FTkFCTEUnXSA9IGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6aqM6K+B5pON5L2c5p2D6ZmQLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAgICAgJGFjdGlvbiDmk43kvZwNCiAgICAgKiBAcGFyYW0gaW50fHN0cmluZyAkbGV2ZWwNCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBDaGVja1JpZ2h0cygkYWN0aW9uLCAkbGV2ZWwgPSBudWxsKQ0KICAgIHsNCiAgICAgICAgaWYgKCRsZXZlbCA9PT0gbnVsbCkgew0KICAgICAgICAgICAgJGxldmVsID0gJHRoaXMtPnVzZXItPkxldmVsOw0KICAgICAgICB9DQoNCiAgICAgICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fWmJwX0NoZWNrUmlnaHRzJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICAgICAkZnByZXR1cm4gPSAkZnBuYW1lKCRhY3Rpb24sICRsZXZlbCk7DQogICAgICAgICAgICBpZiAoJGZwc2lnbmFsID09IFBMVUdJTl9FWElUU0lHTkFMX1JFVFVSTikgew0KICAgICAgICAgICAgICAgICRmcHNpZ25hbCA9IFBMVUdJTl9FWElUU0lHTkFMX05PTkU7DQoNCiAgICAgICAgICAgICAgICByZXR1cm4gJGZwcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGlmICghaXNzZXQoJHRoaXMtPmFjdGlvbnNbJGFjdGlvbl0pKSB7DQogICAgICAgICAgICBpZiAoaXNfbnVtZXJpYygkYWN0aW9uKSkgew0KICAgICAgICAgICAgICAgIHJldHVybiAkbGV2ZWwgPD0gJGFjdGlvbjsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICRsZXZlbCA8PSAkdGhpcy0+YWN0aW9uc1skYWN0aW9uXTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmoLnmja7nlKjmiLfnrYnnuqfpqozor4Hmk43kvZzmnYPpmZAgMS415byA5aeL5Y+C5pWw5o2i6aG65bqPLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkYWN0aW9uIOaTjeS9nA0KICAgICAqIEBwYXJhbSBpbnQgICAgJGxldmVsICDnlKjmiLfnrYnnuqcNCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBDaGVja1JpZ2h0c0J5TGV2ZWwoJGFjdGlvbiwgJGxldmVsKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuICR0aGlzLT5DaGVja1JpZ2h0cygkYWN0aW9uLCAkbGV2ZWwpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmqjOivgeeUqOaIt+eZu+W9lS4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBWZXJpZnkoKQ0KICAgIHsNCiAgICAgICAgLy8g5Zyo5pmu6YCaIFdlYiDpobXpnaLkuK0NCiAgICAgICAgJHVzZXJuYW1lID0gdHJpbShHZXRWYXJzKCd1c2VybmFtZV8nIC4gaGFzaCgiY3JjMzJiIiwgJHRoaXMtPmd1aWQpLCAnQ09PS0lFJykpOw0KICAgICAgICAkdG9rZW4gPSB0cmltKEdldFZhcnMoJ3Rva2VuXycgLiBoYXNoKCJjcmMzMmIiLCAkdGhpcy0+Z3VpZCksICdDT09LSUUnKSk7DQogICAgICAgICR1c2VyID0gJHRoaXMtPlZlcmlmeVVzZXJUb2tlbigkdG9rZW4sICR1c2VybmFtZSk7DQoNCiAgICAgICAgaWYgKGlzX29iamVjdCgkdXNlcikpIHsNCiAgICAgICAgICAgICR0aGlzLT51c2VyID0gJHVzZXI7DQogICAgICAgICAgICAkdGhpcy0+aXNsb2dpbiA9IHRydWU7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KICAgICAgICAkdGhpcy0+dXNlciA9IG5ldyBNZW1iZXIoKTsNCiAgICAgICAgJHRoaXMtPnVzZXItPkd1aWQgPSBHZXRHdWlkKCk7DQogICAgICAgICR0aGlzLT5pc2xvZ2luID0gZmFsc2U7DQoNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOi/lOWbnueZu+W9leaIkOWKn+WQjuW6lOS/neWtmOeahGNvb2tpZeS/oeaBry4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBNZW1iZXIgJG0g5bey6aqM6L+H5oiQ5Yqf55qEbWVtYmVyDQogICAgICoNCiAgICAgKiBAcmV0dXJuIHN0cmluZw0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBWZXJpZnlSZXN1bHQoJG0pDQogICAgew0KICAgICAgICByZXR1cm4gJHRoaXMtPkdlbmVyYXRlVXNlclRva2VuKCRtKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDnlJ/miJBVc2VyIFRva2Vu77yM55So5LqO55m75b2V6aqM6K+BDQogICAgICoNCiAgICAgKiBAcGFyYW0gTWVtYmVyICR1c2VyDQogICAgICogQHBhcmFtIGludCAgICAkdGltZQ0KICAgICAqDQogICAgICogQHJldHVybiBzdHJpbmcNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2VuZXJhdGVVc2VyVG9rZW4oJHVzZXIsICR0aW1lID0gMCkNCiAgICB7DQogICAgICAgIGlmICgkdGltZSA9PT0gMCkgew0KICAgICAgICAgICAgJHRpbWUgPSAodGltZSgpICsgMzYwMCAqIDI0KTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiBDcmVhdGVXZWJUb2tlbigkdXNlci0+SUQsICR0aW1lLCAkdXNlci0+R3VpZCwgJHVzZXItPlBhc3NXb3JkX01ENVBhdGgpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOeUn+aIkEFwaSBUb2tlbu+8jOeUqOS6jiBBUEkg5qih5byP5LiL55qE55So5oi36aqM6K+BLg0KICAgICAqDQogICAgICogQHBhcmFtIE1lbWJlciAkdXNlcg0KICAgICAqIEBwYXJhbSBpbnQgICAgJHRpbWUNCiAgICAgKg0KICAgICAqIEByZXR1cm4gc3RyaW5nDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdlbmVyYXRlQXBpVG9rZW4oJHVzZXIsICR0aW1lID0gMCkNCiAgICB7DQogICAgICAgIHJldHVybiBiYXNlNjRfZW5jb2RlKCR1c2VyLT5OYW1lIC4gJ3x8fCcgLiAkdGhpcy0+R2VuZXJhdGVVc2VyVG9rZW4oJHVzZXIsIChpbnQpICR0aW1lKSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6aqM6K+B55So5oi355m75b2VVG9rZW4uDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICR0b2tlbg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHVzZXJuYW1lDQogICAgICoNCiAgICAgKiBAcmV0dXJuIE1lbWJlcnxudWxsDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFZlcmlmeVVzZXJUb2tlbigkdG9rZW4sICR1c2VybmFtZSkNCiAgICB7DQogICAgICAgICR1c2VyID0gJHRoaXMtPkdldE1lbWJlckJ5TmFtZSgkdXNlcm5hbWUpOw0KICAgICAgICBpZiAoJHVzZXItPklEICE9IG51bGwpIHsNCiAgICAgICAgICAgIGlmIChWZXJpZnlXZWJUb2tlbigkdG9rZW4sICR1c2VyLT5JRCwgJHVzZXItPkd1aWQsICR1c2VyLT5QYXNzV29yZF9NRDVQYXRoKSkgew0KICAgICAgICAgICAgICAgIHJldHVybiAkdXNlcjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiBudWxsOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmqjOivgeeUqOaIt+eZu+W9le+8iOS4gOasoU1ENeWvhuegge+8iS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUgICDnlKjmiLflkI0NCiAgICAgKiBAcGFyYW0gc3RyaW5nICRtZDVwdyAgbWQ15Yqg5a+G5ZCO55qE5a+G56CBDQogICAgICogQHBhcmFtIE1lbWJlciAkbWVtYmVyIOi/lOWbnuivu+WPluaIkOWKn+eahG1lbWJlcuWvueixoQ0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFZlcmlmeV9NRDUoJG5hbWUsICRtZDVwdywgJiRtZW1iZXIpDQogICAgew0KICAgICAgICBpZiAoJG5hbWUgPT0gJycgfHwgJG1kNXB3ID09ICcnKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCiAgICAgICAgJG1lbWJlciA9ICR0aGlzLT5HZXRNZW1iZXJCeU5hbWUoJG5hbWUpOw0KICAgICAgICBpZiAoJG1lbWJlci0+SUQgIT0gbnVsbCkgew0KICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5WZXJpZnlfRmluYWwoJG5hbWUsIG1kNSgkbWQ1cHcgLiAkbWVtYmVyLT5HdWlkKSwgJG1lbWJlcik7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6aqM6K+B55So5oi355m75b2V77yI5Y6f5aeL5piO5paH5a+G56CB77yJLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbmFtZSAgICAgICDnlKjmiLflkI0NCiAgICAgKiBAcGFyYW0gc3RyaW5nICRvcmlnaW5hbHB3IOWvhueggeaYjuaWhw0KICAgICAqIEBwYXJhbSBNZW1iZXIgJG1lbWJlciAgICAg6L+U5Zue6K+75Y+W5oiQ5Yqf55qEbWVtYmVy5a+56LGhDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gVmVyaWZ5X09yaWdpbmFsKCRuYW1lLCAkb3JpZ2luYWxwdywgJiRtZW1iZXIgPSBudWxsKQ0KICAgIHsNCiAgICAgICAgaWYgKCRuYW1lID09ICcnIHx8ICRvcmlnaW5hbHB3ID09ICcnKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCiAgICAgICAgJG0gPSAkdGhpcy0+R2V0TWVtYmVyQnlOYW1lKCRuYW1lKTsNCiAgICAgICAgaWYgKCRtLT5JRCAhPSBudWxsKSB7DQogICAgICAgICAgICByZXR1cm4gJHRoaXMtPlZlcmlmeV9NRDUoJG5hbWUsIG1kNSgkb3JpZ2luYWxwdyksICRtZW1iZXIpOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmqjOivgeeUqOaIt+eZu+W9le+8iOaVsOaNruW6k+S/neWtmOeahOacgOe7iOi/kOeul+WQjuWvhuegge+8iS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUgICAgIOeUqOaIt+WQjQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHBhc3N3b3JkIOS6jOasoeWKoOWvhuWQjueahOWvhueggQ0KICAgICAqIEBwYXJhbSBvYmplY3QgJG1lbWJlciAgIOi/lOWbnuivu+WPluaIkOWKn+eahG1lbWJlcuWvueixoQ0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFZlcmlmeV9GaW5hbCgkbmFtZSwgJHBhc3N3b3JkLCAmJG1lbWJlciA9IG51bGwpDQogICAgew0KICAgICAgICBpZiAoJG5hbWUgPT0gJycgfHwgJHBhc3N3b3JkID09ICcnKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCiAgICAgICAgJG0gPSAkdGhpcy0+R2V0TWVtYmVyQnlOYW1lKCRuYW1lKTsNCiAgICAgICAgaWYgKCRtLT5JRCAhPSBudWxsKSB7DQogICAgICAgICAgICBpZiAoaGFzaF9lcXVhbHMoJG0tPlBhc3N3b3JkLCAkcGFzc3dvcmQpID09PSB0cnVlKSB7DQogICAgICAgICAgICAgICAgJG1lbWJlciA9ICRtOw0KDQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6aqM6K+B55So5oi355m75b2V77yI5L2/55SoVG9rZW7vvIzmm7/ku6Plr4bnoIHkv53lrZjvvIkuDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRuYW1lICAg55So5oi35ZCNDQogICAgICogQHBhcmFtIHN0cmluZyAkd3QgICAgIFdlYlRva2VuDQogICAgICogQHBhcmFtIHN0cmluZyAkd3RfaWQgIFdlYlRva2Vu55qESUTor4bliKvnrKYNCiAgICAgKiBAcGFyYW0gb2JqZWN0ICRtZW1iZXIg6L+U5Zue6K+75Y+W5oiQ5Yqf55qEbWVtYmVy5a+56LGhDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gVmVyaWZ5X1Rva2VuKCRuYW1lLCAkd3QsICR3dF9pZCwgJiRtZW1iZXIgPSBudWxsKQ0KICAgIHsNCiAgICAgICAgaWYgKCRuYW1lID09ICcnIHx8ICR3dCA9PSAnJykgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQogICAgICAgICRtID0gbnVsbDsNCiAgICAgICAgJG0gPSAkdGhpcy0+R2V0TWVtYmVyQnlOYW1lKCRuYW1lKTsNCiAgICAgICAgaWYgKCRtLT5JRCAhPSBudWxsKSB7DQogICAgICAgICAgICBpZiAoVmVyaWZ5V2ViVG9rZW4oJHd0LCAkd3RfaWQsICR0aGlzLT5ndWlkLCAkbS0+SUQsICRtLT5QYXNzd29yZCkgPT09IHRydWUpIHsNCiAgICAgICAgICAgICAgICAkbWVtYmVyID0gJG07DQoNCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpqozor4EgQVBJIFRva2VuLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkYXBpX3Rva2VuDQogICAgICogQHJldHVybiBNZW1iZXJ8bnVsbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBWZXJpZnlBUElUb2tlbigkYXBpX3Rva2VuKQ0KICAgIHsNCiAgICAgICAgJGFwaV90b2tlbiA9IGJhc2U2NF9kZWNvZGUoJGFwaV90b2tlbik7DQoNCiAgICAgICAgaWYgKGVtcHR5KCRhcGlfdG9rZW4pKSB7DQogICAgICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIOmqjOivgeWtl+espuS4suagvOW8j+S4uiB7dXNlcm5hbWV9fHx8e3Rva2VufQ0KICAgICAgICAkYXBpX3Rva2VuX2FycmF5ID0gZXhwbG9kZSgnfHx8JywgJGFwaV90b2tlbik7DQogICAgICAgIGlmIChjb3VudCgkYXBpX3Rva2VuX2FycmF5KSAhPT0gMikgew0KICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJHRoaXMtPlZlcmlmeVVzZXJUb2tlbigkYXBpX3Rva2VuX2FycmF5WzFdLCAkYXBpX3Rva2VuX2FycmF5WzBdKTsNCiAgICB9DQoNCiAgICBwcml2YXRlICRsb2FkbWVtYmVyc19sZXZlbCA9IDA7DQoNCiAgICAvKioNCiAgICAgKiDovb3lhaXnlKjmiLfliJfooaguDQogICAgICoNCiAgICAgKiBAcGFyYW0gaW50ICRsZXZlbCDnlKjmiLfnrYnnuqcNCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBMb2FkTWVtYmVycygkbGV2ZWwgPSAwKQ0KICAgIHsNCiAgICAgICAgJHRoaXMtPmxvYWRtZW1iZXJzX2xldmVsID0gJGxldmVsOw0KICAgICAgICBpZiAoJHRoaXMtPmxvYWRtZW1iZXJzX2xldmVsIDwgMCkgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgJHdoZXJlID0gbnVsbDsNCiAgICAgICAgaWYgKCR0aGlzLT5sb2FkbWVtYmVyc19sZXZlbCA+IDApIHsNCiAgICAgICAgICAgICR3aGVyZSA9IGFycmF5KGFycmF5KCc8PScsICdtZW1fTGV2ZWwnLCAkdGhpcy0+bG9hZG1lbWJlcnNfbGV2ZWwpKTsNCiAgICAgICAgfQ0KICAgICAgICAkdGhpcy0+bWVtYmVycyA9IGFycmF5KCk7DQogICAgICAgICR0aGlzLT5tZW1iZXJzYnluYW1lID0gYXJyYXkoKTsNCiAgICAgICAgJGFycmF5ID0gJHRoaXMtPkdldE1lbWJlckxpc3QobnVsbCwgJHdoZXJlKTsNCg0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4fliJfooajvvIjmlofnq6Av6K+E6K66L+KApuKApu+8ieS4gOasoeaAp+WwhueUqOaIt+mihOi9veWFpeWIsCBtZW1iZXJzIOmHjC4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBhcnJheSAgJGxpc3QgICAgICAgICDmlofnq6Av6K+E6K665YiX6KGo5pWw57uEDQogICAgICogQHBhcmFtIHN0cmluZyAkbWVtX2lkX2ZpZWxkIOeUqOaItyBJRCDlnKjlr7nosaHkuK3nmoTlrZfmrrXlkI0NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbGVhbg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBMb2FkTWVtYmVyc0luTGlzdCgkbGlzdCwgJG1lbV9pZF9maWVsZCA9ICdBdXRob3JJRCcpDQogICAgew0KICAgICAgICAkbWVtX2lkc19uZWVkX2xvYWQgPSBhcnJheSgpOw0KICAgICAgICANCiAgICAgICAgZm9yZWFjaCAoJGxpc3QgYXMgJG9iaikgew0KICAgICAgICAgICAgaWYgKCFpc3NldCgkb2JqLT4kbWVtX2lkX2ZpZWxkKSB8fCAoJG9iai0+JG1lbV9pZF9maWVsZCA9PSBudWxsKSkgew0KICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyDlt7Lnu4/ovb3lhaXnmoTnlKjmiLfkuI3ph43mlrDovb3lhaUNCiAgICAgICAgICAgIGlmIChpc3NldCgkdGhpcy0+bWVtYmVyc1skb2JqLT4kbWVtX2lkX2ZpZWxkXSkpIHsNCiAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgJG1lbV9pZHNfbmVlZF9sb2FkW10gPSAkb2JqLT4kbWVtX2lkX2ZpZWxkOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKGNvdW50KCRtZW1faWRzX25lZWRfbG9hZCkgPT09IDApIHsNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9DQoNCiAgICAgICAgJGFycmF5ID0gJHRoaXMtPkdldE1lbWJlckxpc3QobnVsbCwgYXJyYXkoYXJyYXkoJ0lOJywgJ21lbV9JRCcsICRtZW1faWRzX25lZWRfbG9hZCkpKTsNCg0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDnp4HmnInmlrnms5XkuYvpgJLlvZLliqDovb3liIbnsbsuDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGFycmF5DQogICAgICovDQogICAgcHJpdmF0ZSBmdW5jdGlvbiBMb2FkQ2F0ZWdvcmllc19SZWN1cnNpb24oJGRlZXAsICRpZCwgJiRsdiwgJHR5cGUpDQogICAgew0KICAgICAgICBpZiAoKCRkZWVwICsgMSkgPj0gJHRoaXMtPmNhdGVnb3J5X3JlY3Vyc2lvbl9yZWFsX2RlZXApIHsNCiAgICAgICAgICAgICR0aGlzLT5jYXRlZ29yeV9yZWN1cnNpb25fcmVhbF9kZWVwID0gKCRkZWVwICsgMSk7DQogICAgICAgIH0NCiAgICAgICAgJHN1YmFycmF5ID0gYXJyYXkoKTsNCiAgICAgICAgZm9yICgkaSA9IDA7ICRpIDwgJHRoaXMtPmNhdGVnb3J5X3JlY3Vyc2lvbl9sZXZlbDsgJGkrKykgew0KICAgICAgICAgICAgJG5hbWUgPSAnbHYnIC4gJGk7DQogICAgICAgICAgICAkeyRuYW1lfSA9ICYkbHZbJGldOw0KICAgICAgICB9DQogICAgICAgICRsdmRlZXAgPSAnbHYnIC4gJGRlZXA7DQogICAgICAgICR0aGlzLT5jYXRlZ29yaWVzYnlvcmRlcl90eXBlWyR0eXBlXVskaWRdID0gJiR0aGlzLT5jYXRlZ29yaWVzX2FsbFskaWRdOw0KICAgICAgICBpZiAoJGRlZXAgPCAoJHRoaXMtPmNhdGVnb3J5X3JlY3Vyc2lvbl9sZXZlbCAtIDEpKSB7DQogICAgICAgICAgICAkZGVlcCArPSAxOw0KICAgICAgICAgICAgJGx2ZGVlcG5leHQgPSAnbHYnIC4gJGRlZXA7DQogICAgICAgICAgICBpZiAoaXNzZXQoJHskbHZkZWVwbmV4dH1bJGlkXSkpIHsNCiAgICAgICAgICAgICAgICBmb3JlYWNoICgkeyRsdmRlZXBuZXh0fVskaWRdIGFzICRpZG5vdykgew0KICAgICAgICAgICAgICAgICAgICAkc3ViYXJyYXlbXSA9ICRpZG5vdzsNCiAgICAgICAgICAgICAgICAgICAgJGIgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgZm9yZWFjaCAoJHRoaXMtPmNhdGVnb3JpZXNieW9yZGVyX3R5cGVbJHR5cGVdWyRpZF0tPlN1YkNhdGVnb3JpZXMgYXMgJGtleTIgPT4gJHZhbHVlMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCR2YWx1ZTItPklEID09ICRpZG5vdykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICRiID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBpZiAoJGIgPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5jYXRlZ29yaWVzYnlvcmRlcl90eXBlWyR0eXBlXVskaWRdLT5TdWJDYXRlZ29yaWVzW10gPSAmJHRoaXMtPmNhdGVnb3JpZXNfYWxsWyRpZG5vd107DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgLy8kdGhpcy0+Y2F0ZWdvcmllc2J5b3JkZXJbJGlkXS0+Q2hpbGRyZW5DYXRlZ29yaWVzW10gPSAmJHRoaXMtPmNhdGVnb3JpZXNbJGlkbm93XTsNCiAgICAgICAgICAgICAgICAgICAgJGFycmF5ID0gJHRoaXMtPkxvYWRDYXRlZ29yaWVzX1JlY3Vyc2lvbigkZGVlcCwgJGlkbm93LCAkbHYsICR0eXBlKTsNCiAgICAgICAgICAgICAgICAgICAgZm9yZWFjaCAoJGFycmF5IGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAkc3ViYXJyYXlbXSA9ICR2YWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICAkc3ViYXJyYXkgPSBhcnJheV91bmlxdWUoJHN1YmFycmF5KTsNCiAgICAgICAgZm9yZWFjaCAoJHN1YmFycmF5IGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICAgICAkYiA9IGZhbHNlOw0KICAgICAgICAgICAgZm9yZWFjaCAoJHRoaXMtPmNhdGVnb3JpZXNieW9yZGVyX3R5cGVbJHR5cGVdWyRpZF0tPkNoaWxkcmVuQ2F0ZWdvcmllcyBhcyAka2V5MiA9PiAkdmFsdWUyKSB7DQogICAgICAgICAgICAgICAgaWYgKCR2YWx1ZTItPklEID09ICR2YWx1ZSkgew0KICAgICAgICAgICAgICAgICAgICAkYiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICgkYiA9PSBmYWxzZSkgew0KICAgICAgICAgICAgICAgICR0aGlzLT5jYXRlZ29yaWVzYnlvcmRlcl90eXBlWyR0eXBlXVskaWRdLT5DaGlsZHJlbkNhdGVnb3JpZXNbXSA9ICYkdGhpcy0+Y2F0ZWdvcmllc19hbGxbJHZhbHVlXTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gJHN1YmFycmF5Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOi9veWFpeWIhuexu+WIl+ihqC4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBMb2FkQ2F0ZWdvcmllcygpDQogICAgew0KICAgICAgICAkdGhpcy0+Y2F0ZWdvcmllc19hbGwgPSBhcnJheSgpOw0KDQogICAgICAgICR0aGlzLT5jYXRlZ29yaWVzYnlvcmRlciA9IGFycmF5KCk7DQogICAgICAgICR0aGlzLT5jYXRlZ29yaWVzID0gJiR0aGlzLT5jYXRlZ29yaWVzYnlvcmRlcjsNCg0KICAgICAgICAkdGhpcy0+Y2F0ZWdvcmllc2J5b3JkZXJfdHlwZSA9IGFycmF5KCk7DQogICAgICAgICR0aGlzLT5jYXRlZ29yaWVzX3R5cGUgPSBhcnJheSgpOw0KDQogICAgICAgICR0aGlzLT5jYXRlZ29yeXMgPSAmJHRoaXMtPmNhdGVnb3JpZXM7DQogICAgICAgICR0aGlzLT5jYXRlZ29yeXNieW9yZGVyID0gJiR0aGlzLT5jYXRlZ29yaWVzYnlvcmRlcjsNCg0KICAgICAgICBmb3JlYWNoICgkdGhpcy0+cG9zdHR5cGUgYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgICAgIGlmICghaXNzZXQoJHRoaXMtPmNhdGVnb3JpZXNfdHlwZVska2V5XSkpIHsNCiAgICAgICAgICAgICAgICAkdGhpcy0+Y2F0ZWdvcmllc190eXBlWyRrZXldID0gYXJyYXkoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICghaXNzZXQoJHRoaXMtPmNhdGVnb3JpZXNieW9yZGVyX3R5cGVbJGtleV0pKSB7DQogICAgICAgICAgICAgICAgJHRoaXMtPmNhdGVnb3JpZXNieW9yZGVyX3R5cGVbJGtleV0gPSBhcnJheSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgJGFycmF5ID0gJHRoaXMtPkdldENhdGVnb3J5TGlzdChudWxsLCBudWxsLCBhcnJheSgnY2F0ZV9PcmRlcicgPT4gJ0FTQycpLCBudWxsLCBudWxsKTsNCiAgICAgICAgaWYgKGNvdW50KCRhcnJheSkgPT0gMCkgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgZm9yZWFjaCAoJHRoaXMtPnBvc3R0eXBlIGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICAgICAkbHYgPSBhcnJheSgpOw0KICAgICAgICAgICAgZm9yICgkaSA9IDA7ICRpIDwgJHRoaXMtPmNhdGVnb3J5X3JlY3Vyc2lvbl9sZXZlbDsgJGkrKykgew0KICAgICAgICAgICAgICAgICRuYW1lID0gJ2x2JyAuICRpOw0KICAgICAgICAgICAgICAgICR7JG5hbWV9ID0gYXJyYXkoKTsNCiAgICAgICAgICAgICAgICAkbHZbJGldID0gJiR7JG5hbWV9Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgJGNhdGVnb3JpZXMgPSAkdGhpcy0+Y2F0ZWdvcmllc190eXBlWyRrZXldOw0KDQogICAgICAgICAgICBmb3JlYWNoICgkY2F0ZWdvcmllcyBhcyAkaWQgPT4gJGMpIHsNCiAgICAgICAgICAgICAgICAkbCA9ICdsdicgLiAkYy0+TGV2ZWw7DQogICAgICAgICAgICAgICAgJHskbH1bJGMtPlBhcmVudElEXVtdID0gJGlkOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIWlzc2V0KCRsdjBbMF0pKSB7DQogICAgICAgICAgICAgICAgJGx2MFswXSA9IGFycmF5KCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGZvcmVhY2ggKCRsdjBbMF0gYXMgJGlkMCkgew0KICAgICAgICAgICAgICAgICR0aGlzLT5Mb2FkQ2F0ZWdvcmllc19SZWN1cnNpb24oMCwgJGlkMCwgJGx2LCAka2V5KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgICR0aGlzLT5jYXRlZ29yaWVzX3R5cGUgPSAmJHRoaXMtPmNhdGVnb3JpZXNieW9yZGVyX3R5cGU7DQogICAgICAgICR0aGlzLT5jYXRlZ29yaWVzYnlvcmRlciA9ICYkdGhpcy0+Y2F0ZWdvcmllc2J5b3JkZXJfdHlwZVswXTsNCiAgICAgICAgJHRoaXMtPmNhdGVnb3JpZXMgPSAmJHRoaXMtPmNhdGVnb3JpZXNieW9yZGVyOw0KICAgICAgICAkdGhpcy0+Y2F0ZWdvcnlzID0gJiR0aGlzLT5jYXRlZ29yaWVzOw0KICAgICAgICAkdGhpcy0+Y2F0ZWdvcnlzYnlvcmRlciA9ICYkdGhpcy0+Y2F0ZWdvcmllc2J5b3JkZXI7DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6L295YWl5qCH562+5YiX6KGoLg0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIExvYWRUYWdzKCkNCiAgICB7DQogICAgICAgICR0aGlzLT50YWdzX3R5cGUgPSBhcnJheSgpOw0KICAgICAgICAkdGhpcy0+dGFnc2J5bmFtZV90eXBlID0gYXJyYXkoKTsNCg0KICAgICAgICAkdGhpcy0+dGFncyA9IGFycmF5KCk7DQogICAgICAgICR0aGlzLT50YWdzYnluYW1lID0gYXJyYXkoKTsNCg0KICAgICAgICAkdGhpcy0+dGFnc19hbGwgPSBhcnJheSgpOw0KDQogICAgICAgICRhcnJheSA9ICR0aGlzLT5HZXRUYWdMaXN0KCk7DQoNCiAgICAgICAgaXNzZXQoJHRoaXMtPnRhZ3NfdHlwZVswXSkgfHwgJHRoaXMtPnRhZ3NfdHlwZVswXSA9IGFycmF5KCk7DQogICAgICAgIGlzc2V0KCR0aGlzLT50YWdzYnluYW1lX3R5cGVbMF0pIHx8ICR0aGlzLT50YWdzYnluYW1lX3R5cGVbMF0gPSBhcnJheSgpOw0KDQogICAgICAgICR0aGlzLT50YWdzID0gJiR0aGlzLT50YWdzX3R5cGVbMF07DQogICAgICAgICR0aGlzLT50YWdzYnluYW1lID0gJiR0aGlzLT50YWdzYnluYW1lX3R5cGVbMF07DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6L295YWl5qih5Z2X5YiX6KGoLg0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIExvYWRNb2R1bGVzKCkNCiAgICB7DQogICAgICAgICR0aGlzLT5tb2R1bGVzID0gYXJyYXkoKTsNCiAgICAgICAgJHRoaXMtPm1vZHVsZXNieWZpbGVuYW1lID0gYXJyYXkoKTsNCiAgICAgICAgJGFycmF5ID0gJHRoaXMtPkdldE1vZHVsZUxpc3QoKTsNCg0KICAgICAgICAkZGlyID0gJHRoaXMtPnVzZXJzZGlyIC4gJ3RoZW1lLycgLiAkdGhpcy0+dGhlbWUgLiAnL2luY2x1ZGUvJzsNCiAgICAgICAgaWYgKGZpbGVfZXhpc3RzKCRkaXIpKSB7DQogICAgICAgICAgICAkZmlsZXMgPSBHZXRGaWxlc0luRGlyKCRkaXIsICdwaHAnKTsNCiAgICAgICAgICAgIGZvcmVhY2ggKCRmaWxlcyBhcyAkc29ydG5hbWUgPT4gJGZ1bGxuYW1lKSB7DQogICAgICAgICAgICAgICAgJG0gPSBuZXcgTW9kdWxlKCk7DQogICAgICAgICAgICAgICAgJG0tPkZpbGVOYW1lID0gJHNvcnRuYW1lOw0KICAgICAgICAgICAgICAgICRtLT5OYW1lID0gJHNvcnRuYW1lOw0KICAgICAgICAgICAgICAgICRtLT5IdG1sSUQgPSAkc29ydG5hbWU7DQogICAgICAgICAgICAgICAgJG0tPkNvbnRlbnQgPSBmaWxlX2dldF9jb250ZW50cygkZnVsbG5hbWUpOw0KICAgICAgICAgICAgICAgIGlmIChzdHJpcG9zKCRtLT5Db250ZW50LCAnPGxpJykgIT09IGZhbHNlICYmIHN0cmlwb3MoJG0tPkNvbnRlbnQsICc8L2xpPicpICE9PSBmYWxzZSkgew0KICAgICAgICAgICAgICAgICAgICAkbS0+VHlwZSA9ICd1bCc7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgJG0tPlR5cGUgPSAnZGl2JzsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgJG0tPlNvdXJjZSA9ICd0aGVtZWluY2x1ZGVfJyAuICR0aGlzLT50aGVtZTsNCiAgICAgICAgICAgICAgICAkbS0+SUQgPSAoMCAtIChpbnQpIGNyYzMyKCRtLT5Tb3VyY2UgLiAkbS0+RmlsZU5hbWUpKTsNCiAgICAgICAgICAgICAgICAkdGhpcy0+QWRkQ2FjaGUoJG0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6L295YWl5Li76aKY5YiX6KGoLg0KICAgICAqDQogICAgICogQHJldHVybiBBcHBbXQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBMb2FkVGhlbWVzKCkNCiAgICB7DQogICAgICAgICRhbGxUaGVtZXMgPSBhcnJheSgpOw0KICAgICAgICAkZGlycyA9IEdldERpcnNJbkRpcigkdGhpcy0+dXNlcnNkaXIgLiAndGhlbWUvJyk7DQogICAgICAgIG5hdGNhc2Vzb3J0KCRkaXJzKTsNCiAgICAgICAgYXJyYXlfdW5zaGlmdCgkZGlycywgJHRoaXMtPnRoZW1lKTsNCiAgICAgICAgJGRpcnMgPSBhcnJheV91bmlxdWUoJGRpcnMpOw0KICAgICAgICBmb3JlYWNoICgkZGlycyBhcyAkaWQpIHsNCiAgICAgICAgICAgICRhcHAgPSBuZXcgQXBwKCk7DQogICAgICAgICAgICBpZiAoJGFwcC0+TG9hZEluZm9CeVhtbCgndGhlbWUnLCAkaWQpID09IHRydWUpIHsNCiAgICAgICAgICAgICAgICAkYWxsVGhlbWVzW10gPSAkYXBwOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICRhbGxUaGVtZXM7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6L295YWl5o+S5Lu25YiX6KGoLg0KICAgICAqDQogICAgICogQHJldHVybiBBcHBbXQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBMb2FkUGx1Z2lucygpDQogICAgew0KICAgICAgICAkYWxsUGx1Z2lucyA9IGFycmF5KCk7DQogICAgICAgICRkaXJzID0gR2V0RGlyc0luRGlyKCR0aGlzLT51c2Vyc2RpciAuICdwbHVnaW4vJyk7DQogICAgICAgIG5hdGNhc2Vzb3J0KCRkaXJzKTsNCg0KICAgICAgICBmb3JlYWNoICgkZGlycyBhcyAkaWQpIHsNCiAgICAgICAgICAgICRhcHAgPSBuZXcgQXBwKCk7DQogICAgICAgICAgICBpZiAoJGFwcC0+TG9hZEluZm9CeVhtbCgncGx1Z2luJywgJGlkKSA9PSB0cnVlKSB7DQogICAgICAgICAgICAgICAgJGFsbFBsdWdpbnNbXSA9ICRhcHA7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJGFsbFBsdWdpbnM7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6L295YWl5oyH5a6a5bqU55SoLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkdHlwZSDlupTnlKjnsbvlnosodGhlbWV8cGx1Z2luKQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgJGlkICAg5bqU55SoSUQNCiAgICAgKg0KICAgICAqIEByZXR1cm4gQXBwDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIExvYWRBcHAoJHR5cGUsICRpZCkNCiAgICB7DQogICAgICAgICRhcHAgPSBuZXcgQXBwKCk7DQogICAgICAgIGlmICgkYXBwLT5Mb2FkSW5mb0J5WG1sKCR0eXBlLCAkaWQpICE9IHRydWUpIHsNCiAgICAgICAgICAgICRhcHAtPmlzbG9hZGVkID0gZmFsc2U7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJGFwcDsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmo4Dmn6XlupTnlKjmmK/lkKblronoo4XlubblkK/nlKguDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRuYW1lIOW6lOeUqO+8iOaPkuS7tuaIluS4u+mimO+8ieeahElEDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQ2hlY2tQbHVnaW4oJG5hbWUpDQogICAgew0KICAgICAgICByZXR1cm4gaW5fYXJyYXkoJG5hbWUsICR0aGlzLT5hY3RpdmVkYXBwcyk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5qOA5p+l5bqU55So5piv5ZCm5a6J6KOF5bm25ZCv55SoLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbmFtZSDlupTnlKhJRO+8iOaPkuS7tuaIluS4u+mimO+8iQ0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIENoZWNrQXBwKCRuYW1lKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuICR0aGlzLT5DaGVja1BsdWdpbigkbmFtZSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6I635Y+W6aKE5r+A5rS75o+S5Lu25ZCN5pWw57uELg0KICAgICAqDQogICAgICogQHJldHVybiBzdHJpbmdbXQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRQcmVBY3RpdmVQbHVnaW4oKQ0KICAgIHsNCiAgICAgICAgJGFwID0gZXhwbG9kZSgifCIsICR0aGlzLT5vcHRpb25bJ1pDX1VTSU5HX1BMVUdJTl9MSVNUJ10pOw0KICAgICAgICAkYXAgPSBhcnJheV91bmlxdWUoJGFwKTsNCg0KICAgICAgICByZXR1cm4gJGFwOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOi9veWFpeaMh+WumuW6lOeUqOivreiogOWMhS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHR5cGUgICAg5bqU55So57G75Z6LKHN5c3RlbXx0aGVtZXxwbHVnaW4pDQogICAgICogQHBhcmFtIHN0cmluZyAkaWQgICAgICDlupTnlKhJRA0KICAgICAqIEBwYXJhbSBzdHJpbmcgJGRlZmF1bHQg6buY6K6k6K+t6KiADQogICAgICoNCiAgICAgKiBAdGhyb3dzIEV4Y2VwdGlvbg0KICAgICAqDQogICAgICogQHJldHVybiBudWxsDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIExvYWRMYW5ndWFnZSgkdHlwZSwgJGlkLCAkZGVmYXVsdCA9ICcnKQ0KICAgIHsNCiAgICAgICAgJGxhbmd1YWdlUGF0aCA9ICR0aGlzLT5wYXRoOw0KICAgICAgICAkbGFuZ3VhZ2VSZWdFeCA9ICcvXihbMC05QS1aXC1fXSopXC5waHAkL3VpJzsNCiAgICAgICAgJGxhbmd1YWdlTGlzdCA9IGFycmF5KCk7DQogICAgICAgICRsYW5ndWFnZSA9ICcnOw0KICAgICAgICAkZGVmYXVsdCA9IHN0cl9yZXBsYWNlKGFycmF5KCcvJywgJ1xcJyksICcnLCAkZGVmYXVsdCk7DQogICAgICAgICRsYW5ndWFnZVB0ciA9ICYkdGhpcy0+bGFuZzsNCg0KICAgICAgICBpZiAoJGRlZmF1bHQgPT09ICcnKSB7DQogICAgICAgICAgICAkZGVmYXVsdCA9ICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfTEFOR1VBR0VQQUNLJ107DQogICAgICAgIH0NCg0KICAgICAgICAkZGVmYXVsdExhbmd1YWdlTGlzdCA9IGFycmF5KCRkZWZhdWx0LCAnemgtY24nLCAnemgtdHcnLCAnZW4nKTsNCg0KICAgICAgICBzd2l0Y2ggKCR0eXBlKSB7DQogICAgICAgICAgICBjYXNlICdzeXN0ZW0nOg0KICAgICAgICAgICAgICAgICRsYW5ndWFnZVBhdGggLj0gJ3piX3VzZXJzL2xhbmd1YWdlLyc7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdwbHVnaW4nOg0KICAgICAgICAgICAgY2FzZSAndGhlbWUnOg0KICAgICAgICAgICAgICAgICRsYW5ndWFnZVBhdGggLj0gJ3piX3VzZXJzLycgLiAkdHlwZSAuICcvJyAuICRpZCAuICcvbGFuZ3VhZ2UvJzsNCiAgICAgICAgICAgICAgICAkbGFuZ3VhZ2VQdHIgPSAmJHRoaXMtPmxhbmdbJGlkXTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgICAgICAgJGxhbmd1YWdlUGF0aCAuPSAkdHlwZSAuICcvbGFuZ3VhZ2UvJzsNCiAgICAgICAgICAgICAgICAkbGFuZ3VhZ2VQdHIgPSAmJHRoaXMtPmxhbmdbJGlkXTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgfQ0KDQogICAgICAgICRoYW5kbGUgPSBAb3BlbmRpcigkbGFuZ3VhZ2VQYXRoKTsNCiAgICAgICAgJG1hdGNoID0gbnVsbDsNCiAgICAgICAgaWYgKCRoYW5kbGUpIHsNCiAgICAgICAgICAgIHdoaWxlIChmYWxzZSAhPT0gKCRmaWxlID0gcmVhZGRpcigkaGFuZGxlKSkpIHsNCiAgICAgICAgICAgICAgICBpZiAocHJlZ19tYXRjaCgkbGFuZ3VhZ2VSZWdFeCwgJGZpbGUsICRtYXRjaCkpIHsNCiAgICAgICAgICAgICAgICAgICAgJGxhbmd1YWdlTGlzdFtdID0gJG1hdGNoWzFdOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGNsb3NlZGlyKCRoYW5kbGUpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgLy8g6L+Z6YeM5LiN5Lya5omn6KGM5Yiw77yM5Zyob3BlbmRpcuaXtuWwseW3sue7j+aKm+WHukVfV0FSTklORw0KICAgICAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbignQ2Fubm90IG9wZW5kaXIoJyAuICRsYW5ndWFnZVBhdGggLiAnKScpOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKGNvdW50KCRsYW5ndWFnZUxpc3QpID09PSAwKSB7DQogICAgICAgICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKCdObyBsYW5ndWFnZSBpbiAnIC4gJGxhbmd1YWdlUGF0aCk7DQogICAgICAgIH0NCg0KICAgICAgICBmb3IgKCRpID0gMDsgJGkgPCBjb3VudCgkZGVmYXVsdExhbmd1YWdlTGlzdCk7ICRpKyspIHsNCiAgICAgICAgICAgIC8vIOWcqOaViOeOh+S4iu+8jGFycmF5X3NlYXJjaOWSjOWRveWQjeaVsOe7hOayoeacieacrOi0qOWMuuWIq++8jOiHs+WwkeWcqOi/memHjOWmguatpOOAgg0KICAgICAgICAgICAgaWYgKGZhbHNlICE9PSBhcnJheV9zZWFyY2goJGRlZmF1bHRMYW5ndWFnZUxpc3RbJGldLCAkbGFuZ3VhZ2VMaXN0KSkgew0KICAgICAgICAgICAgICAgICRsYW5ndWFnZSA9ICRkZWZhdWx0TGFuZ3VhZ2VMaXN0WyRpXTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBpZiAoJGxhbmd1YWdlID09PSAnJykgew0KICAgICAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbignTGFuZ3VhZ2UgJyAuICRkZWZhdWx0IC4gJyBpcyBub3QgZm91bmQgaW4gJyAuICRsYW5ndWFnZVBhdGgpOw0KICAgICAgICB9DQoNCiAgICAgICAgJGxhbmd1YWdlUGF0aCAuPSAkbGFuZ3VhZ2UgLiAnLnBocCc7DQogICAgICAgICRsYW5ndWFnZVB0ciA9IGluY2x1ZGUgJGxhbmd1YWdlUGF0aDsNCiAgICAgICAgJHRoaXMtPmxhbmdwYWNrbGlzdFtdID0gYXJyYXkoJHR5cGUsICRpZCwgJGxhbmd1YWdlKTsNCiAgICAgICAgaWYgKCR0eXBlID09ICdzeXN0ZW0nKSB7DQogICAgICAgICAgICBpZiAoaXNfcmVhZGFibGUoJHRoaXMtPnN5c3RlbWRpciAuICdkZWZlbmQvZW4ucGhwJykpIHsNCiAgICAgICAgICAgICAgICAkZGVmZW5kX2VuID0gaW5jbHVkZSAkdGhpcy0+c3lzdGVtZGlyIC4gJ2RlZmVuZC9lbi5waHAnOw0KICAgICAgICAgICAgICAgICRub3dsYW5nID0gJGxhbmd1YWdlUHRyOw0KICAgICAgICAgICAgICAgICR0aGlzLT5sYW5nID0gYXJyYXlfbWVyZ2UoJGRlZmVuZF9lbiwgJG5vd2xhbmcpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgJHRoaXMtPmxhbmdzID0ganNvbl9kZWNvZGUoanNvbl9lbmNvZGUoJHRoaXMtPmxhbmcpKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGlmICgkaWQgIT0gJycgJiYgaXNzZXQoJHRoaXMtPmxhbmdbJGlkXSkpIHsNCiAgICAgICAgICAgICAgICAkdGhpcy0+bGFuZ3MtPiRpZCA9IGpzb25fZGVjb2RlKGpzb25fZW5jb2RlKCR0aGlzLT5sYW5nWyRpZF0pKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1picF9Mb2FkTGFuZ3VhZ2UnXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgICAgICRmcG5hbWUoJHRoaXMtPmxhbmcpOw0KICAgICAgICAgICAgJHRoaXMtPmxhbmdzID0ganNvbl9kZWNvZGUoanNvbl9lbmNvZGUoJHRoaXMtPmxhbmcpKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIHB1YmxpYyBmdW5jdGlvbiBSZWZsdXNoTGFuZ3VhZ2VzKCkNCiAgICB7DQogICAgICAgICR0aGlzLT5sYW5nWydlcnJvciddWyc3NyddID0gc3RyX3JlcGxhY2UoYXJyYXkoJyVtaW4nLCAnJW1heCcpLCBhcnJheSgkdGhpcy0+b3B0aW9uWydaQ19VU0VSTkFNRV9NSU4nXSwgJHRoaXMtPm9wdGlvblsnWkNfVVNFUk5BTUVfTUFYJ10pLCAkdGhpcy0+bGFuZ1snZXJyb3InXVsnNzcnXSk7DQogICAgICAgICR0aGlzLT5sYW5ncyA9IGpzb25fZGVjb2RlKGpzb25fZW5jb2RlKCR0aGlzLT5sYW5nKSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YeN5paw6K+75Y+W6K+t6KiA5YyFLg0KICAgICAqDQogICAgICogQHRocm93cyBFeGNlcHRpb24NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gUmVsb2FkTGFuZ3VhZ2VzKCkNCiAgICB7DQogICAgICAgICRhcnJheSA9ICR0aGlzLT5sYW5ncGFja2xpc3Q7DQogICAgICAgICR0aGlzLT5sYW5nID0gJHRoaXMtPmxhbmdwYWNrbGlzdCA9IGFycmF5KCk7DQogICAgICAgIGZvcmVhY2ggKCRhcnJheSBhcyAkdikgew0KICAgICAgICAgICAgJHRoaXMtPkxvYWRMYW5ndWFnZSgkdlswXSwgJHZbMV0sICR2WzJdKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWIm+W7uuaooeadv+Wvueixoe+8jOmihOWKoOi9veW3sue8luivkeaooeadvw0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkdGhlbWUg5oyH5a6a5Li76aKY5ZCNDQogICAgICoNCiAgICAgKiBAcmV0dXJuIFRlbXBsYXRlDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFByZXBhcmVUZW1wbGF0ZSgkdGhlbWUgPSBudWxsLCAkdGVtcGxhdGVfZGlybmFtZSA9ICd0ZW1wbGF0ZScpDQogICAgew0KICAgICAgICBpZiAoaXNfbnVsbCgkdGhlbWUpIHx8IGVtcHR5KCR0aGVtZSkpIHsNCiAgICAgICAgICAgICR0aGVtZSA9ICYkdGhpcy0+dGhlbWU7DQogICAgICAgIH0NCg0KICAgICAgICAkdGVtcGxhdGUgPSBuZXcgVGVtcGxhdGUoKTsNCiAgICAgICAgJHRlbXBsYXRlLT5NYWtlVGVtcGxhdGVUYWdzKCk7DQoNCiAgICAgICAgLy/ogIHmjqXlj6PvvIzlj6rmlLl0ZW1wbGF0ZVRhZ3PnmoQNCiAgICAgICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fWmJwX01ha2VUZW1wbGF0ZXRhZ3MnXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgICAgICRmcG5hbWUoJHRlbXBsYXRlLT50ZW1wbGF0ZVRhZ3MpOw0KICAgICAgICB9DQoNCiAgICAgICAgLy/mraTlpITlop7liqDmjqXlj6Plj6/ku6XlnKhMb2Fk5pe277yM5a+5JHRoZW1lLCAkdGVtcGxhdGVfZGlybmFtZeWPguaVsOWPr+S7pei/m+ihjOS/ruaUuQ0KICAgICAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9aYnBfUHJlcGFyZVRlbXBsYXRlJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICAgICAkZnBuYW1lKCR0aGVtZSwgJHRlbXBsYXRlX2Rpcm5hbWUpOw0KICAgICAgICB9DQoNCiAgICAgICAgJHRlbXBsYXRlLT50aGVtZSA9ICR0aGVtZTsNCiAgICAgICAgJHRlbXBsYXRlLT50ZW1wbGF0ZV9kaXJuYW1lID0gJHRlbXBsYXRlX2Rpcm5hbWU7DQoNCiAgICAgICAgJHRlbXBsYXRlLT5TZXRQYXRoKCk7DQoNCiAgICAgICAgJHRlbXBsYXRlLT5Mb2FkVGVtcGxhdGVzKCk7DQoNCiAgICAgICAgcmV0dXJuICR0ZW1wbGF0ZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpkojlr7nmnInlkIzkuIDkuLvpopjkuIvmnInlpJrlpZfmqKHmnb/nmoTop6PmnpANCiAgICAgKiDnm7TmjqXlnKjmjqXlj6PkuK3nm7TmjqXosIPnlKgkemJwLT5CdWlsZFRlbXBsYXRlTW9yZei/m+ihjOmHjeaWsOe8luivkeWFtuWug+aooeadvw0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBCdWlsZFRlbXBsYXRlKCkNCiAgICB7DQogICAgICAgICR0aGlzLT5CdWlsZFRlbXBsYXRlX09uY2UoKTsNCg0KICAgICAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9aYnBfQnVpbGRUZW1wbGF0ZV9FbmQnXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgICAgICRmcG5hbWUoJHRoaXMtPnRlbXBsYXRlKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOW/q+aNt+mHjeaWsOe8luivkeaMh+WumuS4u+mimOaooeadv+ebruW9leWQjeeahOaooeadvw0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEJ1aWxkVGVtcGxhdGVNb3JlKCR0aGVtZSA9IG51bGwsICR0ZW1wbGF0ZV9kaXJuYW1lID0gJ3RlbXBsYXRlJykNCiAgICB7DQogICAgICAgIGlmIChpc19udWxsKCR0aGVtZSkgfHwgZW1wdHkoJHRoZW1lKSkgew0KICAgICAgICAgICAgJHRoZW1lID0gJiR0aGlzLT50aGVtZTsNCiAgICAgICAgfQ0KICAgICAgICAkdGhpcy0+dGVtcGxhdGUtPnRoZW1lID0gJHRoZW1lOw0KICAgICAgICAkdGhpcy0+dGVtcGxhdGUtPnRlbXBsYXRlX2Rpcm5hbWUgPSAkdGVtcGxhdGVfZGlybmFtZTsNCiAgICAgICAgJHRoaXMtPnRlbXBsYXRlLT5TZXRQYXRoKCk7DQogICAgICAgIHJldHVybiAkdGhpcy0+QnVpbGRUZW1wbGF0ZV9PbmNlKCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5qih5p2/6Kej5p6QLg0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHJpdmF0ZSBmdW5jdGlvbiBCdWlsZFRlbXBsYXRlX09uY2UoKQ0KICAgIHsNCiAgICAgICAgJHRoaXMtPnRlbXBsYXRlLT5Mb2FkVGVtcGxhdGVzKCk7DQoNCiAgICAgICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fWmJwX0J1aWxkVGVtcGxhdGUnXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgICAgICRmcG5hbWUoJHRoaXMtPnRlbXBsYXRlLT50ZW1wbGF0ZXMpOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICR0aGlzLT50ZW1wbGF0ZS0+QnVpbGRUZW1wbGF0ZSgpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOabtOaWsOaooeadv+e8k+WtmC4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBib29sICRvbmx5Y2hlY2sgIOS4uuecn+eahOivne+8jOWPquWIpOaWreaYr+WQpumcgOimgeiAjOS4jUJ1aWxkDQogICAgICogQHBhcmFtIGJvb2wgJGZvcmNlYnVpbGQNCiAgICAgKg0KICAgICAqIEByZXR1cm4gdHJ1ZSBvciBmYWxzZQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBDaGVja1RlbXBsYXRlKCRvbmx5Y2hlY2sgPSBmYWxzZSwgJGZvcmNlYnVpbGQgPSBmYWxzZSkNCiAgICB7DQogICAgICAgICR0aGlzLT50ZW1wbGF0ZS0+TG9hZFRlbXBsYXRlcygpOw0KICAgICAgICAkcyA9IGltcGxvZGUoJHRoaXMtPnRlbXBsYXRlLT50ZW1wbGF0ZXMpOw0KICAgICAgICAkbWQ1ID0gbWQ1KCRzKTsNCg0KICAgICAgICAvL+acrOWHveaVsOeahOi/lOWbnuWAvOW+iOacieaEj+aAne+8jOS4umZhbHNl6KGo56S66ZyA6KaBcmVidWlsZCDkuLp0cnVl6KGo56S65bey6YeN5bu65a6M5oiQ5oiW5piv5LiN6ZyA6KaBcmVidWlsZA0KICAgICAgICAvLyR6YnAtPkNoZWNrVGVtcGxhdGUodHJ1ZSkgPT0gZmFsc2Ug55qE5oSP5oCd77yM5bCx5piv5Yik5pat5qih5p2/6ZyA6ZyA6KaB6YeN5Yi35paw5ZCX77yfDQoNCiAgICAgICAgLy/lpoLmnpzlr7nmr5TkuI3kuIDmoLcsJG9ubHljaGVja+WwseacieeUqOS6hg0KICAgICAgICBpZiAoJG1kNSAhPSAkdGhpcy0+Y2FjaGUtPnRlbXBsYXRlc19tZDUpIHsNCiAgICAgICAgICAgIGlmICgkb25seWNoZWNrID09IHRydWUgJiYgJGZvcmNlYnVpbGQgPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICB9DQogICAgICAgICAgICAkdGhpcy0+QnVpbGRUZW1wbGF0ZSgpOw0KICAgICAgICAgICAgJHRoaXMtPmNhY2hlLT50ZW1wbGF0ZXNfbWQ1ID0gJG1kNTsNCiAgICAgICAgICAgICR0aGlzLT5TYXZlQ2FjaGUoKTsNCg0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0NCiAgICAgICAgLy/lpoLmnpzlr7nmr5TkuIDmoLfnmoTor53vvIwkZm9yY2VidWlsZOWwseacieeUqOS6hg0KICAgICAgICBpZiAoJG1kNSA9PSAkdGhpcy0+Y2FjaGUtPnRlbXBsYXRlc19tZDUpIHsNCiAgICAgICAgICAgIGlmICgkZm9yY2VidWlsZCA9PSB0cnVlKSB7DQogICAgICAgICAgICAgICAgJHRoaXMtPkJ1aWxkVGVtcGxhdGUoKTsNCiAgICAgICAgICAgICAgICAkdGhpcy0+Y2FjaGUtPnRlbXBsYXRlc19tZDUgPSAkbWQ1Ow0KICAgICAgICAgICAgICAgICR0aGlzLT5TYXZlQ2FjaGUoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOeUn+aIkOaJgOaciei/m1JlYWR5IExpc3TnmoTmqKHlnZfnmoRDb250ZW505YaF5a655bm25L+d5a2YLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBCdWlsZE1vZHVsZSgpDQogICAgew0KICAgICAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9aYnBfQnVpbGRNb2R1bGUnXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgICAgICRmcG5hbWUoKTsNCiAgICAgICAgfQ0KICAgICAgICBNb2R1bGVCdWlsZGVyOjpCdWlsZCgpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmHjeW7uuaooeWdly4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG1vZHVsZUZpbGVOYW1lIOaooeWdl+WQjQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG1vZHVsZUZ1bmN0aW9uIOeUqOaIt+WHveaVsA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBSZWdCdWlsZE1vZHVsZSgkbW9kdWxlRmlsZU5hbWUsICRtb2R1bGVGdW5jdGlvbikNCiAgICB7DQogICAgICAgIE1vZHVsZUJ1aWxkZXI6OlJlZygkbW9kdWxlRmlsZU5hbWUsICRtb2R1bGVGdW5jdGlvbik7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog57O757uf6buY6K6k5rOo5YaM5qih5Z2XLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBSZWdCdWlsZE1vZHVsZXMoKQ0KICAgIHsNCiAgICAgICAgJHRoaXMtPlJlZ0J1aWxkTW9kdWxlKCdjYXRhbG9nJywgJ01vZHVsZUJ1aWxkZXI6OkNhdGFsb2cnKTsNCiAgICAgICAgJHRoaXMtPlJlZ0J1aWxkTW9kdWxlKCdjYWxlbmRhcicsICdNb2R1bGVCdWlsZGVyOjpDYWxlbmRhcicpOw0KICAgICAgICAkdGhpcy0+UmVnQnVpbGRNb2R1bGUoJ2NvbW1lbnRzJywgJ01vZHVsZUJ1aWxkZXI6OkNvbW1lbnRzJyk7DQogICAgICAgICR0aGlzLT5SZWdCdWlsZE1vZHVsZSgncHJldmlvdXMnLCAnTW9kdWxlQnVpbGRlcjo6TGF0ZXN0QXJ0aWNsZXMnKTsNCiAgICAgICAgJHRoaXMtPlJlZ0J1aWxkTW9kdWxlKCdhcmNoaXZlcycsICdNb2R1bGVCdWlsZGVyOjpBcmNoaXZlcycpOw0KICAgICAgICAkdGhpcy0+UmVnQnVpbGRNb2R1bGUoJ25hdmJhcicsICdNb2R1bGVCdWlsZGVyOjpOYXZiYXInKTsNCiAgICAgICAgJHRoaXMtPlJlZ0J1aWxkTW9kdWxlKCd0YWdzJywgJ01vZHVsZUJ1aWxkZXI6OlRhZ0xpc3QnKTsNCiAgICAgICAgJHRoaXMtPlJlZ0J1aWxkTW9kdWxlKCdzdGF0aXN0aWNzJywgJ01vZHVsZUJ1aWxkZXI6OlN0YXRpc3RpY3MnKTsNCiAgICAgICAgJHRoaXMtPlJlZ0J1aWxkTW9kdWxlKCdhdXRob3JzJywgJ01vZHVsZUJ1aWxkZXI6OkF1dGhvcnMnKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmt7vliqDov5vlhaVCdWlsZCBSZWFkeeWIl+ihqOeahOaooeWdly4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG1vZHVsZUZpbGVOYW1lIOaooeWdl+WQjQ0KICAgICAqIEBwYXJhbSBudWxsICAgJHBhcmFtZXRlcnMgICAgIOaooeWdl+WPguaVsA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBBZGRCdWlsZE1vZHVsZSgkbW9kdWxlRmlsZU5hbWUsICRwYXJhbWV0ZXJzID0gbnVsbCkNCiAgICB7DQogICAgICAgICRwID0gZnVuY19nZXRfYXJncygpOw0KICAgICAgICBjYWxsX3VzZXJfZnVuY19hcnJheSgnTW9kdWxlQnVpbGRlcjo6QWRkJywgJHApOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWIoOmZpOi/m+WFpUJ1aWxkIFJlYWR55YiX6KGo5qih5Z2XLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbW9kdWxlRmlsZU5hbWUg5qih5Z2X5ZCNDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIERlbEJ1aWxkTW9kdWxlKCRtb2R1bGVGaWxlTmFtZSkNCiAgICB7DQogICAgICAgIE1vZHVsZUJ1aWxkZXI6OkRlbCgkbW9kdWxlRmlsZU5hbWUpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOafpeivouaMh+WumuaVsOaNrue7k+aehOeahHNxbOW5tui/lOWbnkJhc2Xlr7nosaHliJfooaguDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nfGFycmF5ICR0YWJsZSAgICDmlbDmja7ooagNCiAgICAgKiBAcGFyYW0gYXJyYXkgICAgICAgICRkYXRhaW5mbyDmlbDmja7lrZfmrrUNCiAgICAgKiBAcGFyYW0gc3RyaW5nICAgICAgICRzcWwgICAgICBTUUzmk43kvZzor63lj6UNCiAgICAgKg0KICAgICAqIEByZXR1cm4gYXJyYXkNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0TGlzdEN1c3RvbSgkdGFibGUsICRkYXRhaW5mbywgJHNxbCkNCiAgICB7DQogICAgICAgICRhcnJheSA9IG51bGw7DQogICAgICAgICRsaXN0ID0gYXJyYXkoKTsNCiAgICAgICAgJGFycmF5ID0gJHRoaXMtPmRiLT5RdWVyeSgkc3FsKTsNCiAgICAgICAgaWYgKCFpc3NldCgkYXJyYXkpKSB7DQogICAgICAgICAgICByZXR1cm4gYXJyYXkoKTsNCiAgICAgICAgfQ0KICAgICAgICBmb3JlYWNoICgkYXJyYXkgYXMgJGEpIHsNCiAgICAgICAgICAgICRsID0gbmV3IEJhc2UoJHRhYmxlLCAkZGF0YWluZm8pOw0KICAgICAgICAgICAgJGwtPkxvYWRJbmZvQnlBc3NvYygkYSk7DQogICAgICAgICAgICAkaWQgPSAkbC0+R2V0SWROYW1lKCk7DQogICAgICAgICAgICBpZiAoJHRoaXMtPkNoZWNrQ2FjaGUoJ0Jhc2UnLCAkbC0+JGlkKSA9PSBmYWxzZSkgew0KICAgICAgICAgICAgICAgICR0aGlzLT5BZGRDYWNoZSgkbCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICAkbGlzdFtdID0gJGw7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJGxpc3Q7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5p+l6K+iSUTmlbDmja7nmoTmjIflrprmlbDmja7nu5PmnoTnmoRzcWzlubbov5Tlm55CYXNl5a+56LGh5YiX6KGoLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZ3xhcnJheSAkdGFibGUgICAg5pWw5o2u6KGoDQogICAgICogQHBhcmFtIGFycmF5ICAgICAgICAkZGF0YWluZm8g5pWw5o2u5a2X5q61DQogICAgICogQHBhcmFtIGFycmF5ICAgICAgICAkYXJyYXkgICAgSUTmlbDnu4QNCiAgICAgKg0KICAgICAqIEByZXR1cm4gQmFzZVtdDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldExpc3RDdXN0b21CeUFycmF5KCR0YWJsZSwgJGRhdGFpbmZvLCAkYXJyYXkpDQogICAgew0KICAgICAgICBpZiAoIWlzX2FycmF5KCRhcnJheSkpIHsNCiAgICAgICAgICAgIHJldHVybiBhcnJheSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKGNvdW50KCRhcnJheSkgPT0gMCkgew0KICAgICAgICAgICAgcmV0dXJuIGFycmF5KCk7DQogICAgICAgIH0NCg0KICAgICAgICAkd2hlcmUgPSBhcnJheSgpOw0KICAgICAgICAkd2hlcmVbXSA9IGFycmF5KCdJTicsICRkYXRhaW5mb1snSUQnXVswXSwgaW1wbG9kZSgnLCcsICRhcnJheSkpOw0KICAgICAgICAkc3FsID0gJHRoaXMtPmRiLT5zcWwtPlNlbGVjdCgkdGFibGUsICcqJywgJHdoZXJlKTsNCiAgICAgICAgJGFycmF5ID0gbnVsbDsNCiAgICAgICAgJGxpc3QgPSBhcnJheSgpOw0KICAgICAgICAkYXJyYXkgPSAkdGhpcy0+ZGItPlF1ZXJ5KCRzcWwpOw0KICAgICAgICBpZiAoIWlzc2V0KCRhcnJheSkpIHsNCiAgICAgICAgICAgIHJldHVybiBhcnJheSgpOw0KICAgICAgICB9DQogICAgICAgIGZvcmVhY2ggKCRhcnJheSBhcyAkYSkgew0KICAgICAgICAgICAgJGwgPSBuZXcgQmFzZSgkdGFibGUsICRkYXRhaW5mbyk7DQogICAgICAgICAgICAkbC0+TG9hZEluZm9CeUFzc29jKCRhKTsNCiAgICAgICAgICAgICRpZCA9ICRsLT5HZXRJZE5hbWUoKTsNCiAgICAgICAgICAgIGlmICgkdGhpcy0+Q2hlY2tDYWNoZSgnQmFzZScsICRsLT4kaWQpID09IGZhbHNlKSB7DQogICAgICAgICAgICAgICAgJHRoaXMtPkFkZENhY2hlKCRsKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgICRsaXN0W10gPSAkbDsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAkbGlzdDsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDlt7LmlLnlkI1HZXRMaXN0VHlwZSwxLjXniYjkuK3miZTmjonmnInmrafkuYnnmoRHZXRMaXN0Lg0KICAgICAqDQogICAgICogQHBhcmFtICR0eXBlDQogICAgICogQHBhcmFtICRzcWwNCiAgICAgKg0KICAgICAqIEByZXR1cm4gQmFzZVtdDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldExpc3RUeXBlKCR0eXBlLCAkc3FsKQ0KICAgIHsNCiAgICAgICAgaWYgKGlzX29iamVjdCgkc3FsKSAmJiBnZXRfcGFyZW50X2NsYXNzKCRzcWwpID09ICdTUUxfX0dsb2JhbCcpIHsNCiAgICAgICAgICAgICRzcWwgPSAkc3FsLT5zcWw7DQogICAgICAgIH0NCiAgICAgICAgJGFycmF5ID0gbnVsbDsNCiAgICAgICAgJGxpc3QgPSBhcnJheSgpOw0KICAgICAgICAkYXJyYXkgPSAkdGhpcy0+ZGItPlF1ZXJ5KCRzcWwpOw0KICAgICAgICBpZiAoIWlzc2V0KCRhcnJheSkpIHsNCiAgICAgICAgICAgIHJldHVybiBhcnJheSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgZm9yZWFjaCAoJGFycmF5IGFzICRhKSB7DQogICAgICAgICAgICAvKiogQHZhciBCYXNlICRsICovDQogICAgICAgICAgICAkbCA9IG5ldyAkdHlwZSgpOw0KICAgICAgICAgICAgJGwtPkxvYWRJbmZvQnlBc3NvYygkYSk7DQogICAgICAgICAgICAkaWQgPSAkbC0+R2V0SWROYW1lKCk7DQogICAgICAgICAgICBpZiAoJHRoaXMtPkNoZWNrQ2FjaGUoJHR5cGUsICRsLT4kaWQpID09IGZhbHNlKSB7DQogICAgICAgICAgICAgICAgJHRoaXMtPkFkZENhY2hlKCRsKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgJGxpc3RbXSA9ICRsOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICRsaXN0Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEdldExpc3RPcmlnaW4uDQogICAgICoNCiAgICAgKiBAcGFyYW0gJHNxbA0KICAgICAqDQogICAgICogQHJldHVybiBCYXNlW10NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0TGlzdE9yaWdpbigkc3FsKQ0KICAgIHsNCiAgICAgICAgaWYgKGlzX29iamVjdCgkc3FsKSAmJiBnZXRfcGFyZW50X2NsYXNzKCRzcWwpID09ICdTUUxfX0dsb2JhbCcpIHsNCiAgICAgICAgICAgICRzcWwgPSAkc3FsLT5zcWw7DQogICAgICAgIH0NCiAgICAgICAgJGFycmF5ID0gbnVsbDsNCiAgICAgICAgJGxpc3QgPSBhcnJheSgpOw0KICAgICAgICAkYXJyYXkgPSAkdGhpcy0+ZGItPlF1ZXJ5KCRzcWwpOw0KICAgICAgICBpZiAoIWlzc2V0KCRhcnJheSkpIHsNCiAgICAgICAgICAgIHJldHVybiBhcnJheSgpOw0KICAgICAgICB9DQogICAgICAgIGZvcmVhY2ggKCRhcnJheSBhcyAkYSkgew0KICAgICAgICAgICAgJGxpc3RbXSA9ICRhOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICRsaXN0Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOafpeivoklE5pWw5o2u55qE5oyH5a6a57G75Z6L55qEc3Fs5bm26L+U5Zue5oyH5a6a57G75Z6L5a+56LGh5YiX6KGoLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkdHlwZSAg57G75Z6LDQogICAgICogQHBhcmFtIG1peGVkICAkYXJyYXkgSUTmlbDnu4QNCiAgICAgKg0KICAgICAqIEByZXR1cm4gQmFzZVtdDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldExpc3RUeXBlQnlBcnJheSgkdHlwZSwgJGFycmF5KQ0KICAgIHsNCiAgICAgICAgaWYgKCFpc19hcnJheSgkYXJyYXkpKSB7DQogICAgICAgICAgICByZXR1cm4gYXJyYXkoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChjb3VudCgkYXJyYXkpID09IDApIHsNCiAgICAgICAgICAgIHJldHVybiBhcnJheSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgJHdoZXJlID0gYXJyYXkoKTsNCiAgICAgICAgJHdoZXJlW10gPSBhcnJheSgnSU4nLCAkdGhpcy0+ZGF0YWluZm9bJHR5cGVdWydJRCddWzBdLCBpbXBsb2RlKCcsJywgJGFycmF5KSk7DQogICAgICAgICRzcWwgPSAkdGhpcy0+ZGItPnNxbC0+U2VsZWN0KCR0aGlzLT50YWJsZVskdHlwZV0sICcqJywgJHdoZXJlKTsNCiAgICAgICAgJGFycmF5ID0gbnVsbDsNCiAgICAgICAgJGxpc3QgPSBhcnJheSgpOw0KICAgICAgICAkYXJyYXkgPSAkdGhpcy0+ZGItPlF1ZXJ5KCRzcWwpOw0KICAgICAgICBpZiAoIWlzc2V0KCRhcnJheSkpIHsNCiAgICAgICAgICAgIHJldHVybiBhcnJheSgpOw0KICAgICAgICB9DQogICAgICAgIGZvcmVhY2ggKCRhcnJheSBhcyAkYSkgew0KICAgICAgICAgICAgLyoqIEB2YXIgQmFzZSAkbCAqLw0KICAgICAgICAgICAgJGwgPSBuZXcgJHR5cGUoKTsNCiAgICAgICAgICAgICRsLT5Mb2FkSW5mb0J5QXNzb2MoJGEpOw0KICAgICAgICAgICAgJGlkID0gJGwtPkdldElkTmFtZSgpOw0KICAgICAgICAgICAgaWYgKCR0aGlzLT5DaGVja0NhY2hlKCR0eXBlLCAkbC0+JGlkKSA9PSBmYWxzZSkgew0KICAgICAgICAgICAgICAgICR0aGlzLT5BZGRDYWNoZSgkbCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICAkbGlzdFtdID0gJGw7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJGxpc3Q7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogQHBhcmFtIG1peGVkICRzZWxlY3QNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJHdoZXJlDQogICAgICogQHBhcmFtIG1peGVkICRvcmRlcg0KICAgICAqIEBwYXJhbSBtaXhlZCAkbGltaXQNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJG9wdGlvbg0KICAgICAqDQogICAgICogQHJldHVybiBQb3N0W10NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0UG9zdExpc3QoJHNlbGVjdCA9IG51bGwsICR3aGVyZSA9IG51bGwsICRvcmRlciA9IG51bGwsICRsaW1pdCA9IG51bGwsICRvcHRpb24gPSBudWxsKQ0KICAgIHsNCiAgICAgICAgaWYgKGlzX29iamVjdCgkc2VsZWN0KSAmJiBnZXRfcGFyZW50X2NsYXNzKCRzZWxlY3QpID09ICdTUUxfX0dsb2JhbCcpIHsNCiAgICAgICAgICAgICRzcWwgPSAkc2VsZWN0LT5zcWw7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkc3FsID0gJHRoaXMtPmRiLT5zcWwtPlNlbGVjdCgkdGhpcy0+dGFibGVbJ1Bvc3QnXSwgJHNlbGVjdCwgJHdoZXJlLCAkb3JkZXIsICRsaW1pdCwgJG9wdGlvbik7DQogICAgICAgIH0NCg0KICAgICAgICAvKiogQHZhciBQb3N0W10gJGFycmF5ICovDQogICAgICAgICRhcnJheSA9ICR0aGlzLT5HZXRMaXN0VHlwZSgnUG9zdCcsICRzcWwsICRvcHRpb24pOw0KICAgICAgICBpZiAoaXNzZXQoJG9wdGlvblsncGFnZWJhciddKSAmJiBpc19vYmplY3QoJG9wdGlvblsncGFnZWJhciddKSkgew0KICAgICAgICAgICAgJG9wdGlvblsncGFnZWJhciddLT5DdXJyZW50Q291bnQgPSBjb3VudCgkYXJyYXkpOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICRhcnJheTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJHNlbGVjdA0KICAgICAqIEBwYXJhbSBtaXhlZCAkd2hlcmUNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJG9yZGVyDQogICAgICogQHBhcmFtIG1peGVkICRsaW1pdA0KICAgICAqIEBwYXJhbSBtaXhlZCAkb3B0aW9uDQogICAgICogQHBhcmFtIG1peGVkICRyZWFkdGFncw0KICAgICAqDQogICAgICogQHJldHVybiBQb3N0W10NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0QXJ0aWNsZUxpc3QoJHNlbGVjdCA9IG51bGwsICR3aGVyZSA9IG51bGwsICRvcmRlciA9IG51bGwsICRsaW1pdCA9IG51bGwsICRvcHRpb24gPSBudWxsLCAkcmVhZHRhZ3MgPSB0cnVlKQ0KICAgIHsNCiAgICAgICAgaWYgKGVtcHR5KCR3aGVyZSkpIHsNCiAgICAgICAgICAgICR3aGVyZSA9IGFycmF5KCk7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoaXNfYXJyYXkoJHdoZXJlKSkgew0KICAgICAgICAgICAgYXJyYXlfdW5zaGlmdCgkd2hlcmUsIGFycmF5KCc9JywgJ2xvZ19UeXBlJywgJzAnKSk7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoaXNfb2JqZWN0KCRzZWxlY3QpICYmIGdldF9wYXJlbnRfY2xhc3MoJHNlbGVjdCkgPT0gJ1NRTF9fR2xvYmFsJykgew0KICAgICAgICAgICAgJHNxbCA9ICRzZWxlY3QtPnNxbDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICRzcWwgPSAkdGhpcy0+ZGItPnNxbC0+U2VsZWN0KCR0aGlzLT50YWJsZVsnUG9zdCddLCAkc2VsZWN0LCAkd2hlcmUsICRvcmRlciwgJGxpbWl0LCAkb3B0aW9uKTsNCiAgICAgICAgfQ0KDQoNCiAgICAgICAgLyoqIEB2YXIgUG9zdFtdICRhcnJheSAqLw0KICAgICAgICAkYXJyYXkgPSAkdGhpcy0+R2V0TGlzdFR5cGUoJ1Bvc3QnLCAkc3FsLCAkb3B0aW9uKTsNCiAgICAgICAgaWYgKGlzc2V0KCRvcHRpb25bJ3BhZ2ViYXInXSkgJiYgaXNfb2JqZWN0KCRvcHRpb25bJ3BhZ2ViYXInXSkpIHsNCiAgICAgICAgICAgICRvcHRpb25bJ3BhZ2ViYXInXS0+Q3VycmVudENvdW50ID0gY291bnQoJGFycmF5KTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmICgkcmVhZHRhZ3MpIHsNCiAgICAgICAgICAgICR0YWdzdHJpbmcgPSAnJzsNCiAgICAgICAgICAgIGZvcmVhY2ggKCRhcnJheSBhcyAkYSkgew0KICAgICAgICAgICAgICAgICR0YWdzdHJpbmcgLj0gJGEtPlRhZzsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgICR0aGlzLT5Mb2FkVGFnc0J5SURTdHJpbmcoJHRhZ3N0cmluZyk7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJGFycmF5Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBwYXJhbSBtaXhlZCAkc2VsZWN0DQogICAgICogQHBhcmFtIG1peGVkICR3aGVyZQ0KICAgICAqIEBwYXJhbSBtaXhlZCAkb3JkZXINCiAgICAgKiBAcGFyYW0gbWl4ZWQgJGxpbWl0DQogICAgICogQHBhcmFtIG1peGVkICRvcHRpb24NCiAgICAgKg0KICAgICAqIEByZXR1cm4gUG9zdFtdDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFBhZ2VMaXN0KCRzZWxlY3QgPSBudWxsLCAkd2hlcmUgPSBudWxsLCAkb3JkZXIgPSBudWxsLCAkbGltaXQgPSBudWxsLCAkb3B0aW9uID0gbnVsbCkNCiAgICB7DQogICAgICAgIGlmIChlbXB0eSgkd2hlcmUpKSB7DQogICAgICAgICAgICAkd2hlcmUgPSBhcnJheSgpOw0KICAgICAgICB9DQogICAgICAgIGlmIChpc19hcnJheSgkd2hlcmUpKSB7DQogICAgICAgICAgICBhcnJheV91bnNoaWZ0KCR3aGVyZSwgYXJyYXkoJz0nLCAnbG9nX1R5cGUnLCAnMScpKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChpc19vYmplY3QoJHNlbGVjdCkgJiYgZ2V0X3BhcmVudF9jbGFzcygkc2VsZWN0KSA9PSAnU1FMX19HbG9iYWwnKSB7DQogICAgICAgICAgICAkc3FsID0gJHNlbGVjdC0+c3FsOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJHNxbCA9ICR0aGlzLT5kYi0+c3FsLT5TZWxlY3QoJHRoaXMtPnRhYmxlWydQb3N0J10sICRzZWxlY3QsICR3aGVyZSwgJG9yZGVyLCAkbGltaXQsICRvcHRpb24pOw0KICAgICAgICB9DQoNCiAgICAgICAgLyoqIEB2YXIgUG9zdFtdICRhcnJheSAqLw0KICAgICAgICAkYXJyYXkgPSAkdGhpcy0+R2V0TGlzdFR5cGUoJ1Bvc3QnLCAkc3FsKTsNCiAgICAgICAgaWYgKGlzc2V0KCRvcHRpb25bJ3BhZ2ViYXInXSkgJiYgaXNfb2JqZWN0KCRvcHRpb25bJ3BhZ2ViYXInXSkpIHsNCiAgICAgICAgICAgICRvcHRpb25bJ3BhZ2ViYXInXS0+Q3VycmVudENvdW50ID0gY291bnQoJGFycmF5KTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAkYXJyYXk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogQHBhcmFtIG1peGVkICRzZWxlY3QNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJHdoZXJlDQogICAgICogQHBhcmFtIG1peGVkICRvcmRlcg0KICAgICAqIEBwYXJhbSBtaXhlZCAkbGltaXQNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJG9wdGlvbg0KICAgICAqDQogICAgICogQHJldHVybiBDb21tZW50W10NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0Q29tbWVudExpc3QoJHNlbGVjdCA9IG51bGwsICR3aGVyZSA9IG51bGwsICRvcmRlciA9IG51bGwsICRsaW1pdCA9IG51bGwsICRvcHRpb24gPSBudWxsKQ0KICAgIHsNCiAgICAgICAgaWYgKGlzX29iamVjdCgkc2VsZWN0KSAmJiBnZXRfcGFyZW50X2NsYXNzKCRzZWxlY3QpID09ICdTUUxfX0dsb2JhbCcpIHsNCiAgICAgICAgICAgICRzcWwgPSAkc2VsZWN0LT5zcWw7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkc3FsID0gJHRoaXMtPmRiLT5zcWwtPlNlbGVjdCgkdGhpcy0+dGFibGVbJ0NvbW1lbnQnXSwgJHNlbGVjdCwgJHdoZXJlLCAkb3JkZXIsICRsaW1pdCwgJG9wdGlvbik7DQogICAgICAgIH0NCg0KICAgICAgICAvKiogQHZhciBDb21tZW50W10gJGFycmF5ICovDQogICAgICAgICRhcnJheSA9ICR0aGlzLT5HZXRMaXN0VHlwZSgnQ29tbWVudCcsICRzcWwpOw0KICAgICAgICBpZiAoaXNzZXQoJG9wdGlvblsncGFnZWJhciddKSAmJiBpc19vYmplY3QoJG9wdGlvblsncGFnZWJhciddKSkgew0KICAgICAgICAgICAgJG9wdGlvblsncGFnZWJhciddLT5DdXJyZW50Q291bnQgPSBjb3VudCgkYXJyYXkpOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICRhcnJheTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJHNlbGVjdA0KICAgICAqIEBwYXJhbSBtaXhlZCAkd2hlcmUNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJG9yZGVyDQogICAgICogQHBhcmFtIG1peGVkICRsaW1pdA0KICAgICAqIEBwYXJhbSBtaXhlZCAkb3B0aW9uDQogICAgICoNCiAgICAgKiBAcmV0dXJuIE1lbWJlcltdfEJhc2VbXQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRNZW1iZXJMaXN0KCRzZWxlY3QgPSBudWxsLCAkd2hlcmUgPSBudWxsLCAkb3JkZXIgPSBudWxsLCAkbGltaXQgPSBudWxsLCAkb3B0aW9uID0gbnVsbCkNCiAgICB7DQogICAgICAgIGlmIChpc19vYmplY3QoJHNlbGVjdCkgJiYgZ2V0X3BhcmVudF9jbGFzcygkc2VsZWN0KSA9PSAnU1FMX19HbG9iYWwnKSB7DQogICAgICAgICAgICAkc3FsID0gJHNlbGVjdC0+c3FsOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJHNxbCA9ICR0aGlzLT5kYi0+c3FsLT5TZWxlY3QoJHRoaXMtPnRhYmxlWydNZW1iZXInXSwgJHNlbGVjdCwgJHdoZXJlLCAkb3JkZXIsICRsaW1pdCwgJG9wdGlvbik7DQogICAgICAgIH0NCg0KICAgICAgICAkYXJyYXkgPSAkdGhpcy0+R2V0TGlzdFR5cGUoJ01lbWJlcicsICRzcWwpOw0KICAgICAgICBpZiAoaXNzZXQoJG9wdGlvblsncGFnZWJhciddKSAmJiBpc19vYmplY3QoJG9wdGlvblsncGFnZWJhciddKSkgew0KICAgICAgICAgICAgJG9wdGlvblsncGFnZWJhciddLT5DdXJyZW50Q291bnQgPSBjb3VudCgkYXJyYXkpOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICRhcnJheTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJHNlbGVjdA0KICAgICAqIEBwYXJhbSBtaXhlZCAkd2hlcmUNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJG9yZGVyDQogICAgICogQHBhcmFtIG1peGVkICRsaW1pdA0KICAgICAqIEBwYXJhbSBtaXhlZCAkb3B0aW9uDQogICAgICoNCiAgICAgKiBAcmV0dXJuIFRhZ1tdfEJhc2VbXQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRUYWdMaXN0KCRzZWxlY3QgPSBudWxsLCAkd2hlcmUgPSBudWxsLCAkb3JkZXIgPSBudWxsLCAkbGltaXQgPSBudWxsLCAkb3B0aW9uID0gbnVsbCkNCiAgICB7DQogICAgICAgIGlmIChpc19vYmplY3QoJHNlbGVjdCkgJiYgZ2V0X3BhcmVudF9jbGFzcygkc2VsZWN0KSA9PSAnU1FMX19HbG9iYWwnKSB7DQogICAgICAgICAgICAkc3FsID0gJHNlbGVjdC0+c3FsOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJHNxbCA9ICR0aGlzLT5kYi0+c3FsLT5TZWxlY3QoJHRoaXMtPnRhYmxlWydUYWcnXSwgJHNlbGVjdCwgJHdoZXJlLCAkb3JkZXIsICRsaW1pdCwgJG9wdGlvbik7DQogICAgICAgIH0NCg0KICAgICAgICAkYXJyYXkgPSAkdGhpcy0+R2V0TGlzdFR5cGUoJ1RhZycsICRzcWwpOw0KICAgICAgICBpZiAoaXNzZXQoJG9wdGlvblsncGFnZWJhciddKSAmJiBpc19vYmplY3QoJG9wdGlvblsncGFnZWJhciddKSkgew0KICAgICAgICAgICAgJG9wdGlvblsncGFnZWJhciddLT5DdXJyZW50Q291bnQgPSBjb3VudCgkYXJyYXkpOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICRhcnJheTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJHNlbGVjdA0KICAgICAqIEBwYXJhbSBtaXhlZCAkd2hlcmUNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJG9yZGVyDQogICAgICogQHBhcmFtIG1peGVkICRsaW1pdA0KICAgICAqIEBwYXJhbSBtaXhlZCAkb3B0aW9uDQogICAgICoNCiAgICAgKiBAcmV0dXJuIENhdGVnb3J5W118QmFzZVtdDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldENhdGVnb3J5TGlzdCgkc2VsZWN0ID0gbnVsbCwgJHdoZXJlID0gbnVsbCwgJG9yZGVyID0gbnVsbCwgJGxpbWl0ID0gbnVsbCwgJG9wdGlvbiA9IG51bGwpDQogICAgew0KICAgICAgICBpZiAoaXNfb2JqZWN0KCRzZWxlY3QpICYmIGdldF9wYXJlbnRfY2xhc3MoJHNlbGVjdCkgPT0gJ1NRTF9fR2xvYmFsJykgew0KICAgICAgICAgICAgJHNxbCA9ICRzZWxlY3QtPnNxbDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICRzcWwgPSAkdGhpcy0+ZGItPnNxbC0+U2VsZWN0KCR0aGlzLT50YWJsZVsnQ2F0ZWdvcnknXSwgJHNlbGVjdCwgJHdoZXJlLCAkb3JkZXIsICRsaW1pdCwgJG9wdGlvbik7DQogICAgICAgIH0NCg0KICAgICAgICAkYXJyYXkgPSAkdGhpcy0+R2V0TGlzdFR5cGUoJ0NhdGVnb3J5JywgJHNxbCk7DQogICAgICAgIGlmIChpc3NldCgkb3B0aW9uWydwYWdlYmFyJ10pICYmIGlzX29iamVjdCgkb3B0aW9uWydwYWdlYmFyJ10pKSB7DQogICAgICAgICAgICAkb3B0aW9uWydwYWdlYmFyJ10tPkN1cnJlbnRDb3VudCA9IGNvdW50KCRhcnJheSk7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJGFycmF5Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBwYXJhbSBtaXhlZCAkc2VsZWN0DQogICAgICogQHBhcmFtIG1peGVkICR3aGVyZQ0KICAgICAqIEBwYXJhbSBtaXhlZCAkb3JkZXINCiAgICAgKiBAcGFyYW0gbWl4ZWQgJGxpbWl0DQogICAgICogQHBhcmFtIG1peGVkICRvcHRpb24NCiAgICAgKg0KICAgICAqIEByZXR1cm4gTW9kdWxlW118QmFzZVtdDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldE1vZHVsZUxpc3QoJHNlbGVjdCA9IG51bGwsICR3aGVyZSA9IG51bGwsICRvcmRlciA9IG51bGwsICRsaW1pdCA9IG51bGwsICRvcHRpb24gPSBudWxsKQ0KICAgIHsNCiAgICAgICAgaWYgKGlzX29iamVjdCgkc2VsZWN0KSAmJiBnZXRfcGFyZW50X2NsYXNzKCRzZWxlY3QpID09ICdTUUxfX0dsb2JhbCcpIHsNCiAgICAgICAgICAgICRzcWwgPSAkc2VsZWN0LT5zcWw7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkc3FsID0gJHRoaXMtPmRiLT5zcWwtPlNlbGVjdCgkdGhpcy0+dGFibGVbJ01vZHVsZSddLCAkc2VsZWN0LCAkd2hlcmUsICRvcmRlciwgJGxpbWl0LCAkb3B0aW9uKTsNCiAgICAgICAgfQ0KDQogICAgICAgICRhcnJheSA9ICR0aGlzLT5HZXRMaXN0VHlwZSgnTW9kdWxlJywgJHNxbCk7DQogICAgICAgIGlmIChpc3NldCgkb3B0aW9uWydwYWdlYmFyJ10pICYmIGlzX29iamVjdCgkb3B0aW9uWydwYWdlYmFyJ10pKSB7DQogICAgICAgICAgICAkb3B0aW9uWydwYWdlYmFyJ10tPkN1cnJlbnRDb3VudCA9IGNvdW50KCRhcnJheSk7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJGFycmF5Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBwYXJhbSBtaXhlZCAkc2VsZWN0DQogICAgICogQHBhcmFtIG1peGVkICR3aGVyZQ0KICAgICAqIEBwYXJhbSBtaXhlZCAkb3JkZXINCiAgICAgKiBAcGFyYW0gbWl4ZWQgJGxpbWl0DQogICAgICogQHBhcmFtIG1peGVkICRvcHRpb24NCiAgICAgKg0KICAgICAqIEByZXR1cm4gVXBsb2FkW118QmFzZVtdDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFVwbG9hZExpc3QoJHNlbGVjdCA9IG51bGwsICR3aGVyZSA9IG51bGwsICRvcmRlciA9IG51bGwsICRsaW1pdCA9IG51bGwsICRvcHRpb24gPSBudWxsKQ0KICAgIHsNCiAgICAgICAgaWYgKGlzX29iamVjdCgkc2VsZWN0KSAmJiBnZXRfcGFyZW50X2NsYXNzKCRzZWxlY3QpID09ICdTUUxfX0dsb2JhbCcpIHsNCiAgICAgICAgICAgICRzcWwgPSAkc2VsZWN0LT5zcWw7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkc3FsID0gJHRoaXMtPmRiLT5zcWwtPlNlbGVjdCgkdGhpcy0+dGFibGVbJ1VwbG9hZCddLCAkc2VsZWN0LCAkd2hlcmUsICRvcmRlciwgJGxpbWl0LCAkb3B0aW9uKTsNCiAgICAgICAgfQ0KDQogICAgICAgICRhcnJheSA9ICR0aGlzLT5HZXRMaXN0VHlwZSgnVXBsb2FkJywgJHNxbCk7DQogICAgICAgIGlmIChpc3NldCgkb3B0aW9uWydwYWdlYmFyJ10pICYmIGlzX29iamVjdCgkb3B0aW9uWydwYWdlYmFyJ10pKSB7DQogICAgICAgICAgICAkb3B0aW9uWydwYWdlYmFyJ10tPkN1cnJlbnRDb3VudCA9IGNvdW50KCRhcnJheSk7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJGFycmF5Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h0lE5pWw57uE6I635Y+W5paH56ug5a6e5L6LLg0KICAgICAqDQogICAgICogQHBhcmFtIG1peGVkW10gJGFycmF5DQogICAgICoNCiAgICAgKiBAcmV0dXJuIFBvc3RbXXxCYXNlW10gUG9zdHMNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0UG9zdEJ5QXJyYXkoJGFycmF5KQ0KICAgIHsNCiAgICAgICAgJHBvc3RzID0gJHRoaXMtPkdldExpc3RUeXBlQnlBcnJheSgnUG9zdCcsICRhcnJheSk7DQoNCiAgICAgICAgcmV0dXJuICRwb3N0czsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4dJROaVsOe7hOiOt+WPluivhOiuuuWunuS+iy4NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0Q29tbWVudEJ5QXJyYXkoJGFycmF5KQ0KICAgIHsNCiAgICAgICAgJHBvc3RzID0gJHRoaXMtPkdldExpc3RUeXBlQnlBcnJheSgnQ29tbWVudCcsICRhcnJheSk7DQoNCiAgICAgICAgcmV0dXJuICRwb3N0czsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4dJROaVsOe7hOiOt+WPlk1lbWJlcuWunuS+iy4NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0TWVtYmVyQnlBcnJheSgkYXJyYXkpDQogICAgew0KICAgICAgICAkcG9zdHMgPSAkdGhpcy0+R2V0TGlzdFR5cGVCeUFycmF5KCdNZW1iZXInLCAkYXJyYXkpOw0KDQogICAgICAgIHJldHVybiAkcG9zdHM7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YCa6L+HSUTmlbDnu4Tojrflj5ZDYXRlZ29yeeWunuS+iy4NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0Q2F0ZWdvcnlCeUFycmF5KCRhcnJheSkNCiAgICB7DQogICAgICAgICRwb3N0cyA9ICR0aGlzLT5HZXRMaXN0VHlwZUJ5QXJyYXkoJ0NhdGVnb3J5JywgJGFycmF5KTsNCg0KICAgICAgICByZXR1cm4gJHBvc3RzOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h0lE5pWw57uE6I635Y+WVGFn5a6e5L6LLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRUYWdCeUFycmF5KCRhcnJheSkNCiAgICB7DQogICAgICAgICRwb3N0cyA9ICR0aGlzLT5HZXRMaXN0VHlwZUJ5QXJyYXkoJ1RhZycsICRhcnJheSk7DQoNCiAgICAgICAgcmV0dXJuICRwb3N0czsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4dJROaVsOe7hOiOt+WPlk1vZHVsZeWunuS+iy4NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0TW9kdWxlQnlBcnJheSgkYXJyYXkpDQogICAgew0KICAgICAgICAkcG9zdHMgPSAkdGhpcy0+R2V0TGlzdFR5cGVCeUFycmF5KCdNb2R1bGUnLCAkYXJyYXkpOw0KDQogICAgICAgIHJldHVybiAkcG9zdHM7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YCa6L+HSUTmlbDnu4Tojrflj5ZVcGxvYWTlrp7kvosuDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFVwbG9hZEJ5QXJyYXkoJGFycmF5KQ0KICAgIHsNCiAgICAgICAgJHBvc3RzID0gJHRoaXMtPkdldExpc3RUeXBlQnlBcnJheSgnVXBsb2FkJywgJGFycmF5KTsNCg0KICAgICAgICByZXR1cm4gJHBvc3RzOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBwYXJhbSAkc3FsDQogICAgICoNCiAgICAgKiBAcmV0dXJuIG1peGVkDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIGdldF9yZXN1bHRzKCRzcWwpDQogICAgew0KICAgICAgICByZXR1cm4gJHRoaXMtPmRiLT5RdWVyeSgkc3FsKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmoLnmja7liKvlkI3lvpfliLDnm7jlupTmlbDmja4uDQogICAgICoNCiAgICAgKiBAcGFyYW0gQmFzZVtdfHN0cmluZyAmJG9iamVjdCAgIOe8k+WtmOWvueixoQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgICAgICAgICR2YWwNCiAgICAgKiBAcGFyYW0gc3RyaW5nICAgICAgICAkYmFja0F0dHINCiAgICAgKiBAcGFyYW0gc3RyaW5nICAgICAgICAkY2xhc3NOYW1lDQogICAgICoNCiAgICAgKiBAcmV0dXJuIEJhc2V8bnVsbA0KICAgICAqLw0KICAgIHByaXZhdGUgZnVuY3Rpb24gR2V0U29tZVRoaW5nQnlBbGlhcygkb2JqZWN0LCAkdmFsLCAkYmFja0F0dHIgPSBudWxsLCAkY2xhc3NOYW1lID0gbnVsbCkNCiAgICB7DQogICAgICAgICRyZXQgPSAkdGhpcy0+R2V0U29tZVRoaW5nKCRvYmplY3QsICdBbGlhcycsICR2YWwsICRjbGFzc05hbWUpOw0KDQogICAgICAgIGlmICghaXNfbnVsbCgkcmV0KSkgew0KICAgICAgICAgICAgcmV0dXJuICRyZXQ7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBpZiAoaXNfbnVsbCgkYmFja0F0dHIpKSB7DQogICAgICAgICAgICAgICAgJGJhY2tBdHRyID0gJHRoaXMtPm9wdGlvblsnWkNfQUxJQVNfQkFDS19BVFRSJ107DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+R2V0U29tZVRoaW5nKCRvYmplY3QsICRiYWNrQXR0ciwgJHZhbCwgJGNsYXNzTmFtZSk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmoLnmja5JROW+l+WIsOebuOW6lOaVsOaNri4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBCYXNlW10gICAgICYkb2JqZWN0ICAg57yT5a2Y5a+56LGhDQogICAgICogQHBhcmFtIHN0cmluZyAgICAgJGNsYXNzTmFtZSDmib7kuI3liLBJROaXtuWIneWni+WMluWvueixoeeahOexu+WQjQ0KICAgICAqIEBwYXJhbSBpbnR8c3RyaW5nICRpZCAgICAgICAg5LiO5q2k57G755u45YWz55qESUQNCiAgICAgKg0KICAgICAqIEByZXR1cm4gQmFzZXxudWxsDQogICAgICovDQogICAgcHJpdmF0ZSBmdW5jdGlvbiBHZXRTb21lVGhpbmdCeUlkKCYkb2JqZWN0LCAkY2xhc3NOYW1lLCAkaWQpDQogICAgew0KICAgICAgICBpZiAoZW1wdHkoJGlkKSkgew0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8kbW9kdWxlc+mdnklE5Li6a2V5DQogICAgICAgIC8vaWYgKCRjbGFzc05hbWUgPT0gIk1vZHVsZSIpIHsNCiAgICAgICAgLy8gICAgZm9yZWFjaCAoJG9iamVjdCBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAvLyAgICAgICAgaWYgKCR2YWx1ZS0+SUQgPT0gJGlkKSB7DQogICAgICAgIC8vICAgICAgICAgICAgcmV0dXJuICR2YWx1ZTsNCiAgICAgICAgLy8gICAgICAgIH0NCiAgICAgICAgLy8gICAgfQ0KICAgICAgICAvLyAgICAkbSA9IG5ldyBNb2R1bGUoKTsNCg0KICAgICAgICAvLyAgICByZXR1cm4gJG07DQogICAgICAgIC8vfQ0KDQogICAgICAgIGlmIChhcnJheV9rZXlfZXhpc3RzKCRpZCwgJG9iamVjdCkpIHsNCiAgICAgICAgICAgIHJldHVybiAkb2JqZWN0WyRpZF07DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkcCA9IG5ldyAkY2xhc3NOYW1lKCk7DQogICAgICAgICAgICBpZiAoJHAtPkxvYWRJbmZvQnlJRCgkaWQpKSB7DQogICAgICAgICAgICAgICAgJHRoaXMtPkFkZENhY2hlKCRwKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuICRwOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5qC55o2u5bGe5oCn5YC85b6X5Yiw55u45bqU5pWw5o2uLg0KICAgICAqDQogICAgICogQHBhcmFtIEJhc2VbXSAmJG9iamVjdCDnvJPlrZjlr7nosaENCiAgICAgKiBAcGFyYW0gc3RyaW5nICAgICAgICAkY2xhc3NOYW1lIOWvueixoeacquaJvuWIsOaXtu+8jOWIneWni+WMluexu+WQjQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgJGF0dHIgICAg5bGe5oCn5ZCNDQogICAgICogQHBhcmFtIG1peGVkICAkdmFsICAgICDopoHmn6Xmib7nmoTlgLwNCiAgICAgKg0KICAgICAqIEByZXR1cm4gbnVsbA0KICAgICAqLw0KICAgIHByaXZhdGUgZnVuY3Rpb24gR2V0U29tZVRoaW5nQnlBdHRyKCYkb2JqZWN0LCAkY2xhc3NOYW1lLCAkYXR0ciwgJHZhbCkNCiAgICB7DQogICAgICAgICRjYWNoZU9iamVjdCA9IG51bGw7DQogICAgICAgIGlmIChpc19hcnJheSgkb2JqZWN0KSkgew0KICAgICAgICAgICAgJGNhY2hlT2JqZWN0ID0gJiRvYmplY3Q7DQogICAgICAgIH0gZWxzZWlmICgkY2xhc3NOYW1lICE9ICcnKSB7DQogICAgICAgICAgICBpZiAoIWlzc2V0KCR0aGlzLT5jYWNoZW9iamVjdFskY2xhc3NOYW1lXSkpIHsNCiAgICAgICAgICAgICAgICAkdGhpcy0+Y2FjaGVvYmplY3RbJGNsYXNzTmFtZV0gPSBhcnJheSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgJGNhY2hlT2JqZWN0ID0gJiR0aGlzLT5jYWNoZW9iamVjdFskY2xhc3NOYW1lXTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8v5aaC5p6c5piv5aSa6YeN5bGe5oCn5ZKM5YC85p+l6K+iDQogICAgICAgIGlmIChpc19hcnJheSgkYXR0cikgJiYgaXNfYXJyYXkoJHZhbCkpIHsNCiAgICAgICAgICAgICR2YWwxID0gdHJpbSgkdmFsWzBdKTsNCiAgICAgICAgICAgICR2YWwyID0gdHJpbSgkdmFsWzFdKTsNCiAgICAgICAgICAgICR2YWwzID0gaXNzZXQoJHZhbFsyXSkgPyAkdmFsWzJdIDogbnVsbDsNCiAgICAgICAgICAgICRhdHRyMSA9ICRhdHRyWzBdOw0KICAgICAgICAgICAgJGF0dHIyID0gJGF0dHJbMV07DQogICAgICAgICAgICAkYXR0cjMgPSBpc3NldCgkYXR0clsyXSkgPyAkYXR0clsyXSA6IG51bGw7DQogICAgICAgICAgICBmb3JlYWNoICgkY2FjaGVPYmplY3QgYXMgJGtleSA9PiAmJHZhbHVlKSB7DQogICAgICAgICAgICAgICAgaWYgKGlzX251bGwoJHZhbHVlKSkgew0KICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKCRhdHRyMyAhPT0gbnVsbCAmJiAkdmFsdWUtPiRhdHRyMSA9PSAkdmFsMSAmJiAkdmFsdWUtPiRhdHRyMiA9PSAkdmFsMiAmJiAkdmFsdWUtPiRhdHRyMyA9PSAkdmFsMykgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHZhbHVlOw0KICAgICAgICAgICAgICAgIH0gZWxzZWlmICgkdmFsdWUtPiRhdHRyMSA9PSAkdmFsMSAmJiAkdmFsdWUtPiRhdHRyMiA9PSAkdmFsMikgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHZhbHVlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICR2YWwgPSB0cmltKCR2YWwpOw0KICAgICAgICAgICAgZm9yZWFjaCAoJGNhY2hlT2JqZWN0IGFzICRrZXkgPT4gJiR2YWx1ZSkgew0KICAgICAgICAgICAgICAgIGlmIChpc19udWxsKCR2YWx1ZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmICgkdmFsdWUtPiRhdHRyID09ICR2YWwpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICR2YWx1ZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDojrflj5bmlbDmja7pgJrnlKjlh73mlbAuDQogICAgICoNCiAgICAgKiBAcGFyYW0gQmFzZVtdfHN0cmluZyAkb2JqZWN0ICAgIOe8k+WtmOWvueixoe+8iHN0cmluZyAvIG9iamVjdO+8iQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgICAgICAgICRhdHRyICAgICAg5qyy5p+l5om+55qE5bGe5oCnDQogICAgICogQHBhcmFtIG1peGVkICAgICAgICAgJHZhbCAgICAgICDopoHmn6Xmib7lhoXlrrkNCiAgICAgKiBAcGFyYW0gc3RyaW5nICAgICAgICAkY2xhc3NOYW1lIOWvueixoeacquaJvuWIsOaXtu+8jOWIneWni+WMluexu+WQjQ0KICAgICAqDQogICAgICogQHJldHVybiBCYXNlfG51bGwNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0U29tZVRoaW5nKCRvYmplY3QsICRhdHRyLCAkdmFsLCAkY2xhc3NOYW1lKQ0KICAgIHsNCiAgICAgICAgJGNhY2hlT2JqZWN0ID0gbnVsbDsNCiAgICAgICAgaWYgKGlzX2FycmF5KCRvYmplY3QpKSB7DQogICAgICAgICAgICAkY2FjaGVPYmplY3QgPSAkb2JqZWN0Ow0KICAgICAgICB9IGVsc2VpZiAoJGNsYXNzTmFtZSAhPSAnJykgew0KICAgICAgICAgICAgaWYgKCFpc3NldCgkdGhpcy0+Y2FjaGVvYmplY3RbJGNsYXNzTmFtZV0pKSB7DQogICAgICAgICAgICAgICAgJHRoaXMtPmNhY2hlb2JqZWN0WyRjbGFzc05hbWVdID0gYXJyYXkoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgICRjYWNoZU9iamVjdCA9ICYkdGhpcy0+Y2FjaGVvYmplY3RbJGNsYXNzTmFtZV07DQogICAgICAgIH0NCiAgICAgICAgaWYgKCRhdHRyID09ICJJRCIpIHsNCiAgICAgICAgICAgICRyZXQgPSAkdGhpcy0+R2V0U29tZVRoaW5nQnlJZCgkY2FjaGVPYmplY3QsICRjbGFzc05hbWUsICR2YWwpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJHJldCA9ICR0aGlzLT5HZXRTb21lVGhpbmdCeUF0dHIoJGNhY2hlT2JqZWN0LCAkY2xhc3NOYW1lLCAkYXR0ciwgJHZhbCk7DQogICAgICAgIH0NCiAgICAgICAgaWYgKCRyZXQgPT09IG51bGwgJiYgIWlzX251bGwoJGNsYXNzTmFtZSkpIHsNCiAgICAgICAgICAgIC8qKiBAdmFyIEJhc2UgJHJldCAqLw0KICAgICAgICAgICAgJHJldCA9IG5ldyAkY2xhc3NOYW1lKCk7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJHJldDsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4dJROiOt+WPluaWh+eroOWunuS+iy4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBpbnQgJGlkDQogICAgICoNCiAgICAgKiBAcmV0dXJuIFBvc3R8QmFzZQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRQb3N0QnlJRCgkaWQpDQogICAgew0KICAgICAgICByZXR1cm4gJHRoaXMtPkdldFNvbWVUaGluZygncG9zdHMnLCAnSUQnLCAkaWQsICdQb3N0Jyk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YCa6L+HSUTojrflj5bliIbnsbvlrp7kvosuDQogICAgICoNCiAgICAgKiBAcGFyYW0gaW50ICRpZA0KICAgICAqDQogICAgICogQHJldHVybiBDYXRlZ29yeXxCYXNlDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldENhdGVnb3J5QnlJRCgkaWQpDQogICAgew0KICAgICAgICByZXR1cm4gJHRoaXMtPkdldFNvbWVUaGluZygnY2F0ZWdvcmllc19hbGwnLCAnSUQnLCAkaWQsICdDYXRlZ29yeScpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h+WIhuexu+WQjeiOt+WPluWIhuexu+WunuS+iy4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUNCiAgICAgKg0KICAgICAqIEByZXR1cm4gQ2F0ZWdvcnl8QmFzZQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRDYXRlZ29yeUJ5TmFtZSgkbmFtZSwgJHR5cGUgPSAwKQ0KICAgIHsNCiAgICAgICAgaWYgKCR0eXBlID09PSBudWxsKSB7DQogICAgICAgICAgICAkY2F0ZWdvcnlzID0gJiR0aGlzLT5jYXRlZ29yaWVzX2FsbDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICRjYXRlZ29yeXMgPSAmJHRoaXMtPmNhdGVnb3JpZXNieW9yZGVyX3R5cGVbJHR5cGVdOw0KICAgICAgICB9DQogICAgICAgIGZvcmVhY2ggKCRjYXRlZ29yeXMgYXMgJGtleSA9PiAkYykgew0KICAgICAgICAgICAgaWYgKCRuYW1lID09ICRjLT5OYW1lKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICRjOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHJldHVybiBuZXcgQ2F0ZWdvcnk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YCa6L+H5YiG57G75Yir5ZCN6I635Y+W5YiG57G75a6e5L6LLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbmFtZQ0KICAgICAqIEBwYXJhbSBudWxsICAgJGJhY2tLZXkNCiAgICAgKg0KICAgICAqIEByZXR1cm4gQ2F0ZWdvcnl8QmFzZQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRDYXRlZ29yeUJ5QWxpYXMoJG5hbWUsICR0eXBlID0gMCkNCiAgICB7DQogICAgICAgIGlmICgkdHlwZSA9PT0gbnVsbCkgew0KICAgICAgICAgICAgJGNhdGVnb3J5cyA9ICYkdGhpcy0+Y2F0ZWdvcmllc19hbGw7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkY2F0ZWdvcnlzID0gJiR0aGlzLT5jYXRlZ29yaWVzYnlvcmRlcl90eXBlWyR0eXBlXTsNCiAgICAgICAgfQ0KICAgICAgICBmb3JlYWNoICgkY2F0ZWdvcnlzIGFzICRrZXkgPT4gJGMpIHsNCiAgICAgICAgICAgIGlmICgkbmFtZSA9PSAkYy0+QWxpYXMpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gJGM7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIG5ldyBDYXRlZ29yeTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDkuI7ogIHniYjmnKzkv53mjIHlhbzlrrnlh73mlbAuDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRuYW1lDQogICAgICoNCiAgICAgKiBAcmV0dXJuIENhdGVnb3J5DQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldENhdGVnb3J5QnlBbGlhc09yTmFtZSgkbmFtZSwgJHR5cGUgPSAwKQ0KICAgIHsNCiAgICAgICAgaWYgKCR0eXBlID09PSBudWxsKSB7DQogICAgICAgICAgICAkY2F0ZWdvcnlzID0gJiR0aGlzLT5jYXRlZ29yaWVzX2FsbDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICRjYXRlZ29yeXMgPSAmJHRoaXMtPmNhdGVnb3JpZXNieW9yZGVyX3R5cGVbJHR5cGVdOw0KICAgICAgICB9DQogICAgICAgIGZvcmVhY2ggKCRjYXRlZ29yeXMgYXMgJGtleSA9PiAkYykgew0KICAgICAgICAgICAgaWYgKCRuYW1lID09ICRjLT5BbGlhcyB8fCAkbmFtZSA9PSAkYy0+TmFtZSkgew0KICAgICAgICAgICAgICAgIHJldHVybiAkYzsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gbmV3IENhdGVnb3J5Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h0lE6I635Y+W5qih5Z2X5a6e5L6LLg0KICAgICAqDQogICAgICogQHBhcmFtIGludCAkaWQNCiAgICAgKg0KICAgICAqIEByZXR1cm4gTW9kdWxlfEJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0TW9kdWxlQnlJRCgkaWQpDQogICAgew0KICAgICAgICByZXR1cm4gJHRoaXMtPkdldFNvbWVUaGluZygnbW9kdWxlcycsICdJRCcsICRpZCwgJ01vZHVsZScpOyAvLyBXaGF0IHRoZSBmdWNrPw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h0ZpbGVOYW1l6I635Y+W5qih5Z2X5a6e5L6LLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkZm4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gTW9kdWxlfEJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0TW9kdWxlQnlGaWxlTmFtZSgkZm4pDQogICAgew0KICAgICAgICByZXR1cm4gJHRoaXMtPkdldFNvbWVUaGluZygnbW9kdWxlc2J5ZmlsZW5hbWUnLCAnRmlsZU5hbWUnLCAkZm4sICdNb2R1bGUnKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4dJROiOt+WPlueUqOaIt+WunuS+iy4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBpbnQgJGlkDQogICAgICoNCiAgICAgKiBAcmV0dXJuIE1lbWJlcnxCYXNlDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldE1lbWJlckJ5SUQoJGlkKQ0KICAgIHsNCiAgICAgICAgLyoqIEB2YXIgTWVtYmVyICRyZXQgKi8NCiAgICAgICAgJHJldCA9ICR0aGlzLT5HZXRTb21lVGhpbmcoJ21lbWJlcnMnLCAnSUQnLCAkaWQsICdNZW1iZXInKTsNCiAgICAgICAgaWYgKCRyZXQtPklEID09IG51bGwpIHsNCiAgICAgICAgICAgICRyZXQtPkd1aWQgPSBHZXRHdWlkKCk7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJHJldDsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4fnlKjmiLflkI3ojrflj5bnlKjmiLflrp7kvoso5LiN5Yy65YiG5aSn5bCP5YaZKS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUNCiAgICAgKg0KICAgICAqIEByZXR1cm4gTWVtYmVyfEJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0TWVtYmVyQnlOYW1lKCRuYW1lKQ0KICAgIHsNCiAgICAgICAgJG5hbWUgPSB0cmltKCRuYW1lKTsNCiAgICAgICAgaWYgKCEkbmFtZSB8fCAhQ2hlY2tSZWdFeHAoJG5hbWUsICdbdXNlcm5hbWVdJykpIHsNCiAgICAgICAgICAgIHJldHVybiBuZXcgTWVtYmVyKCk7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoaXNzZXQoJHRoaXMtPm1lbWJlcnNieW5hbWVbJG5hbWVdKSkgew0KICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5tZW1iZXJzYnluYW1lWyRuYW1lXTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICRhcnJheSA9IGFycmF5X2tleXMoJHRoaXMtPm1lbWJlcnNieW5hbWUpOw0KICAgICAgICAgICAgZm9yZWFjaCAoJGFycmF5IGFzICRrID0+ICR2KSB7DQogICAgICAgICAgICAgICAgaWYgKHN0cmNhc2VjbXAoJG5hbWUsICR2KSA9PSAwKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiAkdGhpcy0+bWVtYmVyc2J5bmFtZVskdl07DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgJGxpa2UgPSAoJHRoaXMtPmRiLT50eXBlID09ICdwZ3NxbCcpID8gJ0lMSUtFJyA6ICdMSUtFJzsNCiAgICAgICAgJHNxbCA9ICR0aGlzLT5kYi0+c3FsLT5TZWxlY3QoJHRoaXMtPnRhYmxlWydNZW1iZXInXSwgJyonLCBhcnJheShhcnJheSgkbGlrZSwgJ21lbV9OYW1lJywgJG5hbWUpKSwgYXJyYXkoJ21lbV9JRCcgPT4gJ0FTQycpLCAxLCBudWxsKTsNCg0KICAgICAgICAvKiogQHZhciBNZW1iZXJbXSAkYW0gKi8NCiAgICAgICAgJGFtID0gJHRoaXMtPkdldExpc3RUeXBlKCdNZW1iZXInLCAkc3FsKTsNCiAgICAgICAgaWYgKGNvdW50KCRhbSkgPiAwKSB7DQogICAgICAgICAgICAkbSA9ICRhbVswXTsNCg0KICAgICAgICAgICAgcmV0dXJuICRtOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIG5ldyBNZW1iZXIoKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4fojrflj5bnlKjmiLflkI3miJbliKvlkI3lrp7kvoso5LiN5Yy65YiG5aSn5bCP5YaZKS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUNCiAgICAgKg0KICAgICAqIEByZXR1cm4gTWVtYmVyfEJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0TWVtYmVyQnlOYW1lT3JBbGlhcygkbmFtZSkNCiAgICB7DQogICAgICAgICRuYW1lID0gdHJpbSgkbmFtZSk7DQogICAgICAgIGlmICghJG5hbWUgfHwgIShDaGVja1JlZ0V4cCgkbmFtZSwgJ1t1c2VybmFtZV0nKSB8fCBDaGVja1JlZ0V4cCgkbmFtZSwgJ1tuaWNrbmFtZV0nKSkpIHsNCiAgICAgICAgICAgIHJldHVybiBuZXcgTWVtYmVyKCk7DQogICAgICAgIH0NCg0KICAgICAgICBmb3JlYWNoICgkdGhpcy0+bWVtYmVycyBhcyAka2V5ID0+ICYkdmFsdWUpIHsNCiAgICAgICAgICAgIGlmIChzdHJjYXNlY21wKCR2YWx1ZS0+TmFtZSwgJG5hbWUpID09IDAgfHwgc3RyY2FzZWNtcCgkdmFsdWUtPkFsaWFzLCAkbmFtZSkgPT0gMCkgew0KICAgICAgICAgICAgICAgIHJldHVybiAkdmFsdWU7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAkbGlrZSA9ICgkdGhpcy0+ZGItPnR5cGUgPT0gJ3Bnc3FsJykgPyAnSUxJS0UnIDogJ0xJS0UnOw0KDQogICAgICAgICRzcWwgPSAkdGhpcy0+ZGItPnNxbC0+Z2V0KCktPnNlbGVjdCgkdGhpcy0+dGFibGVbJ01lbWJlciddKS0+d2hlcmUoDQogICAgICAgICAgICBhcnJheSgNCiAgICAgICAgICAgICAgICAiJGxpa2UgYXJyYXkiLCBhcnJheSgNCiAgICAgICAgICAgICAgICAgICAgYXJyYXkoJ21lbV9OYW1lJywgJG5hbWUpLA0KICAgICAgICAgICAgICAgICAgICBhcnJheSgnbWVtX0FsaWFzJywgJG5hbWUpLA0KICAgICAgICAgICAgICAgICkNCiAgICAgICAgICAgICkNCiAgICAgICAgKS0+bGltaXQoMSktPnNxbDsNCg0KICAgICAgICAvKiogQHZhciBNZW1iZXJbXSAkYW0gKi8NCiAgICAgICAgJGFtID0gJHRoaXMtPkdldExpc3RUeXBlKCdNZW1iZXInLCAkc3FsKTsNCiAgICAgICAgaWYgKGNvdW50KCRhbSkgPiAwKSB7DQogICAgICAgICAgICAkbSA9ICRhbVswXTsNCg0KICAgICAgICAgICAgcmV0dXJuICRtOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIG5ldyBNZW1iZXIoKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4fojrflj5bnlKjmiLfnmoTliKvlkI3nmoTlrp7kvoso5LiN5Yy65YiG5aSn5bCP5YaZKS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUNCiAgICAgKg0KICAgICAqIEByZXR1cm4gTWVtYmVyfEJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0TWVtYmVyQnlBbGlhcygkbmFtZSkNCiAgICB7DQogICAgICAgICRuYW1lID0gdHJpbSgkbmFtZSk7DQogICAgICAgIGlmICghJG5hbWUgfHwgIShDaGVja1JlZ0V4cCgkbmFtZSwgJ1tuaWNrbmFtZV0nKSkpIHsNCiAgICAgICAgICAgIHJldHVybiBuZXcgTWVtYmVyKCk7DQogICAgICAgIH0NCg0KICAgICAgICBmb3JlYWNoICgkdGhpcy0+bWVtYmVycyBhcyAka2V5ID0+ICYkdmFsdWUpIHsNCiAgICAgICAgICAgIGlmIChzdHJjYXNlY21wKCR2YWx1ZS0+QWxpYXMsICRuYW1lKSA9PSAwKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICR2YWx1ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgICRsaWtlID0gKCR0aGlzLT5kYi0+dHlwZSA9PSAncGdzcWwnKSA/ICdJTElLRScgOiAnTElLRSc7DQoNCiAgICAgICAgJHNxbCA9ICR0aGlzLT5kYi0+c3FsLT5nZXQoKS0+c2VsZWN0KCR0aGlzLT50YWJsZVsnTWVtYmVyJ10pLT53aGVyZSgNCiAgICAgICAgICAgIGFycmF5KA0KICAgICAgICAgICAgICAgIGFycmF5KCc9JywgJ21lbV9BbGlhcycsICRuYW1lKQ0KICAgICAgICAgICAgKQ0KICAgICAgICApLT5saW1pdCgxKS0+c3FsOw0KDQogICAgICAgIC8qKiBAdmFyIE1lbWJlcltdICRhbSAqLw0KICAgICAgICAkYW0gPSAkdGhpcy0+R2V0TGlzdFR5cGUoJ01lbWJlcicsICRzcWwpOw0KICAgICAgICBpZiAoY291bnQoJGFtKSA+IDApIHsNCiAgICAgICAgICAgICRtID0gJGFtWzBdOw0KDQogICAgICAgICAgICByZXR1cm4gJG07DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gbmV3IE1lbWJlcigpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h+mCrueuseWQjeiOt+WPlueUqOaIt+WunuS+iyjkuI3ljLrliIblpKflsI/lhpkpLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkZW1haWwNCiAgICAgKg0KICAgICAqIEByZXR1cm4gTWVtYmVyDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldE1lbWJlckJ5RW1haWwoJGVtYWlsKQ0KICAgIHsNCiAgICAgICAgJGVtYWlsID0gc3RydG9sb3dlcih0cmltKCRlbWFpbCkpOw0KICAgICAgICBpZiAoISRlbWFpbCB8fCAhQ2hlY2tSZWdFeHAoJGVtYWlsLCAnW2VtYWlsXScpKSB7DQogICAgICAgICAgICByZXR1cm4gbmV3IE1lbWJlcigpOw0KICAgICAgICB9DQoNCiAgICAgICAgJHNxbCA9ICR0aGlzLT5kYi0+c3FsLT5TZWxlY3QoJHRoaXMtPnRhYmxlWydNZW1iZXInXSwgJyonLCBhcnJheShhcnJheSgnTElLRScsICdtZW1fRW1haWwnLCAkZW1haWwpKSwgbnVsbCwgMSwgbnVsbCk7DQogICAgICAgIC8qKiBAdmFyIE1lbWJlcltdICRhbSAqLw0KICAgICAgICAkYW0gPSAkdGhpcy0+R2V0TGlzdFR5cGUoJ01lbWJlcicsICRzcWwpOw0KICAgICAgICBpZiAoY291bnQoJGFtKSA+IDApIHsNCiAgICAgICAgICAgICRtID0gJGFtWzBdOw0KDQogICAgICAgICAgICByZXR1cm4gJG07DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gbmV3IE1lbWJlcigpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOajgOafpeaMh+WumuWQjeensOeahOeUqOaIt+aYr+WQpuWtmOWcqCjkuI3ljLrliIblpKflsI/lhpkpLg0KICAgICAqDQogICAgICogQHBhcmFtICRuYW1lDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQ2hlY2tNZW1iZXJOYW1lRXhpc3QoJG5hbWUpDQogICAgew0KICAgICAgICAkbSA9ICR0aGlzLT5HZXRNZW1iZXJCeU5hbWUoJG5hbWUpOw0KDQogICAgICAgIHJldHVybiAkbS0+SUQgIT0gbnVsbDsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmo4Dmn6XmjIflrprlkI3np7DmiJbliKvlkI3nmoTnlKjmiLfmmK/lkKblrZjlnKgo5LiN5Yy65YiG5aSn5bCP5YaZKS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSAkbmFtZQ0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIENoZWNrTWVtYmVyQnlOYW1lT3JBbGlhc0V4aXN0KCRuYW1lKQ0KICAgIHsNCiAgICAgICAgJG0gPSAkdGhpcy0+R2V0TWVtYmVyQnlOYW1lT3JBbGlhcygkbmFtZSk7DQoNCiAgICAgICAgcmV0dXJuICRtLT5JRCA+IDA7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5qOA5p+l5oyH5a6a6YKu566x55qE55So5oi35piv5ZCm5a2Y5ZyoKOS4jeWMuuWIhuWkp+Wwj+WGmSkuDQogICAgICoNCiAgICAgKiBAcGFyYW0gJGVtYWlsDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQ2hlY2tNZW1iZXJCeUVtYWlsRXhpc3QoJGVtYWlsKQ0KICAgIHsNCiAgICAgICAgJG0gPSAkdGhpcy0+R2V0TWVtYmVyQnlFbWFpbCgkZW1haWwpOw0KDQogICAgICAgIHJldHVybiAkbS0+SUQgPiAwOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h0lE6I635Y+W6K+E6K665a6e5L6LLg0KICAgICAqDQogICAgICogQHBhcmFtIGludCAkaWQNCiAgICAgKg0KICAgICAqIEByZXR1cm4gQ29tbWVudHxCYXNlDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldENvbW1lbnRCeUlEKCRpZCkNCiAgICB7DQogICAgICAgIHJldHVybiAkdGhpcy0+R2V0U29tZVRoaW5nKCdjb21tZW50cycsICdJRCcsICRpZCwgJ0NvbW1lbnQnKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4dJROiOt+WPlumZhOS7tuWunuS+iy4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBpbnQgJGlkDQogICAgICoNCiAgICAgKiBAcmV0dXJuIFVwbG9hZHxCYXNlDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFVwbG9hZEJ5SUQoJGlkKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuICR0aGlzLT5HZXRTb21lVGhpbmcoJ1VwbG9hZCcsICdJRCcsICRpZCwgJ1VwbG9hZCcpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h3RhZ+WIq+WQjeiOt+WPlnRhZ+WunuS+iy4o5YWI6LWwY2FjaGVvYmplY3Tlho3otbDmn6XmlbDmja7lupMpDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRuYW1lDQogICAgICogQHBhcmFtIG51bGwgICAkYmFja0tleQ0KICAgICAqDQogICAgICogQHJldHVybiBUYWd8QmFzZQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRUYWdCeUFsaWFzKCRuYW1lLCAkdHlwZSA9IDApDQogICAgew0KICAgICAgICAkcmV0ID0gJHRoaXMtPkdldFNvbWVUaGluZ0J5QXR0cigkdGhpcy0+dGFncywgJ1RhZycsIGFycmF5KCdBbGlhcycsJ1R5cGUnKSwgYXJyYXkoJG5hbWUsICR0eXBlKSk7DQogICAgICAgIGlmIChpc19vYmplY3QoJHJldCkgJiYgJHJldC0+SUQgPj0gMCkgew0KICAgICAgICAgICAgcmV0dXJuICRyZXQ7DQogICAgICAgIH0NCg0KICAgICAgICAkYSA9IGFycmF5KCk7DQogICAgICAgICRhW10gPSBhcnJheSgnPScsJ3RhZ19BbGlhcycsICRuYW1lKTsNCiAgICAgICAgJGFbXSA9IGFycmF5KCc9JywgJ3RhZ19UeXBlJywgJHR5cGUpOw0KICAgICAgICAkYXJyYXkgPSAkdGhpcy0+R2V0VGFnTGlzdCgnKicsIGFycmF5KCRhKSwgJycsIDEsICcnKTsNCiAgICAgICAgaWYgKGNvdW50KCRhcnJheSkgPT0gMCkgew0KICAgICAgICAgICAgcmV0dXJuIG5ldyBUYWcoKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHJldHVybiAkYXJyYXlbMF07DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4d0YWflkI3ojrflj5Z0YWflrp7kvosuKOWFiOi1sGNhY2hlb2JqZWN05YaN6LWw5p+l5pWw5o2u5bqTKQ0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbmFtZQ0KICAgICAqIEBwYXJhbSBudWxsICAgJGJhY2tLZXkNCiAgICAgKg0KICAgICAqIEByZXR1cm4gVGFnfEJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0VGFnQnlOYW1lKCRuYW1lLCAkdHlwZSA9IDApDQogICAgew0KICAgICAgICAkcmV0ID0gJHRoaXMtPkdldFNvbWVUaGluZ0J5QXR0cigkdGhpcy0+dGFncywgJ1RhZycsIGFycmF5KCdOYW1lJywnVHlwZScpLCBhcnJheSgkbmFtZSwgJHR5cGUpKTsNCiAgICAgICAgaWYgKGlzX29iamVjdCgkcmV0KSAmJiAkcmV0LT5JRCA+PSAwKSB7DQogICAgICAgICAgICByZXR1cm4gJHJldDsNCiAgICAgICAgfQ0KDQogICAgICAgICRhID0gYXJyYXkoKTsNCiAgICAgICAgJGFbXSA9IGFycmF5KCc9JywgJ3RhZ19OYW1lJywgJG5hbWUpOw0KICAgICAgICAkYVtdID0gYXJyYXkoJz0nLCAndGFnX1R5cGUnLCAkdHlwZSk7DQogICAgICAgICRhcnJheSA9ICR0aGlzLT5HZXRUYWdMaXN0KCcqJywgYXJyYXkoJGEpLCAnJywgMSwgJycpOw0KICAgICAgICBpZiAoY291bnQoJGFycmF5KSA9PSAwKSB7DQogICAgICAgICAgICByZXR1cm4gbmV3IFRhZygpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgcmV0dXJuICRhcnJheVswXTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h3RhZ+eahOWIq+WQjeaIluaYr+WQjeensOiOt+WPlnRhZ+WunuS+iy4o5p+l5pWw5o2u5bqT6Z2e6LWwY2FjaGVvYmplY3QpDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRuYW1lDQogICAgICoNCiAgICAgKiBAcmV0dXJuIFRhZ3xCYXNlDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFRhZ0J5QWxpYXNPck5hbWUoJG5hbWUsICR0eXBlID0gMCkNCiAgICB7DQogICAgICAgIC8vcmV0dXJuICR0aGlzLT5HZXRUYWdCeUFsaWFzKCRuYW1lLCAnTmFtZScpOw0KICAgICAgICAkYSA9IGFycmF5KCk7DQogICAgICAgICRhW10gPSBhcnJheSgndGFnX0FsaWFzJywgJG5hbWUpOw0KICAgICAgICAkYVtdID0gYXJyYXkoJ3RhZ19OYW1lJywgJG5hbWUpOw0KICAgICAgICAkYiA9IGFycmF5KCc9JywgJ3RhZ19UeXBlJywgJHR5cGUpOw0KICAgICAgICAkYXJyYXkgPSAkdGhpcy0+R2V0VGFnTGlzdCgnKicsIGFycmF5KGFycmF5KCdhcnJheScsICRhKSwgJGIpLCAnJywgMSwgJycpOw0KICAgICAgICBpZiAoY291bnQoJGFycmF5KSA9PSAwKSB7DQogICAgICAgICAgICByZXR1cm4gbmV3IFRhZygpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgcmV0dXJuICRhcnJheVswXTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h0lE6I635Y+WdGFn5a6e5L6LLg0KICAgICAqDQogICAgICogQHBhcmFtIGludCAkaWQNCiAgICAgKg0KICAgICAqIEByZXR1cm4gVGFnfEJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0VGFnQnlJRCgkaWQpDQogICAgew0KICAgICAgICAkcmV0ID0gJHRoaXMtPkdldFNvbWVUaGluZygndGFnc19hbGwnLCAnSUQnLCAkaWQsICdUYWcnKTsNCg0KICAgICAgICByZXR1cm4gJHJldDsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4fnsbvkvLwnezF9ezJ9ezN9ezR9J+i9veWFpXRhZ3MuDQogICAgICoNCiAgICAgKiBAcGFyYW0gJHMNCiAgICAgKg0KICAgICAqIEByZXR1cm4gYXJyYXkNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gTG9hZFRhZ3NCeUlEU3RyaW5nKCRzKQ0KICAgIHsNCiAgICAgICAgJHMgPSB0cmltKCRzKTsNCiAgICAgICAgaWYgKCRzID09PSAnJykgew0KICAgICAgICAgICAgcmV0dXJuIGFycmF5KCk7DQogICAgICAgIH0NCg0KICAgICAgICAkcyA9IHN0cl9yZXBsYWNlKCd9eycsICd8JywgJHMpOw0KICAgICAgICAkcyA9IHN0cl9yZXBsYWNlKGFycmF5KCd7JywgJ30nKSwgJycsICRzKTsNCiAgICAgICAgJGEgPSBleHBsb2RlKCd8JywgJHMpOw0KICAgICAgICAkYiA9IGFycmF5KCk7DQogICAgICAgIGZvcmVhY2ggKCRhIGFzICYkdmFsdWUpIHsNCiAgICAgICAgICAgICR2YWx1ZSA9IHRyaW0oJHZhbHVlKTsNCiAgICAgICAgICAgIGlmICgkdmFsdWUpIHsNCiAgICAgICAgICAgICAgICAkYltdID0gJHZhbHVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgICR0ID0gYXJyYXlfdW5pcXVlKCRiKTsNCg0KICAgICAgICBpZiAoY291bnQoJHQpID09PSAwKSB7DQogICAgICAgICAgICByZXR1cm4gYXJyYXkoKTsNCiAgICAgICAgfQ0KDQogICAgICAgICRjID0gYXJyYXkoKTsNCiAgICAgICAgJGQgPSBhcnJheSgpOw0KICAgICAgICBmb3JlYWNoICgkdCBhcyAkdikgew0KICAgICAgICAgICAgaWYgKGFycmF5X2tleV9leGlzdHMoJHYsICR0aGlzLT50YWdzX2FsbCkgPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICAgICAkY1tdID0gJHY7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICRkWyR2XSA9ICYkdGhpcy0+dGFnc19hbGxbJHZdOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKGNvdW50KCRjKSA9PT0gMCkgew0KICAgICAgICAgICAgcmV0dXJuICRkOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJHQgPSBhcnJheSgpOw0KICAgICAgICAgICAgJGFycmF5ID0gJHRoaXMtPkdldFRhZ0xpc3QoJycsIGFycmF5KGFycmF5KCdJTicsICd0YWdfSUQnLCAkYykpLCAnJywgJycsICcnKTsNCiAgICAgICAgICAgIGZvcmVhY2ggKCRhcnJheSBhcyAkdikgew0KICAgICAgICAgICAgICAgICR0WyR2LT5JRF0gPSAmJHRoaXMtPnRhZ3NfYWxsWyR2LT5JRF07DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiBhcnJheV9tZXJnZSgkZCwgJHQpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YCa6L+H57G75Ly8J2FhYSxiYmIsY2NjLGRkZCfovb3lhaV0YWdzLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkcyDmoIfnrb7lkI3lrZfnrKbkuLLvvIzlpoInYWFhLGJiYixjY2MsZGRkDQogICAgICogQHBhcmFtIGludCAkcG9zdHR5cGUgdHlwZQ0KICAgICAqDQogICAgICogQHJldHVybiBhcnJheQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBMb2FkVGFnc0J5TmFtZVN0cmluZygkcywgJHBvc3R0eXBlID0gMCkNCiAgICB7DQogICAgICAgICRzID0gdHJpbSgkcyk7DQogICAgICAgICRzID0gc3RyX3JlcGxhY2UoYXJyYXkoJzsnLCAn77yMJywgJ+OAgScpLCAnLCcsICRzKTsNCiAgICAgICAgJHMgPSB0cmltKCRzKTsNCiAgICAgICAgJHMgPSBzdHJpcF90YWdzKCRzKTsNCiAgICAgICAgaWYgKCRzID09PSAnJyB8fCAkcyA9PT0gJywnKSB7DQogICAgICAgICAgICByZXR1cm4gYXJyYXkoKTsNCiAgICAgICAgfQ0KICAgICAgICAkcyA9IGV4cGxvZGUoJywnLCAkcyk7DQogICAgICAgICR0ID0gYXJyYXlfdW5pcXVlKCRzKTsNCiAgICAgICAgaWYgKGNvdW50KCR0KSA9PT0gMCkgew0KICAgICAgICAgICAgcmV0dXJuIGFycmF5KCk7DQogICAgICAgIH0NCg0KICAgICAgICAkdW5sb2FkX3RhZ3MgPSBhcnJheSgpOw0KICAgICAgICAkZXhpc3RfdGFncyA9IGFycmF5KCk7DQogICAgICAgIGZvcmVhY2ggKCR0IGFzICRuYW1lKSB7DQogICAgICAgICAgICAkbmFtZSA9IHRyaW0oJG5hbWUpOw0KICAgICAgICAgICAgaWYgKGlzc2V0KCR0aGlzLT50YWdzYnluYW1lX3R5cGVbJHBvc3R0eXBlXVskbmFtZV0pID09IGZhbHNlKSB7DQogICAgICAgICAgICAgICAgJHVubG9hZF90YWdzW10gPSBhcnJheSgndGFnX05hbWUnLCAkbmFtZSk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICRleGlzdF90YWdzWyRuYW1lXSA9ICYkdGhpcy0+dGFnc2J5bmFtZV90eXBlWyRwb3N0dHlwZV1bJG5hbWVdOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKGNvdW50KCR1bmxvYWRfdGFncykgPT0gMCkgew0KICAgICAgICAgICAgcmV0dXJuICRleGlzdF90YWdzOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJGFycmF5ID0gJHRoaXMtPkdldFRhZ0xpc3QoJycsIGFycmF5KGFycmF5KCc9JywgJ3RhZ19UeXBlJywgJHBvc3R0eXBlKSwgYXJyYXkoJ2FycmF5JywgJHVubG9hZF90YWdzKSksICcnLCAnJywgJycpOw0KICAgICAgICAgICAgZm9yZWFjaCAoJGFycmF5IGFzICR0YWcpIHsNCiAgICAgICAgICAgICAgICAkZXhpc3RfdGFnc1skdGFnLT5OYW1lXSA9ICYkdGhpcy0+dGFnc2J5bmFtZV90eXBlWyRwb3N0dHlwZV1bJHRhZy0+TmFtZV07DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gJGV4aXN0X3RhZ3M7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4fmlbDnu4RhcnJheVsxMTEsMzMzLDQ0NCw1NTUsNjY2Xei9rOaNouaIkOWtmOWCqOS4si4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBhcnJheSAkYXJyYXkg5qCH562+SUTmlbDnu4QNCiAgICAgKg0KICAgICAqIEByZXR1cm4gc3RyaW5nDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIENvbnZlcnRUYWdJRHRvU3RyaW5nKCRhcnJheSkNCiAgICB7DQogICAgICAgICRzID0gJyc7DQogICAgICAgIGZvcmVhY2ggKCRhcnJheSBhcyAkYSkgew0KICAgICAgICAgICAgJHMgLj0gJ3snIC4gJGEgLiAnfSc7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJHM7DQogICAgfQ0KDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFRvcEFydGljbGUoJHR5cGUgPSAwKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuICR0aGlzLT5HZXRUb3BQb3N0KCR0eXBlKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDojrflj5blhajpg6jnva7pobbmlofnq6DvvIjkvJjlhYjku45jYWNoZemHjOivu+aVsOe7hO+8iS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBpbnQgJHR5cGUNCiAgICAgKg0KICAgICAqIEByZXR1cm4gYXJyYXkNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0VG9wUG9zdCgkdHlwZSA9IDApDQogICAgew0KICAgICAgICAkdmFybmFtZSA9ICd0b3BfcG9zdF9hcnJheV8nIC4gJHR5cGU7DQogICAgICAgIGlmICgkdGhpcy0+Y2FjaGUtPkhhc0tleSgkdmFybmFtZSkgPT0gZmFsc2UpIHsNCiAgICAgICAgICAgIHJldHVybiBhcnJheSgpOw0KICAgICAgICB9DQogICAgICAgIGlmICghaXNfc3RyaW5nKCR0aGlzLT5jYWNoZS0+JHZhcm5hbWUpKSB7DQogICAgICAgICAgICByZXR1cm4gYXJyYXkoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIEAkYXJ0aWNsZXNfdG9wX25vdG9yZGVyX2lkYXJyYXkgPSB1bnNlcmlhbGl6ZSgkdGhpcy0+Y2FjaGUtPiR2YXJuYW1lKTsNCiAgICAgICAgaWYgKCFpc19hcnJheSgkYXJ0aWNsZXNfdG9wX25vdG9yZGVyX2lkYXJyYXkpKSB7DQogICAgICAgICAgICBDb3VudFRvcFBvc3QoJHR5cGUsIG51bGwsIG51bGwpOw0KICAgICAgICAgICAgQCRhcnRpY2xlc190b3Bfbm90b3JkZXJfaWRhcnJheSA9IHVuc2VyaWFsaXplKCR0aGlzLT5jYWNoZS0+JHZhcm5hbWUpOw0KICAgICAgICB9DQoNCiAgICAgICAgJGFydGljbGVzX3RvcF9ub3RvcmRlciA9IGFycmF5KCk7DQogICAgICAgIGlmIChpc19hcnJheSgkYXJ0aWNsZXNfdG9wX25vdG9yZGVyX2lkYXJyYXkpKSB7DQogICAgICAgICAgICAkYXJ0aWNsZXNfdG9wX25vdG9yZGVyID0gJHRoaXMtPkdldFBvc3RCeUFycmF5KCRhcnRpY2xlc190b3Bfbm90b3JkZXJfaWRhcnJheSk7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJGFydGljbGVzX3RvcF9ub3RvcmRlcjsNCiAgICB9DQoNCiAgICAvLyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KICAgIC8v6aqM6K+B55u45YWzDQoNCiAgICAvKioNCiAgICAgKiDojrflj5bor4TorrprZXkuDQogICAgICoNCiAgICAgKiBAcGFyYW0gJGlkDQogICAgICoNCiAgICAgKiBAcmV0dXJuIHN0cmluZw0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRDbXRLZXkoJGlkKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuIG1kNSgkdGhpcy0+Z3VpZCAuICRpZCAuIGRhdGUoJ1ltZGgnKSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6aqM6K+B6K+E6K66a2V5Lg0KICAgICAqDQogICAgICogQHBhcmFtICRpZA0KICAgICAqIEBwYXJhbSAka2V5DQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gVmFsaWRDbXRLZXkoJGlkLCAka2V5KQ0KICAgIHsNCiAgICAgICAgJG5vd2tleSA9IG1kNSgkdGhpcy0+Z3VpZCAuICRpZCAuIGRhdGUoJ1ltZGgnKSk7DQogICAgICAgICRub3drZXkyID0gbWQ1KCR0aGlzLT5ndWlkIC4gJGlkIC4gZGF0ZSgnWW1kaCcsICh0aW1lKCkgLSAoMzYwMCAqIDEpKSkpOw0KDQogICAgICAgIHJldHVybiAka2V5ID09ICRub3drZXkgfHwgJGtleSA9PSAkbm93a2V5MjsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDojrflj5ZDU1JGIFRva2VuLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkaWQg5bqU55SoSUTvvIzlj6/ku6Xkv53or4Hmr4/kuKrlupTnlKjojrflj5bkuI3lkIznmoRUb2tlbg0KICAgICAqDQogICAgICogQHJldHVybiBzdHJpbmcNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0Q1NSRlRva2VuKCRpZCA9ICcnKQ0KICAgIHsNCiAgICAgICAgJHMgPSAkdGhpcy0+dXNlci0+SUQgLiAkdGhpcy0+dXNlci0+UGFzc3dvcmQgLiAkdGhpcy0+dXNlci0+U3RhdHVzOw0KDQogICAgICAgIHJldHVybiBtZDUoJHRoaXMtPmd1aWQgLiAkcyAuICRpZCAuIGRhdGUoJ1ltZGgnKSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6aqM6K+BQ1NSRiBUb2tlbi4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHRva2VuDQogICAgICogQHBhcmFtIHN0cmluZyAkaWQgICAg5bqU55SoSUTvvIzlj6/kuLrmr4/kuKrlupTnlKjnlJ/miJDkuIDkuKrkuJPlsZ50b2tlbg0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFZlcmlmeUNTUkZUb2tlbigkdG9rZW4sICRpZCA9ICcnKQ0KICAgIHsNCiAgICAgICAgJHVzZXJTdHJpbmcgPSAkdGhpcy0+dXNlci0+SUQgLiAkdGhpcy0+dXNlci0+UGFzc3dvcmQgLiAkdGhpcy0+dXNlci0+U3RhdHVzOw0KICAgICAgICAkdG9rZW5TdHJpbmcgPSAkdGhpcy0+Z3VpZCAuICR1c2VyU3RyaW5nIC4gJGlkOw0KDQogICAgICAgIGZvciAoJGkgPSAwOyAkaSA8PSAkdGhpcy0+Y3NyZkV4cGlyYXRpb247ICRpKyspIHsNCiAgICAgICAgICAgIGlmICgkdG9rZW4gPT09IG1kNSgkdG9rZW5TdHJpbmcgLiBkYXRlKCdZbWRoJywgKHRpbWUoKSAtICgzNjAwICogJGkpKSkpKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5pi+56S66aqM6K+B56CBDQogICAgICoNCiAgICAgKiBAYXBpIEZpbHRlcl9QbHVnaW5fWmJwX1Nob3dWYWxpZENvZGUg5aaC6K+l5o6l5Y+j5pyq6KKr5oyC6L295YiZ5pi+56S66buY6K6k6aqM6K+B5Zu+54mHDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRpZCDlkb3lkI3kuovku7YNCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBTaG93VmFsaWRDb2RlKCRpZCA9ICcnKQ0KICAgIHsNCiAgICAgICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fWmJwX1Nob3dWYWxpZENvZGUnXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgICAgIHJldHVybiAkZnBuYW1lKCRpZCk7IC8vKg0KICAgICAgICB9DQoNCiAgICAgICAgJF92YyA9IG5ldyBWYWxpZGF0ZUNvZGUoKTsNCiAgICAgICAgJF92Yy0+R2V0SW1nKCk7DQogICAgICAgIHNldGNvb2tpZSgnY2FwdGNoYV8nIC4gY3JjMzIoJHRoaXMtPmd1aWQgLiAkaWQpLCBtZDUoJHRoaXMtPmd1aWQgLiBkYXRlKCJZbWRoIikgLiAkX3ZjLT5HZXRDb2RlKCkpLCBudWxsLCAkdGhpcy0+Y29va2llc3BhdGgpOw0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOavlOWvuemqjOivgeeggQ0KICAgICAqDQogICAgICogQGFwaSBGaWx0ZXJfUGx1Z2luX1picF9DaGVja1ZhbGlkQ29kZSDlpoLor6XmjqXlj6PmnKrooqvmjILovb3liJnmr5Tlr7npu5jorqTpqozor4HnoIENCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHZlcmlmeUNvZGUg6aqM6K+B56CB5pWw5YC8DQogICAgICogQHBhcmFtIHN0cmluZyAkaWQgICAgICAgICDlkb3lkI3kuovku7YNCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBDaGVja1ZhbGlkQ29kZSgkdmVyaWZ5Q29kZSwgJGlkID0gJycpDQogICAgew0KICAgICAgICAkdmVyaWZ5Q29kZSA9IHN0cnRvbG93ZXIoJHZlcmlmeUNvZGUpOw0KICAgICAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9aYnBfQ2hlY2tWYWxpZENvZGUnXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgICAgIHJldHVybiAkZnBuYW1lKCR2ZXJpZnlDb2RlLCAkaWQpOyAvLyoNCiAgICAgICAgfQ0KDQogICAgICAgICRvcmlnaW5hbCA9IEdldFZhcnMoJ2NhcHRjaGFfJyAuIGNyYzMyKCR0aGlzLT5ndWlkIC4gJGlkKSwgJ0NPT0tJRScpOw0KICAgICAgICBzZXRjb29raWUoJ2NhcHRjaGFfJyAuIGNyYzMyKCR0aGlzLT5ndWlkIC4gJGlkKSwgJycsICh0aW1lKCkgLSAzNjAwKSwgJHRoaXMtPmNvb2tpZXNwYXRoKTsNCg0KICAgICAgICByZXR1cm4gbWQ1KCR0aGlzLT5ndWlkIC4gZGF0ZSgiWW1kaCIpIC4gc3RydG9sb3dlcigkdmVyaWZ5Q29kZSkpID09ICRvcmlnaW5hbA0KICAgICAgICAgICAgfHwNCiAgICAgICAgICAgIG1kNSgkdGhpcy0+Z3VpZCAuIGRhdGUoIlltZGgiLCAodGltZSgpIC0gKDM2MDAgKiAxKSkpIC4gc3RydG9sb3dlcigkdmVyaWZ5Q29kZSkpID09ICRvcmlnaW5hbDsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDlkJHlr7zoiKroj5zljZXmt7vliqDnm7jlupTmnaHnm64uDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICR0eXBlICR0eXBlPWNhdGVnb3J5LHRhZyxwYWdlLGl0ZW0NCiAgICAgKiBAcGFyYW0gc3RyaW5nICRpZA0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUNCiAgICAgKiBAcGFyYW0gc3RyaW5nICR1cmwNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQWRkSXRlbVRvTmF2YmFyKCR0eXBlLCAkaWQsICRuYW1lLCAkdXJsKQ0KICAgIHsNCiAgICAgICAgaWYgKCEkdHlwZSkgew0KICAgICAgICAgICAgJHR5cGUgPSAnaXRlbSc7DQogICAgICAgIH0NCg0KICAgICAgICAkbSA9ICR0aGlzLT5tb2R1bGVzYnlmaWxlbmFtZVsnbmF2YmFyJ107DQogICAgICAgICRzID0gJG0tPkNvbnRlbnQ7DQoNCiAgICAgICAgJGEgPSAnPGxpIGlkPSJuYXZiYXItJyAuICR0eXBlIC4gJy0nIC4gJGlkIC4gJyI+PGEgaHJlZj0iJyAuICR1cmwgLiAnIj4nIC4gJG5hbWUgLiAnPC9hPjwvbGk+JzsNCg0KICAgICAgICBpZiAoJHRoaXMtPkNoZWNrSXRlbVRvTmF2YmFyKCR0eXBlLCAkaWQpKSB7DQogICAgICAgICAgICAkcyA9IHByZWdfcmVwbGFjZSgnLzxsaSBpZD0ibmF2YmFyLScgLiAkdHlwZSAuICctJyAuICRpZCAuICciPi4qPzxcL2xpPi8nLCAkYSwgJHMpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJHMgLj0gJzxsaSBpZD0ibmF2YmFyLScgLiAkdHlwZSAuICctJyAuICRpZCAuICciPjxhIGhyZWY9IicgLiAkdXJsIC4gJyI+JyAuICRuYW1lIC4gJzwvYT48L2xpPic7DQogICAgICAgIH0NCg0KICAgICAgICAkbS0+Q29udGVudCA9ICRzOw0KICAgICAgICAkbS0+U2F2ZSgpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWIoOmZpOWvvOiIquiPnOWNleS4reebuOW6lOadoeebri4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHR5cGUNCiAgICAgKiBAcGFyYW0gJGlkDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIERlbEl0ZW1Ub05hdmJhcigkdHlwZSwgJGlkKQ0KICAgIHsNCiAgICAgICAgaWYgKCEkdHlwZSkgew0KICAgICAgICAgICAgJHR5cGUgPSAnaXRlbSc7DQogICAgICAgIH0NCg0KICAgICAgICAkbSA9ICR0aGlzLT5tb2R1bGVzYnlmaWxlbmFtZVsnbmF2YmFyJ107DQogICAgICAgICRzID0gJG0tPkNvbnRlbnQ7DQoNCiAgICAgICAgJHMgPSBwcmVnX3JlcGxhY2UoJy88bGkgaWQ9Im5hdmJhci0nIC4gJHR5cGUgLiAnLScgLiAkaWQgLiAnIj4uKj88XC9saT4vJywgJycsICRzKTsNCg0KICAgICAgICAkbS0+Q29udGVudCA9ICRzOw0KICAgICAgICAkbS0+U2F2ZSgpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOajgOafpeadoeebruaYr+WQpuWcqOWvvOiIquiPnOWNleS4rS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHR5cGUNCiAgICAgKiBAcGFyYW0gJGlkDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQ2hlY2tJdGVtVG9OYXZiYXIoJHR5cGUsICRpZCkNCiAgICB7DQogICAgICAgIGlmICghJHR5cGUpIHsNCiAgICAgICAgICAgICR0eXBlID0gJ2l0ZW0nOw0KICAgICAgICB9DQoNCiAgICAgICAgJG0gPSAkdGhpcy0+bW9kdWxlc2J5ZmlsZW5hbWVbJ25hdmJhciddOw0KICAgICAgICAkcyA9ICRtLT5Db250ZW50Ow0KDQogICAgICAgIHJldHVybiAoYm9vbCkgc3RycG9zKCRzLCAnaWQ9Im5hdmJhci0nIC4gJHR5cGUgLiAnLScgLiAkaWQgLiAnIicpOw0KICAgIH0NCg0KICAgIC8vJHNpZ25hbCA9IGdvb2QsYmFkLHRpcHMNCiAgICBwcml2YXRlICRoaW50cyA9IGFycmF5KCk7DQoNCiAgICAvKioNCiAgICAgKiDorr7nva7mj5DnpLrmtojmga/lubblrZjlhaVDb29raWUuDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRzaWduYWwgIOaPkOekuuexu+Wei++8iGdvb2R8YmFkfHRpcHPvvIkNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRjb250ZW50IOaPkOekuuWGheWuuQ0KICAgICAqIEBwYXJhbSBpbnQgJGRlbGF5IOW7tuaXtuaXtumXtA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBTZXRIaW50KCRzaWduYWwsICRjb250ZW50ID0gJycsICRkZWxheSA9IDEwKQ0KICAgIHsNCiAgICAgICAgaWYgKCRjb250ZW50ID09ICcnKSB7DQogICAgICAgICAgICBpZiAoc3Vic3RyKCRzaWduYWwsIDAsIDQpID09ICdnb29kJykgew0KICAgICAgICAgICAgICAgICRjb250ZW50ID0gJHRoaXMtPmxhbmdbJ21zZyddWydvcGVyYXRpb25fc3VjY2VlZCddOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoc3Vic3RyKCRzaWduYWwsIDAsIDMpID09ICdiYWQnKSB7DQogICAgICAgICAgICAgICAgJGNvbnRlbnQgPSAkdGhpcy0+bGFuZ1snbXNnJ11bJ29wZXJhdGlvbl9mYWlsZWQnXTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICAkY29udGVudCA9IHN1YnN0cigkY29udGVudCwgMCwgMjU1KTsNCiAgICAgICAgZm9yICgkaSA9IDE7ICRpIDw9IDEwOyAkaSsrKSB7DQogICAgICAgICAgICBpZiAoaXNzZXQoJHRoaXMtPmhpbnRzWyRpXSkpIHsNCiAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgICRoaW50ID0gbmV3IHN0ZENsYXNzOw0KICAgICAgICAgICAgJGhpbnQtPnNpZ25hbCA9ICRzaWduYWw7DQogICAgICAgICAgICAkaGludC0+Y29udGVudCA9ICRjb250ZW50Ow0KICAgICAgICAgICAgJGhpbnQtPmRlbGF5ID0gJGRlbGF5Ow0KICAgICAgICAgICAgJHRoaXMtPmhpbnRzWyRpXSA9ICRoaW50Ow0KICAgICAgICAgICAgc2V0Y29va2llKCJoaW50X3NpZ25hbCIgLiAkaSwganNvbl9lbmNvZGUoJGhpbnQpLCAwLCAkdGhpcy0+Y29va2llc3BhdGgpOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmj5Dlj5ZDb29raWXkuK3nmoTmj5DnpLrmtojmga8uDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldEhpbnQoKQ0KICAgIHsNCiAgICAgICAgZm9yICgkaSA9IDE7ICRpIDw9IDEwOyAkaSsrKSB7DQogICAgICAgICAgICBpZiAoaXNzZXQoJHRoaXMtPmhpbnRzWyRpXSkgJiYgaXNfb2JqZWN0KCR0aGlzLT5oaW50c1skaV0pKSB7DQogICAgICAgICAgICAgICAgJHRoaXMtPlNob3dIaW50KCR0aGlzLT5oaW50c1skaV0pOw0KICAgICAgICAgICAgICAgIGlmIChHZXRWYXJzKCJoaW50X3NpZ25hbCIgLiAkaSwgJ0NPT0tJRScpID09PSBqc29uX2VuY29kZSgkdGhpcy0+aGludHNbJGldKSkgew0KICAgICAgICAgICAgICAgICAgICBzZXRjb29raWUoImhpbnRfc2lnbmFsIiAuICRpLCAnJywgKHRpbWUoKSAtIDM2MDApLCAkdGhpcy0+Y29va2llc3BhdGgpOw0KICAgICAgICAgICAgICAgICAgICB1bnNldCgkX0NPT0tJRVsiaGludF9zaWduYWwiIC4gJGldKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgZm9yICgkaSA9IDE7ICRpIDw9IDEwOyAkaSsrKSB7DQogICAgICAgICAgICAkc2lnbmFsID0gR2V0VmFycygnaGludF9zaWduYWwnIC4gJGksICdDT09LSUUnKTsNCiAgICAgICAgICAgICRoaW50ID0ganNvbl9kZWNvZGUoJHNpZ25hbCk7DQogICAgICAgICAgICBpZiAoJGhpbnQgIT09IG51bGwpIHsNCiAgICAgICAgICAgICAgICAkdGhpcy0+U2hvd0hpbnQoJGhpbnQpOw0KICAgICAgICAgICAgICAgIHNldGNvb2tpZSgiaGludF9zaWduYWwiIC4gJGksICcnLCAodGltZSgpIC0gMzYwMCksICR0aGlzLT5jb29raWVzcGF0aCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDnlLHmj5DnpLrmtojmga/ojrflj5ZIVE1MLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkc2lnbmFsICDmj5DnpLrnsbvlnovvvIhnb29kfGJhZHx0aXBz77yJDQogICAgICogQHBhcmFtIHN0cmluZyAkY29udGVudCDmj5DnpLrlhoXlrrkNCiAgICAgKiBAcGFyYW0gaW50ICRkZWxheSDlu7bml7bml7bpl7QNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gU2hvd0hpbnQoJHNpZ25hbCwgJGNvbnRlbnQgPSAnJywgJGRlbGF5ID0gMTApDQogICAgew0KICAgICAgICAvLzEuN+WinuWKoCRzaWduYWzkuLpqc29u57G75Z6LDQogICAgICAgICRoaW50ID0gJHNpZ25hbDsNCiAgICAgICAgaWYgKGlzX29iamVjdCgkaGludCkpIHsNCiAgICAgICAgICAgICRzaWduYWwgPSAkaGludC0+c2lnbmFsOw0KICAgICAgICAgICAgJGNvbnRlbnQgPSAkaGludC0+Y29udGVudDsNCiAgICAgICAgICAgICRkZWxheSA9ICRoaW50LT5kZWxheTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmICgkY29udGVudCA9PSAnJykgew0KICAgICAgICAgICAgaWYgKHN1YnN0cigkc2lnbmFsLCAwLCA0KSA9PSAnZ29vZCcpIHsNCiAgICAgICAgICAgICAgICAkY29udGVudCA9ICR0aGlzLT5sYW5nWydtc2cnXVsnb3BlcmF0aW9uX3N1Y2NlZWQnXTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKHN1YnN0cigkc2lnbmFsLCAwLCAzKSA9PSAnYmFkJykgew0KICAgICAgICAgICAgICAgICRjb250ZW50ID0gJHRoaXMtPmxhbmdbJ21zZyddWydvcGVyYXRpb25fZmFpbGVkJ107DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgJGRlbGF5ID0gKCRkZWxheSAqIDEwMDApOw0KICAgICAgICBlY2hvICI8ZGl2IGNsYXNzPVwiaGludFwiPjxwIGNsYXNzPVwiaGludCBoaW50XyRzaWduYWxcIiBkYXRhLWRlbGF5PVwiJGRlbGF5XCI+JGNvbnRlbnQ8L3A+PC9kaXY+IjsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmmL7npLrplJnor6/kv6Hmga8uDQogICAgICoNCiAgICAgKiBAYXBpIEZpbHRlcl9QbHVnaW5fWmJwX1Nob3dFcnJvcg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZy9pbnQgJGVycm9yVGV4dA0KICAgICAqIEBwYXJhbSBudWxsICAgICAgICRmaWxlDQogICAgICogQHBhcmFtIG51bGwgICAgICAgJGxpbmUNCiAgICAgKg0KICAgICAqIEB0aHJvd3MgRXhjZXB0aW9uDQogICAgICoNCiAgICAgKiBAcmV0dXJuIG1peGVkDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFNob3dFcnJvcigkZXJyb3JUZXh0LCAkZmlsZSA9IG51bGwsICRsaW5lID0gbnVsbCwgJG1vcmVpbmZvID0gYXJyYXkoKSkNCiAgICB7DQogICAgICAgICRlcnJvckNvZGUgPSAwOw0KICAgICAgICBpZiAoaXNfbnVtZXJpYygkZXJyb3JUZXh0KSkgew0KICAgICAgICAgICAgJGVycm9yQ29kZSA9IChpbnQpICRlcnJvclRleHQ7DQogICAgICAgICAgICAkZXJyb3JUZXh0ID0gJHRoaXMtPmxhbmdbJ2Vycm9yJ11bJGVycm9yVGV4dF07DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoJGVycm9yQ29kZSA9PSAyKSB7DQogICAgICAgICAgICBIdHRwNDA0KCk7DQogICAgICAgIH0NCg0KICAgICAgICBaQmxvZ0V4Y2VwdGlvbjo6JGVycm9yX2lkID0gJGVycm9yQ29kZTsNCiAgICAgICAgWkJsb2dFeGNlcHRpb246OiRlcnJvcl9maWxlID0gJGZpbGU7DQogICAgICAgIFpCbG9nRXhjZXB0aW9uOjokZXJyb3JfbGluZSA9ICRsaW5lOw0KICAgICAgICAkYXJyYXkgPSBaQmxvZ0V4Y2VwdGlvbjo6JGVycm9yX2RlYnVnaW5mbzsNCiAgICAgICAgWkJsb2dFeGNlcHRpb246OiRlcnJvcl9kZWJ1Z2luZm8gPSBhcnJheV9tZXJnZSgkYXJyYXksICRtb3JlaW5mbyk7DQoNCiAgICAgICAgaWYgKHN0cmlwb3MoJ3snIC4gc2hhMSgnbXVzdHNob3dlcnJvcicpIC4gJ30nLCAkZXJyb3JUZXh0KSA9PT0gMCkgew0KICAgICAgICAgICAgJGVycm9yVGV4dCA9IHN0cl9yZXBsYWNlKCd7JyAuIHNoYTEoJ211c3RzaG93ZXJyb3InKSAuICd9JywgJycsICRlcnJvclRleHQpOw0KICAgICAgICAgICAgJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fRGVidWdfRGlzcGxheSddID0gYXJyYXkoKTsNCiAgICAgICAgICAgICRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX0RlYnVnX0hhbmRsZXInXSA9IGFycmF5KCk7DQoNCiAgICAgICAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oJGVycm9yVGV4dCk7DQogICAgICAgIH0NCg0KICAgICAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9aYnBfU2hvd0Vycm9yJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICAgICAkZnByZXR1cm4gPSAkZnBuYW1lKCRlcnJvckNvZGUsICRlcnJvclRleHQsICRmaWxlLCAkbGluZSwgJG1vcmVpbmZvKTsNCiAgICAgICAgICAgIGlmICgkZnBzaWduYWwgPT0gUExVR0lOX0VYSVRTSUdOQUxfUkVUVVJOKSB7DQogICAgICAgICAgICAgICAgJGZwc2lnbmFsID0gUExVR0lOX0VYSVRTSUdOQUxfTk9ORTsNCg0KICAgICAgICAgICAgICAgIHJldHVybiAkZnByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKCRlcnJvclRleHQpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOajgOa1i+e9keermeWFs+mXre+8jOWmguaenOWFs+mXre+8jOWImeaKm+WHuumUmeivry4NCiAgICAgKg0KICAgICAqIEB0aHJvd3MgRXhjZXB0aW9uDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIENoZWNrU2l0ZUNsb3NlZCgpDQogICAgew0KICAgICAgICBpZiAoJHRoaXMtPm9wdGlvblsnWkNfQ0xPU0VfU0lURSddKSB7DQogICAgICAgICAgICBIdHRwNTAzKCk7DQogICAgICAgICAgICAkdGhpcy0+U2hvd0Vycm9yKDgyLCBfX0ZJTEVfXywgX19MSU5FX18pOw0KICAgICAgICAgICAgZXhpdDsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOi3s+i9rOWIsOWuieijhemhtemdoi4NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gUmVkaXJlY3RJbnN0YWxsKCkNCiAgICB7DQogICAgICAgIGlmICghJHRoaXMtPm9wdGlvblsnWkNfREFUQUJBU0VfVFlQRSddKSB7DQogICAgICAgICAgICAkcyA9ICRfU0VSVkVSWydRVUVSWV9TVFJJTkcnXTsNCiAgICAgICAgICAgICRzID0gZW1wdHkoJHMpID8gJycgOiAnPycgLiAkczsNCiAgICAgICAgICAgIFJlZGlyZWN0KCcuL3piX2luc3RhbGwvaW5kZXgucGhwJyAuICRzKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOazqOWGjFBvc3RUeXBlLg0KICAgICAqDQogICAgICogQHBhcmFtICR0eXBlSWQNCiAgICAgKiBAcGFyYW0gJG5hbWUNCiAgICAgKiBAcGFyYW0gc3RyaW5nICR1cmxSdWxlICAgICAg6buY6K6k5pivYXJyYXkoKSDkuLpVcmwgUnVsZee7hOWQiOeahOaVsOe7hA0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHRlbXBsYXRlICAgICDpu5jorqTmqKHmnb/lkI3mmK9hcnJheSgpIOS4uuS4gOS4que7hOWQiOaVsOe7hA0KICAgICAqIEBwYXJhbSBzdHJpbmcgJGNsYXNzTmFtZSAgICDpu5jorqTnsbvlkI0NCiAgICAgKiBAcGFyYW0gc3RyaW5nICRhY3Rpb25zICAgICDpu5jorqRBY3Rpb25zIOW6lOaYr2FycmF5KCkNCiAgICAgKg0KICAgICAqIEB0aHJvd3MgRXhjZXB0aW9uDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFJlZ1Bvc3RUeXBlKCR0eXBlSWQsICRuYW1lLCAkdXJsUnVsZSA9IGFycmF5KCksICR0ZW1wbGF0ZSA9IGFycmF5KCksICRjbGFzc05hbWUgPSAnUG9zdCcsICRhY3Rpb25zID0gYXJyYXkoKSwgJHJvdXRlcyA9IGFycmF5KCkpDQogICAgew0KICAgICAgICAvKiDov5nkuKTkuKrlj4LmlbDlnKgxLjfph4zlt7Lnu4/lup/lvIMNCiAgICAgICAgKiBAcGFyYW0gc3RyaW5nICRjYXRlZ29yeVR5cGUg5b2T5YmN5paH56ug57G755qE5YiG57G7VHlwZSAvL+W3suW6n+W8gw0KICAgICAgICAqIEBwYXJhbSBzdHJpbmcgJHRhZ1R5cGUgICAgICDlvZPliY3mlofnq6DnsbvnmoTmoIfnrb5UeXBlIC8v5bey5bqf5byDDQogICAgICAgICovDQogICAgICAgICR1cnMgPSBhcnJheSgpOw0KICAgICAgICAkdXJzWydzaW5nbGVfdXJscnVsZSddID0gJHRoaXMtPm9wdGlvblsnWkNfUEFHRV9SRUdFWCddOw0KICAgICAgICAkdXJzWydsaXN0X3VybHJ1bGUnXSA9ICR0aGlzLT5vcHRpb25bJ1pDX0lOREVYX1JFR0VYJ107DQogICAgICAgICR1cnNbJ2xpc3RfY2F0ZWdvcnlfdXJscnVsZSddID0gJHRoaXMtPm9wdGlvblsnWkNfQ0FURUdPUllfUkVHRVgnXTsNCiAgICAgICAgJHVyc1snbGlzdF9hdXRob3JfdXJscnVsZSddID0gJHRoaXMtPm9wdGlvblsnWkNfQVVUSE9SX1JFR0VYJ107DQogICAgICAgICR1cnNbJ2xpc3RfZGF0ZV91cmxydWxlJ10gPSAkdGhpcy0+b3B0aW9uWydaQ19EQVRFX1JFR0VYJ107DQogICAgICAgICR1cnNbJ2xpc3RfdGFnX3VybHJ1bGUnXSA9ICR0aGlzLT5vcHRpb25bJ1pDX1RBR1NfUkVHRVgnXTsNCiAgICAgICAgJHVyc1snc2VhcmNoX3VybHJ1bGUnXSA9ICR0aGlzLT5vcHRpb25bJ1pDX1NFQVJDSF9SRUdFWCddOw0KICAgICAgICBpZiAoIWlzX2FycmF5KCR1cmxSdWxlKSkgew0KICAgICAgICAgICAgaWYgKCR1cmxSdWxlICE9ICcnKSB7DQogICAgICAgICAgICAgICAgJHVyc1snc2luZ2xlX3VybHJ1bGUnXSA9ICR1cmxSdWxlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJHVycyA9IGFycmF5X21lcmdlKCR1cnMsICR1cmxSdWxlKTsNCiAgICAgICAgfQ0KDQogICAgICAgICR0eXBlSWQgPSAoaW50KSAkdHlwZUlkOw0KICAgICAgICAkbmFtZSA9IHN0cnRvbG93ZXIodHJpbSgkbmFtZSkpOw0KICAgICAgICBpZiAoJHR5cGVJZCA+IDk5KSB7DQogICAgICAgICAgICBpZiAoaXNzZXQoJHRoaXMtPnBvc3R0eXBlWyR0eXBlSWRdKSkgew0KICAgICAgICAgICAgICAgICR0aGlzLT5TaG93RXJyb3IoODcsIF9fRklMRV9fLCBfX0xJTkVfXyk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgJHRwcyA9IGFycmF5KCk7DQogICAgICAgICR0cHNbJ3RlbXBsYXRlJ10gPSAkdGhpcy0+b3B0aW9uWydaQ19QT1NUX0RFRkFVTFRfVEVNUExBVEUnXTsNCiAgICAgICAgJHRwc1snbGlzdF90ZW1wbGF0ZSddID0gJHRoaXMtPm9wdGlvblsnWkNfSU5ERVhfREVGQVVMVF9URU1QTEFURSddOw0KICAgICAgICAkdHBzWydjYXRlZ29yeV90ZW1wbGF0ZSddID0gJHRoaXMtPm9wdGlvblsnWkNfSU5ERVhfREVGQVVMVF9URU1QTEFURSddOw0KICAgICAgICAkdHBzWyd0YWdfdGVtcGxhdGUnXSA9ICR0aGlzLT5vcHRpb25bJ1pDX0lOREVYX0RFRkFVTFRfVEVNUExBVEUnXTsNCiAgICAgICAgJHRwc1snYXV0aG9yX3RlbXBsYXRlJ10gPSAkdGhpcy0+b3B0aW9uWydaQ19JTkRFWF9ERUZBVUxUX1RFTVBMQVRFJ107DQogICAgICAgICR0cHNbJ2RhdGVfdGVtcGxhdGUnXSA9ICR0aGlzLT5vcHRpb25bJ1pDX0lOREVYX0RFRkFVTFRfVEVNUExBVEUnXTsNCiAgICAgICAgJHRwc1snc2VhcmNoX3RlbXBsYXRlJ10gPSAkdGhpcy0+b3B0aW9uWydaQ19TRUFSQ0hfREVGQVVMVF9URU1QTEFURSddOw0KDQogICAgICAgIGlmICghaXNfYXJyYXkoJHRlbXBsYXRlKSkgew0KICAgICAgICAgICAgaWYgKCR0ZW1wbGF0ZSAhPSAnJykgew0KICAgICAgICAgICAgICAgICR0cHNbJ3RlbXBsYXRlJ10gPSAkdGVtcGxhdGU7DQogICAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkdHBzID0gYXJyYXlfbWVyZ2UoJHRwcywgJHRlbXBsYXRlKTsNCiAgICAgICAgfQ0KDQogICAgICAgICR0aGlzLT5wb3N0dHlwZVskdHlwZUlkXSA9IGFycmF5KCduYW1lJyA9PiAkbmFtZSwgJ2NsYXNzbmFtZScgPT4gJGNsYXNzTmFtZSk7DQogICAgICAgICR0aGlzLT5wb3N0dHlwZVskdHlwZUlkXSA9IGFycmF5X21lcmdlKCR0aGlzLT5wb3N0dHlwZVskdHlwZUlkXSwgJHRwcywgJHVycyk7DQoNCiAgICAgICAgJHBvc3RfYWN0aW9ucyA9IGFycmF5KCduZXcnID0+ICdBcnRpY2xlTmV3JywgJ2VkaXQnID0+ICdBcnRpY2xlRWR0JywgJ2RlbCcgPT4gJ0FydGljbGVEZWwnLCAncG9zdCcgPT4gJ0FydGljbGVQc3QnLCAncHVibGlzaCcgPT4gJ0FydGljbGVQdWInLCAnbWFuYWdlJyA9PiAnQXJ0aWNsZU1uZycsICdhbGwnID0+ICdBcnRpY2xlQWxsJywgJ3ZpZXcnID0+ICd2aWV3JywgJ3NlYXJjaCcgPT4gJ3NlYXJjaCcpOw0KDQogICAgICAgIGlmIChlbXB0eSgkYWN0aW9ucykgfHwgaXNfYXJyYXkoJGFjdGlvbnMpID09IGZhbHNlKSB7DQogICAgICAgICAgICAkYWN0aW9ucyA9ICRwb3N0X2FjdGlvbnM7DQogICAgICAgIH0NCg0KICAgICAgICBmb3JlYWNoICgkcG9zdF9hY3Rpb25zIGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICAgICBpZiAoIWlzc2V0KCRhY3Rpb25zWyRrZXldKSkgew0KICAgICAgICAgICAgICAgICRhY3Rpb25zWyRrZXldID0gJHZhbHVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgICR0aGlzLT5wb3N0dHlwZVskdHlwZUlkXVsnYWN0aW9ucyddID0gJGFjdGlvbnM7DQoNCiAgICAgICAgaWYgKCFpc3NldCgkdGhpcy0+dGFnc190eXBlWyR0eXBlSWRdKSkgew0KICAgICAgICAgICAgJHRoaXMtPnRhZ3NfdHlwZVskdHlwZUlkXSA9IGFycmF5KCk7DQogICAgICAgIH0NCiAgICAgICAgaWYgKCFpc3NldCgkdGhpcy0+dGFnc2J5bmFtZV90eXBlWyR0eXBlSWRdKSkgew0KICAgICAgICAgICAgJHRoaXMtPnRhZ3NieW5hbWVfdHlwZVskdHlwZUlkXSA9IGFycmF5KCk7DQogICAgICAgIH0NCiAgICAgICAgaWYgKCFpc3NldCgkdGhpcy0+Y2F0ZWdvcmllc2J5b3JkZXJfdHlwZVskdHlwZUlkXSkpIHsNCiAgICAgICAgICAgICR0aGlzLT5jYXRlZ29yaWVzYnlvcmRlcl90eXBlWyR0eXBlSWRdID0gYXJyYXkoKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOiuvue9rlBvc3RUeXBlLg0KICAgICAqDQogICAgICogQHBhcmFtICR0eXBlSWQNCiAgICAgKiBAcGFyYW0gJG5hbWUNCiAgICAgKiBAcGFyYW0gJHZhbHVlDQogICAgICoNCiAgICAgKiBAdGhyb3dzIEV4Y2VwdGlvbg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBTZXRQb3N0VHlwZSgkdHlwZWlkLCAkbmFtZSwgJHZhbHVlKQ0KICAgIHsNCiAgICAgICAgJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWyRuYW1lXSA9ICR2YWx1ZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDojrflj5ZQb3N0VHlwZeS/oeaBryjlpoLmnpzmmK/kv67mlLnnmoTor53or7fnm7TmjqXnvJbovpEkemJwLT5wb3N0dHlwZSkNCiAgICAgKg0KICAgICAqIEBwYXJhbSAka2V5DQogICAgICoNCiAgICAgKiBAcGFyYW0gJHR5cGVpZA0KICAgICAqDQogICAgICogQHJldHVybiBzdHJpbmcNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0UG9zdFR5cGUoJHR5cGVpZCwgJGtleSkNCiAgICB7DQogICAgICAgIGlmICgka2V5ID09IG51bGwgfHwgZW1wdHkoJGtleSkpIHsNCiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF07DQogICAgICAgIH0NCiAgICAgICAgaWYgKCduYW1lJyA9PSAka2V5KSB7DQogICAgICAgICAgICBpZiAoaXNzZXQoJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWyduYW1lJ10pKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHN0cnRvbG93ZXIoJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWyduYW1lJ10pOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gJyc7DQogICAgICAgIH0gZWxzZWlmICgnc2luZ2xlX3VybHJ1bGUnID09ICRrZXkpIHsNCiAgICAgICAgICAgIGlmIChpc3NldCgkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJ3NpbmdsZV91cmxydWxlJ10pKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVsnc2luZ2xlX3VybHJ1bGUnXTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5vcHRpb25bJ1pDX1BBR0VfUkVHRVgnXTsNCiAgICAgICAgfSBlbHNlaWYgKCdsaXN0X3VybHJ1bGUnID09ICRrZXkpIHsNCiAgICAgICAgICAgIGlmIChpc3NldCgkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJ2xpc3RfdXJscnVsZSddKSkgew0KICAgICAgICAgICAgICAgIHJldHVybiAkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJ2xpc3RfdXJscnVsZSddOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gJHRoaXMtPm9wdGlvblsnWkNfSU5ERVhfUkVHRVgnXTsNCiAgICAgICAgfSBlbHNlaWYgKCdsaXN0X2NhdGVnb3J5X3VybHJ1bGUnID09ICRrZXkpIHsNCiAgICAgICAgICAgIGlmIChpc3NldCgkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJ2xpc3RfY2F0ZWdvcnlfdXJscnVsZSddKSkgew0KICAgICAgICAgICAgICAgIHJldHVybiAkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJ2xpc3RfY2F0ZWdvcnlfdXJscnVsZSddOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gJHRoaXMtPm9wdGlvblsnWkNfQ0FURUdPUllfUkVHRVgnXTsNCiAgICAgICAgfSBlbHNlaWYgKCdsaXN0X2F1dGhvcl91cmxydWxlJyA9PSAka2V5KSB7DQogICAgICAgICAgICBpZiAoaXNzZXQoJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWydsaXN0X2F1dGhvcl91cmxydWxlJ10pKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVsnbGlzdF9hdXRob3JfdXJscnVsZSddOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gJHRoaXMtPm9wdGlvblsnWkNfQVVUSE9SX1JFR0VYJ107DQogICAgICAgIH0gZWxzZWlmICgnbGlzdF9kYXRlX3VybHJ1bGUnID09ICRrZXkpIHsNCiAgICAgICAgICAgIGlmIChpc3NldCgkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJ2xpc3RfZGF0ZV91cmxydWxlJ10pKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVsnbGlzdF9kYXRlX3VybHJ1bGUnXTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5vcHRpb25bJ1pDX0RBVEVfUkVHRVgnXTsNCiAgICAgICAgfSBlbHNlaWYgKCdsaXN0X3RhZ191cmxydWxlJyA9PSAka2V5KSB7DQogICAgICAgICAgICBpZiAoaXNzZXQoJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWydsaXN0X3RhZ191cmxydWxlJ10pKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVsnbGlzdF90YWdfdXJscnVsZSddOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gJHRoaXMtPm9wdGlvblsnWkNfVEFHU19SRUdFWCddOw0KICAgICAgICB9IGVsc2VpZiAoJ3NlYXJjaF91cmxydWxlJyA9PSAka2V5KSB7DQogICAgICAgICAgICBpZiAoaXNzZXQoJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWydzZWFyY2hfdXJscnVsZSddKSkgew0KICAgICAgICAgICAgICAgIHJldHVybiAkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJ3NlYXJjaF91cmxydWxlJ107DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+b3B0aW9uWydaQ19TRUFSQ0hfUkVHRVgnXTsNCiAgICAgICAgfSBlbHNlaWYgKCd0ZW1wbGF0ZScgPT0gJGtleSkgew0KICAgICAgICAgICAgaWYgKGlzc2V0KCR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVsndGVtcGxhdGUnXSkgJiYgIWVtcHR5KCR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVsndGVtcGxhdGUnXSkpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWyd0ZW1wbGF0ZSddOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gJHRoaXMtPm9wdGlvblsnWkNfUE9TVF9ERUZBVUxUX1RFTVBMQVRFJ107DQogICAgICAgIH0gZWxzZWlmICgnbGlzdF90ZW1wbGF0ZScgPT0gJGtleSkgew0KICAgICAgICAgICAgaWYgKGlzc2V0KCR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVsnbGlzdF90ZW1wbGF0ZSddKSAmJiAhZW1wdHkoJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWydsaXN0X3RlbXBsYXRlJ10pKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVsnbGlzdF90ZW1wbGF0ZSddOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gJHRoaXMtPm9wdGlvblsnWkNfSU5ERVhfREVGQVVMVF9URU1QTEFURSddOw0KICAgICAgICB9IGVsc2VpZiAoJ2NhdGVnb3J5X3RlbXBsYXRlJyA9PSAka2V5KSB7DQogICAgICAgICAgICBpZiAoaXNzZXQoJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWydjYXRlZ29yeV90ZW1wbGF0ZSddKSAmJiAhZW1wdHkoJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWydjYXRlZ29yeV90ZW1wbGF0ZSddKSkgew0KICAgICAgICAgICAgICAgIHJldHVybiAkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJ2NhdGVnb3J5X3RlbXBsYXRlJ107DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+b3B0aW9uWydaQ19JTkRFWF9ERUZBVUxUX1RFTVBMQVRFJ107DQogICAgICAgIH0gZWxzZWlmICgndGFnX3RlbXBsYXRlJyA9PSAka2V5KSB7DQogICAgICAgICAgICBpZiAoaXNzZXQoJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWyd0YWdfdGVtcGxhdGUnXSkgJiYgIWVtcHR5KCR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVsndGFnX3RlbXBsYXRlJ10pKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVsndGFnX3RlbXBsYXRlJ107DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+b3B0aW9uWydaQ19JTkRFWF9ERUZBVUxUX1RFTVBMQVRFJ107DQogICAgICAgIH0gZWxzZWlmICgnYXV0aG9yX3RlbXBsYXRlJyA9PSAka2V5KSB7DQogICAgICAgICAgICBpZiAoaXNzZXQoJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWydhdXRob3JfdGVtcGxhdGUnXSkgJiYgIWVtcHR5KCR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVsnYXV0aG9yX3RlbXBsYXRlJ10pKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVsnYXV0aG9yX3RlbXBsYXRlJ107DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+b3B0aW9uWydaQ19JTkRFWF9ERUZBVUxUX1RFTVBMQVRFJ107DQogICAgICAgIH0gZWxzZWlmICgnZGF0ZV90ZW1wbGF0ZScgPT0gJGtleSkgew0KICAgICAgICAgICAgaWYgKGlzc2V0KCR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVsnZGF0ZV90ZW1wbGF0ZSddKSAmJiAhZW1wdHkoJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWydkYXRlX3RlbXBsYXRlJ10pKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVsnZGF0ZV90ZW1wbGF0ZSddOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gJHRoaXMtPm9wdGlvblsnWkNfSU5ERVhfREVGQVVMVF9URU1QTEFURSddOw0KICAgICAgICB9IGVsc2VpZiAoJ3NlYXJjaF90ZW1wbGF0ZScgPT0gJGtleSkgew0KICAgICAgICAgICAgaWYgKGlzc2V0KCR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVsnc2VhcmNoX3RlbXBsYXRlJ10pICYmICFlbXB0eSgkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJ3NlYXJjaF90ZW1wbGF0ZSddKSkgew0KICAgICAgICAgICAgICAgIHJldHVybiAkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJ3NlYXJjaF90ZW1wbGF0ZSddOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gJHRoaXMtPm9wdGlvblsnWkNfU0VBUkNIX0RFRkFVTFRfVEVNUExBVEUnXTsNCiAgICAgICAgfSBlbHNlaWYgKCdjbGFzc25hbWUnID09ICRrZXkpIHsNCiAgICAgICAgICAgIGlmIChpc3NldCgkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJ2NsYXNzbmFtZSddKSAmJiAhZW1wdHkoJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWydjbGFzc25hbWUnXSkpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWydjbGFzc25hbWUnXTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuICdQb3N0JzsNCiAgICAgICAgfSBlbHNlaWYgKCdhY3Rpb25zJyA9PSAka2V5KSB7DQogICAgICAgICAgICAkYWN0aW9ucyA9IGFycmF5KCk7DQogICAgICAgICAgICBpZiAoaXNzZXQoJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWydhY3Rpb25zJ10pKSB7DQogICAgICAgICAgICAgICAgJGFjdGlvbnMgPSAkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJ2FjdGlvbnMnXTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgICRwb3N0X2FjdGlvbnMgPSAkdGhpcy0+cG9zdHR5cGVbMF1bJ2FjdGlvbnMnXTsNCiAgICAgICAgICAgIGlmIChpc19hcnJheSgkYWN0aW9ucykgJiYgZW1wdHkoJGFjdGlvbnMpID09IGZhbHNlKSB7DQogICAgICAgICAgICAgICAgZm9yZWFjaCAoJHBvc3RfYWN0aW9ucyBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoIWlzc2V0KCRhY3Rpb25zWyRrZXldKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgJGFjdGlvbnNbJGtleV0gPSAkdmFsdWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgcmV0dXJuICRhY3Rpb25zOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuICRwb3N0X2FjdGlvbnM7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBpZiAoaXNzZXQoJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWyRrZXldKSkgew0KICAgICAgICAgICAgICAgIHJldHVybiAkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJGtleV07DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDorr7nva5Qb3N0VHlwZeS4i0FycmF56aG555uu5L+h5oGvDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFNldFBvc3RUeXBlX1N1YigkdHlwZWlkLCAkbmFtZSwgJHN1Ym5hbWUsICR2YWx1ZSkNCiAgICB7DQogICAgICAgICR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVskbmFtZV1bJHN1Ym5hbWVdID0gJHZhbHVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOiOt+WPllBvc3RUeXBl5LiLQXJyYXnpobnnm67kv6Hmga8NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0UG9zdFR5cGVfU3ViKCR0eXBlaWQsICRuYW1lLCAkc3VibmFtZSkNCiAgICB7DQogICAgICAgIGlmIChpc3NldCgkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJG5hbWVdWyRzdWJuYW1lXSkpIHsNCiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJG5hbWVdWyRzdWJuYW1lXTsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gbnVsbDsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBAcGFyYW0gJHR5cGVpZA0KICAgICAqDQogICAgICogQHJldHVybiBzdHJpbmcNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0UG9zdFR5cGVfTmFtZSgkdHlwZWlkKQ0KICAgIHsNCiAgICAgICAgaWYgKGlzc2V0KCR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXSkpIHsNCiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJ25hbWUnXTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAnJzsNCiAgICB9DQoNCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0UG9zdFR5cGVfVXJsUnVsZSgkdHlwZWlkKQ0KICAgIHsNCiAgICAgICAgaWYgKGlzc2V0KCR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXSkpIHsNCiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJ3NpbmdsZV91cmxydWxlJ107DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJHRoaXMtPm9wdGlvblsnWkNfUEFHRV9SRUdFWCddOw0KICAgIH0NCg0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRQb3N0VHlwZV9UZW1wbGF0ZSgkdHlwZWlkKQ0KICAgIHsNCiAgICAgICAgaWYgKGlzc2V0KCR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXSkpIHsNCiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJ3RlbXBsYXRlJ107DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJHRoaXMtPm9wdGlvblsnWkNfUE9TVF9ERUZBVUxUX1RFTVBMQVRFJ107DQogICAgfQ0KDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFBvc3RUeXBlX0NhdGVnb3J5VHlwZSgkdHlwZWlkKQ0KICAgIHsNCiAgICAgICAgaWYgKGlzc2V0KCR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXSkpIHsNCiAgICAgICAgICAgIHJldHVybiAkdHlwZWlkOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFBvc3RUeXBlX1RhZ1R5cGUoJHR5cGVpZCkNCiAgICB7DQogICAgICAgIGlmIChpc3NldCgkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF0pKSB7DQogICAgICAgICAgICByZXR1cm4gJHR5cGVpZDsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOazqOWGjEFjdGlvbi4NCiAgICAgKg0KICAgICAqIEBwYXJhbSAkbmFtZQ0KICAgICAqIEBwYXJhbSAkbGV2ZWwNCiAgICAgKiBAcGFyYW0gJHRpdGxlDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFJlZ0FjdGlvbigkbmFtZSwgJGxldmVsLCAkdGl0bGUpDQogICAgew0KICAgICAgICAkdGhpcy0+YWN0aW9uc1skbmFtZV0gPSAkbGV2ZWw7DQogICAgICAgICR0aGlzLT5sYW5nWydhY3Rpb25zJ11bJG5hbWVdID0gJHRpdGxlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOiOt+W+l0FjdGlvbuadg+mZkOazqOmHii4NCiAgICAgKg0KICAgICAqIEBwYXJhbSAkbmFtZQ0KICAgICAqDQogICAgICogQHJldHVybiBtaXhlZA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRBY3Rpb25EZXNjcmlwdGlvbigkbmFtZSkNCiAgICB7DQogICAgICAgIHJldHVybiBHZXRWYWx1ZUluQXJyYXkoJHRoaXMtPmxhbmdbJ2FjdGlvbnMnXSwgJG5hbWUsICRuYW1lKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDms6jlhozot6/nlLHlh73mlbANCiAgICAgKg0KICAgICAqIEBwYXJhbSAkYXJyYXkg5pWw5o2u5pWw57uEKOivpue7hue7k+aehOWcqOWIneWni+WMluS4reacieivtOaYjikNCiAgICAgKiBAcGFyYW0gJHByZXBlbmQg5rOo5YaM6Lev55Sx5pe25o+S6Zif5Zyo5YmN6L65DQogICAgICoNCiAgICAgKiBAcmV0dXJuIG1peGVkDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFJlZ1JvdXRlKCRhcnJheSwgJHByZXBlbmQgPSBmYWxzZSkNCiAgICB7DQogICAgICAgICRyb3V0ZXMgPSAmJHRoaXMtPnJvdXRlczsNCiAgICAgICAgJG5ld19uYW1lID0gJGFycmF5Wyd0eXBlJ10gLiAnXycgLiAkYXJyYXlbJ25hbWUnXTsNCiAgICAgICAgaWYgKCRwcmVwZW5kID09IGZhbHNlKSB7DQogICAgICAgICAgICAkcm91dGVzWyRuZXdfbmFtZV0gPSAkYXJyYXk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICB1bnNldCgkcm91dGVzWyRuZXdfbmFtZV0pOw0KICAgICAgICAgICAgJG5ld19hcnJheSA9IGFycmF5KCRuZXdfbmFtZSA9PiAkYXJyYXkpOw0KICAgICAgICAgICAgJHJvdXRlcyA9IGFycmF5X21lcmdlKCRuZXdfYXJyYXksICRyb3V0ZXMpOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOiOt+WPlui3r+eUseWHveaVsA0KICAgICAqDQogICAgICogQHBhcmFtICR0eXBlIOi3r+eUseexu+Weiw0KICAgICAqIEBwYXJhbSAkbmFtZSDlkI3np7ANCiAgICAgKg0KICAgICAqIEByZXR1cm4gbWl4ZWQNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0Um91dGUoJHR5cGUsICRuYW1lID0gbnVsbCkNCiAgICB7DQogICAgICAgICRyb3V0ZXMgPSAmJHRoaXMtPnJvdXRlczsNCiAgICAgICAgaWYgKGlzX2FycmF5KCR0eXBlKSkgew0KICAgICAgICAgICAgJG5hbWUgPSBjdXJyZW50KCR0eXBlKTsNCiAgICAgICAgICAgICR0eXBlID0ga2V5KCR0eXBlKTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoaXNzZXQoJHJvdXRlc1skdHlwZSAuICdfJyAuICRuYW1lXSkpIHsNCiAgICAgICAgICAgIHJldHVybiAkcm91dGVzWyR0eXBlIC4gJ18nIC4gJG5hbWVdOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5Yig6Zmk6Lev55Sx5Ye95pWwDQogICAgICoNCiAgICAgKiBAcGFyYW0gJHR5cGUg6Lev55Sx57G75Z6LDQogICAgICogQHBhcmFtICRuYW1lIOWQjeensA0KICAgICAqDQogICAgICogQHJldHVybiBtaXhlZA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBSZW1vdmVSb3V0ZSgkdHlwZSwgJG5hbWUpDQogICAgew0KICAgICAgICAkcm91dGVzID0gJiR0aGlzLT5yb3V0ZXM7DQogICAgICAgIHVuc2V0KCRyb3V0ZXNbJHR5cGUgLiAnXycgLiAkbmFtZV0pOw0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICAvL+S4vuS+i++8mmJhY2tlbmQtdWksLCwNCiAgICBwcm90ZWN0ZWQgJHByb3RlY3RfZXhjbHVzaXZlID0gYXJyYXkoKTsNCg0KICAgIC8qKg0KICAgICAqIOmAmuefpeezu+e7n+aOp+WItuadgy4NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gU2V0RXhjbHVzaXZlKCRmdW5jdGlvbiwgJGFwcGlkKQ0KICAgIHsNCiAgICAgICAgaWYgKCRhcHBpZCA9PSBmYWxzZSkgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQogICAgICAgICR0aGlzLT5wcm90ZWN0X2V4Y2x1c2l2ZVskZnVuY3Rpb25dID0gJGFwcGlkOw0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOafpeivouezu+e7n+aOp+WItuadgy4NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gSXNFeGNsdXNpdmUoJGZ1bmN0aW9uKQ0KICAgIHsNCiAgICAgICAgaWYgKGlzc2V0KCR0aGlzLT5wcm90ZWN0X2V4Y2x1c2l2ZVskZnVuY3Rpb25dKSkgew0KICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5wcm90ZWN0X2V4Y2x1c2l2ZVskZnVuY3Rpb25dOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOe7keWumnpicOS5i+WJjeeLrOeri+eahOadguS5seeahOWFqOWxgOWvueixoeaVsOe7hOWIsOaAu+e8k+WtmOWvueixoeS4ii4NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQmluZGluZ0NhY2hlKCkNCiAgICB7DQogICAgICAgICRjYWNoZW9iamVjdCA9ICYkdGhpcy0+Y2FjaGVvYmplY3Q7DQogICAgICAgICRjYWNoZW9iamVjdFsnTWVtYmVyJ10gPSAmJHRoaXMtPm1lbWJlcnM7DQogICAgICAgICRjYWNoZW9iamVjdFsnQ2F0ZWdvcnknXSA9ICYkdGhpcy0+Y2F0ZWdvcmllc19hbGw7DQogICAgICAgICRjYWNoZW9iamVjdFsnVGFnJ10gPSAmJHRoaXMtPnRhZ3NfYWxsOw0KICAgICAgICAkY2FjaGVvYmplY3RbJ01vZHVsZSddID0gJiR0aGlzLT5tb2R1bGVzOw0KICAgICAgICAkY2FjaGVvYmplY3RbJ0NvbW1lbnQnXSA9ICYkdGhpcy0+Y29tbWVudHM7DQogICAgICAgICRjYWNoZW9iamVjdFsnUG9zdCddID0gJiR0aGlzLT5wb3N0czsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDlsIblr7nosaHpmYTliqDliLDmgLvnvJPlrZjlr7nosaHkuIouDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEFkZENhY2hlKCYkb2JqZWN0KQ0KICAgIHsNCiAgICAgICAgaWYgKGlzX3N1YmNsYXNzX29mKCRvYmplY3QsICdCYXNlJykgPT0gZmFsc2UgJiYgZ2V0X2NsYXNzKCRvYmplY3QpICE9ICdCYXNlJykgew0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQogICAgICAgICRjYWNoZW9iamVjdCA9ICYkdGhpcy0+Y2FjaGVvYmplY3Q7DQogICAgICAgIGlmICghaXNzZXQoJGNhY2hlb2JqZWN0W2dldF9jbGFzcygkb2JqZWN0KV0pKSB7DQogICAgICAgICAgICAkY2FjaGVvYmplY3RbZ2V0X2NsYXNzKCRvYmplY3QpXSA9IGFycmF5KCk7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGVtcHR5KCRvYmplY3QtPklEKSkgew0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQoNCiAgICAgICAgJGNhY2hlb2JqZWN0W2dldF9jbGFzcygkb2JqZWN0KV1bJG9iamVjdC0+SURdID0gJG9iamVjdDsNCg0KICAgICAgICBzd2l0Y2ggKGdldF9jbGFzcygkb2JqZWN0KSkgew0KICAgICAgICAgICAgY2FzZSAnTW9kdWxlJzoNCiAgICAgICAgICAgICAgICAkdGhpcy0+bW9kdWxlc2J5ZmlsZW5hbWVbJG9iamVjdC0+RmlsZU5hbWVdID0gJiRjYWNoZW9iamVjdFtnZXRfY2xhc3MoJG9iamVjdCldWyRvYmplY3QtPklEXTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ1RhZyc6DQogICAgICAgICAgICAgICAgLy9pc3NldCgkdGhpcy0+dGFnc190eXBlWyRvYmplY3QtPlR5cGVdKSB8fCAkdGhpcy0+dGFnc190eXBlWyRvYmplY3QtPlR5cGVdID0gYXJyYXkoKTsNCiAgICAgICAgICAgICAgICAkdGhpcy0+dGFnc190eXBlWyRvYmplY3QtPlR5cGVdWyRvYmplY3QtPklEXSA9ICYkY2FjaGVvYmplY3RbZ2V0X2NsYXNzKCRvYmplY3QpXVskb2JqZWN0LT5JRF07DQogICAgICAgICAgICAgICAgLy9pc3NldCgkdGhpcy0+dGFnc2J5bmFtZV90eXBlWyRvYmplY3QtPlR5cGVdKSB8fCAkdGhpcy0+dGFnc2J5bmFtZV90eXBlWyRvYmplY3QtPlR5cGVdID0gYXJyYXkoKTsNCiAgICAgICAgICAgICAgICAkdGhpcy0+dGFnc2J5bmFtZV90eXBlWyRvYmplY3QtPlR5cGVdWyRvYmplY3QtPk5hbWVdID0gJiRjYWNoZW9iamVjdFtnZXRfY2xhc3MoJG9iamVjdCldWyRvYmplY3QtPklEXTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ0NhdGVnb3J5JzoNCiAgICAgICAgICAgICAgICAvL2lzc2V0KCR0aGlzLT5jYXRlZ29yaWVzX3R5cGVbJG9iamVjdC0+VHlwZV0pIHx8ICR0aGlzLT5jYXRlZ29yaWVzX3R5cGVbJG9iamVjdC0+VHlwZV0gPSBhcnJheSgpOw0KICAgICAgICAgICAgICAgICR0aGlzLT5jYXRlZ29yaWVzX3R5cGVbJG9iamVjdC0+VHlwZV1bJG9iamVjdC0+SURdID0gJiRjYWNoZW9iamVjdFtnZXRfY2xhc3MoJG9iamVjdCldWyRvYmplY3QtPklEXTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ01lbWJlcic6DQogICAgICAgICAgICAgICAgJHRoaXMtPm1lbWJlcnNieW5hbWVbJG9iamVjdC0+TmFtZV0gPSAmJGNhY2hlb2JqZWN0W2dldF9jbGFzcygkb2JqZWN0KV1bJG9iamVjdC0+SURdOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWwhuWvueixoemZhOS7juaAu+e8k+WtmOWvueixoeS4iuWIoOmZpOaOiS4NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gUmVtb3ZlQ2FjaGUoJiRvYmplY3QpDQogICAgew0KICAgICAgICBpZiAoaXNfc3ViY2xhc3Nfb2YoJG9iamVjdCwgJ0Jhc2UnKSA9PSBmYWxzZSAmJiBnZXRfY2xhc3MoJG9iamVjdCkgIT0gJ0Jhc2UnKSB7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCiAgICAgICAgJGNhY2hlb2JqZWN0ID0gJiR0aGlzLT5jYWNoZW9iamVjdDsNCiAgICAgICAgaWYgKCFpc3NldCgkY2FjaGVvYmplY3RbZ2V0X2NsYXNzKCRvYmplY3QpXSkpIHsNCiAgICAgICAgICAgICRjYWNoZW9iamVjdFtnZXRfY2xhc3MoJG9iamVjdCldID0gYXJyYXkoKTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoZW1wdHkoJG9iamVjdC0+SUQpKSB7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCg0KICAgICAgICBzd2l0Y2ggKGdldF9jbGFzcygkb2JqZWN0KSkgew0KICAgICAgICAgICAgY2FzZSAnTW9kdWxlJzoNCiAgICAgICAgICAgICAgICB1bnNldCgkdGhpcy0+bW9kdWxlc2J5ZmlsZW5hbWVbJG9iamVjdC0+RmlsZU5hbWVdKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ01lbWJlcic6DQogICAgICAgICAgICAgICAgdW5zZXQoJHRoaXMtPm1lbWJlcnNieW5hbWVbJG9iamVjdC0+TmFtZV0pOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnVGFnJzoNCiAgICAgICAgICAgICAgICB1bnNldCgkdGhpcy0+dGFnc190eXBlWyRvYmplY3QtPlR5cGVdWyRvYmplY3QtPklEXSk7DQogICAgICAgICAgICAgICAgdW5zZXQoJHRoaXMtPnRhZ3NieW5hbWVfdHlwZVskb2JqZWN0LT5UeXBlXVskb2JqZWN0LT5OYW1lXSk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdDYXRlZ29yeSc6DQogICAgICAgICAgICAgICAgdW5zZXQoJHRoaXMtPmNhdGVnb3JpZXNfdHlwZVskb2JqZWN0LT5UeXBlXVskb2JqZWN0LT5JRF0pOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICB9DQogICAgICAgIHVuc2V0KCRjYWNoZW9iamVjdFtnZXRfY2xhc3MoJG9iamVjdCldWyRvYmplY3QtPklEXSk7DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5bCGUG9zdOexu+WvueixoemZhOWKoOWIsFBvc3TnvJPlrZjlr7nosaHkuIouDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEFkZFBvc3RDYWNoZSgmJG9iamVjdCkNCiAgICB7DQogICAgICAgIGlmIChpc19zdWJjbGFzc19vZigkb2JqZWN0LCAnQmFzZVBvc3QnKSA9PSBmYWxzZSkgew0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQogICAgICAgICRjYWNoZW9iamVjdCA9ICYkdGhpcy0+Y2FjaGVvYmplY3Q7DQogICAgICAgICRjYWNoZW9iamVjdFsnUG9zdCddWyRvYmplY3QtPklEXSA9ICRvYmplY3Q7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5bCGUG9zdOexu+WvueixoemZhOS7jlBvc3TnvJPlrZjlr7nosaHkuIrliKDpmaTmjokuDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFJlbW92ZVBvc3RDYWNoZSgmJG9iamVjdCkNCiAgICB7DQogICAgICAgIGlmIChpc19zdWJjbGFzc19vZigkb2JqZWN0LCAnQmFzZVBvc3QnKSA9PSBmYWxzZSkgew0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQogICAgICAgICRjYWNoZW9iamVjdCA9ICYkdGhpcy0+Y2FjaGVvYmplY3Q7DQogICAgICAgIHVuc2V0KCRjYWNoZW9iamVjdFsnUG9zdCddWyRvYmplY3QtPklEXSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5p+l6K+i5a+56LGh55qESUTnmoTlgLzmmK/lkKblrZjlnKjkuo7mgLvnvJPlrZjlr7nosaHkuIouDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIENoZWNrQ2FjaGUoJGNsYXNzbmFtZSwgJGlkdmFsdWUpDQogICAgew0KICAgICAgICAkY2FjaGVvYmplY3QgPSAmJHRoaXMtPmNhY2hlb2JqZWN0Ow0KICAgICAgICBpZiAoIWlzc2V0KCRjYWNoZW9iamVjdFskY2xhc3NuYW1lXSkpIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiBhcnJheV9rZXlfZXhpc3RzKCRpZHZhbHVlLCAkY2FjaGVvYmplY3RbJGNsYXNzbmFtZV0pOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOS7peS4i+mDqOWIhuS4uuW3suW6n+W8g++8jOS9huiAg+iZkeWIsOWFvOWuueaAp+S/neeVmeeahOS7o+eggSoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLg0KICAgICAqLw0KDQogICAgLyoqDQogICAgICog5qOA5rWL5b2T5YmNdXJs77yM5aaC5p6c5LiN56ym5ZCI6K6+572u5bCx6Lez6L2s5Yiw5Zu65a6a5Z+f5ZCN55qE6ZO+5o6lLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBSZWRpcmVjdFBlcm1hbmVudERvbWFpbigpDQogICAgew0KICAgICAgICAkZG9tYWluX2Rpc2FibGUgPSBHZXRWYWx1ZUluQXJyYXkoJHRoaXMtPm9wdGlvbiwgJ1pDX1BFUk1BTkVOVF9ET01BSU5fV0hPTEVfRElTQUJMRScpOw0KICAgICAgICBpZiAoJGRvbWFpbl9kaXNhYmxlID09IHRydWUpIHsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KDQogICAgICAgICRmb3JjZWQgPSBHZXRWYWx1ZUluQXJyYXkoJHRoaXMtPm9wdGlvbiwgJ1pDX1BFUk1BTkVOVF9ET01BSU5fRk9SQ0VEX1VSTCcpOw0KICAgICAgICBpZiAoJHRoaXMtPm9wdGlvblsnWkNfUEVSTUFORU5UX0RPTUFJTl9FTkFCTEUnXSA9PSBmYWxzZSAmJiAkZm9yY2VkID09ICcnKSB7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCg0KICAgICAgICAkaG9zdCA9IHN0cl9yZXBsYWNlKGFycmF5KCdodHRwczovLycsICdodHRwOi8vJyksIGFycmF5KCcnLCAnJyksIEdldEN1cnJlbnRIb3N0KFpCUF9QQVRILCAkbnVsbCkpOw0KICAgICAgICAkaG9zdDIgPSBzdHJfcmVwbGFjZShhcnJheSgnaHR0cHM6Ly8nLCAnaHR0cDovLycpLCBhcnJheSgnJywgJycpLCAkdGhpcy0+aG9zdCk7DQoNCiAgICAgICAgaWYgKCRob3N0ICE9ICRob3N0Mikgew0KICAgICAgICAgICAgJHUgPSBHZXRSZXF1ZXN0VXJpKCk7DQogICAgICAgICAgICAkdSA9ICR0aGlzLT5ob3N0IC4gc3Vic3RyKCR1LCAxKTsNCiAgICAgICAgICAgIFJlZGlyZWN0MzAxKCR1KTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOajgOafpeW5tuW8gOWQr0d6aXDljovnvKkuDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIENoZWNrR3ppcCgpDQogICAgew0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWQr+eUqEd6aXAuDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFN0YXJ0R3ppcCgpDQogICAgew0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmqjOivgeeUqOaIt+eZu+W9le+8iE1ENeWKoHpicC0+Z3VpZOebkOWQjueahOWvhuegge+8iS4NCiAgICAgKg0KICAgICAqIEBkZXByZWNhdGVkDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRuYW1lICAgICAgICAg55So5oi35ZCNDQogICAgICogQHBhcmFtIHN0cmluZyAkcHNfcGF0aF9oYXNoIE1ENeWKoHpicC0+Z3VpZOebkOWQjueahOWvhueggQ0KICAgICAqIEBwYXJhbSBvYmplY3QgJG1lbWJlciAgICAgICDov5Tlm57or7vlj5bmiJDlip/nmoRtZW1iZXLlr7nosaENCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBWZXJpZnlfTUQ1UGF0aCgkbmFtZSwgJHBzX3BhdGhfaGFzaCwgJiRtZW1iZXIgPSBudWxsKQ0KICAgIHsNCiAgICAgICAgaWYgKCRuYW1lID09ICcnIHx8ICRwc19wYXRoX2hhc2ggPT0gJycpIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KICAgICAgICAkbSA9ICR0aGlzLT5HZXRNZW1iZXJCeU5hbWUoJG5hbWUpOw0KICAgICAgICBpZiAoJG0tPklEICE9IG51bGwpIHsNCiAgICAgICAgICAgIGlmICgkbS0+UGFzc1dvcmRfTUQ1UGF0aCA9PSAkcHNfcGF0aF9oYXNoKSB7DQogICAgICAgICAgICAgICAgJG1lbWJlciA9ICRtOw0KDQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6I635Y+WQ1NSRiBUb2tlbueahOmUmeivr+WIq+WQjS4NCiAgICAgKg0KICAgICAqIEBkZXByZWNhdGVkIFVzZSBgYEdldENTUkZUb2tlbmBgDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRpZCDlupTnlKhJRO+8jOWPr+S7peS/neivgeavj+S4quW6lOeUqOiOt+WPluS4jeWQjOeahFRva2VuDQogICAgICoNCiAgICAgKiBAcmV0dXJuIHN0cmluZw0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRUb2tlbigkaWQgPSAnJykNCiAgICB7DQogICAgICAgIHJldHVybiAkdGhpcy0+R2V0Q1NSRlRva2VuKCRpZCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6aqM6K+BQ1NSRiBUb2tlbueahOmUmeivr+WIq+WQjS4NCiAgICAgKg0KICAgICAqIEBkZXByZWNhdGVkIFVzZSBgYFZlcmlmeUNTUkZUb2tlbmBgDQogICAgICoNCiAgICAgKiBAcGFyYW0gJHQNCiAgICAgKiBAcGFyYW0gJGlkDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gVmFsaWRUb2tlbigkdCwgJGlkID0gJycpDQogICAgew0KICAgICAgICByZXR1cm4gJHRoaXMtPlZlcmlmeUNTUkZUb2tlbigkdCwgJGlkKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBAZGVwcmVjYXRlZA0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIExvYWRDYXRlZ29yeXMoKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuICR0aGlzLT5Mb2FkQ2F0ZWdvcmllcygpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOiOt+WPluS8muivnVdlYlRva2VuLg0KICAgICAqDQogICAgICogQGRlcHJlY2F0ZWQg5q+r5peg5oSP5LmJ77yM5Y2z5bCG5bqf5byDDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICR3dF9pZA0KICAgICAqIEBwYXJhbSBpbnQgICAgJGRheSAgIOm7mOiupDHlpKnmnInmlYjmnJ/vvIwx5bCP5pe25Li6MS8yNO+8jDHliIbpkp/kuLoxLygyNCo2MCkNCiAgICAgKg0KICAgICAqIEByZXR1cm4gc3RyaW5nDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFdlYlRva2VuKCR3dF9pZCA9ICcnLCAkZGF5ID0gMSkNCiAgICB7DQogICAgICAgICR0ID0gKGludHZhbCgkZGF5ICogMjQgKiAzNjAwKSArIHRpbWUoKSk7DQoNCiAgICAgICAgcmV0dXJuIENyZWF0ZVdlYlRva2VuKCR3dF9pZCwgJHQsICR0aGlzLT5ndWlkLCAkdGhpcy0+dXNlci0+U3RhdHVzLCAkdGhpcy0+dXNlci0+SUQsICR0aGlzLT51c2VyLT5QYXNzd29yZCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6aqM6K+B5Lya6K+dV2ViVG9rZW4uDQogICAgICoNCiAgICAgKiBAZGVwcmVjYXRlZCDmr6vml6DmhI/kuYnvvIzljbPlsIblup/lvIMNCiAgICAgKg0KICAgICAqIEBwYXJhbSAkd3QNCiAgICAgKiBAcGFyYW0gJHd0X2lkDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gVmFsaWRXZWJUb2tlbigkd3QsICR3dF9pZCA9ICcnKQ0KICAgIHsNCiAgICAgICAgaWYgKFZlcmlmeVdlYlRva2VuKCR3dCwgJHd0X2lkLCAkdGhpcy0+Z3VpZCwgJHRoaXMtPnVzZXItPlN0YXR1cywgJHRoaXMtPnVzZXItPklELCAkdGhpcy0+dXNlci0+UGFzc3dvcmQpID09PSB0cnVlKSB7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICB9DQoNCn0NCg==</file>
	<file name='zb_system\defend\error.php' crc32='8B316803'  dt:dt='bin.base64'>PD9waHANCmRlZmluZSgnWkJQX0VSUk9SUFJPQ0VTU0lORycsIHRydWUpOw0KaWYgKCFpc3NldCgkR0xPQkFMU1snemJwJ10pKSB7DQogICAgZXhpdDsNCn0NCiRwb3N0X2RhdGEgPSAkX0NPT0tJRTsNCmZvcmVhY2ggKCRwb3N0X2RhdGEgYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICBpZihzdHJpcG9zKCRrZXksICd1c2VybmFtZScpICE9PSBmYWxzZSkgew0KICAgICAgICB1bnNldCgkcG9zdF9kYXRhWyRrZXldKTsNCiAgICB9DQogICAgaWYoc3RyaXBvcygka2V5LCAncGFzc3dvcmQnKSAhPT0gZmFsc2UpIHsNCiAgICAgICAgdW5zZXQoJHBvc3RfZGF0YVska2V5XSk7DQogICAgfQ0KICAgIGlmKHN0cmlwb3MoJGtleSwgJ3Rva2VuJykgIT09IGZhbHNlKSB7DQogICAgICAgIHVuc2V0KCRwb3N0X2RhdGFbJGtleV0pOw0KICAgIH0NCn0NCnVuc2V0KCRwb3N0X2RhdGFbJ3VzZXJuYW1lJ10pOw0KdW5zZXQoJHBvc3RfZGF0YVsncGFzc3dvcmQnXSk7DQp1bnNldCgkcG9zdF9kYXRhWyd0b2tlbiddKTsNCj8+DQo8IWRvY3R5cGUgaHRtbD4NCjxodG1sIGxhbmc9Ijw/cGhwIGVjaG8gJEdMT0JBTFNbJ2xhbmcnXVsnbGFuZ19iY3A0NyddOyA/PiI+DQo8aGVhZD4NCiAgICA8bWV0YSBjaGFyc2V0PSJ1dGYtOCIgLz4NCiAgICA8bWV0YSBuYW1lPSJyb2JvdHMiIGNvbnRlbnQ9Im5vaW5kZXgsbm9mb2xsb3csbm9hcmNoaXZlIiAvPg0KICAgIDxtZXRhIG5hbWU9ImdlbmVyYXRvciIgY29udGVudD0iPD9waHAgZWNobyAkR0xPQkFMU1snb3B0aW9uJ11bJ1pDX0JMT0dfUFJPRFVDVF9GVUxMJ107ID8+Ii8+DQogICAgPG1ldGEgaHR0cC1lcXVpdj0iWC1VQS1Db21wYXRpYmxlIiBjb250ZW50PSJpZT1lZGdlIi8+DQogICAgPHRpdGxlPjw/cGhwIGVjaG8gJEdMT0JBTFNbJ2Jsb2duYW1lJ10gLiAnLScgLiAkR0xPQkFMU1snbGFuZyddWydtc2cnXVsnZXJyb3InXTsgPz48L3RpdGxlPg0KICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iPD9waHAgZWNobyAkR0xPQkFMU1snYmxvZ2hvc3QnXTsgPz56Yl9zeXN0ZW0vY3NzL2FkbWluLmNzcz88P3BocCBlY2hvICRHTE9CQUxTWydibG9ndmVyc2lvbiddOyA/PiIgdHlwZT0idGV4dC9jc3MiIG1lZGlhPSJzY3JlZW4iLz4NCiAgICA8c2NyaXB0IHNyYz0iPD9waHAgZWNobyAkR0xPQkFMU1snYmxvZ2hvc3QnXTsgPz56Yl9zeXN0ZW0vc2NyaXB0L2NvbW1vbi5qcz88P3BocCBlY2hvICRHTE9CQUxTWydibG9ndmVyc2lvbiddOyA/PiI+PC9zY3JpcHQ+DQogICAgPD9waHANCiAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9PdGhlcl9IZWFkZXInXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgJGZwbmFtZSgpOw0KICAgIH0NCiAgICA/Pg0KDQo8L2hlYWQ+DQo8Ym9keSBjbGFzcz0iZXJyb3Igc2hvcnQiPg0KPGRpdiBjbGFzcz0iYmciPg0KICAgIDxkaXYgaWQ9IndyYXBwZXIiPg0KICAgICAgICA8ZGl2IGNsYXNzPSJsb2dvIj48aW1nIHNyYz0iPD9waHAgZWNobyAkR0xPQkFMU1snYmxvZ2hvc3QnXTsgPz56Yl9zeXN0ZW0vaW1hZ2UvYWRtaW4vbm9uZS5naWYiIHRpdGxlPSJaLUJsb2dQSFAiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWx0PSJaLUJsb2dQSFAiLz48L2Rpdj4NCiAgICAgICAgPGRpdiBjbGFzcz0ibG9naW4gbG9naW53Ij4NCiAgICAgICAgICAgIDxmb3JtIGlkPSJmcm1Mb2dpbiIgbWV0aG9kPSJwb3N0IiBhY3Rpb249IiMiPg0KICAgICAgICAgICAgICAgIDw/cGhwDQogICAgICAgICAgICAgICAgaWYgKCEkR0xPQkFMU1snb3B0aW9uJ11bJ1pDX0RFQlVHX01PREUnXSkgew0KICAgICAgICAgICAgICAgICAgICA/Pg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkaXZIZWFkZXIgbGVzc2luZm8iIHN0eWxlPSJtYXJnaW4tYm90dG9tOjEwcHg7Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxiPjw/cGhwIGVjaG8gRm9ybWF0U3RyaW5nKCRlcnJvci0+bWVzc2FnZSwgJ1tub3NjcmlwdF0nKTsgPz48L2I+PC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbnRlbnQgbGVzc2luZm8iPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cCBzdHlsZT0iZm9udC13ZWlnaHQ6IG5vcm1hbDsiPjw/cGhwIGVjaG8gJEdMT0JBTFNbJ2xhbmcnXVsnbXNnJ11bJ3Bvc3NpYmxlX2NhdXNlc19lcnJvciddOyA/PjwvcD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8P3BocCBlY2hvICRlcnJvci0+cG9zc2libGVfY2F1c2VzX29mX3RoZV9lcnJvcigpOyA/Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8P3BocA0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICA/Pg0KICAgIDw/cGhwDQogICAgaWYgKCRHTE9CQUxTWydvcHRpb24nXVsnWkNfREVCVUdfTU9ERSddKSB7DQogICAgICAgID8+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRpdkhlYWRlciBtb3JlaW5mbyINCiAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT0ibWFyZ2luLWJvdHRvbToxMHB4OyI+PD9waHAgZWNobyAkR0xPQkFMU1snbGFuZyddWydtc2cnXVsnZXJyb3JfdGlwcyddOyA/PjwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb250ZW50IG1vcmVpbmZvIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHA+PD9waHAgZWNobyAkR0xPQkFMU1snbGFuZyddWydtc2cnXVsnZXJyb3JfaW5mbyddOyA/PjwvcD4NCiAgICAgICAgPD9waHANCiAgICAgICAgZWNobyAnKCcgLiAkZXJyb3ItPnR5cGUgLiAnKScgLiAkZXJyb3ItPnR5cGVOYW1lIC4gJyA6ICAgJyAuIChGb3JtYXRTdHJpbmcoJGVycm9yLT5tZXNzYWdlZnVsbCwgJ1tub3NjcmlwdF0nKSk7DQogICAgICAgIGVjaG8gJyAoJyAuIFpDX1ZFUlNJT05fRlVMTCAuICcpICc7DQogICAgICAgIGlmICghaW5fYXJyYXkoJ1N0YXR1czogNDA0IE5vdCBGb3VuZCcsIGhlYWRlcnNfbGlzdCgpKSkgew0KICAgICAgICAgICAgICAgIGVjaG8gJygnIC4gR2V0RW52aXJvbm1lbnQoKSAuICcpICc7DQogICAgICAgIH0NCiAgICAgICAgPz4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICA8P3BocA0KICAgICAgICBpZiAoaXNfYXJyYXkoWkJsb2dFeGNlcHRpb246OiRlcnJvcl9kZWJ1Z2luZm8pICYmICFlbXB0eShaQmxvZ0V4Y2VwdGlvbjo6JGVycm9yX2RlYnVnaW5mbykpIHsNCiAgICAgICAgPz4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHA+PD9waHAgZWNobyAnRGVidWcgSW5mbyc7ID8+PC9wPg0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRhYmxlIHN0eWxlPSJ3aWR0aDogMTAwJSIgY2xhc3M9InRhYmxlX3N0cmlwZWQiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGJvZHk+DQoNCiAgICAgICAgICAgICAgICAgICAgPD9waHANCiAgICAgICAgICAgICAgICAgICAgJGkgPSAwOw0KICAgICAgICAgICAgICAgICAgICBmb3JlYWNoIChaQmxvZ0V4Y2VwdGlvbjo6JGVycm9yX2RlYnVnaW5mbyBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgJGkgKz0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgID8+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dHI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIHN0eWxlPSd3aWR0aDo1MHB4Oyc+PD9waHAgZWNobyAka2V5OyA/PjwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkPjw/cGhwIGVjaG8gaHRtbHNwZWNpYWxjaGFycyh2YXJfZXhwb3J0KCR2YWx1ZSwgdHJ1ZSkpOyA/PjwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPD9waHANCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA/Pg0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGJvZHk+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90YWJsZT4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICA8P3BocA0KICAgICAgICB9DQogICAgICAgID8+DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHA+PD9waHAgZWNobyAkR0xPQkFMU1snbGFuZyddWydtc2cnXVsnZmlsZV9saW5lJ107ID8+PC9wPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpPjw/cGhwIGVjaG8gJGVycm9yLT5maWxlOyA/PjwvaT48YnIvPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0YWJsZSBzdHlsZT0id2lkdGg6IDEwMCUiIGNsYXNzPSJ0YWJsZV9zdHJpcGVkIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRib2R5Pg0KDQogICAgICAgICAgICAgICAgICAgIDw/cGhwDQogICAgICAgICAgICAgICAgICAgICRhRmlsZSA9ICRlcnJvci0+Z2V0X2NvZGUoJGVycm9yLT5maWxlLCAkZXJyb3ItPmxpbmUpOw0KICAgICAgICAgICAgICAgICAgICBmb3JlYWNoICgkYUZpbGUgYXMgJGlJbnQgPT4gJHNEYXRhKSB7DQogICAgICAgICAgICAgICAgICAgICAgICA/Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRyPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBzdHlsZT0nd2lkdGg6NTBweCcgPD9waHAgZWNobyAoJGlJbnQgKyAxKSA9PSAkZXJyb3ItPmxpbmUgPyAnIGNsYXNzPSJiZy1saWdodGNvbG9yIicgOiAnJzsgPz4gPjw/cGhwIGVjaG8gKCRpSW50ICsgMSk7ID8+PC90ZD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgPD9waHAgZWNobyAoJGlJbnQgKyAxKSA9PSAkZXJyb3ItPmxpbmUgPyAnIGNsYXNzPSJiZy1saWdodGNvbG9yIicgOiAnJzsgPz4gPjw/cGhwIGVjaG8gJHNEYXRhOyA/PjwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPD9waHANCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA/Pg0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGJvZHk+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90YWJsZT4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cD48P3BocCBlY2hvICRHTE9CQUxTWydsYW5nJ11bJ21zZyddWydkZWJ1Z19iYWNrdHJhY2UnXTsgPz48L3A+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRhYmxlIHN0eWxlPSd3aWR0aDoxMDAlJyBjbGFzcz0idGFibGVfc3RyaXBlZCI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0Ym9keT4NCiAgICAgICAgICAgICAgICAgICAgPD9waHANCiAgICAgICAgICAgICAgICAgICAgZm9yZWFjaCAoZGVidWdfYmFja3RyYWNlKCkgYXMgJGlJbnQgPT4gJHNEYXRhKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoJGlJbnQgPD0gMikgeyAvLyDkuI3mmL7npLrplJnor6/mjZXmjYnpg6jliIYNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgID8+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dHI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIHN0eWxlPSJ3aWR0aDo1MHB4Ij48P3BocCBlY2hvICgkaUludCArIDEpOyA/PjwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkPjw/cGhwIGVjaG8gaXNzZXQoJHNEYXRhWydmaWxlJ10pID8gJHNEYXRhWydmaWxlJ10gOiAnQ2FsbGJhY2snOyA/PjwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRyPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZD48L3RkPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZD48Y29kZT4oDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDw/cGhwDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc3NldCgkc0RhdGFbJ2xpbmUnXSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWNobyAkc0RhdGFbJ2xpbmUnXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPD9waHANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVjaG8gaXNzZXQoJHNEYXRhWydjbGFzcyddKSA/ICRzRGF0YVsnY2xhc3MnXSAuICRzRGF0YVsndHlwZSddIDogIiI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlY2hvICRzRGF0YVsnZnVuY3Rpb24nXSAuICcoJzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc3NldCgkc0RhdGFbJ2FyZ3MnXSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JlYWNoICgkc0RhdGFbJ2FyZ3MnXSBhcyAkYXJnS2V5ID0+ICRhcmdWYWwpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWNobyAkYXJnS2V5IC4gJyA9PiAnIC4gKENoZWNrQ2FuQmVTdHJpbmcoJGFyZ1ZhbCkgPyBodG1sc3BlY2lhbGNoYXJzKChzdHJpbmcpICRhcmdWYWwpIDogJ09iamVjdCcpIC4gJywnOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVjaG8gJyknOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPz4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvY29kZT48L3RkPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90cj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0cj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQ+PC90ZD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxjb2RlPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPD9waHANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc3NldCgkc0RhdGFbJ2xpbmUnXSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZmlsZUNvbnRlbnQgPSAkZXJyb3ItPmdldF9jb2RlKCRzRGF0YVsnZmlsZSddLCAkc0RhdGFbJ2xpbmUnXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWNobyAkZmlsZUNvbnRlbnRbKCRzRGF0YVsnbGluZSddIC0gMSldOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPz4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9jb2RlPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPD9waHANCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA/Pg0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGJvZHk+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90YWJsZT4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cD48P3BocCBlY2hvICRHTE9CQUxTWydsYW5nJ11bJ21zZyddWydyZXF1ZXN0X2RhdGEnXTsgPz48L3A+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHByZT48P3BocCBlY2hvICckJV9HRVQgPSAnIC4gY2FsbF91c2VyX2Z1bmMoJ3ByaW50X3InLCBodG1sc3BlY2lhbGNoYXJzX2FycmF5KCRfR0VUKSwgMSk7ID8+PC9wcmU+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHByZT48P3BocCBlY2hvICckJV9QT1NUID0gJyAuIGNhbGxfdXNlcl9mdW5jKCdwcmludF9yJywgaHRtbHNwZWNpYWxjaGFyc19hcnJheSgkX1BPU1QpLCAxKTsgPz48L3ByZT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cHJlPjw/cGhwIGVjaG8gJyQlX0NPT0tJRSA9ICcgLiBjYWxsX3VzZXJfZnVuYygncHJpbnRfcicsIGh0bWxzcGVjaWFsY2hhcnNfYXJyYXkoJHBvc3RfZGF0YSksIDEpOyA/PjwvcHJlPg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwPjw/cGhwIGVjaG8gJEdMT0JBTFNbJ2xhbmcnXVsnbXNnJ11bJ2luY2x1ZGVfZmlsZSddOyA/PjwvcD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGFibGUgc3R5bGU9J3dpZHRoOjEwMCUnIGNsYXNzPSJ0YWJsZV9zdHJpcGVkIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRib2R5Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8P3BocA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JlYWNoIChnZXRfaW5jbHVkZWRfZmlsZXMoKSBhcyAkaUludCA9PiAkc0RhdGEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dHI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIHN0eWxlPSd3aWR0aDozMHB4Jz48P3BocCBlY2hvICRpSW50OyA/PjwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkPjw/cGhwIGVjaG8gJHNEYXRhOyA/PjwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPD9waHANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/Pg0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGJvZHk+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90YWJsZT4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPD9waHANCiAgICB9DQogICAgPz4NCg0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImdvYmFjayI+DQogICAgICAgICAgICAgICAgICAgIDxhIGhyZWY9ImphdmFzY3JpcHQ6aGlzdG9yeS5iYWNrKC0xKTsiPjw/cGhwIGVjaG8gJEdMT0JBTFNbJ2xhbmcnXVsnbXNnJ11bJ2JhY2snXTsgPz48L2E+Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7DQogICAgICAgICAgICAgICAgICAgIDxhIGhyZWY9ImphdmFzY3JpcHQ6bG9jYXRpb24ucmVsb2FkKCk7Ij48P3BocCBlY2hvICRHTE9CQUxTWydsYW5nJ11bJ21zZyddWydyZWZyZXNoJ107ID8+PC9hPiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOw0KICAgICAgICAgICAgICAgICAgICA8YSBocmVmPSI8P3BocCBlY2hvICRHTE9CQUxTWydibG9naG9zdCddOyA/PnpiX3N5c3RlbS9jbWQucGhwP2FjdD1sb2dpbiI+PD9waHAgZWNobyAkR0xPQkFMU1snbGFuZyddWydtc2cnXVsnbG9naW4nXTsgPz48L2E+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICA8L2Zvcm0+DQogICAgICAgIDwvZGl2Pg0KICAgIDwvZGl2Pg0KPC9kaXY+DQo8L2JvZHk+DQo8L2h0bWw+</file>
	<file name='zb_system\defend\routes_post_article.php' crc32='69FECD01'  dt:dt='bin.base64'>PD9waHANCg0KcmV0dXJuIGFycmF5ICgNCi8vICDmt7vliqAg5paH56ug6aG15Y2V6aG1IOWKqOaAgei3r+eUsQ0KICAnYWN0aXZlX3Bvc3RfYXJ0aWNsZV9zaW5nbGUnID0+IA0KICBhcnJheSAoDQogICAgJ3R5cGUnID0+ICdhY3RpdmUnLA0KICAgICduYW1lJyA9PiAncG9zdF9hcnRpY2xlX3NpbmdsZScsDQogICAgJ2NhbGwnID0+ICdWaWV3UG9zdCcsDQogICAgJ2dldCcgPT4gDQogICAgYXJyYXkgKA0KICAgICAgMCA9PiAnaWQnLA0KICAgICAgMSA9PiAnYWxpYXMnLA0KICAgICksDQogICAgJ25vdF9nZXQnID0+IA0KICAgIGFycmF5ICgNCiAgICAgIDAgPT4gJ2NhdGUnLA0KICAgICAgMSA9PiAnYXV0aCcsDQogICAgICAyID0+ICd0YWdzJywNCiAgICAgIDMgPT4gJ2RhdGUnLA0KICAgICksDQogICAgJ3VybHJ1bGUnID0+ICcnLA0KICAgICd0b19wZXJtYWxpbmsnID0+IHRydWUsDQogICksDQovLyAg5re75YqgIOaWh+eroGNhdGXpobXliJfooago5bim5Y+C5pWwKSDliqjmgIHot6/nlLENCiAgJ2FjdGl2ZV9wb3N0X2FydGljbGVfbGlzdF9jYXRlZ29yeScgPT4gDQogIGFycmF5ICgNCiAgICAndHlwZScgPT4gJ2FjdGl2ZScsDQogICAgJ25hbWUnID0+ICdwb3N0X2FydGljbGVfbGlzdF9jYXRlZ29yeScsDQogICAgJ2NhbGwnID0+ICdWaWV3TGlzdCcsDQogICAgJ3VybHJ1bGUnID0+ICcnLA0KICAgICdnZXQnID0+IA0KICAgIGFycmF5ICgNCiAgICAgIDAgPT4gJ3BhZ2UnLA0KICAgICksDQogICAgJ211c3RfZ2V0JyA9PiANCiAgICBhcnJheSAoDQogICAgICAwID0+ICdjYXRlJywNCiAgICApLA0KICAgICdub3RfZ2V0JyA9PiANCiAgICBhcnJheSAoDQogICAgICAwID0+ICdpZCcsDQogICAgICAxID0+ICdhbGlhcycsDQogICAgKSwNCiAgKSwNCi8vICDmt7vliqAg5paH56ugYXV0aOmhteWIl+ihqCjluKblj4LmlbApIOWKqOaAgei3r+eUsQ0KICAnYWN0aXZlX3Bvc3RfYXJ0aWNsZV9saXN0X2F1dGhvcicgPT4gDQogIGFycmF5ICgNCiAgICAndHlwZScgPT4gJ2FjdGl2ZScsDQogICAgJ25hbWUnID0+ICdwb3N0X2FydGljbGVfbGlzdF9hdXRob3InLA0KICAgICdjYWxsJyA9PiAnVmlld0xpc3QnLA0KICAgICd1cmxydWxlJyA9PiAnJywNCiAgICAnZ2V0JyA9PiANCiAgICBhcnJheSAoDQogICAgICAwID0+ICdwYWdlJywNCiAgICApLA0KICAgICdtdXN0X2dldCcgPT4gDQogICAgYXJyYXkgKA0KICAgICAgMCA9PiAnYXV0aCcsDQogICAgKSwNCiAgICAnbm90X2dldCcgPT4gDQogICAgYXJyYXkgKA0KICAgICAgMCA9PiAnaWQnLA0KICAgICAgMSA9PiAnYWxpYXMnLA0KICAgICksDQogICksDQovLyAg5re75YqgIOaWh+eroGRhdGXpobXliJfooago5bim5Y+C5pWwKSDliqjmgIHot6/nlLENCiAgJ2FjdGl2ZV9wb3N0X2FydGljbGVfbGlzdF9kYXRlJyA9PiANCiAgYXJyYXkgKA0KICAgICd0eXBlJyA9PiAnYWN0aXZlJywNCiAgICAnbmFtZScgPT4gJ3Bvc3RfYXJ0aWNsZV9saXN0X2RhdGUnLA0KICAgICdjYWxsJyA9PiAnVmlld0xpc3QnLA0KICAgICd1cmxydWxlJyA9PiAnJywNCiAgICAnZ2V0JyA9PiANCiAgICBhcnJheSAoDQogICAgICAwID0+ICdwYWdlJywNCiAgICApLA0KICAgICdtdXN0X2dldCcgPT4gDQogICAgYXJyYXkgKA0KICAgICAgMCA9PiAnZGF0ZScsDQogICAgKSwNCiAgICAnbm90X2dldCcgPT4gDQogICAgYXJyYXkgKA0KICAgICAgMCA9PiAnaWQnLA0KICAgICAgMSA9PiAnYWxpYXMnLA0KICAgICksDQogICksDQovLyAg5re75YqgIOaWh+eroHRhZ3PpobXliJfooago5bim5Y+C5pWwKSDliqjmgIHot6/nlLENCiAgJ2FjdGl2ZV9wb3N0X2FydGljbGVfbGlzdF90YWcnID0+IA0KICBhcnJheSAoDQogICAgJ3R5cGUnID0+ICdhY3RpdmUnLA0KICAgICduYW1lJyA9PiAncG9zdF9hcnRpY2xlX2xpc3RfdGFnJywNCiAgICAnY2FsbCcgPT4gJ1ZpZXdMaXN0JywNCiAgICAndXJscnVsZScgPT4gJycsDQogICAgJ2dldCcgPT4gDQogICAgYXJyYXkgKA0KICAgICAgMCA9PiAncGFnZScsDQogICAgKSwNCiAgICAnbXVzdF9nZXQnID0+IA0KICAgIGFycmF5ICgNCiAgICAgIDAgPT4gJ3RhZ3MnLA0KICAgICksDQogICAgJ25vdF9nZXQnID0+IA0KICAgIGFycmF5ICgNCiAgICAgIDAgPT4gJ2lkJywNCiAgICAgIDEgPT4gJ2FsaWFzJywNCiAgICApLA0KICApLA0KLy8gIOa3u+WKoCDmlofnq6DpobXljZXpobUg5Lyq6Z2Z6Lev55SxDQogICdyZXdyaXRlX3Bvc3RfYXJ0aWNsZV9zaW5nbGUnID0+IA0KICBhcnJheSAoDQogICAgJ3R5cGUnID0+ICdyZXdyaXRlJywNCiAgICAnbmFtZScgPT4gJ3Bvc3RfYXJ0aWNsZV9zaW5nbGUnLA0KICAgICdjYWxsJyA9PiAnVmlld1Bvc3QnLA0KICAgICd1cmxydWxlJyA9PiAnJywNCiAgICAnYXJncycgPT4gDQogICAgYXJyYXkgKA0KICAgICAgMCA9PiAncG9zdEBpZCcsDQogICAgICAxID0+ICdwb3N0QGFsaWFzJywNCiAgICApLA0KICApLA0KLy8gIOa3u+WKoCDmlofnq6BpbmRleOWIl+ihqCDkvKrpnZnot6/nlLENCiAgJ3Jld3JpdGVfcG9zdF9hcnRpY2xlX2xpc3QnID0+IA0KICBhcnJheSAoDQogICAgJ3R5cGUnID0+ICdyZXdyaXRlJywNCiAgICAnbmFtZScgPT4gJ3Bvc3RfYXJ0aWNsZV9saXN0JywNCiAgICAnY2FsbCcgPT4gJ1ZpZXdMaXN0JywNCiAgICAndXJscnVsZScgPT4gJycsDQogICAgJ2FyZ3MnID0+IA0KICAgIGFycmF5ICgNCiAgICAgIDAgPT4gJ3BhZ2UnLA0KICAgICksDQogICAgJ2FyZ3Nfd2l0aCcgPT4gDQogICAgYXJyYXkgKA0KICAgICksDQogICAgJ2FiYnJfdXJsJyA9PiB0cnVlLA0KICApLA0KLy8gIOa3u+WKoCDmlofnq6BjYXRlZ29yeeWIl+ihqCDkvKrpnZnot6/nlLENCiAgJ3Jld3JpdGVfcG9zdF9hcnRpY2xlX2xpc3RfY2F0ZWdvcnknID0+IA0KICBhcnJheSAoDQogICAgJ3R5cGUnID0+ICdyZXdyaXRlJywNCiAgICAnbmFtZScgPT4gJ3Bvc3RfYXJ0aWNsZV9saXN0X2NhdGVnb3J5JywNCiAgICAnY2FsbCcgPT4gJ1ZpZXdMaXN0JywNCiAgICAndXJscnVsZScgPT4gJycsDQogICAgJ2FyZ3MnID0+IA0KICAgIGFycmF5ICgNCiAgICAgIDAgPT4gJ2NhdGVAaWQnLA0KICAgICAgMSA9PiAnY2F0ZUBhbGlhcycsDQogICAgICAyID0+ICdwYWdlJywNCiAgICApLA0KICApLA0KLy8gIOa3u+WKoCDmlofnq6BhdXRob3LliJfooagg5Lyq6Z2Z6Lev55SxDQogICdyZXdyaXRlX3Bvc3RfYXJ0aWNsZV9saXN0X2F1dGhvcicgPT4gDQogIGFycmF5ICgNCiAgICAndHlwZScgPT4gJ3Jld3JpdGUnLA0KICAgICduYW1lJyA9PiAncG9zdF9hcnRpY2xlX2xpc3RfYXV0aG9yJywNCiAgICAnY2FsbCcgPT4gJ1ZpZXdMaXN0JywNCiAgICAndXJscnVsZScgPT4gJycsDQogICAgJ2FyZ3MnID0+IA0KICAgIGFycmF5ICgNCiAgICAgIDAgPT4gJ2F1dGhAaWQnLA0KICAgICAgMSA9PiAnYXV0aEBhbGlhcycsDQogICAgICAyID0+ICdwYWdlJywNCiAgICApLA0KICApLA0KLy8gIOa3u+WKoCDmlofnq6BkYXRl5YiX6KGoIOS8qumdmei3r+eUsQ0KICAncmV3cml0ZV9wb3N0X2FydGljbGVfbGlzdF9kYXRlJyA9PiANCiAgYXJyYXkgKA0KICAgICd0eXBlJyA9PiAncmV3cml0ZScsDQogICAgJ25hbWUnID0+ICdwb3N0X2FydGljbGVfbGlzdF9kYXRlJywNCiAgICAnY2FsbCcgPT4gJ1ZpZXdMaXN0JywNCiAgICAndXJscnVsZScgPT4gJycsDQogICAgJ2FyZ3MnID0+IA0KICAgIGFycmF5ICgNCiAgICAgIDAgPT4gJ2RhdGUnLA0KICAgICAgMSA9PiAncGFnZScsDQogICAgKSwNCiAgKSwNCi8vICDmt7vliqAg5paH56ugdGFn5YiX6KGoIOS8qumdmei3r+eUsQ0KICAncmV3cml0ZV9wb3N0X2FydGljbGVfbGlzdF90YWcnID0+IA0KICBhcnJheSAoDQogICAgJ3R5cGUnID0+ICdyZXdyaXRlJywNCiAgICAnbmFtZScgPT4gJ3Bvc3RfYXJ0aWNsZV9saXN0X3RhZycsDQogICAgJ2NhbGwnID0+ICdWaWV3TGlzdCcsDQogICAgJ3VybHJ1bGUnID0+ICcnLA0KICAgICdhcmdzJyA9PiANCiAgICBhcnJheSAoDQogICAgICAwID0+ICd0YWdzQGlkJywNCiAgICAgIDEgPT4gJ3RhZ3NAYWxpYXMnLA0KICAgICAgMiA9PiAncGFnZScsDQogICAgKSwNCiAgKSwNCi8vICDov5nmmK/kuIDkuKrkvovlrZDvvJog5paH56ug5pCc57Si55qE5Lyq6Z2Z6Lev55Sx55qE5a6e546wDQovKg0KICAncmV3cml0ZV9wb3N0X2FydGljbGVfc2VhcmNoJyA9PiANCiAgYXJyYXkgKA0KICAgICd0eXBlJyA9PiAncmV3cml0ZScsDQogICAgJ25hbWUnID0+ICdwb3N0X2FydGljbGVfc2VhcmNoJywNCiAgICAnY2FsbCcgPT4gJ1ZpZXdTZWFyY2gnLA0KICAgICdwcmVmaXgnID0+ICdzZWFyY2gnLA0KICAgICd1cmxydWxlJyA9PiAneyVob3N0JX17JXElfV97JXBhZ2UlfS5odG1sJywNCiAgICAnYXJncycgPT4gDQogICAgYXJyYXkgKA0KICAgICAgJ3EnID0+ICdbXlxcL19dKycsDQogICAgICAwID0+ICdwYWdlJywNCiAgICApLA0KICAgICdhcmdzX3dpdGgnID0+IA0KICAgIGFycmF5ICgNCiAgICAgICdwb3N0dHlwZScgPT4gMCwNCiAgICApLA0KICAgICdyZXF1ZXN0X21ldGhvZCcgPT4gDQogICAgYXJyYXkgKA0KICAgICAgMCA9PiAnR0VUJywNCiAgICAgIDEgPT4gJ1BPU1QnLA0KICAgICksDQogICAgJ29ubHlfbWF0Y2hfcGFnZScgPT4gZmFsc2UsDQogICksDQoqLw0KLy8gIOa3u+WKoCDpu5jorqTot6/nlLEg77yI5paH56ug6aG15YiX6KGo55qE6aaW6aG16Lev55Sx77yM5Y+q5Zyo5rKh5pyJ5byA5ZCv5Lyq6Z2Z5LiL5ZCv55So77yJDQogICdkZWZhdWx0X3Bvc3RfYXJ0aWNsZV9saXN0JyA9PiANCiAgYXJyYXkgKA0KICAgICd0eXBlJyA9PiAnZGVmYXVsdCcsDQogICAgJ25hbWUnID0+ICdwb3N0X2FydGljbGVfbGlzdCcsDQogICAgJ2NhbGwnID0+ICdWaWV3TGlzdCcsDQogICAgJ3VybHJ1bGUnID0+ICcnLA0KICAgICdnZXQnID0+IA0KICAgIGFycmF5ICgNCiAgICAgIDAgPT4gJ3BhZ2UnLA0KICAgICksDQogICAgJ25vdF9nZXQnID0+IA0KICAgIGFycmF5ICgNCiAgICAgIDAgPT4gJ2NhdGUnLA0KICAgICAgMSA9PiAndGFncycsDQogICAgICAyID0+ICdhdXRoJywNCiAgICAgIDMgPT4gJ2RhdGUnLA0KICAgICAgNCA9PiAnaWQnLA0KICAgICAgNSA9PiAnYWxpYXMnLA0KICAgICksDQogICAgJ2FiYnJfdXJsJyA9PiB0cnVlLA0KICApLA0KKTsNCg==</file>
	<file name='zb_system\function\c_system_admin_function.php' crc32='21322896'  dt:dt='bin.base64'>PD9waHANCi8qKg0KICog5ZCO5Y+w566h55CG6L6F5Yqp5Ye95pWw55u45YWzDQogKiBAcGFja2FnZSBaLUJsb2dQSFANCiAqIEBzdWJwYWNrYWdlIFN5c3RlbS9BZG1pbmlzdHJhdG9yIOWQjuWPsOeuoeeQhg0KICogQGF1dGhvciBaLUJsb2dQSFAgVGVhbQ0KICovDQoNCmlmICghZGVmaW5lZCgnWkJQX1BBVEgnKSkgew0KICAgIGV4aXQoJ0FjY2VzcyBkZW5pZWQnKTsNCn0NCg0KLy8jIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCg0KLyoqDQogKiDmt7vliqDpobXpnaLnrqHnkIblrZDoj5zljZUo5YaF572u5o+S5Lu25Ye95pWwKS4NCiAqLw0KZnVuY3Rpb24gSW5jbHVkZV9BZG1pbl9BZGRwYWdlc3VibWVudSgpDQp7DQogICAgZWNobyBNYWtlU3ViTWVudSgkR0xPQkFMU1snbGFuZyddWydtc2cnXVsnbmV3X3BhZ2UnXSwgJy4uL2NtZC5waHA/YWN0PVBhZ2VFZHQnLCAnbS1sZWZ0JywgbnVsbCwgbnVsbCwgbnVsbCwgJ2ljb24tZmlsZS1wbHVzLWZpbGwnKTsNCn0NCg0KLyoqDQogKiDmt7vliqDmoIfnrb7nrqHnkIblrZDoj5zljZUo5YaF572u5o+S5Lu25Ye95pWwKS4NCiAqLw0KZnVuY3Rpb24gSW5jbHVkZV9BZG1pbl9BZGR0YWdzdWJtZW51KCkNCnsNCiAgICAkdHlwZSA9IChpbnQpIEdldFZhcnMoJ3R5cGUnKTsNCiAgICAkdHlwZXVybCA9ICR0eXBlID4gMCA/ICgnJnR5cGU9JyAuICR0eXBlKSA6ICcnOw0KICAgIGVjaG8gTWFrZVN1Yk1lbnUoJEdMT0JBTFNbJ2xhbmcnXVsnbXNnJ11bJ25ld190YWcnXSwgJy4uL2NtZC5waHA/YWN0PVRhZ0VkdCcgLiAkdHlwZXVybCwgJ20tbGVmdCcsIG51bGwsIG51bGwsIG51bGwsICdpY29uLXRhZy1maWxsJyk7DQp9DQoNCi8qKg0KICog5re75Yqg5YiG57G7566h55CG5a2Q6I+c5Y2VKOWGhee9ruaPkuS7tuWHveaVsCkuDQogKi8NCmZ1bmN0aW9uIEluY2x1ZGVfQWRtaW5fQWRkY2F0ZXN1Ym1lbnUoKQ0Kew0KICAgICR0eXBlID0gKGludCkgR2V0VmFycygndHlwZScpOw0KICAgICR0eXBldXJsID0gJHR5cGUgPiAwID8gKCcmdHlwZT0nIC4gJHR5cGUpIDogJyc7DQogICAgZWNobyBNYWtlU3ViTWVudSgkR0xPQkFMU1snbGFuZyddWydtc2cnXVsnbmV3X2NhdGVnb3J5J10sICcuLi9jbWQucGhwP2FjdD1DYXRlZ29yeUVkdCcgLiAkdHlwZXVybCwgJ20tbGVmdCcsIG51bGwsIG51bGwsIG51bGwsICdpY29uLWZvbGRlci1wbHVzJyk7DQp9DQoNCi8qKg0KICog5re75Yqg55So5oi3566h55CG5a2Q6I+c5Y2VKOWGhee9ruaPkuS7tuWHveaVsCkuDQogKi8NCmZ1bmN0aW9uIEluY2x1ZGVfQWRtaW5fQWRkbWVtc3VibWVudSgpDQp7DQogICAgZ2xvYmFsICR6YnA7DQogICAgaWYgKCR6YnAtPkNoZWNrUmlnaHRzKCdNZW1iZXJOZXcnKSkgew0KICAgICAgICBlY2hvIE1ha2VTdWJNZW51KCRHTE9CQUxTWydsYW5nJ11bJ21zZyddWyduZXdfbWVtYmVyJ10sICcuLi9jbWQucGhwP2FjdD1NZW1iZXJOZXcnLCAnbS1sZWZ0JywgbnVsbCwgbnVsbCwgbnVsbCwgJ2ljb24tcGVyc29uLXBsdXMtZmlsbCcpOw0KICAgIH0NCiAgICBlY2hvIE1ha2VTdWJNZW51KCRHTE9CQUxTWydsYW5nJ11bJ21zZyddWyd2aWV3X3JpZ2h0cyddLCAnLi4vY21kLnBocD9hY3Q9bWlzYyZhbXA7dHlwZT12cnMnLCAnbS1sZWZ0JywgbnVsbCwgbnVsbCwgbnVsbCwgJ2ljb24tcGVyc29uLWNoZWNrLWZpbGwnKTsNCn0NCg0KLyoqDQogKiDmt7vliqDmqKHlnZfnrqHnkIblrZDoj5zljZUo5YaF572u5o+S5Lu25Ye95pWwKS4NCiAqLw0KZnVuY3Rpb24gSW5jbHVkZV9BZG1pbl9BZGRtb2RzdWJtZW51KCkNCnsNCiAgICBlY2hvIE1ha2VTdWJNZW51KCRHTE9CQUxTWydsYW5nJ11bJ21zZyddWyduZXdfbW9kdWxlJ10sICcuLi9jbWQucGhwP2FjdD1Nb2R1bGVFZHQnLCAnbS1sZWZ0JywgbnVsbCwgbnVsbCwgbnVsbCwgJ2ljb24tc3VidHJhY3QnKTsNCiAgICBlY2hvIE1ha2VTdWJNZW51KCRHTE9CQUxTWydsYW5nJ11bJ21zZyddWydtb2R1bGVfbmF2YmFyJ10sICcuLi9jbWQucGhwP2FjdD1Nb2R1bGVFZHQmYW1wO2ZpbGVuYW1lPW5hdmJhcicpOw0KICAgIGVjaG8gTWFrZVN1Yk1lbnUoJEdMT0JBTFNbJ2xhbmcnXVsnbXNnJ11bJ21vZHVsZV9saW5rJ10sICcuLi9jbWQucGhwP2FjdD1Nb2R1bGVFZHQmYW1wO2ZpbGVuYW1lPWxpbmsnKTsNCiAgICBlY2hvIE1ha2VTdWJNZW51KCRHTE9CQUxTWydsYW5nJ11bJ21zZyddWydtb2R1bGVfZmF2b3JpdGUnXSwgJy4uL2NtZC5waHA/YWN0PU1vZHVsZUVkdCZhbXA7ZmlsZW5hbWU9ZmF2b3JpdGUnKTsNCiAgICBlY2hvIE1ha2VTdWJNZW51KCRHTE9CQUxTWydsYW5nJ11bJ21zZyddWydtb2R1bGVfbWlzYyddLCAnLi4vY21kLnBocD9hY3Q9TW9kdWxlRWR0JmFtcDtmaWxlbmFtZT1taXNjJyk7DQp9DQoNCi8qKg0KICog5re75Yqg6K+E6K66566h55CG5a2Q6I+c5Y2VKOWGhee9ruaPkuS7tuWHveaVsCkuDQogKi8NCmZ1bmN0aW9uIEluY2x1ZGVfQWRtaW5fQWRkY210c3VibWVudSgpDQp7DQogICAgZ2xvYmFsICR6YnA7DQogICAgaWYgKCR6YnAtPkNoZWNrUmlnaHRzKCdDb21tZW50QWxsJykpIHsNCiAgICAgICAgJG4gPSAoJHpicC0+Y2FjaGUtPmFsbF9jb21tZW50X251bXMgLSAkemJwLT5jYWNoZS0+bm9ybWFsX2NvbW1lbnRfbnVtcyk7DQogICAgICAgIGlmICgkbiAhPSAwKSB7DQogICAgICAgICAgICAkbiA9ICcgKCcgLiAkbiAuICcpJzsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICRuID0gJyc7DQogICAgICAgIH0NCiAgICAgICAgZWNobyBNYWtlU3ViTWVudSgkR0xPQkFMU1snbGFuZyddWydtc2cnXVsnY2hlY2tfY29tbWVudCddIC4gJG4sICcuLi9jbWQucGhwP2FjdD1Db21tZW50TW5nJmFtcDtpc2NoZWNraW5nPTEnLCAnbS1sZWZ0ICcgLiAoR2V0VmFycygnaXNjaGVja2luZycpID8gJ20tbm93JyA6ICcnKSwgbnVsbCwgbnVsbCwgbnVsbCwgJ2ljb24tc2hpZWxkLXNoYWRlZCcpOw0KICAgIH0NCn0NCg0KLyoqDQogKiDmt7vliqDnvZHnq5norr7nva7lrZDoj5zljZUo5YaF572u5o+S5Lu25Ye95pWwKS4NCiAqLw0KZnVuY3Rpb24gSW5jbHVkZV9BZG1pbl9BZGRzZXR0aW5nc3VibWVudSgpDQp7DQogICAgZWNobyBNYWtlU3ViTWVudSgkR0xPQkFMU1snbGFuZyddWydtc2cnXVsnY2xlYXJfdGh1bWJfY2FjaGUnXSwgJ2phdmFzY3JpcHQ6d2luZG93LmNvbmZpcm0oXCcnIC4gJEdMT0JBTFNbJ2xhbmcnXVsnbXNnJ11bJ2NvbmZpcm1fY2xlYXJfdGh1bWJfY2FjaGUnXSAuICdcJykgJiYgKHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCcnIC4gQnVpbGRTYWZlQ21kVVJMKCdhY3Q9bWlzYyZ0eXBlPWNsZWFydGh1bWJjYWNoZScpIC4gJ1wnKTsnLCAnbS1yaWdodCcsIG51bGwsIG51bGwsIG51bGwsICdpY29uLXRyYXNoLWZpbGwnKTsNCn0NCg0KLyoqDQogKiDljYfnuqfmlbDmja7lupMNCiAqLw0KZnVuY3Rpb24gSW5jbHVkZV9BZG1pbl9VcGRhdGVEQigpDQp7DQogICAgZ2xvYmFsICR6YnA7DQoNCiAgICBpZiAoJHpicC0+dmVyc2lvbiA+PSBaQ19MQVNUX1ZFUlNJT04gJiYgKGludCkgJHpicC0+b3B0aW9uWydaQ19MQVNUX1ZFUlNJT04nXSA8IFpDX0xBU1RfVkVSU0lPTikgew0KICAgICAgICBpZiAoc3Vic3RyKEdldFZhbHVlSW5BcnJheShnZXRfaW5jbHVkZWRfZmlsZXMoKSwgMCksIC05KSA9PSAnaW5kZXgucGhwJykgew0KICAgICAgICAgICAgJHpicC0+U2V0SGludCgndGlwcycsICc8YSBocmVmPSIjIiBvbmNsaWNrPSIkLmdldChibG9naG9zdCtcJ3piX3N5c3RlbS9hZG1pbi91cGRhdGVkYi5waHBcJywgZnVuY3Rpb24oZGF0YSl7YWxlcnQoSlNPTi5wYXJzZShkYXRhKS5kYXRhKTt3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7fSk7Ij4nIC4gQCR6YnAtPmxhbmdzLT5tc2ctPnVwZGF0ZV9kYiAuICc8L2E+JywgMTAwMDApOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQovKioNCiAqIENoZWNrIEh0dHAgMzA0T0sNCiAqLw0KZnVuY3Rpb24gSW5jbHVkZV9BZG1pbl9DaGVja0h0dHAzMDRPSygpDQp7DQogICAgZ2xvYmFsICR6YnAsICRhY3Rpb247DQogICAgaWYgKCRhY3Rpb24gIT0gJ2FkbWluJykgew0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIGlmICghJHpicC0+Q2hlY2tSaWdodHMoJ3Jvb3QnKSkgew0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIC8v5Y6f5Zug5piv5LiN6IO96L6T5Ye6MzA054q25oCB55qE77yM5Y+R546w6L6T5Ye6NTAw54q25oCB5Lmf5piv6ZSZ55qE77yM5omA5Lul5qOA5rWLNTAw55So5LqOMzA05LiKDQogICAgaWYgKEdldFZhcnMoJ2h0dHAzMDRvaycsICdDT09LSUUnKSAhPT0gJzEnICYmIEdldFZhcnMoJ2h0dHAzMDRvaycsICdDT09LSUUnKSAhPT0gJzAnKSB7DQogICAgICAgIGVjaG8gJzxzY3JpcHQ+DQogICAgICAgICB2YXIgZXhwID0gbmV3IERhdGUoKTsNCiAgICAgICAgIGV4cC5zZXRUaW1lKGV4cC5nZXRUaW1lKCkgKyAzNjUqMjQqMzYwMCoxMDAwKTsNCiAgICAgICAgICQoZnVuY3Rpb24gKCkgeyAgJC5hamF4KHt0eXBlOiAiR0VUIix1cmw6ICInIC4gJHpicC0+aG9zdCAuICd6Yl9zeXN0ZW0vY21kLnBocD9hY3Q9Y2hlY2todHRwMzA0b2siLHN1Y2Nlc3M6IGZ1bmN0aW9uKG1zZyl7IA0KICAgICAgICAgICAgZG9jdW1lbnQuY29va2llPSJodHRwMzA0b2s9MDsgcGF0aD0nIC4gJHpicC0+Y29va2llc3BhdGggLiAnIiArICI7IGV4cGlyZXM9IiArIGV4cC50b0dNVFN0cmluZygpOw0KICAgICAgICAgfSxzdGF0dXNDb2RlOiB7NTAwOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIGRvY3VtZW50LmNvb2tpZT0iaHR0cDMwNG9rPTE7IHBhdGg9JyAuICR6YnAtPmNvb2tpZXNwYXRoIC4gJyIgKyAiOyBleHBpcmVzPSIgKyBleHAudG9HTVRTdHJpbmcoKTsNCiAgICAgICAgIH19fSk7IH0pOyA8L3NjcmlwdD4nOw0KICAgIH0NCiAgICBpZiAoR2V0VmFycygnaHR0cDMwNG9rJywgJ0NPT0tJRScpID09PSAnMCcpIHsNCiAgICAgICAgaWYgKCR6YnAtPm9wdGlvblsnWkNfSlNfMzA0X0VOQUJMRSddID09IHRydWUpIHsNCiAgICAgICAgICAgICR6YnAtPm9wdGlvblsnWkNfSlNfMzA0X0VOQUJMRSddID0gZmFsc2U7DQogICAgICAgICAgICAkemJwLT5TYXZlT3B0aW9uKCk7DQogICAgICAgIH0NCiAgICB9IGVsc2VpZiAoR2V0VmFycygnaHR0cDMwNG9rJywgJ0NPT0tJRScpID09PSAnMScpIHsNCiAgICAgICAgaWYgKCR6YnAtPm9wdGlvblsnWkNfSlNfMzA0X0VOQUJMRSddID09IGZhbHNlKSB7DQogICAgICAgICAgICAkemJwLT5vcHRpb25bJ1pDX0pTXzMwNF9FTkFCTEUnXSA9IHRydWU7DQogICAgICAgICAgICAkemJwLT5TYXZlT3B0aW9uKCk7DQogICAgICAgIH0NCiAgICB9DQp9DQoNCiR0b3BtZW51cyA9IGFycmF5KCk7DQoNCiRsZWZ0bWVudXMgPSBhcnJheSgpOw0KDQovKioNCiAqIOWQjuWPsOeuoeeQhuW3puS+p+WvvOiIquiPnOWNlS4NCiAqLw0KZnVuY3Rpb24gUmVzcG9uc2VBZG1pbl9MZWZ0TWVudSgpDQp7DQogICAgZ2xvYmFsICR6YnA7DQogICAgZ2xvYmFsICRsZWZ0bWVudXM7DQoNCiAgICAkbGVmdG1lbnVzWyduYXZfbmV3J10gPSBNYWtlTGVmdE1lbnUoIkFydGljbGVFZHQiLCAkemJwLT5sYW5nWydtc2cnXVsnbmV3X2FydGljbGUnXSwgJHpicC0+aG9zdCAuICJ6Yl9zeXN0ZW0vY21kLnBocD9hY3Q9QXJ0aWNsZUVkdCIsICJuYXZfbmV3IiwgImFBcnRpY2xlRWR0IiwgIiIsICJpY29uLXBlbmNpbC1zcXVhcmUtZmlsbCIpOw0KICAgICRsZWZ0bWVudXNbJ25hdl9hcnRpY2xlJ10gPSBNYWtlTGVmdE1lbnUoIkFydGljbGVNbmciLCAkemJwLT5sYW5nWydtc2cnXVsnYXJ0aWNsZV9tYW5hZ2UnXSwgJHpicC0+aG9zdCAuICJ6Yl9zeXN0ZW0vY21kLnBocD9hY3Q9QXJ0aWNsZU1uZyIsICJuYXZfYXJ0aWNsZSIsICJhQXJ0aWNsZU1uZyIsICIiLCAiaWNvbi1zdGlja2llcyIpOw0KICAgICRsZWZ0bWVudXNbJ25hdl9wYWdlJ10gPSBNYWtlTGVmdE1lbnUoIlBhZ2VNbmciLCAkemJwLT5sYW5nWydtc2cnXVsncGFnZV9tYW5hZ2UnXSwgJHpicC0+aG9zdCAuICJ6Yl9zeXN0ZW0vY21kLnBocD9hY3Q9UGFnZU1uZyIsICJuYXZfcGFnZSIsICJhUGFnZU1uZyIsICIiLCAiaWNvbi1zdGlja2llcy1maWxsIik7DQoNCiAgICAkbGVmdG1lbnVzW10gPSAiPGxpIGNsYXNzPSdzcGxpdCc+PGhyLz48L2xpPiI7DQoNCiAgICAkbGVmdG1lbnVzWyduYXZfY2F0ZWdvcnknXSA9IE1ha2VMZWZ0TWVudSgiQ2F0ZWdvcnlNbmciLCAkemJwLT5sYW5nWydtc2cnXVsnY2F0ZWdvcnlfbWFuYWdlJ10sICR6YnAtPmhvc3QgLiAiemJfc3lzdGVtL2NtZC5waHA/YWN0PUNhdGVnb3J5TW5nIiwgIm5hdl9jYXRlZ29yeSIsICJhQ2F0ZWdvcnlNbmciLCAiIiwgImljb24tZm9sZGVyLWZpbGwiKTsNCiAgICAkbGVmdG1lbnVzWyduYXZfdGFncyddID0gTWFrZUxlZnRNZW51KCJUYWdNbmciLCAkemJwLT5sYW5nWydtc2cnXVsndGFnX21hbmFnZSddLCAkemJwLT5ob3N0IC4gInpiX3N5c3RlbS9jbWQucGhwP2FjdD1UYWdNbmciLCAibmF2X3RhZ3MiLCAiYVRhZ01uZyIsICIiLCAiaWNvbi10YWdzLWZpbGwiKTsNCiAgICAkbGVmdG1lbnVzWyduYXZfY29tbWVudDEnXSA9IE1ha2VMZWZ0TWVudSgiQ29tbWVudE1uZyIsICR6YnAtPmxhbmdbJ21zZyddWydjb21tZW50X21hbmFnZSddLCAkemJwLT5ob3N0IC4gInpiX3N5c3RlbS9jbWQucGhwP2FjdD1Db21tZW50TW5nIiwgIm5hdl9jb21tZW50IiwgImFDb21tZW50TW5nIiwgIiIsICJpY29uLWNoYXQtdGV4dC1maWxsIik7DQogICAgJGxlZnRtZW51c1snbmF2X3VwbG9hZCddID0gTWFrZUxlZnRNZW51KCJVcGxvYWRNbmciLCAkemJwLT5sYW5nWydtc2cnXVsndXBsb2FkX21hbmFnZSddLCAkemJwLT5ob3N0IC4gInpiX3N5c3RlbS9jbWQucGhwP2FjdD1VcGxvYWRNbmciLCAibmF2X3VwbG9hZCIsICJhVXBsb2FkTW5nIiwgIiIsICJpY29uLWluYm94ZXMtZmlsbCIpOw0KICAgICRsZWZ0bWVudXNbJ25hdl9tZW1iZXInXSA9IE1ha2VMZWZ0TWVudSgiTWVtYmVyTW5nIiwgJHpicC0+bGFuZ1snbXNnJ11bJ21lbWJlcl9tYW5hZ2UnXSwgJHpicC0+aG9zdCAuICJ6Yl9zeXN0ZW0vY21kLnBocD9hY3Q9TWVtYmVyTW5nIiwgIm5hdl9tZW1iZXIiLCAiYU1lbWJlck1uZyIsICIiLCAiaWNvbi1wZW9wbGUtZmlsbCIpOw0KDQogICAgJGxlZnRtZW51c1tdID0gIjxsaSBjbGFzcz0nc3BsaXQnPjxoci8+PC9saT4iOw0KDQogICAgJGxlZnRtZW51c1snbmF2X3RoZW1lJ10gPSBNYWtlTGVmdE1lbnUoIlRoZW1lTW5nIiwgJHpicC0+bGFuZ1snbXNnJ11bJ3RoZW1lX21hbmFnZSddLCAkemJwLT5ob3N0IC4gInpiX3N5c3RlbS9jbWQucGhwP2FjdD1UaGVtZU1uZyIsICJuYXZfdGhlbWUiLCAiYVRoZW1lTW5nIiwgIiIsICJpY29uLWdyaWQtMXgyLWZpbGwiKTsNCiAgICAkbGVmdG1lbnVzWyduYXZfbW9kdWxlJ10gPSBNYWtlTGVmdE1lbnUoIk1vZHVsZU1uZyIsICR6YnAtPmxhbmdbJ21zZyddWydtb2R1bGVfbWFuYWdlJ10sICR6YnAtPmhvc3QgLiAiemJfc3lzdGVtL2NtZC5waHA/YWN0PU1vZHVsZU1uZyIsICJuYXZfbW9kdWxlIiwgImFNb2R1bGVNbmciLCAiIiwgImljb24tZ3JpZC0zeDMtZ2FwLWZpbGwiKTsNCiAgICAkbGVmdG1lbnVzWyduYXZfcGx1Z2luJ10gPSBNYWtlTGVmdE1lbnUoIlBsdWdpbk1uZyIsICR6YnAtPmxhbmdbJ21zZyddWydwbHVnaW5fbWFuYWdlJ10sICR6YnAtPmhvc3QgLiAiemJfc3lzdGVtL2NtZC5waHA/YWN0PVBsdWdpbk1uZyIsICJuYXZfcGx1Z2luIiwgImFQbHVnaW5NbmciLCAiIiwgImljb24tcHV6emxlLWZpbGwiKTsNCg0KICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX0FkbWluX0xlZnRNZW51J10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICRmcG5hbWUoJGxlZnRtZW51cyk7DQogICAgfQ0KDQogICAgZm9yZWFjaCAoJGxlZnRtZW51cyBhcyAkbSkgew0KICAgICAgICBlY2hvICRtOw0KICAgIH0NCn0NCg0KLyoqDQogKiDlkI7lj7DnrqHnkIbpobbpg6joj5zljZUuDQogKi8NCmZ1bmN0aW9uIFJlc3BvbnNlQWRtaW5fVG9wTWVudSgpDQp7DQogICAgZ2xvYmFsICR6YnA7DQogICAgZ2xvYmFsICR0b3BtZW51czsNCg0KICAgICR0b3BtZW51c1tdID0gTWFrZVRvcE1lbnUoImFkbWluIiwgJHpicC0+bGFuZ1snbXNnJ11bJ2Rhc2hib2FyZCddLCAkemJwLT5ob3N0IC4gInpiX3N5c3RlbS9jbWQucGhwP2FjdD1hZG1pbiIsICIiLCAiIiwgImljb24taG91c2UtZG9vci1maWxsIik7DQogICAgJHRvcG1lbnVzW10gPSBNYWtlVG9wTWVudSgiU2V0dGluZ01uZyIsIEAkemJwLT5sYW5nWydtc2cnXVsnd2ViX3NldHRpbmdzJ10sICR6YnAtPmhvc3QgLiAiemJfc3lzdGVtL2NtZC5waHA/YWN0PVNldHRpbmdNbmciLCAiIiwgIiIsICJpY29uLWdlYXItZmlsbCIpOw0KDQogICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fQWRtaW5fVG9wTWVudSddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAkZnBuYW1lKCR0b3BtZW51cyk7DQogICAgfQ0KDQogICAgJHRvcG1lbnVzW10gPSBNYWtlVG9wTWVudSgibWlzYyIsICR6YnAtPmxhbmdbJ21zZyddWydvZmZpY2lhbF93ZWJzaXRlJ10sICJodHRwczovL3d3dy56YmxvZ2NuLmNvbS8iLCAiX2JsYW5rIiwgIiIsICJpY29uLXpibG9nLWNpcmNsZS1maWxsIik7DQoNCiAgICBmb3JlYWNoICgkdG9wbWVudXMgYXMgJG0pIHsNCiAgICAgICAgZWNobyAkbTsNCiAgICB9DQp9DQoNCi8qKg0KICog5re75Yqg5a2Q6I+c5Y2V6aG5Lg0KICoNCiAqIEBwYXJhbSAkc3RyTmFtZQ0KICogQHBhcmFtICRzdHJVcmwNCiAqIEBwYXJhbSAkc3RyQ2xhc3MNCiAqIEBwYXJhbSAkc3RyVGFyZ2V0DQogKiBAcGFyYW0gJHN0cklkDQogKiBAcGFyYW0gJHN0clRpdGxlDQogKg0KICogQHJldHVybiBudWxsfHN0cmluZw0KICovDQpmdW5jdGlvbiBNYWtlU3ViTWVudSgkc3RyTmFtZSwgJHN0clVybCwgJHN0ckNsYXNzID0gJ20tbGVmdCcsICRzdHJUYXJnZXQgPSAnJywgJHN0cklkID0gJycsICRzdHJUaXRsZSA9ICcnLCAkc3RySWNvbkNsYXNzID0gJycpDQp7DQogICAgJHMgPSAnPGEgaHJlZj0iJyAuICRzdHJVcmwgLiAnIiAnOw0KICAgIGlmICgkc3RyVGFyZ2V0KSB7DQogICAgICAgICRzIC49ICd0YXJnZXQ9IicgLiAkc3RyVGFyZ2V0IC4gJyInOw0KICAgIH0NCiAgICBpZiAoJHN0cklkKSB7DQogICAgICAgICRzIC49ICdpZD0iJyAuICRzdHJJZCAuICciJzsNCiAgICB9DQogICAgaWYgKCRzdHJUaXRsZSkgew0KICAgICAgICAkcyAuPSAndGl0bGU9IicgLiAkc3RyVGl0bGUgLiAnIiAnIC4gJ2FsdD0iJyAuICRzdHJUaXRsZSAuICciICc7DQogICAgfQ0KICAgICRzIC49ICc+JzsNCiAgICAkc3RySWNvbkVsZW0gPSAkc3RySWNvbkNsYXNzICE9PSAiIiA/ICI8aSBjbGFzcz1cIiIgLiAkc3RySWNvbkNsYXNzIC4gIlwiIHN0eWxlPVwibGluZS1oZWlnaHQ6IDFlbTtcIj48L2k+ICIgOiAiIjsNCiAgICAkcyAuPSAnPHNwYW4gY2xhc3M9IicgLiAkc3RyQ2xhc3MgLiAnIj4nIC4gJHN0ckljb25FbGVtIC4gJHN0ck5hbWUgLiAnPC9zcGFuPjwvYT4nOw0KDQogICAgcmV0dXJuICRzOw0KfQ0KDQovKioNCiAqIOa3u+WKoOmhtumDqOiPnOWNlemhuS4NCiAqDQogKiBAcGFyYW0gJHJlcXVpcmVBY3Rpb24NCiAqIEBwYXJhbSAkc3RyTmFtZQ0KICogQHBhcmFtICRzdHJVcmwNCiAqIEBwYXJhbSAkc3RyVGFyZ2V0DQogKiBAcGFyYW0gJHN0ckxpSWQNCiAqIEBwYXJhbSAkc3RySWNvbkNsYXNzDQogKg0KICogQHJldHVybiBudWxsfHN0cmluZw0KICovDQpmdW5jdGlvbiBNYWtlVG9wTWVudSgkcmVxdWlyZUFjdGlvbiwgJHN0ck5hbWUsICRzdHJVcmwsICRzdHJUYXJnZXQsICRzdHJMaUlkLCAkc3RySWNvbkNsYXNzID0gIiIpDQp7DQogICAgZ2xvYmFsICR6YnA7DQoNCiAgICBzdGF0aWMgJEFkbWluVG9wTWVudUNvdW50ID0gMDsNCiAgICBpZiAoJHpicC0+Q2hlY2tSaWdodHMoJHJlcXVpcmVBY3Rpb24pID09IGZhbHNlKSB7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICAkdG1wID0gbnVsbDsNCiAgICBpZiAoJHN0clRhcmdldCA9PSAiIikgew0KICAgICAgICAkc3RyVGFyZ2V0ID0gIl9zZWxmIjsNCiAgICB9DQogICAgJEFkbWluVG9wTWVudUNvdW50ID0gKCRBZG1pblRvcE1lbnVDb3VudCArIDEpOw0KICAgIGlmICgkc3RyTGlJZCA9PSAiIikgew0KICAgICAgICAkc3RyTGlJZCA9ICJ0b3BtZW51IiAuICRBZG1pblRvcE1lbnVDb3VudDsNCiAgICB9DQogICAgJHN0ckljb25FbGVtID0gJHN0ckljb25DbGFzcyAhPT0gIiIgPyAiPGkgY2xhc3M9XCIiIC4gJHN0ckljb25DbGFzcyAuICJcIj48L2k+PHNwYW4+IiA6ICI8c3Bhbj4iOw0KICAgICR0bXAgPSAiPGxpIGlkPVwiIiAuICRzdHJMaUlkIC4gIlwiPjxhIGhyZWY9XCIiIC4gJHN0clVybCAuICJcIiB0YXJnZXQ9XCIiIC4gJHN0clRhcmdldCAuICJcIiB0aXRsZT1cIiIgLiBodG1sc3BlY2lhbGNoYXJzKCRzdHJOYW1lKSAuICJcIj4iIC4gJHN0ckljb25FbGVtIC4gJHN0ck5hbWUgLiAiPC9zcGFuPjwvYT48L2xpPiI7DQoNCiAgICByZXR1cm4gJHRtcDsNCn0NCg0KLyoqDQogKiDmt7vliqDlt6bkvqfoj5zljZXpobkuDQogKg0KICogQHBhcmFtICRyZXF1aXJlQWN0aW9uDQogKiBAcGFyYW0gJHN0ck5hbWUNCiAqIEBwYXJhbSAkc3RyVXJsDQogKiBAcGFyYW0gJHN0ckxpSWQNCiAqIEBwYXJhbSAkc3RyQUlkDQogKiBAcGFyYW0gJHN0ckltZ1VybA0KICoNCiAqIEByZXR1cm4gbnVsbHxzdHJpbmcNCiAqLw0KZnVuY3Rpb24gTWFrZUxlZnRNZW51KCRyZXF1aXJlQWN0aW9uLCAkc3RyTmFtZSwgJHN0clVybCwgJHN0ckxpSWQsICRzdHJBSWQsICRzdHJJbWdVcmwsICRzdHJJY29uQ2xhc3MgPSAiIikNCnsNCiAgICBnbG9iYWwgJHpicDsNCg0KICAgIHN0YXRpYyAkQWRtaW5MZWZ0TWVudUNvdW50ID0gMDsNCiAgICBpZiAoJHpicC0+Q2hlY2tSaWdodHMoJHJlcXVpcmVBY3Rpb24pID09IGZhbHNlKSB7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICAkQWRtaW5MZWZ0TWVudUNvdW50ID0gKCRBZG1pbkxlZnRNZW51Q291bnQgKyAxKTsNCiAgICAkdG1wID0gbnVsbDsNCiAgICANCiAgICBpZiAoJHN0ckljb25DbGFzcyAhPSAiIikgew0KICAgICAgICAkdG1wID0gIjxsaSBpZD1cIiIgLiAkc3RyTGlJZCAuICJcIj48YSBpZD1cIiIgLiAkc3RyQUlkIC4gIlwiIGhyZWY9XCIiIC4gJHN0clVybCAuICJcIiB0aXRsZT1cIiIgLiBzdHJpcF90YWdzKCRzdHJOYW1lKSAuICJcIj48c3Bhbj48aSBjbGFzcz1cIiIgLiAkc3RySWNvbkNsYXNzIC4gIlwiPjwvaT4iIC4gJHN0ck5hbWUgLiAiPC9zcGFuPjwvYT48L2xpPiI7DQogICAgfSBlbHNlaWYgKCRzdHJJbWdVcmwgIT0gIiIpIHsNCiAgICAgICAgJHRtcCA9ICI8bGkgaWQ9XCIiIC4gJHN0ckxpSWQgLiAiXCI+PGEgaWQ9XCIiIC4gJHN0ckFJZCAuICJcIiBocmVmPVwiIiAuICRzdHJVcmwgLiAiXCIgdGl0bGU9XCIiIC4gc3RyaXBfdGFncygkc3RyTmFtZSkgLiAiXCI+PHNwYW4gY2xhc3M9XCJiZ2ljb25cIiBzdHlsZT1cImJhY2tncm91bmQtaW1hZ2U6dXJsKCciIC4gJHN0ckltZ1VybCAuICInKVwiPiIgLiAkc3RyTmFtZSAuICI8L3NwYW4+PC9hPjwvbGk+IjsNCiAgICB9IGVsc2Ugew0KICAgICAgICAkdG1wID0gIjxsaSBpZD1cIiIgLiAkc3RyTGlJZCAuICJcIj48YSBpZD1cIiIgLiAkc3RyQUlkIC4gIlwiIGhyZWY9XCIiIC4gJHN0clVybCAuICJcIiB0aXRsZT1cIiIgLiBzdHJpcF90YWdzKCRzdHJOYW1lKSAuICJcIj48c3Bhbj48aSBjbGFzcz1cImljb24td2luZG93LWZpbGxcIj48L2k+IiAuICRzdHJOYW1lIC4gIjwvc3Bhbj48L2E+PC9saT4iOw0KICAgIH0NCg0KICAgIHJldHVybiAkdG1wOw0KfQ0KDQovLyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KDQovKioNCiAqIOeUn+aIkOmAmueUqOihqOWNleeahG9wdGlvbuWIl+ihqC4NCiAqDQogKiBAcGFyYW0gJGRlZmF1bHQNCiAqIEBwYXJhbSAkYXJyYXkNCiAqIEBwYXJhbSAkbmFtZQ0KICoNCiAqIEByZXR1cm4gbnVsbHxzdHJpbmcNCiAqLw0KZnVuY3Rpb24gT3V0cHV0T3B0aW9uSXRlbXNPZkNvbW1vbigkZGVmYXVsdCwgJGFycmF5LCAkbmFtZSA9ICdDb21tb24nKQ0Kew0KICAgIGdsb2JhbCAkemJwOw0KICAgICRzID0gbnVsbDsNCiAgICAkdHogPSAkYXJyYXk7DQogICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fT3V0cHV0T3B0aW9uSXRlbXNPZkNvbW1vbiddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAkZnByZXR1cm4gPSAkZnBuYW1lKCRkZWZhdWx0LCAkdHosICRuYW1lKTsNCiAgICAgICAgaWYgKCRmcHNpZ25hbCA9PSBQTFVHSU5fRVhJVFNJR05BTF9SRVRVUk4pIHsNCiAgICAgICAgICAgICRmcHNpZ25hbCA9IFBMVUdJTl9FWElUU0lHTkFMX05PTkU7DQogICAgICAgICAgICByZXR1cm4gJGZwcmV0dXJuOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgZm9yZWFjaCAoJHR6IGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICRzIC49ICc8b3B0aW9uIHZhbHVlPSInIC4gJGtleSAuICciICcgLiAoJGRlZmF1bHQgPT0gJGtleSA/ICdzZWxlY3RlZD0ic2VsZWN0ZWQiJyA6ICcnKSAuICcgPicgLiAkdmFsdWUgLiAnPC9vcHRpb24+JzsNCiAgICB9DQogICAgcmV0dXJuICRzOw0KfQ0KDQovKioNCiAqIOeUn+aIkOWIhuexu3NlbGVjdOihqOWNlS4NCiAqDQogKiBAcGFyYW0gJGRlZmF1bHQNCiAqDQogKiBAcmV0dXJuIG51bGx8c3RyaW5nDQogKi8NCmZ1bmN0aW9uIE91dHB1dE9wdGlvbkl0ZW1zT2ZDYXRlZ29yaWVzKCRkZWZhdWx0LCAkdHlwZSA9IDApDQp7DQogICAgZ2xvYmFsICR6YnA7DQoNCiAgICAkcyA9IG51bGw7DQogICAgJHR6ID0gYXJyYXkoKTsNCiAgICBmb3JlYWNoICgkemJwLT5jYXRlZ29yaWVzYnlvcmRlcl90eXBlWyR0eXBlXSBhcyAkaWQgPT4gJGNhdGUpIHsNCiAgICAgICAgJHR6WyRjYXRlLT5JRF0gPSAkY2F0ZS0+U3ltYm9sTmFtZTsNCiAgICB9DQogICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fT3V0cHV0T3B0aW9uSXRlbXNPZkNhdGVnb3JpZXMnXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgJGZwcmV0dXJuID0gJGZwbmFtZSgkZGVmYXVsdCwgJHR6LCAkdHlwZSk7DQogICAgICAgIGlmICgkZnBzaWduYWwgPT0gUExVR0lOX0VYSVRTSUdOQUxfUkVUVVJOKSB7DQogICAgICAgICAgICAkZnBzaWduYWwgPSBQTFVHSU5fRVhJVFNJR05BTF9OT05FOw0KICAgICAgICAgICAgcmV0dXJuICRmcHJldHVybjsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGZvcmVhY2ggKCR0eiBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAkcyAuPSAnPG9wdGlvbiB2YWx1ZT0iJyAuICRrZXkgLiAnIiAnIC4gKCRkZWZhdWx0ID09ICRrZXkgPyAnc2VsZWN0ZWQ9InNlbGVjdGVkIicgOiAnJykgLiAnID4nIC4gJHZhbHVlIC4gJzwvb3B0aW9uPic7DQogICAgfQ0KICAgIHJldHVybiAkczsNCn0NCg0KLyoqDQogKiDnlJ/miJDmqKHmnb9zZWxlY3TooajljZUuDQogKg0KICogQHBhcmFtICRkZWZhdWx0DQogKiBAcGFyYW0gJHJlZnVzZV9maWxlX2ZpbHRlcg0KICogQHBhcmFtICRhY2NlcHRfdHlwZQ0KICoNCiAqIEByZXR1cm4gbnVsbHxzdHJpbmcNCiAqLw0KZnVuY3Rpb24gT3V0cHV0T3B0aW9uSXRlbXNPZlRlbXBsYXRlKCRkZWZhdWx0LCAkcmVmdXNlX2ZpbGVfZmlsdGVyID0gYXJyYXkoKSwgJGFjY2VwdF90eXBlID0gYXJyYXkoKSkNCnsNCiAgICBnbG9iYWwgJHpicDsNCiAgICAkdGVzdFJlZ0V4cCA9ICIvXihcLnxwb3N0LXxtb2R1bGV8aGVhZGVyfGZvb3Rlcnxjb21tZW50fHNpZGViYXJ8cGFnZWJhcnxbYS16QS1aXVxfKS9zaSI7DQogICAgJHMgPSBudWxsOw0KICAgICR0eiA9IGFycmF5KCk7DQogICAgJHR6WycnXSA9ICR6YnAtPmxhbmdbJ21zZyddWydub25lJ107DQoNCiAgICAvL3R5cGUgPSBsaXN0LHNpbmdsZSxhcnRpY2xlLHBhZ2UsY2F0ZWdvcnksdGFnLGF1dGhvcixkYXRl77yM5Y+v5Lul5bm25YiX5aSa5LiqDQoNCiAgICBmb3JlYWNoICgkemJwLT50ZW1wbGF0ZS0+dGVtcGxhdGVzIGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgIGlmIChwcmVnX21hdGNoKCR0ZXN0UmVnRXhwLCAka2V5KSkgew0KICAgICAgICAgICAgY29udGludWU7DQogICAgICAgIH0NCg0KICAgICAgICAkYiA9IGZhbHNlOw0KICAgICAgICBmb3JlYWNoICgkcmVmdXNlX2ZpbGVfZmlsdGVyIGFzICRrZXkyID0+ICR2YWx1ZTIpIHsNCiAgICAgICAgICAgICR0ZXN0UmVnRXhwMiA9ICIvLiooJHZhbHVlMikvc2kiOw0KICAgICAgICAgICAgaWYgKHByZWdfbWF0Y2goJHRlc3RSZWdFeHAyLCAka2V5KSkgew0KICAgICAgICAgICAgICAgICRiID0gdHJ1ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBpZiAoJGIgPT0gdHJ1ZSkgew0KICAgICAgICAgICAgY29udGludWU7DQogICAgICAgIH0NCg0KICAgICAgICAkbmFtZSA9ICR6YnAtPnRlbXBsYXRlLT50ZW1wbGF0ZXNfTmFtZVska2V5XTsNCiAgICAgICAgJHR5cGUgPSAkemJwLT50ZW1wbGF0ZS0+dGVtcGxhdGVzX1R5cGVbJGtleV07DQogICAgICAgICR0eXBlQXJyYXkgPSBleHBsb2RlKCd8JywgJHR5cGUpOw0KDQogICAgICAgIGlmIChzdHJ0b2xvd2VyKCR0eXBlKSA9PSAnbm9uZScpIHsNCiAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICB9DQoNCiAgICAgICAgLy/liKTmlq3kuLvpopjmmK/lkKblr7nmqKHmnb/ov5vooYzkuoZUZW1wbGF0ZSBUeXBl5qCH5rOoDQogICAgICAgIGlmICgkemJwLT50ZW1wbGF0ZS0+aXN1c2VfbmFtZWFuZHR5cGUgPT0gdHJ1ZSkgey8v55SoJGFjY2VwdF90eXBl5Y675qOA5p+lJHR5cGVBcnJhee+8jOS4uuecnyRj5bCx5pivdHJ1ZeWwseWPr+S7peaUvuWFpeWIl+ihqA0KICAgICAgICAgICAgJGMgPSBmYWxzZTsNCiAgICAgICAgICAgIGZvcmVhY2ggKCRhY2NlcHRfdHlwZSBhcyAkazEgPT4gJHYxKSB7DQogICAgICAgICAgICAgICAgZm9yZWFjaCAoJHR5cGVBcnJheSBhcyAkazIgPT4gJHYyKSB7DQogICAgICAgICAgICAgICAgICAgIGlmIChzdHJ0b2xvd2VyKHRyaW0oJHYxKSkgPT0gc3RydG9sb3dlcih0cmltKCR2MikpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAkYyA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoJGMpIHsNCiAgICAgICAgICAgICAgICBpZiAoJGRlZmF1bHQgPT0gJGtleSkgew0KICAgICAgICAgICAgICAgICAgICAkczIgPSAoJG5hbWUgIT09ICcnKSA/ICcgKCcgLiAkbmFtZSAuICcpJyA6ICRuYW1lOw0KICAgICAgICAgICAgICAgICAgICAkdHpbJGtleV0gPSAnWycgLiAkemJwLT5sYW5nWydtc2cnXVsnY3VycmVudF90ZW1wbGF0ZSddIC4gJ10gJyAuICRrZXkgLiAkczI7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgJHMyID0gKCRuYW1lICE9PSAnJykgPyAnICgnIC4gJG5hbWUgLiAnKScgOiAkbmFtZTsNCiAgICAgICAgICAgICAgICAgICAgJHR6WyRrZXldID0gJGtleSAuICRzMjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSB7IC8v5rKh5pyJ5qCH5rOo5bCx55So5Lyg57uf5pa55rOVDQogICAgICAgICAgICBpZiAoJGRlZmF1bHQgPT0gJGtleSkgew0KICAgICAgICAgICAgICAgICRzMiA9ICgkbmFtZSAhPT0gJycpID8gJyAoJyAuICRuYW1lIC4gJyknIDogJG5hbWU7DQogICAgICAgICAgICAgICAgJHR6WyRrZXldID0gJ1snIC4gJHpicC0+bGFuZ1snbXNnJ11bJ2N1cnJlbnRfdGVtcGxhdGUnXSAuICddICcgLiAka2V5IC4gJHMyOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAkczIgPSAoJG5hbWUgIT09ICcnKSA/ICcgKCcgLiAkbmFtZSAuICcpJyA6ICRuYW1lOw0KICAgICAgICAgICAgICAgICR0elska2V5XSA9ICRrZXkgLiAkczI7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9PdXRwdXRPcHRpb25JdGVtc09mVGVtcGxhdGUnXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgJGZwcmV0dXJuID0gJGZwbmFtZSgkZGVmYXVsdCwgJHR6LCAkcmVmdXNlX2ZpbGVfZmlsdGVyLCAkYWNjZXB0X3R5cGUpOw0KICAgICAgICBpZiAoJGZwc2lnbmFsID09IFBMVUdJTl9FWElUU0lHTkFMX1JFVFVSTikgew0KICAgICAgICAgICAgJGZwc2lnbmFsID0gUExVR0lOX0VYSVRTSUdOQUxfTk9ORTsNCiAgICAgICAgICAgIHJldHVybiAkZnByZXR1cm47DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBmb3JlYWNoICgkdHogYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgJHMgLj0gJzxvcHRpb24gdmFsdWU9IicgLiAka2V5IC4gJyIgJyAuICgkZGVmYXVsdCA9PSAka2V5ID8gJ3NlbGVjdGVkPSJzZWxlY3RlZCInIDogJycpIC4gJyA+JyAuICR2YWx1ZSAuICc8L29wdGlvbj4nOw0KICAgIH0NCiAgICByZXR1cm4gJHM7DQp9DQoNCi8qKg0KICog55Sf5oiQ55So5oi3562J57qnc2VsZWN06KGo5Y2VLg0KICoNCiAqIEBwYXJhbSAkZGVmYXVsdA0KICoNCiAqIEByZXR1cm4gbnVsbHxzdHJpbmcNCiAqLw0KZnVuY3Rpb24gT3V0cHV0T3B0aW9uSXRlbXNPZk1lbWJlckxldmVsKCRkZWZhdWx0KQ0Kew0KICAgIGdsb2JhbCAkemJwOw0KDQogICAgJHMgPSBudWxsOw0KICAgICR0eiA9IGFycmF5KCk7DQogICAgaWYgKCEkemJwLT5DaGVja1JpZ2h0cygnTWVtYmVyQWxsJykpIHsNCiAgICAgICAgJHR6WyRkZWZhdWx0XSA9ICR6YnAtPmxhbmdbJ3VzZXJfbGV2ZWxfbmFtZSddWyRkZWZhdWx0XTsNCiAgICB9IGVsc2Ugew0KICAgICAgICBmb3IgKCRpID0gMTsgJGkgPCAoY291bnQoJHpicC0+bGFuZ1sndXNlcl9sZXZlbF9uYW1lJ10pICsgMSk7ICRpKyspIHsNCiAgICAgICAgICAgICR0elskaV0gPSAkemJwLT5sYW5nWyd1c2VyX2xldmVsX25hbWUnXVskaV07DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9PdXRwdXRPcHRpb25JdGVtc09mTWVtYmVyTGV2ZWwnXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgJGZwcmV0dXJuID0gJGZwbmFtZSgkZGVmYXVsdCk7DQogICAgICAgIGlmICgkZnBzaWduYWwgPT0gUExVR0lOX0VYSVRTSUdOQUxfUkVUVVJOKSB7DQogICAgICAgICAgICAkZnBzaWduYWwgPSBQTFVHSU5fRVhJVFNJR05BTF9OT05FOw0KICAgICAgICAgICAgcmV0dXJuICRmcHJldHVybjsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGZvcmVhY2ggKCR0eiBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAkcyAuPSAnPG9wdGlvbiB2YWx1ZT0iJyAuICRrZXkgLiAnIiAnIC4gKCRkZWZhdWx0ID09ICRrZXkgPyAnc2VsZWN0ZWQ9InNlbGVjdGVkIicgOiAnJykgLiAnID4nIC4gJHZhbHVlIC4gJzwvb3B0aW9uPic7DQogICAgfQ0KICAgIHJldHVybiAkczsNCn0NCg0KLyoqDQogKiDnlJ/miJDnlKjmiLdzZWxlY3TooajljZUuDQogKg0KICogQHBhcmFtICRkZWZhdWx0DQogKg0KICogQHJldHVybiBudWxsfHN0cmluZw0KICovDQpmdW5jdGlvbiBPdXRwdXRPcHRpb25JdGVtc09mTWVtYmVyKCRkZWZhdWx0KQ0Kew0KICAgIGdsb2JhbCAkemJwOw0KDQogICAgJHMgPSBudWxsOw0KICAgICR0eiA9IGFycmF5KCk7DQoNCiAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9PdXRwdXRPcHRpb25JdGVtc09mTWVtYmVyX0JlZ2luJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICRmcHJldHVybiA9ICRmcG5hbWUoJGRlZmF1bHQsICR0eik7DQogICAgICAgIGlmICgkZnBzaWduYWwgPT0gUExVR0lOX0VYSVRTSUdOQUxfUkVUVVJOKSB7DQogICAgICAgICAgICAkZnBzaWduYWwgPSBQTFVHSU5fRVhJVFNJR05BTF9OT05FOw0KICAgICAgICAgICAgcmV0dXJuICRmcHJldHVybjsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGlmICghJHpicC0+Q2hlY2tSaWdodHMoJ0FydGljbGVBbGwnKSkgew0KICAgICAgICBpZiAoIWlzc2V0KCR6YnAtPm1lbWJlcnNbJGRlZmF1bHRdKSkgew0KICAgICAgICAgICAgJHR6WzBdID0gJyc7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkdHpbJGRlZmF1bHRdID0gJHpicC0+bWVtYmVyc1skZGVmYXVsdF0tPk5hbWU7DQogICAgICAgIH0NCiAgICB9IGVsc2Ugew0KICAgICAgICBmb3IgKCRpID0gMTsgJGkgPCAoY291bnQoJHpicC0+bGFuZ1sndXNlcl9sZXZlbF9uYW1lJ10pICsgMSk7ICRpKyspIHsNCiAgICAgICAgICAgIGlmICgkemJwLT5DaGVja1JpZ2h0c0J5TGV2ZWwoJ0FydGljbGVFZHQnLCAkaSkgPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICAkemJwLT5Mb2FkTWVtYmVycygkaSk7DQogICAgICAgICRtZW1iZXJieW5hbWUgPSBhcnJheSgpOw0KICAgICAgICBmb3JlYWNoICgkemJwLT5tZW1iZXJzIGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICAgICBpZiAoJHpicC0+Q2hlY2tSaWdodHNCeUxldmVsKCdBcnRpY2xlRWR0JywgJHpicC0+bWVtYmVyc1ska2V5XS0+TGV2ZWwpKSB7DQogICAgICAgICAgICAgICAgJG1lbWJlcmJ5bmFtZVskemJwLT5tZW1iZXJzWyRrZXldLT5OYW1lXSA9ICR6YnAtPm1lbWJlcnNbJGtleV0tPklEOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGtzb3J0KCRtZW1iZXJieW5hbWUpOw0KICAgICAgICBmb3JlYWNoICgkbWVtYmVyYnluYW1lIGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICAgICAkdHpbJHZhbHVlXSA9ICRrZXk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9PdXRwdXRPcHRpb25JdGVtc09mTWVtYmVyJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICRmcHJldHVybiA9ICRmcG5hbWUoJGRlZmF1bHQsICR0eik7DQogICAgICAgIGlmICgkZnBzaWduYWwgPT0gUExVR0lOX0VYSVRTSUdOQUxfUkVUVVJOKSB7DQogICAgICAgICAgICAkZnBzaWduYWwgPSBQTFVHSU5fRVhJVFNJR05BTF9OT05FOw0KICAgICAgICAgICAgcmV0dXJuICRmcHJldHVybjsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGZvcmVhY2ggKCR0eiBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAkcyAuPSAnPG9wdGlvbiB2YWx1ZT0iJyAuICRrZXkgLiAnIiAnIC4gKCRkZWZhdWx0ID09ICRrZXkgPyAnc2VsZWN0ZWQ9InNlbGVjdGVkIicgOiAnJykgLiAnID4nIC4gJHZhbHVlIC4gJzwvb3B0aW9uPic7DQogICAgfQ0KICAgIHJldHVybiAkczsNCn0NCg0KLyoqDQogKiDnlJ/miJDmlofnq6BJc1RvcOeKtuaAgXNlbGVjdOihqOWNlS4NCiAqDQogKiBAcGFyYW0gJGRlZmF1bHQNCiAqDQogKiBAcmV0dXJuIG51bGx8c3RyaW5nDQogKi8NCmZ1bmN0aW9uIE91dHB1dE9wdGlvbkl0ZW1zT2ZJc1RvcCgkZGVmYXVsdCkNCnsNCiAgICBnbG9iYWwgJHpicDsNCg0KICAgICRzID0gbnVsbDsNCiAgICAkdHogPSBhcnJheSgpOw0KICAgICR0elswXSA9ICR6YnAtPmxhbmdbJ21zZyddWydub25lJ107DQogICAgJHR6WzJdID0gJHpicC0+bGFuZ1snbXNnJ11bJ3RvcF9pbmRleCddOw0KICAgICR0elsxXSA9ICR6YnAtPmxhbmdbJ21zZyddWyd0b3BfZ2xvYmFsJ107DQogICAgJHR6WzRdID0gJHpicC0+bGFuZ1snbXNnJ11bJ3RvcF9jYXRlZ29yeSddOw0KDQogICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fT3V0cHV0T3B0aW9uSXRlbXNPZklzVG9wJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICRmcHJldHVybiA9ICRmcG5hbWUoJGRlZmF1bHQsICR0eik7DQogICAgICAgIGlmICgkZnBzaWduYWwgPT0gUExVR0lOX0VYSVRTSUdOQUxfUkVUVVJOKSB7DQogICAgICAgICAgICAkZnBzaWduYWwgPSBQTFVHSU5fRVhJVFNJR05BTF9OT05FOw0KICAgICAgICAgICAgcmV0dXJuICRmcHJldHVybjsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGZvcmVhY2ggKCR0eiBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAkcyAuPSAnPG9wdGlvbiB2YWx1ZT0iJyAuICRrZXkgLiAnIiAnIC4gKCRkZWZhdWx0ID09ICRrZXkgPyAnc2VsZWN0ZWQ9InNlbGVjdGVkIicgOiAnJykgLiAnID4nIC4gJHZhbHVlIC4gJzwvb3B0aW9uPic7DQogICAgfQ0KDQogICAgcmV0dXJuICRzOw0KfQ0KDQovKioNCiAqIOeUn+aIkOaWh+eroOWPkeW4g+eKtuaAgXNlbGVjdOihqOWNlS4NCiAqDQogKiBAcGFyYW0gJGRlZmF1bHQNCiAqDQogKiBAcmV0dXJuIG51bGx8c3RyaW5nDQogKi8NCmZ1bmN0aW9uIE91dHB1dE9wdGlvbkl0ZW1zT2ZQb3N0U3RhdHVzKCRkZWZhdWx0KQ0Kew0KICAgIGdsb2JhbCAkemJwOw0KDQogICAgJHMgPSAnJzsNCiAgICAkdHogPSBhcnJheSgpOw0KICAgIGlmICghJHpicC0+Q2hlY2tSaWdodHMoJ0FydGljbGVQdWInKSAmJiAkZGVmYXVsdCA9PSAyKSB7DQogICAgICAgICR0elsyXSA9ICR6YnAtPmxhbmdbJ3Bvc3Rfc3RhdHVzX25hbWUnXVsnMiddOw0KICAgIH0gZWxzZWlmICghJHpicC0+Q2hlY2tSaWdodHMoJ0FydGljbGVBbGwnKSAmJiAkZGVmYXVsdCA9PSAyKSB7DQogICAgICAgICR0elsyXSA9ICR6YnAtPmxhbmdbJ3Bvc3Rfc3RhdHVzX25hbWUnXVsnMiddOw0KICAgIH0gZWxzZSB7DQogICAgICAgICR0elswXSA9ICR6YnAtPmxhbmdbJ3Bvc3Rfc3RhdHVzX25hbWUnXVsnMCddOw0KICAgICAgICAkdHpbMV0gPSAkemJwLT5sYW5nWydwb3N0X3N0YXR1c19uYW1lJ11bJzEnXTsNCiAgICAgICAgaWYgKCR6YnAtPkNoZWNrUmlnaHRzKCdBcnRpY2xlQWxsJykpIHsNCiAgICAgICAgICAgICR0elsyXSA9ICR6YnAtPmxhbmdbJ3Bvc3Rfc3RhdHVzX25hbWUnXVsnMiddOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fT3V0cHV0T3B0aW9uSXRlbXNPZlBvc3RTdGF0dXMnXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgJGZwcmV0dXJuID0gJGZwbmFtZSgkZGVmYXVsdCwgJHR6KTsNCiAgICAgICAgaWYgKCRmcHNpZ25hbCA9PSBQTFVHSU5fRVhJVFNJR05BTF9SRVRVUk4pIHsNCiAgICAgICAgICAgICRmcHNpZ25hbCA9IFBMVUdJTl9FWElUU0lHTkFMX05PTkU7DQogICAgICAgICAgICByZXR1cm4gJGZwcmV0dXJuOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgZm9yZWFjaCAoJHR6IGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICRzIC49ICc8b3B0aW9uIHZhbHVlPSInIC4gJGtleSAuICciICcgLiAoJGRlZmF1bHQgPT0gJGtleSA/ICdzZWxlY3RlZD0ic2VsZWN0ZWQiJyA6ICcnKSAuICcgPicgLiAkdmFsdWUgLiAnPC9vcHRpb24+JzsNCiAgICB9DQoNCiAgICByZXR1cm4gJHM7DQp9DQoNCi8qKg0KICog5Yib5bu6RGl25qih5Z2XLg0KICoNCiAqIEBwYXJhbSAkbQ0KICogQHBhcmFtIGJvb2wgJGJ1dHRvbg0KICovDQpmdW5jdGlvbiBDcmVhdGVNb2R1bGVEaXYoJG0sICRidXR0b24gPSB0cnVlKQ0Kew0KICAgIGdsb2JhbCAkemJwOw0KDQogICAgZWNobyAnPGRpdiBjbGFzcz0id2lkZ2V0IHdpZGdldF9zb3VyY2VfJyAuICRtLT5Tb3VyY2VUeXBlIC4gJyB3aWRnZXRfaWRfJyAuICRtLT5GaWxlTmFtZSAuICciPic7DQogICAgZWNobyAnPGRpdiBjbGFzcz0id2lkZ2V0LXRpdGxlIj48aSBjbGFzcz0iaWNvbi1sYXlvdXQtd3RmIG1vZHVsZS1pY29uIj48L2k+JyAuICgoJG0tPlNvdXJjZVR5cGUgIT0gJ3RoZW1laW5jbHVkZScpID8gJG0tPk5hbWUgOiAkbS0+RmlsZU5hbWUpIC4gJyc7DQoNCiAgICBpZiAoJGJ1dHRvbikgew0KICAgICAgICBlY2hvICc8c3BhbiBjbGFzcz0id2lkZ2V0LWFjdGlvbiI+PGEgaHJlZj0iLi4vY21kLnBocD9hY3Q9TW9kdWxlRWR0JmFtcDtpZD0nIC4gJG0tPklEIC4gJyI+PGkgY2xhc3M9Imljb24tcGVuY2lsLXNxdWFyZSI+PC9pPjwvYT4nOw0KDQogICAgICAgIGlmICgkbS0+U291cmNlVHlwZSA9PSAndXNlcicgfHwgJG0tPlNvdXJjZVR5cGUgPT0gJ3RoZW1laW5jbHVkZScpIHsNCiAgICAgICAgICAgIGVjaG8gJyZuYnNwOzxhIG9uY2xpY2s9InJldHVybiB3aW5kb3cuY29uZmlybShcJycgLiBzdHJfcmVwbGFjZShhcnJheSgnIicsJ1wnJyksICcnLCAkemJwLT5sYW5nWydtc2cnXVsnY29uZmlybV9vcGVyYXRpbmcnXSkgLiAnXCcpOyIgaHJlZj0iJyAuIEJ1aWxkU2FmZUNtZFVSTCgnYWN0PU1vZHVsZURlbCZhbXA7aWQ9JyAuICRtLT5JRCkgLiAnIj48aSBjbGFzcz0iaWNvbi10cmFzaCI+PC9pPjwvYT4nOw0KICAgICAgICB9DQogICAgICAgIGVjaG8gJzwvc3Bhbj4nOw0KICAgIH0NCg0KICAgIGVjaG8gJzwvZGl2Pic7DQogICAgZWNobyAnPGRpdiBjbGFzcz0iZnVuaWQiIHN0eWxlPSJkaXNwbGF5Om5vbmUiPicgLiAkbS0+RmlsZU5hbWUgLiAnPC9kaXY+JzsNCiAgICBlY2hvICc8L2Rpdj4nOw0KfQ0KDQovKioNCiAqIOeUn+aIkFRZUEVzZWxlY3TooajljZUuDQogKg0KICogQHBhcmFtICRkZWZhdWx0DQogKg0KICogQHJldHVybiBudWxsfHN0cmluZw0KICovDQpmdW5jdGlvbiBPdXRwdXRPcHRpb25JdGVtc09mUG9zdFR5cGUoJGRlZmF1bHQpDQp7DQogICAgZ2xvYmFsICR6YnA7DQogICAgJHMgPSBudWxsOw0KICAgICR0eiA9IGFycmF5KCk7DQoNCiAgICBmb3JlYWNoICgkemJwLT5wb3N0dHlwZSBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAkdHpbJGtleV0gPSAkdmFsdWVbMF07DQogICAgfQ0KDQogICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fT3V0cHV0T3B0aW9uSXRlbXNPZkNvbW1vbiddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAkZnByZXR1cm4gPSAkZnBuYW1lKCRkZWZhdWx0LCAkdHosICdQb3N0VHlwZScpOw0KICAgICAgICBpZiAoJGZwc2lnbmFsID09IFBMVUdJTl9FWElUU0lHTkFMX1JFVFVSTikgew0KICAgICAgICAgICAgJGZwc2lnbmFsID0gUExVR0lOX0VYSVRTSUdOQUxfTk9ORTsNCiAgICAgICAgICAgIHJldHVybiAkZnByZXR1cm47DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBmb3JlYWNoICgkdHogYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgJHMgLj0gJzxvcHRpb24gdmFsdWU9IicgLiAka2V5IC4gJyIgJyAuICgkZGVmYXVsdCA9PSAka2V5ID8gJ3NlbGVjdGVkPSJzZWxlY3RlZCInIDogJycpIC4gJyA+JyAuICR2YWx1ZSAuICc8L29wdGlvbj4nOw0KICAgIH0NCiAgICByZXR1cm4gJHM7DQp9DQoNCi8qKg0KICog55Sf5oiQ5pe25Yy6c2VsZWN06KGo5Y2VLg0KICoNCiAqIEBwYXJhbSAkZGVmYXVsdA0KICoNCiAqIEByZXR1cm4gc3RyaW5nDQogKi8NCmZ1bmN0aW9uIENyZWF0ZU9wdGlvbnNPZlRpbWVab25lKCRkZWZhdWx0KQ0Kew0KICAgICRzID0gJyc7DQogICAgJHR6ID0gYXJyYXkoDQogICAgICAgICdFdGMvR01UKzEyJyAgICAgICAgICAgICAgICAgICAgID0+ICctMTI6MDAnLA0KICAgICAgICAnUGFjaWZpYy9NaWR3YXknICAgICAgICAgICAgICAgICA9PiAnLTExOjAwJywNCiAgICAgICAgJ1BhY2lmaWMvSG9ub2x1bHUnICAgICAgICAgICAgICAgPT4gJy0xMDowMCcsDQogICAgICAgICdBbWVyaWNhL0FuY2hvcmFnZScgICAgICAgICAgICAgID0+ICctMDk6MDAnLA0KICAgICAgICAnQW1lcmljYS9Mb3NfQW5nZWxlcycgICAgICAgICAgICA9PiAnLTA4OjAwJywNCiAgICAgICAgJ0FtZXJpY2EvRGVudmVyJyAgICAgICAgICAgICAgICAgPT4gJy0wNzowMCcsDQogICAgICAgICdBbWVyaWNhL1RlZ3VjaWdhbHBhJyAgICAgICAgICAgID0+ICctMDY6MDAnLA0KICAgICAgICAnQW1lcmljYS9OZXdfWW9yaycgICAgICAgICAgICAgICA9PiAnLTA1OjAwJywNCiAgICAgICAgJ0FtZXJpY2EvSGFsaWZheCcgICAgICAgICAgICAgICAgPT4gJy0wNDowMCcsDQogICAgICAgICdBbWVyaWNhL0FyZ2VudGluYS9CdWVub3NfQWlyZXMnID0+ICctMDM6MDAnLA0KICAgICAgICAnQXRsYW50aWMvU291dGhfR2VvcmdpYScgICAgICAgICA9PiAnLTAyOjAwJywNCiAgICAgICAgJ0F0bGFudGljL0F6b3JlcycgICAgICAgICAgICAgICAgPT4gJy0wMTowMCcsDQogICAgICAgICdVVEMnICAgICAgICAgICAgICAgICAgICAgICAgICAgID0+ICcwMDowMCcsDQogICAgICAgICdFdXJvcGUvQmVybGluJyAgICAgICAgICAgICAgICAgID0+ICcrMDE6MDAnLA0KICAgICAgICAnRXVyb3BlL1NvZmlhJyAgICAgICAgICAgICAgICAgICA9PiAnKzAyOjAwJywNCiAgICAgICAgJ0FmcmljYS9OYWlyb2JpJyAgICAgICAgICAgICAgICAgPT4gJyswMzowMCcsDQogICAgICAgICdFdXJvcGUvTW9zY293JyAgICAgICAgICAgICAgICAgID0+ICcrMDQ6MDAnLA0KICAgICAgICAnQXNpYS9LYXJhY2hpJyAgICAgICAgICAgICAgICAgICA9PiAnKzA1OjAwJywNCiAgICAgICAgJ0FzaWEvRGhha2EnICAgICAgICAgICAgICAgICAgICAgPT4gJyswNjowMCcsDQogICAgICAgICdBc2lhL0Jhbmdrb2snICAgICAgICAgICAgICAgICAgID0+ICcrMDc6MDAnLA0KICAgICAgICAnQXNpYS9TaGFuZ2hhaScgICAgICAgICAgICAgICAgICA9PiAnKzA4OjAwJywNCiAgICAgICAgJ0FzaWEvVG9reW8nICAgICAgICAgICAgICAgICAgICAgPT4gJyswOTowMCcsDQogICAgICAgICdQYWNpZmljL0d1YW0nICAgICAgICAgICAgICAgICAgID0+ICcrMTA6MDAnLA0KICAgICAgICAnQXVzdHJhbGlhL1N5ZG5leScgICAgICAgICAgICAgICA9PiAnKzExOjAwJywNCiAgICAgICAgJ1BhY2lmaWMvRmlqaScgICAgICAgICAgICAgICAgICAgPT4gJysxMjowMCcsDQogICAgICAgICdQYWNpZmljL1RvbmdhdGFwdScgICAgICAgICAgICAgID0+ICcrMTM6MDAnLA0KICAgICk7DQoNCiAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9PdXRwdXRPcHRpb25JdGVtc09mQ29tbW9uJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICRmcHJldHVybiA9ICRmcG5hbWUoJGRlZmF1bHQsICR0eiwgJ1RpbWVab25lJyk7DQogICAgICAgIGlmICgkZnBzaWduYWwgPT0gUExVR0lOX0VYSVRTSUdOQUxfUkVUVVJOKSB7DQogICAgICAgICAgICAkZnBzaWduYWwgPSBQTFVHSU5fRVhJVFNJR05BTF9OT05FOw0KICAgICAgICAgICAgcmV0dXJuICRmcHJldHVybjsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGZvcmVhY2ggKCR0eiBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAkcyAuPSAnPG9wdGlvbiB2YWx1ZT0iJyAuICRrZXkgLiAnIiAnIC4gKCRkZWZhdWx0ID09ICRrZXkgPyAnc2VsZWN0ZWQ9InNlbGVjdGVkIicgOiAnJykgLiAnID4nIC4gJGtleSAuICcgJyAuICR2YWx1ZSAuICc8L29wdGlvbj4nOw0KICAgIH0NCg0KICAgIHJldHVybiAkczsNCn0NCg0KLyoqDQogKiDnlJ/miJDor63oqIBzZWxlY3TooajljZUuDQogKg0KICogQHBhcmFtICRkZWZhdWx0DQogKg0KICogQHJldHVybiBzdHJpbmcNCiAqLw0KZnVuY3Rpb24gQ3JlYXRlT3B0aW9uc09mTGFuZygkZGVmYXVsdCkNCnsNCiAgICBnbG9iYWwgJHpicDsNCiAgICAkcyA9ICcnOw0KICAgICRkaXIgPSAkemJwLT51c2Vyc2RpciAuICdsYW5ndWFnZS8nOw0KICAgICRmaWxlcyA9IEdldEZpbGVzSW5EaXIoJGRpciwgJ3BocCcpOw0KICAgICR0eiA9IGFycmF5KCk7DQogICAgZm9yZWFjaCAoJGZpbGVzIGFzICRmKSB7DQogICAgICAgIGlmIChzdWJzdHIoJGYsIDAsIDEpICE9PSAnLicgJiYgc3Vic3RyKCRmLCAwLCAxKSAhPT0gJ18nKSB7DQogICAgICAgICAgICAkbiA9IGJhc2VuYW1lKCRmLCAnLnBocCcpOw0KICAgICAgICAgICAgLy9maXggMS4zIHRvIDEuNCB3YXJuaW5nDQogICAgICAgICAgICBpZiAoJ1NpbXBDaGluZXNlJyA9PSAkbikgew0KICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoJ1RyYWRDaGluZXNlJyA9PSAkbikgew0KICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAkdCA9IGluY2x1ZGUgJGY7DQogICAgICAgICAgICAkdHpbJG5dID0gJHRbJ2xhbmdfbmFtZSddIC4gJyAoJyAuICRuIC4gJyknOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fT3V0cHV0T3B0aW9uSXRlbXNPZkNvbW1vbiddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAkZnByZXR1cm4gPSAkZnBuYW1lKCRkZWZhdWx0LCAkdHosICdMYW5nJyk7DQogICAgICAgIGlmICgkZnBzaWduYWwgPT0gUExVR0lOX0VYSVRTSUdOQUxfUkVUVVJOKSB7DQogICAgICAgICAgICAkZnBzaWduYWwgPSBQTFVHSU5fRVhJVFNJR05BTF9OT05FOw0KICAgICAgICAgICAgcmV0dXJuICRmcHJldHVybjsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGZvcmVhY2ggKCR0eiBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAkcyAuPSAnPG9wdGlvbiB2YWx1ZT0iJyAuICRrZXkgLiAnIiAnIC4gKCRkZWZhdWx0ID09ICRrZXkgPyAnc2VsZWN0ZWQ9InNlbGVjdGVkIicgOiAnJykgLiAnID4nIC4gJGtleSAuICcgJyAuICR2YWx1ZSAuICc8L29wdGlvbj4nOw0KICAgIH0NCiAgICByZXR1cm4gJHM7DQp9DQoNCi8qKg0KICog55Sf5oiQR3Vlc3RUeXBl6KGo5Y2VLg0KICoNCiAqIEBwYXJhbSAkZGVmYXVsdA0KICoNCiAqIEByZXR1cm4gc3RyaW5nDQogKi8NCmZ1bmN0aW9uIENyZWF0ZU9wdGlvbnNPZkd1ZXN0SVBUeXBlKCRkZWZhdWx0KQ0Kew0KICAgIGdsb2JhbCAkemJwOw0KICAgICRzID0gJyc7DQogICAgJHR6ID0gYXJyYXkoDQogICAgICAgICdSRU1PVEVfQUREUicgICAgICAgICAgICAgICAgICAgID0+ICdSRU1PVEVfQUREUiAoJyAuICR6YnAtPmxhbmdbJ21zZyddWydkZWZhdWx0J10gLiAnKSAnIC4gR2V0VmFycygnUkVNT1RFX0FERFInLCAnU0VSVkVSJyksDQogICAgICAgICdIVFRQX1hfRk9SV0FSREVEX0ZPUicgICAgICAgICAgID0+ICdIVFRQX1hfRk9SV0FSREVEX0ZPUiAo6IW+6K6v5LqRLOmYv+mHjOS6kSzkuIPniZspICcgLiBHZXRWYXJzKCdIVFRQX1hfRk9SV0FSREVEX0ZPUicsICdTRVJWRVInKSwNCiAgICAgICAgJ0hUVFBfWF9SRUFMX0lQJyAgICAgICAgICAgICAgICAgPT4gJ0hUVFBfWF9SRUFMX0lQICjlj4jmi43kupEs55m+5bqmQ0ROKScgLiBHZXRWYXJzKCdIVFRQX1hfUkVBTF9JUCcsICdTRVJWRVInKSwNCiAgICAgICAgJ0hUVFBfQ0ZfQ09OTkVDVElOR19JUCcgICAgICAgICAgPT4gJ0hUVFBfQ0ZfQ09OTkVDVElOR19JUCAoQ2xvdWRGbGFyZSkgJyAuIEdldFZhcnMoJ0hUVFBfQ0ZfQ09OTkVDVElOR19JUCcsICdTRVJWRVInKSwNCiAgICAgICAgJ0hUVFBfQ0xJRU5UX0lQJyAgICAgICAgICAgICAgICAgPT4gJ0hUVFBfQ0xJRU5UX0lQICcgLiBHZXRWYXJzKCdIVFRQX0NMSUVOVF9JUCcsICdTRVJWRVInKSwNCiAgICApOw0KDQogICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fT3V0cHV0T3B0aW9uSXRlbXNPZkNvbW1vbiddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAkZnByZXR1cm4gPSAkZnBuYW1lKCRkZWZhdWx0LCAkdHosICdHdWVzdElQVHlwZScpOw0KICAgICAgICBpZiAoJGZwc2lnbmFsID09IFBMVUdJTl9FWElUU0lHTkFMX1JFVFVSTikgew0KICAgICAgICAgICAgJGZwc2lnbmFsID0gUExVR0lOX0VYSVRTSUdOQUxfTk9ORTsNCiAgICAgICAgICAgIHJldHVybiAkZnByZXR1cm47DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBmb3JlYWNoICgkdHogYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgJHMgLj0gJzxvcHRpb24gdmFsdWU9IicgLiAka2V5IC4gJyIgJyAuICgkZGVmYXVsdCA9PSAka2V5ID8gJ3NlbGVjdGVkPSJzZWxlY3RlZCInIDogJycpIC4gJyA+JyAuICR2YWx1ZSAuICc8L29wdGlvbj4nOw0KICAgIH0NCiAgICByZXR1cm4gJHM7DQp9DQoNCi8qKg0KICog55Sf5oiQ5o6S5bqP5oyJ6ZKuDQogKi8NCmZ1bmN0aW9uIE1ha2VPcmRlckJ1dHRvbigkaWQsICR1cmxydWxlLCAkb3JkZXJfZ2V0LCAkZGVmYXVsdCA9ICdhc2MnKQ0Kew0KICAgICRidXR0b25fb3JkZXJfaWRfY2xhc3MgPSAnJzsNCiAgICBpZiAoJG9yZGVyX2dldCA9PSAkaWQgLiAnX2FzYycgfHwgJG9yZGVyX2dldCA9PSAkaWQgLiAnX2Rlc2MnKSB7DQogICAgICAgICRidXR0b25fb3JkZXJfaWRfY2xhc3MgPSAnZWxlbWVudC12aXNpYmlsaXR5LXZpc2libGUtYWx3YXlzICc7DQogICAgfQ0KICAgIGlmICgkb3JkZXJfZ2V0ID09ICRpZCAuICdfYXNjJykgew0KICAgICAgICAkYnV0dG9uX29yZGVyX2lkX29yZGVyID0gJGlkIC4gJ19kZXNjJzsNCiAgICAgICAgJGJ1dHRvbl9vcmRlcl9pZF9pY29uID0gJ2ljb24tYXJyb3ctdXAtc2hvcnQnOw0KICAgICAgICAkYnV0dG9uX29yZGVyX2lkX2NsYXNzIC49ICdlbGVtZW50LXZpc2liaWxpdHktaGlkZGVuICc7DQogICAgfSBlbHNlaWYgKCRvcmRlcl9nZXQgPT0gJGlkIC4gJ19kZXNjJykgew0KICAgICAgICAkYnV0dG9uX29yZGVyX2lkX29yZGVyID0gJGlkIC4gJ19hc2MnOw0KICAgICAgICAkYnV0dG9uX29yZGVyX2lkX2ljb24gPSAnaWNvbi1hcnJvdy1kb3duLXNob3J0JzsNCiAgICAgICAgJGJ1dHRvbl9vcmRlcl9pZF9jbGFzcyAuPSAnZWxlbWVudC12aXNpYmlsaXR5LWhpZGRlbiAnOw0KICAgIH0gZWxzZSB7DQogICAgICAgIGlmICgkZGVmYXVsdCA9PSAnYXNjJykgew0KICAgICAgICAgICAgJGJ1dHRvbl9vcmRlcl9pZF9vcmRlciA9ICRpZCAuICdfYXNjJzsNCiAgICAgICAgICAgICRidXR0b25fb3JkZXJfaWRfaWNvbiA9ICdpY29uLWFycm93LWRvd24tc2hvcnQnOw0KICAgICAgICAgICAgJGJ1dHRvbl9vcmRlcl9pZF9jbGFzcyAuPSAnZWxlbWVudC12aXNpYmlsaXR5LWhpZGRlbiAnOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJGJ1dHRvbl9vcmRlcl9pZF9vcmRlciA9ICRpZCAuICdfZGVzYyc7DQogICAgICAgICAgICAkYnV0dG9uX29yZGVyX2lkX2ljb24gPSAnaWNvbi1hcnJvdy11cC1zaG9ydCc7DQogICAgICAgICAgICAkYnV0dG9uX29yZGVyX2lkX2NsYXNzIC49ICdlbGVtZW50LXZpc2liaWxpdHktaGlkZGVuICc7DQogICAgICAgIH0NCiAgICB9DQogICAgJHVybHJ1bGUtPlJ1bGVzWyd7JW9yZGVyJX0nXSA9ICRidXR0b25fb3JkZXJfaWRfb3JkZXI7DQogICAgJGJ1dHRvbl9vcmRlcl9pZCA9ICcgPGEgY2xhc3M9Im9yZGVyX2J1dHRvbiAnIC4gJGJ1dHRvbl9vcmRlcl9pZF9jbGFzcyAuICciIGhyZWY9IicgLiAkdXJscnVsZS0+TWFrZSgpIC4gJyI+PGkgc3R5bGU9ImZvbnQtc2l6ZTowLjc1ZW07IiBjbGFzcz0iJyAuICRidXR0b25fb3JkZXJfaWRfaWNvbiAuICciPjwvaT48L2E+JzsNCg0KICAgIHJldHVybiBhcnJheSgkYnV0dG9uX29yZGVyX2lkKTsNCn0NCg==</file>
	<file name='zb_system\function\c_system_function.php' crc32='3A18A67F'  dt:dt='bin.base64'>PD9waHANCi8qKg0KICog5Yqf6IO95Z6L55qE5Ye95pWwLg0KICovDQoNCmlmICghZGVmaW5lZCgnWkJQX1BBVEgnKSkgew0KICAgIGV4aXQoJ0FjY2VzcyBkZW5pZWQnKTsNCn0NCg0KLyoqDQogKiDojrflj5bmlofnq6AuDQogKg0KICogQHBhcmFtIG1peGVkICRpZG9ybmFtZSAgICDmlofnq6BpZCDmiJYg5ZCN56ew44CB5Yir5ZCNICgxLjfmlK/mjIHlpI3mnYLnmoRhcnJheeWPguaVsCwkY291bnTkuLphcnJheeaXtuWQjumdoueahOWPguaVsOWPr+S7peS4jeiuvikNCiAqIEBwYXJhbSBhcnJheSAkb3B0aW9uIHxudWxsDQogKg0KICogQHJldHVybiBQb3N0DQogKi8NCmZ1bmN0aW9uIEdldFBvc3QoJGlkb3JuYW1lLCAkb3B0aW9uID0gbnVsbCkNCnsNCiAgICAvL+aWsOeJiOacrOeahOS9v+eUqOivtOaYjuivt+eciw0KICAgIC8vaHR0cHM6Ly93aWtpLnpibG9nY24uY29tL2Rva3UucGhwP2lkPXpibG9ncGhwOmRldmVsb3BtZW50OmZ1bmN0aW9uczpnZXRwb3N0DQogICAgZ2xvYmFsICR6YnA7DQogICAgJHBvc3QgPSBudWxsOw0KICAgICRpZCA9IG51bGw7DQogICAgJHRpdGxlID0gbnVsbDsNCiAgICAkYWxpYXMgPSBudWxsOw0KICAgICR0aXRsZW9yYWxpYXMgPSBudWxsOw0KDQogICAgaWYgKGlzX2FycmF5KCRpZG9ybmFtZSkpIHsNCiAgICAgICAgJGFyZ3MgPSAkaWRvcm5hbWU7DQogICAgICAgIGlmIChhcnJheV9rZXlfZXhpc3RzKCdpZG9ybmFtZScsICRhcmdzKSkgew0KICAgICAgICAgICAgJGlkb3JuYW1lID0gJGFyZ3NbJ2lkb3JuYW1lJ107DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkaWRvcm5hbWUgPSBudWxsOw0KICAgICAgICB9DQogICAgICAgIGlmIChhcnJheV9rZXlfZXhpc3RzKCdpZCcsICRhcmdzKSkgew0KICAgICAgICAgICAgJGlkID0gJGFyZ3NbJ2lkJ107DQogICAgICAgICAgICB1bnNldCgkYXJnc1snaWQnXSk7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGFycmF5X2tleV9leGlzdHMoJ3RpdGxlJywgJGFyZ3MpKSB7DQogICAgICAgICAgICAkdGl0bGUgPSAkYXJnc1sndGl0bGUnXTsNCiAgICAgICAgICAgIHVuc2V0KCRhcmdzWyd0aXRsZSddKTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoYXJyYXlfa2V5X2V4aXN0cygnYWxpYXMnLCAkYXJncykpIHsNCiAgICAgICAgICAgICRhbGlhcyA9ICRhcmdzWydhbGlhcyddOw0KICAgICAgICAgICAgdW5zZXQoJGFyZ3NbJ2FsaWFzJ10pOw0KICAgICAgICB9DQogICAgICAgIGlmIChhcnJheV9rZXlfZXhpc3RzKCd0aXRsZW9yYWxpYXMnLCAkYXJncykpIHsNCiAgICAgICAgICAgICR0aXRsZW9yYWxpYXMgPSAkYXJnc1sndGl0bGVvcmFsaWFzJ107DQogICAgICAgICAgICB1bnNldCgkYXJnc1sndGl0bGVvcmFsaWFzJ10pOw0KICAgICAgICB9DQogICAgICAgIGlmIChhcnJheV9rZXlfZXhpc3RzKCdvcHRpb24nLCAkYXJncykpIHsNCiAgICAgICAgICAgICRvcHRpb24gPSAkYXJnc1snb3B0aW9uJ107DQogICAgICAgICAgICB1bnNldCgkYXJnc1snb3B0aW9uJ10pOw0KICAgICAgICB9DQogICAgICAgIGlmICghaXNfYXJyYXkoJG9wdGlvbikpIHsNCiAgICAgICAgICAgICRvcHRpb24gPSBhcnJheSgpOw0KICAgICAgICB9DQogICAgICAgICRvcHRpb24gPSBhcnJheV9tZXJnZSgkYXJncywgJG9wdGlvbik7DQogICAgICAgIHVuc2V0KCRhcmdzKTsNCiAgICB9DQoNCiAgICBpZiAoIWlzX2FycmF5KCRvcHRpb24pKSB7DQogICAgICAgICRvcHRpb24gPSBhcnJheSgpOw0KICAgIH0NCiAgICBpZiAoIWFycmF5X2tleV9leGlzdHMoJ3Bvc3RfdHlwZScsICRvcHRpb24pKSB7DQogICAgICAgICRvcHRpb25bJ3Bvc3RfdHlwZSddID0gbnVsbDsNCiAgICB9DQogICAgaWYgKCFhcnJheV9rZXlfZXhpc3RzKCdwb3N0X3N0YXR1cycsICRvcHRpb24pKSB7DQogICAgICAgICRvcHRpb25bJ3Bvc3Rfc3RhdHVzJ10gPSBudWxsOw0KICAgIH0NCiAgICBpZiAoIWFycmF5X2tleV9leGlzdHMoJ29ubHlfYXJ0aWNsZScsICRvcHRpb24pKSB7DQogICAgICAgICRvcHRpb25bJ29ubHlfYXJ0aWNsZSddID0gZmFsc2U7DQogICAgfQ0KICAgIGlmICghYXJyYXlfa2V5X2V4aXN0cygnb25seV9wYWdlJywgJG9wdGlvbikpIHsNCiAgICAgICAgJG9wdGlvblsnb25seV9wYWdlJ10gPSBmYWxzZTsNCiAgICB9DQogICAgaWYgKCFhcnJheV9rZXlfZXhpc3RzKCd3aGVyZV9jdXN0b20nLCAkb3B0aW9uKSkgew0KICAgICAgICAkb3B0aW9uWyd3aGVyZV9jdXN0b20nXSA9IGFycmF5KCk7DQogICAgfQ0KICAgIGlmICghYXJyYXlfa2V5X2V4aXN0cygnb3JkZXJfY3VzdG9tJywgJG9wdGlvbikpIHsNCiAgICAgICAgJG9wdGlvblsnb3JkZXJfY3VzdG9tJ10gPSBhcnJheSgpOw0KICAgIH0NCg0KICAgICR3ID0gYXJyYXkoKTsNCiAgICBpZiAoJG9wdGlvblsncG9zdF90eXBlJ10gIT09IG51bGwpIHsNCiAgICAgICAgJHdbXSA9IGFycmF5KCc9JywgJ2xvZ19UeXBlJywgKGludCkgJG9wdGlvblsncG9zdF90eXBlJ10pOw0KICAgIH0gZWxzZWlmICgkb3B0aW9uWydvbmx5X2FydGljbGUnXSA9PSB0cnVlKSB7DQogICAgICAgICR3W10gPSBhcnJheSgnPScsICdsb2dfVHlwZScsIDApOw0KICAgIH0gZWxzZWlmICgkb3B0aW9uWydvbmx5X3BhZ2UnXSA9PSB0cnVlKSB7DQogICAgICAgICR3W10gPSBhcnJheSgnPScsICdsb2dfVHlwZScsIDEpOw0KICAgIH0NCg0KICAgIGlmICgkb3B0aW9uWydwb3N0X3N0YXR1cyddICE9PSBudWxsKSB7DQogICAgICAgICR3W10gPSBhcnJheSgnPScsICdsb2dfU3RhdHVzJywgKGludCkgJG9wdGlvblsncG9zdF9zdGF0dXMnXSk7DQogICAgfQ0KDQogICAgJG9wdGlvbjIgPSAkb3B0aW9uOw0KICAgIHVuc2V0KCRvcHRpb24yWydwb3N0X3R5cGUnXSwgJG9wdGlvbjJbJ3Bvc3Rfc3RhdHVzJ10sICRvcHRpb24yWydvbmx5X2FydGljbGUnXSwgJG9wdGlvbjJbJ29ubHlfcGFnZSddKTsNCiAgICB1bnNldCgkb3B0aW9uMlsnb3JkZXJfY3VzdG9tJ10sICRvcHRpb24yWyd3aGVyZV9jdXN0b20nXSk7DQoNCiAgICBpZiAoaXNfbnVsbCgkaWQpID09PSBmYWxzZSkgew0KICAgICAgICAkd1tdID0gYXJyYXkoJz0nLCAnbG9nX0lEJywgKGludCkgJGlkKTsNCiAgICB9IGVsc2VpZiAoaXNfbnVsbCgkdGl0bGUpID09PSBmYWxzZSkgew0KICAgICAgICAkd1tdID0gYXJyYXkoJz0nLCAnbG9nX1RpdGxlJywgJHRpdGxlKTsNCiAgICB9IGVsc2VpZiAoaXNfbnVsbCgkYWxpYXMpID09PSBmYWxzZSkgew0KICAgICAgICAkd1tdID0gYXJyYXkoJz0nLCAnbG9nX0FsaWFzJywgJGFsaWFzKTsNCiAgICB9IGVsc2VpZiAoaXNfbnVsbCgkdGl0bGVvcmFsaWFzKSA9PT0gZmFsc2UpIHsNCiAgICAgICAgJHdbXSA9IGFycmF5KCdhcnJheScsIGFycmF5KGFycmF5KCdsb2dfQWxpYXMnLCAkdGl0bGVvcmFsaWFzKSwgYXJyYXkoJ2xvZ19UaXRsZScsICR0aXRsZW9yYWxpYXMpKSk7DQogICAgfSBlbHNlaWYgKGlzX3N0cmluZygkaWRvcm5hbWUpKSB7DQogICAgICAgICR3W10gPSBhcnJheSgnYXJyYXknLCBhcnJheShhcnJheSgnbG9nX0FsaWFzJywgJGlkb3JuYW1lKSwgYXJyYXkoJ2xvZ19UaXRsZScsICRpZG9ybmFtZSkpKTsNCiAgICB9IGVsc2VpZiAoaXNfaW50KCRpZG9ybmFtZSkpIHsNCiAgICAgICAgJHdbXSA9IGFycmF5KCc9JywgJ2xvZ19JRCcsIChpbnQpICRpZG9ybmFtZSk7DQogICAgfSBlbHNlIHsNCiAgICAgICAgJHdbXSA9IGFycmF5KCc9JywgJ2xvZ19JRCcsICcnKTsNCiAgICB9DQoNCiAgICAkc2VsZWN0ID0gJyc7DQogICAgJGNvdW50ID0gMTsNCg0KICAgIGlmICghZW1wdHkoJG9wdGlvblsnd2hlcmVfY3VzdG9tJ10pICYmIGlzX2FycmF5KCRvcHRpb25bJ3doZXJlX2N1c3RvbSddKSkgew0KICAgICAgICBmb3JlYWNoICgkb3B0aW9uWyd3aGVyZV9jdXN0b20nXSBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAgICAgJHdbXSA9ICR2YWx1ZTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgICRvcmRlciA9IGFycmF5KCk7DQogICAgaWYgKCFlbXB0eSgkb3B0aW9uWydvcmRlcl9jdXN0b20nXSkgJiYgaXNfYXJyYXkoJG9wdGlvblsnb3JkZXJfY3VzdG9tJ10pKSB7DQogICAgICAgIGZvcmVhY2ggKCRvcHRpb25bJ29yZGVyX2N1c3RvbSddIGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICAgICAkb3JkZXJbJGtleV0gPSAkdmFsdWU7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAkYXJ0aWNsZXMgPSAkemJwLT5HZXRQb3N0TGlzdCgkc2VsZWN0LCAkdywgJG9yZGVyLCAkY291bnQsICRvcHRpb24yKTsNCg0KICAgIGlmIChjb3VudCgkYXJ0aWNsZXMpID09IDApIHsNCiAgICAgICAgJHBvc3QgPSBuZXcgUG9zdCgpOw0KICAgIH0gZWxzZSB7DQogICAgICAgICRwb3N0ID0gJGFydGljbGVzWzBdOw0KICAgIH0NCg0KICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX0dldFBvc3RfUmVzdWx0J10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICRmcHJldHVybiA9ICRmcG5hbWUoJHBvc3QpOw0KICAgIH0NCg0KICAgIHJldHVybiAkcG9zdDsNCn0NCg0KLyoqDQogKiDojrflj5bmlofnq6DliJfooaguDQogKg0KICogQHBhcmFtIGludCAgJGNvdW50ICDmlbDph48gKDEuN+aUr+aMgeWkjeadgueahGFycmF55Y+C5pWwLCRjb3VudOS4umFycmF55pe25ZCO6Z2i55qE5Y+C5pWw5Y+v5Lul5LiN6K6+KQ0KICogQHBhcmFtIG51bGwgJGNhdGUgICDliIbnsbtJRA0KICogQHBhcmFtIG51bGwgJGF1dGggICDnlKjmiLdJRA0KICogQHBhcmFtIG51bGwgJGRhdGUgICDml6XmnJ8NCiAqIEBwYXJhbSBudWxsICR0YWdzICAg5qCH562+DQogKiBAcGFyYW0gbnVsbCAkc2VhcmNoIOaQnOe0ouWFs+mUruivjQ0KICogQHBhcmFtIG51bGwgJG9wdGlvbg0KICoNCiAqIEByZXR1cm4gYXJyYXl8bWl4ZWQNCiAqLw0KZnVuY3Rpb24gR2V0TGlzdCgkY291bnQgPSAxMCwgJGNhdGUgPSBudWxsLCAkYXV0aCA9IG51bGwsICRkYXRlID0gbnVsbCwgJHRhZ3MgPSBudWxsLCAkc2VhcmNoID0gbnVsbCwgJG9wdGlvbiA9IG51bGwpDQp7DQogICAgLy/mlrDniYjmnKznmoTkvb/nlKjor7TmmI7or7fnnIsNCiAgICAvL2h0dHBzOi8vd2lraS56YmxvZ2NuLmNvbS9kb2t1LnBocD9pZD16YmxvZ3BocDpkZXZlbG9wbWVudDpmdW5jdGlvbnM6Z2V0bGlzdA0KICAgIGdsb2JhbCAkemJwOw0KICAgICRhcmdzID0gYXJyYXkoKTsNCiAgICBpZiAoaXNfYXJyYXkoJGNvdW50KSkgew0KICAgICAgICAkYXJncyA9ICRjb3VudDsNCiAgICAgICAgaWYgKGFycmF5X2tleV9leGlzdHMoJ2NvdW50JywgJGFyZ3MpKSB7DQogICAgICAgICAgICAkY291bnQgPSAoaW50KSAkYXJnc1snY291bnQnXTsNCiAgICAgICAgICAgIHVuc2V0KCRhcmdzWydjb3VudCddKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICRjb3VudCA9IDEwOw0KICAgICAgICB9DQogICAgICAgIGlmIChhcnJheV9rZXlfZXhpc3RzKCdjYXRlZ29yeScsICRhcmdzKSkgew0KICAgICAgICAgICAgJGNhdGUgPSAkYXJnc1snY2F0ZWdvcnknXTsNCiAgICAgICAgICAgIHVuc2V0KCRhcmdzWydjYXRlZ29yeSddKTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoYXJyYXlfa2V5X2V4aXN0cygnY2F0ZScsICRhcmdzKSkgew0KICAgICAgICAgICAgJGNhdGUgPSAkYXJnc1snY2F0ZSddOw0KICAgICAgICAgICAgdW5zZXQoJGFyZ3NbJ2NhdGUnXSk7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGFycmF5X2tleV9leGlzdHMoJ2F1dGhvcicsICRhcmdzKSkgew0KICAgICAgICAgICAgJGF1dGggPSAkYXJnc1snYXV0aG9yJ107DQogICAgICAgICAgICB1bnNldCgkYXJnc1snYXV0aG9yJ10pOw0KICAgICAgICB9DQogICAgICAgIGlmIChhcnJheV9rZXlfZXhpc3RzKCdhdXRoJywgJGFyZ3MpKSB7DQogICAgICAgICAgICAkYXV0aCA9ICRhcmdzWydhdXRoJ107DQogICAgICAgICAgICB1bnNldCgkYXJnc1snYXV0aCddKTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoYXJyYXlfa2V5X2V4aXN0cygnZGF0ZScsICRhcmdzKSkgew0KICAgICAgICAgICAgJGRhdGUgPSAkYXJnc1snZGF0ZSddOw0KICAgICAgICAgICAgdW5zZXQoJGFyZ3NbJ2RhdGUnXSk7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGFycmF5X2tleV9leGlzdHMoJ3RhZ3MnLCAkYXJncykpIHsNCiAgICAgICAgICAgICR0YWdzID0gJGFyZ3NbJ3RhZ3MnXTsNCiAgICAgICAgICAgIHVuc2V0KCRhcmdzWyd0YWdzJ10pOw0KICAgICAgICB9DQogICAgICAgIGlmIChhcnJheV9rZXlfZXhpc3RzKCdzZWFyY2gnLCAkYXJncykpIHsNCiAgICAgICAgICAgICRzZWFyY2ggPSAkYXJnc1snc2VhcmNoJ107DQogICAgICAgICAgICB1bnNldCgkYXJnc1snc2VhcmNoJ10pOw0KICAgICAgICB9DQogICAgICAgIGlmIChhcnJheV9rZXlfZXhpc3RzKCdvcHRpb24nLCAkYXJncykpIHsNCiAgICAgICAgICAgICRvcHRpb24gPSAkYXJnc1snb3B0aW9uJ107DQogICAgICAgICAgICB1bnNldCgkYXJnc1snb3B0aW9uJ10pOw0KICAgICAgICB9DQogICAgICAgIGlmICghaXNfYXJyYXkoJG9wdGlvbikpIHsNCiAgICAgICAgICAgICRvcHRpb24gPSBhcnJheSgpOw0KICAgICAgICB9DQogICAgICAgICRvcHRpb24gPSBhcnJheV9tZXJnZSgkYXJncywgJG9wdGlvbik7DQogICAgICAgIHVuc2V0KCRhcmdzKTsNCiAgICB9DQoNCiAgICBpZiAoIWlzX2FycmF5KCRvcHRpb24pKSB7DQogICAgICAgICRvcHRpb24gPSBhcnJheSgpOw0KICAgIH0NCiAgICBpZiAoIWFycmF5X2tleV9leGlzdHMoJ3Bvc3RfdHlwZScsICRvcHRpb24pKSB7DQogICAgICAgICRvcHRpb25bJ3Bvc3RfdHlwZSddID0gbnVsbDsNCiAgICB9DQogICAgaWYgKCFhcnJheV9rZXlfZXhpc3RzKCdwb3N0X3N0YXR1cycsICRvcHRpb24pKSB7DQogICAgICAgICRvcHRpb25bJ3Bvc3Rfc3RhdHVzJ10gPSAwOw0KICAgIH0NCiAgICBpZiAoIWFycmF5X2tleV9leGlzdHMoJ29ubHlfb250b3AnLCAkb3B0aW9uKSkgew0KICAgICAgICAkb3B0aW9uWydvbmx5X29udG9wJ10gPSBmYWxzZTsNCiAgICB9DQogICAgaWYgKCFhcnJheV9rZXlfZXhpc3RzKCdvbmx5X25vdF9vbnRvcCcsICRvcHRpb24pKSB7DQogICAgICAgICRvcHRpb25bJ29ubHlfbm90X29udG9wJ10gPSBmYWxzZTsNCiAgICB9DQogICAgaWYgKCFhcnJheV9rZXlfZXhpc3RzKCdoYXNfc3ViY2F0ZScsICRvcHRpb24pKSB7DQogICAgICAgICRvcHRpb25bJ2hhc19zdWJjYXRlJ10gPSBmYWxzZTsNCiAgICB9DQogICAgaWYgKCFhcnJheV9rZXlfZXhpc3RzKCd3aGVyZV9jdXN0b20nLCAkb3B0aW9uKSkgew0KICAgICAgICAkb3B0aW9uWyd3aGVyZV9jdXN0b20nXSA9IGFycmF5KCk7DQogICAgfQ0KICAgIGlmICghYXJyYXlfa2V5X2V4aXN0cygnb3JkZXJfY3VzdG9tJywgJG9wdGlvbikpIHsNCiAgICAgICAgJG9wdGlvblsnb3JkZXJfY3VzdG9tJ10gPSBhcnJheSgpOw0KICAgIH0NCiAgICBpZiAoIWFycmF5X2tleV9leGlzdHMoJ2lzX3JlbGF0ZWQnLCAkb3B0aW9uKSkgew0KICAgICAgICAkb3B0aW9uWydpc19yZWxhdGVkJ10gPSBmYWxzZTsNCiAgICB9DQogICAgaWYgKCRvcHRpb25bJ2lzX3JlbGF0ZWQnXSkgew0KICAgICAgICAkYXQgPSAkemJwLT5HZXRQb3N0QnlJRCgkb3B0aW9uWydpc19yZWxhdGVkJ10pOw0KICAgICAgICAkdGFncyA9ICRhdC0+VGFnczsNCiAgICAgICAgaWYgKCEkdGFncykgew0KICAgICAgICAgICAgcmV0dXJuIGFycmF5KCk7DQogICAgICAgIH0NCiAgICAgICAgJGNvdW50ID0gKCRjb3VudCArIDEpOw0KICAgIH0NCg0KICAgICRvcHRpb24yID0gJG9wdGlvbjsNCiAgICB1bnNldCgkb3B0aW9uMlsncG9zdF90eXBlJ10sICRvcHRpb24yWydwb3N0X3N0YXR1cyddLCAkb3B0aW9uMlsnb25seV9vbnRvcCddLCAkb3B0aW9uMlsnb25seV9ub3Rfb250b3AnXSk7DQogICAgdW5zZXQoJG9wdGlvbjJbJ2hhc19zdWJjYXRlJ10sICRvcHRpb24yWydpc19yZWxhdGVkJ10sICRvcHRpb24yWydvcmRlcl9ieV9tZXRhcyddKTsNCiAgICB1bnNldCgkb3B0aW9uMlsnb3JkZXJfY3VzdG9tJ10sICRvcHRpb24yWyd3aGVyZV9jdXN0b20nXSk7DQoNCiAgICAkbGlzdCA9IGFycmF5KCk7DQogICAgJHBvc3RfdHlwZSA9IG51bGw7DQogICAgJHcgPSBhcnJheSgpOw0KDQogICAgaWYgKCRvcHRpb25bJ3Bvc3RfdHlwZSddICE9PSBudWxsKSB7DQogICAgICAgICRwb3N0X3R5cGUgPSAoaW50KSAkb3B0aW9uWydwb3N0X3R5cGUnXTsNCiAgICB9IGVsc2Ugew0KICAgICAgICAkcG9zdF90eXBlID0gMDsNCiAgICB9DQogICAgJHdbXSA9IGFycmF5KCc9JywgJ2xvZ19UeXBlJywgJHBvc3RfdHlwZSk7DQoNCiAgICBpZiAoJG9wdGlvblsncG9zdF9zdGF0dXMnXSAhPT0gbnVsbCkgew0KICAgICAgICAkd1tdID0gYXJyYXkoJz0nLCAnbG9nX1N0YXR1cycsIChpbnQpICRvcHRpb25bJ3Bvc3Rfc3RhdHVzJ10pOw0KICAgIH0NCg0KICAgIGlmICgkb3B0aW9uWydvbmx5X29udG9wJ10gPT0gdHJ1ZSkgew0KICAgICAgICAkd1tdID0gYXJyYXkoJz4nLCAnbG9nX0lzVG9wJywgMCk7DQogICAgfSBlbHNlaWYgKCRvcHRpb25bJ29ubHlfbm90X29udG9wJ10gPT0gdHJ1ZSkgew0KICAgICAgICAkd1tdID0gYXJyYXkoJz0nLCAnbG9nX0lzVG9wJywgMCk7DQogICAgfQ0KDQogICAgaWYgKCFpc19udWxsKCRjYXRlKSkgew0KICAgICAgICAkY2F0ZWdvcnkgPSBuZXcgQ2F0ZWdvcnkoKTsNCiAgICAgICAgJGNhdGVnb3J5ID0gJHpicC0+R2V0Q2F0ZWdvcnlCeUlEKCRjYXRlKTsNCg0KICAgICAgICBpZiAoJGNhdGVnb3J5LT5JRCA+IDApIHsNCiAgICAgICAgICAgIGlmICghJG9wdGlvblsnaGFzX3N1YmNhdGUnXSkgew0KICAgICAgICAgICAgICAgICR3W10gPSBhcnJheSgnPScsICdsb2dfQ2F0ZUlEJywgJGNhdGVnb3J5LT5JRCk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICRhcnlzdWJjYXRlID0gYXJyYXkoKTsNCiAgICAgICAgICAgICAgICAkYXJ5c3ViY2F0ZVtdID0gYXJyYXkoJ2xvZ19DYXRlSUQnLCAkY2F0ZWdvcnktPklEKTsNCiAgICAgICAgICAgICAgICBpZiAoaXNzZXQoJHpicC0+Y2F0ZWdvcmllc19hbGxbJGNhdGVnb3J5LT5JRF0pKSB7DQogICAgICAgICAgICAgICAgICAgIGZvcmVhY2ggKCR6YnAtPmNhdGVnb3JpZXNfYWxsWyRjYXRlZ29yeS0+SURdLT5DaGlsZHJlbkNhdGVnb3JpZXMgYXMgJHN1YmNhdGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICRhcnlzdWJjYXRlW10gPSBhcnJheSgnbG9nX0NhdGVJRCcsICRzdWJjYXRlLT5JRCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgJHdbXSA9IGFycmF5KCdhcnJheScsICRhcnlzdWJjYXRlKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHJldHVybiBhcnJheSgpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgaWYgKCFpc19udWxsKCRhdXRoKSkgew0KICAgICAgICAkYXV0aG9yID0gbmV3IE1lbWJlcigpOw0KICAgICAgICAkYXV0aG9yID0gJHpicC0+R2V0TWVtYmVyQnlJRCgkYXV0aCk7DQoNCiAgICAgICAgaWYgKCRhdXRob3ItPklEID4gMCkgew0KICAgICAgICAgICAgJHdbXSA9IGFycmF5KCc9JywgJ2xvZ19BdXRob3JJRCcsICRhdXRob3ItPklEKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHJldHVybiBhcnJheSgpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgaWYgKCFpc19udWxsKCRkYXRlKSkgew0KICAgICAgICAkZGF0ZXRpbWUgPSBzdHJ0b3RpbWUoJGRhdGUpOw0KICAgICAgICBpZiAoJGRhdGV0aW1lKSB7DQogICAgICAgICAgICAkZGF0ZXRpdGxlID0gc3RyX3JlcGxhY2UoYXJyYXkoJyV5JScsICclbSUnKSwgYXJyYXkoZGF0ZSgnWScsICRkYXRldGltZSksIGRhdGUoJ24nLCAkZGF0ZXRpbWUpKSwgJHpicC0+bGFuZ1snbXNnJ11bJ3llYXJfbW9udGgnXSk7DQogICAgICAgICAgICAkd1tdID0gYXJyYXkoJ0JFVFdFRU4nLCAnbG9nX1Bvc3RUaW1lJywgJGRhdGV0aW1lLCBzdHJ0b3RpbWUoJysxIG1vbnRoJywgJGRhdGV0aW1lKSk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICByZXR1cm4gYXJyYXkoKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGlmICghaXNfbnVsbCgkdGFncykpIHsNCiAgICAgICAgJHRhZyA9IG5ldyBUYWcoKTsNCiAgICAgICAgaWYgKGlzX2FycmF5KCR0YWdzKSkgew0KICAgICAgICAgICAgJHRhID0gYXJyYXkoKTsNCiAgICAgICAgICAgIGZvcmVhY2ggKCR0YWdzIGFzICR0KSB7DQogICAgICAgICAgICAgICAgJHRhW10gPSBhcnJheSgnbG9nX1RhZycsICcleycgLiAkdC0+SUQgLiAnfSUnKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgICR3W10gPSBhcnJheSgnYXJyYXlfbGlrZScsICR0YSk7DQogICAgICAgICAgICB1bnNldCgkdGEpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgaWYgKGlzX2ludCgkdGFncykpIHsNCiAgICAgICAgICAgICAgICAkdGFnID0gJHpicC0+R2V0VGFnQnlJRCgkdGFncyk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICR0YWcgPSAkemJwLT5HZXRUYWdCeUFsaWFzT3JOYW1lKCR0YWdzLCAkcG9zdF90eXBlKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICgkdGFnLT5JRCA+IDApIHsNCiAgICAgICAgICAgICAgICAkd1tdID0gYXJyYXkoJ0xJS0UnLCAnbG9nX1RhZycsICcleycgLiAkdGFnLT5JRCAuICd9JScpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gYXJyYXkoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGlmIChpc19zdHJpbmcoJHNlYXJjaCkpIHsNCiAgICAgICAgJHNlYXJjaCA9IHRyaW0oJHNlYXJjaCk7DQogICAgICAgIGlmICgkc2VhcmNoICE9PSAnJykgew0KICAgICAgICAgICAgJHdbXSA9IGFycmF5KCdzZWFyY2gnLCAnbG9nX0NvbnRlbnQnLCAnbG9nX0ludHJvJywgJ2xvZ19UaXRsZScsICRzZWFyY2gpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgcmV0dXJuIGFycmF5KCk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAkc2VsZWN0ID0gJyc7DQoNCiAgICBpZiAoIWVtcHR5KCRvcHRpb25bJ3doZXJlX2N1c3RvbSddKSAmJiBpc19hcnJheSgkb3B0aW9uWyd3aGVyZV9jdXN0b20nXSkpIHsNCiAgICAgICAgZm9yZWFjaCAoJG9wdGlvblsnd2hlcmVfY3VzdG9tJ10gYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgICAgICR3W10gPSAkdmFsdWU7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBpZiAoZW1wdHkoJG9wdGlvblsnb3JkZXJfY3VzdG9tJ10pKSB7DQogICAgICAgICRvcmRlciA9IGFycmF5KCdsb2dfUG9zdFRpbWUnID0+ICdERVNDJyk7DQogICAgfSBlbHNlIHsNCiAgICAgICAgJG9yZGVyID0gYXJyYXkoKTsNCiAgICAgICAgZm9yZWFjaCAoJG9wdGlvblsnb3JkZXJfY3VzdG9tJ10gYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgICAgICRvcmRlclska2V5XSA9ICR2YWx1ZTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX0xhcmdlRGF0YV9HZXRMaXN0J10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICRmcHJldHVybiA9ICRmcG5hbWUoJHNlbGVjdCwgJHcsICRvcmRlciwgJGNvdW50LCAkb3B0aW9uMik7DQogICAgfQ0KDQogICAgJGxpc3QgPSAkemJwLT5HZXRQb3N0TGlzdCgkc2VsZWN0LCAkdywgJG9yZGVyLCAkY291bnQsICRvcHRpb24yKTsNCg0KICAgIGlmICgkb3B0aW9uWydpc19yZWxhdGVkJ10pIHsNCiAgICAgICAgZm9yZWFjaCAoJGxpc3QgYXMgJGsgPT4gJGEpIHsNCiAgICAgICAgICAgIGlmICgkYS0+SUQgPT0gJG9wdGlvblsnaXNfcmVsYXRlZCddKSB7DQogICAgICAgICAgICAgICAgdW5zZXQoJGxpc3RbJGtdKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBpZiAoY291bnQoJGxpc3QpID09ICRjb3VudCkgew0KICAgICAgICAgICAgYXJyYXlfcG9wKCRsaXN0KTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICBpZiAoaXNzZXQoJG9wdGlvblsnb3JkZXJfYnlfbWV0YXMnXSkpIHsgLy/ku45tZXRh6YeM55qE5YC85o6S5bqPDQogICAgICAgIGlmIChpc19hcnJheSgkb3B0aW9uWydvcmRlcl9ieV9tZXRhcyddKSkgew0KICAgICAgICAgICAgJG9yZGVya2V5ID0ga2V5KCRvcHRpb25bJ29yZGVyX2J5X21ldGFzJ10pOw0KICAgICAgICAgICAgJG9yZGVyID0gY3VycmVudCgkb3B0aW9uWydvcmRlcl9ieV9tZXRhcyddKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICRvcmRlcmtleSA9IGN1cnJlbnQoJG9wdGlvblsnb3JkZXJfYnlfbWV0YXMnXSk7DQogICAgICAgICAgICAkb3JkZXIgPSAnYXNjJzsNCiAgICAgICAgfQ0KICAgICAgICAkb3JkZXJhcnJheSA9IGFycmF5KCk7DQogICAgICAgIGZvcmVhY2ggKCRsaXN0IGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICAgICAkb3JkZXJhcnJheVska2V5XSA9ICR2YWx1ZS0+TWV0YXMtPiRvcmRlcmtleTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoc3RydG9sb3dlcigkb3JkZXIpID09ICdkZXNjJykgew0KICAgICAgICAgICAgYXJzb3J0KCRvcmRlcmFycmF5KTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGFzb3J0KCRvcmRlcmFycmF5KTsNCiAgICAgICAgfQ0KICAgICAgICAkbmV3bGlzdCA9IGFycmF5KCk7DQogICAgICAgIGZvcmVhY2ggKCRvcmRlcmFycmF5IGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICAgICAkbmV3bGlzdFtdID0gJGxpc3RbJGtleV07DQogICAgICAgIH0NCiAgICAgICAgJGxpc3QgPSAkbmV3bGlzdDsNCiAgICB9DQoNCg0KICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX0dldExpc3RfUmVzdWx0J10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICRmcHJldHVybiA9ICRmcG5hbWUoJGxpc3QpOw0KICAgIH0NCg0KICAgIHJldHVybiAkbGlzdDsNCn0NCg0KLy8jIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCg0KLyoqDQogKiDmmL7npLo0MDTpobXpnaIo5YaF572u5o+S5Lu25Ye95pWwKS4NCiAqDQogKiDlj6/pgJrov4fkuLvpopjkuK3nmoQ0MDQucGhw5qih5p2/6Ieq5a6a5LmJ5pi+56S65pWI5p6cDQogKg0KICogQHBhcmFtICRlcnJvckNvZGUNCiAqIEBwYXJhbSAkZXJyb3JEZXNjcmlwdGlvbg0KICogQHBhcmFtICRmaWxlDQogKiBAcGFyYW0gJGxpbmUNCiAqDQogKiBAYXBpIEZpbHRlcl9QbHVnaW5fWmJwX1Nob3dFcnJvcg0KICoNCiAqIEB0aHJvd3MgRXhjZXB0aW9uDQogKi8NCmZ1bmN0aW9uIEluY2x1ZGVfU2hvd0Vycm9yNDA0KCRlcnJvckNvZGUsICRlcnJvckRlc2NyaXB0aW9uLCAkZmlsZSwgJGxpbmUpDQp7DQogICAgZ2xvYmFsICR6YnA7DQogICAgaWYgKCFpbl9hcnJheSgiU3RhdHVzOiA0MDQgTm90IEZvdW5kIiwgaGVhZGVyc19saXN0KCkpKSB7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICAkemJwLT50ZW1wbGF0ZS0+U2V0VGFncygndGl0bGUnLCAkemJwLT50aXRsZSk7DQogICAgJHpicC0+dGVtcGxhdGUtPlNldFRlbXBsYXRlKCc0MDQnKTsNCiAgICAkemJwLT50ZW1wbGF0ZS0+RGlzcGxheSgpOw0KDQogICAgZXhpdDsNCn0NCg0KLyoqDQogKiDovpPlh7rlkI7lj7DmjIflrprlrZfkvZNmYW1pbHko5YaF572u5o+S5Lu25Ye95pWwKS4NCiAqLw0KZnVuY3Rpb24gSW5jbHVkZV9BZGRvbkFkbWluRm9udCgpDQp7DQogICAgZ2xvYmFsICR6YnA7DQogICAgJGYgPSAkcyA9ICcnOw0KICAgIGlmIChpc3NldCgkemJwLT5sYW5nWydmb250X2ZhbWlseSddKSAmJiB0cmltKCR6YnAtPmxhbmdbJ2ZvbnRfZmFtaWx5J10pKSB7DQogICAgICAgICRmID0gJ2ZvbnQtZmFtaWx5OicgLiAkemJwLT5sYW5nWydmb250X2ZhbWlseSddIC4gJzsnOw0KICAgIH0NCg0KICAgIGlmIChpc3NldCgkemJwLT5sYW5nWydmb250X3NpemUnXSkgJiYgdHJpbSgkemJwLT5sYW5nWydmb250X3NpemUnXSkpIHsNCiAgICAgICAgJHMgPSAnZm9udC1zaXplOicgLiAkemJwLT5sYW5nWydmb250X3NpemUnXSAuICc7JzsNCiAgICB9DQoNCiAgICBpZiAoJGYgfHwgJHMpIHsNCiAgICAgICAgZWNobyAnPHN0eWxlIHR5cGU9InRleHQvY3NzIj5ib2R5eycgLiAkcyAuICRmIC4gJ308L3N0eWxlPic7DQogICAgfQ0KfQ0KDQovKioNCiAqIOaJueWkhOeQhuaWh+eroA0KICoNCiAqIEBwYXJhbSBpbnQgJHR5cGUNCiAqLw0KZnVuY3Rpb24gSW5jbHVkZV9CYXRjaFBvc3RfQXJ0aWNsZSgkdHlwZSkNCnsNCiAgICBnbG9iYWwgJHpicDsNCiAgICBpZiAoJHR5cGUgIT0gWkNfUE9TVF9UWVBFX0FSVElDTEUpIHsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICBpZiAoIWlzc2V0KCRfUE9TVFsnaWQnXSkpIHsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICAkYXJyYXlpZCA9ICRfUE9TVFsnaWQnXTsNCiAgICBmb3JlYWNoICgkYXJyYXlpZCBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAkaWQgPSAoaW50KSAkdmFsdWU7DQogICAgICAgICRhcnRpY2xlID0gbmV3IFBvc3QoKTsNCiAgICAgICAgJGFydGljbGUgPSAkemJwLT5HZXRQb3N0QnlJRCgkaWQpOw0KICAgICAgICBpZiAoJGFydGljbGUtPklEID4gMCkgew0KICAgICAgICAgICAgaWYgKCEkemJwLT5DaGVja1JpZ2h0cygnQXJ0aWNsZUFsbCcpICYmICRhcnRpY2xlLT5BdXRob3JJRCAhPSAkemJwLT51c2VyLT5JRCkgew0KICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAkcHJlX2F1dGhvciA9ICRhcnRpY2xlLT5BdXRob3JJRDsNCiAgICAgICAgICAgICRwcmVfdGFnID0gJGFydGljbGUtPlRhZzsNCiAgICAgICAgICAgICRwcmVfY2F0ZWdvcnkgPSAkYXJ0aWNsZS0+Q2F0ZUlEOw0KICAgICAgICAgICAgJHByZV9pc3RvcCA9ICRhcnRpY2xlLT5Jc1RvcDsNCiAgICAgICAgICAgICRwcmVfc3RhdHVzID0gJGFydGljbGUtPlN0YXR1czsNCg0KICAgICAgICAgICAgJGFydGljbGUtPkRlbCgpOw0KDQogICAgICAgICAgICBEZWxBcnRpY2xlX0NvbW1lbnRzKCRhcnRpY2xlLT5JRCk7DQoNCiAgICAgICAgICAgIENvdW50VGFnQXJyYXlTdHJpbmcoJHByZV90YWcsIC0xLCAkYXJ0aWNsZS0+SUQpOw0KICAgICAgICAgICAgQ291bnRNZW1iZXJBcnJheShhcnJheSgkcHJlX2F1dGhvciksIGFycmF5KC0xLCAwLCAwLCAwKSk7DQogICAgICAgICAgICBDb3VudENhdGVnb3J5QXJyYXkoYXJyYXkoJHByZV9jYXRlZ29yeSksIC0xKTsNCiAgICAgICAgICAgIGlmICgoJHByZV9pc3RvcCA9PSAwICYmICRwcmVfc3RhdHVzID09IDApKSB7DQogICAgICAgICAgICAgICAgQ291bnROb3JtYWxBcnRpY2xlTnVtcygtMSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoJGFydGljbGUtPklzVG9wID09IHRydWUpIHsNCiAgICAgICAgICAgICAgICBDb3VudFRvcFBvc3QoJGFydGljbGUtPlR5cGUsIG51bGwsICRhcnRpY2xlLT5JRCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX0RlbEFydGljbGVfU3VjY2VlZCddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAgICAgICAgICRmcG5hbWUoJGFydGljbGUpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KICAgICR6YnAtPkFkZEJ1aWxkTW9kdWxlKCdwcmV2aW91cycpOw0KICAgICR6YnAtPkFkZEJ1aWxkTW9kdWxlKCdjYWxlbmRhcicpOw0KICAgICR6YnAtPkFkZEJ1aWxkTW9kdWxlKCdjb21tZW50cycpOw0KICAgICR6YnAtPkFkZEJ1aWxkTW9kdWxlKCdhcmNoaXZlcycpOw0KICAgICR6YnAtPkFkZEJ1aWxkTW9kdWxlKCd0YWdzJyk7DQogICAgJHpicC0+QWRkQnVpbGRNb2R1bGUoJ2F1dGhvcnMnKTsNCg0KICAgIHJldHVybiB0cnVlOw0KfQ0KDQovKioNCiAqIOaJueWkhOeQhumhtemdog0KICoNCiAqIEBwYXJhbSBpbnQgJHR5cGUNCiAqLw0KZnVuY3Rpb24gSW5jbHVkZV9CYXRjaFBvc3RfUGFnZSgkdHlwZSkNCnsNCiAgICBnbG9iYWwgJHpicDsNCiAgICBpZiAoJHR5cGUgIT0gWkNfUE9TVF9UWVBFX1BBR0UpIHsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICBpZiAoIWlzc2V0KCRfUE9TVFsnaWQnXSkpIHsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICAkYXJyYXlpZCA9ICRfUE9TVFsnaWQnXTsNCiAgICBmb3JlYWNoICgkYXJyYXlpZCBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAkaWQgPSAoaW50KSAkdmFsdWU7DQogICAgICAgICRhcnRpY2xlID0gbmV3IFBvc3QoKTsNCiAgICAgICAgJGFydGljbGUgPSAkemJwLT5HZXRQb3N0QnlJRCgkaWQpOw0KICAgICAgICBpZiAoJGFydGljbGUtPklEID4gMCkgew0KICAgICAgICAgICAgaWYgKCEkemJwLT5DaGVja1JpZ2h0cygnUGFnZUFsbCcpICYmICRhcnRpY2xlLT5BdXRob3JJRCAhPSAkemJwLT51c2VyLT5JRCkgew0KICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAkcHJlX2F1dGhvciA9ICRhcnRpY2xlLT5BdXRob3JJRDsNCg0KICAgICAgICAgICAgJGFydGljbGUtPkRlbCgpOw0KDQogICAgICAgICAgICBEZWxBcnRpY2xlX0NvbW1lbnRzKCRhcnRpY2xlLT5JRCk7DQoNCiAgICAgICAgICAgIENvdW50TWVtYmVyQXJyYXkoYXJyYXkoJHByZV9hdXRob3IpLCBhcnJheSgwLCAtMSwgMCwgMCkpOw0KDQogICAgICAgICAgICAkemJwLT5BZGRCdWlsZE1vZHVsZSgnY29tbWVudHMnKTsNCg0KICAgICAgICAgICAgJHpicC0+RGVsSXRlbVRvTmF2YmFyKCdwYWdlJywgJGFydGljbGUtPklEKTsNCg0KICAgICAgICAgICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fRGVsUGFnZV9TdWNjZWVkJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICAgICAgICAgJGZwbmFtZSgkYXJ0aWNsZSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQogICAgcmV0dXJuIHRydWU7DQp9DQoNCi8qKg0KICog6aaW6aG1aW5kZXgucGhw55qE57uT5bC+5aSE55CGDQogKi8NCmZ1bmN0aW9uIEluY2x1ZGVfSW5kZXhfRW5kKCkNCnsNCiAgICBnbG9iYWwgJHpicDsNCiAgICBpZiAoJHpicC0+b3B0aW9uWydaQ19SVU5JTkZPX0RJU1BMQVknXSA9PSB0cnVlKSB7DQogICAgICAgIFJ1blRpbWUoKTsNCiAgICB9DQp9DQoNCi8qKg0KICog6aaW6aG1aW5kZXgucGhw55qE5byA5aS05aSE55CGDQogKi8NCmZ1bmN0aW9uIEluY2x1ZGVfSW5kZXhfQmVnaW4oKQ0Kew0KICAgIGdsb2JhbCAkemJwOw0KICAgICR6YnAtPkNoZWNrU2l0ZUNsb3NlZCgpOw0KDQogICAgJHpicC0+UmVkaXJlY3RQZXJtYW5lbnREb21haW4oKTsNCg0KICAgIGlmICgkemJwLT50ZW1wbGF0ZS0+aGFzVGVtcGxhdGUoJzQwNCcpKSB7DQogICAgICAgIEFkZF9GaWx0ZXJfUGx1Z2luKCdGaWx0ZXJfUGx1Z2luX1picF9TaG93RXJyb3InLCAnSW5jbHVkZV9TaG93RXJyb3I0MDQnKTsNCiAgICB9DQoNCiAgICBpZiAoJHpicC0+b3B0aW9uWydaQ19BRERJVElPTkFMX1NFQ1VSSVRZJ10pIHsNCiAgICAgICAgaGVhZGVyKCdYLVhTUy1Qcm90ZWN0aW9uOiAxOyBtb2RlPWJsb2NrJyk7DQogICAgICAgIGlmICgkemJwLT5pc0h0dHBzKSB7DQogICAgICAgICAgICBoZWFkZXIoJ1VwZ3JhZGUtSW5zZWN1cmUtUmVxdWVzdHM6IDEnKTsNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KLyoqDQogKiDigJzlrqHmoLjkuK3kvJrlkZjigJ3nmoTliY3lj7DmnYPpmZDmi5Lnu53pqozor4ENCiAqLw0KZnVuY3Rpb24gSW5jbHVkZV9Gcm9udGVuZF9DaGVja1JpZ2h0cygkYWN0aW9uLCAkbGV2ZWwpDQp7DQogICAgZ2xvYmFsICR6YnA7DQogICAgaWYgKCR6YnAtPnVzZXItPlN0YXR1cyA9PSBaQ19NRU1CRVJfU1RBVFVTX0FVRElUSU5HKSB7DQogICAgICAgIGlmICghaW5fYXJyYXkoJGFjdGlvbiwgYXJyYXkoJ2xvZ2luJywgJ2xvZ291dCcsICdtaXNjJywgJ2ZlZWQnLCAnYWpheCcsICd2ZXJpZnknLCAnTm9WYWxpZENvZGUnLCAnTWVtYmVyRWR0JywgJ01lbWJlclBzdCcsICdNZW1iZXJNbmcnKSkpIHsNCiAgICAgICAgICAgICRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1picF9DaGVja1JpZ2h0cyddWydJbmNsdWRlX0Zyb250ZW5kX0NoZWNrUmlnaHRzJ10gPSBQTFVHSU5fRVhJVFNJR05BTF9SRVRVUk47DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCiAgICAgICAgaWYgKCR6YnAtPm9wdGlvblsnWkNfQUxMT1dfQVVESVRUSU5HX01FTUJFUl9WSVNJVF9NQU5BR0UnXSA9PSBmYWxzZSAmJiAkYWN0aW9uID09ICdhZG1pbicpIHsNCiAgICAgICAgICAgICRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1picF9DaGVja1JpZ2h0cyddWydJbmNsdWRlX0Zyb250ZW5kX0NoZWNrUmlnaHRzJ10gPSBQTFVHSU5fRVhJVFNJR05BTF9SRVRVUk47DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCiAgICB9DQp9DQoNCi8vIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQoNCi8qKg0KICog6L+H5ruk5omp5bGV5pWw5o2uLg0KICoNCiAqIEBwYXJhbSAkb2JqZWN0DQogKi8NCmZ1bmN0aW9uIEZpbHRlck1ldGEoJiRvYmplY3QpDQp7DQogICAgLy8kdHlwZT1zdHJ0b2xvd2VyKGdldF9jbGFzcygkb2JqZWN0KSk7DQoNCiAgICBmb3JlYWNoICgkX1BPU1QgYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgaWYgKHN1YnN0cigka2V5LCAwLCA1KSA9PSAnbWV0YV8nKSB7DQogICAgICAgICAgICAkbmFtZSA9IHN1YnN0cigka2V5LCAoNSAtIHN0cmxlbigka2V5KSkpOw0KICAgICAgICAgICAgJG9iamVjdC0+TWV0YXMtPiRuYW1lID0gJHZhbHVlOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgZm9yZWFjaCAoJG9iamVjdC0+TWV0YXMtPkdldERhdGEoKSBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICBpZiAoJHZhbHVlID09ICcnKSB7DQogICAgICAgICAgICAkb2JqZWN0LT5NZXRhcy0+RGVsKCRrZXkpOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQovKioNCiAqIOi/h+a7pOivhOiuuuaVsOaNri4NCiAqDQogKiBAcGFyYW0gJGNvbW1lbnQNCiAqDQogKiBAdGhyb3dzIEV4Y2VwdGlvbg0KICovDQpmdW5jdGlvbiBGaWx0ZXJDb21tZW50KCYkY29tbWVudCkNCnsNCiAgICBnbG9iYWwgJHpicDsNCg0KICAgIGlmICghQ2hlY2tSZWdFeHAoJGNvbW1lbnQtPk5hbWUsICdbbmlja25hbWVdJykpIHsNCiAgICAgICAgJHpicC0+U2hvd0Vycm9yKDE1LCBfX0ZJTEVfXywgX19MSU5FX18pOw0KICAgIH0NCiAgICBpZiAoJGNvbW1lbnQtPkVtYWlsICYmICghQ2hlY2tSZWdFeHAoJGNvbW1lbnQtPkVtYWlsLCAnW2VtYWlsXScpKSkgew0KICAgICAgICAkemJwLT5TaG93RXJyb3IoMjksIF9fRklMRV9fLCBfX0xJTkVfXyk7DQogICAgfQ0KICAgIGlmICgkY29tbWVudC0+SG9tZVBhZ2UgJiYgKCFDaGVja1JlZ0V4cCgkY29tbWVudC0+SG9tZVBhZ2UsICdbaG9tZXBhZ2VdJykpKSB7DQogICAgICAgICR6YnAtPlNob3dFcnJvcigzMCwgX19GSUxFX18sIF9fTElORV9fKTsNCiAgICB9DQoNCiAgICAkY29tbWVudC0+TmFtZSA9IEZvcm1hdFN0cmluZygkY29tbWVudC0+TmFtZSwgJ1tub2h0bWxdJyk7DQogICAgJGNvbW1lbnQtPk5hbWUgPSBzdHJfcmVwbGFjZShhcnJheSgnPCcsICc+JywgJyAnLCAn44CAJyksICcnLCAkY29tbWVudC0+TmFtZSk7DQogICAgJGNvbW1lbnQtPk5hbWUgPSBTdWJTdHJVVEY4X1N0YXJ0KCRjb21tZW50LT5OYW1lLCAwLCAkemJwLT5vcHRpb25bJ1pDX1VTRVJOQU1FX01BWCddKTsNCiAgICAkY29tbWVudC0+RW1haWwgPSBTdWJTdHJVVEY4X1N0YXJ0KCRjb21tZW50LT5FbWFpbCwgMCwgJHpicC0+b3B0aW9uWydaQ19FTUFJTF9NQVgnXSk7DQogICAgJGNvbW1lbnQtPkhvbWVQYWdlID0gU3ViU3RyVVRGOF9TdGFydCgkY29tbWVudC0+SG9tZVBhZ2UsIDAsICR6YnAtPm9wdGlvblsnWkNfSE9NRVBBR0VfTUFYJ10pOw0KDQogICAgJGNvbW1lbnQtPkNvbnRlbnQgPSBGb3JtYXRTdHJpbmcoJGNvbW1lbnQtPkNvbnRlbnQsICdbbm9odG1sXScpOw0KDQogICAgJGNvbW1lbnQtPkNvbnRlbnQgPSBTdWJTdHJVVEY4X1N0YXJ0KCRjb21tZW50LT5Db250ZW50LCAwLCAxMDAwKTsNCiAgICAkY29tbWVudC0+Q29udGVudCA9IHRyaW0oJGNvbW1lbnQtPkNvbnRlbnQpOw0KICAgIGlmIChzdHJsZW4oJGNvbW1lbnQtPkNvbnRlbnQpID09IDApIHsNCiAgICAgICAgJHpicC0+U2hvd0Vycm9yKDQ2LCBfX0ZJTEVfXywgX19MSU5FX18pOw0KICAgIH0NCn0NCg0KLyoqDQogKiDov4fmu6Tmlofnq6DmlbDmja4uDQogKg0KICogQHBhcmFtICRhcnRpY2xlDQogKi8NCmZ1bmN0aW9uIEZpbHRlclBvc3QoJiRhcnRpY2xlKQ0Kew0KICAgIGdsb2JhbCAkemJwOw0KDQogICAgJGFydGljbGUtPlRpdGxlID0gc3RyaXBfdGFncygkYXJ0aWNsZS0+VGl0bGUpOw0KICAgICRhcnRpY2xlLT5UaXRsZSA9IGh0bWxzcGVjaWFsY2hhcnMoJGFydGljbGUtPlRpdGxlKTsNCiAgICAkYXJ0aWNsZS0+QWxpYXMgPSBGb3JtYXRTdHJpbmcoJGFydGljbGUtPkFsaWFzLCAnW25vcm1hbG5hbWVdJyk7DQogICAgJGFydGljbGUtPkFsaWFzID0gc3RyX3JlcGxhY2UoJyAnLCAnJywgJGFydGljbGUtPkFsaWFzKTsNCiAgICAkYXJ0aWNsZS0+QWxpYXMgPSBzdHJfcmVwbGFjZSgn44CAJywgJycsICRhcnRpY2xlLT5BbGlhcyk7DQoNCiAgICBpZiAoJGFydGljbGUtPlR5cGUgPT0gWkNfUE9TVF9UWVBFX0FSVElDTEUpIHsNCiAgICAgICAgaWYgKCEkemJwLT5DaGVja1JpZ2h0cygnQXJ0aWNsZUFsbCcpKSB7DQogICAgICAgICAgICAkYXJ0aWNsZS0+Q29udGVudCA9IEZvcm1hdFN0cmluZygkYXJ0aWNsZS0+Q29udGVudCwgJ1tub3NjcmlwdF0nKTsNCiAgICAgICAgICAgICRhcnRpY2xlLT5JbnRybyA9IEZvcm1hdFN0cmluZygkYXJ0aWNsZS0+SW50cm8sICdbbm9zY3JpcHRdJyk7DQogICAgICAgIH0NCiAgICB9IGVsc2VpZiAoJGFydGljbGUtPlR5cGUgPT0gWkNfUE9TVF9UWVBFX1BBR0UpIHsNCiAgICAgICAgaWYgKCEkemJwLT5DaGVja1JpZ2h0cygnUGFnZUFsbCcpKSB7DQogICAgICAgICAgICAkYXJ0aWNsZS0+Q29udGVudCA9IEZvcm1hdFN0cmluZygkYXJ0aWNsZS0+Q29udGVudCwgJ1tub3NjcmlwdF0nKTsNCiAgICAgICAgICAgICRhcnRpY2xlLT5JbnRybyA9IEZvcm1hdFN0cmluZygkYXJ0aWNsZS0+SW50cm8sICdbbm9zY3JpcHRdJyk7DQogICAgICAgIH0NCiAgICB9IGVsc2Ugew0KICAgICAgICBpZiAoISR6YnAtPkNoZWNrUmlnaHRzKCdBcnRpY2xlQWxsJykpIHsNCiAgICAgICAgICAgICRhcnRpY2xlLT5Db250ZW50ID0gRm9ybWF0U3RyaW5nKCRhcnRpY2xlLT5Db250ZW50LCAnW25vc2NyaXB0XScpOw0KICAgICAgICAgICAgJGFydGljbGUtPkludHJvID0gRm9ybWF0U3RyaW5nKCRhcnRpY2xlLT5JbnRybywgJ1tub3NjcmlwdF0nKTsNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KLyoqDQogKiDov4fmu6TnlKjmiLfmlbDmja4uDQogKg0KICogQHBhcmFtICRtZW1iZXINCiAqDQogKiBAdGhyb3dzIEV4Y2VwdGlvbg0KICovDQpmdW5jdGlvbiBGaWx0ZXJNZW1iZXIoJiRtZW1iZXIpDQp7DQogICAgZ2xvYmFsICR6YnA7DQogICAgJG1lbWJlci0+SW50cm8gPSBGb3JtYXRTdHJpbmcoJG1lbWJlci0+SW50cm8sICdbbm9zY3JpcHRdJyk7DQogICAgJG1lbWJlci0+QWxpYXMgPSBGb3JtYXRTdHJpbmcoJG1lbWJlci0+QWxpYXMsICdbbm9ybWFsbmFtZV0nKTsNCiAgICAkbWVtYmVyLT5BbGlhcyA9IHN0cl9yZXBsYWNlKGFycmF5KCcvJywgJy4nLCAnICcsICfjgIAnLCAnXycpLCAnJywgJG1lbWJlci0+QWxpYXMpOw0KICAgICRtZW1iZXItPkFsaWFzID0gU3ViU3RyVVRGOF9TdGFydCgkbWVtYmVyLT5BbGlhcywgMCwgKGludCkgJHpicC0+ZGF0YWluZm9bJ01lbWJlciddWydBbGlhcyddWzJdKTsNCiAgICBpZiAoWmJwX1N0ckxlbigkbWVtYmVyLT5OYW1lKSA8ICR6YnAtPm9wdGlvblsnWkNfVVNFUk5BTUVfTUlOJ10gfHwgWmJwX1N0ckxlbigkbWVtYmVyLT5OYW1lKSA+ICR6YnAtPm9wdGlvblsnWkNfVVNFUk5BTUVfTUFYJ10pIHsNCiAgICAgICAgJHpicC0+U2hvd0Vycm9yKDc3LCBfX0ZJTEVfXywgX19MSU5FX18pOw0KICAgIH0NCg0KICAgIGlmICghQ2hlY2tSZWdFeHAoJG1lbWJlci0+TmFtZSwgJ1t1c2VybmFtZV0nKSkgew0KICAgICAgICAkemJwLT5TaG93RXJyb3IoNzcsIF9fRklMRV9fLCBfX0xJTkVfXyk7DQogICAgfQ0KDQogICAgaWYgKCRtZW1iZXItPkFsaWFzICE9ICcnICYmICFDaGVja1JlZ0V4cCgkbWVtYmVyLT5BbGlhcywgJ1tuaWNrbmFtZV0nKSkgew0KICAgICAgICAkemJwLT5TaG93RXJyb3IoOTAsIF9fRklMRV9fLCBfX0xJTkVfXyk7DQogICAgfQ0KDQogICAgaWYgKCFDaGVja1JlZ0V4cCgkbWVtYmVyLT5FbWFpbCwgJ1tlbWFpbF0nKSkgew0KICAgICAgICAkbWVtYmVyLT5FbWFpbCA9ICdudWxsQG51bGwuY29tJzsNCiAgICB9DQogICAgJG1lbWJlci0+RW1haWwgPSBzdHJ0b2xvd2VyKCRtZW1iZXItPkVtYWlsKTsNCg0KICAgIGlmIChzdWJzdHIoJG1lbWJlci0+SG9tZVBhZ2UsIDAsIDQpICE9ICdodHRwJykgew0KICAgICAgICAkbWVtYmVyLT5Ib21lUGFnZSA9ICdodHRwOi8vJyAuICRtZW1iZXItPkhvbWVQYWdlOw0KICAgIH0NCg0KICAgIGlmICghQ2hlY2tSZWdFeHAoJG1lbWJlci0+SG9tZVBhZ2UsICdbaG9tZXBhZ2VdJykpIHsNCiAgICAgICAgJG1lbWJlci0+SG9tZVBhZ2UgPSAnJzsNCiAgICB9DQoNCiAgICBpZiAoc3RybGVuKCRtZW1iZXItPkVtYWlsKSA+ICR6YnAtPm9wdGlvblsnWkNfRU1BSUxfTUFYJ10pIHsNCiAgICAgICAgJHpicC0+U2hvd0Vycm9yKDI5LCBfX0ZJTEVfXywgX19MSU5FX18pOw0KICAgIH0NCg0KICAgIGlmIChzdHJsZW4oJG1lbWJlci0+SG9tZVBhZ2UpID4gJHpicC0+b3B0aW9uWydaQ19IT01FUEFHRV9NQVgnXSkgew0KICAgICAgICAkemJwLT5TaG93RXJyb3IoMzAsIF9fRklMRV9fLCBfX0xJTkVfXyk7DQogICAgfQ0KfQ0KDQovKioNCiAqIOi/h+a7pOaooeWdl+aVsOaNri4NCiAqDQogKiBAcGFyYW0gJG1vZHVsZQ0KICovDQpmdW5jdGlvbiBGaWx0ZXJNb2R1bGUoJiRtb2R1bGUpDQp7DQogICAgZ2xvYmFsICR6YnA7DQogICAgJG1vZHVsZS0+RmlsZU5hbWUgPSBGb3JtYXRTdHJpbmcoJG1vZHVsZS0+RmlsZU5hbWUsICdbZmlsZW5hbWVdJyk7DQogICAgJG1vZHVsZS0+SHRtbElEID0gRm9ybWF0U3RyaW5nKCRtb2R1bGUtPkh0bWxJRCwgJ1tub3JtYWxuYW1lXScpOw0KfQ0KDQovKioNCiAqIOi/h+a7pOWIhuexu+aVsOaNri4NCiAqDQogKiBAcGFyYW0gJGNhdGVnb3J5DQogKi8NCmZ1bmN0aW9uIEZpbHRlckNhdGVnb3J5KCYkY2F0ZWdvcnkpDQp7DQogICAgZ2xvYmFsICR6YnA7DQogICAgJGNhdGVnb3J5LT5OYW1lID0gc3RyaXBfdGFncygkY2F0ZWdvcnktPk5hbWUpOw0KICAgICRjYXRlZ29yeS0+TmFtZSA9IHRyaW0oJGNhdGVnb3J5LT5OYW1lKTsNCiAgICAkY2F0ZWdvcnktPkFsaWFzID0gRm9ybWF0U3RyaW5nKCRjYXRlZ29yeS0+QWxpYXMsICdbbm9ybWFsbmFtZV0nKTsNCiAgICAvLyRjYXRlZ29yeS0+QWxpYXM9c3RyX3JlcGxhY2UoJy8nLCcnLCRjYXRlZ29yeS0+QWxpYXMpOw0KICAgICRjYXRlZ29yeS0+QWxpYXMgPSBzdHJfcmVwbGFjZSgnLicsICcnLCAkY2F0ZWdvcnktPkFsaWFzKTsNCiAgICAkY2F0ZWdvcnktPkFsaWFzID0gc3RyX3JlcGxhY2UoJyAnLCAnJywgJGNhdGVnb3J5LT5BbGlhcyk7DQogICAgJGNhdGVnb3J5LT5BbGlhcyA9IHN0cl9yZXBsYWNlKCdfJywgJycsICRjYXRlZ29yeS0+QWxpYXMpOw0KICAgICRjYXRlZ29yeS0+QWxpYXMgPSB0cmltKCRjYXRlZ29yeS0+QWxpYXMpOw0KfQ0KDQovKioNCiAqIOi/h+a7pHRhZ+aVsOaNri4NCiAqDQogKiBAcGFyYW0gJHRhZw0KICovDQpmdW5jdGlvbiBGaWx0ZXJUYWcoJiR0YWcpDQp7DQogICAgZ2xvYmFsICR6YnA7DQogICAgJHRhZy0+TmFtZSA9IHN0cmlwX3RhZ3MoJHRhZy0+TmFtZSk7DQogICAgJHRhZy0+TmFtZSA9IHRyaW0oJHRhZy0+TmFtZSk7DQogICAgJHRhZy0+QWxpYXMgPSBGb3JtYXRTdHJpbmcoJHRhZy0+QWxpYXMsICdbbm9ybWFsbmFtZV0nKTsNCiAgICAkdGFnLT5BbGlhcyA9IHN0cl9yZXBsYWNlKCcuJywgJycsICR0YWctPkFsaWFzKTsNCiAgICAkdGFnLT5BbGlhcyA9IHN0cl9yZXBsYWNlKCcgJywgJycsICR0YWctPkFsaWFzKTsNCiAgICAkdGFnLT5BbGlhcyA9IHN0cl9yZXBsYWNlKCdfJywgJycsICR0YWctPkFsaWFzKTsNCiAgICAkdGFnLT5BbGlhcyA9IHRyaW0oJHRhZy0+QWxpYXMpOw0KfQ0KDQovLyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KLy/nu5/orqHlh73mlbANCg0KLyoqDQogKue7n+iuoee9rumhtuaWh+eroOaVsOe7hC4NCiAqDQogKiBAcGFyYW0gaW50ICAkdHlwZQ0KICogQHBhcmFtIG51bGwgJGFkZHBsdXMNCiAqIEBwYXJhbSBudWxsICRkZWxwbHVzDQogKi8NCmZ1bmN0aW9uIENvdW50VG9wUG9zdCgkdHlwZSA9IDAsICRhZGRwbHVzID0gbnVsbCwgJGRlbHBsdXMgPSBudWxsKQ0Kew0KICAgIGdsb2JhbCAkemJwOw0KICAgICR2YXJuYW1lID0gJ3RvcF9wb3N0X2FycmF5XycgLiAkdHlwZTsNCiAgICBAJGFycmF5ID0gdW5zZXJpYWxpemUoJHpicC0+Y2FjaGUtPiR2YXJuYW1lKTsNCiAgICBpZiAoIWlzX2FycmF5KCRhcnJheSkpIHsNCiAgICAgICAgJGFycmF5ID0gYXJyYXkoKTsNCiAgICB9DQoNCiAgICBpZiAoJGFkZHBsdXMgPT09IG51bGwgJiYgJGRlbHBsdXMgPT09IG51bGwpIHsNCiAgICAgICAgJHMgPSAkemJwLT5kYi0+c3FsLT5TZWxlY3QoJHpicC0+dGFibGVbJ1Bvc3QnXSwgJ2xvZ19JRCcsIGFycmF5KGFycmF5KCc9JywgJ2xvZ19UeXBlJywgJHR5cGUpLCBhcnJheSgnPicsICdsb2dfSXNUb3AnLCAwKSwgYXJyYXkoJz0nLCAnbG9nX1N0YXR1cycsIDApKSwgbnVsbCwgbnVsbCwgbnVsbCk7DQogICAgICAgICRhID0gJHpicC0+ZGItPlF1ZXJ5KCRzKTsNCiAgICAgICAgZm9yZWFjaCAoJGEgYXMgJGlkKSB7DQogICAgICAgICAgICAkYXJyYXlbKGludCkgY3VycmVudCgkaWQpXSA9IChpbnQpIGN1cnJlbnQoJGlkKTsNCiAgICAgICAgfQ0KICAgIH0gZWxzZWlmICgkYWRkcGx1cyAhPT0gbnVsbCAmJiAkZGVscGx1cyA9PT0gbnVsbCkgew0KICAgICAgICAkYWRkcGx1cyA9IChpbnQpICRhZGRwbHVzOw0KICAgICAgICAkYXJyYXlbJGFkZHBsdXNdID0gJGFkZHBsdXM7DQogICAgfSBlbHNlaWYgKCRhZGRwbHVzID09PSBudWxsICYmICRkZWxwbHVzICE9PSBudWxsKSB7DQogICAgICAgICRkZWxwbHVzID0gKGludCkgJGRlbHBsdXM7DQogICAgICAgIHVuc2V0KCRhcnJheVskZGVscGx1c10pOw0KICAgIH0NCg0KICAgICR6YnAtPmNhY2hlLT4kdmFybmFtZSA9IHNlcmlhbGl6ZSgkYXJyYXkpOw0KfQ0KDQovKioNCiAq57uf6K6h6K+E6K665pWwLg0KICoNCiAqIEBwYXJhbSBpbnQgJGFsbHBsdXMg5o6n5Yi25piv5ZCm6KaB6L+b6KGM5YWo6KGo5omr5o+PIOaAu+ivhOiuug0KICogQHBhcmFtIGludCAkY2hrcGx1cyDmjqfliLbmmK/lkKbopoHov5vooYzlhajooajmiavmj48g5pyq5a6h5qC46K+E6K66DQogKi8NCmZ1bmN0aW9uIENvdW50Q29tbWVudE51bXMoJGFsbHBsdXMgPSBudWxsLCAkY2hrcGx1cyA9IG51bGwpDQp7DQogICAgZ2xvYmFsICR6YnA7DQoNCiAgICBpZiAoJGFsbHBsdXMgPT09IG51bGwpIHsNCiAgICAgICAgJHpicC0+Y2FjaGUtPmFsbF9jb21tZW50X251bXMgPSAoaW50KSBHZXRWYWx1ZUluQXJyYXlCeUN1cnJlbnQoJHpicC0+ZGItPnNxbC0+Z2V0KCktPnNlbGVjdCgkR0xPQkFMU1sndGFibGUnXVsnQ29tbWVudCddKS0+Y291bnQoYXJyYXkoJyonID0+ICdudW0nKSktPnF1ZXJ5LCAnbnVtJyk7DQogICAgfSBlbHNlIHsNCiAgICAgICAgJHpicC0+Y2FjaGUtPmFsbF9jb21tZW50X251bXMgKz0gJGFsbHBsdXM7DQogICAgfQ0KICAgIGlmICgkY2hrcGx1cyA9PT0gbnVsbCkgew0KICAgICAgICAkemJwLT5jYWNoZS0+Y2hlY2tfY29tbWVudF9udW1zID0gKGludCkgR2V0VmFsdWVJbkFycmF5QnlDdXJyZW50KCR6YnAtPmRiLT5zcWwtPmdldCgpLT5zZWxlY3QoJEdMT0JBTFNbJ3RhYmxlJ11bJ0NvbW1lbnQnXSktPmNvdW50KGFycmF5KCcqJyA9PiAnbnVtJykpLT53aGVyZSgnPScsICdjb21tX0lzY2hlY2tpbmcnLCAnMScpLT5xdWVyeSwgJ251bScpOw0KICAgIH0gZWxzZSB7DQogICAgICAgICR6YnAtPmNhY2hlLT5jaGVja19jb21tZW50X251bXMgKz0gJGNoa3BsdXM7DQogICAgfQ0KICAgICR6YnAtPmNhY2hlLT5ub3JtYWxfY29tbWVudF9udW1zID0gKGludCkgKCR6YnAtPmNhY2hlLT5hbGxfY29tbWVudF9udW1zIC0gJHpicC0+Y2FjaGUtPmNoZWNrX2NvbW1lbnRfbnVtcyk7DQp9DQoNCi8qKg0KICrnu5/orqHlhazlvIDmlofnq6DmlbAuDQogKg0KICogQHBhcmFtIGludCAkcGx1cyDmjqfliLbmmK/lkKbopoHov5vooYzlhajooajmiavmj48NCiAqLw0KZnVuY3Rpb24gQ291bnROb3JtYWxBcnRpY2xlTnVtcygkcGx1cyA9IG51bGwpDQp7DQogICAgZ2xvYmFsICR6YnA7DQoNCiAgICBpZiAoJHBsdXMgPT09IG51bGwpIHsNCiAgICAgICAgJHMgPSAkemJwLT5kYi0+c3FsLT5Db3VudCgkemJwLT50YWJsZVsnUG9zdCddLCBhcnJheShhcnJheSgnQ09VTlQnLCAnKicsICdudW0nKSksIGFycmF5KGFycmF5KCc9JywgJ2xvZ19UeXBlJywgMCksIGFycmF5KCc9JywgJ2xvZ19Jc1RvcCcsIDApLCBhcnJheSgnPScsICdsb2dfU3RhdHVzJywgMCkpKTsNCiAgICAgICAgJG51bSA9IEdldFZhbHVlSW5BcnJheUJ5Q3VycmVudCgkemJwLT5kYi0+UXVlcnkoJHMpLCAnbnVtJyk7DQoNCiAgICAgICAgJHpicC0+Y2FjaGUtPm5vcm1hbF9hcnRpY2xlX251bXMgPSAkbnVtOw0KICAgIH0gZWxzZSB7DQogICAgICAgICR6YnAtPmNhY2hlLT5ub3JtYWxfYXJ0aWNsZV9udW1zICs9ICRwbHVzOw0KICAgIH0NCn0NCg0KLyoqDQogKiDnu5/orqHmlofnq6DkuIvor4TorrrmlbAuDQogKg0KICogQHBhcmFtIHBvc3QgJGFydGljbGUNCiAqIEBwYXJhbSBpbnQgICRwbHVzICAgIOaOp+WItuaYr+WQpuimgei/m+ihjOWFqOihqOaJq+aPjw0KICovDQpmdW5jdGlvbiBDb3VudFBvc3QoJiRhcnRpY2xlLCAkcGx1cyA9IG51bGwpDQp7DQogICAgZ2xvYmFsICR6YnA7DQoNCiAgICBpZiAoJHBsdXMgPT09IG51bGwpIHsNCiAgICAgICAgJGlkID0gJGFydGljbGUtPklEOw0KDQogICAgICAgICRzID0gJHpicC0+ZGItPnNxbC0+Q291bnQoJHpicC0+dGFibGVbJ0NvbW1lbnQnXSwgYXJyYXkoYXJyYXkoJ0NPVU5UJywgJyonLCAnbnVtJykpLCBhcnJheShhcnJheSgnPScsICdjb21tX0xvZ0lEJywgJGlkKSwgYXJyYXkoJz0nLCAnY29tbV9Jc0NoZWNraW5nJywgMCkpKTsNCiAgICAgICAgJG51bSA9IEdldFZhbHVlSW5BcnJheUJ5Q3VycmVudCgkemJwLT5kYi0+UXVlcnkoJHMpLCAnbnVtJyk7DQoNCiAgICAgICAgJGFydGljbGUtPkNvbW1OdW1zID0gJG51bTsNCiAgICB9IGVsc2Ugew0KICAgICAgICAkYXJ0aWNsZS0+Q29tbU51bXMgKz0gJHBsdXM7DQogICAgfQ0KfQ0KDQovKioNCiAqIOaJuemHj+e7n+iuoeaMh+WumuaWh+eroOS4i+ivhOiuuuaVsOW5tuS/neWtmC4NCiAqDQogKiBAcGFyYW0gYXJyYXkgJGFycmF5IOiusOW9leaWh+eroElE55qE5pWw57uEDQogKiBAcGFyYW0gaW50ICAgJHBsdXMgIOaOp+WItuaYr+WQpuimgei/m+ihjOWFqOihqOaJq+aPjw0KICogQHBhcmFtIGludCAgICAgICR0eXBlICAgICAgcG9zdOWSjGNhdGVnb3J555qE5YiG57G7VHlwZQ0KICovDQpmdW5jdGlvbiBDb3VudFBvc3RBcnJheSgkYXJyYXksICRwbHVzID0gbnVsbCwgJHR5cGUgPSAwKQ0Kew0KICAgIGdsb2JhbCAkemJwOw0KICAgICRhcnJheSA9IGFycmF5X3VuaXF1ZSgkYXJyYXkpOw0KICAgIGZvcmVhY2ggKCRhcnJheSBhcyAkdmFsdWUpIHsNCiAgICAgICAgaWYgKCR2YWx1ZSA9PSAwKSB7DQogICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgfQ0KDQogICAgICAgICRhcnRpY2xlID0gJHpicC0+R2V0UG9zdEJ5SUQoJHZhbHVlKTsNCiAgICAgICAgaWYgKCRhcnRpY2xlLT5JRCA+IDApIHsNCiAgICAgICAgICAgIENvdW50UG9zdCgkYXJ0aWNsZSwgJHBsdXMsICR0eXBlKTsNCiAgICAgICAgICAgICRhcnRpY2xlLT5TYXZlKCk7DQogICAgICAgIH0NCiAgICB9DQp9DQoNCi8qKg0KICog57uf6K6h5YiG57G75LiL5paH56ug5pWwLg0KICoNCiAqIEBwYXJhbSBDYXRlZ29yeSAmJGNhdGVnb3J5DQogKiBAcGFyYW0gaW50ICAgICAgJHBsdXMgICAgICDmjqfliLbmmK/lkKbopoHov5vooYzlhajooajmiavmj48NCiAqIEBwYXJhbSBpbnQgICAgICAkdHlwZSAgICAgIHBvc3TlkoxjYXRlZ29yeeeahOWIhuexu1R5cGUNCiAqLw0KZnVuY3Rpb24gQ291bnRDYXRlZ29yeSgmJGNhdGVnb3J5LCAkcGx1cyA9IG51bGwsICR0eXBlID0gMCkNCnsNCiAgICBnbG9iYWwgJHpicDsNCg0KICAgIGlmICgkcGx1cyA9PT0gbnVsbCkgew0KICAgICAgICAkaWQgPSAkY2F0ZWdvcnktPklEOw0KDQogICAgICAgICRzID0gJHpicC0+ZGItPnNxbC0+Q291bnQoJHpicC0+dGFibGVbJ1Bvc3QnXSwgYXJyYXkoYXJyYXkoJ0NPVU5UJywgJyonLCAnbnVtJykpLCBhcnJheShhcnJheSgnPScsICdsb2dfVHlwZScsICR0eXBlKSwgYXJyYXkoJz0nLCAnbG9nX1N0YXR1cycsIDApLCBhcnJheSgnPScsICdsb2dfQ2F0ZUlEJywgJGlkKSkpOw0KICAgICAgICAkbnVtID0gR2V0VmFsdWVJbkFycmF5QnlDdXJyZW50KCR6YnAtPmRiLT5RdWVyeSgkcyksICdudW0nKTsNCg0KICAgICAgICAkY2F0ZWdvcnktPkNvdW50ID0gJG51bTsNCiAgICB9IGVsc2Ugew0KICAgICAgICAkY2F0ZWdvcnktPkNvdW50ICs9ICRwbHVzOw0KICAgIH0NCn0NCg0KLyoqDQogKiDmibnph4/nu5/orqHmjIflrprliIbnsbvkuIvmlofnq6DmlbDlubbkv53lrZguDQogKg0KICogQHBhcmFtIGFycmF5ICRhcnJheSDorrDlvZXliIbnsbtJROeahOaVsOe7hA0KICogQHBhcmFtIGludCAgICRwbHVzICDmjqfliLbmmK/lkKbopoHov5vooYzlhajooajmiavmj48NCiAqIEBwYXJhbSBpbnQgICAkdHlwZSAgcG9zdOWSjGNhdGVnb3J555qE5YiG57G7VHlwZQ0KICovDQpmdW5jdGlvbiBDb3VudENhdGVnb3J5QXJyYXkoJGFycmF5LCAkcGx1cyA9IG51bGwsICR0eXBlID0gMCkNCnsNCiAgICBnbG9iYWwgJHpicDsNCiAgICAkYXJyYXkgPSBhcnJheV91bmlxdWUoJGFycmF5KTsNCiAgICBmb3JlYWNoICgkYXJyYXkgYXMgJHZhbHVlKSB7DQogICAgICAgIGlmICgkdmFsdWUgPT0gMCkgew0KICAgICAgICAgICAgY29udGludWU7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGlzc2V0KCR6YnAtPmNhdGVnb3JpZXNfYWxsWyR2YWx1ZV0pKSB7DQogICAgICAgICAgICBDb3VudENhdGVnb3J5KCR6YnAtPmNhdGVnb3JpZXNfYWxsWyR2YWx1ZV0sICRwbHVzLCAkdHlwZSk7DQogICAgICAgICAgICAkemJwLT5jYXRlZ29yaWVzX2FsbFskdmFsdWVdLT5TYXZlKCk7DQogICAgICAgIH0NCiAgICB9DQp9DQoNCi8qKg0KICog57uf6K6hdGFn5LiL55qE5paH56ug5pWwLg0KICoNCiAqIEBwYXJhbSB0YWcgJiR0YWcNCiAqIEBwYXJhbSBpbnQgJHBsdXMg5o6n5Yi25piv5ZCm6KaB6L+b6KGM5YWo6KGo5omr5o+PDQogKiBAcGFyYW0gaW50ICR0eXBlIHBvc3Tlkox0YWfnmoTliIbnsbtUeXBlDQogKi8NCmZ1bmN0aW9uIENvdW50VGFnKCYkdGFnLCAkcGx1cyA9IG51bGwsICR0eXBlID0gMCkNCnsNCiAgICBnbG9iYWwgJHpicDsNCg0KICAgIGlmICgkcGx1cyA9PT0gbnVsbCkgew0KICAgICAgICAkaWQgPSAkdGFnLT5JRDsNCiAgICAgICAgJHcgPSBhcnJheSgpOw0KICAgICAgICAkd1tdID0gYXJyYXkoJz0nLCAnbG9nX1R5cGUnLCAkdHlwZSk7DQogICAgICAgICR3W10gPSBhcnJheSgnTElLRScsICdsb2dfVGFnJywgJyV7JyAuICRpZCAuICd9JScpOw0KICAgICAgICAkcyA9ICR6YnAtPmRiLT5zcWwtPkNvdW50KCR6YnAtPnRhYmxlWydQb3N0J10sIGFycmF5KGFycmF5KCdDT1VOVCcsICcqJywgJ251bScpKSwgJHcpOw0KICAgICAgICAkbnVtID0gR2V0VmFsdWVJbkFycmF5QnlDdXJyZW50KCR6YnAtPmRiLT5RdWVyeSgkcyksICdudW0nKTsNCg0KICAgICAgICAkdGFnLT5Db3VudCA9ICRudW07DQogICAgfSBlbHNlIHsNCiAgICAgICAgJHRhZy0+Q291bnQgKz0gJHBsdXM7DQogICAgfQ0KfQ0KDQovKioNCiAqIOaJuemHj+e7n+iuoeaMh+WumnRhZ+S4i+aWh+eroOaVsOW5tuS/neWtmC4NCiAqDQogKiBAcGFyYW0gc3RyaW5nICRzdHJpbmcg57G75Ly8J3sxfXsyfXszfXs0fXs0fSfnmoR0YWdJROS4sg0KICogQHBhcmFtIGludCAgICAkcGx1cyAgIOaOp+WItuaYr+WQpuimgei/m+ihjOWFqOihqOaJq+aPjw0KICogQHBhcmFtIGludCAgICAkYXJ0aWNsZWlkICAg5pqC5rKh5Y+R546w5pyJ55So5aSE55qE5Y+C5pWwDQogKg0KICogQHJldHVybiBib29sDQogKi8NCmZ1bmN0aW9uIENvdW50VGFnQXJyYXlTdHJpbmcoJHN0cmluZywgJHBsdXMgPSBudWxsLCAkYXJ0aWNsZWlkID0gbnVsbCkNCnsNCiAgICBnbG9iYWwgJHpicDsNCiAgICAvKiBAdmFyIFRhZ1tdICRhcnJheSAqLw0KICAgICRhcnJheSA9ICR6YnAtPkxvYWRUYWdzQnlJRFN0cmluZygkc3RyaW5nKTsNCg0KICAgIC8v5re75Yqg5aSn5pWw5o2u5o6l5Y+jLHRhZyxwbHVzLGlkDQogICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fTGFyZ2VEYXRhX0NvdW50VGFnQXJyYXknXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgJGZwcmV0dXJuID0gJGZwbmFtZSgkYXJyYXksICRwbHVzLCAkYXJ0aWNsZWlkKTsNCiAgICAgICAgaWYgKCRmcHNpZ25hbCA9PSBQTFVHSU5fRVhJVFNJR05BTF9SRVRVUk4pIHsNCiAgICAgICAgICAgICRmcHNpZ25hbCA9IFBMVUdJTl9FWElUU0lHTkFMX05PTkU7DQoNCiAgICAgICAgICAgIHJldHVybiAkZnByZXR1cm47DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBmb3JlYWNoICgkYXJyYXkgYXMgJiR0YWcpIHsNCiAgICAgICAgQ291bnRUYWcoJHRhZywgJHBsdXMsICR0YWctPlR5cGUpOw0KICAgICAgICAkdGFnLT5TYXZlKCk7DQogICAgfQ0KDQogICAgcmV0dXJuIHRydWU7DQp9DQoNCi8qKg0KICog57uf6K6h55So5oi35LiL55qE5paH56ug5pWw44CB6aG16Z2i5pWw44CB6K+E6K665pWw44CB6ZmE5Lu25pWw562JLg0KICoNCiAqIEBwYXJhbSAkbWVtYmVyDQogKiBAcGFyYW0gYXJyYXkgJHBsdXMg6K6+572u5piv5ZCm6ZyA6KaB5a6M5YWo5YWo6KGo5omr5o+PDQogKi8NCmZ1bmN0aW9uIENvdW50TWVtYmVyKCYkbWVtYmVyLCAkcGx1cyA9IGFycmF5KG51bGwsIG51bGwsIG51bGwsIG51bGwpKQ0Kew0KICAgIGdsb2JhbCAkemJwOw0KICAgIGlmICghKCRtZW1iZXIgaW5zdGFuY2VvZiBNZW1iZXIpKSB7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICAkaWQgPSAkbWVtYmVyLT5JRDsNCg0KICAgIGlmICgkcGx1c1swXSA9PT0gbnVsbCkgew0KICAgICAgICAkcyA9ICR6YnAtPmRiLT5zcWwtPkNvdW50KCR6YnAtPnRhYmxlWydQb3N0J10sIGFycmF5KGFycmF5KCdDT1VOVCcsICcqJywgJ251bScpKSwgYXJyYXkoYXJyYXkoJz0nLCAnbG9nX0F1dGhvcklEJywgJGlkKSwgYXJyYXkoJz0nLCAnbG9nX1R5cGUnLCAwKSkpOw0KICAgICAgICAkbWVtYmVyX0FydGljbGVzID0gR2V0VmFsdWVJbkFycmF5QnlDdXJyZW50KCR6YnAtPmRiLT5RdWVyeSgkcyksICdudW0nKTsNCiAgICAgICAgJG1lbWJlci0+QXJ0aWNsZXMgPSAkbWVtYmVyX0FydGljbGVzOw0KICAgIH0gZWxzZSB7DQogICAgICAgICRtZW1iZXItPkFydGljbGVzICs9ICRwbHVzWzBdOw0KICAgIH0NCg0KICAgIGlmICgkcGx1c1sxXSA9PT0gbnVsbCkgew0KICAgICAgICAkcyA9ICR6YnAtPmRiLT5zcWwtPkNvdW50KCR6YnAtPnRhYmxlWydQb3N0J10sIGFycmF5KGFycmF5KCdDT1VOVCcsICcqJywgJ251bScpKSwgYXJyYXkoYXJyYXkoJz0nLCAnbG9nX0F1dGhvcklEJywgJGlkKSwgYXJyYXkoJz0nLCAnbG9nX1R5cGUnLCAxKSkpOw0KICAgICAgICAkbWVtYmVyX1BhZ2VzID0gR2V0VmFsdWVJbkFycmF5QnlDdXJyZW50KCR6YnAtPmRiLT5RdWVyeSgkcyksICdudW0nKTsNCiAgICAgICAgJG1lbWJlci0+UGFnZXMgPSAkbWVtYmVyX1BhZ2VzOw0KICAgIH0gZWxzZSB7DQogICAgICAgICRtZW1iZXItPlBhZ2VzICs9ICRwbHVzWzFdOw0KICAgIH0NCg0KICAgIGlmICgkcGx1c1syXSA9PT0gbnVsbCkgew0KICAgICAgICBpZiAoJG1lbWJlci0+SUQgPiAwKSB7DQogICAgICAgICAgICAkcyA9ICR6YnAtPmRiLT5zcWwtPkNvdW50KCR6YnAtPnRhYmxlWydDb21tZW50J10sIGFycmF5KGFycmF5KCdDT1VOVCcsICcqJywgJ251bScpKSwgYXJyYXkoYXJyYXkoJz0nLCAnY29tbV9BdXRob3JJRCcsICRpZCksIGFycmF5KCc9JywgJ2NvbW1fSXNDaGVja2luZycsIDApKSk7DQogICAgICAgICAgICAkbWVtYmVyX0NvbW1lbnRzID0gR2V0VmFsdWVJbkFycmF5QnlDdXJyZW50KCR6YnAtPmRiLT5RdWVyeSgkcyksICdudW0nKTsNCiAgICAgICAgICAgICRtZW1iZXItPkNvbW1lbnRzID0gJG1lbWJlcl9Db21tZW50czsNCiAgICAgICAgfQ0KICAgIH0gZWxzZSB7DQogICAgICAgICRtZW1iZXItPkNvbW1lbnRzICs9ICRwbHVzWzJdOw0KICAgIH0NCg0KICAgIGlmICgkcGx1c1szXSA9PT0gbnVsbCkgew0KICAgICAgICAkcyA9ICR6YnAtPmRiLT5zcWwtPkNvdW50KCR6YnAtPnRhYmxlWydVcGxvYWQnXSwgYXJyYXkoYXJyYXkoJ0NPVU5UJywgJyonLCAnbnVtJykpLCBhcnJheShhcnJheSgnPScsICd1bF9BdXRob3JJRCcsICRpZCkpKTsNCiAgICAgICAgJG1lbWJlcl9VcGxvYWRzID0gR2V0VmFsdWVJbkFycmF5QnlDdXJyZW50KCR6YnAtPmRiLT5RdWVyeSgkcyksICdudW0nKTsNCiAgICAgICAgJG1lbWJlci0+VXBsb2FkcyA9ICRtZW1iZXJfVXBsb2FkczsNCiAgICB9IGVsc2Ugew0KICAgICAgICAkbWVtYmVyLT5VcGxvYWRzICs9ICRwbHVzWzNdOw0KICAgIH0NCn0NCg0KLyoqDQogKiDmibnph4/nu5/orqHmjIflrprnlKjmiLfmlbDmja7lubbkv53lrZguDQogKg0KICogQHBhcmFtIGFycmF5ICRhcnJheSDorrDlvZXnlKjmiLdJROeahOaVsOe7hA0KICogQHBhcmFtIGFycmF5ICRwbHVzICDorr7nva7mmK/lkKbpnIDopoHlrozlhajlhajooajmiavmj48NCiAqLw0KZnVuY3Rpb24gQ291bnRNZW1iZXJBcnJheSgkYXJyYXksICRwbHVzID0gYXJyYXkobnVsbCwgbnVsbCwgbnVsbCwgbnVsbCkpDQp7DQogICAgZ2xvYmFsICR6YnA7DQogICAgJGFycmF5ID0gYXJyYXlfdW5pcXVlKCRhcnJheSk7DQogICAgZm9yZWFjaCAoJGFycmF5IGFzICR2YWx1ZSkgew0KICAgICAgICBpZiAoJHZhbHVlID09IDApIHsNCiAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKGlzc2V0KCR6YnAtPm1lbWJlcnNbJHZhbHVlXSkpIHsNCiAgICAgICAgICAgIENvdW50TWVtYmVyKCR6YnAtPm1lbWJlcnNbJHZhbHVlXSwgJHBsdXMpOw0KICAgICAgICAgICAgJHpicC0+bWVtYmVyc1skdmFsdWVdLT5TYXZlKCk7DQogICAgICAgIH0NCiAgICB9DQp9DQoNCi8vIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQoNCi8qKg0KICogQnVpbGRNb2R1bGVfY2F0YWxvZw0KICoNCiAqIEBkZXByZWNhdGVkDQogKg0KICogQHRocm93cyBFeGNlcHRpb24NCiAqDQogKiBAcmV0dXJuIHN0cmluZw0KICovDQpmdW5jdGlvbiBCdWlsZE1vZHVsZV9jYXRhbG9nKCkNCnsNCiAgICByZXR1cm4gTW9kdWxlQnVpbGRlcjo6Q2F0YWxvZygpOw0KfQ0KDQovKioNCiAqIEJ1aWxkTW9kdWxlX2NhbGVuZGFyDQogKg0KICogQHBhcmFtIHN0cmluZyAkZGF0ZQ0KICoNCiAqIEBkZXByZWNhdGVkDQogKg0KICogQHRocm93cyBFeGNlcHRpb24NCiAqDQogKiBAcmV0dXJuIHN0cmluZw0KICovDQpmdW5jdGlvbiBCdWlsZE1vZHVsZV9jYWxlbmRhcigkZGF0ZSA9ICcnKQ0Kew0KICAgIHJldHVybiBNb2R1bGVCdWlsZGVyOjpDYWxlbmRhcigkZGF0ZSk7DQp9DQoNCi8qKg0KICogQnVpbGRNb2R1bGVfY29tbWVudHMNCiAqDQogKiBAZGVwcmVjYXRlZA0KICoNCiAqIEB0aHJvd3MgRXhjZXB0aW9uDQogKg0KICogQHJldHVybiBzdHJpbmcNCiAqLw0KZnVuY3Rpb24gQnVpbGRNb2R1bGVfY29tbWVudHMoKQ0Kew0KICAgIHJldHVybiBNb2R1bGVCdWlsZGVyOjpDb21tZW50cygpOw0KfQ0KDQovKioNCiAqIEJ1aWxkTW9kdWxlX3ByZXZpb3VzDQogKg0KICogQGRlcHJlY2F0ZWQNCiAqDQogKiBAdGhyb3dzIEV4Y2VwdGlvbg0KICoNCiAqIEByZXR1cm4gc3RyaW5nDQogKi8NCmZ1bmN0aW9uIEJ1aWxkTW9kdWxlX3ByZXZpb3VzKCkNCnsNCiAgICByZXR1cm4gTW9kdWxlQnVpbGRlcjo6TGF0ZXN0QXJ0aWNsZXMoKTsNCn0NCg0KLyoqDQogKiBCdWlsZE1vZHVsZV9hcmNoaXZlcw0KICoNCiAqIEBkZXByZWNhdGVkDQogKg0KICogQHRocm93cyBFeGNlcHRpb24NCiAqDQogKiBAcmV0dXJuIHN0cmluZw0KICovDQpmdW5jdGlvbiBCdWlsZE1vZHVsZV9hcmNoaXZlcygpDQp7DQogICAgcmV0dXJuIE1vZHVsZUJ1aWxkZXI6OkFyY2hpdmVzKCk7DQp9DQoNCi8qKg0KICogQnVpbGRNb2R1bGVfbmF2YmFyDQogKg0KICogQGRlcHJlY2F0ZWQNCiAqDQogKiBAdGhyb3dzIEV4Y2VwdGlvbg0KICoNCiAqIEByZXR1cm4gc3RyaW5nDQogKi8NCmZ1bmN0aW9uIEJ1aWxkTW9kdWxlX25hdmJhcigpDQp7DQogICAgcmV0dXJuIE1vZHVsZUJ1aWxkZXI6Ok5hdmJhcigpOw0KfQ0KDQovKioNCiAqIEJ1aWxkTW9kdWxlX3RhZ3MNCiAqDQogKiBAZGVwcmVjYXRlZA0KICoNCiAqIEB0aHJvd3MgRXhjZXB0aW9uDQogKg0KICogQHJldHVybiBzdHJpbmcNCiAqLw0KZnVuY3Rpb24gQnVpbGRNb2R1bGVfdGFncygpDQp7DQogICAgcmV0dXJuIE1vZHVsZUJ1aWxkZXI6OlRhZ0xpc3QoKTsNCn0NCg0KLyoqDQogKiBCdWlsZE1vZHVsZV9hdXRob3JzDQogKg0KICogQHBhcmFtIGludCAkbGV2ZWwNCiAqDQogKiBAZGVwcmVjYXRlZA0KICoNCiAqIEB0aHJvd3MgRXhjZXB0aW9uDQogKg0KICogQHJldHVybiBzdHJpbmcNCiAqLw0KZnVuY3Rpb24gQnVpbGRNb2R1bGVfYXV0aG9ycygkbGV2ZWwgPSA0KQ0Kew0KICAgIHJldHVybiBNb2R1bGVCdWlsZGVyOjpBdXRob3JzKCRsZXZlbCk7DQp9DQoNCi8qKg0KICogQnVpbGRNb2R1bGVfc3RhdGlzdGljcw0KICoNCiAqIEBwYXJhbSBhcnJheSAkYXJyYXkNCiAqDQogKiBAZGVwcmVjYXRlZA0KICoNCiAqIEB0aHJvd3MgRXhjZXB0aW9uDQogKg0KICogQHJldHVybiBzdHJpbmcNCiAqLw0KZnVuY3Rpb24gQnVpbGRNb2R1bGVfc3RhdGlzdGljcygkYXJyYXkgPSBhcnJheSgpKQ0Kew0KICAgIHJldHVybiBNb2R1bGVCdWlsZGVyOjpTdGF0aXN0aWNzKCRhcnJheSk7DQp9DQo=</file>
	<file name='zb_system\function\c_system_route.php' crc32='75A5818B'  dt:dt='bin.base64'>PD9waHANCg0KLyoqDQogKiDot6/nlLHlkozmjqfliLblmajnm7jlhbPlh73mlbAuDQogKi8NCg0KaWYgKCFkZWZpbmVkKCdaQlBfUEFUSCcpKSB7DQogICAgZXhpdCgnQWNjZXNzIGRlbmllZCcpOw0KfQ0KDQovLyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KDQovKioNCiAqIOagueaNrnVybOi3r+eUseinhOWImeaYvuekuumhtemdoueahOS4u+i3r+eUseWZqOWHveaVsC4NCiAqDQogKg0KICogQGFwaSBGaWx0ZXJfUGx1Z2luX1ZpZXdBdXRvX0JlZ2luDQogKiBAYXBpIEZpbHRlcl9QbHVnaW5fVmlld0F1dG9fRW5kDQogKg0KICogQHRocm93cyBFeGNlcHRpb24NCiAqDQogKiBAcmV0dXJuIG51bGx8c3RyaW5nDQogKi8NCmZ1bmN0aW9uIFZpZXdBdXRvKCkNCnsNCiAgICBnbG9iYWwgJHpicDsNCg0KICAgICRvcmlnaW5hbF91cmwgPSAkemJwLT5jdXJyZW50dXJsOw0KDQogICAgJHVybCA9IEdldFZhbHVlSW5BcnJheShleHBsb2RlKCc/JywgJG9yaWdpbmFsX3VybCksICcwJyk7DQoNCiAgICBpZiAoJHpicC0+Y29va2llc3BhdGggPT09IHN1YnN0cigkdXJsLCAwLCBzdHJsZW4oJHpicC0+Y29va2llc3BhdGgpKSkgew0KICAgICAgICAkdXJsID0gc3Vic3RyKCR1cmwsIHN0cmxlbigkemJwLT5jb29raWVzcGF0aCkpOw0KICAgIH0NCg0KICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1ZpZXdBdXRvX0JlZ2luJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICRmcHJldHVybiA9ICRmcG5hbWUoJG9yaWdpbmFsX3VybCwgJHVybCk7DQogICAgICAgIGlmICgkZnBzaWduYWwgPT0gUExVR0lOX0VYSVRTSUdOQUxfUkVUVVJOKSB7DQogICAgICAgICAgICAkZnBzaWduYWwgPSBQTFVHSU5fRVhJVFNJR05BTF9OT05FOw0KDQogICAgICAgICAgICByZXR1cm4gJGZwcmV0dXJuOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgJHVybCA9IHVybGRlY29kZSgkdXJsKTsNCiAgICAkYWN0aXZlX3JvdXRlcyA9IGFycmF5KCk7DQogICAgJHJld3JpdGVfcm91dGVzID0gYXJyYXkoKTsNCiAgICAkZGVmYXVsdF9yb3V0ZXMgPSBhcnJheSgpOw0KICAgIGZvcmVhY2ggKCR6YnAtPnJvdXRlcyBhcyAka2V5ID0+ICRyb3V0ZSkgew0KICAgICAgICAkcm91dGVbJ29yaWdpbmFsX3VybCddID0gJG9yaWdpbmFsX3VybDsNCiAgICAgICAgJHJvdXRlWyd1cmwnXSA9ICR1cmw7DQogICAgICAgIGlmICgkcm91dGVbJ3R5cGUnXSA9PSAnYWN0aXZlJykgew0KICAgICAgICAgICAgaWYgKEdldFZhbHVlSW5BcnJheSgkcm91dGUsICdzdXNwZW5kZWQnLCBmYWxzZSkgPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICAgICAkYWN0aXZlX3JvdXRlc1tdID0gJHJvdXRlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGlmICgkcm91dGVbJ3R5cGUnXSA9PSAncmV3cml0ZScpIHsNCiAgICAgICAgICAgIGlmICgkemJwLT5vcHRpb25bJ1pDX1NUQVRJQ19NT0RFJ10gPT0gJ1JFV1JJVEUnICYmIEdldFZhbHVlSW5BcnJheSgkcm91dGUsICdzdXNwZW5kZWQnLCBmYWxzZSkgPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICAgICAkcmV3cml0ZV9yb3V0ZXNbXSA9ICRyb3V0ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBpZiAoJHJvdXRlWyd0eXBlJ10gPT0gJ2RlZmF1bHQnKSB7DQogICAgICAgICAgICBpZiAoR2V0VmFsdWVJbkFycmF5KCRyb3V0ZSwgJ3N1c3BlbmRlZCcsIGZhbHNlKSA9PSBmYWxzZSkgew0KICAgICAgICAgICAgICAgIGlmIChHZXRWYWx1ZUluQXJyYXkoJHJvdXRlLCAnb25seV9yZXdyaXRlJywgZmFsc2UpID09IHRydWUpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCR6YnAtPm9wdGlvblsnWkNfU1RBVElDX01PREUnXSA9PSAnUkVXUklURScpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICRkZWZhdWx0X3JvdXRlc1tdID0gJHJvdXRlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSBlbHNlaWYgKEdldFZhbHVlSW5BcnJheSgkcm91dGUsICdvbmx5X2FjdGl2ZScsIGZhbHNlKSA9PSB0cnVlKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICgkemJwLT5vcHRpb25bJ1pDX1NUQVRJQ19NT0RFJ10gPT0gJ0FDVElWRScpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICRkZWZhdWx0X3JvdXRlc1tdID0gJHJvdXRlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgJGRlZmF1bHRfcm91dGVzW10gPSAkcm91dGU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgLy/ljLnphY3liqjmgIHot6/nlLHvvIjmn5Dkupvmg4XlhrXkuIvvvIzlnKjkvKrpnZnlvIDlkK/ml7bljLnphY3kvYbkuI3ovpPlh7rlhoXlrrnvvIzlpoLmnpzmmK/nrKblkIjmnaHku7blsLHlj6/ku6Xot7PovazvvIkNCiAgICBmb3JlYWNoICgkYWN0aXZlX3JvdXRlcyBhcyAka2V5ID0+ICRyb3V0ZSkgew0KICAgICAgICAkcHJlZml4ID0gR2V0VmFsdWVJbkFycmF5KCRyb3V0ZSwgJ3ByZWZpeCcsICcnKTsNCiAgICAgICAgJHByZWZpeCA9IGVtcHR5KCRwcmVmaXgpID8gJycgOiAoJHByZWZpeCAuICcvJyk7DQogICAgICAgIGlmICgoJHVybCA9PSAkcHJlZml4IC4gJycpIHx8ICgkdXJsID09ICRwcmVmaXggLiAnaW5kZXgucGhwJykgfHwgKCgkemJwLT5vcHRpb25bJ1pDX1NUQVRJQ19NT0RFJ10gPT0gJ1JFV1JJVEUnKSAmJiBHZXRWYWx1ZUluQXJyYXkoJF9HRVQsICdyZXdyaXRlJywgbnVsbCkgPT0gdHJ1ZSkpIHsNCiAgICAgICAgICAgICRiID0gVmlld0F1dG9fQ2hlY2tfR2V0X0FuZF9Ob3RfR2V0X0FuZF9NdXN0X0dldChHZXRWYWx1ZUluQXJyYXkoJHJvdXRlLCAnZ2V0JywgYXJyYXkoKSksIEdldFZhbHVlSW5BcnJheSgkcm91dGUsICdub3RfZ2V0JywgYXJyYXkoKSksIEdldFZhbHVlSW5BcnJheSgkcm91dGUsICdtdXN0X2dldCcsIGFycmF5KCkpKTsNCg0KICAgICAgICAgICAgJGIgPSAkYiAmJiBWaWV3QXV0b19DaGVja19SZXF1ZXN0X01ldGhvZChHZXRWYWx1ZUluQXJyYXkoJHJvdXRlLCAncmVxdWVzdF9tZXRob2QnLCAnJykpOw0KICAgICAgICAgICAgLy/lpoLmnpzmnaHku7bnrKblkIjlsLHnu4TlkIjlj4LmlbDmlbDnu4TlubbosIPnlKjlh73mlbANCiAgICAgICAgICAgIGlmICgkYikgew0KICAgICAgICAgICAgICAgICRhcnJheSA9IGFycmF5KCk7DQogICAgICAgICAgICAgICAgVmlld0F1dG9fUHJvY2Vzc19BcmdzX2dldCgkYXJyYXksIEdldFZhbHVlSW5BcnJheSgkcm91dGUsICdhcmdzX2dldCcsIGFycmF5KCkpLCAkcm91dGUpOw0KICAgICAgICAgICAgICAgIFZpZXdBdXRvX1Byb2Nlc3NfQXJnc193aXRoKCRhcnJheSwgR2V0VmFsdWVJbkFycmF5KCRyb3V0ZSwgJ2FyZ3Nfd2l0aCcsIGFycmF5KCkpLCAkcm91dGUpOw0KICAgICAgICAgICAgICAgIFZpZXdBdXRvX1Byb2Nlc3NfQXJnc19NZXJnZSgkcm91dGUpOw0KICAgICAgICAgICAgICAgICRiX3JlZGlyZWN0ID0gVmlld0F1dG9fQ2hlY2tfVG9fUGVybWFsaW5rKCRyb3V0ZSk7DQogICAgICAgICAgICAgICAgaWYgKCRiX3JlZGlyZWN0KSB7DQogICAgICAgICAgICAgICAgICAgICRhcnJheVsnY2FuY2VsZGlzcGxheSddID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgJHJlc3VsdCA9IFZpZXdBdXRvX0NhbGxfQXV0bygkcm91dGUsICRhcnJheSk7DQogICAgICAgICAgICAgICAgaWYgKCRyZXN1bHQgPT09IGZhbHNlKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoJHJlc3VsdCA9PSB0cnVlKSB7DQogICAgICAgICAgICAgICAgICAgIC8v5aaC5p6c5byA5ZCv5Lyq6Z2Z5LiUJGJfcmVkaXJlY3TvvIzpgqPkuYjpgJrov4fljp/liqjmgIHorr/pl67nmoTkvJrot7Povazoh7MkcmVzdWx0DQogICAgICAgICAgICAgICAgICAgIGlmICgkYl9yZWRpcmVjdCAmJiBpc19zdHJpbmcoJHJlc3VsdCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIFJlZGlyZWN0KCRyZXN1bHQpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHJldHVybiAkcmVzdWx0Ow0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgLy/ljLnphY3kvKrpnZnot6/nlLENCiAgICBmb3JlYWNoICgkcmV3cml0ZV9yb3V0ZXMgYXMgJGtleSA9PiAkcm91dGUpIHsNCiAgICAgICAgLy8kbWF0Y2hfd2l0aF9wYWdlIOm7mOiupOWMuemFjTHmrKEgKHRydWUp77yM5pyJcGFnZeWPguaVsOWPr+S7peWMuemFjTLmrKEgW2ZhbHNlPShyZW1vdmUgcGFnZSksIHRydWU9KGtlZXAgcGFnZSldDQogICAgICAgICRwYXJhbWV0ZXJzID0gYXJyYXkoKTsNCiAgICAgICAgJG1hdGNoX3dpdGhfcGFnZSA9IGFycmF5KCk7DQogICAgICAgIFZpZXdBdXRvX0dldF9QYXJhbWV0ZXJzX0FuZF9NYXRjaF93aXRoX3BhZ2UoJHJvdXRlLCAkcGFyYW1ldGVycywgJG1hdGNoX3dpdGhfcGFnZSk7DQoNCiAgICAgICAgZm9yZWFjaCAoJG1hdGNoX3dpdGhfcGFnZSBhcyAkbWF0Y2hfd2l0aF9wYWdlX2tleSA9PiAkbWF0Y2hfd2l0aF9wYWdlX3ZhbHVlKSB7DQogICAgICAgICAgICAkYiA9IFZpZXdBdXRvX0NoZWNrX0dldF9BbmRfTm90X0dldF9BbmRfTXVzdF9HZXQoR2V0VmFsdWVJbkFycmF5KCRyb3V0ZSwgJ2dldCcsIGFycmF5KCkpLCBHZXRWYWx1ZUluQXJyYXkoJHJvdXRlLCAnbm90X2dldCcsIGFycmF5KCkpLCBHZXRWYWx1ZUluQXJyYXkoJHJvdXRlLCAnbXVzdF9nZXQnLCBhcnJheSgpKSk7DQogICAgICAgICAgICAkYiA9ICRiICYmIFZpZXdBdXRvX0NoZWNrX1JlcXVlc3RfTWV0aG9kKEdldFZhbHVlSW5BcnJheSgkcm91dGUsICdyZXF1ZXN0X21ldGhvZCcsICcnKSk7DQogICAgICAgICAgICAvL+WmguaenOebtOaOpeaMh+WumuS6hiRyb3V0ZVsndXJscnVsZV9yZWdleCdd77yM5bCx5LiN6LCD55SoVXJsUnVsZTo6T3V0cHV0VXJsUmVnRXjvvIznm7TmjqVwcmVnX21hdGNoDQogICAgICAgICAgICBpZiAoaXNzZXQoJHJvdXRlWyd1cmxydWxlX3JlZ2V4J10pICYmIHRyaW0oJHJvdXRlWyd1cmxydWxlX3JlZ2V4J10pICE9ICcnKSB7DQogICAgICAgICAgICAgICAgJHIgPSB0cmltKCRyb3V0ZVsndXJscnVsZV9yZWdleCddKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgLy8kciA9IFVybFJ1bGU6Ok91dHB1dFVybFJlZ0V4X1YyKCR6YnAtPkdldFBvc3RUeXBlKDAsICdsaXN0X3VybHJ1bGUnKSwgJ2xpc3QnLCAkbWF0Y2hfd2l0aF9wYWdlX3ZhbHVlKTsNCiAgICAgICAgICAgICAgICAkciA9IFVybFJ1bGU6Ok91dHB1dFVybFJlZ0V4X1JvdXRlKCRyb3V0ZSwgJG1hdGNoX3dpdGhfcGFnZV92YWx1ZSk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICRtID0gYXJyYXkoKTsNCiAgICAgICAgICAgIC8v5aaC5p6c5p2h5Lu256ym5ZCI5bCx57uE5ZCI5Y+C5pWw5pWw57uE5bm26LCD55So5Ye95pWwDQogICAgICAgICAgICAvL3Zhcl9kdW1wKCRtYXRjaF93aXRoX3BhZ2VfdmFsdWUsICRyb3V0ZVsndXJscnVsZSddLCAkciwgJHVybCwgJG0pOy8vZGllOw0KICAgICAgICAgICAgLy92YXJfZHVtcChwcmVnX21hdGNoKCRyLCAkdXJsLCAkbSkpOw0KICAgICAgICAgICAgJGIgPSAkYiAmJiAoKCRyICE9ICcnICYmIHByZWdfbWF0Y2goJHIsICR1cmwsICRtKSA9PSAxKSB8fCAoJHIgPT0gJycgJiYgJHVybCA9PSAnJykgfHwgKCRyID09ICcnICYmICR1cmwgPT0gJ2luZGV4LnBocCcpKTsNCiAgICAgICAgICAgIGlmICgkYikgew0KICAgICAgICAgICAgICAgICRhcnJheSA9ICRtOw0KICAgICAgICAgICAgICAgIFZpZXdBdXRvX1Byb2Nlc3NfQXJncygkYXJyYXksICRwYXJhbWV0ZXJzLCAkbSk7DQogICAgICAgICAgICAgICAgVmlld0F1dG9fUHJvY2Vzc19BcmdzX3dpdGgoJGFycmF5LCBHZXRWYWx1ZUluQXJyYXkoJHJvdXRlLCAnYXJnc193aXRoJywgYXJyYXkoKSksICRyb3V0ZSk7DQogICAgICAgICAgICAgICAgVmlld0F1dG9fUHJvY2Vzc19BcmdzX01lcmdlKCRyb3V0ZSk7DQogICAgICAgICAgICAgICAgLy92YXJfZHVtcCgkbWF0Y2hfd2l0aF9wYWdlX3ZhbHVlLCAkcm91dGVbJ3VybHJ1bGUnXSwgJHIsICR1cmwsICRtLCAkYXJyYXkpOy8vZGllOw0KICAgICAgICAgICAgICAgICRyZXN1bHQgPSBWaWV3QXV0b19DYWxsX0F1dG8oJHJvdXRlLCAkYXJyYXkpOw0KICAgICAgICAgICAgICAgIGlmICgkcmVzdWx0ID09PSBmYWxzZSkgew0KICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgcmV0dXJuICRyZXN1bHQ7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvL+mDveS4jeiDveWMuemFjeaXtu+8jOi/m+WFpeS4gOasoem7mOiupOi3r+eUsQ0KICAgIGZvcmVhY2ggKCRkZWZhdWx0X3JvdXRlcyBhcyAka2V5ID0+ICRyb3V0ZSkgew0KICAgICAgICAkYiA9IFZpZXdBdXRvX0NoZWNrX0dldF9BbmRfTm90X0dldF9BbmRfTXVzdF9HZXQoR2V0VmFsdWVJbkFycmF5KCRyb3V0ZSwgJ2dldCcsIGFycmF5KCkpLCBHZXRWYWx1ZUluQXJyYXkoJHJvdXRlLCAnbm90X2dldCcsIGFycmF5KCkpLCBHZXRWYWx1ZUluQXJyYXkoJHJvdXRlLCAnbXVzdF9nZXQnLCBhcnJheSgpKSk7DQogICAgICAgICRiID0gJGIgJiYgVmlld0F1dG9fQ2hlY2tfUmVxdWVzdF9NZXRob2QoR2V0VmFsdWVJbkFycmF5KCRyb3V0ZSwgJ3JlcXVlc3RfbWV0aG9kJywgJycpKTsNCiAgICAgICAgaWYgKCRiKSB7DQogICAgICAgICAgICAkYXJyYXkgPSBhcnJheSgpOw0KICAgICAgICAgICAgVmlld0F1dG9fUHJvY2Vzc19BcmdzX2dldCgkYXJyYXksIEdldFZhbHVlSW5BcnJheSgkcm91dGUsICdhcmdzX2dldCcsIGFycmF5KCkpLCAkcm91dGUpOw0KICAgICAgICAgICAgVmlld0F1dG9fUHJvY2Vzc19BcmdzX3dpdGgoJGFycmF5LCBHZXRWYWx1ZUluQXJyYXkoJHJvdXRlLCAnYXJnc193aXRoJywgYXJyYXkoKSksICRyb3V0ZSk7DQogICAgICAgICAgICBWaWV3QXV0b19Qcm9jZXNzX0FyZ3NfTWVyZ2UoJHJvdXRlKTsNCiAgICAgICAgICAgICRyZXN1bHQgPSBWaWV3QXV0b19DYWxsX0F1dG8oJHJvdXRlLCAkYXJyYXkpOw0KICAgICAgICAgICAgaWYgKCRyZXN1bHQgPT09IGZhbHNlKSB7DQogICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gJHJlc3VsdDsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1ZpZXdBdXRvX0VuZCddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAkZnByZXR1cm4gPSAkZnBuYW1lKCR1cmwpOw0KICAgICAgICBpZiAoJGZwc2lnbmFsID09IFBMVUdJTl9FWElUU0lHTkFMX1JFVFVSTikgew0KICAgICAgICAgICAgJGZwc2lnbmFsID0gUExVR0lOX0VYSVRTSUdOQUxfTk9ORTsNCg0KICAgICAgICAgICAgcmV0dXJuICRmcHJldHVybjsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgICR6YnAtPlNob3dFcnJvcigyLCBfX0ZJTEVfXywgX19MSU5FX18pOw0KDQogICAgcmV0dXJuIGZhbHNlOw0KfQ0KDQovKioNCiAqIFZpZXdBdXRv55qE6L6F5Yqp5Ye95pWwDQogKi8NCmZ1bmN0aW9uIFZpZXdBdXRvX1Byb2Nlc3NfQXJncygmJGFycmF5LCAkcGFyYW1ldGVycywgJG0pDQp7DQogICAgZm9yZWFjaCAoJHBhcmFtZXRlcnMgYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgaWYgKGlzc2V0KCRtWyhzdHJpbmcpICR2YWx1ZVsnbmFtZSddXSkpIHsNCiAgICAgICAgICAgICRhcnJheVskdmFsdWVbJ25hbWUnXV0gPSAkbVsoc3RyaW5nKSAkdmFsdWVbJ25hbWUnXV07DQogICAgICAgICAgICBpZiAoJHZhbHVlWydhbGlhcyddICE9ICcnKSB7DQogICAgICAgICAgICAgICAgJGFycmF5WyR2YWx1ZVsnYWxpYXMnXV0gPSAkbVsoc3RyaW5nKSAkdmFsdWVbJ25hbWUnXV07DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQogICAgcmV0dXJuICRhcnJheTsNCn0NCg0KLyoqDQogKiBWaWV3QXV0b+eahOi+heWKqeWHveaVsA0KICovDQpmdW5jdGlvbiBWaWV3QXV0b19Qcm9jZXNzX0FyZ3NfZ2V0KCYkYXJyYXksICRhcmdzX2dldCwgJHJvdXRlKQ0Kew0KICAgICRnZXQgPSBhcnJheV9tZXJnZShHZXRWYWx1ZUluQXJyYXkoJHJvdXRlLCAnZ2V0JywgYXJyYXkoKSksIEdldFZhbHVlSW5BcnJheSgkcm91dGUsICdtdXN0X2dldCcsIGFycmF5KCkpKTsNCg0KICAgIGlmIChpc3NldCgkYXJnc19nZXQpICYmIGlzX2FycmF5KCRhcmdzX2dldCkpIHsNCiAgICAgICAgZm9yZWFjaCAoJGdldCBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAgICAgJGFyZ3NfZ2V0W10gPSAkdmFsdWU7DQogICAgICAgIH0NCiAgICAgICAgZm9yZWFjaCAoJGFyZ3NfZ2V0IGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICAgICBpZiAoaXNzZXQoJF9HRVRbJHZhbHVlXSkpIHsNCiAgICAgICAgICAgICAgICAkYXJyYXlbJHZhbHVlXSA9ICRfR0VUWyR2YWx1ZV07DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICRhcnJheVskdmFsdWVdID0gbnVsbDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCiAgICByZXR1cm4gJGFycmF5Ow0KfQ0KDQovKioNCiAqIFZpZXdBdXRv55qE6L6F5Yqp5Ye95pWwDQogKi8NCmZ1bmN0aW9uIFZpZXdBdXRvX1Byb2Nlc3NfQXJnc193aXRoKCYkYXJyYXksICRhcmdzX3dpdGgsICRyb3V0ZSkNCnsNCiAgICBpZiAoaXNzZXQoJGFyZ3Nfd2l0aCkgJiYgaXNfYXJyYXkoJGFyZ3Nfd2l0aCkpIHsNCiAgICAgICAgZm9yZWFjaCAoJGFyZ3Nfd2l0aCBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAgICAgaWYgKGlzX2ludGVnZXIoJGtleSkgJiYgaXNfc2NhbGFyKCR2YWx1ZSkpIHsNCiAgICAgICAgICAgICAgICBpZiAoaXNzZXQoJF9HRVRbJHZhbHVlXSkpIHsNCiAgICAgICAgICAgICAgICAgICAgJGFycmF5WyR2YWx1ZV0gPSAkX0dFVFskdmFsdWVdOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoaXNzZXQoJHJvdXRlWyR2YWx1ZV0pKSB7DQogICAgICAgICAgICAgICAgICAgICRhcnJheVskdmFsdWVdID0gJHJvdXRlWyR2YWx1ZV07DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSBlbHNlaWYgKGlzX3N0cmluZygka2V5KSkgew0KICAgICAgICAgICAgICAgICRhcnJheVska2V5XSA9ICR2YWx1ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCiAgICByZXR1cm4gJGFycmF5Ow0KfQ0KDQovKioNCiAqIFZpZXdBdXRv55qE6L6F5Yqp5Ye95pWwDQogKi8NCmZ1bmN0aW9uIFZpZXdBdXRvX1Byb2Nlc3NfQXJnc19NZXJnZSgmJHJvdXRlKQ0Kew0KICAgICRhcnJheSA9IGFycmF5KCk7DQogICAgJGdldCA9IGFycmF5X21lcmdlKEdldFZhbHVlSW5BcnJheSgkcm91dGUsICdnZXQnLCBhcnJheSgpKSwgR2V0VmFsdWVJbkFycmF5KCRyb3V0ZSwgJ211c3RfZ2V0JywgYXJyYXkoKSksIEdldFZhbHVlSW5BcnJheSgkcm91dGUsICdhcmdzX2dldCcsIGFycmF5KCkpKTsNCiAgICBmb3JlYWNoICgkZ2V0IGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgIGlmIChpc3NldCgkX0dFVFskdmFsdWVdKSkgew0KICAgICAgICAgICAgJGFycmF5WyR2YWx1ZV0gPSAkX0dFVFskdmFsdWVdOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJGFycmF5WyR2YWx1ZV0gPSAnJzsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgICR3aXRoID0gR2V0VmFsdWVJbkFycmF5KCRyb3V0ZSwgJ2FyZ3Nfd2l0aCcsIGFycmF5KCkpOw0KICAgIGZvcmVhY2ggKCR3aXRoIGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgIGlmIChpc19pbnRlZ2VyKCRrZXkpICYmIGlzX3NjYWxhcigkdmFsdWUpKSB7DQogICAgICAgICAgICBpZiAoaXNzZXQoJF9HRVRbJHZhbHVlXSkpIHsNCiAgICAgICAgICAgICAgICAkYXJyYXlbJHZhbHVlXSA9ICRfR0VUWyR2YWx1ZV07DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoaXNzZXQoJHJvdXRlWyR2YWx1ZV0pKSB7DQogICAgICAgICAgICAgICAgJGFycmF5WyR2YWx1ZV0gPSAkcm91dGVbJHZhbHVlXTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlaWYgKGlzX3N0cmluZygka2V5KSkgew0KICAgICAgICAgICAgJGFycmF5WyRrZXldID0gJHZhbHVlOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgaWYgKCEoaXNzZXQoJHJvdXRlWydhcmdzJ10pICYmIGlzX2FycmF5KCRyb3V0ZVsnYXJncyddKSkpIHsNCiAgICAgICAgJHJvdXRlWydhcmdzJ10gPSBhcnJheSgpOw0KICAgIH0NCiAgICBmb3JlYWNoICgkYXJyYXkgYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgJHZhbHVlID0gdHJpbSgkdmFsdWUpOw0KICAgICAgICAkcm91dGVbJ2FyZ3MnXVtdID0gYXJyYXkoJ25hbWUnID0+ICRrZXksICd2YWx1ZScgPT4gJHZhbHVlKTsNCiAgICB9DQp9DQoNCi8qKg0KICogVmlld0F1dG/nmoTovoXliqnlh73mlbANCiAqLw0KZnVuY3Rpb24gVmlld0F1dG9fQ2FsbF9BdXRvKCRyb3V0ZSwgJGFycmF5KQ0Kew0KICAgIGlmIChpc3NldCgkcm91dGVbJ3JlZGlyZWN0X3RvJ10pKSB7DQogICAgICAgIFJlZGlyZWN0KCRyb3V0ZVsncmVkaXJlY3RfdG8nXSk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgaWYgKGlzc2V0KCRyb3V0ZVsncmVkaXJlY3QzMDFfdG8nXSkpIHsNCiAgICAgICAgUmVkaXJlY3QzMDEoJHJvdXRlWydyZWRpcmVjdDMwMV90byddKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICAkZnVuY3Rpb24gPSAkcm91dGVbJ2NhbGwnXTsNCiAgICAkYXJyYXlbJ3JvdXRlJ10gPSAkcm91dGU7DQogICAgaWYgKHN0cnBvcygkZnVuY3Rpb24sICc6OicpICE9PSBmYWxzZSkgew0KICAgICAgICAkZnVuYyA9IGV4cGxvZGUoJzo6JywgJGZ1bmN0aW9uKTsNCiAgICAgICAgcmV0dXJuIGNhbGxfdXNlcl9mdW5jKGFycmF5KCRmdW5jWzBdLCAkZnVuY1sxXSksICRhcnJheSk7DQogICAgfSBlbHNlaWYgKHN0cnBvcygkZnVuY3Rpb24sICdAJykgIT09IGZhbHNlKSB7DQogICAgICAgICRmdW5jID0gZXhwbG9kZSgnQCcsICRmdW5jdGlvbik7DQogICAgICAgIGlmICh2ZXJzaW9uX2NvbXBhcmUoUEhQX1ZFUlNJT04sICc3LjAuMCcpID49IDApIHsNCiAgICAgICAgICAgIHJldHVybiBjYWxsX3VzZXJfZnVuYyhhcnJheSgkZnVuY1swXSwgJGZ1bmNbMV0pLCAkYXJyYXkpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJG8gPSBuZXcgJGZ1bmNbMF07DQogICAgICAgICAgICByZXR1cm4gY2FsbF91c2VyX2Z1bmMoYXJyYXkoJG8sICRmdW5jWzFdKSwgJGFycmF5KTsNCiAgICAgICAgfQ0KICAgIH0gZWxzZSB7DQogICAgICAgIHJldHVybiBjYWxsX3VzZXJfZnVuYygkZnVuY3Rpb24sICRhcnJheSk7DQogICAgfQ0KfQ0KDQovKioNCiAqIFZpZXdBdXRv55qE6L6F5Yqp5Ye95pWwDQogKi8NCmZ1bmN0aW9uIFZpZXdBdXRvX0NoZWNrX1RvX1Blcm1hbGluaygkcm91dGUpDQp7DQogICAgZ2xvYmFsICR6YnA7DQogICAgaWYgKEdldFZhbHVlSW5BcnJheSgkcm91dGUsICd0b19wZXJtYWxpbmsnLCBmYWxzZSkgPT0gZmFsc2UpIHsNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCiAgICBpZiAoISgkemJwLT5vcHRpb25bJ1pDX1NUQVRJQ19NT0RFJ10gPT0gJ1JFV1JJVEUnKSkgew0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KICAgIGlmICgoJHpicC0+b3B0aW9uWydaQ19TVEFUSUNfTU9ERSddID09ICdSRVdSSVRFJykgJiYgR2V0VmFsdWVJbkFycmF5KCRfR0VULCAncmV3cml0ZScsIG51bGwpID09IHRydWUpIHsNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCiAgICAvL+ajgOafpeacieS4jeWtmOWcqOeahOWPguaVsOWwsei/lOWbnmZhbHNlDQogICAgJGdldCA9IEdldFZhbHVlSW5BcnJheSgkcm91dGUsICdnZXQnLCBhcnJheSgpKTsNCiAgICBmb3JlYWNoICgkX0dFVCBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICBpZiAoIWVtcHR5KCRnZXQpICYmIGluX2FycmF5KCRrZXksICRnZXQpID09IGZhbHNlKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCiAgICB9DQogICAgLy/mo4Dmn6XnlJ/miJDop4TliJnkuLrnqbrlsLHov5Tlm55mYWxzZQ0KICAgICR1cmxydWxlID0gR2V0VmFsdWVJbkFycmF5KCRyb3V0ZSwgJ3VybHJ1bGUnLCAnJyk7DQogICAgaWYgKGVtcHR5KCR1cmxydWxlKSkgew0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KICAgICRtYXRjaF93aXRoX3BhZ2UgPSBmYWxzZTsNCiAgICBpZiAoYXJyYXlfa2V5X2V4aXN0cygncGFnZScsICRfR0VUKSkgew0KICAgICAgICAkbWF0Y2hfd2l0aF9wYWdlID0gdHJ1ZTsNCiAgICB9DQogICAgJHIgPSBVcmxSdWxlOjpPdXRwdXRVcmxSZWdFeF9Sb3V0ZSgkcm91dGUsICRtYXRjaF93aXRoX3BhZ2UpOw0KICAgIGlmICgkciAhPSAnJykgew0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQogICAgcmV0dXJuIGZhbHNlOw0KfQ0KDQovKioNCiAqIFZpZXdBdXRv55qE6L6F5Yqp5Ye95pWwDQogKi8NCmZ1bmN0aW9uIFZpZXdBdXRvX0dldF9QYXJhbWV0ZXJzX0FuZF9NYXRjaF93aXRoX3BhZ2UoJHJvdXRlLCAmJHBhcmFtZXRlcnMsICYkbWF0Y2hfd2l0aF9wYWdlKQ0Kew0KICAgIGlmIChpc3NldCgkcm91dGVbJ2FyZ3MnXSkgJiYgaXNfYXJyYXkoJHJvdXRlWydhcmdzJ10pKSB7DQogICAgICAgICRwYXJhbWV0ZXJzID0gVXJsUnVsZTo6UHJvY2Vzc1BhcmFtZXRlcnMoJHJvdXRlKTsNCiAgICB9IGVsc2Ugew0KICAgICAgICAkcGFyYW1ldGVycyA9IGFycmF5KCk7DQogICAgfQ0KDQogICAgJG1hdGNoX3dpdGhfcGFnZSA9IGFycmF5KCdyZW1vdmVfcGFnZScgPT4gZmFsc2UpOw0KICAgICRoYXNwYWdlID0gZmFsc2U7DQogICAgZm9yZWFjaCAoJHBhcmFtZXRlcnMgYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgaWYgKCR2YWx1ZVsnbmFtZSddID09ICdwYWdlJykgew0KICAgICAgICAgICAgJGhhc3BhZ2UgPSB0cnVlOw0KICAgICAgICB9DQogICAgfQ0KICAgIGlmICgkaGFzcGFnZSA9PSBmYWxzZSkgew0KICAgICAgICB1bnNldCgkbWF0Y2hfd2l0aF9wYWdlWydyZW1vdmVfcGFnZSddKTsNCiAgICB9DQoNCiAgICAkb25seV9tYXRjaF9wYWdlID0gR2V0VmFsdWVJbkFycmF5KCRyb3V0ZSwgJ29ubHlfbWF0Y2hfcGFnZScsIGZhbHNlKTsNCiAgICBpZiAoJG9ubHlfbWF0Y2hfcGFnZSA9PSB0cnVlKSB7DQogICAgICAgIHVuc2V0KCRtYXRjaF93aXRoX3BhZ2VbJ3JlbW92ZV9wYWdlJ10pOw0KICAgIH0NCiAgICAkbWF0Y2hfd2l0aF9wYWdlWydrZWVwX3BhZ2UnXSA9IHRydWU7DQp9DQoNCi8qKg0KICogVmlld0F1dG/nmoTovoXliqnlh73mlbANCiAqLw0KZnVuY3Rpb24gVmlld0F1dG9fQ2hlY2tfUmVxdWVzdF9NZXRob2QoJHJlcXVlc3RfbWV0aG9kKQ0Kew0KICAgICRiID0gZmFsc2U7DQogICAgaWYgKCFlbXB0eSgkcmVxdWVzdF9tZXRob2QpKSB7DQogICAgICAgICRtID0gJF9TRVJWRVJbJ1JFUVVFU1RfTUVUSE9EJ107DQogICAgICAgIGlmIChpc19hcnJheSgkcmVxdWVzdF9tZXRob2QpKSB7DQogICAgICAgICAgICBmb3JlYWNoICgkcmVxdWVzdF9tZXRob2QgYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgICAgICAgICBpZiAoc3RyY2FzZWNtcCgkdmFsdWUsICRtKSA9PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICRiID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgaWYgKHN0cmNhc2VjbXAoJHJlcXVlc3RfbWV0aG9kLCAkbSkgPT0gMCkgew0KICAgICAgICAgICAgICAgICRiID0gdHJ1ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0gZWxzZSB7DQogICAgICAgICRiID0gdHJ1ZTsNCiAgICB9DQogICAgcmV0dXJuICRiOw0KfQ0KDQovKioNCiAqIFZpZXdBdXRv55qE6L6F5Yqp5Ye95pWwDQogKi8NCmZ1bmN0aW9uIFZpZXdBdXRvX0NoZWNrX0dldF9BbmRfTm90X0dldF9BbmRfTXVzdF9HZXQoJGdldCwgJG5vdGdldCwgJG11c3RnZXQpDQp7DQogICAgJGIgPSBmYWxzZTsNCiAgICAvL+ajgOafpUdFVOWPguaVsOaYr+WQpuWtmOWcqCjlpoLmnpzmnIky5Liq5oiWMuS4quS7peS4iu+8jOW/hemhu+WtmOWcqDHkuKopIE9SICjlpoLmnpzlj6rmnIkx5Liq77yM5YiZ5Y+v5pyJ5Y+v5pegKQ0KICAgIGlmICghZW1wdHkoJGdldCkpIHsNCiAgICAgICAgaWYgKGNvdW50KCRnZXQpID09IDEpIHsNCiAgICAgICAgICAgICRiID0gdHJ1ZTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGZvcmVhY2ggKCRnZXQgYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgICAgICAgICBpZiAoaXNzZXQoJF9HRVRbJHZhbHVlXSkpIHsNCiAgICAgICAgICAgICAgICAgICAgJGIgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9IGVsc2Ugew0KICAgICAgICAkYiA9IHRydWU7DQogICAgfQ0KDQogICAgLy/mo4Dmn6VHRVTlj4LmlbDmmK/lkKbmnInkuI3pnIDopoHnmoTlrZjlnKgo5YWo6YOo5LiN6IO95a2Y5ZyoKSBOT1QNCiAgICBpZiAoIWVtcHR5KCRub3RnZXQpKSB7DQogICAgICAgIGZvcmVhY2ggKCRub3RnZXQgYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgICAgIGlmICgoc3Vic3RyKCR2YWx1ZSwgMCwgMSkgPT0gJy8nICYmIHN1YnN0cl9jb3VudCgkdmFsdWUsICcvJykgPiAxKSB8fCAoc3Vic3RyKCR2YWx1ZSwgMCwgMSkgPT0gJyMnICYmIHN1YnN0cl9jb3VudCgkdmFsdWUsICcjJykgPiAxKSB8fCAoc3Vic3RyKCR2YWx1ZSwgMCwgMSkgPT0gJ34nICYmIHN1YnN0cl9jb3VudCgkdmFsdWUsICd+JykgPiAxKSkgew0KICAgICAgICAgICAgICAgIGZvcmVhY2ggKCRfR0VUIGFzICRrZXkyID0+ICR2YWx1ZTIpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKEBwcmVnX21hdGNoKCR2YWx1ZSwgJGtleTIpID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAkYiA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRiOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBpZiAoaXNzZXQoJF9HRVRbJHZhbHVlXSkpIHsNCiAgICAgICAgICAgICAgICAgICAgJGIgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRiOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCiAgICAvL+ajgOafpUdFVOWPguaVsOaYr+WQpuacieW/hemhu+eahOWtmOWcqCjlhajpg6jlv4XlrZjlnKgpIEFORA0KICAgIGlmICghZW1wdHkoJG11c3RnZXQpKSB7DQogICAgICAgICRjID0gYXJyYXkoKTsNCiAgICAgICAgZm9yZWFjaCAoJG11c3RnZXQgYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgICAgIGlmIChpc3NldCgkX0dFVFskdmFsdWVdKSkgew0KICAgICAgICAgICAgICAgICRjW10gPSB0cnVlOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAkY1tdID0gZmFsc2U7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgaWYgKGluX2FycmF5KGZhbHNlLCAkYywgdHJ1ZSkgPT0gdHJ1ZSkgew0KICAgICAgICAgICAgJGIgPSBmYWxzZTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICByZXR1cm4gJGI7DQp9DQoNCi8qKg0KICogVmlld0F1dG/nmoTovoXliqnlh73mlbANCiAqLw0KZnVuY3Rpb24gVmlld0F1dG9fUHJvY2Vzc19QYWdlYmFyX1JlcGxhY2VfQXJyYXkoJiRwYWdlYmFyLCAkcm91dGUsICRhcmdzKQ0Kew0KICAgIGlmIChlbXB0eSgkcm91dGUpKSB7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICAkYXJncyA9IGlzX2FycmF5KCRhcmdzKSA/ICRhcmdzIDogYXJyYXkoKTsNCiAgICAkYXJyYXkgPSBHZXRWYWx1ZUluQXJyYXkoJGFyZ3MsIDAsIGFycmF5KCkpOw0KICAgICRhcnJheSA9IGlzX2FycmF5KCRhcnJheSkgPyAkYXJyYXkgOiBhcnJheSgpOw0KICAgICRwYXJhbWV0ZXJzID0gVXJsUnVsZTo6UHJvY2Vzc1BhcmFtZXRlcnMoJHJvdXRlKTsNCiAgICAkcmVwbGFjZSA9IGFycmF5KCk7DQoNCiAgICBmb3JlYWNoICgkcGFyYW1ldGVycyBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICBpZiAoaXNzZXQoJGFycmF5WyRrZXldKSkgew0KICAgICAgICAgICAgJHJlcGxhY2VbJHZhbHVlWyduYW1lJ11dID0gJGFycmF5WyRrZXldOw0KICAgICAgICB9DQogICAgfQ0KICAgICRydWxlcyA9ICYkcGFnZWJhci0+VXJsUnVsZS0+UnVsZXM7DQogICAgZm9yZWFjaCAoJHJlcGxhY2UgYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgaWYgKCFpc3NldCgkcnVsZXNbJ3slJyAuICRrZXkgLiAnJX0nXSkpIHsNCiAgICAgICAgICAgICRydWxlc1sneyUnIC4gJGtleSAuICclfSddID0gJHZhbHVlOw0KICAgICAgICB9DQogICAgfQ0KICAgIGZvcmVhY2ggKCRhcnJheSBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICBpZiAoaXNfc3RyaW5nKCRrZXkpICYmIGlzX3NjYWxhcigkdmFsdWUpICYmICFpc3NldCgkcnVsZXNbJ3slJyAuICRrZXkgLiAnJX0nXSkpIHsNCiAgICAgICAgICAgICRydWxlc1sneyUnIC4gJGtleSAuICclfSddID0gJHZhbHVlOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQovLyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KDQovKioNCiAqIFZpZXdJbmRleCzpppbpobXvvIzmkJzntKLpobXvvIxmZWVk6aG155qE5Li75Ye95pWwLg0KICoNCiAqIEBhcGkgRmlsdGVyX1BsdWdpbl9WaWV3SW5kZXhfQmVnaW4NCiAqDQogKiBAdGhyb3dzIEV4Y2VwdGlvbg0KICoNCiAqIEByZXR1cm4gbWl4ZWQNCiAqLw0KZnVuY3Rpb24gVmlld0luZGV4KCkNCnsNCiAgICBnbG9iYWwgJHpicCwgJGFjdGlvbjsNCg0KICAgICR1cmwgPSAkemJwLT5jdXJyZW50dXJsOw0KDQogICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fVmlld0luZGV4X0JlZ2luJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICRmcHJldHVybiA9ICRmcG5hbWUoJHVybCk7DQogICAgICAgIGlmICgkZnBzaWduYWwgPT0gUExVR0lOX0VYSVRTSUdOQUxfUkVUVVJOKSB7DQogICAgICAgICAgICAkZnBzaWduYWwgPSBQTFVHSU5fRVhJVFNJR05BTF9OT05FOw0KDQogICAgICAgICAgICByZXR1cm4gJGZwcmV0dXJuOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgc3dpdGNoICgkYWN0aW9uKSB7DQogICAgICAgIGNhc2UgJ2ZlZWQnOg0KICAgICAgICAgICAgVmlld0ZlZWQoKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICdzZWFyY2gnOg0KICAgICAgICAgICAgVmlld1NlYXJjaCgpOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJ3ZpZXcnOg0KICAgICAgICBjYXNlICcnOg0KICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgVmlld0F1dG8oKTsNCiAgICB9DQoNCiAgICByZXR1cm4gdHJ1ZTsNCn0NCg0KLyoqDQogKiDmmL7npLpSU1MyRmVlZC4NCiAqDQogKiBAYXBpIEZpbHRlcl9QbHVnaW5fVmlld0ZlZWRfQmVnaW4NCiAqLw0KZnVuY3Rpb24gVmlld0ZlZWQoKQ0Kew0KICAgIGdsb2JhbCAkemJwOw0KDQogICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fVmlld0ZlZWRfQmVnaW4nXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgJGZwcmV0dXJuID0gJGZwbmFtZSgpOw0KICAgICAgICBpZiAoJGZwc2lnbmFsID09IFBMVUdJTl9FWElUU0lHTkFMX1JFVFVSTikgew0KICAgICAgICAgICAgJGZwc2lnbmFsID0gUExVR0lOX0VYSVRTSUdOQUxfTk9ORTsNCg0KICAgICAgICAgICAgcmV0dXJuICRmcHJldHVybjsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGlmICghJHpicC0+Q2hlY2tSaWdodHMoJEdMT0JBTFNbJ2FjdGlvbiddKSkgew0KICAgICAgICBIdHRwNDA0KCk7DQogICAgICAgIGRpZTsNCiAgICB9DQoNCiAgICAkcnNzMiA9IG5ldyBSc3MyKCR6YnAtPm5hbWUsICR6YnAtPmhvc3QsICR6YnAtPnN1Ym5hbWUpOw0KDQogICAgJHcgPSBhcnJheShhcnJheSgnPScsICdsb2dfU3RhdHVzJywgMCkpOw0KDQogICAgJHBvc3R5cGUgPSAoaW50KSBHZXRWYXJzKCdwb3N0dHlwZScsICdHRVQnLCAwKTsNCiAgICAkd1tdID0gYXJyYXkoJz0nLCAnbG9nX1R5cGUnLCAkcG9zdHlwZSk7DQoNCiAgICAkYWN0aW9ucyA9ICR6YnAtPkdldFBvc3RUeXBlKCRwb3N0eXBlLCAnYWN0aW9ucycpOw0KDQogICAgaWYgKCEkemJwLT5DaGVja1JpZ2h0cygkYWN0aW9uc1sndmlldyddKSkgew0KICAgICAgICBIdHRwNDA0KCk7DQogICAgICAgIGRpZTsNCiAgICB9DQoNCiAgICBpZiAoR2V0VmFycygnY2F0ZScsICdHRVQnKSAhPSBudWxsKSB7DQogICAgICAgICR3W10gPSBhcnJheSgnPScsICdsb2dfQ2F0ZUlEJywgKGludCkgR2V0VmFycygnY2F0ZScsICdHRVQnKSk7DQogICAgfSBlbHNlaWYgKEdldFZhcnMoJ2F1dGgnLCAnR0VUJykgIT0gbnVsbCkgew0KICAgICAgICAkd1tdID0gYXJyYXkoJz0nLCAnbG9nX0F1dGhvcklEJywgKGludCkgR2V0VmFycygnYXV0aCcsICdHRVQnKSk7DQogICAgfSBlbHNlaWYgKEdldFZhcnMoJ2RhdGUnLCAnR0VUJykgIT0gbnVsbCkgew0KICAgICAgICAkZCA9IHN0cnRvdGltZShHZXRWYXJzKCdkYXRlJywgJ0dFVCcpKTsNCiAgICAgICAgaWYgKHN0cnJwb3MoR2V0VmFycygnZGF0ZScsICdHRVQnKSwgJy0nKSAhPT0gc3RycG9zKEdldFZhcnMoJ2RhdGUnLCAnR0VUJyksICctJykpIHsNCiAgICAgICAgICAgICR3W10gPSBhcnJheSgnQkVUV0VFTicsICdsb2dfUG9zdFRpbWUnLCAkZCwgc3RydG90aW1lKCcrMSBkYXknLCAkZCkpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJHdbXSA9IGFycmF5KCdCRVRXRUVOJywgJ2xvZ19Qb3N0VGltZScsICRkLCBzdHJ0b3RpbWUoJysxIG1vbnRoJywgJGQpKTsNCiAgICAgICAgfQ0KICAgIH0gZWxzZWlmIChHZXRWYXJzKCd0YWdzJywgJ0dFVCcpICE9IG51bGwpIHsNCiAgICAgICAgJHdbXSA9IGFycmF5KCdMSUtFJywgJ2xvZ19UYWcnLCAnJXsnIC4gKGludCkgR2V0VmFycygndGFncycsICdHRVQnKSAuICd9JScpOw0KICAgIH0NCg0KICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1ZpZXdGZWVkX0NvcmUnXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgJGZwbmFtZSgkdyk7DQogICAgfQ0KDQogICAgJGFydGljbGVzID0gJHpicC0+R2V0UG9zdExpc3QoDQogICAgICAgICcqJywNCiAgICAgICAgJHcsDQogICAgICAgIGFycmF5KCdsb2dfUG9zdFRpbWUnID0+ICdERVNDJyksDQogICAgICAgICR6YnAtPm9wdGlvblsnWkNfUlNTMl9DT1VOVCddLA0KICAgICAgICBudWxsDQogICAgKTsNCg0KICAgIGZvcmVhY2ggKCRhcnRpY2xlcyBhcyAkYXJ0aWNsZSkgew0KICAgICAgICAkcnNzMi0+YWRkSXRlbSgkYXJ0aWNsZS0+VGl0bGUsICRhcnRpY2xlLT5VcmwsICgkemJwLT5vcHRpb25bJ1pDX1JTU19FWFBPUlRfV0hPTEUnXSA9PSB0cnVlID8gJGFydGljbGUtPkNvbnRlbnQgOiAkYXJ0aWNsZS0+SW50cm8pLCAkYXJ0aWNsZS0+UG9zdFRpbWUpOw0KICAgIH0NCg0KICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1ZpZXdGZWVkX0VuZCddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAkZnByZXR1cm4gPSAkZnBuYW1lKCRyc3MyKTsNCiAgICAgICAgaWYgKCRmcHNpZ25hbCA9PSBQTFVHSU5fRVhJVFNJR05BTF9SRVRVUk4pIHsNCiAgICAgICAgICAgICRmcHNpZ25hbCA9IFBMVUdJTl9FWElUU0lHTkFMX05PTkU7DQoNCiAgICAgICAgICAgIHJldHVybiAkZnByZXR1cm47DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBoZWFkZXIoIkNvbnRlbnQtdHlwZTp0ZXh0L3htbDsgQ2hhcnNldD11dGYtOCIpOw0KDQogICAgZWNobyAkcnNzMi0+c2F2ZVhNTCgpOw0KDQogICAgcmV0dXJuIHRydWU7DQp9DQoNCi8qKg0KICog5bGV56S65pCc57Si57uT5p6cLg0KICoNCiAqIEBhcGkgRmlsdGVyX1BsdWdpbl9WaWV3U2VhcmNoX0JlZ2luDQogKiBAYXBpIEZpbHRlcl9QbHVnaW5fVmlld1Bvc3RfVGVtcGxhdGUNCiAqDQogKiBAdGhyb3dzIEV4Y2VwdGlvbg0KICoNCiAqIEByZXR1cm4gbWl4ZWQNCiAqLw0KZnVuY3Rpb24gVmlld1NlYXJjaCgpDQp7DQogICAgZ2xvYmFsICR6YnA7DQoNCiAgICAkZnBhcmdzID0gY2FsbF91c2VyX2Z1bmMoJ2Z1bmNfZ2V0X2FyZ3MnKTsNCiAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9WaWV3U2VhcmNoX0JlZ2luJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICRmcHJldHVybiA9IGNhbGxfdXNlcl9mdW5jX2FycmF5KCRmcG5hbWUsICRmcGFyZ3MpOw0KICAgICAgICBpZiAoJGZwc2lnbmFsID09IFBMVUdJTl9FWElUU0lHTkFMX1JFVFVSTikgew0KICAgICAgICAgICAgJGZwc2lnbmFsID0gUExVR0lOX0VYSVRTSUdOQUxfTk9ORTsNCiAgICAgICAgICAgIHJldHVybiAkZnByZXR1cm47DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAkcSA9IEdldFZhcnMoJ3EnLCAnR0VUJyk7DQogICAgJHBhZ2UgPSBHZXRWYXJzKCdwYWdlJywgJ0dFVCcpOw0KDQogICAgJGFyZ3MgPSBHZXRWYWx1ZUluQXJyYXkoJGZwYXJncywgMCwgbnVsbCk7DQogICAgaWYgKGlzX2FycmF5KCRhcmdzKSkgew0KICAgICAgICAkY2FuY2VsZGlzcGxheSA9IEdldFZhbHVlSW5BcnJheSgkYXJncywgJ2NhbmNlbGRpc3BsYXknLCBmYWxzZSk7DQogICAgICAgICRwb3N0dHlwZSA9IEdldFZhbHVlSW5BcnJheSgkYXJncywgJ3Bvc3R0eXBlJywgMCk7DQogICAgICAgICRxID0gR2V0VmFsdWVJbkFycmF5KCRhcmdzLCAncScsICcnKTsNCiAgICAgICAgaWYgKGlzc2V0KCRhcmdzWydzZWFyY2gnXSkgJiYgJGFyZ3NbJ3NlYXJjaCddKSB7DQogICAgICAgICAgICAkcSA9ICRhcmdzWydzZWFyY2gnXTsNCiAgICAgICAgfQ0KICAgICAgICAkcGFnZSA9IEdldFZhbHVlSW5BcnJheSgkYXJncywgJ3BhZ2UnLCAwKTsNCiAgICAgICAgJHJvdXRlID0gR2V0VmFsdWVJbkFycmF5KCRhcmdzLCAncm91dGUnLCBhcnJheSgpKTsNCiAgICAgICAgJGRpc2FibGVib3QgPSBHZXRWYWx1ZUluQXJyYXkoJGFyZ3MsICdkaXNhYmxlYm90JywgdHJ1ZSk7DQogICAgfSBlbHNlIHsNCiAgICAgICAgJGNhbmNlbGRpc3BsYXkgPSBmYWxzZTsNCiAgICAgICAgJHBvc3R0eXBlID0gMDsNCiAgICAgICAgJHJvdXRlID0gYXJyYXkoJ3VybHJ1bGUnID0+ICR6YnAtPm9wdGlvblsnWkNfU0VBUkNIX1JFR0VYJ10pOw0KICAgICAgICAkZGlzYWJsZWJvdCA9IHRydWU7DQogICAgfQ0KDQogICAgJHEgPSB0cmltKGh0bWxzcGVjaWFsY2hhcnMoJHEpKTsNCiAgICAkcGFnZSA9IChpbnQpICRwYWdlID09IDAgPyAxIDogKGludCkgJHBhZ2U7DQoNCiAgICAkdyA9IGFycmF5KCk7DQogICAgJHdbXSA9IGFycmF5KCc9JywgJ2xvZ19UeXBlJywgJHBvc3R0eXBlKTsNCg0KICAgIC8v5rKh5pyJ5p2D6ZmQ5bCx5pCc57Si56m655qEDQogICAgJGFjdGlvbnMgPSAkemJwLT5HZXRQb3N0VHlwZSgkcG9zdHR5cGUsICdhY3Rpb25zJyk7DQogICAgaWYgKCEkemJwLT5DaGVja1JpZ2h0cygkYWN0aW9uc1snc2VhcmNoJ10pKSB7DQogICAgICAgICR3W10gPSBhcnJheSgnPScsICdsb2dfSUQnLCAwKTsNCiAgICB9DQoNCiAgICAkYXJ0aWNsZSA9IG5ldyBQb3N0KCk7DQogICAgJGFydGljbGUtPklEID0gMDsNCiAgICAkYXJ0aWNsZS0+VGl0bGUgPSAkemJwLT5sYW5ncy0+bXNnLT5zZWFyY2ggLiAnJm5ic3A7JnF1b3Q7PHNwYW4+JyAuICRxIC4gJzwvc3Bhbj4mcXVvdDsnOw0KICAgICRhcnRpY2xlLT5Jc0xvY2sgPSB0cnVlOw0KICAgICRhcnRpY2xlLT5UeXBlID0gJHBvc3R0eXBlOw0KDQogICAgaWYgKCRxKSB7DQogICAgICAgICR3W10gPSBhcnJheSgnc2VhcmNoJywgJ2xvZ19Db250ZW50JywgJ2xvZ19JbnRybycsICdsb2dfVGl0bGUnLCAkcSk7DQogICAgfSBlbHNlIHsNCiAgICAgICAgJHdbXSA9IGFycmF5KCc9JywgJ2xvZ19JRCcsIDApOw0KICAgIH0NCg0KICAgIGlmICghKCR6YnAtPkNoZWNrUmlnaHRzKCRhcnRpY2xlLT5UeXBlQWN0aW9uc1snYWxsJ10pKSkgew0KICAgICAgICAkd1tdID0gYXJyYXkoJz0nLCAnbG9nX1N0YXR1cycsIDApOw0KICAgIH0NCiAgICAkb3JkZXIgPSBhcnJheSgnbG9nX1Bvc3RUaW1lJyA9PiAnREVTQycpOw0KDQogICAgJHBhZ2ViYXIgPSBuZXcgUGFnZWJhcigkcm91dGUpOw0KICAgICRwYWdlYmFyLT5QYWdlQ291bnQgPSAkemJwLT5zZWFyY2hjb3VudDsNCiAgICAkcGFnZWJhci0+UGFnZU5vdyA9ICRwYWdlOw0KICAgICRwYWdlYmFyLT5QYWdlQmFyQ291bnQgPSAkemJwLT5wYWdlYmFyY291bnQ7DQogICAgJHBhZ2ViYXItPlVybFJ1bGUtPlJ1bGVzWyd7JXBhZ2UlfSddID0gJHBhZ2U7DQogICAgJHBhZ2ViYXItPlVybFJ1bGUtPlJ1bGVzWyd7JXElfSddID0gcmF3dXJsZW5jb2RlKCRxKTsNCiAgICAkcGFnZWJhci0+VXJsUnVsZS0+UnVsZXNbJ3slc2VhcmNoJX0nXSA9IHJhd3VybGVuY29kZSgkcSk7DQogICAgVmlld0F1dG9fUHJvY2Vzc19QYWdlYmFyX1JlcGxhY2VfQXJyYXkoJHBhZ2ViYXIsICRyb3V0ZSwgJGZwYXJncyk7DQoNCiAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9WaWV3U2VhcmNoX0NvcmUnXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgJGZwbmFtZSgkcSwgJHBhZ2UsICR3LCAkcGFnZWJhciwgJG9yZGVyKTsNCiAgICB9DQoNCiAgICAkYXJyYXkgPSAkemJwLT5HZXRQb3N0TGlzdCgNCiAgICAgICAgJycsDQogICAgICAgICR3LA0KICAgICAgICAkb3JkZXIsDQogICAgICAgIGFycmF5KCgkcGFnZWJhci0+UGFnZU5vdyAtIDEpICogJHBhZ2ViYXItPlBhZ2VDb3VudCwgJHBhZ2ViYXItPlBhZ2VDb3VudCksDQogICAgICAgIGFycmF5KCdwYWdlYmFyJyA9PiAkcGFnZWJhcikNCiAgICApOw0KDQogICAgJHJlc3VsdHMgPSBhcnJheSgpOw0KDQogICAgZm9yZWFjaCAoJGFycmF5IGFzICRhKSB7DQogICAgICAgICRyID0gbmV3IFBvc3QoKTsNCiAgICAgICAgJHItPkxvYWRJbmZvQnlEYXRhQXJyYXkoJGEtPkdldERhdGEoKSk7DQogICAgICAgICRhcnRpY2xlLT5Db250ZW50IC49ICc8cD48YSBocmVmPSInIC4gJGEtPlVybCAuICciPicgLiBzdHJfaXJlcGxhY2UoJHEsICc8c3Ryb25nPicgLiAkcSAuICc8L3N0cm9uZz4nLCAkYS0+VGl0bGUpIC4gJzwvYT48YnIvPic7DQogICAgICAgICRzID0gc3RyaXBfdGFncygkYS0+SW50cm8pIC4gJyAnIC4gc3RyaXBfdGFncygkYS0+Q29udGVudCk7DQogICAgICAgICRpID0gWmJwX1N0cmlwb3MoJHMsICRxLCAwKTsNCiAgICAgICAgaWYgKCRpICE9PSBmYWxzZSkgew0KICAgICAgICAgICAgaWYgKCRpID4gNTApIHsNCiAgICAgICAgICAgICAgICAkdCA9IFN1YlN0clVURjhfU3RhcnQoJHMsICgkaSAtIDUwKSwgMTAwKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgJHQgPSBTdWJTdHJVVEY4X1N0YXJ0KCRzLCAwLCAxMDApOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgJGFydGljbGUtPkNvbnRlbnQgLj0gc3RyX2lyZXBsYWNlKCRxLCAnPHN0cm9uZz4nIC4gJHEgLiAnPC9zdHJvbmc+JywgJHQpIC4gJzxici8+JzsNCiAgICAgICAgICAgICRyLT5JbnRybyA9IHN0cl9pcmVwbGFjZSgkcSwgJzxzdHJvbmc+JyAuICRxIC4gJzwvc3Ryb25nPicsICR0KTsNCiAgICAgICAgICAgICRyLT5Db250ZW50ID0gJGEtPkNvbnRlbnQ7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkcyA9IHN0cmlwX3RhZ3MoJGEtPlRpdGxlKTsNCiAgICAgICAgICAgICRpID0gWmJwX1N0cnBvcygkcywgJHEsIDApOw0KICAgICAgICAgICAgaWYgKCRpID4gNTApIHsNCiAgICAgICAgICAgICAgICAkdCA9IFN1YlN0clVURjhfU3RhcnQoJHMsICgkaSAtIDUwKSwgMTAwKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgJHQgPSBTdWJTdHJVVEY4X1N0YXJ0KCRzLCAwLCAxMDApOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgJGFydGljbGUtPkNvbnRlbnQgLj0gc3RyX3JlcGxhY2UoJHEsICc8c3Ryb25nPicgLiAkcSAuICc8L3N0cm9uZz4nLCAkdCkgLiAnPGJyLz4nOw0KICAgICAgICAgICAgJHItPkludHJvID0gc3RyX3JlcGxhY2UoJHEsICc8c3Ryb25nPicgLiAkcSAuICc8L3N0cm9uZz4nLCAkdCk7DQogICAgICAgICAgICAkci0+Q29udGVudCA9ICRhLT5Db250ZW50Ow0KICAgICAgICB9DQogICAgICAgICRyLT5UaXRsZSA9IHN0cl9yZXBsYWNlKCRxLCAnPHN0cm9uZz4nIC4gJHEgLiAnPC9zdHJvbmc+JywgJHItPlRpdGxlKTsNCiAgICAgICAgJGFydGljbGUtPkNvbnRlbnQgLj0gJzxhIGhyZWY9IicgLiAkYS0+VXJsIC4gJyI+JyAuICRhLT5VcmwgLiAnPC9hPjxici8+PC9wPic7DQogICAgICAgICRyZXN1bHRzW10gPSAkcjsNCiAgICB9DQoNCiAgICBpZiAoJGRpc2FibGVib3QpIHsNCiAgICAgICAgJHpicC0+aGVhZGVyIC49ICcgICAgPG1ldGEgbmFtZT0icm9ib3RzIiBjb250ZW50PSJub2luZGV4LG5vZm9sbG93LG5vYXJjaGl2ZSIgLz4nIC4gIlxyXG4iOw0KICAgIH0NCiAgICAkemJwLT50ZW1wbGF0ZS0+U2V0VGFncygndGl0bGUnLCBzdHJfcmVwbGFjZShhcnJheSgnPHNwYW4+JywgJzwvc3Bhbj4nKSwgJycsICRhcnRpY2xlLT5UaXRsZSkpOw0KICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCdhcnRpY2xlJywgJGFydGljbGUpOw0KICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCdhcnRpY2xlcycsICRyZXN1bHRzKTsNCiAgICAkemJwLT50ZW1wbGF0ZS0+U2V0VGFncygnc2VhcmNoJywgJHEpOw0KICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCdwYWdlJywgJHBhZ2UpOw0KICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCdwYWdlYmFyJywgJHBhZ2ViYXIpOw0KICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCdjb21tZW50cycsIGFycmF5KCkpOw0KICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCdpc3NlYXJjaCcsIHRydWUpOw0KICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCdwb3N0dHlwZScsICRwb3N0dHlwZSk7DQogICAgaWYgKGlzX29iamVjdCgkcGFnZWJhcikgJiYgaXNzZXQoJHBhZ2ViYXItPmJ1dHRvbnNbJHBhZ2ViYXItPlBhZ2VOb3ddKSkgew0KICAgICAgICAkemJwLT50ZW1wbGF0ZS0+U2V0VGFncygndXJsJywgJHBhZ2ViYXItPmJ1dHRvbnNbJHBhZ2ViYXItPlBhZ2VOb3ddKTsNCiAgICB9IGVsc2Ugew0KICAgICAgICAkemJwLT50ZW1wbGF0ZS0+U2V0VGFncygndXJsJywgJHpicC0+aG9zdCk7DQogICAgfQ0KICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCdhcmdzJywgJGZwYXJncyk7DQogICAgJHpicC0+dGVtcGxhdGUtPlNldFRhZ3MoJ3JvdXRlJywgJHJvdXRlKTsNCg0KICAgIC8vMS4257uf5LiA5pS55Li6c2VhcmNo5qih5byPDQogICAgJHpicC0+dGVtcGxhdGUtPlNldFRhZ3MoJ3R5cGUnLCAnc2VhcmNoJyk7DQogICAgLy8xLjfmjIflrprmkJzntKLmqKHmnb/kuLrkvJjlhYjkuLpzZWFyY2jmiJbmmK9pbmRleA0KICAgIGlmICgkemJwLT50ZW1wbGF0ZS0+SGFzVGVtcGxhdGUoJHpicC0+R2V0UG9zdFR5cGUoJHBvc3R0eXBlLCAnc2VhcmNoX3RlbXBsYXRlJykpKSB7DQogICAgICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUZW1wbGF0ZSgkemJwLT5HZXRQb3N0VHlwZSgkcG9zdHR5cGUsICdzZWFyY2hfdGVtcGxhdGUnKSk7DQogICAgfSBlbHNlIHsNCiAgICAgICAgJHpicC0+dGVtcGxhdGUtPlNldFRlbXBsYXRlKCR6YnAtPkdldFBvc3RUeXBlKCRwb3N0dHlwZSwgJ2xpc3RfdGVtcGxhdGUnKSk7DQogICAgfQ0KDQogICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fVmlld1NlYXJjaF9UZW1wbGF0ZSddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAkZnByZXR1cm4gPSAkZnBuYW1lKCR6YnAtPnRlbXBsYXRlKTsNCiAgICAgICAgaWYgKCRmcHNpZ25hbCA9PSBQTFVHSU5fRVhJVFNJR05BTF9SRVRVUk4pIHsNCiAgICAgICAgICAgICRmcHNpZ25hbCA9IFBMVUdJTl9FWElUU0lHTkFMX05PTkU7DQoNCiAgICAgICAgICAgIHJldHVybiAkZnByZXR1cm47DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBpZiAoJGNhbmNlbGRpc3BsYXkgPT0gZmFsc2UpIHsNCiAgICAgICAgJHpicC0+dGVtcGxhdGUtPkRpc3BsYXkoKTsNCiAgICB9IGVsc2Ugew0KICAgICAgICByZXR1cm4gJHpicC0+dGVtcGxhdGUtPkdldFRhZ3MoJ3VybCcpOw0KICAgIH0NCg0KICAgIHJldHVybiB0cnVlOw0KfQ0KDQovLyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KDQovKioNCiAqIOaYvuekuuWIl+ihqOmhtemdoi4NCiAqDQogKiBAcGFyYW0gaW50ICAgJHBhZ2UgKDEuN+i1t+WBmuS4uuS4u+imgWFycmF55Z6L5Y+C5pWw77yM5ZCO57ut55qE6YO95L2c5bqf5LqGKQ0KICogQHBhcmFtIG1peGVkICRjYXRlICAgICAgICAgICDliIbnsbsgaWTmiJZhbGlhcw0KICogQHBhcmFtIG1peGVkICRhdXRoICAgICAgICAgICDkvZzogIUgaWTmiJZhbGlhcw0KICogQHBhcmFtIG1peGVkICRkYXRlICAgICAgICAgICDml6XmnJ8NCiAqIEBwYXJhbSBtaXhlZCAkdGFncyAgICAgICAgICAgdGFncyBpZOaIlmFsaWFzDQogKiBAcGFyYW0gbWl4ZWQgJGlzcmV3cml0ZSAgICAgIOaYr+WQpuWQr+eUqHVybHJld3JpdGUNCiAqIEBwYXJhbSBhcnJheSAkb2JqZWN0ICAgICAgICAg5oqKMS436YeM5paw5aKeYXJyYXnlnovlj4LmlbDkvKDnu5nml6fniYjmnKznmoTmjqXlj6MNCiAqDQogKiBAYXBpIEZpbHRlcl9QbHVnaW5fVmlld0xpc3RfQmVnaW4NCiAqIEBhcGkgRmlsdGVyX1BsdWdpbl9WaWV3TGlzdF9CZWdpbl9WMg0KICogQGFwaSBGaWx0ZXJfUGx1Z2luX1ZpZXdMaXN0X1RlbXBsYXRlDQogKg0KICogQHRocm93cyBFeGNlcHRpb24NCiAqDQogKiBAcmV0dXJuIHN0cmluZw0KICovDQpmdW5jdGlvbiBWaWV3TGlzdCgkcGFnZSA9IG51bGwsICRjYXRlID0gbnVsbCwgJGF1dGggPSBudWxsLCAkZGF0ZSA9IG51bGwsICR0YWdzID0gbnVsbCwgJGlzcmV3cml0ZSA9IGZhbHNlLCAkb2JqZWN0ID0gYXJyYXkoKSkNCnsNCiAgICBnbG9iYWwgJHpicDsNCg0KICAgICRmcGFyZ3MgPSBjYWxsX3VzZXJfZnVuYygnZnVuY19nZXRfYXJncycpOw0KICAgICRmcGFyZ3NfY291bnQgPSBjb3VudCgkZnBhcmdzKTsNCg0KICAgIC8v5paw54mI5pys55qE5Ye95pWwVjIgKHYy54mI5pys5Lyg5YWl55qE56ys5LiA5Liq5Y+C5pWw5pivYXJyYXnkuJTlj6rkvKDkuIDkuKphcnJheSkNCiAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9WaWV3TGlzdF9CZWdpbl9WMiddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAkZnByZXR1cm4gPSAkZnBuYW1lKCRwYWdlKTsNCiAgICAgICAgaWYgKCRmcHNpZ25hbCA9PSBQTFVHSU5fRVhJVFNJR05BTF9SRVRVUk4pIHsNCiAgICAgICAgICAgICRmcHNpZ25hbCA9IFBMVUdJTl9FWElUU0lHTkFMX05PTkU7DQoNCiAgICAgICAgICAgIHJldHVybiAkZnByZXR1cm47DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvL+S/ruato+mmluS4quWPguaVsOS9v+eUqGFycmF56ICM5LiN5Lyg5YWl5ZCO57ut5Y+C5pWw55qE5oOF5Ya1DQogICAgaWYgKGlzX2FycmF5KCRwYWdlKSAmJiBpc3NldCgkcGFnZVsncm91dGUnXSkgJiYgJGZwYXJnc19jb3VudCA9PSAxKSB7DQogICAgICAgICRvYmplY3QgPSAkcGFnZTsNCiAgICAgICAgJGlzcmV3cml0ZSA9IHRydWU7DQogICAgICAgICRjYXRlID0gR2V0VmFsdWVJbkFycmF5KCRwYWdlLCAnY2F0ZScsIG51bGwpOw0KICAgICAgICAkYXV0aCA9IEdldFZhbHVlSW5BcnJheSgkcGFnZSwgJ2F1dGgnLCBudWxsKTsNCiAgICAgICAgJGRhdGUgPSBHZXRWYWx1ZUluQXJyYXkoJHBhZ2UsICdkYXRlJywgbnVsbCk7DQogICAgICAgICR0YWdzID0gR2V0VmFsdWVJbkFycmF5KCRwYWdlLCAndGFncycsIG51bGwpOw0KICAgICAgICAkcG9zdHR5cGUgPSBHZXRWYWx1ZUluQXJyYXkoJHBhZ2UsICdwb3N0dHlwZScsIDApOw0KICAgICAgICAkY2FuY2VsZGlzcGxheSA9IEdldFZhbHVlSW5BcnJheSgkcGFnZSwgJ2NhbmNlbGRpc3BsYXknLCBmYWxzZSk7DQogICAgICAgICRyb3V0ZSA9IEdldFZhbHVlSW5BcnJheSgkcGFnZSwgJ3JvdXRlJywgYXJyYXkoKSk7DQogICAgICAgICRwYWdlID0gR2V0VmFsdWVJbkFycmF5KCRwYWdlLCAncGFnZScsIG51bGwpOw0KICAgIH0gZWxzZSB7DQogICAgICAgICRvYmplY3QgPSBhcnJheSgpOw0KICAgICAgICAkcG9zdHR5cGUgPSAwOw0KICAgICAgICAkY2FuY2VsZGlzcGxheSA9IGZhbHNlOw0KICAgICAgICAkcm91dGUgPSBhcnJheSgpOw0KICAgIH0NCg0KICAgIC8v6ICB54mI5pys55qE5YW85a655o6l5Y+jDQogICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fVmlld0xpc3RfQmVnaW4nXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgJGZwYXJnc192MSA9IGFycmF5KCRwYWdlLCAkY2F0ZSwgJGF1dGgsICRkYXRlLCAkdGFncywgJGlzcmV3cml0ZSwgJG9iamVjdCk7DQogICAgICAgICRmcHJldHVybiA9IGNhbGxfdXNlcl9mdW5jX2FycmF5KCRmcG5hbWUsICRmcGFyZ3NfdjEpOw0KICAgICAgICBpZiAoJGZwc2lnbmFsID09IFBMVUdJTl9FWElUU0lHTkFMX1JFVFVSTikgew0KICAgICAgICAgICAgJGZwc2lnbmFsID0gUExVR0lOX0VYSVRTSUdOQUxfTk9ORTsNCg0KICAgICAgICAgICAgcmV0dXJuICRmcHJldHVybjsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgICR0eXBlID0gJ2luZGV4JzsNCiAgICBpZiAoJGNhdGUgIT09IG51bGwpIHsNCiAgICAgICAgJHR5cGUgPSAnY2F0ZWdvcnknOw0KICAgIH0NCg0KICAgIGlmICgkYXV0aCAhPT0gbnVsbCkgew0KICAgICAgICAkdHlwZSA9ICdhdXRob3InOw0KICAgIH0NCg0KICAgIGlmICgkZGF0ZSAhPT0gbnVsbCkgew0KICAgICAgICAkdHlwZSA9ICdkYXRlJzsNCiAgICB9DQoNCiAgICBpZiAoJHRhZ3MgIT09IG51bGwpIHsNCiAgICAgICAgJHR5cGUgPSAndGFnJzsNCiAgICB9DQoNCiAgICAkY2F0ZWdvcnkgPSBudWxsOw0KICAgICRhdXRob3IgPSBudWxsOw0KICAgICRkYXRldGltZSA9IG51bGw7DQogICAgJHRhZyA9IG51bGw7DQoNCiAgICAkdyA9IGFycmF5KCk7DQogICAgJHdbXSA9IGFycmF5KCc9JywgJ2xvZ19UeXBlJywgJHBvc3R0eXBlKTsNCiAgICAkd1tdID0gYXJyYXkoJz0nLCAnbG9nX1N0YXR1cycsIDApOw0KICAgICR3W10gPSBhcnJheSgnPScsICdsb2dfSXNUb3AnLCAwKTsNCg0KICAgICRwYWdlID0gKGludCkgJHBhZ2UgPT0gMCA/IDEgOiAoaW50KSAkcGFnZTsNCg0KICAgICRhcnRpY2xlcyA9IGFycmF5KCk7DQogICAgJGFydGljbGVzX3RvcCA9IGFycmF5KCk7DQoNCiAgICBzd2l0Y2ggKCR0eXBlKSB7DQogICAgICAgICAgICAvLyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCiAgICAgICAgY2FzZSAnaW5kZXgnOg0KICAgICAgICAgICAgaWYgKCFlbXB0eSgkcm91dGUpKSB7DQogICAgICAgICAgICAgICAgJHBhZ2ViYXIgPSBuZXcgUGFnZWJhcigkcm91dGUpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAkcGFnZWJhciA9IG5ldyBQYWdlYmFyKCR6YnAtPm9wdGlvblsnWkNfSU5ERVhfUkVHRVgnXSwgdHJ1ZSwgdHJ1ZSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoMCA9PSAkcG9zdHR5cGUpIHsNCiAgICAgICAgICAgICAgICAkcGFnZWJhci0+Q291bnQgPSAkemJwLT5jYWNoZS0+bm9ybWFsX2FydGljbGVfbnVtczsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgICR0ZW1wbGF0ZSA9ICR6YnAtPkdldFBvc3RUeXBlKCRwb3N0dHlwZSwgJ2xpc3RfdGVtcGxhdGUnKTsNCiAgICAgICAgICAgIGlmICgkcGFnZSA9PSAxKSB7DQogICAgICAgICAgICAgICAgJHpicC0+dGl0bGUgPSAkemJwLT5zdWJuYW1lOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAkemJwLT50aXRsZSA9IHN0cl9yZXBsYWNlKCclbnVtJScsICRwYWdlLCAkemJwLT5sYW5nWydtc2cnXVsnbnVtYmVyX3BhZ2UnXSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIC8vIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KICAgICAgICBjYXNlICdjYXRlZ29yeSc6DQogICAgICAgICAgICBpZiAoIWVtcHR5KCRyb3V0ZSkpIHsNCiAgICAgICAgICAgICAgICAkcGFnZWJhciA9IG5ldyBQYWdlYmFyKCRyb3V0ZSk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICRwYWdlYmFyID0gbmV3IFBhZ2ViYXIoJHpicC0+b3B0aW9uWydaQ19DQVRFR09SWV9SRUdFWCddKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgICRjYXRlZ29yeSA9IG5ldyBDYXRlZ29yeSgpOw0KDQogICAgICAgICAgICBpZiAoIWlzX2FycmF5KCRjYXRlKSkgew0KICAgICAgICAgICAgICAgICRjYXRlSWQgPSAkY2F0ZTsNCiAgICAgICAgICAgICAgICAkY2F0ZSA9IGFycmF5KCk7DQogICAgICAgICAgICAgICAgaWYgKHN0cnBvcygkemJwLT5vcHRpb25bJ1pDX0NBVEVHT1JZX1JFR0VYJ10sICd7JWlkJX0nKSAhPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICAgICAgICAgJGNhdGVbJ2lkJ10gPSAkY2F0ZUlkOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoc3RycG9zKCR6YnAtPm9wdGlvblsnWkNfQ0FURUdPUllfUkVHRVgnXSwgJ3slYWxpYXMlfScpICE9PSBmYWxzZSkgew0KICAgICAgICAgICAgICAgICAgICAkY2F0ZVsnYWxpYXMnXSA9ICRjYXRlSWQ7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKGlzc2V0KCRjYXRlWydpZCddKSkgew0KICAgICAgICAgICAgICAgICRjYXRlZ29yeSA9ICR6YnAtPkdldENhdGVnb3J5QnlJRCgkY2F0ZVsnaWQnXSk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICRjYXRlZ29yeSA9ICR6YnAtPkdldENhdGVnb3J5QnlBbGlhcygkY2F0ZVsnYWxpYXMnXSwgJHBvc3R0eXBlKTsNCiAgICAgICAgICAgICAgICBpZiAoJGNhdGVnb3J5LT5JRCA9PSAnJykgew0KICAgICAgICAgICAgICAgICAgICAkY2F0ZWdvcnkgPSAkemJwLT5HZXRDYXRlZ29yeUJ5QWxpYXNPck5hbWUoJGNhdGVbJ2FsaWFzJ10sICRwb3N0dHlwZSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoJGNhdGVnb3J5LT5JRCA9PSAnJykgew0KICAgICAgICAgICAgICAgIGlmICghZW1wdHkoJHJvdXRlKSB8fCAkaXNyZXdyaXRlID09IHRydWUpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICR6YnAtPlNob3dFcnJvcigyLCBfX0ZJTEVfXywgX19MSU5FX18pOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKCRwYWdlID09IDEpIHsNCiAgICAgICAgICAgICAgICAkemJwLT50aXRsZSA9ICRjYXRlZ29yeS0+TmFtZTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgJHpicC0+dGl0bGUgPSAkY2F0ZWdvcnktPk5hbWUgLiAnICcgLiBzdHJfcmVwbGFjZSgnJW51bSUnLCAkcGFnZSwgJHpicC0+bGFuZ1snbXNnJ11bJ251bWJlcl9wYWdlJ10pOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgJHRlbXBsYXRlID0gJGNhdGVnb3J5LT5UZW1wbGF0ZTsNCg0KICAgICAgICAgICAgaWYgKCEkemJwLT5vcHRpb25bJ1pDX0RJU1BMQVlfU1VCQ0FURUdPUllTJ10pIHsNCiAgICAgICAgICAgICAgICAkd1tdID0gYXJyYXkoJz0nLCAnbG9nX0NhdGVJRCcsICRjYXRlZ29yeS0+SUQpOw0KICAgICAgICAgICAgICAgICRwYWdlYmFyLT5Db3VudCA9ICRjYXRlZ29yeS0+Q291bnQ7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICRhcnlzdWJjYXRlID0gYXJyYXkoKTsNCiAgICAgICAgICAgICAgICAkYXJ5c3ViY2F0ZVtdID0gYXJyYXkoJ2xvZ19DYXRlSUQnLCAkY2F0ZWdvcnktPklEKTsNCiAgICAgICAgICAgICAgICBpZiAoaXNzZXQoJHpicC0+Y2F0ZWdvcmllc1skY2F0ZWdvcnktPklEXSkpIHsNCiAgICAgICAgICAgICAgICAgICAgZm9yZWFjaCAoJHpicC0+Y2F0ZWdvcmllc1skY2F0ZWdvcnktPklEXS0+Q2hpbGRyZW5DYXRlZ29yaWVzIGFzICRzdWJjYXRlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAkYXJ5c3ViY2F0ZVtdID0gYXJyYXkoJ2xvZ19DYXRlSUQnLCAkc3ViY2F0ZS0+SUQpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICR3W10gPSBhcnJheSgnYXJyYXknLCAkYXJ5c3ViY2F0ZSk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICRwYWdlYmFyLT5VcmxSdWxlLT5SdWxlc1sneyVpZCV9J10gPSAkY2F0ZWdvcnktPklEOw0KICAgICAgICAgICAgJHBhZ2ViYXItPlVybFJ1bGUtPlJ1bGVzWyd7JWFsaWFzJX0nXSA9ICRjYXRlZ29yeS0+QWxpYXMgPT0gJycgPyByYXd1cmxlbmNvZGUoJGNhdGVnb3J5LT5OYW1lKSA6ICRjYXRlZ29yeS0+QWxpYXM7DQogICAgICAgICAgICAkcGFnZWJhci0+VXJsUnVsZS0+UnVsZXNPYmplY3QgPSAkY2F0ZWdvcnk7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIC8vIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KICAgICAgICBjYXNlICdhdXRob3InOg0KICAgICAgICAgICAgaWYgKCFlbXB0eSgkcm91dGUpKSB7DQogICAgICAgICAgICAgICAgJHBhZ2ViYXIgPSBuZXcgUGFnZWJhcigkcm91dGUpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAkcGFnZWJhciA9IG5ldyBQYWdlYmFyKCR6YnAtPm9wdGlvblsnWkNfQVVUSE9SX1JFR0VYJ10pOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgJGF1dGhvciA9IG5ldyBNZW1iZXIoKTsNCg0KICAgICAgICAgICAgaWYgKCFpc19hcnJheSgkYXV0aCkpIHsNCiAgICAgICAgICAgICAgICAkYXV0aElkID0gJGF1dGg7DQogICAgICAgICAgICAgICAgJGF1dGggPSBhcnJheSgpOw0KICAgICAgICAgICAgICAgIGlmIChzdHJwb3MoJHpicC0+b3B0aW9uWydaQ19BVVRIT1JfUkVHRVgnXSwgJ3slaWQlfScpICE9PSBmYWxzZSkgew0KICAgICAgICAgICAgICAgICAgICAkYXV0aFsnaWQnXSA9ICRhdXRoSWQ7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmIChzdHJwb3MoJHpicC0+b3B0aW9uWydaQ19BVVRIT1JfUkVHRVgnXSwgJ3slYWxpYXMlfScpICE9PSBmYWxzZSkgew0KICAgICAgICAgICAgICAgICAgICAkYXV0aFsnYWxpYXMnXSA9ICRhdXRoSWQ7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKGlzc2V0KCRhdXRoWydpZCddKSkgew0KICAgICAgICAgICAgICAgIC8qIEB2YXIgTWVtYmVyICRhdXRob3IgKi8NCiAgICAgICAgICAgICAgICAkYXV0aG9yID0gJHpicC0+R2V0TWVtYmVyQnlJRCgkYXV0aFsnaWQnXSk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIC8qIEB2YXIgTWVtYmVyICRhdXRob3IgKi8NCiAgICAgICAgICAgICAgICAkYXV0aG9yID0gJHpicC0+R2V0TWVtYmVyQnlOYW1lT3JBbGlhcygkYXV0aFsnYWxpYXMnXSk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICgkYXV0aG9yLT5JRCA9PSAnJykgew0KICAgICAgICAgICAgICAgIGlmICghZW1wdHkoJHJvdXRlKSB8fCAkaXNyZXdyaXRlID09IHRydWUpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICR6YnAtPlNob3dFcnJvcigyLCBfX0ZJTEVfXywgX19MSU5FX18pOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKCRwYWdlID09IDEpIHsNCiAgICAgICAgICAgICAgICAkemJwLT50aXRsZSA9ICRhdXRob3ItPlN0YXRpY05hbWU7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICR6YnAtPnRpdGxlID0gJGF1dGhvci0+U3RhdGljTmFtZSAuICcgJyAuIHN0cl9yZXBsYWNlKCclbnVtJScsICRwYWdlLCAkemJwLT5sYW5nWydtc2cnXVsnbnVtYmVyX3BhZ2UnXSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICAkdGVtcGxhdGUgPSAkYXV0aG9yLT5UZW1wbGF0ZTsNCiAgICAgICAgICAgICR3W10gPSBhcnJheSgnPScsICdsb2dfQXV0aG9ySUQnLCAkYXV0aG9yLT5JRCk7DQogICAgICAgICAgICAvLyRwYWdlYmFyLT5Db3VudCA9ICRhdXRob3ItPkFydGljbGVzOw0KICAgICAgICAgICAgJHBhZ2ViYXItPlVybFJ1bGUtPlJ1bGVzWyd7JWlkJX0nXSA9ICRhdXRob3ItPklEOw0KICAgICAgICAgICAgJHBhZ2ViYXItPlVybFJ1bGUtPlJ1bGVzWyd7JWFsaWFzJX0nXSA9ICRhdXRob3ItPkFsaWFzID09ICcnID8gcmF3dXJsZW5jb2RlKCRhdXRob3ItPk5hbWUpIDogJGF1dGhvci0+QWxpYXM7DQogICAgICAgICAgICAkcGFnZWJhci0+VXJsUnVsZS0+UnVsZXNPYmplY3QgPSAkYXV0aG9yOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAvLyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCiAgICAgICAgY2FzZSAnZGF0ZSc6DQogICAgICAgICAgICBpZiAoIWVtcHR5KCRyb3V0ZSkpIHsNCiAgICAgICAgICAgICAgICAkcGFnZWJhciA9IG5ldyBQYWdlYmFyKCRyb3V0ZSk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICRwYWdlYmFyID0gbmV3IFBhZ2ViYXIoJHpicC0+b3B0aW9uWydaQ19EQVRFX1JFR0VYJ10pOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIWlzX2FycmF5KCRkYXRlKSkgew0KICAgICAgICAgICAgICAgICRkYXRldGltZSA9ICRkYXRlOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAkZGF0ZXRpbWUgPSAkZGF0ZVsnZGF0ZSddOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAkaGFzRGF5ID0gZmFsc2U7DQoNCiAgICAgICAgICAgICRkYXRldGltZV90eHQgPSAkZGF0ZXRpbWU7DQogICAgICAgICAgICAkZGF0ZXRpbWUgPSBudWxsOw0KICAgICAgICAgICAgaWYgKGZ1bmN0aW9uX2V4aXN0cygnZGF0ZV9jcmVhdGVfZnJvbV9mb3JtYXQnKSkgew0KICAgICAgICAgICAgICAgICRvYmpkYXRlID0gZGF0ZV9jcmVhdGVfZnJvbV9mb3JtYXQoJHpicC0+b3B0aW9uWydaQ19EQVRFVElNRV9XSVRIREFZX1JVTEUnXSwgJGRhdGV0aW1lX3R4dCk7DQogICAgICAgICAgICAgICAgaWYgKCRvYmpkYXRlICE9PSBmYWxzZSkgew0KICAgICAgICAgICAgICAgICAgICAkZGF0ZXRpbWUgPSBzdHJ0b3RpbWUoJG9iamRhdGUtPmZvcm1hdCgnWS1uLWonKSk7DQogICAgICAgICAgICAgICAgICAgICRoYXNEYXkgPSB0cnVlOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICRvYmpkYXRlID0gZGF0ZV9jcmVhdGVfZnJvbV9mb3JtYXQoJHpicC0+b3B0aW9uWydaQ19EQVRFVElNRV9SVUxFJ10sICRkYXRldGltZV90eHQpOw0KICAgICAgICAgICAgICAgICAgICBpZiAoJG9iamRhdGUgIT09IGZhbHNlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAkZGF0ZXRpbWUgPSBzdHJ0b3RpbWUoJG9iamRhdGUtPmZvcm1hdCgnWS1uJykpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAkZGF0ZXRpbWVfdHh0ID0gc3RyX3JlcGxhY2UoJHpicC0+b3B0aW9uWydaQ19EQVRFVElNRV9TRVBBUkFUT1InXSwgJy0nLCAkZGF0ZXRpbWVfdHh0KTsNCiAgICAgICAgICAgICAgICBpZiAoc3Vic3RyX2NvdW50KCRkYXRldGltZV90eHQsICctJykgPiAxKSB7DQogICAgICAgICAgICAgICAgICAgICRoYXNEYXkgPSB0cnVlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoc3RydG90aW1lKCRkYXRldGltZV90eHQpICE9PSBmYWxzZSkgew0KICAgICAgICAgICAgICAgICAgICAkZGF0ZXRpbWUgPSBzdHJ0b3RpbWUoJGRhdGV0aW1lX3R4dCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKCFpc19pbnQoJGRhdGV0aW1lKSkgew0KICAgICAgICAgICAgICAgIGlmICghZW1wdHkoJHJvdXRlKSB8fCAkaXNyZXdyaXRlID09IHRydWUpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICR6YnAtPlNob3dFcnJvcigyLCBfX0ZJTEVfXywgX19MSU5FX18pOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoJGhhc0RheSkgew0KICAgICAgICAgICAgICAgICRkYXRldGl0bGUgPSBzdHJfcmVwbGFjZShhcnJheSgnJXklJywgJyVtJScsICclZCUnKSwgYXJyYXkoZGF0ZSgnWScsICRkYXRldGltZSksIGRhdGUoJ24nLCAkZGF0ZXRpbWUpLCBkYXRlKCdqJywgJGRhdGV0aW1lKSksICR6YnAtPmxhbmdbJ21zZyddWyd5ZWFyX21vbnRoX2RheSddKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgJGRhdGV0aXRsZSA9IHN0cl9yZXBsYWNlKGFycmF5KCcleSUnLCAnJW0lJyksIGFycmF5KGRhdGUoJ1knLCAkZGF0ZXRpbWUpLCBkYXRlKCduJywgJGRhdGV0aW1lKSksICR6YnAtPmxhbmdbJ21zZyddWyd5ZWFyX21vbnRoJ10pOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoJHBhZ2UgPT0gMSkgew0KICAgICAgICAgICAgICAgICR6YnAtPnRpdGxlID0gJGRhdGV0aXRsZTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgJHpicC0+dGl0bGUgPSAkZGF0ZXRpdGxlIC4gJyAnIC4gc3RyX3JlcGxhY2UoJyVudW0lJywgJHBhZ2UsICR6YnAtPmxhbmdbJ21zZyddWydudW1iZXJfcGFnZSddKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgJHpicC0+bW9kdWxlc2J5ZmlsZW5hbWVbJ2NhbGVuZGFyJ10tPkNvbnRlbnQgPSBNb2R1bGVCdWlsZGVyOjpDYWxlbmRhcihkYXRlKCdZJywgJGRhdGV0aW1lKSAuICctJyAuIGRhdGUoJ24nLCAkZGF0ZXRpbWUpKTsNCg0KICAgICAgICAgICAgJHRlbXBsYXRlID0gJHpicC0+R2V0UG9zdFR5cGUoJHBvc3R0eXBlLCAnZGF0ZV90ZW1wbGF0ZScpOw0KDQogICAgICAgICAgICBpZiAoJGhhc0RheSkgew0KICAgICAgICAgICAgICAgICR3W10gPSBhcnJheSgnQkVUV0VFTicsICdsb2dfUG9zdFRpbWUnLCAkZGF0ZXRpbWUsIHN0cnRvdGltZSgnKzEgZGF5JywgJGRhdGV0aW1lKSk7DQogICAgICAgICAgICAgICAgJHBhZ2ViYXItPlVybFJ1bGUtPlJ1bGVzWyd7JWRhdGUlfSddID0gZGF0ZSgkemJwLT5vcHRpb25bJ1pDX0RBVEVUSU1FX1dJVEhEQVlfUlVMRSddLCAkZGF0ZXRpbWUpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAkd1tdID0gYXJyYXkoJ0JFVFdFRU4nLCAnbG9nX1Bvc3RUaW1lJywgJGRhdGV0aW1lLCBzdHJ0b3RpbWUoJysxIG1vbnRoJywgJGRhdGV0aW1lKSk7DQogICAgICAgICAgICAgICAgJHBhZ2ViYXItPlVybFJ1bGUtPlJ1bGVzWyd7JWRhdGUlfSddID0gZGF0ZSgkemJwLT5vcHRpb25bJ1pDX0RBVEVUSU1FX1JVTEUnXSwgJGRhdGV0aW1lKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgJHBhZ2ViYXItPlVybFJ1bGUtPlJ1bGVzT2JqZWN0ID0gbmV3IFpicERhdGUoJGRhdGV0aW1lKTsNCiAgICAgICAgICAgICRkYXRldGltZSA9IE1ldGFzOjpDb252ZXJ0QXJyYXkoZ2V0ZGF0ZSgkZGF0ZXRpbWUpKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgLy8jIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQogICAgICAgIGNhc2UgJ3RhZyc6DQogICAgICAgICAgICBpZiAoIWVtcHR5KCRyb3V0ZSkpIHsNCiAgICAgICAgICAgICAgICAkcGFnZWJhciA9IG5ldyBQYWdlYmFyKCRyb3V0ZSk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICRwYWdlYmFyID0gbmV3IFBhZ2ViYXIoJHpicC0+b3B0aW9uWydaQ19UQUdTX1JFR0VYJ10pOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgJHRhZyA9IG5ldyBUYWcoKTsNCg0KICAgICAgICAgICAgaWYgKCFpc19hcnJheSgkdGFncykpIHsNCiAgICAgICAgICAgICAgICAkdGFnSWQgPSAkdGFnczsNCiAgICAgICAgICAgICAgICAkdGFncyA9IGFycmF5KCk7DQogICAgICAgICAgICAgICAgaWYgKHN0cnBvcygkemJwLT5vcHRpb25bJ1pDX1RBR1NfUkVHRVgnXSwgJ3slaWQlfScpICE9PSBmYWxzZSkgew0KICAgICAgICAgICAgICAgICAgICAkdGFnc1snaWQnXSA9ICR0YWdJZDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKHN0cnBvcygkemJwLT5vcHRpb25bJ1pDX1RBR1NfUkVHRVgnXSwgJ3slYWxpYXMlfScpICE9PSBmYWxzZSkgew0KICAgICAgICAgICAgICAgICAgICAkdGFnc1snYWxpYXMnXSA9ICR0YWdJZDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoaXNzZXQoJHRhZ3NbJ2lkJ10pKSB7DQogICAgICAgICAgICAgICAgJHRhZyA9ICR6YnAtPkdldFRhZ0J5SUQoJHRhZ3NbJ2lkJ10pOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAkdGFnID0gJHpicC0+R2V0VGFnQnlBbGlhc09yTmFtZSgkdGFnc1snYWxpYXMnXSwgJHBvc3R0eXBlKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKCR0YWctPklEID09IDApIHsNCiAgICAgICAgICAgICAgICBpZiAoIWVtcHR5KCRyb3V0ZSkgfHwgJGlzcmV3cml0ZSA9PSB0cnVlKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAkemJwLT5TaG93RXJyb3IoMiwgX19GSUxFX18sIF9fTElORV9fKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKCRwYWdlID09IDEpIHsNCiAgICAgICAgICAgICAgICAkemJwLT50aXRsZSA9ICR0YWctPk5hbWU7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICR6YnAtPnRpdGxlID0gJHRhZy0+TmFtZSAuICcgJyAuIHN0cl9yZXBsYWNlKCclbnVtJScsICRwYWdlLCAkemJwLT5sYW5nWydtc2cnXVsnbnVtYmVyX3BhZ2UnXSk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICR0ZW1wbGF0ZSA9ICR0YWctPlRlbXBsYXRlOw0KICAgICAgICAgICAgJHdbXSA9IGFycmF5KCdMSUtFJywgJ2xvZ19UYWcnLCAnJXsnIC4gJHRhZy0+SUQgLiAnfSUnKTsNCiAgICAgICAgICAgICRwYWdlYmFyLT5VcmxSdWxlLT5SdWxlc1sneyVpZCV9J10gPSAkdGFnLT5JRDsNCiAgICAgICAgICAgICRwYWdlYmFyLT5VcmxSdWxlLT5SdWxlc1sneyVhbGlhcyV9J10gPSAkdGFnLT5BbGlhcyA9PSAnJyA/IHJhd3VybGVuY29kZSgkdGFnLT5OYW1lKSA6ICR0YWctPkFsaWFzOw0KICAgICAgICAgICAgJHBhZ2ViYXItPlVybFJ1bGUtPlJ1bGVzT2JqZWN0ID0gJHRhZzsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbignVW5rbm93biB0eXBlJyk7DQogICAgfQ0KDQogICAgJHBhZ2ViYXItPlBhZ2VDb3VudCA9ICR6YnAtPmRpc3BsYXljb3VudDsNCiAgICAkcGFnZWJhci0+UGFnZU5vdyA9ICRwYWdlOw0KICAgICRwYWdlYmFyLT5QYWdlQmFyQ291bnQgPSAkemJwLT5wYWdlYmFyY291bnQ7DQogICAgJHBhZ2ViYXItPlVybFJ1bGUtPlJ1bGVzWyd7JXBhZ2UlfSddID0gJHBhZ2U7DQoNCiAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9WaWV3TGlzdF9Db3JlJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICRmcG5hbWUoJHR5cGUsICRwYWdlLCAkY2F0ZWdvcnksICRhdXRob3IsICRkYXRldGltZSwgJHRhZywgJHcsICRwYWdlYmFyLCAkdGVtcGxhdGUpOw0KICAgIH0NCg0KICAgIGlmICgkemJwLT5vcHRpb25bJ1pDX0xJU1RPTlRPUF9UVVJOT0ZGJ10gPT0gZmFsc2UpIHsNCiAgICAgICAgJGFydGljbGVzX3RvcF9ub3RvcmRlciA9ICR6YnAtPkdldFRvcFBvc3QoJHBvc3R0eXBlKTsNCiAgICAgICAgZm9yZWFjaCAoJGFydGljbGVzX3RvcF9ub3RvcmRlciBhcyAkYXJ0aWNsZXNfdG9wX25vdG9yZGVyX3Bvc3QpIHsNCiAgICAgICAgICAgIGlmICgkYXJ0aWNsZXNfdG9wX25vdG9yZGVyX3Bvc3QtPlRvcFR5cGUgPT0gJ2dsb2JhbCcpIHsNCiAgICAgICAgICAgICAgICAkYXJ0aWNsZXNfdG9wW10gPSAkYXJ0aWNsZXNfdG9wX25vdG9yZGVyX3Bvc3Q7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgaWYgKCR0eXBlID09ICdpbmRleCcgJiYgJHBhZ2UgPT0gMSkgew0KICAgICAgICAgICAgZm9yZWFjaCAoJGFydGljbGVzX3RvcF9ub3RvcmRlciBhcyAkYXJ0aWNsZXNfdG9wX25vdG9yZGVyX3Bvc3QpIHsNCiAgICAgICAgICAgICAgICBpZiAoJGFydGljbGVzX3RvcF9ub3RvcmRlcl9wb3N0LT5Ub3BUeXBlID09ICdpbmRleCcpIHsNCiAgICAgICAgICAgICAgICAgICAgJGFydGljbGVzX3RvcFtdID0gJGFydGljbGVzX3RvcF9ub3RvcmRlcl9wb3N0Ow0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBpZiAoJHR5cGUgPT0gJ2NhdGVnb3J5JyAmJiAkcGFnZSA9PSAxKSB7DQogICAgICAgICAgICBmb3JlYWNoICgkYXJ0aWNsZXNfdG9wX25vdG9yZGVyIGFzICRhcnRpY2xlc190b3Bfbm90b3JkZXJfcG9zdCkgew0KICAgICAgICAgICAgICAgIGlmICgkYXJ0aWNsZXNfdG9wX25vdG9yZGVyX3Bvc3QtPlRvcFR5cGUgPT0gJ2NhdGVnb3J5JyAmJiAkYXJ0aWNsZXNfdG9wX25vdG9yZGVyX3Bvc3QtPkNhdGVJRCA9PSAkY2F0ZWdvcnktPklEKSB7DQogICAgICAgICAgICAgICAgICAgICRhcnRpY2xlc190b3BbXSA9ICRhcnRpY2xlc190b3Bfbm90b3JkZXJfcG9zdDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAkc2VsZWN0ID0gJyc7DQogICAgJG9yZGVyID0gYXJyYXkoJ2xvZ19Qb3N0VGltZScgPT4gJ0RFU0MnKTsNCiAgICAkbGltaXQgPSBhcnJheSgoJHBhZ2ViYXItPlBhZ2VOb3cgLSAxKSAqICRwYWdlYmFyLT5QYWdlQ291bnQsICRwYWdlYmFyLT5QYWdlQ291bnQpOw0KICAgICRvcHRpb24gPSBhcnJheSgncGFnZWJhcicgPT4gJHBhZ2ViYXIpOw0KICAgIFZpZXdBdXRvX1Byb2Nlc3NfUGFnZWJhcl9SZXBsYWNlX0FycmF5KCRwYWdlYmFyLCAkcm91dGUsICRmcGFyZ3MpOw0KDQogICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fTGFyZ2VEYXRhX0FydGljbGUnXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgJGZwcmV0dXJuID0gJGZwbmFtZSgkc2VsZWN0LCAkdywgJG9yZGVyLCAkbGltaXQsICRvcHRpb24sICR0eXBlKTsNCiAgICB9DQoNCiAgICAkYXJ0aWNsZXMgPSAkemJwLT5HZXRQb3N0TGlzdCgNCiAgICAgICAgJHNlbGVjdCwNCiAgICAgICAgJHcsDQogICAgICAgICRvcmRlciwNCiAgICAgICAgJGxpbWl0LA0KICAgICAgICAkb3B0aW9uDQogICAgKTsNCg0KICAgIGlmIChjb3VudCgkYXJ0aWNsZXMpIDw9IDAgJiYgJHBhZ2UgPiAxKSB7DQogICAgICAgICR6YnAtPlNob3dFcnJvcigyLCBfX0ZJTEVfXywgX19MSU5FX18pOw0KICAgIH0NCg0KICAgICRhcnRpY2xlcyA9IGFycmF5X21lcmdlKCRhcnRpY2xlc190b3AsICRhcnRpY2xlcyk7DQoNCiAgICAkdGFnc3RyaW5nID0gbnVsbDsNCiAgICBmb3JlYWNoICgkYXJ0aWNsZXMgYXMgJGtleSA9PiAkYXJ0aWNsZSkgew0KICAgICAgICAkdGFnc3RyaW5nIC49ICRhcnRpY2xlLT5UYWc7DQogICAgfQ0KICAgICR6YnAtPkxvYWRUYWdzQnlJRFN0cmluZygkdGFnc3RyaW5nKTsNCg0KICAgIGZvcmVhY2ggKCRhcnRpY2xlcyBhcyAka2V5ID0+ICYkYXJ0aWNsZSkgew0KICAgICAgICAkY2xhc3NuYW1lID0gJHpicC0+R2V0UG9zdFR5cGUoJHBvc3R0eXBlLCAnY2xhc3NuYW1lJyk7DQogICAgICAgIGlmIChzdHJjYXNlY21wKGdldF9jbGFzcygkYXJ0aWNsZSksICRjbGFzc25hbWUpICE9IDApIHsNCiAgICAgICAgICAgICRuZXdhcnRpY2xlID0gJGFydGljbGUtPkNsb25lZChmYWxzZSwgJGNsYXNzbmFtZSk7DQogICAgICAgICAgICAkYXJ0aWNsZSA9ICRuZXdhcnRpY2xlOw0KICAgICAgICAgICAgJHpicC0+QWRkUG9zdENhY2hlKCRhcnRpY2xlKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgICR6YnAtPkxvYWRNZW1iZXJzSW5MaXN0KCRhcnRpY2xlcyk7DQoNCiAgICAkemJwLT50ZW1wbGF0ZS0+U2V0VGFncygndGl0bGUnLCAkemJwLT50aXRsZSk7DQogICAgJHpicC0+dGVtcGxhdGUtPlNldFRhZ3MoJ2FydGljbGVzJywgJGFydGljbGVzKTsNCiAgICBpZiAoJHBhZ2ViYXItPlBhZ2VBbGwgPT0gMCkgew0KICAgICAgICAkcGFnZWJhciA9IG51bGw7DQogICAgfQ0KDQogICAgJHpicC0+dGVtcGxhdGUtPlNldFRhZ3MoJ3Bvc3R0eXBlJywgJHBvc3R0eXBlKTsNCiAgICAkemJwLT50ZW1wbGF0ZS0+U2V0VGFncygncGFnZWJhcicsICRwYWdlYmFyKTsNCiAgICAkemJwLT50ZW1wbGF0ZS0+U2V0VGFncygndHlwZScsICR0eXBlKTsNCiAgICAkemJwLT50ZW1wbGF0ZS0+U2V0VGFncygncGFnZScsICRwYWdlKTsNCg0KICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCdkYXRlJywgJGRhdGV0aW1lKTsNCiAgICAkemJwLT50ZW1wbGF0ZS0+U2V0VGFncygndGFnJywgJHRhZyk7DQogICAgJHpicC0+dGVtcGxhdGUtPlNldFRhZ3MoJ2F1dGhvcicsICRhdXRob3IpOw0KICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCdjYXRlZ29yeScsICRjYXRlZ29yeSk7DQoNCiAgICBpZiAoaXNfb2JqZWN0KCRwYWdlYmFyKSAmJiBpc3NldCgkcGFnZWJhci0+YnV0dG9uc1skcGFnZWJhci0+UGFnZU5vd10pKSB7DQogICAgICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCd1cmwnLCAkcGFnZWJhci0+YnV0dG9uc1skcGFnZWJhci0+UGFnZU5vd10pOw0KICAgIH0gZWxzZSB7DQogICAgICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCd1cmwnLCAkemJwLT5ob3N0KTsNCiAgICB9DQogICAgJHpicC0+dGVtcGxhdGUtPlNldFRhZ3MoJ2FyZ3MnLCAkZnBhcmdzKTsNCiAgICAkemJwLT50ZW1wbGF0ZS0+U2V0VGFncygncm91dGUnLCAkcm91dGUpOw0KDQogICAgaWYgKCR6YnAtPnRlbXBsYXRlLT5oYXNUZW1wbGF0ZSgkdGVtcGxhdGUpKSB7DQogICAgICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUZW1wbGF0ZSgkdGVtcGxhdGUpOw0KICAgIH0gZWxzZSB7DQogICAgICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUZW1wbGF0ZSgnaW5kZXgnKTsNCiAgICB9DQoNCiAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9WaWV3TGlzdF9UZW1wbGF0ZSddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAkZnByZXR1cm4gPSAkZnBuYW1lKCR6YnAtPnRlbXBsYXRlKTsNCiAgICAgICAgaWYgKCRmcHNpZ25hbCA9PSBQTFVHSU5fRVhJVFNJR05BTF9SRVRVUk4pIHsNCiAgICAgICAgICAgICRmcHNpZ25hbCA9IFBMVUdJTl9FWElUU0lHTkFMX05PTkU7DQoNCiAgICAgICAgICAgIHJldHVybiAkZnByZXR1cm47DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBpZiAoJGNhbmNlbGRpc3BsYXkgPT0gZmFsc2UpIHsNCiAgICAgICAgJHpicC0+dGVtcGxhdGUtPkRpc3BsYXkoKTsNCiAgICB9IGVsc2Ugew0KICAgICAgICByZXR1cm4gJHpicC0+dGVtcGxhdGUtPkdldFRhZ3MoJ3VybCcpOw0KICAgIH0NCg0KICAgIHJldHVybiB0cnVlOw0KfQ0KDQovKioNCiAqIOaYvuekuuaWh+eroC4NCiAqDQogKiBAcGFyYW0gYXJyYXl8aW50fHN0cmluZyAkaWQgICAgICAgICDmlofnq6BJRC8gSUQv5Yir5ZCN5a+56LGhICgxLjfotbflgZrkuLrkuLvopoFhcnJheeWei+WPguaVsO+8jOWQjue7reeahOmDveS9nOW6n+S6hikNCiAqIEBwYXJhbSBzdHJpbmcgICAgICAgICAgICRhbGlhcyAgICAg77yI5aaC5p6c5pyJ55qE6K+d77yJ5paH56ug5Yir5ZCNDQogKiBAcGFyYW0gYm9vbCAgICAgICAgICAgICAkaXNyZXdyaXRlICDmmK/lkKblkK/nlKh1cmxyZXdyaXRlDQogKiBAcGFyYW0gYXJyYXkgICAgICAgICAgICAkb2JqZWN0ICAgICDmiooxLjfph4zmlrDlop5hcnJheeWei+WPguaVsOS8oOe7meaXp+eJiOacrOeahOaOpeWPow0KICoNCiAqIEBhcGkgRmlsdGVyX1BsdWdpbl9WaWV3UG9zdF9CZWdpbg0KICogQGFwaSBGaWx0ZXJfUGx1Z2luX1ZpZXdQb3N0X0JlZ2luX1YyDQogKiBAYXBpIEZpbHRlcl9QbHVnaW5fVmlld1Bvc3RfVGVtcGxhdGUNCiAqDQogKiBAdGhyb3dzIEV4Y2VwdGlvbg0KICoNCiAqIEByZXR1cm4gc3RyaW5nDQogKi8NCmZ1bmN0aW9uIFZpZXdQb3N0KCRpZCA9IG51bGwsICRhbGlhcyA9IG51bGwsICRpc3Jld3JpdGUgPSBmYWxzZSwgJG9iamVjdCA9IGFycmF5KCkpDQp7DQogICAgZ2xvYmFsICR6YnA7DQoNCiAgICAkZnBhcmdzID0gY2FsbF91c2VyX2Z1bmMoJ2Z1bmNfZ2V0X2FyZ3MnKTsNCiAgICAkZnBhcmdzX2NvdW50ID0gY291bnQoJGZwYXJncyk7DQoNCiAgICAvL+aWsOeJiOacrOeahOWHveaVsFYyICh2MueJiOacrOS8oOWFpeeahOesrOS4gOS4quWPguaVsOaYr2FycmF55LiU5Y+q5Lyg5LiA5LiqYXJyYXkpDQogICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fVmlld1Bvc3RfQmVnaW5fVjInXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgJGZwcmV0dXJuID0gJGZwbmFtZSgkaWQpOw0KICAgICAgICBpZiAoJGZwc2lnbmFsID09IFBMVUdJTl9FWElUU0lHTkFMX1JFVFVSTikgew0KICAgICAgICAgICAgJGZwc2lnbmFsID0gUExVR0lOX0VYSVRTSUdOQUxfTk9ORTsNCg0KICAgICAgICAgICAgcmV0dXJuICRmcHJldHVybjsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8v5L+u5q2j6aaW5Liq5Y+C5pWw5L2/55SoYXJyYXnogIzkuI3kvKDlhaXlkI7nu63lj4LmlbDnmoTmg4XlhrUNCiAgICBpZiAoaXNfYXJyYXkoJGlkKSAmJiBpc3NldCgkaWRbJ3JvdXRlJ10pICYmICRmcGFyZ3NfY291bnQgPT0gMSkgew0KICAgICAgICAkb2JqZWN0ID0gJGlkOw0KICAgICAgICAkaXNyZXdyaXRlID0gdHJ1ZTsNCiAgICAgICAgJHBvc3R0eXBlID0gR2V0VmFsdWVJbkFycmF5KCRvYmplY3QsICdwb3N0dHlwZScsIDApOw0KICAgICAgICAkY2FuY2VsZGlzcGxheSA9IEdldFZhbHVlSW5BcnJheSgkb2JqZWN0LCAnY2FuY2VsZGlzcGxheScsIGZhbHNlKTsNCiAgICAgICAgJHJvdXRlID0gR2V0VmFsdWVJbkFycmF5KCRvYmplY3QsICdyb3V0ZScsIGFycmF5KCkpOw0KICAgICAgICAkYWxpYXMgPSBHZXRWYWx1ZUluQXJyYXkoJG9iamVjdCwgJ2FsaWFzJywgbnVsbCk7DQogICAgICAgICRpZCA9IEdldFZhbHVlSW5BcnJheSgkb2JqZWN0LCAnaWQnLCBudWxsKTsNCiAgICAgICAgLy/ku47liKvlkI1wb3N05Lit6K+75Y+W5q2j56Gu55qEJGlk5oiWJGFsaWFzDQogICAgICAgIGlmIChpc3NldCgkcm91dGVbJ2FyZ3MnXSkgJiYgaXNfYXJyYXkoJHJvdXRlWydhcmdzJ10pKSB7DQogICAgICAgICAgICAkcGFyYW1ldGVycyA9IFVybFJ1bGU6OlByb2Nlc3NQYXJhbWV0ZXJzKCRyb3V0ZSk7DQogICAgICAgICAgICBmb3JlYWNoICgkcGFyYW1ldGVycyBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAgICAgICAgIGlmICgkdmFsdWVbJ25hbWUnXSA9PSAnaWQnICYmICR2YWx1ZVsnYWxpYXMnXSAhPSAnJykgew0KICAgICAgICAgICAgICAgICAgICAkaWQgPSBHZXRWYWx1ZUluQXJyYXkoJG9iamVjdCwgJHZhbHVlWydhbGlhcyddLCBudWxsKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKCR2YWx1ZVsnbmFtZSddID09ICdhbGlhcycgJiYgJHZhbHVlWydhbGlhcyddICE9ICcnKSB7DQogICAgICAgICAgICAgICAgICAgICRhbGlhcyA9IEdldFZhbHVlSW5BcnJheSgkb2JqZWN0LCAkdmFsdWVbJ2FsaWFzJ10sIG51bGwpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0gZWxzZSB7DQogICAgICAgICRvYmplY3QgPSBhcnJheSgpOw0KICAgICAgICAkcG9zdHR5cGUgPSAwOw0KICAgICAgICAkY2FuY2VsZGlzcGxheSA9IGZhbHNlOw0KICAgICAgICAkcm91dGUgPSBhcnJheSgpOw0KICAgICAgICBpZiAoaXNfYXJyYXkoJGlkKSkgew0KICAgICAgICAgICAgJG9iamVjdCA9ICRpZDsNCiAgICAgICAgICAgICRpZCA9IGlzc2V0KCRvYmplY3RbJ2lkJ10pID8gJG9iamVjdFsnaWQnXSA6IG51bGw7DQogICAgICAgICAgICAkYWxpYXMgPSBpc3NldCgkb2JqZWN0WydhbGlhcyddKSA/ICRvYmplY3RbJ2FsaWFzJ10gOiBudWxsOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJG9iamVjdCA9IGFycmF5KCdpZCcgPT4gJGlkKTsNCiAgICAgICAgICAgICRvYmplY3RbJ2FsaWFzJ10gPSAkYWxpYXM7DQogICAgICAgICAgICAkb2JqZWN0WzBdID0gZW1wdHkoJGFsaWFzKSA/ICRpZCA6ICRhbGlhczsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8v5YW85a656ICB54mI5pys55qE5o6l5Y+jDQogICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fVmlld1Bvc3RfQmVnaW4nXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgJGZwYXJnc192MSA9IGFycmF5KCRpZCwgJGFsaWFzLCAkaXNyZXdyaXRlLCAkb2JqZWN0KTsNCiAgICAgICAgJGZwcmV0dXJuID0gY2FsbF91c2VyX2Z1bmNfYXJyYXkoJGZwbmFtZSwgJGZwYXJnc192MSk7DQogICAgICAgIGlmICgkZnBzaWduYWwgPT0gUExVR0lOX0VYSVRTSUdOQUxfUkVUVVJOKSB7DQogICAgICAgICAgICAkZnBzaWduYWwgPSBQTFVHSU5fRVhJVFNJR05BTF9OT05FOw0KDQogICAgICAgICAgICByZXR1cm4gJGZwcmV0dXJuOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgJHNlbGVjdCA9ICcnOw0KICAgICR3ID0gYXJyYXkoKTsNCiAgICAkb3JkZXIgPSBudWxsOw0KICAgICRsaW1pdCA9IDE7DQogICAgJG9wdGlvbiA9IG51bGw7DQoNCiAgICAkd1tdID0gYXJyYXkoJz0nLCAnbG9nX1R5cGUnLCAkcG9zdHR5cGUpOw0KDQogICAgaWYgKCRpZCAhPT0gbnVsbCAmJiBpc19udW1lcmljKCRpZCkpIHsNCiAgICAgICAgaWYgKGZ1bmN0aW9uX2V4aXN0cygnY3R5cGVfZGlnaXQnKSAmJiAhY3R5cGVfZGlnaXQoKHN0cmluZykgJGlkKSkgew0KICAgICAgICAgICAgJHpicC0+U2hvd0Vycm9yKDMsIF9fRklMRV9fLCBfX0xJTkVfXyk7DQogICAgICAgIH0NCg0KICAgICAgICAkd1tdID0gYXJyYXkoJz0nLCAnbG9nX0lEJywgJGlkKTsNCiAgICB9IGVsc2VpZiAoJGFsaWFzICE9PSBudWxsKSB7DQogICAgICAgIGlmICgkemJwLT5vcHRpb25bJ1pDX1BPU1RfQUxJQVNfVVNFX0lEX05PVF9USVRMRSddID09IGZhbHNlKSB7DQogICAgICAgICAgICAkd1tdID0gYXJyYXkoJ2FycmF5JywgYXJyYXkoYXJyYXkoJ2xvZ19BbGlhcycsICRhbGlhcyksIGFycmF5KCdsb2dfVGl0bGUnLCAkYWxpYXMpKSk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkd1tdID0gYXJyYXkoJ2FycmF5JywgYXJyYXkoYXJyYXkoJ2xvZ19BbGlhcycsICRhbGlhcyksIGFycmF5KCdsb2dfSUQnLCAkYWxpYXMpKSk7DQogICAgICAgIH0NCiAgICB9IGVsc2Ugew0KICAgICAgICAkemJwLT5TaG93RXJyb3IoMiwgX19GSUxFX18sIF9fTElORV9fKTsNCiAgICAgICAgZXhpdDsNCiAgICB9DQoNCiAgICBpZiAoZW1wdHkoJHpicC0+dXNlci0+SUQpKSB7DQogICAgICAgICR3W10gPSBhcnJheSgnPScsICdsb2dfU3RhdHVzJywgMCk7DQogICAgfQ0KDQogICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fVmlld1Bvc3RfQ29yZSddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAkZnBuYW1lKCRzZWxlY3QsICR3LCAkb3JkZXIsICRsaW1pdCwgJG9wdGlvbik7DQogICAgfQ0KDQogICAgJGFydGljbGVzID0gJHpicC0+R2V0UG9zdExpc3QoJHNlbGVjdCwgJHcsICRvcmRlciwgJGxpbWl0LCAkb3B0aW9uKTsNCiAgICBpZiAoY291bnQoJGFydGljbGVzKSA9PSAwKSB7DQogICAgICAgIGlmICghZW1wdHkoJHJvdXRlKSB8fCAkaXNyZXdyaXRlID09IHRydWUpIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KICAgICAgICAkemJwLT5TaG93RXJyb3IoMiwgX19GSUxFX18sIF9fTElORV9fKTsNCiAgICB9DQoNCiAgICAkYXJ0aWNsZSA9ICRhcnRpY2xlc1swXTsNCg0KICAgIGlmICgkcG9zdHR5cGUgIT0gJGFydGljbGUtPlR5cGUpIHsNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0gZWxzZSB7DQogICAgICAgICRjbGFzc25hbWUgPSAkemJwLT5HZXRQb3N0VHlwZSgkcG9zdHR5cGUsICdjbGFzc25hbWUnKTsNCiAgICAgICAgaWYgKHN0cmNhc2VjbXAoZ2V0X2NsYXNzKCRhcnRpY2xlKSwgJGNsYXNzbmFtZSkgIT0gMCkgew0KICAgICAgICAgICAgJG5ld2FydGljbGUgPSAkYXJ0aWNsZS0+Q2xvbmVkKGZhbHNlLCAkY2xhc3NuYW1lKTsNCiAgICAgICAgICAgICRhcnRpY2xlID0gJG5ld2FydGljbGU7DQogICAgICAgICAgICAkemJwLT5BZGRQb3N0Q2FjaGUoJGFydGljbGUpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgaWYgKCRhcnRpY2xlLT5TdGF0dXMgIT0gMCAmJiAhJHpicC0+Q2hlY2tSaWdodHMoJGFydGljbGUtPlR5cGVBY3Rpb25zWydhbGwnXSkgJiYgKCRhcnRpY2xlLT5BdXRob3JJRCAhPSAkemJwLT51c2VyLT5JRCkpIHsNCiAgICAgICAgJHpicC0+U2hvd0Vycm9yKDIsIF9fRklMRV9fLCBfX0xJTkVfXyk7DQogICAgfQ0KDQogICAgaWYgKCFlbXB0eSgkcm91dGUpIHx8ICRpc3Jld3JpdGUgPT0gdHJ1ZSkgew0KICAgICAgICBpZiAoaXNzZXQoJG9iamVjdFswXSkgJiYgIWlzc2V0KCRvYmplY3RbJ3BhZ2UnXSkpIHsNCiAgICAgICAgICAgIGlmICghKHN0cmlwb3ModXJsZGVjb2RlKCRhcnRpY2xlLT5VcmwpLCAkb2JqZWN0WzBdKSAhPT0gZmFsc2UpKSB7DQogICAgICAgICAgICAgICAgLy8kemJwLT5TaG93RXJyb3IoMiwgX19GSUxFX18sIF9fTElORV9fKTsNCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAkemJwLT5Mb2FkVGFnc0J5SURTdHJpbmcoJGFydGljbGUtPlRhZyk7DQoNCiAgICBpZiAoaXNzZXQoJHpicC0+b3B0aW9uWydaQ19WSUVXTlVNU19UVVJOT0ZGJ10pICYmICR6YnAtPm9wdGlvblsnWkNfVklFV05VTVNfVFVSTk9GRiddID09IGZhbHNlKSB7DQogICAgICAgICRhcnRpY2xlLT5WaWV3TnVtcyArPSAxOw0KICAgICAgICAkc3FsID0gJHpicC0+ZGItPnNxbC0+VXBkYXRlKCR6YnAtPnRhYmxlWydQb3N0J10sIGFycmF5KCdsb2dfVmlld051bXMnID0+ICRhcnRpY2xlLT5WaWV3TnVtcyksIGFycmF5KGFycmF5KCc9JywgJ2xvZ19JRCcsICRhcnRpY2xlLT5JRCkpKTsNCiAgICAgICAgJHpicC0+ZGItPlVwZGF0ZSgkc3FsKTsNCiAgICB9DQoNCiAgICAkcGFnZWJhciA9IG5ldyBQYWdlYmFyKCdqYXZhc2NyaXB0OnpicC5jb21tZW50LmdldChcJycgLiAkYXJ0aWNsZS0+SUQgLiAnXCcsXCd7JXBhZ2UlfVwnKTsnLCBmYWxzZSk7DQogICAgJHBhZ2ViYXItPlBhZ2VDb3VudCA9ICR6YnAtPmNvbW1lbnRkaXNwbGF5Y291bnQ7DQogICAgJHBhZ2ViYXItPlBhZ2VOb3cgPSAxOw0KICAgICRwYWdlYmFyLT5QYWdlQmFyQ291bnQgPSAkemJwLT5wYWdlYmFyY291bnQ7DQogICAgJHBhZ2ViYXItPlVybFJ1bGUtPlJ1bGVzT2JqZWN0ID0gJiRhcnRpY2xlOw0KDQogICAgaWYgKCR6YnAtPm9wdGlvblsnWkNfQ09NTUVOVF9UVVJOT0ZGJ10pIHsNCiAgICAgICAgJGFydGljbGUtPklzTG9jayA9IHRydWU7DQogICAgfQ0KDQogICAgJGNvbW1lbnRzID0gYXJyYXkoKTsNCg0KICAgIGlmICghJGFydGljbGUtPklzTG9jayAmJiAkemJwLT5zb2NpYWxjb21tZW50ID09IG51bGwpIHsNCiAgICAgICAgJGNvbW1lbnRzID0gJHpicC0+R2V0Q29tbWVudExpc3QoDQogICAgICAgICAgICAnKicsDQogICAgICAgICAgICBhcnJheSgNCiAgICAgICAgICAgICAgICBhcnJheSgnPScsICdjb21tX0xvZ0lEJywgJGFydGljbGUtPklEKSwNCiAgICAgICAgICAgICAgICBhcnJheSgnPScsICdjb21tX1Jvb3RJRCcsIDApLA0KICAgICAgICAgICAgICAgIGFycmF5KCc9JywgJ2NvbW1fSXNDaGVja2luZycsIDApLA0KICAgICAgICAgICAgKSwNCiAgICAgICAgICAgIGFycmF5KCdjb21tX0lEJyA9PiAoJHpicC0+b3B0aW9uWydaQ19DT01NRU5UX1JFVkVSU0VfT1JERVInXSA/ICdERVNDJyA6ICdBU0MnKSksDQogICAgICAgICAgICBhcnJheSgoJHBhZ2ViYXItPlBhZ2VOb3cgLSAxKSAqICRwYWdlYmFyLT5QYWdlQ291bnQsICRwYWdlYmFyLT5QYWdlQ291bnQpLA0KICAgICAgICAgICAgYXJyYXkoJ3BhZ2ViYXInID0+ICRwYWdlYmFyKQ0KICAgICAgICApOw0KICAgICAgICAkcm9vdGlkID0gYXJyYXkoKTsNCiAgICAgICAgZm9yZWFjaCAoJGNvbW1lbnRzIGFzICYkY29tbWVudCkgew0KICAgICAgICAgICAgJHJvb3RpZFtdID0gJGNvbW1lbnQtPklEOw0KICAgICAgICB9DQogICAgICAgICRjb21tZW50czIgPSAkemJwLT5HZXRDb21tZW50TGlzdCgNCiAgICAgICAgICAgICcqJywNCiAgICAgICAgICAgIGFycmF5KA0KICAgICAgICAgICAgICAgIGFycmF5KCc9JywgJ2NvbW1fTG9nSUQnLCAkYXJ0aWNsZS0+SUQpLA0KICAgICAgICAgICAgICAgIGFycmF5KCdJTicsICdjb21tX1Jvb3RJRCcsICRyb290aWQpLA0KICAgICAgICAgICAgICAgIGFycmF5KCc9JywgJ2NvbW1fSXNDaGVja2luZycsIDApLA0KICAgICAgICAgICAgKSwNCiAgICAgICAgICAgIGFycmF5KCdjb21tX0lEJyA9PiAoJHpicC0+b3B0aW9uWydaQ19DT01NRU5UX1JFVkVSU0VfT1JERVInXSA/ICdERVNDJyA6ICdBU0MnKSksDQogICAgICAgICAgICBudWxsLA0KICAgICAgICAgICAgbnVsbA0KICAgICAgICApOw0KICAgICAgICAkZmxvb3JpZCA9ICgoJHBhZ2ViYXItPlBhZ2VOb3cgLSAxKSAqICRwYWdlYmFyLT5QYWdlQ291bnQpOw0KICAgICAgICBmb3JlYWNoICgkY29tbWVudHMgYXMgJiRjb21tZW50KSB7DQogICAgICAgICAgICAkZmxvb3JpZCArPSAxOw0KICAgICAgICAgICAgJGNvbW1lbnQtPkZsb29ySUQgPSAkZmxvb3JpZDsNCiAgICAgICAgICAgICRjb21tZW50LT5Db250ZW50ID0gRm9ybWF0U3RyaW5nKCRjb21tZW50LT5Db250ZW50LCAnW2VudGVyXScpOw0KICAgICAgICAgICAgaWYgKCR6YnAtPmF1dG9maWxsX3RlbXBsYXRlX2h0bWx0YWdzICYmIHN0cnBvcygkemJwLT50ZW1wbGF0ZS0+dGVtcGxhdGVzWydjb21tZW50J10sICdpZD0iQWpheENvbW1lbnQnKSA9PT0gZmFsc2UpIHsNCiAgICAgICAgICAgICAgICAkY29tbWVudC0+Q29udGVudCAuPSAnPGxhYmVsIGlkPSJBamF4Q29tbWVudCcgLiAkY29tbWVudC0+SUQgLiAnIj48L2xhYmVsPic7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgZm9yZWFjaCAoJGNvbW1lbnRzMiBhcyAmJGNvbW1lbnQpIHsNCiAgICAgICAgICAgICRjb21tZW50LT5Db250ZW50ID0gRm9ybWF0U3RyaW5nKCRjb21tZW50LT5Db250ZW50LCAnW2VudGVyXScpOw0KICAgICAgICAgICAgaWYgKCR6YnAtPmF1dG9maWxsX3RlbXBsYXRlX2h0bWx0YWdzICYmIHN0cnBvcygkemJwLT50ZW1wbGF0ZS0+dGVtcGxhdGVzWydjb21tZW50J10sICdpZD0iQWpheENvbW1lbnQnKSA9PT0gZmFsc2UpIHsNCiAgICAgICAgICAgICAgICAkY29tbWVudC0+Q29udGVudCAuPSAnPGxhYmVsIGlkPSJBamF4Q29tbWVudCcgLiAkY29tbWVudC0+SUQgLiAnIj48L2xhYmVsPic7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAkemJwLT5Mb2FkTWVtYmVyc0luTGlzdCgkY29tbWVudHMpOw0KDQogICAgJHpicC0+dGVtcGxhdGUtPlNldFRhZ3MoJ3Bvc3R0eXBlJywgJGFydGljbGUtPlR5cGUpOw0KICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCd0aXRsZScsICgkYXJ0aWNsZS0+U3RhdHVzID09IDAgPyAnJyA6ICdbJyAuICR6YnAtPmxhbmdbJ3Bvc3Rfc3RhdHVzX25hbWUnXVskYXJ0aWNsZS0+U3RhdHVzXSAuICddJykgLiAkYXJ0aWNsZS0+VGl0bGUpOw0KICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCd1cmwnLCAkYXJ0aWNsZS0+VXJsKTsNCiAgICAkemJwLT50ZW1wbGF0ZS0+U2V0VGFncygnYXJ0aWNsZScsICRhcnRpY2xlKTsNCiAgICAkemJwLT50ZW1wbGF0ZS0+U2V0VGFncygndHlwZScsICRhcnRpY2xlLT5UeXBlTmFtZSk7DQogICAgJHpicC0+dGVtcGxhdGUtPlNldFRhZ3MoJ3BhZ2UnLCAxKTsNCg0KICAgIGlmICgkcGFnZWJhci0+UGFnZUFsbCA9PSAwIHx8ICRwYWdlYmFyLT5QYWdlQWxsID09IDEpIHsNCiAgICAgICAgJHBhZ2ViYXIgPSBudWxsOw0KICAgIH0NCiAgICAkemJwLT50ZW1wbGF0ZS0+U2V0VGFncygncGFnZWJhcicsICRwYWdlYmFyKTsNCiAgICAkemJwLT50ZW1wbGF0ZS0+U2V0VGFncygnY29tbWVudHNwYWdlYmFyJywgJHBhZ2ViYXIpOw0KICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCdjb21tZW50c3BhZ2UnLCAxKTsNCiAgICAkemJwLT50ZW1wbGF0ZS0+U2V0VGFncygnY29tbWVudHMnLCAkY29tbWVudHMpOw0KDQogICAgJHpicC0+dGVtcGxhdGUtPlNldFRhZ3MoJ2FyZ3MnLCAkZnBhcmdzKTsNCiAgICAkemJwLT50ZW1wbGF0ZS0+U2V0VGFncygncm91dGUnLCAkcm91dGUpOw0KDQogICAgaWYgKCR6YnAtPnRlbXBsYXRlLT5oYXNUZW1wbGF0ZSgkYXJ0aWNsZS0+VGVtcGxhdGUpKSB7DQogICAgICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUZW1wbGF0ZSgkYXJ0aWNsZS0+VGVtcGxhdGUpOw0KICAgIH0gZWxzZSB7DQogICAgICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUZW1wbGF0ZSgkemJwLT5vcHRpb25bJ1pDX1BPU1RfREVGQVVMVF9URU1QTEFURSddKTsNCiAgICB9DQoNCiAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9WaWV3UG9zdF9UZW1wbGF0ZSddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAkZnByZXR1cm4gPSAkZnBuYW1lKCR6YnAtPnRlbXBsYXRlKTsNCiAgICAgICAgaWYgKCRmcHNpZ25hbCA9PSBQTFVHSU5fRVhJVFNJR05BTF9SRVRVUk4pIHsNCiAgICAgICAgICAgICRmcHNpZ25hbCA9IFBMVUdJTl9FWElUU0lHTkFMX05PTkU7DQoNCiAgICAgICAgICAgIHJldHVybiAkZnByZXR1cm47DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBpZiAoJGNhbmNlbGRpc3BsYXkgPT0gZmFsc2UpIHsNCiAgICAgICAgJHpicC0+dGVtcGxhdGUtPkRpc3BsYXkoKTsNCiAgICB9IGVsc2Ugew0KICAgICAgICByZXR1cm4gJHpicC0+dGVtcGxhdGUtPkdldFRhZ3MoJ3VybCcpOw0KICAgIH0NCg0KICAgIHJldHVybiB0cnVlOw0KfQ0KDQovKioNCiAqIOaYvuekuuaWh+eroOS4i+ivhOiuuuWIl+ihqC4NCiAqDQogKiBAcGFyYW0gaW50ICRwb3N0aWQg5paH56ugSUQNCiAqIEBwYXJhbSBpbnQgJHBhZ2UgICDpobXmlbANCiAqDQogKiBAdGhyb3dzIEV4Y2VwdGlvbg0KICoNCiAqIEByZXR1cm4gYm9vbA0KICovDQpmdW5jdGlvbiBWaWV3Q29tbWVudHMoJHBvc3RpZCwgJHBhZ2UpDQp7DQogICAgZ2xvYmFsICR6YnA7DQoNCiAgICAkcG9zdCA9IG5ldyBQb3N0KCk7DQogICAgJHBvc3QgPSAkemJwLT5HZXRQb3N0QnlJRCgkcG9zdGlkKTsNCiAgICAkcGFnZSA9ICRwYWdlID09IDAgPyAxIDogJHBhZ2U7DQogICAgJHRlbXBsYXRlID0gJ2NvbW1lbnRzJzsNCg0KICAgICRwYWdlYmFyID0gbmV3IFBhZ2ViYXIoJ2phdmFzY3JpcHQ6emJwLmNvbW1lbnQuZ2V0KFwnJyAuICRwb3N0LT5JRCAuICdcJyxcJ3slcGFnZSV9XCcpOycpOw0KICAgICRwYWdlYmFyLT5QYWdlQ291bnQgPSAkemJwLT5jb21tZW50ZGlzcGxheWNvdW50Ow0KICAgICRwYWdlYmFyLT5QYWdlTm93ID0gJHBhZ2U7DQogICAgJHBhZ2ViYXItPlBhZ2VCYXJDb3VudCA9ICR6YnAtPnBhZ2ViYXJjb3VudDsNCiAgICAvLyRwYWdlYmFyLT5Db3VudCA9ICRwb3N0LT5Db21tTnVtczsNCg0KICAgICRjb21tZW50cyA9IGFycmF5KCk7DQoNCiAgICAkY29tbWVudHMgPSAkemJwLT5HZXRDb21tZW50TGlzdCgNCiAgICAgICAgJyonLA0KICAgICAgICBhcnJheSgNCiAgICAgICAgICAgIGFycmF5KCc9JywgJ2NvbW1fTG9nSUQnLCAkcG9zdC0+SUQpLA0KICAgICAgICAgICAgYXJyYXkoJz0nLCAnY29tbV9Sb290SUQnLCAwKSwNCiAgICAgICAgICAgIGFycmF5KCc9JywgJ2NvbW1fSXNDaGVja2luZycsIDApLA0KICAgICAgICApLA0KICAgICAgICBhcnJheSgnY29tbV9JRCcgPT4gKCR6YnAtPm9wdGlvblsnWkNfQ09NTUVOVF9SRVZFUlNFX09SREVSJ10gPyAnREVTQycgOiAnQVNDJykpLA0KICAgICAgICBhcnJheSgoJHBhZ2ViYXItPlBhZ2VOb3cgLSAxKSAqICRwYWdlYmFyLT5QYWdlQ291bnQsICRwYWdlYmFyLT5QYWdlQ291bnQpLA0KICAgICAgICBhcnJheSgncGFnZWJhcicgPT4gJHBhZ2ViYXIpDQogICAgKTsNCiAgICAkcm9vdGlkID0gYXJyYXkoKTsNCiAgICBmb3JlYWNoICgkY29tbWVudHMgYXMgJGNvbW1lbnQpIHsNCiAgICAgICAgJHJvb3RpZFtdID0gYXJyYXkoJ2NvbW1fUm9vdElEJywgJGNvbW1lbnQtPklEKTsNCiAgICB9DQogICAgJGNvbW1lbnRzMiA9ICR6YnAtPkdldENvbW1lbnRMaXN0KA0KICAgICAgICAnKicsDQogICAgICAgIGFycmF5KA0KICAgICAgICAgICAgYXJyYXkoJz0nLCAnY29tbV9Mb2dJRCcsICRwb3N0LT5JRCksDQogICAgICAgICAgICBhcnJheSgnYXJyYXknLCAkcm9vdGlkKSwNCiAgICAgICAgICAgIGFycmF5KCc9JywgJ2NvbW1fSXNDaGVja2luZycsIDApLA0KICAgICAgICApLA0KICAgICAgICBhcnJheSgnY29tbV9JRCcgPT4gKCR6YnAtPm9wdGlvblsnWkNfQ09NTUVOVF9SRVZFUlNFX09SREVSJ10gPyAnREVTQycgOiAnQVNDJykpLA0KICAgICAgICBudWxsLA0KICAgICAgICBudWxsDQogICAgKTsNCg0KICAgICRmbG9vcmlkID0gKCgkcGFnZWJhci0+UGFnZU5vdyAtIDEpICogJHBhZ2ViYXItPlBhZ2VDb3VudCk7DQogICAgZm9yZWFjaCAoJGNvbW1lbnRzIGFzICYkY29tbWVudCkgew0KICAgICAgICAkZmxvb3JpZCArPSAxOw0KICAgICAgICAkY29tbWVudC0+Rmxvb3JJRCA9ICRmbG9vcmlkOw0KICAgICAgICAkY29tbWVudC0+Q29udGVudCA9IEZvcm1hdFN0cmluZygkY29tbWVudC0+Q29udGVudCwgJ1tlbnRlcl0nKTsNCiAgICAgICAgaWYgKCR6YnAtPmF1dG9maWxsX3RlbXBsYXRlX2h0bWx0YWdzICYmIHN0cnBvcygkemJwLT50ZW1wbGF0ZS0+dGVtcGxhdGVzWydjb21tZW50J10sICdpZD0iQWpheENvbW1lbnQnKSA9PT0gZmFsc2UpIHsNCiAgICAgICAgICAgICRjb21tZW50LT5Db250ZW50IC49ICc8bGFiZWwgaWQ9IkFqYXhDb21tZW50JyAuICRjb21tZW50LT5JRCAuICciPjwvbGFiZWw+JzsNCiAgICAgICAgfQ0KICAgIH0NCiAgICBmb3JlYWNoICgkY29tbWVudHMyIGFzICYkY29tbWVudCkgew0KICAgICAgICAkY29tbWVudC0+Q29udGVudCA9IEZvcm1hdFN0cmluZygkY29tbWVudC0+Q29udGVudCwgJ1tlbnRlcl0nKTsNCiAgICAgICAgaWYgKCR6YnAtPmF1dG9maWxsX3RlbXBsYXRlX2h0bWx0YWdzICYmIHN0cnBvcygkemJwLT50ZW1wbGF0ZS0+dGVtcGxhdGVzWydjb21tZW50J10sICdpZD0iQWpheENvbW1lbnQnKSA9PT0gZmFsc2UpIHsNCiAgICAgICAgICAgICRjb21tZW50LT5Db250ZW50IC49ICc8bGFiZWwgaWQ9IkFqYXhDb21tZW50JyAuICRjb21tZW50LT5JRCAuICciPjwvbGFiZWw+JzsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCd0aXRsZScsICR6YnAtPnRpdGxlKTsNCiAgICAkemJwLT50ZW1wbGF0ZS0+U2V0VGFncygnYXJ0aWNsZScsICRwb3N0KTsNCiAgICAkemJwLT50ZW1wbGF0ZS0+U2V0VGFncygndHlwZScsICdjb21tZW50Jyk7DQoNCiAgICBpZiAoJHBhZ2ViYXItPlBhZ2VBbGwgPT0gMSkgew0KICAgICAgICAkcGFnZWJhciA9IG51bGw7DQogICAgfQ0KDQogICAgJHpicC0+dGVtcGxhdGUtPlNldFRhZ3MoJ3BhZ2ViYXInLCAkcGFnZWJhcik7DQogICAgJHpicC0+dGVtcGxhdGUtPlNldFRhZ3MoJ2NvbW1lbnRzcGFnZWJhcicsICRwYWdlYmFyKTsNCiAgICAkemJwLT50ZW1wbGF0ZS0+U2V0VGFncygnY29tbWVudHNwYWdlJywgJHBhZ2UpOw0KICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCdjb21tZW50cycsICRjb21tZW50cyk7DQoNCiAgICAkemJwLT50ZW1wbGF0ZS0+U2V0VGVtcGxhdGUoJHRlbXBsYXRlKTsNCg0KICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1ZpZXdDb21tZW50c19UZW1wbGF0ZSddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAkZnByZXR1cm4gPSAkZnBuYW1lKCR6YnAtPnRlbXBsYXRlKTsNCiAgICB9DQoNCiAgICAkcyA9ICR6YnAtPnRlbXBsYXRlLT5PdXRwdXQoKTsNCg0KICAgICRhID0gZXhwbG9kZSgnPGxhYmVsIGlkPSJBamF4Q29tbWVudEJlZ2luIj48L2xhYmVsPicsICRzKTsNCiAgICAkcyA9ICRhWzFdOw0KICAgICRhID0gZXhwbG9kZSgnPGxhYmVsIGlkPSJBamF4Q29tbWVudEVuZCI+PC9sYWJlbD4nLCAkcyk7DQogICAgJHMgPSAkYVswXTsNCg0KICAgIGVjaG8gJHM7DQoNCiAgICByZXR1cm4gdHJ1ZTsNCn0NCg0KLyoqDQogKiDmmL7npLror4TorrouDQogKg0KICogQHBhcmFtIGludCAkaWQg6K+E6K66SUQNCiAqDQogKiBAdGhyb3dzIEV4Y2VwdGlvbg0KICoNCiAqIEByZXR1cm4gYm9vbA0KICovDQpmdW5jdGlvbiBWaWV3Q29tbWVudCgkaWQpDQp7DQogICAgZ2xvYmFsICR6YnA7DQoNCiAgICAkdGVtcGxhdGUgPSAnY29tbWVudCc7DQogICAgLyogQHZhciBDb21tZW50ICRjb21tZW50ICovDQogICAgJGNvbW1lbnQgPSAkemJwLT5HZXRDb21tZW50QnlJRCgkaWQpOw0KICAgICRwb3N0ID0gbmV3IFBvc3QoKTsNCiAgICAkcG9zdCA9ICR6YnAtPkdldFBvc3RCeUlEKCRjb21tZW50LT5Mb2dJRCk7DQoNCiAgICAkY29tbWVudC0+Q29udGVudCA9IEZvcm1hdFN0cmluZyhodG1sc3BlY2lhbGNoYXJzKCRjb21tZW50LT5Db250ZW50KSwgJ1tlbnRlcl0nKTsNCiAgICBpZiAoJHpicC0+YXV0b2ZpbGxfdGVtcGxhdGVfaHRtbHRhZ3MgJiYgc3RycG9zKCR6YnAtPnRlbXBsYXRlLT50ZW1wbGF0ZXNbJ2NvbW1lbnQnXSwgJ2lkPSJBamF4Q29tbWVudCcpID09PSBmYWxzZSkgew0KICAgICAgICAkY29tbWVudC0+Q29udGVudCAuPSAnPGxhYmVsIGlkPSJBamF4Q29tbWVudCcgLiAkY29tbWVudC0+SUQgLiAnIj48L2xhYmVsPic7DQogICAgfQ0KDQogICAgJHpicC0+dGVtcGxhdGUtPlNldFRhZ3MoJ3RpdGxlJywgJHpicC0+dGl0bGUpOw0KICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCdjb21tZW50JywgJGNvbW1lbnQpOw0KICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCdhcnRpY2xlJywgJHBvc3QpOw0KICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCd0eXBlJywgJ2NvbW1lbnQnKTsNCiAgICAkemJwLT50ZW1wbGF0ZS0+U2V0VGFncygncGFnZScsIDEpOw0KICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUZW1wbGF0ZSgkdGVtcGxhdGUpOw0KDQogICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fVmlld0NvbW1lbnRfVGVtcGxhdGUnXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgJGZwcmV0dXJuID0gJGZwbmFtZSgkemJwLT50ZW1wbGF0ZSk7DQogICAgfQ0KDQogICAgJHpicC0+dGVtcGxhdGUtPkRpc3BsYXkoKTsNCg0KICAgIHJldHVybiB0cnVlOw0KfQ0K</file>
	<file name='zb_system\function\c_system_version.php' crc32='29CE7A44'  dt:dt='bin.base64'>PD9waHANCg0KaWYgKCFkZWZpbmVkKCdaQlBfUEFUSCcpKSB7DQogICAgZXhpdCgnQWNjZXNzIGRlbmllZCcpOw0KfQ0KLyoNCiAqIOWumuS5ieeJiOacrOWPtw0KDQrov5nmmK8xLjXlj5bmtojnmoTmlbDnu4TvvIzooqvlronmjpLliLDlupTnlKjkuK3lv4PlrqLmiLfnq6/nmoRpbmNsdWRlLnBocOaWh+S7tumHjOOAgg0KI+WumuS5ieeJiOacrOWPt+WIlw0KJHpicHZlcnM9YXJyYXkoKTsNCiR6YnB2ZXJzWycxMzA3MDcnXT0nMS4wIEJldGEgQnVpbGQgMTMwNzA3JzsNCiR6YnB2ZXJzWycxMzExMTEnXT0nMS4wIEJldGEyIEJ1aWxkIDEzMTExMSc7DQokemJwdmVyc1snMTMxMjIxJ109JzEuMSBUYWljaGkgQnVpbGQgMTMxMjIxJzsNCiR6YnB2ZXJzWycxNDAyMjAnXT0nMS4yIEhpcHBvIEJ1aWxkIDE0MDIyMCc7DQokemJwdmVyc1snMTQwNjE0J109JzEuMyBXb25jZSBCdWlsZCAxNDA2MTQnOw0KJHpicHZlcnNbJzE1MDEwMSddPScxLjQgRGVlcGx1ZSBCdWlsZCAxNTAxMDEnOw0KJHpicHZlcnNbJzE1MTYyNiddPScxLjUgWmVybyBCdWlsZCAxNTE2MjYnOw0KDQogKi8NCmRlZmluZSgnWkNfVkVSU0lPTl9NQUpPUicsICcxJyk7DQpkZWZpbmUoJ1pDX1ZFUlNJT05fTUlOT1InLCAnNycpOw0KZGVmaW5lKCdaQ19WRVJTSU9OX0JVSUxEJywgJzAnKTsNCmRlZmluZSgnWkNfVkVSU0lPTl9DT01NSVQnLCAnMjkyNScpOw0KZGVmaW5lKCdaQ19WRVJTSU9OX0NPREVOQU1FJywgJ1RlbmV0Jyk7DQpkZWZpbmUoJ1pDX1ZFUlNJT04nLCBaQ19WRVJTSU9OX01BSk9SIC4gJy4nIC4gWkNfVkVSU0lPTl9NSU5PUiAuICcuJyAuIFpDX1ZFUlNJT05fQlVJTEQgLiAnLicgLiBaQ19WRVJTSU9OX0NPTU1JVCk7DQppZiAoc3RyY2FzZWNtcChaQ19WRVJTSU9OX0NPREVOQU1FLCAnQmV0YScpID09IDAgfHwgc3RyY2FzZWNtcChaQ19WRVJTSU9OX0NPREVOQU1FLCAnQWxwaGEnKSA9PSAwKSB7DQogICAgZGVmaW5lKCdaQ19WRVJTSU9OX0RJU1BMQVknLCBaQ19WRVJTSU9OX01BSk9SIC4gJy4nIC4gWkNfVkVSU0lPTl9NSU5PUiAuICcuJyAuIFpDX1ZFUlNJT05fQlVJTEQgLiAnICcgLiBaQ19WRVJTSU9OX0NPREVOQU1FKTsNCn0gZWxzZSB7DQogICAgZGVmaW5lKCdaQ19WRVJTSU9OX0RJU1BMQVknLCBaQ19WRVJTSU9OX01BSk9SIC4gJy4nIC4gWkNfVkVSU0lPTl9NSU5PUiAuICcuJyAuIFpDX1ZFUlNJT05fQlVJTEQpOw0KfQ0KZGVmaW5lKCdaQ19WRVJTSU9OX0ZVTEwnLCBaQ19WRVJTSU9OIC4gJyAoJyAuIFpDX1ZFUlNJT05fQ09ERU5BTUUgLiAnKScpOw0KZGVmaW5lKCdaQ19CTE9HX0NPTU1JVCcsIFpDX1ZFUlNJT05fQ09NTUlUKTsgLy8g5Li65YaZ5YWl57O757uf6YWN572u57uf5LiA6aOO5qC8DQokR0xPQkFMU1snYmxvZ3ZlcnNpb24nXSA9IFpDX1ZFUlNJT05fTUFKT1IgLiBaQ19WRVJTSU9OX01JTk9SIC4gWkNfVkVSU0lPTl9DT01NSVQ7DQpkZWZpbmUoJ1pDX0JMT0dfVkVSU0lPTicsIFpDX1ZFUlNJT05fRElTUExBWSAuICcgQnVpbGQgJyAuICRHTE9CQUxTWydibG9ndmVyc2lvbiddKTsNCmRlZmluZSgnWkNfTEFTVF9WRVJTSU9OJywgJzE3MjgwMCcpOyAvL+aVsOaNruW6k+mHjOWGmeWFpeeahOacgOaWsOeahOaVsOaNruW6k+eJiOacrOWPt++8iOmdnuezu+e7n+eJiOacrOWPt++8jOWPquacieabtOaUueaVsOaNruW6k+e7k+aehOaJjeS8muWPmOWKqO+8iQ0K</file>
	<file name='zb_system\function\lib\config.php' crc32='74B8E7BD'  dt:dt='bin.base64'>PD9waHANCg0KaWYgKCFkZWZpbmVkKCdaQlBfUEFUSCcpKSB7DQogICAgZXhpdCgnQWNjZXNzIGRlbmllZCcpOw0KfQ0KDQovKioNCiAqIOmFjee9ruexuy4NCiAqLw0KY2xhc3MgQ29uZmlnIGltcGxlbWVudHMgSXRlcmF0b3INCnsNCg0KICAgIHByaXZhdGUgJHBvc2l0aW9uID0gMDsNCg0KICAgIHByaXZhdGUgJGFycmF5ID0gYXJyYXkoKTsgLy/lrZgka2V555qE5pWw57uE77yM6Z2eJHZhbHVlDQoNCiAgICBwdWJsaWMgZnVuY3Rpb24gcmV3aW5kKCkNCiAgICB7DQogICAgICAgIC8vZm9yZWFjaCAoJHRoaXMtPmt2ZGF0YSBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAvLyAgICAkdGhpcy0+YXJyYXlbXSA9ICRrZXk7DQogICAgICAgIC8vfQ0KICAgICAgICAkdGhpcy0+YXJyYXkgPSBhcnJheV9rZXlzKCR0aGlzLT5rdmRhdGEpOw0KICAgICAgICAkdGhpcy0+cG9zaXRpb24gPSAwOw0KICAgIH0NCg0KICAgIHB1YmxpYyBmdW5jdGlvbiBjdXJyZW50KCkNCiAgICB7DQogICAgICAgIHJldHVybiAkdGhpcy0+a3ZkYXRhWyR0aGlzLT5hcnJheVskdGhpcy0+cG9zaXRpb25dXTsNCiAgICB9DQoNCiAgICBwdWJsaWMgZnVuY3Rpb24ga2V5KCkNCiAgICB7DQogICAgICAgIHJldHVybiAkdGhpcy0+YXJyYXlbJHRoaXMtPnBvc2l0aW9uXTsNCiAgICB9DQoNCiAgICBwdWJsaWMgZnVuY3Rpb24gbmV4dCgpDQogICAgew0KICAgICAgICArKyR0aGlzLT5wb3NpdGlvbjsNCiAgICB9DQoNCiAgICBwdWJsaWMgZnVuY3Rpb24gdmFsaWQoKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuIGFycmF5X2tleV9leGlzdHMoJHRoaXMtPnBvc2l0aW9uLCAkdGhpcy0+YXJyYXkpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nIOaVsOaNruihqA0KICAgICAqLw0KICAgIHByb3RlY3RlZCAkdGFibGUgPSAnJzsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgYXJyYXkg6KGo57uT5p6E5L+h5oGvDQogICAgICovDQogICAgcHJvdGVjdGVkICRkYXRhaW5mbyA9IGFycmF5KCk7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIGFycmF5IOWOn+Wni2Ri5pWw5o2u5pWw57uEDQogICAgICovDQogICAgcHJvdGVjdGVkICRkYXRhID0gYXJyYXkoKTsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgYXJyYXkg5a2Y5YKoQ29uZmln55u45bqUa2V5LXZhbHVl5pWw5YC855qE5pWw57uEDQogICAgICovDQogICAgcHJvdGVjdGVkICRrdmRhdGEgPSBhcnJheSgpOw0KDQogICAgLyoqDQogICAgICogQHZhciBhcnJheSDlrZjlgqhDb25maWfnm7jlupTljp/lp4vmlbDmja7nmoTmlbDnu4QNCiAgICAgKi8NCiAgICBwcm90ZWN0ZWQgJG9yaWdrdmRhdGEgPSBhcnJheSgpOw0KDQogICAgLyoqDQogICAgICogQHZhciBEYXRhYmFzZV9fSW50ZXJmYWNlDQogICAgICovDQogICAgcHJvdGVjdGVkICRkYiA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiAkaXRlbW5hbWUgc3RyaW5nIOmhueebruWQjeensC4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJGl0ZW1OYW1lDQogICAgICogQHBhcmFtIG51bGwgICAkZGINCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGl0ZW1OYW1lID0gJycsICYkZGIgPSBudWxsKQ0KICAgIHsNCiAgICAgICAgaWYgKCRkYiAhPT0gbnVsbCkgew0KICAgICAgICAgICAgJHRoaXMtPmRiID0gJiRkYjsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICR0aGlzLT5kYiA9ICYkR0xPQkFMU1snemJwJ10tPmRiOw0KICAgICAgICB9DQoNCiAgICAgICAgJHRoaXMtPnRhYmxlID0gJiRHTE9CQUxTWyd0YWJsZSddWydDb25maWcnXTsNCiAgICAgICAgJHRoaXMtPmRhdGFpbmZvID0gJiRHTE9CQUxTWydkYXRhaW5mbyddWydDb25maWcnXTsNCg0KICAgICAgICBmb3JlYWNoICgkdGhpcy0+ZGF0YWluZm8gYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgICAgICR0aGlzLT5kYXRhWyRrZXldID0gJHZhbHVlWzNdOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCRpdGVtTmFtZSkgew0KICAgICAgICAgICAgJGl0ZW1OYW1lID0gRmlsdGVyQ29ycmVjdE5hbWUoJGl0ZW1OYW1lKTsNCiAgICAgICAgfQ0KDQogICAgICAgICR0aGlzLT5kYXRhWydOYW1lJ10gPSAkaXRlbU5hbWU7DQogICAgICAgICR0aGlzLT5wb3NpdGlvbiA9IDA7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogQHBhcmFtICRuYW1lDQogICAgICogQHBhcmFtICR2YWx1ZQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBfX3NldCgkbmFtZSwgJHZhbHVlKQ0KICAgIHsNCiAgICAgICAgJG5hbWUgPSBGaWx0ZXJDb3JyZWN0TmFtZSgkbmFtZSk7DQogICAgICAgICR0aGlzLT5rdmRhdGFbJG5hbWVdID0gJHZhbHVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUga2V55ZCNDQogICAgICoNCiAgICAgKiBAcmV0dXJuIG51bGwNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gX19nZXQoJG5hbWUpDQogICAgew0KICAgICAgICBpZiAoIWlzc2V0KCR0aGlzLT5rdmRhdGFbJG5hbWVdKSkgew0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICR0aGlzLT5rdmRhdGFbJG5hbWVdOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBwYXJhbSAkbmFtZQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBfX2lzc2V0KCRuYW1lKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuIGFycmF5X2tleV9leGlzdHMoJG5hbWUsICR0aGlzLT5rdmRhdGEpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBwYXJhbSAkbmFtZQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBfX3Vuc2V0KCRuYW1lKQ0KICAgIHsNCiAgICAgICAgdW5zZXQoJHRoaXMtPmt2ZGF0YVskbmFtZV0pOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOiOt+WPlkRhdGHmlbDmja4uDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGFycmF5DQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldERhdGEoKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuICR0aGlzLT5rdmRhdGE7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6I635Y+WQ29uZmln55qESXRlbSjpobnnm67lkI0pLg0KICAgICAqDQogICAgICogQHJldHVybiBzdHJpbmcNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0SXRlbU5hbWUoKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuICR0aGlzLT5kYXRhWydOYW1lJ107DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5qOA5p+lS1ZEYXRh5bGe5oCn77yI5pWw57uE77yJ5bGe5oCn5YC85piv5piv5ZCm5a2Y5Zyo55u45bqUa2V5Lg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbmFtZSBrZXnlkI0NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBIYXNLZXkoJG5hbWUpDQogICAgew0KICAgICAgICByZXR1cm4gYXJyYXlfa2V5X2V4aXN0cygkbmFtZSwgJHRoaXMtPmt2ZGF0YSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5qOA5p+lS1ZEYXRh5bGe5oCn77yI5pWw57uE77yJ5Lit55qE5Y2V5YWD5pWw55uuLg0KICAgICAqDQogICAgICogQHJldHVybiBpbnQNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQ291bnRJdGVtKCkNCiAgICB7DQogICAgICAgIHJldHVybiBjb3VudCgkdGhpcy0+a3ZkYXRhKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgZnVuY3Rpb24gQ291bnRJdGVtT3JpZygpDQogICAgew0KICAgICAgICByZXR1cm4gY291bnQoJHRoaXMtPm9yaWdrdmRhdGEpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWPjOmHjeaEj+S5ieeahOWHveaVsA0KICAgICAqICRuYW1l5Li6bnVsbOWwsei9rOWQkURlbGV0ZSgpDQogICAgICogJG5hbWXkuI3kuLpudWxs5bCx6L2s5ZCRRGVsS2V5KCkNCiAgICAgKiDliKDpmaRLVkRhdGHlsZ7mgKfvvIjmlbDnu4TvvInkuK3nmoTnm7jlupTpobkNCiAgICAgKiBEZWzlkI3np7DlkozmlbDmja7lupPliKDpmaTlh73mlbDmnInlhrLnqoENCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUga2V55ZCNDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIERlbCgkbmFtZSA9IG51bGwpDQogICAgew0KICAgICAgICBpZiAoJG5hbWUgPT09IG51bGwpIHsNCiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+RGVsZXRlKCk7DQogICAgICAgIH0NCiAgICAgICAgaWYgKCRuYW1lICE9PSBudWxsKSB7DQogICAgICAgICAgICByZXR1cm4gJHRoaXMtPkRlbEtleSgkbmFtZSk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDlsIZEYXRh5bGe5oCn77yI5pWw57uE77yJ5YC85bqP5YiX5YyWLg0KICAgICAqDQogICAgICogQHJldHVybiBzdHJpbmcg6L+U5Zue5bqP5YiX5YyW55qE5YC8DQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFNlcmlhbGl6ZSgpDQogICAgew0KICAgICAgICBnbG9iYWwgJGJsb2dob3N0Ow0KICAgICAgICBpZiAoY291bnQoJHRoaXMtPmt2ZGF0YSkgPT0gMCkgew0KICAgICAgICAgICAgcmV0dXJuICcnOw0KICAgICAgICB9DQoNCiAgICAgICAgJGFycmF5ID0gJHRoaXMtPmt2ZGF0YTsNCiAgICAgICAgZm9yZWFjaCAoJGFycmF5IGFzICRrZXkgPT4gJiR2YWx1ZSkgew0KICAgICAgICAgICAgaWYgKGlzX3N0cmluZygkdmFsdWUpKSB7DQogICAgICAgICAgICAgICAgJHZhbHVlID0gc3RyX3JlcGxhY2UoJGJsb2dob3N0LCAneyNaQ19CTE9HX0hPU1QjfScsICR2YWx1ZSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gc2VyaWFsaXplKCRhcnJheSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5bCG5bqP5YiX5YyW55qE5YC85Y+N5bqP5YiX5YyW5ZCO6LWL5LqIRGF0YeWxnuaAp+WAvA0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkcyDluo/liJfljJblgLwNCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBVbnNlcmlhbGl6ZSgkcykNCiAgICB7DQogICAgICAgIGdsb2JhbCAkYmxvZ2hvc3Q7DQoNCiAgICAgICAgaWYgKCRzID09ICcnKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCg0KICAgICAgICAkdGhpcy0+a3ZkYXRhID0gQHVuc2VyaWFsaXplKCRzKTsNCiAgICAgICAgaWYgKCFpc19hcnJheSgkdGhpcy0+a3ZkYXRhKSkgew0KICAgICAgICAgICAgJHRoaXMtPmt2ZGF0YSA9IGFycmF5KCk7DQoNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgIGZvcmVhY2ggKCR0aGlzLT5rdmRhdGEgYXMgJGtleSA9PiAmJHZhbHVlKSB7DQogICAgICAgICAgICBpZiAoaXNfc3RyaW5nKCR2YWx1ZSkpIHsNCiAgICAgICAgICAgICAgICAkdmFsdWUgPSBzdHJfcmVwbGFjZSgneyNaQ19CTE9HX0hPU1QjfScsICRibG9naG9zdCwgJHZhbHVlKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOS7juaVsOe7hOS4reWKoOi9veaVsOaNri4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBhcnJheSAkYXJyYXkg5YWz6IGU5pWw57uEDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gTG9hZEluZm9CeUFzc29jKCRhcnJheSkNCiAgICB7DQogICAgICAgIGZvcmVhY2ggKCR0aGlzLT5kYXRhaW5mbyBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAgICAgaWYgKCFpc3NldCgkYXJyYXlbJHZhbHVlWzBdXSkpIHsNCiAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgICR0aGlzLT5kYXRhWyRrZXldID0gJGFycmF5WyR2YWx1ZVswXV07DQogICAgICAgIH0NCiAgICAgICAgJHRoaXMtPlVuc2VyaWFsaXplKCR0aGlzLT5kYXRhWydWYWx1ZSddKTsNCiAgICAgICAgJHRoaXMtPm9yaWdrdmRhdGEgPSAkdGhpcy0+a3ZkYXRhOw0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOS4uuS6huWKoOW/q+WkhOeQhumAn+W6puaJjeWGmeeahOS4gOWvuVdpdGhQcmUsV2l0aEFmdGVy5Ye95pWwLg0KICAgICAqLw0KICAgIHByaXZhdGUgJGRhdGFfcHJlX2tleSA9IGFycmF5KCk7DQoNCiAgICBwcml2YXRlICRkYXRhX3ByZV92YWx1ZSA9IGFycmF5KCk7DQoNCiAgICBwdWJsaWMgZnVuY3Rpb24gTG9hZEluZm9CeUFzc29jU2luZ2xlV2l0aFByZSgkYXJyYXkpDQogICAgew0KICAgICAgICAka2V5ID0gdHJpbSgkYXJyYXlbJHRoaXMtPmRhdGFpbmZvWydLZXknXVswXV0pOw0KICAgICAgICAkdmFsdWUgPSB0cmltKCRhcnJheVskdGhpcy0+ZGF0YWluZm9bJ1ZhbHVlJ11bMF1dKTsNCiAgICAgICAgJHRoaXMtPmRhdGFfcHJlX2tleVtdID0gJGtleTsNCiAgICAgICAgJHRoaXMtPmRhdGFfcHJlX3ZhbHVlW10gPSAkdmFsdWU7DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgcHVibGljIGZ1bmN0aW9uIExvYWRJbmZvQnlBc3NvY1NpbmdsZVdpdGhBZnRlcigpDQogICAgew0KICAgICAgICBnbG9iYWwgJGJsb2dob3N0Ow0KICAgICAgICBpZiAoY291bnQoJHRoaXMtPmRhdGFfcHJlX3ZhbHVlKSA9PSAwIHx8IGNvdW50KCR0aGlzLT5kYXRhX3ByZV9rZXkpID09IDApIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgICR0aGlzLT5rdmRhdGEgPSBhcnJheSgpOw0KDQogICAgICAgIGZvcmVhY2ggKCR0aGlzLT5kYXRhX3ByZV92YWx1ZSBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAgICAgaWYgKGlzX2FycmF5KCR0aGlzLT5kYXRhX3ByZV9rZXlbJGtleV0pKSB7DQogICAgICAgICAgICAgICAgdW5zZXQoJHRoaXMtPmRhdGFfcHJlX2tleVska2V5XSk7DQogICAgICAgICAgICAgICAgdW5zZXQoJHRoaXMtPmRhdGFfcHJlX3ZhbHVlWyRrZXldKTsNCiAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIEAkdGhpcy0+a3ZkYXRhWyR0aGlzLT5kYXRhX3ByZV9rZXlbJGtleV1dID0gdW5zZXJpYWxpemUoJHRoaXMtPmRhdGFfcHJlX3ZhbHVlWyRrZXldKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGZvcmVhY2ggKCR0aGlzLT5rdmRhdGEgYXMgJGtleSA9PiAmJHZhbHVlKSB7DQogICAgICAgICAgICBpZiAoaXNfc3RyaW5nKCR2YWx1ZSkpIHsNCiAgICAgICAgICAgICAgICAkdmFsdWUgPSBzdHJfcmVwbGFjZSgneyNaQ19CTE9HX0hPU1QjfScsICRibG9naG9zdCwgJHZhbHVlKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICAkdGhpcy0+b3JpZ2t2ZGF0YSA9ICR0aGlzLT5rdmRhdGE7DQogICAgICAgICR0aGlzLT5kYXRhX3ByZV9rZXlbXSA9IGFycmF5KCk7DQogICAgICAgICR0aGlzLT5kYXRhX3ByZV92YWx1ZVtdID0gYXJyYXkoKTsNCg0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICBwdWJsaWMgZnVuY3Rpb24gTG9hZEluZm9CeUFzc29jU2luZ2xlKCRhcnJheSkNCiAgICB7DQogICAgICAgICRrZXkgPSB0cmltKCRhcnJheVskdGhpcy0+ZGF0YWluZm9bJ0tleSddWzBdXSk7DQogICAgICAgICR2YWx1ZSA9IHRyaW0oJGFycmF5WyR0aGlzLT5kYXRhaW5mb1snVmFsdWUnXVswXV0pOw0KDQogICAgICAgICR2YWx1ZSA9ICR0aGlzLT5VbnNlcmlhbGl6ZVNpbmdsZSgkdmFsdWUpOw0KICAgICAgICAkdGhpcy0+a3ZkYXRhWyRrZXldID0gJHZhbHVlOw0KICAgICAgICAkdGhpcy0+b3JpZ2t2ZGF0YVska2V5XSA9ICR2YWx1ZTsNCg0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICBwdWJsaWMgZnVuY3Rpb24gU2VyaWFsaXplU2luZ2xlKCR2YWx1ZSkNCiAgICB7DQogICAgICAgIGdsb2JhbCAkYmxvZ2hvc3Q7DQogICAgICAgIGlmIChpc19zdHJpbmcoJHZhbHVlKSkgew0KICAgICAgICAgICAgJHZhbHVlID0gc3RyX3JlcGxhY2UoJGJsb2dob3N0LCAneyNaQ19CTE9HX0hPU1QjfScsICR2YWx1ZSk7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gc2VyaWFsaXplKCR2YWx1ZSk7DQogICAgfQ0KDQogICAgcHVibGljIGZ1bmN0aW9uIFVuc2VyaWFsaXplU2luZ2xlKCR2YWx1ZSkNCiAgICB7DQogICAgICAgIGdsb2JhbCAkYmxvZ2hvc3Q7DQogICAgICAgICR2YWx1ZSA9IEB1bnNlcmlhbGl6ZSgkdmFsdWUpOw0KDQogICAgICAgIGlmIChpc19zdHJpbmcoJHZhbHVlKSkgew0KICAgICAgICAgICAgJHZhbHVlID0gc3RyX3JlcGxhY2UoJ3sjWkNfQkxPR19IT1NUI30nLCAkYmxvZ2hvc3QsICR2YWx1ZSk7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJHZhbHVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOS/neWtmOaVsOaNri4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBTYXZlKCkNCiAgICB7DQogICAgICAgICRuYW1lID0gJHRoaXMtPkdldEl0ZW1OYW1lKCk7DQogICAgICAgIGlmICgkbmFtZSA9PSAnJykgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgJGFkZCA9IGFycmF5X2RpZmZfa2V5KCR0aGlzLT5rdmRhdGEsICR0aGlzLT5vcmlna3ZkYXRhKTsNCiAgICAgICAgJGRlbCA9IGFycmF5X2RpZmZfa2V5KCR0aGlzLT5vcmlna3ZkYXRhLCAkdGhpcy0+a3ZkYXRhKTsNCiAgICAgICAgJG1vZCA9IGFycmF5KCk7IC8vYXJyYXlfaW50ZXJzZWN0KCR0aGlzLT5rdmRhdGEsICR0aGlzLT5vcmlna3ZkYXRhKTsNCiAgICAgICAgZm9yZWFjaCAoJHRoaXMtPmt2ZGF0YSBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAgICAgaWYgKGFycmF5X2tleV9leGlzdHMoJGtleSwgJHRoaXMtPm9yaWdrdmRhdGEpICYmICR0aGlzLT5rdmRhdGFbJGtleV0gIT0gJHRoaXMtPm9yaWdrdmRhdGFbJGtleV0pIHsNCiAgICAgICAgICAgICAgICAkbW9kWyRrZXldID0gJHZhbHVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIC8vdmFyX2R1bXAoY291bnQoJHRoaXMtPmt2ZGF0YSksY291bnQoJHRoaXMtPm9yaWdrdmRhdGEpKTtkaWU7DQogICAgICAgIC8vbG9ncyh2YXJfZXhwb3J0KCBhcnJheSgkdGhpcy0+b3JpZ2t2ZGF0YVsnWkNfREVCVUdfTU9ERSddLCAkdGhpcy0+a3ZkYXRhWydaQ19ERUJVR19NT0RFJ10pLCB0cnVlICkgKTsNCiAgICAgICAgLy9sb2dzKHZhcl9leHBvcnQoIGFycmF5KCdhZGQnPT4kYWRkICwgJ2RlbCc9PiRkZWwgLCAnbW9kJz0+JG1vZCksdHJ1ZSApICk7DQogICAgICAgIC8vdmFyX2R1bXAoJHRoaXMtPm9yaWdrdmRhdGFbJ1pDX0RFQlVHX01PREUnXSwgJHRoaXMtPmt2ZGF0YVsnWkNfREVCVUdfTU9ERSddKTsNCiAgICAgICAgLy92YXJfZHVtcCgkYWRkLCAkZGVsLCAkbW9kKTsNCiAgICAgICAgLy92YXJfZHVtcCgkdGhpcy0+a3ZkYXRhLCAkdGhpcy0+b3JpZ2t2ZGF0YSk7ZGllOw0KICAgICAgICBpZiAoKCRhZGQgKyAkZGVsICsgJG1vZCkgPT0gYXJyYXkoKSkgew0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0NCg0KICAgICAgICAkb2xkID0gQCR0aGlzLT5kYi0+UXVlcnkoJHRoaXMtPmRiLT5zcWwtPlNlbGVjdCgkdGhpcy0+dGFibGUsICR0aGlzLT5kYXRhaW5mb1snS2V5J11bMF0sIG51bGwsIG51bGwsIDEpKTsNCiAgICAgICAgLy/msqHmnInov5nkuKrlrZfmrrXvvJphcnJheSgxKSB7IFswXT0+IGJvb2woZmFsc2UpIH0NCiAgICAgICAgaWYgKGNvdW50KCRvbGQpID09IDEgJiYgJG9sZFswXSA9PT0gZmFsc2UpIHsgLy/lpoLmnpzov5jmsqHmnInlu7pjb25mX0tleeWtl+auteWwseS4jeimgeWOn+WtkOWMluWtmOWCqA0KICAgICAgICAgICAgJHZhbHVlID0gJHRoaXMtPlNlcmlhbGl6ZSgpOw0KDQogICAgICAgICAgICAka3YgPSBhcnJheSgkdGhpcy0+ZGF0YWluZm9bJ05hbWUnXVswXSA9PiAkbmFtZSwgJHRoaXMtPmRhdGFpbmZvWydWYWx1ZSddWzBdID0+ICR2YWx1ZSk7DQoNCiAgICAgICAgICAgICRvbGQgPSAkdGhpcy0+ZGItPlF1ZXJ5KCR0aGlzLT5kYi0+c3FsLT5TZWxlY3QoJHRoaXMtPnRhYmxlLCAnKicsIGFycmF5KGFycmF5KCc9JywgJHRoaXMtPmRhdGFpbmZvWydOYW1lJ11bMF0sICRuYW1lKSkpKTsNCiAgICAgICAgICAgIC8v5rKh5pyJ6L+Z5LiA6KGM5pWw5o2uIGFycmF5KDApIHsgfQ0KICAgICAgICAgICAgaWYgKGNvdW50KCRvbGQpID09IDApIHsNCiAgICAgICAgICAgICAgICAkc3FsID0gJHRoaXMtPmRiLT5zcWwtPkluc2VydCgkdGhpcy0+dGFibGUsICRrdik7DQogICAgICAgICAgICAgICAgJHRoaXMtPmRiLT5JbnNlcnQoJHNxbCk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIGFycmF5X3NoaWZ0KCRrdik7DQogICAgICAgICAgICAgICAgJHNxbCA9ICR0aGlzLT5kYi0+c3FsLT5VcGRhdGUoJHRoaXMtPnRhYmxlLCAka3YsIGFycmF5KGFycmF5KCc9JywgJHRoaXMtPmRhdGFpbmZvWydOYW1lJ11bMF0sICRuYW1lKSkpOw0KICAgICAgICAgICAgICAgICR0aGlzLT5kYi0+VXBkYXRlKCRzcWwpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgLy/lrZjlgqjmiJDlip/lkI7ph43nva5vcmlna3ZkYXRhDQogICAgICAgICAgICAkdGhpcy0+b3JpZ2t2ZGF0YSA9ICR0aGlzLT5rdmRhdGE7DQoNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9DQoNCiAgICAgICAgJG9sZCA9ICR0aGlzLT5kYi0+UXVlcnkoJHRoaXMtPmRiLT5zcWwtPlNlbGVjdCgkdGhpcy0+dGFibGUsICcqJywgYXJyYXkoYXJyYXkoJz0nLCAkdGhpcy0+ZGF0YWluZm9bJ05hbWUnXVswXSwgJG5hbWUpLCBhcnJheSgnPScsICR0aGlzLT5kYXRhaW5mb1snS2V5J11bMF0sICcnKSkpKTsNCiAgICAgICAgaWYgKGNvdW50KCRvbGQpID4gMCkgeyAvL+WmguaenOWtmOWcqOiAgeaVsOaNru+8jOWFiOWIoOmZpOiAgeeahA0KICAgICAgICAgICAgJGRlbCA9IGFycmF5KCk7DQogICAgICAgICAgICAkbW9kID0gYXJyYXkoKTsNCiAgICAgICAgICAgICRhZGQgPSAkdGhpcy0+a3ZkYXRhOw0KDQogICAgICAgICAgICAkc3FsID0gJHRoaXMtPmRiLT5zcWwtPkRlbGV0ZSgkdGhpcy0+dGFibGUsIGFycmF5KGFycmF5KCc9JywgJHRoaXMtPmRhdGFpbmZvWydOYW1lJ11bMF0sICRuYW1lKSwgYXJyYXkoJz0nLCAkdGhpcy0+ZGF0YWluZm9bJ0tleSddWzBdLCAnJykpKTsNCiAgICAgICAgICAgICR0aGlzLT5kYi0+RGVsZXRlKCRzcWwpOw0KICAgICAgICB9DQogICAgICAgIGlmICgoJGFkZCArICRkZWwgKyAkbW9kKSA9PSBhcnJheSgpKSB7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KDQogICAgICAgICR0aGlzLT5kYi0+VHJhbnNhY3Rpb24oJ2JlZ2luJyk7DQoNCiAgICAgICAgLy9hZGQNCiAgICAgICAgZm9yZWFjaCAoJGFkZCBhcyAka2V5MiA9PiAkdmFsdWUyKSB7DQogICAgICAgICAgICAka3YyID0gYXJyYXkoJHRoaXMtPmRhdGFpbmZvWydOYW1lJ11bMF0gPT4gJG5hbWUsICR0aGlzLT5kYXRhaW5mb1snS2V5J11bMF0gPT4gJGtleTIsICR0aGlzLT5kYXRhaW5mb1snVmFsdWUnXVswXSA9PiAkdGhpcy0+U2VyaWFsaXplU2luZ2xlKCR2YWx1ZTIpKTsNCiAgICAgICAgICAgICRzcWwgPSAkdGhpcy0+ZGItPnNxbC0+SW5zZXJ0KCR0aGlzLT50YWJsZSwgJGt2Mik7DQogICAgICAgICAgICAkb2xkID0gJHRoaXMtPmRiLT5RdWVyeSgkdGhpcy0+ZGItPnNxbC0+U2VsZWN0KCR0aGlzLT50YWJsZSwgJyonLCBhcnJheShhcnJheSgnPScsICR0aGlzLT5kYXRhaW5mb1snTmFtZSddWzBdLCAkbmFtZSksIGFycmF5KCc9JywgJHRoaXMtPmRhdGFpbmZvWydLZXknXVswXSwgJGtleTIpKSkpOw0KICAgICAgICAgICAgaWYgKGNvdW50KCRvbGQpID09IDApIHsNCiAgICAgICAgICAgICAgICAkdGhpcy0+ZGItPkluc2VydCgkc3FsKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgJGtleTMgPSAka2V5MjsNCiAgICAgICAgICAgICAgICAkdmFsdWUzID0gJHZhbHVlMjsNCiAgICAgICAgICAgICAgICAka3YzID0gYXJyYXkoJHRoaXMtPmRhdGFpbmZvWydWYWx1ZSddWzBdID0+ICR0aGlzLT5TZXJpYWxpemVTaW5nbGUoJHZhbHVlMykpOw0KICAgICAgICAgICAgICAgICRzcWwgPSAkdGhpcy0+ZGItPnNxbC0+VXBkYXRlKCR0aGlzLT50YWJsZSwgJGt2MywgYXJyYXkoYXJyYXkoJz0nLCAkdGhpcy0+ZGF0YWluZm9bJ05hbWUnXVswXSwgJG5hbWUpLCBhcnJheSgnPScsICR0aGlzLT5kYXRhaW5mb1snS2V5J11bMF0sICRrZXkzKSkpOw0KICAgICAgICAgICAgICAgICR0aGlzLT5kYi0+VXBkYXRlKCRzcWwpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIC8vbW9kDQogICAgICAgIGZvcmVhY2ggKCRtb2QgYXMgJGtleTIgPT4gJHZhbHVlMikgew0KICAgICAgICAgICAgJGt2MiA9IGFycmF5KCR0aGlzLT5kYXRhaW5mb1snTmFtZSddWzBdID0+ICRuYW1lLCAkdGhpcy0+ZGF0YWluZm9bJ0tleSddWzBdID0+ICRrZXkyLCAkdGhpcy0+ZGF0YWluZm9bJ1ZhbHVlJ11bMF0gPT4gJHRoaXMtPlNlcmlhbGl6ZVNpbmdsZSgkdmFsdWUyKSk7DQogICAgICAgICAgICAkc3FsID0gJHRoaXMtPmRiLT5zcWwtPkluc2VydCgkdGhpcy0+dGFibGUsICRrdjIpOw0KICAgICAgICAgICAgJG9sZCA9ICR0aGlzLT5kYi0+UXVlcnkoJHRoaXMtPmRiLT5zcWwtPlNlbGVjdCgkdGhpcy0+dGFibGUsICcqJywgYXJyYXkoYXJyYXkoJz0nLCAkdGhpcy0+ZGF0YWluZm9bJ05hbWUnXVswXSwgJG5hbWUpLCBhcnJheSgnPScsICR0aGlzLT5kYXRhaW5mb1snS2V5J11bMF0sICRrZXkyKSkpKTsNCiAgICAgICAgICAgIGlmIChjb3VudCgkb2xkKSA9PSAwKSB7DQogICAgICAgICAgICAgICAgJHRoaXMtPmRiLT5JbnNlcnQoJHNxbCk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICRrZXkzID0gJGtleTI7DQogICAgICAgICAgICAgICAgJHZhbHVlMyA9ICR2YWx1ZTI7DQogICAgICAgICAgICAgICAgJGt2MyA9IGFycmF5KCR0aGlzLT5kYXRhaW5mb1snVmFsdWUnXVswXSA9PiAkdGhpcy0+U2VyaWFsaXplU2luZ2xlKCR2YWx1ZTMpKTsNCiAgICAgICAgICAgICAgICAkc3FsID0gJHRoaXMtPmRiLT5zcWwtPlVwZGF0ZSgkdGhpcy0+dGFibGUsICRrdjMsIGFycmF5KGFycmF5KCc9JywgJHRoaXMtPmRhdGFpbmZvWydOYW1lJ11bMF0sICRuYW1lKSwgYXJyYXkoJz0nLCAkdGhpcy0+ZGF0YWluZm9bJ0tleSddWzBdLCAka2V5MykpKTsNCiAgICAgICAgICAgICAgICAkdGhpcy0+ZGItPlVwZGF0ZSgkc3FsKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICAvL2RlbA0KICAgICAgICBmb3JlYWNoICgkZGVsIGFzICRrZXk0ID0+ICR2YWx1ZTQpIHsNCiAgICAgICAgICAgICRzcWwgPSAkdGhpcy0+ZGItPnNxbC0+RGVsZXRlKCR0aGlzLT50YWJsZSwgYXJyYXkoYXJyYXkoJz0nLCAkdGhpcy0+ZGF0YWluZm9bJ05hbWUnXVswXSwgJG5hbWUpLCBhcnJheSgnPScsICR0aGlzLT5kYXRhaW5mb1snS2V5J11bMF0sICRrZXk0KSkpOw0KICAgICAgICAgICAgJHRoaXMtPmRiLT5EZWxldGUoJHNxbCk7DQogICAgICAgIH0NCiAgICAgICAgLy92YXJfZHVtcCgkYWRkLCRkZWwsJG1vZCk7ZGllOw0KICAgICAgICAkdGhpcy0+ZGItPlRyYW5zYWN0aW9uKCdjb21taXQnKTsNCiAgICAgICAgLy/lrZjlgqjmiJDlip/lkI7ph43nva5vcmlna3ZkYXRhDQogICAgICAgICR0aGlzLT5vcmlna3ZkYXRhID0gJHRoaXMtPmt2ZGF0YTsNCg0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDliKDpmaTmlbDmja4NCiAgICAgKiBEZWxldGXooajnpLrku47mlbDmja7lupPliKDpmaQNCiAgICAgKiDku44kemJw5Y+K5pWw5o2u5bqT5Lit5Yig6Zmk6K+l5a6e5L6LQ29uZmln5pWw5o2uLg0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIERlbGV0ZSgpDQogICAgew0KICAgICAgICBnbG9iYWwgJHpicDsNCiAgICAgICAgJG5hbWUgPSAkdGhpcy0+R2V0SXRlbU5hbWUoKTsNCiAgICAgICAgJHNxbCA9ICR0aGlzLT5kYi0+c3FsLT5EZWxldGUoJHRoaXMtPnRhYmxlLCBhcnJheShhcnJheSgnPScsICR0aGlzLT5kYXRhaW5mb1snTmFtZSddWzBdLCAkbmFtZSkpKTsNCiAgICAgICAgJHRoaXMtPmRiLT5EZWxldGUoJHNxbCk7DQogICAgICAgIHVuc2V0KCR6YnAtPmNvbmZpZ3NbJG5hbWVdKTsNCg0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiB0b1N0cmluZy4NCiAgICAgKg0KICAgICAqIOWwhkJhc2Xlr7nlg4/ov5Tlm55KU09O5pWw5o2uDQogICAgICoNCiAgICAgKiBAcmV0dXJuIHN0cmluZw0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBfX3RvU3RyaW5nKCkNCiAgICB7DQogICAgICAgIHJldHVybiAoc3RyaW5nKSBqc29uX2VuY29kZSgkdGhpcy0+a3ZkYXRhKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmt7vliqBvcuS/ruaUuUtleS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSAkbmFtZQ0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEFkZEtleSgkbmFtZSwgJHZhbHVlKQ0KICAgIHsNCiAgICAgICAgJG5hbWUgPSBGaWx0ZXJDb3JyZWN0TmFtZSgkbmFtZSk7DQogICAgICAgIGlmICghJG5hbWUpIHsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KICAgICAgICAkdGhpcy0+a3ZkYXRhWyRuYW1lXSA9ICR2YWx1ZTsNCg0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDliKDpmaRLZXnvvIzkuI3mjqjojZDkvb/nlKhEZWwoJG5hbWUpLg0KICAgICAqDQogICAgICogQHBhcmFtICRuYW1lDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gRGVsS2V5KCRuYW1lKQ0KICAgIHsNCiAgICAgICAgJG5hbWUgPSBGaWx0ZXJDb3JyZWN0TmFtZSgkbmFtZSk7DQogICAgICAgIGlmICghaXNzZXQoJHRoaXMtPmt2ZGF0YVskbmFtZV0pKSB7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCg0KICAgICAgICB1bnNldCgkdGhpcy0+a3ZkYXRhWyRuYW1lXSk7DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQp9DQo=</file>
</files>