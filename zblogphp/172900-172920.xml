<files codepage='65001' xmlns:dt='urn:schemas-microsoft-com:datatypes'>
	<file name='zb_system\function\lib\metas.php' crc32='1E566597'  dt:dt='bin.base64'>PD9waHANCg0KaWYgKCFkZWZpbmVkKCdaQlBfUEFUSCcpKSB7DQogICAgZXhpdCgnQWNjZXNzIGRlbmllZCcpOw0KfQ0KDQovKioNCiAqIOaJqeWxleWGheWuueexuy4NCiAqDQogKiBAcHJvcGVydHkgc3RyaW5nIE5hbWUNCiAqIEBwcm9wZXJ0eSBpbnR8c3RyaW5nIENvdW50DQogKiBAcHJvcGVydHkgc3RyaW5nIFVybA0KICovDQpjbGFzcyBNZXRhcw0Kew0KDQogICAgLyoqDQogICAgICogQHZhciBhcnJheSDlrZjlgqhNZXRhc+ebuOW6lOaVsOWAvOeahOaVsOe7hA0KICAgICAqLw0KICAgIHByaXZhdGUgJHBfZGF0YSA9IGFycmF5KCk7DQoNCiAgICAvKioNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRuYW1lIGtleeWQjQ0KICAgICAqIEBwYXJhbSAkdmFsdWUNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gX19zZXQoJG5hbWUsICR2YWx1ZSkNCiAgICB7DQogICAgICAgICR0aGlzLT5wX2RhdGFbJG5hbWVdID0gJHZhbHVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUga2V55ZCNDQogICAgICoNCiAgICAgKiBAcmV0dXJuIG51bGwNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gX19nZXQoJG5hbWUpDQogICAgew0KICAgICAgICBpZiAoIWlzc2V0KCR0aGlzLT5wX2RhdGFbJG5hbWVdKSkgew0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICR0aGlzLT5wX2RhdGFbJG5hbWVdOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBwYXJhbSAkbmFtZQ0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIF9faXNzZXQoJG5hbWUpDQogICAgew0KICAgICAgICByZXR1cm4gaXNzZXQoJHRoaXMtPnBfZGF0YVskbmFtZV0pOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBwYXJhbSAkbmFtZQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBfX3Vuc2V0KCRuYW1lKQ0KICAgIHsNCiAgICAgICAgdW5zZXQoJHRoaXMtPnBfZGF0YVskbmFtZV0pOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWwhuaVsOe7hOaVsOaNrui9rOaNouS4uk1ldGFz5a6e5L6LLg0KICAgICAqDQogICAgICogQHBhcmFtIGFycmF5ICRhDQogICAgICoNCiAgICAgKiBAcmV0dXJuIE1ldGFzDQogICAgICovDQogICAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiBDb252ZXJ0QXJyYXkoJGEpDQogICAgew0KICAgICAgICAkbSA9IG5ldyBzZWxmKCk7DQogICAgICAgIGlmIChpc19hcnJheSgkYSkpIHsNCiAgICAgICAgICAgICRtLT5wX2RhdGEgPSAkYTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAkbTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDojrflj5ZEYXRh5pWw5o2uLg0KICAgICAqDQogICAgICogQHJldHVybiBhcnJheQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXREYXRhKCkNCiAgICB7DQogICAgICAgIHJldHVybiAkdGhpcy0+cF9kYXRhOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOS+neaNrnpicOiuvue9ruabv+aNouetvuagh+S4umhvc3TlgLzmiJbmmK/lm7rlrprln5/lkI0uDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICR2YWx1ZQ0KICAgICAqDQogICAgICogQHJldHVybiBzdHJpbmcNCiAgICAgKi8NCiAgICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIFJlcGxhY2VUYWcySG9zdCgkdmFsdWUpDQogICAgew0KICAgICAgICBnbG9iYWwgJGJsb2dob3N0Ow0KDQogICAgICAgIHJldHVybiBzdHJfcmVwbGFjZSgneyNaQ19CTE9HX0hPU1QjfScsICRibG9naG9zdCwgJHZhbHVlKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDkvp3mja56YnDorr7nva7mm7/mjaJob3N05YC85Li6562+5qCHLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkdmFsdWUNCiAgICAgKg0KICAgICAqIEByZXR1cm4gc3RyaW5nDQogICAgICovDQogICAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiBSZXBsYWNlSG9zdDJUYWcoJHZhbHVlKQ0KICAgIHsNCiAgICAgICAgZ2xvYmFsICRibG9naG9zdDsNCg0KICAgICAgICByZXR1cm4gc3RyX3JlcGxhY2UoJGJsb2dob3N0LCAneyNaQ19CTE9HX0hPU1QjfScsICR2YWx1ZSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5qOA5p+lRGF0YeWxnuaAp++8iOaVsOe7hO+8ieWxnuaAp+WAvOaYr+aYr+WQpuWtmOWcqOebuOW6lGtleS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUga2V55ZCNDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gSGFzS2V5KCRuYW1lKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuIGFycmF5X2tleV9leGlzdHMoJG5hbWUsICR0aGlzLT5wX2RhdGEpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOajgOafpURhdGHlsZ7mgKfvvIjmlbDnu4TvvInkuK3nmoTljZXlhYPmlbDnm64uDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGludA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBDb3VudEl0ZW0oKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuIGNvdW50KCR0aGlzLT5wX2RhdGEpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWIoOmZpERhdGHlsZ7mgKfvvIjmlbDnu4TvvInkuK3nmoTnm7jlupTpobkuDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRuYW1lIGtleeWQjQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBEZWwoJG5hbWUpDQogICAgew0KICAgICAgICB1bnNldCgkdGhpcy0+cF9kYXRhWyRuYW1lXSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5bCGRGF0YeWxnuaAp++8iOaVsOe7hO+8ieWAvOW6j+WIl+WMli4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gc3RyaW5nIOi/lOWbnuW6j+WIl+WMlueahOWAvA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBTZXJpYWxpemUoKQ0KICAgIHsNCiAgICAgICAgaWYgKGNvdW50KCR0aGlzLT5wX2RhdGEpID09IDApIHsNCiAgICAgICAgICAgIHJldHVybiAnJzsNCiAgICAgICAgfQ0KDQogICAgICAgICRkYXRhID0gJHRoaXMtPnBfZGF0YTsNCiAgICAgICAgZm9yZWFjaCAoJGRhdGEgYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgICAgIGlmIChpc19zdHJpbmcoJHZhbHVlKSkgew0KICAgICAgICAgICAgICAgICRkYXRhWyRrZXldID0gc2VsZjo6UmVwbGFjZUhvc3QyVGFnKCR2YWx1ZSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAvL3JldHVybiBqc29uX2VuY29kZSgkZGF0YSk7DQogICAgICAgIHJldHVybiBzZXJpYWxpemUoJGRhdGEpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWwhuW6j+WIl+WMlueahOWAvOWPjeW6j+WIl+WMluWQjui1i+S6iERhdGHlsZ7mgKflgLwNCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHMg5bqP5YiX5YyW5YC8DQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gVW5zZXJpYWxpemUoJHMpDQogICAgew0KICAgICAgICBpZiAoJHMgPT0gJycpIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vaWYoc3RycG9zKCRzLCd7Jyk9PT0wKXsNCiAgICAgICAgLy8kdGhpcy0+cF9kYXRhPWpzb25fZGVjb2RlKCRzLHRydWUpOw0KICAgICAgICAvL31lbHNlew0KICAgICAgICBAJHRoaXMtPnBfZGF0YSA9IHVuc2VyaWFsaXplKCRzKTsNCiAgICAgICAgLy99DQogICAgICAgIGlmIChpc19hcnJheSgkdGhpcy0+cF9kYXRhKSkgew0KICAgICAgICAgICAgaWYgKGNvdW50KCR0aGlzLT5wX2RhdGEpID09IDApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgZm9yZWFjaCAoJHRoaXMtPnBfZGF0YSBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAgICAgICAgIGlmIChpc19zdHJpbmcoJHZhbHVlKSkgew0KICAgICAgICAgICAgICAgICAgICAkdGhpcy0+cF9kYXRhWyRrZXldID0gc2VsZjo6UmVwbGFjZVRhZzJIb3N0KCR2YWx1ZSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJHRoaXMtPnBfZGF0YSA9IGFycmF5KCk7DQoNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KfQ0K</file>
	<file name='zb_system\function\lib\zblogphp.php' crc32='F02841EB'  dt:dt='bin.base64'>PD9waHANCg0KaWYgKCFkZWZpbmVkKCdaQlBfUEFUSCcpKSB7DQogICAgZXhpdCgnQWNjZXNzIGRlbmllZCcpOw0KfQ0KLyoqDQogKiB6YnDlhajlsYDmk43kvZznsbsuDQogKi8NCmNsYXNzIFpCbG9nUEhQDQp7DQoNCiAgICBwcml2YXRlIHN0YXRpYyAkcHJpdmF0ZV96YnAgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcg54mI5pys5Y+3DQogICAgICovDQogICAgcHVibGljICR2ZXJzaW9uID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgRGF0YWJhc2VfX0ludGVyZmFjZSDmlbDmja7lupMNCiAgICAgKi8NCiAgICBwdWJsaWMgJGRiID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgYXJyYXkg6YWN572u6YCJ6aG5DQogICAgICovDQogICAgcHVibGljICRvcHRpb24gPSBhcnJheSgpOw0KDQogICAgLyoqDQogICAgICogQHZhciBhcnJheSDor63oqIANCiAgICAgKi8NCiAgICBwdWJsaWMgJGxhbmcgPSBhcnJheSgpOw0KDQogICAgLyoqDQogICAgICogQHZhciBqc29u57G75Z6LIOivreiogA0KICAgICAqLw0KICAgIHB1YmxpYyAkbGFuZ3MgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBhcnJheSDor63oqIDljIVsaXN0DQogICAgICovDQogICAgcHVibGljICRsYW5ncGFja2xpc3QgPSBhcnJheSgpOw0KDQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcg6Lev5b6EDQogICAgICovDQogICAgcHVibGljICRwYXRoID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nIOWfn+WQjQ0KICAgICAqLw0KICAgIHB1YmxpYyAkaG9zdCA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIHN0cmluZyBjb29raWXkvZznlKjln58NCiAgICAgKi8NCiAgICBwdWJsaWMgJGNvb2tpZXNwYXRoID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nIGd1aWQNCiAgICAgKi8NCiAgICBwdWJsaWMgJGd1aWQgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcg5b2T5YmN6ZO+5o6lDQogICAgICovDQogICAgcHVibGljICRjdXJyZW50dXJsID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nIOW9k+WJjemTvuaOpQ0KICAgICAqLw0KICAgIHB1YmxpYyAkZnVsbGN1cnJlbnR1cmwgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcgU3lzdGVt55uu5b2VDQogICAgICovDQogICAgcHVibGljICRzeXN0ZW1kaXIgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcgQWRtaW7nm67lvZUNCiAgICAgKi8NCiAgICBwdWJsaWMgJGFkbWluZGlyID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nIOeUqOaIt+ebruW9lQ0KICAgICAqLw0KICAgIHB1YmxpYyAkdXNlcnNkaXIgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcgU3lzdGVtIFVybA0KICAgICAqLw0KICAgIHB1YmxpYyAkc3lzdGVtdXJsID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nIEFkbWluIFVybA0KICAgICAqLw0KICAgIHB1YmxpYyAkYWRtaW51cmwgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcg55So5oi3VXJsDQogICAgICovDQogICAgcHVibGljICR1c2Vyc3VybCA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIHN0cmluZyBDYWNoZeebruW9lQ0KICAgICAqLw0KICAgIHB1YmxpYyAkY2FjaGVkaXIgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcgTG9nc+ebruW9lQ0KICAgICAqLw0KICAgIHB1YmxpYyAkbG9nc2RpciA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIHN0cmluZyBEYXRh55uu5b2VDQogICAgICovDQogICAgcHVibGljICRkYXRhZGlyID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nIOmqjOivgeeggeWcsOWdgA0KICAgICAqLw0KICAgIHB1YmxpYyAkdmVyaWZ5Q29kZVVybCA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIHN0cmluZyDpqozor4HnoIHlnLDlnYDvvIjmi7zlhpnplJnor6/vvIkNCiAgICAgKg0KICAgICAqIEBkZXByZWNhdGVkDQogICAgICovDQogICAgcHVibGljICR2YWxpZGNvZGV1cmwgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcNCiAgICAgKi8NCiAgICBwdWJsaWMgJGZlZWR1cmwgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcNCiAgICAgKi8NCiAgICBwdWJsaWMgJHNlYXJjaHVybCA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIHN0cmluZw0KICAgICAqLw0KICAgIHB1YmxpYyAkYWpheHVybCA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIHN0cmluZw0KICAgICAqLw0KICAgIHB1YmxpYyAkeG1scnBjdXJsID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nDQogICAgICovDQogICAgcHVibGljICRhcGl1cmwgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcNCiAgICAgKi8NCiAgICBwdWJsaWMgJGNtZHVybCA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIE1lbWJlcltdIOeUqOaIt+aVsOe7hA0KICAgICAqLw0KICAgIHB1YmxpYyAkbWVtYmVycyA9IGFycmF5KCk7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIE1lbWJlcltdIOeUqOaIt+aVsOe7hO+8iOS7peeUqOaIt+WQjeS4uumUru+8iQ0KICAgICAqLw0KICAgIHB1YmxpYyAkbWVtYmVyc2J5bmFtZSA9IGFycmF5KCk7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIENhdGVnb3J5W10g5YiG57G75pWw57uEICgkY2F0ZWdvcnlz5bey5bqf5byDKQ0KICAgICAqLw0KICAgIHB1YmxpYyAkY2F0ZWdvcnlzID0gYXJyYXkoKTsNCg0KICAgIHB1YmxpYyAkY2F0ZWdvcmllcyA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIENhdGVnb3J5W10g5YiG57G75pWw57uEQUxMDQogICAgICovDQogICAgcHVibGljICRjYXRlZ29yaWVzX2FsbCA9IGFycmF5KCk7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIENhdGVnb3J5W10g5YiG57G75pWw57uE77yI5bey5o6S5bqP77yJICgkY2F0ZWdvcnlzYnlvcmRlcuW3suW6n+W8gykgIGNhdGVnb3JpZXPlvJXnlKgNCiAgICAgKi8NCiAgICBwdWJsaWMgJGNhdGVnb3J5c2J5b3JkZXIgPSBhcnJheSgpOw0KDQogICAgcHVibGljICRjYXRlZ29yaWVzYnlvcmRlciA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIENhdGVnb3J5W10g5oyJ57G75Z6L5YiG57G755qEMue7tOaVsOe7hCAvL+acrOi6q+aXoOaEj+S5ieS6hu+8jOeOsOW8leeUqOiHqiRjYXRlZ29yaWVzYnlvcmRlcl90eXBlDQogICAgICovDQogICAgcHVibGljICRjYXRlZ29yaWVzX3R5cGUgPSBhcnJheSgpOw0KDQogICAgLyoqDQogICAgICogQHZhciBDYXRlZ29yeVtdIOaMieexu+Wei+WIhuexuzLnu7TmlbDnu4TvvIjlt7LmjpLluo/vvIljYXRlZ29yaWVzX3R5cGXlvJXnlKgNCiAgICAgKi8NCiAgICBwdWJsaWMgJGNhdGVnb3JpZXNieW9yZGVyX3R5cGUgPSBhcnJheSgpOw0KDQogICAgLyoqDQogICAgICogQHZhciBNb2R1bGVbXSDmqKHlnZfmlbDnu4QNCiAgICAgKi8NCiAgICBwdWJsaWMgJG1vZHVsZXMgPSBhcnJheSgpOw0KDQogICAgLyoqDQogICAgICogQHZhciBNb2R1bGVbXSDmqKHlnZfmlbDnu4TvvIjku6Xmlofku7blkI3kuLrplK7vvIkNCiAgICAgKi8NCiAgICBwdWJsaWMgJG1vZHVsZXNieWZpbGVuYW1lID0gYXJyYXkoKTsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgQ29uZmlnW10g6YWN572u6YCJ6aG5DQogICAgICovDQogICAgcHVibGljICRjb25maWdzID0gYXJyYXkoKTsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgVGFnW10g5qCH562+5pWw57uEDQogICAgICovDQogICAgcHVibGljICR0YWdzID0gYXJyYXkoKTsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgVGFnW10g5qCH562+5pWw57uE77yI5Lul5qCH562+5ZCN5Li66ZSu77yJDQogICAgICovDQogICAgcHVibGljICR0YWdzYnluYW1lID0gYXJyYXkoKTsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgYXJyYXkg5qCH562+5pWw57uEIEFMTA0KICAgICAqLw0KICAgIHB1YmxpYyAkdGFnc19hbGwgPSBhcnJheSgpOw0KDQogICAgLyoqDQogICAgICogQHZhciBhcnJheSDmoIfnrb7mlbDnu4QgQnkgVHlwZSAy57u05pWw57uEDQogICAgICovDQogICAgcHVibGljICR0YWdzX3R5cGUgPSBhcnJheSgpOw0KDQogICAgLyoqDQogICAgICogQHZhciBhcnJheSDmoIfnrb7mlbDnu4QgQnkgVHlwZe+8iOS7peagh+etvuWQjeS4uumUru+8iTLnu7TmlbDnu4QNCiAgICAgKi8NCiAgICBwdWJsaWMgJHRhZ3NieW5hbWVfdHlwZSA9IGFycmF5KCk7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIENvbW1lbnRbXSDor4TorrrmlbDnu4QNCiAgICAgKi8NCiAgICBwdWJsaWMgJGNvbW1lbnRzID0gYXJyYXkoKTsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgUG9zdFtdIOaWh+eroOWIl+ihqOaVsOe7hA0KICAgICAqLw0KICAgIHB1YmxpYyAkcG9zdHMgPSBhcnJheSgpOw0KDQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcg5b2T5YmN6aG16Z2i5qCH6aKYDQogICAgICovDQogICAgcHVibGljICR0aXRsZSA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIHN0cmluZyDnvZHnq5nlkI0NCiAgICAgKi8NCiAgICBwdWJsaWMgJG5hbWUgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcg572R56uZ5a2Q5qCH6aKYDQogICAgICovDQogICAgcHVibGljICRzdWJuYW1lID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgQXBwIOW9k+WJjeS4u+mimA0KICAgICAqLw0KICAgIHB1YmxpYyAkdGhlbWUgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBhcnJheSgpIOW9k+WJjeS4u+mimOeJiOacrOS/oeaBrw0KICAgICAqLw0KICAgIHB1YmxpYyAkdGhlbWVpbmZvID0gYXJyYXkoKTsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nIOW9k+WJjeS4u+mimOmjjuagvA0KICAgICAqLw0KICAgIHB1YmxpYyAkc3R5bGUgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBNZW1iZXIg5b2T5YmN55So5oi3DQogICAgICovDQogICAgcHVibGljICR1c2VyID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgQ29uZmlnIOe8k+WtmA0KICAgICAqLw0KICAgIHB1YmxpYyAkY2FjaGUgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBhcnJheXxudWxsIOaVsOaNruihqA0KICAgICAqLw0KICAgIHB1YmxpYyAkdGFibGUgPSBudWxsOw0KDQogICAgcHVibGljICR0ID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgYXJyYXl8bnVsbCDmlbDmja7ooajkv6Hmga8NCiAgICAgKi8NCiAgICBwdWJsaWMgJGRhdGFpbmZvID0gbnVsbDsNCg0KICAgIHB1YmxpYyAkZCA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIGFycmF5fG51bGwg57G75Z6L5bqP5YiXDQogICAgICovDQogICAgcHVibGljICRwb3N0dHlwZSA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIGFycmF5fG51bGwg5pON5L2c5YiX6KGoDQogICAgICovDQogICAgcHVibGljICRhY3Rpb25zID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgbWl4ZWR8bnVsbHxzdHJpbmcg5b2T5YmN5pON5L2cDQogICAgICovDQogICAgcHVibGljICRhY3Rpb24gPSBudWxsOw0KDQogICAgcHJpdmF0ZSAkaXNpbml0aWFsaXplZCA9IGZhbHNlOyAvL+aYr+WQpuWIneWni+WMluaIkOWKnw0KDQogICAgcHJpdmF0ZSAkaXNjb25uZWN0ZWQgPSBmYWxzZTsgLy/mmK/lkKbov57mjqXmiJDlip8NCg0KICAgIHByaXZhdGUgJGlzbG9hZCA9IGZhbHNlOyAvL+aYr+WQpui9veWFpQ0KDQogICAgcHJpdmF0ZSAkaXNwcmVsb2FkID0gZmFsc2U7IC8v5piv5ZCm6aKE5Yqg6L29DQoNCiAgICBwcml2YXRlICRpc3Nlc3Npb24gPSBmYWxzZTsgLy/mmK/lkKbkvb/nlKhzZXNzaW9uDQoNCiAgICBwdWJsaWMgJGlzbWFuYWdlID0gZmFsc2U7IC8v5piv5ZCm5Yqg6L29566h55CG5qih5byPDQoNCiAgICBwdWJsaWMgJGlzYXBpID0gZmFsc2U7IC8v5piv5ZCm5Yqg6L29QVBJ5qih5byPDQoNCiAgICBwdWJsaWMgJGlzY21kID0gZmFsc2U7IC8v5piv5ZCm5Yqg6L29Q01E5qih5byPDQoNCiAgICBwdWJsaWMgJGlzYWpheCA9IGZhbHNlOyAvL+aYr+WQpuWKoOi9vUFKQVjmqKHlvI8NCg0KICAgIHB1YmxpYyAkaXN4bWxycGMgPSBmYWxzZTsgLy/mmK/lkKbliqDovb1YTUwtUlBD5qih5byPDQoNCiAgICBwdWJsaWMgJGlzaHR0cHMgPSBmYWxzZTsgLy/pk77mjqXoh7Npc0h0dHBzDQoNCiAgICBwdWJsaWMgJGlzSHR0cHMgPSBmYWxzZTsgLy/mmK/lkKZIVFRQUw0KDQogICAgcHVibGljICRpc2RlYnVnID0gZmFsc2U7IC8v5piv5ZCmRGVidWcgTW9kZQ0KDQogICAgcHVibGljICRpc2xvZ2luID0gZmFsc2U7IC8v5piv5ZCmTG9naW4NCg0KICAgIC8qKg0KICAgICAqIEB2YXIgVGVtcGxhdGUg5b2T5YmN5qih5p2/DQogICAgICovDQogICAgcHVibGljICR0ZW1wbGF0ZSA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIG51bGwg56S+5Lya5YyW6K+E6K66DQogICAgICovDQogICAgcHVibGljICRzb2NpYWxjb21tZW50ID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgbnVsbCDmqKHmnb/lpLTpg6gNCiAgICAgKi8NCiAgICBwdWJsaWMgJGhlYWRlciA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIG51bGwg5qih5p2/5bC+6YOoDQogICAgICovDQogICAgcHVibGljICRmb290ZXIgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBhcnJheSDmv4DmtLvnmoTmj5Lku7bliJfooagNCiAgICAgKi8NCiAgICBwdWJsaWMgJGFjdGl2ZWRhcHBzID0gYXJyYXkoKTsNCg0KICAgIHB1YmxpYyAkYWN0aXZlYXBwczsNCg0KICAgIHB1YmxpYyAkY29va2llX3Rvb2tlbl9odHRwb25seSA9IHRydWU7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIGludCDnrqHnkIbpobXpnaLmmL7npLrmnaHmlbANCiAgICAgKi8NCiAgICBwdWJsaWMgJG1hbmFnZWNvdW50ID0gNTA7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIGludCDpobXnoIHmmL7npLrmnaHmlbANCiAgICAgKi8NCiAgICBwdWJsaWMgJHBhZ2ViYXJjb3VudCA9IDEwOw0KDQogICAgLyoqDQogICAgICogQHZhciBpbnQg5pCc57Si6L+U5Zue5p2h5pWwDQogICAgICovDQogICAgcHVibGljICRzZWFyY2hjb3VudCA9IDEwOw0KDQogICAgLyoqDQogICAgICogQHZhciBpbnQg5paH56ug5YiX6KGo5pi+56S65p2h5pWwDQogICAgICovDQogICAgcHVibGljICRkaXNwbGF5Y291bnQgPSAxMDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgaW50IOivhOiuuuaYvuekuuaVsOmHjw0KICAgICAqLw0KICAgIHB1YmxpYyAkY29tbWVudGRpc3BsYXljb3VudCA9IDEwOw0KDQogICAgLyoqDQogICAgICogQHZhciBpbnQgQVBJIOavj+mhteacgOWkmuadoeaVsA0KICAgICAqLw0KICAgIHB1YmxpYyAkYXBpTWF4Q291bnRQZXJQYWdlID0gNTA7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIGludCDlvZPliY3lrp7kvovkuItDU1JGIFRva2Vu6L+H5pyf5pe26Ze077yI5bCP5pe277yJDQogICAgICovDQogICAgcHVibGljICRjc3JmRXhwaXJhdGlvbiA9IDE7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIEFwcCDlvZPliY3kuLvpopjnsbsNCiAgICAgKi8NCiAgICBwdWJsaWMgJHRoZW1lYXBwID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgaW50IOWIhuexu+acgOWkp+mAkuW9kuWxguaVsA0KICAgICAqLw0KICAgIHB1YmxpYyAkY2F0ZWdvcnlfcmVjdXJzaW9uX2xldmVsID0gNTsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgaW50IOWIhuexu+WunumZhemAkuW9kuWxguaVsA0KICAgICAqLw0KICAgIHB1YmxpYyAkY2F0ZWdvcnlfcmVjdXJzaW9uX3JlYWxfZGVlcCA9IDA7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIGludCDor4TorrrmnIDlpKfpgJLlvZLlsYLmlbANCiAgICAgKi8NCiAgICBwdWJsaWMgJGNvbW1lbnRfcmVjdXJzaW9uX2xldmVsID0gNDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgaHRtbCBqcyBoYXNoICjkvb/nlKjml7bor7fnlKjigJzov73liqDigJ3ljrvmt7vliqDoh6rlt7HnmoRoYXNoKQ0KICAgICAqLw0KICAgIHB1YmxpYyAkaHRtbF9qc19oYXNoID0gJyc7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIGFkbWluIGpzIGhhc2ggKOS9v+eUqOaXtuivt+eUqOKAnOi/veWKoOKAneWOu+a3u+WKoOiHquW3seeahGhhc2gpDQogICAgICovDQogICAgcHVibGljICRhZG1pbl9qc19oYXNoID0gJyc7DQoNCiAgICAvL+m7mOiupOi3r+eUsXVybOaVsOe7hA0KICAgIHB1YmxpYyAkcm91dGVzID0gYXJyYXkoKTsNCg0KICAgIC8v5oC757yT5a2Y5a+56LGhDQogICAgcHVibGljICRjYWNoZW9iamVjdCA9IGFycmF5KCk7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIHN0cmluZyDorr7lrprkuLvpopjkuIvnmoTmqKHmnb/oh6rliqjloavlhYXnvLrlpLHnmoRodG1s5qCH562+KOm7mOiupOaYr3RydWUpDQogICAgICovDQogICAgcHVibGljICRhdXRvZmlsbF90ZW1wbGF0ZV9odG1sdGFncyA9IHRydWU7DQoNCiAgICBjb25zdCBPUFRJT05fUkVTRVJWRV9LRVlTID0gJ1pDX0RBVEFCQVNFX1RZUEV8WkNfU1FMSVRFX05BTUV8WkNfU1FMSVRFX1BSRXxaQ19NWVNRTF9TRVJWRVJ8WkNfTVlTUUxfVVNFUk5BTUV8WkNfTVlTUUxfUEFTU1dPUkR8WkNfTVlTUUxfTkFNRXxaQ19NWVNRTF9DSEFSU0VUfFpDX01ZU1FMX0NPTExBVEV8WkNfTVlTUUxfUFJFfFpDX01ZU1FMX0VOR0lORXxaQ19NWVNRTF9QT1JUfFpDX01ZU1FMX1BFUlNJU1RFTlR8WkNfTVlTUUxfUE9SVHxaQ19QR1NRTF9TRVJWRVJ8WkNfUEdTUUxfVVNFUk5BTUV8WkNfUEdTUUxfUEFTU1dPUkR8WkNfUEdTUUxfTkFNRXxaQ19QR1NRTF9DSEFSU0VUfFpDX1BHU1FMX1BSRXxaQ19QR1NRTF9QT1JUfFpDX1BHU1FMX1BFUlNJU1RFTlR8WkNfQ0xPU0VfV0hPTEVfU0lURXxaQ19QRVJNQU5FTlRfRE9NQUlOX0ZPUkNFRF9VUkx8WkNfUEVSTUFORU5UX0RPTUFJTl9XSE9MRV9ESVNBQkxFJzsNCg0KICAgIC8qKg0KICAgICAqIOiOt+WPluWUr+S4gOWunuS+iy4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gbnVsbHxaQmxvZ1BIUA0KICAgICAqLw0KICAgIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gR2V0SW5zdGFuY2UoKQ0KICAgIHsNCiAgICAgICAgaWYgKCFpc3NldChzZWxmOjokcHJpdmF0ZV96YnApKSB7DQogICAgICAgICAgICBpZiAoaXNzZXQoJEdMT0JBTFNbJ29wdGlvbiddWydaQ19HT0RaQlBfRklMRSddKSAmJiBpc3NldCgkR0xPQkFMU1snb3B0aW9uJ11bJ1pDX0dPRFpCUF9OQU1FJ10pICYmIGlzX3JlYWRhYmxlKFpCUF9QQVRIIC4gJEdMT0JBTFNbJ29wdGlvbiddWydaQ19HT0RaQlBfRklMRSddKSkgew0KICAgICAgICAgICAgICAgIGluY2x1ZGUgWkJQX1BBVEggLiAkR0xPQkFMU1snb3B0aW9uJ11bJ1pDX0dPRFpCUF9GSUxFJ107DQogICAgICAgICAgICAgICAgc2VsZjo6JHByaXZhdGVfemJwID0gbmV3ICRHTE9CQUxTWydvcHRpb24nXVsnWkNfR09EWkJQX05BTUUnXSgpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBzZWxmOjokcHJpdmF0ZV96YnAgPSBuZXcgc2VsZigpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIHNlbGY6OiRwcml2YXRlX3picDsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDliJ3lp4vljJbmlbDmja7lupPov57mjqUuDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICR0eXBlIOaVsOaNrui/nuaOpeexu+Weiw0KICAgICAqDQogICAgICogQHJldHVybiBEYXRhYmFzZV9fSW50ZXJmYWNlDQogICAgICovDQogICAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiBJbml0aWFsaXplREIoJHR5cGUpDQogICAgew0KICAgICAgICBpZiAoIXRyaW0oJHR5cGUpKSB7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCg0KICAgICAgICAkbmV3dHlwZSA9ICdEYXRhYmFzZV9fJyAuIHRyaW0oJHR5cGUpOw0KDQogICAgICAgIHJldHVybiBuZXcgJG5ld3R5cGUoKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmnoTpgKDlh73mlbDvvIzliqDovb3ln7rmnKzphY3nva7liLAkemJwLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBfX2NvbnN0cnVjdCgpDQogICAgew0KICAgICAgICBnbG9iYWwgJG9wdGlvbiwgJGxhbmcsICRsYW5ncywgJGJsb2dwYXRoLCAkYmxvZ2hvc3QsICRjb29raWVzcGF0aCwgICRjYWNoZWRpciwgJGxvZ3NkaXIsICRkYXRhZGlyLA0KICAgICAgICAgICAgJHRhYmxlLCAkZGF0YWluZm8sICRhY3Rpb25zLCAkYWN0aW9uLCAkYmxvZ3ZlcnNpb24sICRibG9ndGl0bGUsICRibG9nbmFtZSwgJGJsb2dzdWJuYW1lLCAkcm91dGVzLA0KICAgICAgICAgICAgJGJsb2d0aGVtZSwgJGJsb2dzdHlsZSwgJGN1cnJlbnR1cmwsICRhY3RpdmVkYXBwcywgJHBvc3R0eXBlLCAkZnVsbGN1cnJlbnR1cmwsDQogICAgICAgICAgICAkdXNlcnNkaXIsICRzeXN0ZW1kaXIsICRhZG1pbmRpciwgJHVzZXJzdXJsLCAkc3lzdGVtdXJsLCAkYWRtaW51cmw7DQoNCiAgICAgICAgaWYgKFpCUF9IT09LRVJST1IpIHsNCiAgICAgICAgICAgIFpCbG9nRXhjZXB0aW9uOjpTZXRFcnJvckhvb2soKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8v5Z+65pys6YWN572u5Yqg6L295YiwJHpicOWGhQ0KICAgICAgICAkdGhpcy0+dmVyc2lvbiA9ICYkYmxvZ3ZlcnNpb247DQogICAgICAgICR0aGlzLT5vcHRpb24gPSAmJG9wdGlvbjsNCiAgICAgICAgJHRoaXMtPmxhbmcgPSAmJGxhbmc7DQogICAgICAgICR0aGlzLT5sYW5ncyA9ICYkbGFuZ3M7DQogICAgICAgICR0aGlzLT5yb3V0ZXMgPSAmJHJvdXRlczsNCg0KICAgICAgICAkdGhpcy0+cGF0aCA9ICYkYmxvZ3BhdGg7DQogICAgICAgICR0aGlzLT5ob3N0ID0gJiRibG9naG9zdDsgLy/mraTlgLzlnKjlkI7ovrnliJ3lp4vljJbml7blj6/og73kvJrlj5jljJYhDQogICAgICAgICR0aGlzLT5jdXJyZW50dXJsID0gJiRjdXJyZW50dXJsOw0KICAgICAgICAkdGhpcy0+ZnVsbGN1cnJlbnR1cmwgPSAmJGZ1bGxjdXJyZW50dXJsOw0KICAgICAgICAkdGhpcy0+Y29va2llc3BhdGggPSAmJGNvb2tpZXNwYXRoOw0KICAgICAgICAkdGhpcy0+dXNlcnNkaXIgPSAmJHVzZXJzZGlyOw0KICAgICAgICAkdGhpcy0+Y2FjaGVkaXIgPSAmJGNhY2hlZGlyOw0KICAgICAgICAkdGhpcy0+bG9nc2RpciA9ICYkbG9nc2RpcjsNCiAgICAgICAgJHRoaXMtPmRhdGFkaXIgPSAmJGRhdGFkaXI7DQogICAgICAgICR0aGlzLT5zeXN0ZW1kaXIgPSAmJHN5c3RlbWRpcjsNCiAgICAgICAgJHRoaXMtPmFkbWluZGlyID0gJiRhZG1pbmRpcjsNCiAgICAgICAgJHRoaXMtPnVzZXJzdXJsID0gJiR1c2Vyc3VybDsNCiAgICAgICAgJHRoaXMtPnN5c3RlbXVybCA9ICYkc3lzdGVtdXJsOw0KICAgICAgICAkdGhpcy0+YWRtaW51cmwgPSAmJGFkbWludXJsOw0KDQogICAgICAgICR0aGlzLT50YWJsZSA9ICYkdGFibGU7DQogICAgICAgICR0aGlzLT5kYXRhaW5mbyA9ICYkZGF0YWluZm87DQogICAgICAgICR0aGlzLT50ID0gJiR0aGlzLT50YWJsZTsNCiAgICAgICAgJHRoaXMtPmQgPSAmJHRoaXMtPmRhdGFpbmZvOw0KICAgICAgICAkdGhpcy0+YWN0aW9ucyA9ICYkYWN0aW9uczsNCiAgICAgICAgJHRoaXMtPnBvc3R0eXBlID0gJiRwb3N0dHlwZTsNCg0KICAgICAgICAkdGhpcy0+YWN0aW9uID0gJiRhY3Rpb247DQogICAgICAgICR0aGlzLT5hY3RpdmVkYXBwcyA9ICYkYWN0aXZlZGFwcHM7DQogICAgICAgICR0aGlzLT5hY3RpdmVhcHBzID0gJiR0aGlzLT5hY3RpdmVkYXBwczsNCg0KICAgICAgICAkdGhpcy0+Z3VpZCA9ICYkdGhpcy0+b3B0aW9uWydaQ19CTE9HX0NMU0lEJ107DQoNCiAgICAgICAgJHRoaXMtPnRpdGxlID0gJiRibG9ndGl0bGU7DQogICAgICAgICR0aGlzLT5uYW1lID0gJiRibG9nbmFtZTsNCiAgICAgICAgJHRoaXMtPnN1Ym5hbWUgPSAmJGJsb2dzdWJuYW1lOw0KICAgICAgICAkdGhpcy0+dGhlbWUgPSAmJGJsb2d0aGVtZTsNCiAgICAgICAgJHRoaXMtPnN0eWxlID0gJiRibG9nc3R5bGU7DQoNCiAgICAgICAgJHRoaXMtPm1hbmFnZWNvdW50ID0gJiR0aGlzLT5vcHRpb25bJ1pDX01BTkFHRV9DT1VOVCddOw0KICAgICAgICAkdGhpcy0+cGFnZWJhcmNvdW50ID0gJiR0aGlzLT5vcHRpb25bJ1pDX1BBR0VCQVJfQ09VTlQnXTsNCiAgICAgICAgJHRoaXMtPnNlYXJjaGNvdW50ID0gJiR0aGlzLT5vcHRpb25bJ1pDX1NFQVJDSF9DT1VOVCddOw0KICAgICAgICAkdGhpcy0+ZGlzcGxheWNvdW50ID0gJiR0aGlzLT5vcHRpb25bJ1pDX0RJU1BMQVlfQ09VTlQnXTsNCiAgICAgICAgJHRoaXMtPmNvbW1lbnRkaXNwbGF5Y291bnQgPSAmJHRoaXMtPm9wdGlvblsnWkNfQ09NTUVOVFNfRElTUExBWV9DT1VOVCddOw0KDQogICAgICAgICR0aGlzLT5jYXRlZ29yaWVzYnlvcmRlcl90eXBlWzBdID0gYXJyYXkoKTsNCiAgICAgICAgJHRoaXMtPmNhdGVnb3JpZXNieW9yZGVyID0gJiR0aGlzLT5jYXRlZ29yaWVzYnlvcmRlcl90eXBlWzBdOw0KICAgICAgICAkdGhpcy0+Y2F0ZWdvcmllcyA9ICYkdGhpcy0+Y2F0ZWdvcmllc2J5b3JkZXI7DQogICAgICAgICR0aGlzLT5jYXRlZ29yeXMgPSAmJHRoaXMtPmNhdGVnb3JpZXM7DQogICAgICAgICR0aGlzLT5jYXRlZ29yeXNieW9yZGVyID0gJiR0aGlzLT5jYXRlZ29yaWVzYnlvcmRlcjsNCg0KICAgICAgICAkdGhpcy0+dGFnc190eXBlWzBdID0gYXJyYXkoKTsNCiAgICAgICAgJHRoaXMtPnRhZ3NieW5hbWVfdHlwZVswXSA9IGFycmF5KCk7DQogICAgICAgICR0aGlzLT50YWdzID0gJiR0aGlzLT50YWdzX3R5cGVbMF07DQogICAgICAgICR0aGlzLT50YWdzYnluYW1lID0gJiR0aGlzLT50YWdzYnluYW1lX3R5cGVbMF07DQoNCiAgICAgICAgJHRoaXMtPnVzZXIgPSBuZXcgc3RkQ2xhc3MoKTsNCiAgICAgICAgZm9yZWFjaCAoJHRoaXMtPmRhdGFpbmZvWydNZW1iZXInXSBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAgICAgJHRoaXMtPnVzZXItPiRrZXkgPSAkdmFsdWVbM107DQogICAgICAgIH0NCiAgICAgICAgJHRoaXMtPnVzZXItPk1ldGFzID0gbmV3IE1ldGFzKCk7DQoNCiAgICAgICAgJHRoaXMtPmlzaHR0cHMgPSAmJHRoaXMtPmlzSHR0cHM7DQoNCiAgICAgICAgJHRoaXMtPkJpbmRpbmdDYWNoZSgpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAq5p6Q5p6E5Ye95pWw77yM6YeK5pS+6LWE5rqQLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBfX2Rlc3RydWN0KCkNCiAgICB7DQogICAgICAgICR0aGlzLT5UZXJtaW5hdGUoKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBAYXBpIEZpbHRlcl9QbHVnaW5fWmJwX0NhbGwNCiAgICAgKg0KICAgICAqIEBwYXJhbSAkbWV0aG9kDQogICAgICogQHBhcmFtICRhcmdzDQogICAgICoNCiAgICAgKiBAcmV0dXJuIG1peGVkDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIF9fY2FsbCgkbWV0aG9kLCAkYXJncykNCiAgICB7DQogICAgICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1picF9DYWxsJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICAgICAkZnByZXR1cm4gPSAkZnBuYW1lKCRtZXRob2QsICRhcmdzKTsNCiAgICAgICAgICAgIGlmICgkZnBzaWduYWwgPT0gUExVR0lOX0VYSVRTSUdOQUxfUkVUVVJOKSB7DQogICAgICAgICAgICAgICAgJGZwc2lnbmFsID0gUExVR0lOX0VYSVRTSUdOQUxfTk9ORTsNCg0KICAgICAgICAgICAgICAgIHJldHVybiAkZnByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgdHJpZ2dlcl9lcnJvcigkdGhpcy0+bGFuZ1snZXJyb3InXVs4MV0sIEVfVVNFUl9XQVJOSU5HKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDorr7nva7lj4LmlbDlgLwNCiAgICAgKg0KICAgICAqIEBwYXJhbSAkbmFtZQ0KICAgICAqIEBwYXJhbSAkdmFsdWUNCiAgICAgKg0KICAgICAqIEByZXR1cm4gbWl4ZWQNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gX19zZXQoJG5hbWUsICR2YWx1ZSkNCiAgICB7DQogICAgICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1picF9TZXQnXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgICAgICRmcHJldHVybiA9ICRmcG5hbWUoJG5hbWUsICR2YWx1ZSk7DQogICAgICAgICAgICBpZiAoJGZwc2lnbmFsID09IFBMVUdJTl9FWElUU0lHTkFMX1JFVFVSTikgew0KICAgICAgICAgICAgICAgICRmcHNpZ25hbCA9IFBMVUdJTl9FWElUU0lHTkFMX05PTkU7DQoNCiAgICAgICAgICAgICAgICByZXR1cm4gJGZwcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHRyaWdnZXJfZXJyb3IoJHRoaXMtPmxhbmdbJ2Vycm9yJ11bODFdLCBFX1VTRVJfV0FSTklORyk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6I635Y+W5Y+C5pWw5YC8DQogICAgICoNCiAgICAgKiBAcGFyYW0gJG5hbWUNCiAgICAgKg0KICAgICAqIEByZXR1cm4gbWl4ZWQNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gX19nZXQoJG5hbWUpDQogICAgew0KICAgICAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9aYnBfR2V0J10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICAgICAkZnByZXR1cm4gPSAkZnBuYW1lKCRuYW1lKTsNCiAgICAgICAgICAgIGlmICgkZnBzaWduYWwgPT0gUExVR0lOX0VYSVRTSUdOQUxfUkVUVVJOKSB7DQogICAgICAgICAgICAgICAgJGZwc2lnbmFsID0gUExVR0lOX0VYSVRTSUdOQUxfTk9ORTsNCg0KICAgICAgICAgICAgICAgIHJldHVybiAkZnByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgdHJpZ2dlcl9lcnJvcigkdGhpcy0+bGFuZ1snZXJyb3InXVs4MV0sIEVfVVNFUl9XQVJOSU5HKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDliJ3lp4vljJYkemJwLg0KICAgICAqDQogICAgICogQHRocm93cyBFeGNlcHRpb24NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBJbml0aWFsaXplKCkNCiAgICB7DQogICAgICAgIGlmICgkdGhpcy0+aXNpbml0aWFsaXplZCkgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgJG9sZFpvbmUgPSAkdGhpcy0+b3B0aW9uWydaQ19USU1FX1pPTkVfTkFNRSddOw0KICAgICAgICBkYXRlX2RlZmF1bHRfdGltZXpvbmVfc2V0KCRvbGRab25lKTsNCg0KICAgICAgICAkb2xkTGFuZyA9ICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfTEFOR1VBR0VQQUNLJ107DQogICAgICAgICR0aGlzLT5Mb2FkTGFuZ3VhZ2UoJ3N5c3RlbScsICcnKTsNCg0KICAgICAgICBpZiAoJHRoaXMtPm9wdGlvblsnWkNfQ0xPU0VfV0hPTEVfU0lURSddID09IHRydWUpIHsNCiAgICAgICAgICAgIEh0dHA1MDMoKTsNCiAgICAgICAgICAgICR0aGlzLT5TaG93RXJyb3IoODIsIF9fRklMRV9fLCBfX0xJTkVfXyk7DQoNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmICghJHRoaXMtPk9wZW5Db25uZWN0KCkpIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgICR0aGlzLT5Db252ZXJ0VGFibGVBbmREYXRhaW5mbygpOw0KDQogICAgICAgICR0aGlzLT5Mb2FkQ29uZmlnc09ubHlTeXN0ZW0odHJ1ZSk7DQogICAgICAgICR0aGlzLT5Mb2FkT3B0aW9uKCk7DQoNCiAgICAgICAgaWYgKCR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfTEFOR1VBR0VQQUNLJ10gPT09ICdTaW1wQ2hpbmVzZScpIHsNCiAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfTEFOR1VBR0VQQUNLJ10gPSAnemgtY24nOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfTEFOR1VBR0VQQUNLJ10gPT09ICdUcmFkQ2hpbmVzZScpIHsNCiAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfTEFOR1VBR0VQQUNLJ10gPSAnemgtdHcnOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCRvbGRMYW5nICE9ICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfTEFOR1VBR0VQQUNLJ10pIHsNCiAgICAgICAgICAgICR0aGlzLT5Mb2FkTGFuZ3VhZ2UoJ3N5c3RlbScsICcnKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChpc3NldCgkdGhpcy0+b3B0aW9uWydaQ19ERUJVR19NT0RFX1dBUk5JTkcnXSkpIHsNCiAgICAgICAgICAgIFpCbG9nRXhjZXB0aW9uOjokaXN3YXJuaW5nID0gKGJvb2wpICR0aGlzLT5vcHRpb25bJ1pDX0RFQlVHX01PREVfV0FSTklORyddOw0KICAgICAgICB9DQogICAgICAgIGlmIChpc3NldCgkdGhpcy0+b3B0aW9uWydaQ19ERUJVR19NT0RFX1NUUklDVCddKSkgew0KICAgICAgICAgICAgWkJsb2dFeGNlcHRpb246OiRpc3N0cmljdCA9IChib29sKSAkdGhpcy0+b3B0aW9uWydaQ19ERUJVR19NT0RFX1NUUklDVCddOw0KICAgICAgICB9DQogICAgICAgIGlmIChpc3NldCgkdGhpcy0+b3B0aW9uWydaQ19ERUJVR19MT0dfRVJST1InXSkpIHsNCiAgICAgICAgICAgIFpCbG9nRXhjZXB0aW9uOjokaXNsb2dlcnJvciA9IChib29sKSAkdGhpcy0+b3B0aW9uWydaQ19ERUJVR19MT0dfRVJST1InXTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vWkNfUEVSTUFORU5UX0RPTUFJTl9XSE9MRV9ESVNBQkxF5LiN5a2Y5ZyoIOaIluaYryBaQ19QRVJNQU5FTlRfRE9NQUlOX1dIT0xFX0RJU0FCTEXlrZjlnKjkvYbkuLrlgYcNCiAgICAgICAgJGRvbWFpbl9kaXNhYmxlID0gR2V0VmFsdWVJbkFycmF5KCR0aGlzLT5vcHRpb24sICdaQ19QRVJNQU5FTlRfRE9NQUlOX1dIT0xFX0RJU0FCTEUnKTsNCiAgICAgICAgaWYgKCRkb21haW5fZGlzYWJsZSA9PSBmYWxzZSkgew0KICAgICAgICAgICAgJGZvcmNlZF91cmwgPSBHZXRWYWx1ZUluQXJyYXkoJHRoaXMtPm9wdGlvbiwgJ1pDX1BFUk1BTkVOVF9ET01BSU5fRk9SQ0VEX1VSTCcpOw0KICAgICAgICAgICAgaWYgKCRmb3JjZWRfdXJsICE9ICcnKSB7DQogICAgICAgICAgICAgICAgLy/lpoLmnpxaQ19QRVJNQU5FTlRfRE9NQUlOX0ZPUkNFRF9VUkzlrZjlnKgg5LiU5LiN5Li656m6DQogICAgICAgICAgICAgICAgJHRoaXMtPmhvc3QgPSAoc3RyaW5nKSAkZm9yY2VkX3VybDsNCiAgICAgICAgICAgICAgICAkdGhpcy0+Y29va2llc3BhdGggPSBzdHJzdHIoc3RyX3JlcGxhY2UoJzovLycsICcnLCAkdGhpcy0+aG9zdCksICcvJyk7DQogICAgICAgICAgICB9IGVsc2VpZiAoJHRoaXMtPm9wdGlvblsnWkNfUEVSTUFORU5UX0RPTUFJTl9FTkFCTEUnXSA9PSB0cnVlKSB7DQogICAgICAgICAgICAgICAgLy/lpoLmnpxaQ19QRVJNQU5FTlRfRE9NQUlOX0VOQUJMReW3suW8gOWQr+eahOivnQ0KICAgICAgICAgICAgICAgICR0aGlzLT5ob3N0ID0gJHRoaXMtPm9wdGlvblsnWkNfQkxPR19IT1NUJ107DQogICAgICAgICAgICAgICAgJHRoaXMtPmNvb2tpZXNwYXRoID0gc3Ryc3RyKHN0cl9yZXBsYWNlKCc6Ly8nLCAnJywgJHRoaXMtPmhvc3QpLCAnLycpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAvL+m7mOiupOiHquWKqOivhuWIq+Wfn+WQjQ0KICAgICAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfSE9TVCddID0gJHRoaXMtPmhvc3Q7DQogICAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19CTE9HX0hPU1QnXSA9ICR0aGlzLT5ob3N0Ow0KICAgICAgICB9DQoNCiAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfQkxPR19QUk9EVUNUJ10gPSAnWi1CbG9nUEhQJzsNCiAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfQkxPR19WRVJTSU9OJ10gPSBaQ19CTE9HX1ZFUlNJT047DQogICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX05PV19WRVJTSU9OJ10gPSAkdGhpcy0+dmVyc2lvbjsgIC8vWkNfTEFTVF9WRVJTSU9ODQogICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfUFJPRFVDVF9GVUxMJ10gPSAkdGhpcy0+b3B0aW9uWydaQ19CTE9HX1BST0RVQ1QnXSAuICcgJyAuIFpDX1ZFUlNJT05fRElTUExBWTsNCiAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfQkxPR19QUk9EVUNUX0ZVTExIVE1MJ10gPSAnPGEgaHJlZj0iaHR0cHM6Ly93d3cuemJsb2djbi5jb20vIiB0aXRsZT0iWi1CbG9nUEhQICcgLiBaQ19CTE9HX1ZFUlNJT04gLiAnIiB0YXJnZXQ9Il9ibGFuayI+JyAuICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfUFJPRFVDVF9GVUxMJ10gLiAnPC9hPic7DQogICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfUFJPRFVDVF9IVE1MJ10gPSAnPGEgaHJlZj0iaHR0cHM6Ly93d3cuemJsb2djbi5jb20vIiB0aXRsZT0iWi1CbG9nUEhQICcgLiBaQ19CTE9HX1ZFUlNJT04gLiAnIiB0YXJnZXQ9Il9ibGFuayI+JyAuICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfUFJPRFVDVCddIC4gJzwvYT4nOw0KDQogICAgICAgIGlmICgkb2xkWm9uZSAhPSAkdGhpcy0+b3B0aW9uWydaQ19USU1FX1pPTkVfTkFNRSddKSB7DQogICAgICAgICAgICBkYXRlX2RlZmF1bHRfdGltZXpvbmVfc2V0KCR0aGlzLT5vcHRpb25bJ1pDX1RJTUVfWk9ORV9OQU1FJ10pOw0KICAgICAgICB9DQoNCiAgICAgICAgLyppZihpc3NldCgkX0NPT0tJRVsndGltZXpvbmUnXSkpew0KICAgICAgICAgICAgJHR6PUdldFZhcnMoJ3RpbWV6b25lJywnQ09PS0lFJyk7DQogICAgICAgICAgICBpZihpc19udW1lcmljKCR0eikpew0KICAgICAgICAgICAgJHR6PXNwcmludGYoJyUrZCcsLSR0eik7DQogICAgICAgICAgICBkYXRlX2RlZmF1bHRfdGltZXpvbmVfc2V0KCdFdGMvR01UJyAuICR0eik7DQogICAgICAgICAgICAkdGhpcy0+dGltZXpvbmU9ZGF0ZV9kZWZhdWx0X3RpbWV6b25lX2dldCgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAqLw0KDQogICAgICAgIGlmICgkdGhpcy0+b3B0aW9uWydaQ19WRVJTSU9OX0lOX0hFQURFUiddICYmICFoZWFkZXJzX3NlbnQoKSkgew0KICAgICAgICAgICAgaGVhZGVyKCdQcm9kdWN0OicgLiAkdGhpcy0+b3B0aW9uWydaQ19CTE9HX1BST0RVQ1RfRlVMTCddKTsNCiAgICAgICAgfQ0KDQogICAgICAgICRwYXJzZWRIb3N0ID0gcGFyc2VfdXJsKCR0aGlzLT5ob3N0KTsNCiAgICAgICAgaWYgKGlzc2V0KCRwYXJzZWRIb3N0WydzY2hlbWUnXSkgJiYgaXNzZXQoJHBhcnNlZEhvc3RbJ2hvc3QnXSkpIHsNCiAgICAgICAgICAgICR0aGlzLT5mdWxsY3VycmVudHVybCA9ICRwYXJzZWRIb3N0WydzY2hlbWUnXSAuICc6Ly8nIC4gJHBhcnNlZEhvc3RbJ2hvc3QnXTsNCiAgICAgICAgICAgIGlmIChpc3NldCgkcGFyc2VkSG9zdFsncG9ydCddKSkgew0KICAgICAgICAgICAgICAgICR0aGlzLT5mdWxsY3VycmVudHVybCAuPSAnOicgLiAkcGFyc2VkSG9zdFsncG9ydCddOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJHRoaXMtPmZ1bGxjdXJyZW50dXJsID0gJyc7DQogICAgICAgIH0NCiAgICAgICAgJHRoaXMtPmZ1bGxjdXJyZW50dXJsIC49ICR0aGlzLT5jdXJyZW50dXJsOw0KDQogICAgICAgIGlmIChzdHJpcG9zKCR0aGlzLT5ob3N0LCAnaHR0cCcpID09PSAwKSB7DQogICAgICAgICAgICBpZiAoc3RyaXBvcygkdGhpcy0+aG9zdCwgJ2h0dHBzOi8vJykgPT09IDApIHsNCiAgICAgICAgICAgICAgICAkdGhpcy0+aXNIdHRwcyA9IHRydWU7DQogICAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkdGhpcy0+aXNIdHRwcyA9IChIVFRQX1NDSEVNRSA9PT0gJ2h0dHBzOi8vJyk7DQogICAgICAgIH0NCiAgICAgICAgLy92YXJfZHVtcCgkdGhpcy0+aXNIdHRwcyk7ZGllOw0KDQogICAgICAgICR0aGlzLT52ZXJpZnlDb2RlVXJsID0gJHRoaXMtPnN5c3RlbXVybCAuICdzY3JpcHQvY192YWxpZGNvZGUucGhwJzsNCiAgICAgICAgJHRoaXMtPnZhbGlkY29kZXVybCA9ICYkdGhpcy0+dmVyaWZ5Q29kZVVybDsNCiAgICAgICAgJHRoaXMtPmZlZWR1cmwgPSAkdGhpcy0+aG9zdCAuICdmZWVkLnBocCc7DQogICAgICAgICR0aGlzLT5zZWFyY2h1cmwgPSAkdGhpcy0+aG9zdCAuICdzZWFyY2gucGhwJzsNCiAgICAgICAgJHRoaXMtPmNtZHVybCA9ICR0aGlzLT5zeXN0ZW11cmwgLiAnY21kLnBocCc7DQogICAgICAgICR0aGlzLT5hamF4dXJsID0gJHRoaXMtPmNtZHVybCAuICc/YWN0PWFqYXgmc3JjPSc7DQogICAgICAgICR0aGlzLT54bWxycGN1cmwgPSAkdGhpcy0+c3lzdGVtdXJsIC4gJ3htbC1ycGMvaW5kZXgucGhwJzsNCiAgICAgICAgJHRoaXMtPmFwaXVybCA9ICR0aGlzLT5zeXN0ZW11cmwgLiAnYXBpLnBocCc7DQoNCiAgICAgICAgJHRoaXMtPkxvYWRDb25maWdzT25seVN5c3RlbShmYWxzZSk7DQoNCiAgICAgICAgJHRoaXMtPkxvYWRDYWNoZSgpOw0KDQogICAgICAgICFkZWZpbmVkKCdaQlBfSU5fQVBJJykgfHwgJHRoaXMtPmlzYXBpID0gdHJ1ZTsNCiAgICAgICAgIWRlZmluZWQoJ1pCUF9JTl9DTUQnKSB8fCAkdGhpcy0+aXNjbWQgPSB0cnVlOw0KICAgICAgICAhZGVmaW5lZCgnWkJQX0lOX0FKQVgnKSB8fCAkdGhpcy0+aXNhamF4ID0gdHJ1ZTsNCiAgICAgICAgIWRlZmluZWQoJ1pCUF9JTl9YTUxSUEMnKSB8fCAkdGhpcy0+aXN4bWxycGMgPSB0cnVlOw0KICAgICAgICAhJHRoaXMtPm9wdGlvblsnWkNfREVCVUdfTU9ERSddIHx8ICR0aGlzLT5pc2RlYnVnID0gdHJ1ZTsNCg0KICAgICAgICAkdGhpcy0+TG9hZFBvc3RUeXBlKCk7DQogICAgICAgICR0aGlzLT5Mb2FkUm91dGVzKCk7DQoNCiAgICAgICAgJHRoaXMtPnRoZW1lYXBwID0gbmV3IEFwcCgpOw0KICAgICAgICAkdGhpcy0+dGhlbWVpbmZvID0gJHRoaXMtPnRoZW1lYXBwLT5HZXRJbmZvQXJyYXkoKTsNCg0KICAgICAgICAkdGhpcy0+aXNpbml0aWFsaXplZCA9IHRydWU7DQoNCiAgICAgICAgaWYgKCR0aGlzLT5pc2FwaSkgew0KICAgICAgICAgICAgLy/mjILovb1BUEnplJnor6/mmL7npLoNCiAgICAgICAgICAgIEFkZF9GaWx0ZXJfUGx1Z2luKCdGaWx0ZXJfUGx1Z2luX0RlYnVnX0Rpc3BsYXknLCAnQXBpRGVidWdEaXNwbGF5Jyk7DQogICAgICAgICAgICAvL+aMgui9vVRva2Vu6aqM6K+BDQogICAgICAgICAgICBBZGRfRmlsdGVyX1BsdWdpbignRmlsdGVyX1BsdWdpbl9aYnBfUHJlTG9hZCcsICdBcGlUb2tlblZlcmlmeScpOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6K+75Y+W5paH5Lu26YeM55qEUG9zdFR5cGXphY3nva4o5Lul5ZCO5Y+v6IO95Lya5pS+6L+b5pWw5o2u5bqT6YeMKQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBMb2FkUG9zdFR5cGUoKQ0KICAgIHsNCiAgICAgICAgZm9yZWFjaCAoYXJyYXkoMCA9PiAnYXJ0aWNsZScsIDEgPT4gJ3BhZ2UnKSBhcyAkcG9zdGlkID0+ICRwb3N0bmFtZSkgew0KICAgICAgICAgICAgJHBvc3R0eXBlID0gaW5jbHVkZSBaQlBfUEFUSCAuICd6Yl9zeXN0ZW0vZGVmZW5kL3Bvc3R0eXBlXycgLiAkcG9zdG5hbWUgLiAnLnBocCc7DQogICAgICAgICAgICBpZiAoZW1wdHkoJHBvc3R0eXBlWydzaW5nbGVfdXJscnVsZSddKSkgew0KICAgICAgICAgICAgICAgIGlmICgkcG9zdGlkID09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgJHBvc3R0eXBlWydzaW5nbGVfdXJscnVsZSddID0gJHRoaXMtPm9wdGlvblsnWkNfQVJUSUNMRV9SRUdFWCddOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICRwb3N0dHlwZVsnc2luZ2xlX3VybHJ1bGUnXSA9ICR0aGlzLT5vcHRpb25bJ1pDX1BBR0VfUkVHRVgnXTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbXB0eSgkcG9zdHR5cGVbJ2xpc3RfdXJscnVsZSddKSA/ICRwb3N0dHlwZVsnbGlzdF91cmxydWxlJ10gPSAkdGhpcy0+b3B0aW9uWydaQ19JTkRFWF9SRUdFWCddIDogbnVsbDsNCiAgICAgICAgICAgIGVtcHR5KCRwb3N0dHlwZVsnbGlzdF9jYXRlZ29yeV91cmxydWxlJ10pID8gJHBvc3R0eXBlWydsaXN0X2NhdGVnb3J5X3VybHJ1bGUnXSA9ICR0aGlzLT5vcHRpb25bJ1pDX0NBVEVHT1JZX1JFR0VYJ10gOiBudWxsOw0KICAgICAgICAgICAgZW1wdHkoJHBvc3R0eXBlWydsaXN0X2F1dGhvcl91cmxydWxlJ10pID8gJHBvc3R0eXBlWydsaXN0X2F1dGhvcl91cmxydWxlJ10gPSAkdGhpcy0+b3B0aW9uWydaQ19BVVRIT1JfUkVHRVgnXSA6IG51bGw7DQogICAgICAgICAgICBlbXB0eSgkcG9zdHR5cGVbJ2xpc3RfZGF0ZV91cmxydWxlJ10pID8gJHBvc3R0eXBlWydsaXN0X2RhdGVfdXJscnVsZSddID0gJHRoaXMtPm9wdGlvblsnWkNfREFURV9SRUdFWCddIDogbnVsbDsNCiAgICAgICAgICAgIGVtcHR5KCRwb3N0dHlwZVsnbGlzdF90YWdfdXJscnVsZSddKSA/ICRwb3N0dHlwZVsnbGlzdF90YWdfdXJscnVsZSddID0gJHRoaXMtPm9wdGlvblsnWkNfVEFHU19SRUdFWCddIDogbnVsbDsNCiAgICAgICAgICAgIGVtcHR5KCRwb3N0dHlwZVsnc2VhcmNoX3VybHJ1bGUnXSkgPyAkcG9zdHR5cGVbJ3NlYXJjaF91cmxydWxlJ10gPSAkdGhpcy0+b3B0aW9uWydaQ19TRUFSQ0hfUkVHRVgnXSA6IG51bGw7DQoNCiAgICAgICAgICAgICR0aGlzLT5wb3N0dHlwZVskcG9zdGlkXSA9ICRwb3N0dHlwZTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOivu+WPluaWh+S7tumHjOeahOi3r+eUsemFjee9rijku6XlkI7lj6/og73kvJrmlL7ov5vmlbDmja7lupPph4wpDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIExvYWRSb3V0ZXMoKQ0KICAgIHsNCiAgICAgICAgZm9yZWFjaCAoYXJyYXkoMCA9PiAnYXJ0aWNsZScsIDEgPT4gJ3BhZ2UnKSBhcyAkcG9zdGlkID0+ICRwb3N0bmFtZSkgew0KICAgICAgICAgICAgaWYgKCFpc19yZWFkYWJsZSgkZmlsZSA9IFpCUF9QQVRIIC4gJ3piX3N5c3RlbS9kZWZlbmQvcm91dGVzX3Bvc3RfJyAuICRwb3N0bmFtZSAuICcucGhwJykpIHsNCiAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgICRyb3V0ZSA9IGluY2x1ZGUgJGZpbGU7DQogICAgICAgICAgICBmb3JlYWNoICgkcm91dGUgYXMgJGtleTIgPT4gJHZhbHVlMikgew0KICAgICAgICAgICAgICAgIGlmIChlbXB0eSgkdmFsdWUyWyd1cmxydWxlJ10pKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICgkdmFsdWUyWyduYW1lJ10gPT0gJ3Bvc3RfJyAuICRwb3N0bmFtZSAuICdfc2luZ2xlJykgew0KICAgICAgICAgICAgICAgICAgICAgICAgJHZhbHVlMlsndXJscnVsZSddID0gJHRoaXMtPkdldFBvc3RUeXBlKCRwb3N0aWQsICdzaW5nbGVfdXJscnVsZScpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGlmICgkdmFsdWUyWyduYW1lJ10gPT0gJ3Bvc3RfJyAuICRwb3N0bmFtZSAuICdfbGlzdCcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICR2YWx1ZTJbJ3VybHJ1bGUnXSA9ICR0aGlzLT5HZXRQb3N0VHlwZSgkcG9zdGlkLCAnbGlzdF91cmxydWxlJyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYgKCR2YWx1ZTJbJ25hbWUnXSA9PSAncG9zdF8nIC4gJHBvc3RuYW1lIC4gJ19saXN0X29ubHlfYWN0aXZlJykgew0KICAgICAgICAgICAgICAgICAgICAgICAgJHZhbHVlMlsndXJscnVsZSddID0gJHRoaXMtPkdldFBvc3RUeXBlKCRwb3N0aWQsICdsaXN0X3VybHJ1bGUnKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBpZiAoJHZhbHVlMlsnbmFtZSddID09ICdwb3N0XycgLiAkcG9zdG5hbWUgLiAnX2xpc3RfY2F0ZWdvcnknKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAkdmFsdWUyWyd1cmxydWxlJ10gPSAkdGhpcy0+R2V0UG9zdFR5cGUoJHBvc3RpZCwgJ2xpc3RfY2F0ZWdvcnlfdXJscnVsZScpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGlmICgkdmFsdWUyWyduYW1lJ10gPT0gJ3Bvc3RfJyAuICRwb3N0bmFtZSAuICdfbGlzdF9hdXRob3InKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAkdmFsdWUyWyd1cmxydWxlJ10gPSAkdGhpcy0+R2V0UG9zdFR5cGUoJHBvc3RpZCwgJ2xpc3RfYXV0aG9yX3VybHJ1bGUnKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBpZiAoJHZhbHVlMlsnbmFtZSddID09ICdwb3N0XycgLiAkcG9zdG5hbWUgLiAnX2xpc3RfZGF0ZScpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICR2YWx1ZTJbJ3VybHJ1bGUnXSA9ICR0aGlzLT5HZXRQb3N0VHlwZSgkcG9zdGlkLCAnbGlzdF9kYXRlX3VybHJ1bGUnKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBpZiAoJHZhbHVlMlsnbmFtZSddID09ICdwb3N0XycgLiAkcG9zdG5hbWUgLiAnX2xpc3RfdGFnJykgew0KICAgICAgICAgICAgICAgICAgICAgICAgJHZhbHVlMlsndXJscnVsZSddID0gJHRoaXMtPkdldFBvc3RUeXBlKCRwb3N0aWQsICdsaXN0X3RhZ191cmxydWxlJyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYgKCR2YWx1ZTJbJ25hbWUnXSA9PSAncG9zdF8nIC4gJHBvc3RuYW1lIC4gJ19zZWFyY2gnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAkdmFsdWUyWyd1cmxydWxlJ10gPSAkdGhpcy0+R2V0UG9zdFR5cGUoJHBvc3RpZCwgJ3NlYXJjaF91cmxydWxlJyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgJHRoaXMtPnJvdXRlc1ska2V5Ml0gPSAkdmFsdWUyOw0KICAgICAgICAgICAgICAgIGlmICgkdmFsdWUyWyd0eXBlJ10gIT0gJ3Jld3JpdGUnIHx8ICgkdGhpcy0+b3B0aW9uWydaQ19TVEFUSUNfTU9ERSddID09ICdSRVdSSVRFJyAmJiAkdmFsdWUyWyd0eXBlJ10gPT0gJ3Jld3JpdGUnKSkgew0KICAgICAgICAgICAgICAgICAgICAkdGhpcy0+U2V0UG9zdFR5cGVfU3ViKCRwb3N0aWQsICdyb3V0ZXMnLCAkdmFsdWUyWyduYW1lJ10sIGFycmF5KCR2YWx1ZTJbJ3R5cGUnXSA9PiAkdmFsdWUyWyduYW1lJ10pKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgLy92YXJfZXhwb3J0KCR0aGlzLT5wb3N0dHlwZSk7DQogICAgICAgIC8vdmFyX2V4cG9ydCgkdGhpcy0+cm91dGVzKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDlnKhJbml0aWFsaXpl5ZKM5Yqg6L295omA5pyJ5o+S5Lu2aW5jbHVkZeS5i+WQju+8jOWcqExvYWTkuYvliY3nmoTov4fnqIvvvIzooqtjX3N5c3RlbV9iYXNl6LCD55So77yMMS436YeM5paw5Yqg55qEDQogICAgICoNCiAgICAgKiBAdGhyb3dzIEV4Y2VwdGlvbg0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFByZUxvYWQoKQ0KICAgIHsNCiAgICAgICAgaWYgKCEkdGhpcy0+aXNpbml0aWFsaXplZCB8fCAkdGhpcy0+aXNwcmVsb2FkKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCg0KICAgICAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9aYnBfUHJlTG9hZCddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAgICAgJGZwcmV0dXJuID0gJGZwbmFtZSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgLy/mraTlpITmjqXlj6PlupTor6XlnKjkuIvkuIDniYjmnKznp7vpmaTvvIzor7fkuI3opoHlho3kvb/nlKjkuobvvIHvvIHvvIENCiAgICAgICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fWmJwX0xvYWRfUHJlJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICAgICAkZnByZXR1cm4gPSAkZnBuYW1lKCk7DQogICAgICAgIH0NCg0KICAgICAgICAkdGhpcy0+aXNwcmVsb2FkID0gdHJ1ZTsNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5LuO5pWw5o2u5bqT6YeM6K+75Y+W5L+h5oGv77yM5ZCv5Yqo5pW05LiqWkJQLg0KICAgICAqDQogICAgICogQHRocm93cyBFeGNlcHRpb24NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBMb2FkKCkNCiAgICB7DQogICAgICAgIGlmICghJHRoaXMtPmlzaW5pdGlhbGl6ZWQgfHwgISR0aGlzLT5pc3ByZWxvYWQgfHwgJHRoaXMtPmlzbG9hZCkgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCFoZWFkZXJzX3NlbnQoKSkgew0KICAgICAgICAgICAgaGVhZGVyKCdDb250ZW50LXR5cGU6IHRleHQvaHRtbDsgY2hhcnNldD11dGYtOCcpOw0KICAgICAgICB9DQoNCiAgICAgICAgJHRoaXMtPkNvbnZlcnRUYWJsZUFuZERhdGFpbmZvKCk7DQogICAgICAgIGlmICgkdGhpcy0+b3B0aW9uWydaQ19MT0FETUVNQkVSU19MRVZFTCddID09IDApIHsNCiAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX0xPQURNRU1CRVJTX0xFVkVMJ10gPSAxOw0KICAgICAgICB9DQogICAgICAgICR0aGlzLT5Mb2FkTWVtYmVycygkdGhpcy0+b3B0aW9uWydaQ19MT0FETUVNQkVSU19MRVZFTCddKTsNCiAgICAgICAgJHRoaXMtPkxvYWRDYXRlZ29yaWVzKCk7DQogICAgICAgIC8vJHRoaXMtPkxvYWRUYWdzKCk7DQogICAgICAgICR0aGlzLT5Mb2FkTW9kdWxlcygpOw0KICAgICAgICAkdGhpcy0+UmVnQnVpbGRNb2R1bGVzKCk7DQoNCiAgICAgICAgaWYgKCEoaXNfc3ViY2xhc3Nfb2YoJHRoaXMtPnVzZXIsICdCYXNlTWVtYmVyJykgJiYgJHRoaXMtPnVzZXItPkxldmVsID4gMCAmJiAhZW1wdHkoJHRoaXMtPnVzZXItPklEKSkpIHsNCiAgICAgICAgICAgICR0aGlzLT5WZXJpZnkoKTsNCiAgICAgICAgICAgICR0aGlzLT5pc2xvZ2luID0gZW1wdHkoJHRoaXMtPnVzZXItPklEKSA/IGZhbHNlIDogdHJ1ZTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8v5Yib5bu65qih5p2/57G7DQogICAgICAgICR0aGlzLT50ZW1wbGF0ZSA9ICR0aGlzLT5QcmVwYXJlVGVtcGxhdGUoKTsNCg0KICAgICAgICBpZiAoJHRoaXMtPmlzbWFuYWdlKSB7DQogICAgICAgICAgICAkdGhpcy0+TG9hZE1hbmFnZSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fTG9naW5fSGVhZGVyJywgJ0luY2x1ZGVfQWRkb25BZG1pbkZvbnQnKTsNCiAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fT3RoZXJfSGVhZGVyJywgJ0luY2x1ZGVfQWRkb25BZG1pbkZvbnQnKTsNCiAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fQWRtaW5fSGVhZGVyJywgJ0luY2x1ZGVfQWRkb25BZG1pbkZvbnQnKTsNCiAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fQmF0Y2hQb3N0JywgJ0luY2x1ZGVfQmF0Y2hQb3N0X0FydGljbGUnKTsNCiAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fQmF0Y2hQb3N0JywgJ0luY2x1ZGVfQmF0Y2hQb3N0X1BhZ2UnKTsNCiAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fSW5kZXhfRW5kJywgJ0luY2x1ZGVfSW5kZXhfRW5kJyk7DQogICAgICAgIEFkZF9GaWx0ZXJfUGx1Z2luKCdGaWx0ZXJfUGx1Z2luX1NlYXJjaF9FbmQnLCAnSW5jbHVkZV9JbmRleF9FbmQnKTsNCiAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fSW5kZXhfQmVnaW4nLCAnSW5jbHVkZV9JbmRleF9CZWdpbicpOw0KICAgICAgICBBZGRfRmlsdGVyX1BsdWdpbignRmlsdGVyX1BsdWdpbl9TZWFyY2hfQmVnaW4nLCAnSW5jbHVkZV9JbmRleF9CZWdpbicpOw0KICAgICAgICBBZGRfRmlsdGVyX1BsdWdpbignRmlsdGVyX1BsdWdpbl9GZWVkX0JlZ2luJywgJ0luY2x1ZGVfSW5kZXhfQmVnaW4nKTsNCiAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fWmJwX0NoZWNrUmlnaHRzJywgJ0luY2x1ZGVfRnJvbnRlbmRfQ2hlY2tSaWdodHMnKTsNCg0KICAgICAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9aYnBfTG9hZCddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAgICAgJGZwbmFtZSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCR0aGlzLT51c2VyLT5TdGF0dXMgPT0gWkNfTUVNQkVSX1NUQVRVU19MT0NLRUQpIHsNCiAgICAgICAgICAgICR0aGlzLT5TaG93RXJyb3IoODAsIF9fRklMRV9fLCBfX0xJTkVfXyk7DQogICAgICAgIH0NCg0KICAgICAgICAvL+i/m+WQjuWPsOaXtuW3suiHquWKqOajgOa1i+aooeadv+W5tuiHquWKqOmHjeW7uuS6hu+8jOaJgOS7pei/memHjOWPqumSiOWvueW8gOiwg+ivleWQjueahOWJjeWPsOeahOiuv+mXrui/m+ihjA0KICAgICAgICBpZiAoJHRoaXMtPm9wdGlvblsnWkNfREVCVUdfTU9ERSddIHx8ICR0aGlzLT5pc21hbmFnZSkgew0KICAgICAgICAgICAgJHRoaXMtPkNoZWNrVGVtcGxhdGUoKTsNCiAgICAgICAgfQ0KDQogICAgICAgICR0aGlzLT5SZWZsdXNoTGFuZ3VhZ2VzKCk7DQogICAgICAgICR0aGlzLT5Db252ZXJ0VGFibGVBbmREYXRhaW5mbygpOw0KDQogICAgICAgICR0aGlzLT5pc2xvZ2luID0gZW1wdHkoJHRoaXMtPnVzZXItPklEKSA/IGZhbHNlIDogdHJ1ZTsNCiAgICAgICAgJHRoaXMtPmlzbG9hZCA9IHRydWU7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOi9veWFpeeuoeeQhi4NCiAgICAgKg0KICAgICAqIEB0aHJvd3MgRXhjZXB0aW9uDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIExvYWRNYW5hZ2UoKQ0KICAgIHsNCiAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fQWRtaW5fUGFnZU1uZ19TdWJNZW51JywgJ0luY2x1ZGVfQWRtaW5fQWRkcGFnZXN1Ym1lbnUnKTsNCiAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fQWRtaW5fVGFnTW5nX1N1Yk1lbnUnLCAnSW5jbHVkZV9BZG1pbl9BZGR0YWdzdWJtZW51Jyk7DQogICAgICAgIEFkZF9GaWx0ZXJfUGx1Z2luKCdGaWx0ZXJfUGx1Z2luX0FkbWluX0NhdGVnb3J5TW5nX1N1Yk1lbnUnLCAnSW5jbHVkZV9BZG1pbl9BZGRjYXRlc3VibWVudScpOw0KICAgICAgICBBZGRfRmlsdGVyX1BsdWdpbignRmlsdGVyX1BsdWdpbl9BZG1pbl9NZW1iZXJNbmdfU3ViTWVudScsICdJbmNsdWRlX0FkbWluX0FkZG1lbXN1Ym1lbnUnKTsNCiAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fQWRtaW5fTW9kdWxlTW5nX1N1Yk1lbnUnLCAnSW5jbHVkZV9BZG1pbl9BZGRtb2RzdWJtZW51Jyk7DQogICAgICAgIEFkZF9GaWx0ZXJfUGx1Z2luKCdGaWx0ZXJfUGx1Z2luX0FkbWluX0NvbW1lbnRNbmdfU3ViTWVudScsICdJbmNsdWRlX0FkbWluX0FkZGNtdHN1Ym1lbnUnKTsNCiAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fQWRtaW5fU2V0dGluZ01uZ19TdWJNZW51JywgJ0luY2x1ZGVfQWRtaW5fQWRkc2V0dGluZ3N1Ym1lbnUnKTsNCiAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fWmJwX0xvYWRNYW5hZ2UnLCAnSW5jbHVkZV9BZG1pbl9VcGRhdGVEQicpOw0KICAgICAgICBBZGRfRmlsdGVyX1BsdWdpbignRmlsdGVyX1BsdWdpbl9BZG1pbl9FbmQnLCAnSW5jbHVkZV9BZG1pbl9DaGVja0h0dHAzMDRPSycpOw0KDQogICAgICAgIGlmIChpc3NldCgkR0xPQkFMU1snemJwdmVycyddKSkgew0KICAgICAgICAgICAgJEdMT0JBTFNbJ3picHZlcnMnXVskR0xPQkFMU1snYmxvZ3ZlcnNpb24nXV0gPSBaQ19WRVJTSU9OX0RJU1BMQVkgLiAnIEJ1aWxkICcgLiAkR0xPQkFMU1snYmxvZ3ZlcnNpb24nXTsNCiAgICAgICAgfQ0KDQogICAgICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1picF9Mb2FkTWFuYWdlJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICAgICAkZnBuYW1lKCk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDnu4jmraLov57mjqXvvIzph4rmlL7otYTmupAuDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFRlcm1pbmF0ZSgpDQogICAgew0KICAgICAgICBpZiAoJHRoaXMtPmlzaW5pdGlhbGl6ZWQpIHsNCiAgICAgICAgICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1picF9UZXJtaW5hdGUnXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgICAgICAgICAkZnBuYW1lKCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICR0aGlzLT5DbG9zZUNvbm5lY3QoKTsNCiAgICAgICAgICAgIHVuc2V0KCR0aGlzLT5kYik7DQogICAgICAgICAgICAkdGhpcy0+aXNpbml0aWFsaXplZCA9IGZhbHNlOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6L+e5o6l5pWw5o2u5bqTLg0KICAgICAqDQogICAgICogQHRocm93cyBFeGNlcHRpb24NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBPcGVuQ29ubmVjdCgpDQogICAgew0KICAgICAgICBpZiAoJHRoaXMtPmlzY29ubmVjdGVkKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoISR0aGlzLT5vcHRpb25bJ1pDX0RBVEFCQVNFX1RZUEUnXSkgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgc3dpdGNoICgkdGhpcy0+b3B0aW9uWydaQ19EQVRBQkFTRV9UWVBFJ10pIHsNCiAgICAgICAgICAgIGNhc2UgJ3NxbGl0ZSc6DQogICAgICAgICAgICBjYXNlICdzcWxpdGUzJzoNCiAgICAgICAgICAgIGNhc2UgJ3Bkb19zcWxpdGUnOg0KICAgICAgICAgICAgICAgICR0aGlzLT5kYiA9IHNlbGY6OkluaXRpYWxpemVEQigkdGhpcy0+b3B0aW9uWydaQ19EQVRBQkFTRV9UWVBFJ10pOw0KICAgICAgICAgICAgICAgIGlmICgkdGhpcy0+ZGItPk9wZW4oDQogICAgICAgICAgICAgICAgICAgIGFycmF5KCR0aGlzLT5kYXRhZGlyIC4gJycgLiAkdGhpcy0+b3B0aW9uWydaQ19TUUxJVEVfTkFNRSddLA0KICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfU1FMSVRFX1BSRSddLA0KICAgICAgICAgICAgICAgICAgICApDQogICAgICAgICAgICAgICAgKSA9PSBmYWxzZQ0KICAgICAgICAgICAgICAgICkgew0KICAgICAgICAgICAgICAgICAgICAkdGhpcy0+U2hvd0Vycm9yKDY5LCBfX0ZJTEVfXywgX19MSU5FX18pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ3Bvc3RncmVzcWwnOg0KICAgICAgICAgICAgY2FzZSAncGRvX3Bvc3RncmVzcWwnOg0KICAgICAgICAgICAgICAgICR0aGlzLT5kYiA9IHNlbGY6OkluaXRpYWxpemVEQigkdGhpcy0+b3B0aW9uWydaQ19EQVRBQkFTRV9UWVBFJ10pOw0KICAgICAgICAgICAgICAgIGlmICgkdGhpcy0+ZGItPk9wZW4oDQogICAgICAgICAgICAgICAgICAgIGFycmF5KCR0aGlzLT5vcHRpb25bJ1pDX1BHU1FMX1NFUlZFUiddLA0KICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfUEdTUUxfVVNFUk5BTUUnXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX1BHU1FMX1BBU1NXT1JEJ10sDQogICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19QR1NRTF9OQU1FJ10sDQogICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19QR1NRTF9QUkUnXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX1BHU1FMX1BPUlQnXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX1BHU1FMX1BFUlNJU1RFTlQnXSwNCiAgICAgICAgICAgICAgICAgICAgKQ0KICAgICAgICAgICAgICAgICkgPT0gZmFsc2UNCiAgICAgICAgICAgICAgICApIHsNCiAgICAgICAgICAgICAgICAgICAgJHRoaXMtPlNob3dFcnJvcig2NywgX19GSUxFX18sIF9fTElORV9fKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdteXNxbCc6DQogICAgICAgICAgICBjYXNlICdteXNxbGknOg0KICAgICAgICAgICAgY2FzZSAncGRvX215c3FsJzoNCiAgICAgICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgICAgICAgaWYgKCR0aGlzLT5vcHRpb25bJ1pDX0RBVEFCQVNFX1RZUEUnXSA9PSAnbXlzcWwnICYmIHZlcnNpb25fY29tcGFyZShQSFBfVkVSU0lPTiwgJzcuMC4wJykgPj0gMCkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoZXh0ZW5zaW9uX2xvYWRlZCgnbXlzcWxpJykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX0RBVEFCQVNFX1RZUEUnXSA9ICdteXNxbGknOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2VpZiAoZXh0ZW5zaW9uX2xvYWRlZCgncGRvX215c3FsJykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX0RBVEFCQVNFX1RZUEUnXSA9ICdwZG9fbXlzcWwnOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICR0aGlzLT5kYiA9IHNlbGY6OkluaXRpYWxpemVEQigkdGhpcy0+b3B0aW9uWydaQ19EQVRBQkFTRV9UWVBFJ10pOw0KICAgICAgICAgICAgICAgIGlmICgkdGhpcy0+ZGItPk9wZW4oDQogICAgICAgICAgICAgICAgICAgIGFycmF5KA0KICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfTVlTUUxfU0VSVkVSJ10sDQogICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19NWVNRTF9VU0VSTkFNRSddLA0KICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfTVlTUUxfUEFTU1dPUkQnXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX01ZU1FMX05BTUUnXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX01ZU1FMX1BSRSddLA0KICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfTVlTUUxfUE9SVCddLA0KICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfTVlTUUxfUEVSU0lTVEVOVCddLA0KICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfTVlTUUxfRU5HSU5FJ10sDQogICAgICAgICAgICAgICAgICAgICkNCiAgICAgICAgICAgICAgICApID09IGZhbHNlDQogICAgICAgICAgICAgICAgKSB7DQogICAgICAgICAgICAgICAgICAgICR0aGlzLT5TaG93RXJyb3IoNjcsIF9fRklMRV9fLCBfX0xJTkVfXyk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICB9DQogICAgICAgIC8vIHV0ZjhtYjTmlK/mjIENCiAgICAgICAgaWYgKCR0aGlzLT5kYi0+dHlwZSA9PSAnbXlzcWwnICYmIHZlcnNpb25fY29tcGFyZSgkdGhpcy0+ZGItPnZlcnNpb24sICc1LjUuMycpIDwgMCkgew0KICAgICAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fRGJTcWxfRmlsdGVyJywgJ3V0Zjg0bWJfZmlsdGVyJyk7DQogICAgICAgICAgICBBZGRfRmlsdGVyX1BsdWdpbignRmlsdGVyX1BsdWdpbl9FZGl0X0JlZ2luJywgJ3V0Zjg0bWJfZml4SHRtbFNwZWNpYWxDaGFycycpOw0KICAgICAgICB9DQogICAgICAgICR0aGlzLT5pc2Nvbm5lY3RlZCA9IHRydWU7DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5a+56KGo5ZCN5ZKM5pWw5o2u57uT5p6E6L+b6KGM6aKE6L2s5o2iLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBDb252ZXJ0VGFibGVBbmREYXRhaW5mbygpDQogICAgew0KICAgICAgICBpZiAoJHRoaXMtPmRiLT5kYnByZSkgew0KICAgICAgICAgICAgJHRoaXMtPnRhYmxlID0gc3RyX3JlcGxhY2UoJyVwcmUlJywgJHRoaXMtPmRiLT5kYnByZSwgJHRoaXMtPnRhYmxlKTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoJHRoaXMtPmRiLT50eXBlID09PSAncG9zdGdyZXNxbCcpIHsNCiAgICAgICAgICAgIGZvcmVhY2ggKCR0aGlzLT5kYXRhaW5mbyBhcyAka2V5ID0+ICYkdmFsdWUpIHsNCiAgICAgICAgICAgICAgICBmb3JlYWNoICgkdmFsdWUgYXMgJGsyID0+ICYkdjIpIHsNCiAgICAgICAgICAgICAgICAgICAgJHYyWzBdID0gc3RydG9sb3dlcigkdjJbMF0pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWFs+mXreaVsOaNruW6k+i/nuaOpS4NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQ2xvc2VDb25uZWN0KCkNCiAgICB7DQogICAgICAgIGlmICgkdGhpcy0+aXNjb25uZWN0ZWQpIHsNCiAgICAgICAgICAgICR0aGlzLT5kYi0+Q2xvc2UoKTsNCiAgICAgICAgICAgICR0aGlzLT5pc2Nvbm5lY3RlZCA9IGZhbHNlOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5ZCv55Soc2Vzc2lvbi4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBTdGFydFNlc3Npb24oKQ0KICAgIHsNCiAgICAgICAgaWYgKHNlc3Npb25fc3RhdHVzKCkgPT0gMSkgew0KICAgICAgICAgICAgc2Vzc2lvbl9zdGFydCgpOw0KICAgICAgICAgICAgJHRoaXMtPmlzc2Vzc2lvbiA9IHRydWU7DQoNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOe7iOatonNlc3Npb24uDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gRW5kU2Vzc2lvbigpDQogICAgew0KICAgICAgICBpZiAoc2Vzc2lvbl9zdGF0dXMoKSA9PSAyKSB7DQogICAgICAgICAgICBzZXNzaW9uX3dyaXRlX2Nsb3NlKCk7DQogICAgICAgICAgICAkdGhpcy0+aXNzZXNzaW9uID0gZmFsc2U7DQoNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIExvYWQgb3IgUmVMb2Fk5o+S5Lu2Q29uZmlnc+ihqC4NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gTG9hZENvbmZpZ3MoKQ0KICAgIHsNCiAgICAgICAgJHRoaXMtPkxvYWRDb25maWdzT25seVN5c3RlbSh0cnVlKTsNCiAgICAgICAgJHRoaXMtPkxvYWRDb25maWdzT25seVN5c3RlbShmYWxzZSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6L295YWl5o+S5Lu2Q29uZmlnc+ihqCBPbmx5IFN5c3RlbSBPcHRpb24uDQogICAgICovDQogICAgcHJpdmF0ZSAkcHJ2Q29uZmlnTGlzdCA9IG51bGw7DQoNCiAgICBwdWJsaWMgZnVuY3Rpb24gTG9hZENvbmZpZ3NPbmx5U3lzdGVtKCRvbmx5c3lzdGVtb3B0aW9uID0gdHJ1ZSkNCiAgICB7DQogICAgICAgIGlmICgkb25seXN5c3RlbW9wdGlvbiA9PSB0cnVlKSB7DQogICAgICAgICAgICAkdGhpcy0+Y29uZmlncyA9IGFycmF5KCk7DQogICAgICAgICAgICAkdGhpcy0+cHJ2Q29uZmlnTGlzdCA9IGFycmF5KCk7DQoNCiAgICAgICAgICAgICRzcWwgPSAkdGhpcy0+ZGItPnNxbC0+Z2V0KCktPnNlbGVjdCgkdGhpcy0+dGFibGVbJ0NvbmZpZyddKTsNCiAgICAgICAgICAgIC8qIEB2YXIgQ29uZmlnW10gJGFycmF5ICovDQogICAgICAgICAgICAkdGhpcy0+cHJ2Q29uZmlnTGlzdCA9ICR0aGlzLT5HZXRMaXN0T3JpZ2luKCRzcWwpOw0KICAgICAgICB9DQoNCiAgICAgICAgJHR5cGUgPSAnQ29uZmlnJzsNCg0KICAgICAgICBmb3JlYWNoICgkdGhpcy0+cHJ2Q29uZmlnTGlzdCBhcyAkYykgew0KICAgICAgICAgICAgJG5hbWUgPSAkY1skdGhpcy0+ZFsnQ29uZmlnJ11bJ05hbWUnXVswXV07DQogICAgICAgICAgICBpZiAoKCRuYW1lID09ICdzeXN0ZW0nICYmICRvbmx5c3lzdGVtb3B0aW9uID09IHRydWUpIHx8ICgkbmFtZSAhPSAnc3lzdGVtJyAmJiAkb25seXN5c3RlbW9wdGlvbiA9PSBmYWxzZSkpIHsNCiAgICAgICAgICAgICAgICBpZiAoIWlzc2V0KCR0aGlzLT5jb25maWdzWyRuYW1lXSkpIHsNCiAgICAgICAgICAgICAgICAgICAgJGwgPSBuZXcgJHR5cGUoJG5hbWUpOw0KICAgICAgICAgICAgICAgICAgICAkdGhpcy0+Y29uZmlnc1skbmFtZV0gPSAkbDsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAkbCA9ICR0aGlzLT5jb25maWdzWyRuYW1lXTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKGdldF9jbGFzcygkbCkgIT0gJHR5cGUpIHsNCiAgICAgICAgICAgICAgICAgICAgJGwgPSBuZXcgJHR5cGUoJG5hbWUpOw0KICAgICAgICAgICAgICAgICAgICAkdGhpcy0+Y29uZmlnc1skbmFtZV0gPSAkbDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKGlzc2V0KCRjWyR0aGlzLT5kWydDb25maWcnXVsnS2V5J11bMF1dKSAmJiAkY1skdGhpcy0+ZFsnQ29uZmlnJ11bJ0tleSddWzBdXSAhPSAnJykgew0KICAgICAgICAgICAgICAgICAgICAkbC0+TG9hZEluZm9CeUFzc29jU2luZ2xlV2l0aFByZSgkYyk7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgJGwtPkxvYWRJbmZvQnlBc3NvYygkYyk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIC8v5bCG6K+75Ye65p2l55qE5pWw57uE5YaN5ou85oiQ5bqP5YiX5YyW5pWw5o2u5YaN5Y+N5bqP5YiX5YyWDQogICAgICAgIGZvcmVhY2ggKCR0aGlzLT5jb25maWdzIGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICAgICBpZiAoaXNfb2JqZWN0KCR2YWx1ZSkgJiYgKCRrZXkgPT0gJ3N5c3RlbScgJiYgJG9ubHlzeXN0ZW1vcHRpb24gPT0gdHJ1ZSkgfHwgKCRrZXkgIT0gJ3N5c3RlbScgJiYgJG9ubHlzeXN0ZW1vcHRpb24gPT0gZmFsc2UpKSB7DQogICAgICAgICAgICAgICAgJHZhbHVlLT5Mb2FkSW5mb0J5QXNzb2NTaW5nbGVXaXRoQWZ0ZXIoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIGlmICgkb25seXN5c3RlbW9wdGlvbiA9PSBmYWxzZSkgew0KICAgICAgICAgICAgJHRoaXMtPnBydkNvbmZpZ0xpc3QgPSBhcnJheSgpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5L+d5a2YQ29uZmlnc+ihqC4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUgQ29uZmlnc+ihqOWQjQ0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFNhdmVDb25maWcoJG5hbWUpDQogICAgew0KICAgICAgICBpZiAoIWlzc2V0KCR0aGlzLT5jb25maWdzWyRuYW1lXSkpIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgICR0aGlzLT5jb25maWdzWyRuYW1lXS0+U2F2ZSgpOw0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWIoOmZpENvbmZpZ3PooaguDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRuYW1lIENvbmZpZ3PooajlkI0NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBEZWxDb25maWcoJG5hbWUpDQogICAgew0KICAgICAgICBpZiAoIWlzc2V0KCR0aGlzLT5jb25maWdzWyRuYW1lXSkpIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgICR0aGlzLT5jb25maWdzWyRuYW1lXS0+RGVsZXRlKCk7DQogICAgICAgIHVuc2V0KCR0aGlzLT5jb25maWdzWyRuYW1lXSk7DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6I635Y+WQ29uZmlnc+ihqOWAvA0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbmFtZSBDb25maWdz6KGo5ZCNDQogICAgICoNCiAgICAgKiBAcmV0dXJuIG1peGVkDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIENvbmZpZygkbmFtZSkNCiAgICB7DQogICAgICAgIGlmICghaXNzZXQoJHRoaXMtPmNvbmZpZ3NbJG5hbWVdKSkgew0KICAgICAgICAgICAgJG5hbWUgPSBGaWx0ZXJDb3JyZWN0TmFtZSgkbmFtZSk7DQogICAgICAgICAgICBpZiAoISRuYW1lKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAkdGhpcy0+Y29uZmlnc1skbmFtZV0gPSBuZXcgQ29uZmlnKCRuYW1lKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAkdGhpcy0+Y29uZmlnc1skbmFtZV07DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5p+l5p+QQ29uZmln5piv5ZCm5a2Y5ZyoLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbmFtZSBDb25maWdz6KGo5ZCNDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gSGFzQ29uZmlnKCRuYW1lKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuIGlzc2V0KCR0aGlzLT5jb25maWdzWyRuYW1lXSkgJiYgJHRoaXMtPmNvbmZpZ3NbJG5hbWVdLT5Db3VudEl0ZW0oKSA+IDA7DQogICAgfQ0KDQogICAgLy8jIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCiAgICAvL0NhY2hl55u45YWzDQogICAgcHJpdmF0ZSAkY2FjaGVfaGFzaCA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiDkv53lrZjnvJPlrZguDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gU2F2ZUNhY2hlKCkNCiAgICB7DQogICAgICAgIC8vJHM9JHRoaXMtPmNhY2hlZGlyIC4gJycgLiAkdGhpcy0+Z3VpZCAuICcuY2FjaGUnOw0KICAgICAgICAvLyRjPXNlcmlhbGl6ZSgkdGhpcy0+Y2FjaGUpOw0KICAgICAgICAvL0BmaWxlX3B1dF9jb250ZW50cygkcywgJGMpOw0KICAgICAgICAvLyR0aGlzLT5jb25maWdzWydjYWNoZSddPSR0aGlzLT5jYWNoZTsNCiAgICAgICAgJG5ld19oYXNoID0gbWQ1KCR0aGlzLT5Db25maWcoJ2NhY2hlJykpOw0KICAgICAgICBpZiAoJHRoaXMtPmNhY2hlX2hhc2ggPT0gJG5ld19oYXNoKSB7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KDQogICAgICAgICR0aGlzLT5TYXZlQ29uZmlnKCdjYWNoZScpOw0KICAgICAgICAkdGhpcy0+Y2FjaGVfaGFzaCA9ICRuZXdfaGFzaDsNCg0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDliqDovb3nvJPlrZguDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gTG9hZENhY2hlKCkNCiAgICB7DQogICAgICAgICR0aGlzLT5jYWNoZSA9ICR0aGlzLT5Db25maWcoJ2NhY2hlJyk7DQogICAgICAgICR0aGlzLT5jYWNoZV9oYXNoID0gbWQ1KCR0aGlzLT5Db25maWcoJ2NhY2hlJykpOw0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOS/neWtmOmFjee9ri4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBTYXZlT3B0aW9uKCkNCiAgICB7DQogICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfQ0xTSUQnXSA9ICR0aGlzLT5ndWlkOw0KDQogICAgICAgIHVuc2V0KCR0aGlzLT5vcHRpb25bJ1pDX1BFUk1BTkVOVF9ET01BSU5fV0hPTEVfRElTQUJMRSddKTsNCiAgICAgICAgdW5zZXQoJHRoaXMtPm9wdGlvblsnWkNfUEVSTUFORU5UX0RPTUFJTl9GT1JDRURfVVJMJ10pOw0KDQogICAgICAgICRyZXNlcnZlX2tleXMgPSBleHBsb2RlKCd8Jywgc2VsZjo6T1BUSU9OX1JFU0VSVkVfS0VZUyk7DQoNCiAgICAgICAgaWYgKGZpbGVfZXhpc3RzKCR0aGlzLT51c2Vyc2RpciAuICdjX29wdGlvbi5waHAnKSA9PSBmYWxzZSkgew0KICAgICAgICAgICAgJHMgPSAiPCI7DQogICAgICAgICAgICAkcyAuPSAiP3BocFxyXG4iOw0KICAgICAgICAgICAgJHMgLj0gInJldHVybiAiOw0KICAgICAgICAgICAgJG9wdGlvbiA9IGFycmF5KCk7DQogICAgICAgICAgICBmb3JlYWNoICgkdGhpcy0+b3B0aW9uIGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICAgICAgICAgaWYgKGluX2FycmF5KCRrZXksICRyZXNlcnZlX2tleXMpKSB7DQogICAgICAgICAgICAgICAgICAgICRvcHRpb25bJGtleV0gPSAkdmFsdWU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgJHMgLj0gdmFyX2V4cG9ydCgkb3B0aW9uLCB0cnVlKTsNCiAgICAgICAgICAgICRzIC49ICI7IjsNCiAgICAgICAgICAgIEBmaWxlX3B1dF9jb250ZW50cygkdGhpcy0+dXNlcnNkaXIgLiAnY19vcHRpb24ucGhwJywgJHMpOw0KICAgICAgICB9DQoNCiAgICAgICAgZm9yZWFjaCAoJHRoaXMtPm9wdGlvbiBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAgICAgJHRoaXMtPkNvbmZpZygnc3lzdGVtJyktPiRrZXkgPSAkdmFsdWU7DQogICAgICAgIH0NCiAgICAgICAgZm9yZWFjaCAoJHJlc2VydmVfa2V5cyBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAgICAgJHRoaXMtPkNvbmZpZygnc3lzdGVtJyktPkRlbEtleSgkdmFsdWUpOw0KICAgICAgICB9DQoNCiAgICAgICAgJHRoaXMtPkNvbmZpZygnc3lzdGVtJyktPlpDX0JMT0dfSE9TVCA9IGNodW5rX3NwbGl0KCR0aGlzLT5Db25maWcoJ3N5c3RlbScpLT5aQ19CTE9HX0hPU1QsIDEsICJ8Iik7DQoNCiAgICAgICAgJHRoaXMtPlNhdmVDb25maWcoJ3N5c3RlbScpOw0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOi9veWFpemFjee9ri4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBMb2FkT3B0aW9uKCkNCiAgICB7DQogICAgICAgICRhcnJheSA9ICR0aGlzLT5Db25maWcoJ3N5c3RlbScpLT5HZXREYXRhKCk7DQoNCiAgICAgICAgaWYgKGVtcHR5KCRhcnJheSkpIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmICghaXNfYXJyYXkoJGFycmF5KSkgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgJHJlc2VydmVfa2V5cyA9IGV4cGxvZGUoJ3wnLCBzZWxmOjpPUFRJT05fUkVTRVJWRV9LRVlTKTsNCg0KICAgICAgICBmb3JlYWNoICgkYXJyYXkgYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgICAgIGlmICgka2V5ID09ICdaQ19CTE9HX0hPU1QnKSB7DQogICAgICAgICAgICAgICAgJHZhbHVlID0gc3RyX3JlcGxhY2UoJ3wnLCAnJywgJHZhbHVlKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKGluX2FycmF5KCRrZXksICRyZXNlcnZlX2tleXMpKSB7DQogICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJGtleV0gPSAkdmFsdWU7DQogICAgICAgIH0NCiAgICAgICAgaWYgKCFleHRlbnNpb25fbG9hZGVkKCdnZCcpKSB7DQogICAgICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19DT01NRU5UX1ZFUklGWV9FTkFCTEUnXSA9IGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6aqM6K+B5pON5L2c5p2D6ZmQLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAgICAgJGFjdGlvbiDmk43kvZwNCiAgICAgKiBAcGFyYW0gaW50fHN0cmluZyAkbGV2ZWwNCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBDaGVja1JpZ2h0cygkYWN0aW9uLCAkbGV2ZWwgPSBudWxsKQ0KICAgIHsNCiAgICAgICAgaWYgKCRsZXZlbCA9PT0gbnVsbCkgew0KICAgICAgICAgICAgJGxldmVsID0gJHRoaXMtPnVzZXItPkxldmVsOw0KICAgICAgICB9DQoNCiAgICAgICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fWmJwX0NoZWNrUmlnaHRzJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICAgICAkZnByZXR1cm4gPSAkZnBuYW1lKCRhY3Rpb24sICRsZXZlbCk7DQogICAgICAgICAgICBpZiAoJGZwc2lnbmFsID09IFBMVUdJTl9FWElUU0lHTkFMX1JFVFVSTikgew0KICAgICAgICAgICAgICAgICRmcHNpZ25hbCA9IFBMVUdJTl9FWElUU0lHTkFMX05PTkU7DQoNCiAgICAgICAgICAgICAgICByZXR1cm4gJGZwcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGlmICghaXNzZXQoJHRoaXMtPmFjdGlvbnNbJGFjdGlvbl0pKSB7DQogICAgICAgICAgICBpZiAoaXNfbnVtZXJpYygkYWN0aW9uKSkgew0KICAgICAgICAgICAgICAgIHJldHVybiAkbGV2ZWwgPD0gJGFjdGlvbjsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICRsZXZlbCA8PSAkdGhpcy0+YWN0aW9uc1skYWN0aW9uXTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmoLnmja7nlKjmiLfnrYnnuqfpqozor4Hmk43kvZzmnYPpmZAgMS415byA5aeL5Y+C5pWw5o2i6aG65bqPLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkYWN0aW9uIOaTjeS9nA0KICAgICAqIEBwYXJhbSBpbnQgICAgJGxldmVsICDnlKjmiLfnrYnnuqcNCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBDaGVja1JpZ2h0c0J5TGV2ZWwoJGFjdGlvbiwgJGxldmVsKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuICR0aGlzLT5DaGVja1JpZ2h0cygkYWN0aW9uLCAkbGV2ZWwpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmqjOivgeeUqOaIt+eZu+W9lS4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBWZXJpZnkoKQ0KICAgIHsNCiAgICAgICAgLy8g5Zyo5pmu6YCaIFdlYiDpobXpnaLkuK0NCiAgICAgICAgJHVzZXJuYW1lID0gdHJpbShHZXRWYXJzKCd1c2VybmFtZV8nIC4gaGFzaCgiY3JjMzJiIiwgJHRoaXMtPmd1aWQpLCAnQ09PS0lFJykpOw0KICAgICAgICAkdG9rZW4gPSB0cmltKEdldFZhcnMoJ3Rva2VuXycgLiBoYXNoKCJjcmMzMmIiLCAkdGhpcy0+Z3VpZCksICdDT09LSUUnKSk7DQogICAgICAgICR1c2VyID0gJHRoaXMtPlZlcmlmeVVzZXJUb2tlbigkdG9rZW4sICR1c2VybmFtZSk7DQoNCiAgICAgICAgaWYgKGlzX29iamVjdCgkdXNlcikpIHsNCiAgICAgICAgICAgICR0aGlzLT51c2VyID0gJHVzZXI7DQogICAgICAgICAgICAkdGhpcy0+aXNsb2dpbiA9IHRydWU7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KICAgICAgICAkdGhpcy0+dXNlciA9IG5ldyBNZW1iZXIoKTsNCiAgICAgICAgJHRoaXMtPnVzZXItPkd1aWQgPSBHZXRHdWlkKCk7DQogICAgICAgICR0aGlzLT5pc2xvZ2luID0gZmFsc2U7DQoNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOi/lOWbnueZu+W9leaIkOWKn+WQjuW6lOS/neWtmOeahGNvb2tpZeS/oeaBry4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBNZW1iZXIgJG0g5bey6aqM6L+H5oiQ5Yqf55qEbWVtYmVyDQogICAgICoNCiAgICAgKiBAcmV0dXJuIHN0cmluZw0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBWZXJpZnlSZXN1bHQoJG0pDQogICAgew0KICAgICAgICByZXR1cm4gJHRoaXMtPkdlbmVyYXRlVXNlclRva2VuKCRtKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDnlJ/miJBVc2VyIFRva2Vu77yM55So5LqO55m75b2V6aqM6K+BDQogICAgICoNCiAgICAgKiBAcGFyYW0gTWVtYmVyICR1c2VyDQogICAgICogQHBhcmFtIGludCAgICAkdGltZQ0KICAgICAqDQogICAgICogQHJldHVybiBzdHJpbmcNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2VuZXJhdGVVc2VyVG9rZW4oJHVzZXIsICR0aW1lID0gMCkNCiAgICB7DQogICAgICAgIGlmICgkdGltZSA9PT0gMCkgew0KICAgICAgICAgICAgJHRpbWUgPSAodGltZSgpICsgMzYwMCAqIDI0KTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiBDcmVhdGVXZWJUb2tlbigkdXNlci0+SUQsICR0aW1lLCAkdXNlci0+R3VpZCwgJHVzZXItPlBhc3NXb3JkX01ENVBhdGgpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOeUn+aIkEFwaSBUb2tlbu+8jOeUqOS6jiBBUEkg5qih5byP5LiL55qE55So5oi36aqM6K+BLg0KICAgICAqDQogICAgICogQHBhcmFtIE1lbWJlciAkdXNlcg0KICAgICAqIEBwYXJhbSBpbnQgICAgJHRpbWUNCiAgICAgKg0KICAgICAqIEByZXR1cm4gc3RyaW5nDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdlbmVyYXRlQXBpVG9rZW4oJHVzZXIsICR0aW1lID0gMCkNCiAgICB7DQogICAgICAgIHJldHVybiBiYXNlNjRfZW5jb2RlKCR1c2VyLT5OYW1lIC4gJ3x8fCcgLiAkdGhpcy0+R2VuZXJhdGVVc2VyVG9rZW4oJHVzZXIsIChpbnQpICR0aW1lKSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6aqM6K+B55So5oi355m75b2VVG9rZW4uDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICR0b2tlbg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHVzZXJuYW1lDQogICAgICoNCiAgICAgKiBAcmV0dXJuIE1lbWJlcnxudWxsDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFZlcmlmeVVzZXJUb2tlbigkdG9rZW4sICR1c2VybmFtZSkNCiAgICB7DQogICAgICAgICR1c2VyID0gJHRoaXMtPkdldE1lbWJlckJ5TmFtZSgkdXNlcm5hbWUpOw0KICAgICAgICBpZiAoJHVzZXItPklEICE9IG51bGwpIHsNCiAgICAgICAgICAgIGlmIChWZXJpZnlXZWJUb2tlbigkdG9rZW4sICR1c2VyLT5JRCwgJHVzZXItPkd1aWQsICR1c2VyLT5QYXNzV29yZF9NRDVQYXRoKSkgew0KICAgICAgICAgICAgICAgIHJldHVybiAkdXNlcjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiBudWxsOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmqjOivgeeUqOaIt+eZu+W9le+8iOS4gOasoU1ENeWvhuegge+8iS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUgICDnlKjmiLflkI0NCiAgICAgKiBAcGFyYW0gc3RyaW5nICRtZDVwdyAgbWQ15Yqg5a+G5ZCO55qE5a+G56CBDQogICAgICogQHBhcmFtIE1lbWJlciAkbWVtYmVyIOi/lOWbnuivu+WPluaIkOWKn+eahG1lbWJlcuWvueixoQ0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFZlcmlmeV9NRDUoJG5hbWUsICRtZDVwdywgJiRtZW1iZXIpDQogICAgew0KICAgICAgICBpZiAoJG5hbWUgPT0gJycgfHwgJG1kNXB3ID09ICcnKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCiAgICAgICAgJG1lbWJlciA9ICR0aGlzLT5HZXRNZW1iZXJCeU5hbWUoJG5hbWUpOw0KICAgICAgICBpZiAoJG1lbWJlci0+SUQgIT0gbnVsbCkgew0KICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5WZXJpZnlfRmluYWwoJG5hbWUsIG1kNSgkbWQ1cHcgLiAkbWVtYmVyLT5HdWlkKSwgJG1lbWJlcik7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6aqM6K+B55So5oi355m75b2V77yI5Y6f5aeL5piO5paH5a+G56CB77yJLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbmFtZSAgICAgICDnlKjmiLflkI0NCiAgICAgKiBAcGFyYW0gc3RyaW5nICRvcmlnaW5hbHB3IOWvhueggeaYjuaWhw0KICAgICAqIEBwYXJhbSBNZW1iZXIgJG1lbWJlciAgICAg6L+U5Zue6K+75Y+W5oiQ5Yqf55qEbWVtYmVy5a+56LGhDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gVmVyaWZ5X09yaWdpbmFsKCRuYW1lLCAkb3JpZ2luYWxwdywgJiRtZW1iZXIgPSBudWxsKQ0KICAgIHsNCiAgICAgICAgaWYgKCRuYW1lID09ICcnIHx8ICRvcmlnaW5hbHB3ID09ICcnKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCiAgICAgICAgJG0gPSAkdGhpcy0+R2V0TWVtYmVyQnlOYW1lKCRuYW1lKTsNCiAgICAgICAgaWYgKCRtLT5JRCAhPSBudWxsKSB7DQogICAgICAgICAgICByZXR1cm4gJHRoaXMtPlZlcmlmeV9NRDUoJG5hbWUsIG1kNSgkb3JpZ2luYWxwdyksICRtZW1iZXIpOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmqjOivgeeUqOaIt+eZu+W9le+8iOaVsOaNruW6k+S/neWtmOeahOacgOe7iOi/kOeul+WQjuWvhuegge+8iS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUgICAgIOeUqOaIt+WQjQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHBhc3N3b3JkIOS6jOasoeWKoOWvhuWQjueahOWvhueggQ0KICAgICAqIEBwYXJhbSBvYmplY3QgJG1lbWJlciAgIOi/lOWbnuivu+WPluaIkOWKn+eahG1lbWJlcuWvueixoQ0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFZlcmlmeV9GaW5hbCgkbmFtZSwgJHBhc3N3b3JkLCAmJG1lbWJlciA9IG51bGwpDQogICAgew0KICAgICAgICBpZiAoJG5hbWUgPT0gJycgfHwgJHBhc3N3b3JkID09ICcnKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCiAgICAgICAgJG0gPSAkdGhpcy0+R2V0TWVtYmVyQnlOYW1lKCRuYW1lKTsNCiAgICAgICAgaWYgKCRtLT5JRCAhPSBudWxsKSB7DQogICAgICAgICAgICBpZiAoaGFzaF9lcXVhbHMoJG0tPlBhc3N3b3JkLCAkcGFzc3dvcmQpID09PSB0cnVlKSB7DQogICAgICAgICAgICAgICAgJG1lbWJlciA9ICRtOw0KDQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6aqM6K+B55So5oi355m75b2V77yI5L2/55SoVG9rZW7vvIzmm7/ku6Plr4bnoIHkv53lrZjvvIkuDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRuYW1lICAg55So5oi35ZCNDQogICAgICogQHBhcmFtIHN0cmluZyAkd3QgICAgIFdlYlRva2VuDQogICAgICogQHBhcmFtIHN0cmluZyAkd3RfaWQgIFdlYlRva2Vu55qESUTor4bliKvnrKYNCiAgICAgKiBAcGFyYW0gb2JqZWN0ICRtZW1iZXIg6L+U5Zue6K+75Y+W5oiQ5Yqf55qEbWVtYmVy5a+56LGhDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gVmVyaWZ5X1Rva2VuKCRuYW1lLCAkd3QsICR3dF9pZCwgJiRtZW1iZXIgPSBudWxsKQ0KICAgIHsNCiAgICAgICAgaWYgKCRuYW1lID09ICcnIHx8ICR3dCA9PSAnJykgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQogICAgICAgICRtID0gbnVsbDsNCiAgICAgICAgJG0gPSAkdGhpcy0+R2V0TWVtYmVyQnlOYW1lKCRuYW1lKTsNCiAgICAgICAgaWYgKCRtLT5JRCAhPSBudWxsKSB7DQogICAgICAgICAgICBpZiAoVmVyaWZ5V2ViVG9rZW4oJHd0LCAkd3RfaWQsICR0aGlzLT5ndWlkLCAkbS0+SUQsICRtLT5QYXNzd29yZCkgPT09IHRydWUpIHsNCiAgICAgICAgICAgICAgICAkbWVtYmVyID0gJG07DQoNCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpqozor4EgQVBJIFRva2VuLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkYXBpX3Rva2VuDQogICAgICogQHJldHVybiBNZW1iZXJ8bnVsbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBWZXJpZnlBUElUb2tlbigkYXBpX3Rva2VuKQ0KICAgIHsNCiAgICAgICAgJGFwaV90b2tlbiA9IGJhc2U2NF9kZWNvZGUoJGFwaV90b2tlbik7DQoNCiAgICAgICAgaWYgKGVtcHR5KCRhcGlfdG9rZW4pKSB7DQogICAgICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIOmqjOivgeWtl+espuS4suagvOW8j+S4uiB7dXNlcm5hbWV9fHx8e3Rva2VufQ0KICAgICAgICAkYXBpX3Rva2VuX2FycmF5ID0gZXhwbG9kZSgnfHx8JywgJGFwaV90b2tlbik7DQogICAgICAgIGlmIChjb3VudCgkYXBpX3Rva2VuX2FycmF5KSAhPT0gMikgew0KICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJHRoaXMtPlZlcmlmeVVzZXJUb2tlbigkYXBpX3Rva2VuX2FycmF5WzFdLCAkYXBpX3Rva2VuX2FycmF5WzBdKTsNCiAgICB9DQoNCiAgICBwcml2YXRlICRsb2FkbWVtYmVyc19sZXZlbCA9IDA7DQoNCiAgICAvKioNCiAgICAgKiDovb3lhaXnlKjmiLfliJfooaguDQogICAgICoNCiAgICAgKiBAcGFyYW0gaW50ICRsZXZlbCDnlKjmiLfnrYnnuqcNCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBMb2FkTWVtYmVycygkbGV2ZWwgPSAwKQ0KICAgIHsNCiAgICAgICAgJHRoaXMtPmxvYWRtZW1iZXJzX2xldmVsID0gJGxldmVsOw0KICAgICAgICBpZiAoJHRoaXMtPmxvYWRtZW1iZXJzX2xldmVsIDwgMCkgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgJHdoZXJlID0gbnVsbDsNCiAgICAgICAgaWYgKCR0aGlzLT5sb2FkbWVtYmVyc19sZXZlbCA+IDApIHsNCiAgICAgICAgICAgICR3aGVyZSA9IGFycmF5KGFycmF5KCc8PScsICdtZW1fTGV2ZWwnLCAkdGhpcy0+bG9hZG1lbWJlcnNfbGV2ZWwpKTsNCiAgICAgICAgfQ0KICAgICAgICAkdGhpcy0+bWVtYmVycyA9IGFycmF5KCk7DQogICAgICAgICR0aGlzLT5tZW1iZXJzYnluYW1lID0gYXJyYXkoKTsNCiAgICAgICAgJGFycmF5ID0gJHRoaXMtPkdldE1lbWJlckxpc3QobnVsbCwgJHdoZXJlKTsNCg0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4fliJfooajvvIjmlofnq6Av6K+E6K66L+KApuKApu+8ieS4gOasoeaAp+WwhueUqOaIt+mihOi9veWFpeWIsCBtZW1iZXJzIOmHjC4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBhcnJheSAgJGxpc3QgICAgICAgICDmlofnq6Av6K+E6K665YiX6KGo5pWw57uEDQogICAgICogQHBhcmFtIHN0cmluZyAkbWVtX2lkX2ZpZWxkIOeUqOaItyBJRCDlnKjlr7nosaHkuK3nmoTlrZfmrrXlkI0NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbGVhbg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBMb2FkTWVtYmVyc0luTGlzdCgkbGlzdCwgJG1lbV9pZF9maWVsZCA9ICdBdXRob3JJRCcpDQogICAgew0KICAgICAgICAkbWVtX2lkc19uZWVkX2xvYWQgPSBhcnJheSgpOw0KICAgICAgICANCiAgICAgICAgZm9yZWFjaCAoJGxpc3QgYXMgJG9iaikgew0KICAgICAgICAgICAgaWYgKCFpc3NldCgkb2JqLT4kbWVtX2lkX2ZpZWxkKSB8fCAoJG9iai0+JG1lbV9pZF9maWVsZCA9PSBudWxsKSkgew0KICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyDlt7Lnu4/ovb3lhaXnmoTnlKjmiLfkuI3ph43mlrDovb3lhaUNCiAgICAgICAgICAgIGlmIChpc3NldCgkdGhpcy0+bWVtYmVyc1skb2JqLT4kbWVtX2lkX2ZpZWxkXSkpIHsNCiAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgJG1lbV9pZHNfbmVlZF9sb2FkW10gPSAkb2JqLT4kbWVtX2lkX2ZpZWxkOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKGNvdW50KCRtZW1faWRzX25lZWRfbG9hZCkgPT09IDApIHsNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9DQoNCiAgICAgICAgJGFycmF5ID0gJHRoaXMtPkdldE1lbWJlckxpc3QobnVsbCwgYXJyYXkoYXJyYXkoJ0lOJywgJ21lbV9JRCcsICRtZW1faWRzX25lZWRfbG9hZCkpKTsNCg0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDnp4HmnInmlrnms5XkuYvpgJLlvZLliqDovb3liIbnsbsuDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGFycmF5DQogICAgICovDQogICAgcHJpdmF0ZSBmdW5jdGlvbiBMb2FkQ2F0ZWdvcmllc19SZWN1cnNpb24oJGRlZXAsICRpZCwgJiRsdiwgJHR5cGUpDQogICAgew0KICAgICAgICBpZiAoKCRkZWVwICsgMSkgPj0gJHRoaXMtPmNhdGVnb3J5X3JlY3Vyc2lvbl9yZWFsX2RlZXApIHsNCiAgICAgICAgICAgICR0aGlzLT5jYXRlZ29yeV9yZWN1cnNpb25fcmVhbF9kZWVwID0gKCRkZWVwICsgMSk7DQogICAgICAgIH0NCiAgICAgICAgJHN1YmFycmF5ID0gYXJyYXkoKTsNCiAgICAgICAgZm9yICgkaSA9IDA7ICRpIDwgJHRoaXMtPmNhdGVnb3J5X3JlY3Vyc2lvbl9sZXZlbDsgJGkrKykgew0KICAgICAgICAgICAgJG5hbWUgPSAnbHYnIC4gJGk7DQogICAgICAgICAgICAkeyRuYW1lfSA9ICYkbHZbJGldOw0KICAgICAgICB9DQogICAgICAgICRsdmRlZXAgPSAnbHYnIC4gJGRlZXA7DQogICAgICAgICR0aGlzLT5jYXRlZ29yaWVzYnlvcmRlcl90eXBlWyR0eXBlXVskaWRdID0gJiR0aGlzLT5jYXRlZ29yaWVzX2FsbFskaWRdOw0KICAgICAgICBpZiAoJGRlZXAgPCAoJHRoaXMtPmNhdGVnb3J5X3JlY3Vyc2lvbl9sZXZlbCAtIDEpKSB7DQogICAgICAgICAgICAkZGVlcCArPSAxOw0KICAgICAgICAgICAgJGx2ZGVlcG5leHQgPSAnbHYnIC4gJGRlZXA7DQogICAgICAgICAgICBpZiAoaXNzZXQoJHskbHZkZWVwbmV4dH1bJGlkXSkpIHsNCiAgICAgICAgICAgICAgICBmb3JlYWNoICgkeyRsdmRlZXBuZXh0fVskaWRdIGFzICRpZG5vdykgew0KICAgICAgICAgICAgICAgICAgICAkc3ViYXJyYXlbXSA9ICRpZG5vdzsNCiAgICAgICAgICAgICAgICAgICAgJGIgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgZm9yZWFjaCAoJHRoaXMtPmNhdGVnb3JpZXNieW9yZGVyX3R5cGVbJHR5cGVdWyRpZF0tPlN1YkNhdGVnb3JpZXMgYXMgJGtleTIgPT4gJHZhbHVlMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCR2YWx1ZTItPklEID09ICRpZG5vdykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICRiID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBpZiAoJGIgPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5jYXRlZ29yaWVzYnlvcmRlcl90eXBlWyR0eXBlXVskaWRdLT5TdWJDYXRlZ29yaWVzW10gPSAmJHRoaXMtPmNhdGVnb3JpZXNfYWxsWyRpZG5vd107DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgLy8kdGhpcy0+Y2F0ZWdvcmllc2J5b3JkZXJbJGlkXS0+Q2hpbGRyZW5DYXRlZ29yaWVzW10gPSAmJHRoaXMtPmNhdGVnb3JpZXNbJGlkbm93XTsNCiAgICAgICAgICAgICAgICAgICAgJGFycmF5ID0gJHRoaXMtPkxvYWRDYXRlZ29yaWVzX1JlY3Vyc2lvbigkZGVlcCwgJGlkbm93LCAkbHYsICR0eXBlKTsNCiAgICAgICAgICAgICAgICAgICAgZm9yZWFjaCAoJGFycmF5IGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAkc3ViYXJyYXlbXSA9ICR2YWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICAkc3ViYXJyYXkgPSBhcnJheV91bmlxdWUoJHN1YmFycmF5KTsNCiAgICAgICAgZm9yZWFjaCAoJHN1YmFycmF5IGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICAgICAkYiA9IGZhbHNlOw0KICAgICAgICAgICAgZm9yZWFjaCAoJHRoaXMtPmNhdGVnb3JpZXNieW9yZGVyX3R5cGVbJHR5cGVdWyRpZF0tPkNoaWxkcmVuQ2F0ZWdvcmllcyBhcyAka2V5MiA9PiAkdmFsdWUyKSB7DQogICAgICAgICAgICAgICAgaWYgKCR2YWx1ZTItPklEID09ICR2YWx1ZSkgew0KICAgICAgICAgICAgICAgICAgICAkYiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICgkYiA9PSBmYWxzZSkgew0KICAgICAgICAgICAgICAgICR0aGlzLT5jYXRlZ29yaWVzYnlvcmRlcl90eXBlWyR0eXBlXVskaWRdLT5DaGlsZHJlbkNhdGVnb3JpZXNbXSA9ICYkdGhpcy0+Y2F0ZWdvcmllc19hbGxbJHZhbHVlXTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gJHN1YmFycmF5Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOi9veWFpeWIhuexu+WIl+ihqC4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBMb2FkQ2F0ZWdvcmllcygpDQogICAgew0KICAgICAgICAkdGhpcy0+Y2F0ZWdvcmllc19hbGwgPSBhcnJheSgpOw0KDQogICAgICAgICR0aGlzLT5jYXRlZ29yaWVzYnlvcmRlciA9IGFycmF5KCk7DQogICAgICAgICR0aGlzLT5jYXRlZ29yaWVzID0gJiR0aGlzLT5jYXRlZ29yaWVzYnlvcmRlcjsNCg0KICAgICAgICAkdGhpcy0+Y2F0ZWdvcmllc2J5b3JkZXJfdHlwZSA9IGFycmF5KCk7DQogICAgICAgICR0aGlzLT5jYXRlZ29yaWVzX3R5cGUgPSBhcnJheSgpOw0KDQogICAgICAgICR0aGlzLT5jYXRlZ29yeXMgPSAmJHRoaXMtPmNhdGVnb3JpZXM7DQogICAgICAgICR0aGlzLT5jYXRlZ29yeXNieW9yZGVyID0gJiR0aGlzLT5jYXRlZ29yaWVzYnlvcmRlcjsNCg0KICAgICAgICBmb3JlYWNoICgkdGhpcy0+cG9zdHR5cGUgYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgICAgIGlmICghaXNzZXQoJHRoaXMtPmNhdGVnb3JpZXNfdHlwZVska2V5XSkpIHsNCiAgICAgICAgICAgICAgICAkdGhpcy0+Y2F0ZWdvcmllc190eXBlWyRrZXldID0gYXJyYXkoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICghaXNzZXQoJHRoaXMtPmNhdGVnb3JpZXNieW9yZGVyX3R5cGVbJGtleV0pKSB7DQogICAgICAgICAgICAgICAgJHRoaXMtPmNhdGVnb3JpZXNieW9yZGVyX3R5cGVbJGtleV0gPSBhcnJheSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgJGFycmF5ID0gJHRoaXMtPkdldENhdGVnb3J5TGlzdChudWxsLCBudWxsLCBhcnJheSgnY2F0ZV9PcmRlcicgPT4gJ0FTQycpLCBudWxsLCBudWxsKTsNCiAgICAgICAgaWYgKGNvdW50KCRhcnJheSkgPT0gMCkgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgZm9yZWFjaCAoJHRoaXMtPnBvc3R0eXBlIGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICAgICAkbHYgPSBhcnJheSgpOw0KICAgICAgICAgICAgZm9yICgkaSA9IDA7ICRpIDwgJHRoaXMtPmNhdGVnb3J5X3JlY3Vyc2lvbl9sZXZlbDsgJGkrKykgew0KICAgICAgICAgICAgICAgICRuYW1lID0gJ2x2JyAuICRpOw0KICAgICAgICAgICAgICAgICR7JG5hbWV9ID0gYXJyYXkoKTsNCiAgICAgICAgICAgICAgICAkbHZbJGldID0gJiR7JG5hbWV9Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgJGNhdGVnb3JpZXMgPSAkdGhpcy0+Y2F0ZWdvcmllc190eXBlWyRrZXldOw0KDQogICAgICAgICAgICBmb3JlYWNoICgkY2F0ZWdvcmllcyBhcyAkaWQgPT4gJGMpIHsNCiAgICAgICAgICAgICAgICAkbCA9ICdsdicgLiAkYy0+TGV2ZWw7DQogICAgICAgICAgICAgICAgJHskbH1bJGMtPlBhcmVudElEXVtdID0gJGlkOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIWlzc2V0KCRsdjBbMF0pKSB7DQogICAgICAgICAgICAgICAgJGx2MFswXSA9IGFycmF5KCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGZvcmVhY2ggKCRsdjBbMF0gYXMgJGlkMCkgew0KICAgICAgICAgICAgICAgICR0aGlzLT5Mb2FkQ2F0ZWdvcmllc19SZWN1cnNpb24oMCwgJGlkMCwgJGx2LCAka2V5KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgICR0aGlzLT5jYXRlZ29yaWVzX3R5cGUgPSAmJHRoaXMtPmNhdGVnb3JpZXNieW9yZGVyX3R5cGU7DQogICAgICAgICR0aGlzLT5jYXRlZ29yaWVzYnlvcmRlciA9ICYkdGhpcy0+Y2F0ZWdvcmllc2J5b3JkZXJfdHlwZVswXTsNCiAgICAgICAgJHRoaXMtPmNhdGVnb3JpZXMgPSAmJHRoaXMtPmNhdGVnb3JpZXNieW9yZGVyOw0KICAgICAgICAkdGhpcy0+Y2F0ZWdvcnlzID0gJiR0aGlzLT5jYXRlZ29yaWVzOw0KICAgICAgICAkdGhpcy0+Y2F0ZWdvcnlzYnlvcmRlciA9ICYkdGhpcy0+Y2F0ZWdvcmllc2J5b3JkZXI7DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6L295YWl5qCH562+5YiX6KGoLg0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIExvYWRUYWdzKCkNCiAgICB7DQogICAgICAgICR0aGlzLT50YWdzX3R5cGUgPSBhcnJheSgpOw0KICAgICAgICAkdGhpcy0+dGFnc2J5bmFtZV90eXBlID0gYXJyYXkoKTsNCg0KICAgICAgICAkdGhpcy0+dGFncyA9IGFycmF5KCk7DQogICAgICAgICR0aGlzLT50YWdzYnluYW1lID0gYXJyYXkoKTsNCg0KICAgICAgICAkdGhpcy0+dGFnc19hbGwgPSBhcnJheSgpOw0KDQogICAgICAgICRhcnJheSA9ICR0aGlzLT5HZXRUYWdMaXN0KCk7DQoNCiAgICAgICAgaXNzZXQoJHRoaXMtPnRhZ3NfdHlwZVswXSkgfHwgJHRoaXMtPnRhZ3NfdHlwZVswXSA9IGFycmF5KCk7DQogICAgICAgIGlzc2V0KCR0aGlzLT50YWdzYnluYW1lX3R5cGVbMF0pIHx8ICR0aGlzLT50YWdzYnluYW1lX3R5cGVbMF0gPSBhcnJheSgpOw0KDQogICAgICAgICR0aGlzLT50YWdzID0gJiR0aGlzLT50YWdzX3R5cGVbMF07DQogICAgICAgICR0aGlzLT50YWdzYnluYW1lID0gJiR0aGlzLT50YWdzYnluYW1lX3R5cGVbMF07DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6L295YWl5qih5Z2X5YiX6KGoLg0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIExvYWRNb2R1bGVzKCkNCiAgICB7DQogICAgICAgICR0aGlzLT5tb2R1bGVzID0gYXJyYXkoKTsNCiAgICAgICAgJHRoaXMtPm1vZHVsZXNieWZpbGVuYW1lID0gYXJyYXkoKTsNCiAgICAgICAgJGFycmF5ID0gJHRoaXMtPkdldE1vZHVsZUxpc3QoKTsNCg0KICAgICAgICAkZGlyID0gJHRoaXMtPnVzZXJzZGlyIC4gJ3RoZW1lLycgLiAkdGhpcy0+dGhlbWUgLiAnL2luY2x1ZGUvJzsNCiAgICAgICAgaWYgKGZpbGVfZXhpc3RzKCRkaXIpKSB7DQogICAgICAgICAgICAkZmlsZXMgPSBHZXRGaWxlc0luRGlyKCRkaXIsICdwaHAnKTsNCiAgICAgICAgICAgIGZvcmVhY2ggKCRmaWxlcyBhcyAkc29ydG5hbWUgPT4gJGZ1bGxuYW1lKSB7DQogICAgICAgICAgICAgICAgJG0gPSBuZXcgTW9kdWxlKCk7DQogICAgICAgICAgICAgICAgJG0tPkZpbGVOYW1lID0gJHNvcnRuYW1lOw0KICAgICAgICAgICAgICAgICRtLT5OYW1lID0gJHNvcnRuYW1lOw0KICAgICAgICAgICAgICAgICRtLT5IdG1sSUQgPSAkc29ydG5hbWU7DQogICAgICAgICAgICAgICAgJG0tPkNvbnRlbnQgPSBmaWxlX2dldF9jb250ZW50cygkZnVsbG5hbWUpOw0KICAgICAgICAgICAgICAgIGlmIChzdHJpcG9zKCRtLT5Db250ZW50LCAnPGxpJykgIT09IGZhbHNlICYmIHN0cmlwb3MoJG0tPkNvbnRlbnQsICc8L2xpPicpICE9PSBmYWxzZSkgew0KICAgICAgICAgICAgICAgICAgICAkbS0+VHlwZSA9ICd1bCc7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgJG0tPlR5cGUgPSAnZGl2JzsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgJG0tPlNvdXJjZSA9ICd0aGVtZWluY2x1ZGVfJyAuICR0aGlzLT50aGVtZTsNCiAgICAgICAgICAgICAgICAkbS0+SUQgPSAoMCAtIChpbnQpIGNyYzMyKCRtLT5Tb3VyY2UgLiAkbS0+RmlsZU5hbWUpKTsNCiAgICAgICAgICAgICAgICAkdGhpcy0+QWRkQ2FjaGUoJG0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6L295YWl5Li76aKY5YiX6KGoLg0KICAgICAqDQogICAgICogQHJldHVybiBBcHBbXQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBMb2FkVGhlbWVzKCkNCiAgICB7DQogICAgICAgICRhbGxUaGVtZXMgPSBhcnJheSgpOw0KICAgICAgICAkZGlycyA9IEdldERpcnNJbkRpcigkdGhpcy0+dXNlcnNkaXIgLiAndGhlbWUvJyk7DQogICAgICAgIG5hdGNhc2Vzb3J0KCRkaXJzKTsNCiAgICAgICAgYXJyYXlfdW5zaGlmdCgkZGlycywgJHRoaXMtPnRoZW1lKTsNCiAgICAgICAgJGRpcnMgPSBhcnJheV91bmlxdWUoJGRpcnMpOw0KICAgICAgICBmb3JlYWNoICgkZGlycyBhcyAkaWQpIHsNCiAgICAgICAgICAgICRhcHAgPSBuZXcgQXBwKCk7DQogICAgICAgICAgICBpZiAoJGFwcC0+TG9hZEluZm9CeVhtbCgndGhlbWUnLCAkaWQpID09IHRydWUpIHsNCiAgICAgICAgICAgICAgICAkYWxsVGhlbWVzW10gPSAkYXBwOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICRhbGxUaGVtZXM7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6L295YWl5o+S5Lu25YiX6KGoLg0KICAgICAqDQogICAgICogQHJldHVybiBBcHBbXQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBMb2FkUGx1Z2lucygpDQogICAgew0KICAgICAgICAkYWxsUGx1Z2lucyA9IGFycmF5KCk7DQogICAgICAgICRkaXJzID0gR2V0RGlyc0luRGlyKCR0aGlzLT51c2Vyc2RpciAuICdwbHVnaW4vJyk7DQogICAgICAgIG5hdGNhc2Vzb3J0KCRkaXJzKTsNCg0KICAgICAgICBmb3JlYWNoICgkZGlycyBhcyAkaWQpIHsNCiAgICAgICAgICAgICRhcHAgPSBuZXcgQXBwKCk7DQogICAgICAgICAgICBpZiAoJGFwcC0+TG9hZEluZm9CeVhtbCgncGx1Z2luJywgJGlkKSA9PSB0cnVlKSB7DQogICAgICAgICAgICAgICAgJGFsbFBsdWdpbnNbXSA9ICRhcHA7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJGFsbFBsdWdpbnM7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6L295YWl5oyH5a6a5bqU55SoLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkdHlwZSDlupTnlKjnsbvlnosodGhlbWV8cGx1Z2luKQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgJGlkICAg5bqU55SoSUQNCiAgICAgKg0KICAgICAqIEByZXR1cm4gQXBwDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIExvYWRBcHAoJHR5cGUsICRpZCkNCiAgICB7DQogICAgICAgICRhcHAgPSBuZXcgQXBwKCk7DQogICAgICAgIGlmICgkYXBwLT5Mb2FkSW5mb0J5WG1sKCR0eXBlLCAkaWQpICE9IHRydWUpIHsNCiAgICAgICAgICAgICRhcHAtPmlzbG9hZGVkID0gZmFsc2U7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJGFwcDsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmo4Dmn6XlupTnlKjmmK/lkKblronoo4XlubblkK/nlKguDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRuYW1lIOW6lOeUqO+8iOaPkuS7tuaIluS4u+mimO+8ieeahElEDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQ2hlY2tQbHVnaW4oJG5hbWUpDQogICAgew0KICAgICAgICByZXR1cm4gaW5fYXJyYXkoJG5hbWUsICR0aGlzLT5hY3RpdmVkYXBwcyk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5qOA5p+l5bqU55So5piv5ZCm5a6J6KOF5bm25ZCv55SoLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbmFtZSDlupTnlKhJRO+8iOaPkuS7tuaIluS4u+mimO+8iQ0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIENoZWNrQXBwKCRuYW1lKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuICR0aGlzLT5DaGVja1BsdWdpbigkbmFtZSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6I635Y+W6aKE5r+A5rS75o+S5Lu25ZCN5pWw57uELg0KICAgICAqDQogICAgICogQHJldHVybiBzdHJpbmdbXQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRQcmVBY3RpdmVQbHVnaW4oKQ0KICAgIHsNCiAgICAgICAgJGFwID0gZXhwbG9kZSgifCIsICR0aGlzLT5vcHRpb25bJ1pDX1VTSU5HX1BMVUdJTl9MSVNUJ10pOw0KICAgICAgICAkYXAgPSBhcnJheV91bmlxdWUoJGFwKTsNCg0KICAgICAgICByZXR1cm4gJGFwOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOi9veWFpeaMh+WumuW6lOeUqOivreiogOWMhS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHR5cGUgICAg5bqU55So57G75Z6LKHN5c3RlbXx0aGVtZXxwbHVnaW4pDQogICAgICogQHBhcmFtIHN0cmluZyAkaWQgICAgICDlupTnlKhJRA0KICAgICAqIEBwYXJhbSBzdHJpbmcgJGRlZmF1bHQg6buY6K6k6K+t6KiADQogICAgICoNCiAgICAgKiBAdGhyb3dzIEV4Y2VwdGlvbg0KICAgICAqDQogICAgICogQHJldHVybiBudWxsDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIExvYWRMYW5ndWFnZSgkdHlwZSwgJGlkLCAkZGVmYXVsdCA9ICcnKQ0KICAgIHsNCiAgICAgICAgJGxhbmd1YWdlUGF0aCA9ICR0aGlzLT5wYXRoOw0KICAgICAgICAkbGFuZ3VhZ2VSZWdFeCA9ICcvXihbMC05QS1aXC1fXSopXC5waHAkL3VpJzsNCiAgICAgICAgJGxhbmd1YWdlTGlzdCA9IGFycmF5KCk7DQogICAgICAgICRsYW5ndWFnZSA9ICcnOw0KICAgICAgICAkZGVmYXVsdCA9IHN0cl9yZXBsYWNlKGFycmF5KCcvJywgJ1xcJyksICcnLCAkZGVmYXVsdCk7DQogICAgICAgICRsYW5ndWFnZVB0ciA9ICYkdGhpcy0+bGFuZzsNCg0KICAgICAgICBpZiAoJGRlZmF1bHQgPT09ICcnKSB7DQogICAgICAgICAgICAkZGVmYXVsdCA9ICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfTEFOR1VBR0VQQUNLJ107DQogICAgICAgIH0NCg0KICAgICAgICAkZGVmYXVsdExhbmd1YWdlTGlzdCA9IGFycmF5KCRkZWZhdWx0LCAnemgtY24nLCAnemgtdHcnLCAnZW4nKTsNCg0KICAgICAgICBzd2l0Y2ggKCR0eXBlKSB7DQogICAgICAgICAgICBjYXNlICdzeXN0ZW0nOg0KICAgICAgICAgICAgICAgICRsYW5ndWFnZVBhdGggLj0gJ3piX3VzZXJzL2xhbmd1YWdlLyc7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdwbHVnaW4nOg0KICAgICAgICAgICAgY2FzZSAndGhlbWUnOg0KICAgICAgICAgICAgICAgICRsYW5ndWFnZVBhdGggLj0gJ3piX3VzZXJzLycgLiAkdHlwZSAuICcvJyAuICRpZCAuICcvbGFuZ3VhZ2UvJzsNCiAgICAgICAgICAgICAgICAkbGFuZ3VhZ2VQdHIgPSAmJHRoaXMtPmxhbmdbJGlkXTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgICAgICAgJGxhbmd1YWdlUGF0aCAuPSAkdHlwZSAuICcvbGFuZ3VhZ2UvJzsNCiAgICAgICAgICAgICAgICAkbGFuZ3VhZ2VQdHIgPSAmJHRoaXMtPmxhbmdbJGlkXTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgfQ0KDQogICAgICAgICRoYW5kbGUgPSBAb3BlbmRpcigkbGFuZ3VhZ2VQYXRoKTsNCiAgICAgICAgJG1hdGNoID0gbnVsbDsNCiAgICAgICAgaWYgKCRoYW5kbGUpIHsNCiAgICAgICAgICAgIHdoaWxlIChmYWxzZSAhPT0gKCRmaWxlID0gcmVhZGRpcigkaGFuZGxlKSkpIHsNCiAgICAgICAgICAgICAgICBpZiAocHJlZ19tYXRjaCgkbGFuZ3VhZ2VSZWdFeCwgJGZpbGUsICRtYXRjaCkpIHsNCiAgICAgICAgICAgICAgICAgICAgJGxhbmd1YWdlTGlzdFtdID0gJG1hdGNoWzFdOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGNsb3NlZGlyKCRoYW5kbGUpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgLy8g6L+Z6YeM5LiN5Lya5omn6KGM5Yiw77yM5Zyob3BlbmRpcuaXtuWwseW3sue7j+aKm+WHukVfV0FSTklORw0KICAgICAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbignQ2Fubm90IG9wZW5kaXIoJyAuICRsYW5ndWFnZVBhdGggLiAnKScpOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKGNvdW50KCRsYW5ndWFnZUxpc3QpID09PSAwKSB7DQogICAgICAgICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKCdObyBsYW5ndWFnZSBpbiAnIC4gJGxhbmd1YWdlUGF0aCk7DQogICAgICAgIH0NCg0KICAgICAgICBmb3IgKCRpID0gMDsgJGkgPCBjb3VudCgkZGVmYXVsdExhbmd1YWdlTGlzdCk7ICRpKyspIHsNCiAgICAgICAgICAgIC8vIOWcqOaViOeOh+S4iu+8jGFycmF5X3NlYXJjaOWSjOWRveWQjeaVsOe7hOayoeacieacrOi0qOWMuuWIq++8jOiHs+WwkeWcqOi/memHjOWmguatpOOAgg0KICAgICAgICAgICAgaWYgKGZhbHNlICE9PSBhcnJheV9zZWFyY2goJGRlZmF1bHRMYW5ndWFnZUxpc3RbJGldLCAkbGFuZ3VhZ2VMaXN0KSkgew0KICAgICAgICAgICAgICAgICRsYW5ndWFnZSA9ICRkZWZhdWx0TGFuZ3VhZ2VMaXN0WyRpXTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBpZiAoJGxhbmd1YWdlID09PSAnJykgew0KICAgICAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbignTGFuZ3VhZ2UgJyAuICRkZWZhdWx0IC4gJyBpcyBub3QgZm91bmQgaW4gJyAuICRsYW5ndWFnZVBhdGgpOw0KICAgICAgICB9DQoNCiAgICAgICAgJGxhbmd1YWdlUGF0aCAuPSAkbGFuZ3VhZ2UgLiAnLnBocCc7DQogICAgICAgICRsYW5ndWFnZVB0ciA9IGluY2x1ZGUgJGxhbmd1YWdlUGF0aDsNCiAgICAgICAgJHRoaXMtPmxhbmdwYWNrbGlzdFtdID0gYXJyYXkoJHR5cGUsICRpZCwgJGxhbmd1YWdlKTsNCiAgICAgICAgaWYgKCR0eXBlID09ICdzeXN0ZW0nKSB7DQogICAgICAgICAgICBpZiAoaXNfcmVhZGFibGUoJHRoaXMtPnN5c3RlbWRpciAuICdkZWZlbmQvZW4ucGhwJykpIHsNCiAgICAgICAgICAgICAgICAkZGVmZW5kX2VuID0gaW5jbHVkZSAkdGhpcy0+c3lzdGVtZGlyIC4gJ2RlZmVuZC9lbi5waHAnOw0KICAgICAgICAgICAgICAgICRub3dsYW5nID0gJGxhbmd1YWdlUHRyOw0KICAgICAgICAgICAgICAgICR0aGlzLT5sYW5nID0gKCRub3dsYW5nICsgJGRlZmVuZF9lbik7DQogICAgICAgICAgICAgICAgZm9yZWFjaCAoJHRoaXMtPmxhbmcgYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGlzX2FycmF5KCR2YWx1ZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5sYW5nWyRrZXldID0gKCRub3dsYW5nWyRrZXldICsgJGRlZmVuZF9lblska2V5XSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICAkdGhpcy0+bGFuZ3MgPSBqc29uX2RlY29kZShqc29uX2VuY29kZSgkdGhpcy0+bGFuZykpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgaWYgKCRpZCAhPSAnJyAmJiBpc3NldCgkdGhpcy0+bGFuZ1skaWRdKSkgew0KICAgICAgICAgICAgICAgICR0aGlzLT5sYW5ncy0+JGlkID0ganNvbl9kZWNvZGUoanNvbl9lbmNvZGUoJHRoaXMtPmxhbmdbJGlkXSkpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fWmJwX0xvYWRMYW5ndWFnZSddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAgICAgJGZwbmFtZSgkdGhpcy0+bGFuZyk7DQogICAgICAgICAgICAkdGhpcy0+bGFuZ3MgPSBqc29uX2RlY29kZShqc29uX2VuY29kZSgkdGhpcy0+bGFuZykpOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgcHVibGljIGZ1bmN0aW9uIFJlZmx1c2hMYW5ndWFnZXMoKQ0KICAgIHsNCiAgICAgICAgJHRoaXMtPmxhbmdbJ2Vycm9yJ11bJzc3J10gPSBzdHJfcmVwbGFjZShhcnJheSgnJW1pbicsICclbWF4JyksIGFycmF5KCR0aGlzLT5vcHRpb25bJ1pDX1VTRVJOQU1FX01JTiddLCAkdGhpcy0+b3B0aW9uWydaQ19VU0VSTkFNRV9NQVgnXSksICR0aGlzLT5sYW5nWydlcnJvciddWyc3NyddKTsNCiAgICAgICAgJHRoaXMtPmxhbmdzID0ganNvbl9kZWNvZGUoanNvbl9lbmNvZGUoJHRoaXMtPmxhbmcpKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDph43mlrDor7vlj5bor63oqIDljIUuDQogICAgICoNCiAgICAgKiBAdGhyb3dzIEV4Y2VwdGlvbg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBSZWxvYWRMYW5ndWFnZXMoKQ0KICAgIHsNCiAgICAgICAgJGFycmF5ID0gJHRoaXMtPmxhbmdwYWNrbGlzdDsNCiAgICAgICAgJHRoaXMtPmxhbmcgPSAkdGhpcy0+bGFuZ3BhY2tsaXN0ID0gYXJyYXkoKTsNCiAgICAgICAgZm9yZWFjaCAoJGFycmF5IGFzICR2KSB7DQogICAgICAgICAgICAkdGhpcy0+TG9hZExhbmd1YWdlKCR2WzBdLCAkdlsxXSwgJHZbMl0pOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5Yib5bu65qih5p2/5a+56LGh77yM6aKE5Yqg6L295bey57yW6K+R5qih5p2/DQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICR0aGVtZSDmjIflrprkuLvpopjlkI0NCiAgICAgKg0KICAgICAqIEByZXR1cm4gVGVtcGxhdGUNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gUHJlcGFyZVRlbXBsYXRlKCR0aGVtZSA9IG51bGwsICR0ZW1wbGF0ZV9kaXJuYW1lID0gJ3RlbXBsYXRlJykNCiAgICB7DQogICAgICAgIGlmIChpc19udWxsKCR0aGVtZSkgfHwgZW1wdHkoJHRoZW1lKSkgew0KICAgICAgICAgICAgJHRoZW1lID0gJiR0aGlzLT50aGVtZTsNCiAgICAgICAgfQ0KDQogICAgICAgICR0ZW1wbGF0ZSA9IG5ldyBUZW1wbGF0ZSgpOw0KICAgICAgICAkdGVtcGxhdGUtPk1ha2VUZW1wbGF0ZVRhZ3MoKTsNCg0KICAgICAgICAvL+iAgeaOpeWPo++8jOWPquaUuXRlbXBsYXRlVGFnc+eahA0KICAgICAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9aYnBfTWFrZVRlbXBsYXRldGFncyddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAgICAgJGZwbmFtZSgkdGVtcGxhdGUtPnRlbXBsYXRlVGFncyk7DQogICAgICAgIH0NCg0KICAgICAgICAvL+atpOWkhOWinuWKoOaOpeWPo+WPr+S7peWcqExvYWTml7bvvIzlr7kkdGhlbWUsICR0ZW1wbGF0ZV9kaXJuYW1l5Y+C5pWw5Y+v5Lul6L+b6KGM5L+u5pS5DQogICAgICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1picF9QcmVwYXJlVGVtcGxhdGUnXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgICAgICRmcG5hbWUoJHRoZW1lLCAkdGVtcGxhdGVfZGlybmFtZSk7DQogICAgICAgIH0NCg0KICAgICAgICAkdGVtcGxhdGUtPnRoZW1lID0gJHRoZW1lOw0KICAgICAgICAkdGVtcGxhdGUtPnRlbXBsYXRlX2Rpcm5hbWUgPSAkdGVtcGxhdGVfZGlybmFtZTsNCg0KICAgICAgICAkdGVtcGxhdGUtPlNldFBhdGgoKTsNCg0KICAgICAgICAkdGVtcGxhdGUtPkxvYWRUZW1wbGF0ZXMoKTsNCg0KICAgICAgICByZXR1cm4gJHRlbXBsYXRlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmSiOWvueacieWQjOS4gOS4u+mimOS4i+acieWkmuWll+aooeadv+eahOino+aekA0KICAgICAqIOebtOaOpeWcqOaOpeWPo+S4reebtOaOpeiwg+eUqCR6YnAtPkJ1aWxkVGVtcGxhdGVNb3Jl6L+b6KGM6YeN5paw57yW6K+R5YW25a6D5qih5p2/DQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEJ1aWxkVGVtcGxhdGUoKQ0KICAgIHsNCiAgICAgICAgJHRoaXMtPkJ1aWxkVGVtcGxhdGVfT25jZSgpOw0KDQogICAgICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1picF9CdWlsZFRlbXBsYXRlX0VuZCddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAgICAgJGZwbmFtZSgkdGhpcy0+dGVtcGxhdGUpOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5b+r5o236YeN5paw57yW6K+R5oyH5a6a5Li76aKY5qih5p2/55uu5b2V5ZCN55qE5qih5p2/DQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQnVpbGRUZW1wbGF0ZU1vcmUoJHRoZW1lID0gbnVsbCwgJHRlbXBsYXRlX2Rpcm5hbWUgPSAndGVtcGxhdGUnKQ0KICAgIHsNCiAgICAgICAgaWYgKGlzX251bGwoJHRoZW1lKSB8fCBlbXB0eSgkdGhlbWUpKSB7DQogICAgICAgICAgICAkdGhlbWUgPSAmJHRoaXMtPnRoZW1lOw0KICAgICAgICB9DQogICAgICAgICR0aGlzLT50ZW1wbGF0ZS0+dGhlbWUgPSAkdGhlbWU7DQogICAgICAgICR0aGlzLT50ZW1wbGF0ZS0+dGVtcGxhdGVfZGlybmFtZSA9ICR0ZW1wbGF0ZV9kaXJuYW1lOw0KICAgICAgICAkdGhpcy0+dGVtcGxhdGUtPlNldFBhdGgoKTsNCiAgICAgICAgcmV0dXJuICR0aGlzLT5CdWlsZFRlbXBsYXRlX09uY2UoKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmqKHmnb/op6PmnpAuDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwcml2YXRlIGZ1bmN0aW9uIEJ1aWxkVGVtcGxhdGVfT25jZSgpDQogICAgew0KICAgICAgICAkdGhpcy0+dGVtcGxhdGUtPkxvYWRUZW1wbGF0ZXMoKTsNCg0KICAgICAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9aYnBfQnVpbGRUZW1wbGF0ZSddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAgICAgJGZwbmFtZSgkdGhpcy0+dGVtcGxhdGUtPnRlbXBsYXRlcyk7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJHRoaXMtPnRlbXBsYXRlLT5CdWlsZFRlbXBsYXRlKCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5pu05paw5qih5p2/57yT5a2YLg0KICAgICAqDQogICAgICogQHBhcmFtIGJvb2wgJG9ubHljaGVjayAg5Li655yf55qE6K+d77yM5Y+q5Yik5pat5piv5ZCm6ZyA6KaB6ICM5LiNQnVpbGQNCiAgICAgKiBAcGFyYW0gYm9vbCAkZm9yY2VidWlsZA0KICAgICAqDQogICAgICogQHJldHVybiB0cnVlIG9yIGZhbHNlDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIENoZWNrVGVtcGxhdGUoJG9ubHljaGVjayA9IGZhbHNlLCAkZm9yY2VidWlsZCA9IGZhbHNlKQ0KICAgIHsNCiAgICAgICAgJHRoaXMtPnRlbXBsYXRlLT5Mb2FkVGVtcGxhdGVzKCk7DQogICAgICAgICRzID0gaW1wbG9kZSgkdGhpcy0+dGVtcGxhdGUtPnRlbXBsYXRlcyk7DQogICAgICAgICRtZDUgPSBtZDUoJHMpOw0KDQogICAgICAgIC8v5pys5Ye95pWw55qE6L+U5Zue5YC85b6I5pyJ5oSP5oCd77yM5Li6ZmFsc2XooajnpLrpnIDopoFyZWJ1aWxkIOS4unRydWXooajnpLrlt7Lph43lu7rlrozmiJDmiJbmmK/kuI3pnIDopoFyZWJ1aWxkDQogICAgICAgIC8vJHpicC0+Q2hlY2tUZW1wbGF0ZSh0cnVlKSA9PSBmYWxzZSDnmoTmhI/mgJ3vvIzlsLHmmK/liKTmlq3mqKHmnb/pnIDpnIDopoHph43liLfmlrDlkJfvvJ8NCg0KICAgICAgICAvL+WmguaenOWvueavlOS4jeS4gOagtywkb25seWNoZWNr5bCx5pyJ55So5LqGDQogICAgICAgIGlmICgkbWQ1ICE9ICR0aGlzLT5jYWNoZS0+dGVtcGxhdGVzX21kNSkgew0KICAgICAgICAgICAgaWYgKCRvbmx5Y2hlY2sgPT0gdHJ1ZSAmJiAkZm9yY2VidWlsZCA9PSBmYWxzZSkgew0KICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgICR0aGlzLT5CdWlsZFRlbXBsYXRlKCk7DQogICAgICAgICAgICAkdGhpcy0+Y2FjaGUtPnRlbXBsYXRlc19tZDUgPSAkbWQ1Ow0KICAgICAgICAgICAgJHRoaXMtPlNhdmVDYWNoZSgpOw0KDQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KICAgICAgICAvL+WmguaenOWvueavlOS4gOagt+eahOivne+8jCRmb3JjZWJ1aWxk5bCx5pyJ55So5LqGDQogICAgICAgIGlmICgkbWQ1ID09ICR0aGlzLT5jYWNoZS0+dGVtcGxhdGVzX21kNSkgew0KICAgICAgICAgICAgaWYgKCRmb3JjZWJ1aWxkID09IHRydWUpIHsNCiAgICAgICAgICAgICAgICAkdGhpcy0+QnVpbGRUZW1wbGF0ZSgpOw0KICAgICAgICAgICAgICAgICR0aGlzLT5jYWNoZS0+dGVtcGxhdGVzX21kNSA9ICRtZDU7DQogICAgICAgICAgICAgICAgJHRoaXMtPlNhdmVDYWNoZSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog55Sf5oiQ5omA5pyJ6L+bUmVhZHkgTGlzdOeahOaooeWdl+eahENvbnRlbnTlhoXlrrnlubbkv53lrZguDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEJ1aWxkTW9kdWxlKCkNCiAgICB7DQogICAgICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1picF9CdWlsZE1vZHVsZSddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAgICAgJGZwbmFtZSgpOw0KICAgICAgICB9DQogICAgICAgIE1vZHVsZUJ1aWxkZXI6OkJ1aWxkKCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YeN5bu65qih5Z2XLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbW9kdWxlRmlsZU5hbWUg5qih5Z2X5ZCNDQogICAgICogQHBhcmFtIHN0cmluZyAkbW9kdWxlRnVuY3Rpb24g55So5oi35Ye95pWwDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFJlZ0J1aWxkTW9kdWxlKCRtb2R1bGVGaWxlTmFtZSwgJG1vZHVsZUZ1bmN0aW9uKQ0KICAgIHsNCiAgICAgICAgTW9kdWxlQnVpbGRlcjo6UmVnKCRtb2R1bGVGaWxlTmFtZSwgJG1vZHVsZUZ1bmN0aW9uKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDns7vnu5/pu5jorqTms6jlhozmqKHlnZcuDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFJlZ0J1aWxkTW9kdWxlcygpDQogICAgew0KICAgICAgICAkdGhpcy0+UmVnQnVpbGRNb2R1bGUoJ2NhdGFsb2cnLCAnTW9kdWxlQnVpbGRlcjo6Q2F0YWxvZycpOw0KICAgICAgICAkdGhpcy0+UmVnQnVpbGRNb2R1bGUoJ2NhbGVuZGFyJywgJ01vZHVsZUJ1aWxkZXI6OkNhbGVuZGFyJyk7DQogICAgICAgICR0aGlzLT5SZWdCdWlsZE1vZHVsZSgnY29tbWVudHMnLCAnTW9kdWxlQnVpbGRlcjo6Q29tbWVudHMnKTsNCiAgICAgICAgJHRoaXMtPlJlZ0J1aWxkTW9kdWxlKCdwcmV2aW91cycsICdNb2R1bGVCdWlsZGVyOjpMYXRlc3RBcnRpY2xlcycpOw0KICAgICAgICAkdGhpcy0+UmVnQnVpbGRNb2R1bGUoJ2FyY2hpdmVzJywgJ01vZHVsZUJ1aWxkZXI6OkFyY2hpdmVzJyk7DQogICAgICAgICR0aGlzLT5SZWdCdWlsZE1vZHVsZSgnbmF2YmFyJywgJ01vZHVsZUJ1aWxkZXI6Ok5hdmJhcicpOw0KICAgICAgICAkdGhpcy0+UmVnQnVpbGRNb2R1bGUoJ3RhZ3MnLCAnTW9kdWxlQnVpbGRlcjo6VGFnTGlzdCcpOw0KICAgICAgICAkdGhpcy0+UmVnQnVpbGRNb2R1bGUoJ3N0YXRpc3RpY3MnLCAnTW9kdWxlQnVpbGRlcjo6U3RhdGlzdGljcycpOw0KICAgICAgICAkdGhpcy0+UmVnQnVpbGRNb2R1bGUoJ2F1dGhvcnMnLCAnTW9kdWxlQnVpbGRlcjo6QXV0aG9ycycpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOa3u+WKoOi/m+WFpUJ1aWxkIFJlYWR55YiX6KGo55qE5qih5Z2XLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbW9kdWxlRmlsZU5hbWUg5qih5Z2X5ZCNDQogICAgICogQHBhcmFtIG51bGwgICAkcGFyYW1ldGVycyAgICAg5qih5Z2X5Y+C5pWwDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEFkZEJ1aWxkTW9kdWxlKCRtb2R1bGVGaWxlTmFtZSwgJHBhcmFtZXRlcnMgPSBudWxsKQ0KICAgIHsNCiAgICAgICAgJHAgPSBmdW5jX2dldF9hcmdzKCk7DQogICAgICAgIGNhbGxfdXNlcl9mdW5jX2FycmF5KCdNb2R1bGVCdWlsZGVyOjpBZGQnLCAkcCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5Yig6Zmk6L+b5YWlQnVpbGQgUmVhZHnliJfooajmqKHlnZcuDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRtb2R1bGVGaWxlTmFtZSDmqKHlnZflkI0NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gRGVsQnVpbGRNb2R1bGUoJG1vZHVsZUZpbGVOYW1lKQ0KICAgIHsNCiAgICAgICAgTW9kdWxlQnVpbGRlcjo6RGVsKCRtb2R1bGVGaWxlTmFtZSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5p+l6K+i5oyH5a6a5pWw5o2u57uT5p6E55qEc3Fs5bm26L+U5ZueQmFzZeWvueixoeWIl+ihqC4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmd8YXJyYXkgJHRhYmxlICAgIOaVsOaNruihqA0KICAgICAqIEBwYXJhbSBhcnJheSAgICAgICAgJGRhdGFpbmZvIOaVsOaNruWtl+autQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgICAgICAgJHNxbCAgICAgIFNRTOaTjeS9nOivreWPpQ0KICAgICAqDQogICAgICogQHJldHVybiBhcnJheQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRMaXN0Q3VzdG9tKCR0YWJsZSwgJGRhdGFpbmZvLCAkc3FsKQ0KICAgIHsNCiAgICAgICAgJGFycmF5ID0gbnVsbDsNCiAgICAgICAgJGxpc3QgPSBhcnJheSgpOw0KICAgICAgICAkYXJyYXkgPSAkdGhpcy0+ZGItPlF1ZXJ5KCRzcWwpOw0KICAgICAgICBpZiAoIWlzc2V0KCRhcnJheSkpIHsNCiAgICAgICAgICAgIHJldHVybiBhcnJheSgpOw0KICAgICAgICB9DQogICAgICAgIGZvcmVhY2ggKCRhcnJheSBhcyAkYSkgew0KICAgICAgICAgICAgJGwgPSBuZXcgQmFzZSgkdGFibGUsICRkYXRhaW5mbyk7DQogICAgICAgICAgICAkbC0+TG9hZEluZm9CeUFzc29jKCRhKTsNCiAgICAgICAgICAgICRpZCA9ICRsLT5HZXRJZE5hbWUoKTsNCiAgICAgICAgICAgIGlmICgkdGhpcy0+Q2hlY2tDYWNoZSgnQmFzZScsICRsLT4kaWQpID09IGZhbHNlKSB7DQogICAgICAgICAgICAgICAgJHRoaXMtPkFkZENhY2hlKCRsKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgICRsaXN0W10gPSAkbDsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAkbGlzdDsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmn6Xor6JJROaVsOaNrueahOaMh+WumuaVsOaNrue7k+aehOeahHNxbOW5tui/lOWbnkJhc2Xlr7nosaHliJfooaguDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nfGFycmF5ICR0YWJsZSAgICDmlbDmja7ooagNCiAgICAgKiBAcGFyYW0gYXJyYXkgICAgICAgICRkYXRhaW5mbyDmlbDmja7lrZfmrrUNCiAgICAgKiBAcGFyYW0gYXJyYXkgICAgICAgICRhcnJheSAgICBJROaVsOe7hA0KICAgICAqDQogICAgICogQHJldHVybiBCYXNlW10NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0TGlzdEN1c3RvbUJ5QXJyYXkoJHRhYmxlLCAkZGF0YWluZm8sICRhcnJheSkNCiAgICB7DQogICAgICAgIGlmICghaXNfYXJyYXkoJGFycmF5KSkgew0KICAgICAgICAgICAgcmV0dXJuIGFycmF5KCk7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoY291bnQoJGFycmF5KSA9PSAwKSB7DQogICAgICAgICAgICByZXR1cm4gYXJyYXkoKTsNCiAgICAgICAgfQ0KDQogICAgICAgICR3aGVyZSA9IGFycmF5KCk7DQogICAgICAgICR3aGVyZVtdID0gYXJyYXkoJ0lOJywgJGRhdGFpbmZvWydJRCddWzBdLCBpbXBsb2RlKCcsJywgJGFycmF5KSk7DQogICAgICAgICRzcWwgPSAkdGhpcy0+ZGItPnNxbC0+U2VsZWN0KCR0YWJsZSwgJyonLCAkd2hlcmUpOw0KICAgICAgICAkYXJyYXkgPSBudWxsOw0KICAgICAgICAkbGlzdCA9IGFycmF5KCk7DQogICAgICAgICRhcnJheSA9ICR0aGlzLT5kYi0+UXVlcnkoJHNxbCk7DQogICAgICAgIGlmICghaXNzZXQoJGFycmF5KSkgew0KICAgICAgICAgICAgcmV0dXJuIGFycmF5KCk7DQogICAgICAgIH0NCiAgICAgICAgZm9yZWFjaCAoJGFycmF5IGFzICRhKSB7DQogICAgICAgICAgICAkbCA9IG5ldyBCYXNlKCR0YWJsZSwgJGRhdGFpbmZvKTsNCiAgICAgICAgICAgICRsLT5Mb2FkSW5mb0J5QXNzb2MoJGEpOw0KICAgICAgICAgICAgJGlkID0gJGwtPkdldElkTmFtZSgpOw0KICAgICAgICAgICAgaWYgKCR0aGlzLT5DaGVja0NhY2hlKCdCYXNlJywgJGwtPiRpZCkgPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICAgICAkdGhpcy0+QWRkQ2FjaGUoJGwpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgJGxpc3RbXSA9ICRsOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICRsaXN0Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOW3suaUueWQjUdldExpc3RUeXBlLDEuNeeJiOS4reaJlOaOieacieatp+S5ieeahEdldExpc3QuDQogICAgICoNCiAgICAgKiBAcGFyYW0gJHR5cGUNCiAgICAgKiBAcGFyYW0gJHNxbA0KICAgICAqDQogICAgICogQHJldHVybiBCYXNlW10NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0TGlzdFR5cGUoJHR5cGUsICRzcWwpDQogICAgew0KICAgICAgICBpZiAoaXNfb2JqZWN0KCRzcWwpICYmIGdldF9wYXJlbnRfY2xhc3MoJHNxbCkgPT0gJ1NRTF9fR2xvYmFsJykgew0KICAgICAgICAgICAgJHNxbCA9ICRzcWwtPnNxbDsNCiAgICAgICAgfQ0KICAgICAgICAkYXJyYXkgPSBudWxsOw0KICAgICAgICAkbGlzdCA9IGFycmF5KCk7DQogICAgICAgICRhcnJheSA9ICR0aGlzLT5kYi0+UXVlcnkoJHNxbCk7DQogICAgICAgIGlmICghaXNzZXQoJGFycmF5KSkgew0KICAgICAgICAgICAgcmV0dXJuIGFycmF5KCk7DQogICAgICAgIH0NCg0KICAgICAgICBmb3JlYWNoICgkYXJyYXkgYXMgJGEpIHsNCiAgICAgICAgICAgIC8qKiBAdmFyIEJhc2UgJGwgKi8NCiAgICAgICAgICAgICRsID0gbmV3ICR0eXBlKCk7DQogICAgICAgICAgICAkbC0+TG9hZEluZm9CeUFzc29jKCRhKTsNCiAgICAgICAgICAgICRpZCA9ICRsLT5HZXRJZE5hbWUoKTsNCiAgICAgICAgICAgIGlmICgkdGhpcy0+Q2hlY2tDYWNoZSgkdHlwZSwgJGwtPiRpZCkgPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICAgICAkdGhpcy0+QWRkQ2FjaGUoJGwpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICAkbGlzdFtdID0gJGw7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJGxpc3Q7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogR2V0TGlzdE9yaWdpbi4NCiAgICAgKg0KICAgICAqIEBwYXJhbSAkc3FsDQogICAgICoNCiAgICAgKiBAcmV0dXJuIEJhc2VbXQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRMaXN0T3JpZ2luKCRzcWwpDQogICAgew0KICAgICAgICBpZiAoaXNfb2JqZWN0KCRzcWwpICYmIGdldF9wYXJlbnRfY2xhc3MoJHNxbCkgPT0gJ1NRTF9fR2xvYmFsJykgew0KICAgICAgICAgICAgJHNxbCA9ICRzcWwtPnNxbDsNCiAgICAgICAgfQ0KICAgICAgICAkYXJyYXkgPSBudWxsOw0KICAgICAgICAkbGlzdCA9IGFycmF5KCk7DQogICAgICAgICRhcnJheSA9ICR0aGlzLT5kYi0+UXVlcnkoJHNxbCk7DQogICAgICAgIGlmICghaXNzZXQoJGFycmF5KSkgew0KICAgICAgICAgICAgcmV0dXJuIGFycmF5KCk7DQogICAgICAgIH0NCiAgICAgICAgZm9yZWFjaCAoJGFycmF5IGFzICRhKSB7DQogICAgICAgICAgICAkbGlzdFtdID0gJGE7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJGxpc3Q7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5p+l6K+iSUTmlbDmja7nmoTmjIflrprnsbvlnovnmoRzcWzlubbov5Tlm57mjIflrprnsbvlnovlr7nosaHliJfooaguDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICR0eXBlICDnsbvlnosNCiAgICAgKiBAcGFyYW0gbWl4ZWQgICRhcnJheSBJROaVsOe7hA0KICAgICAqDQogICAgICogQHJldHVybiBCYXNlW10NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0TGlzdFR5cGVCeUFycmF5KCR0eXBlLCAkYXJyYXkpDQogICAgew0KICAgICAgICBpZiAoIWlzX2FycmF5KCRhcnJheSkpIHsNCiAgICAgICAgICAgIHJldHVybiBhcnJheSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKGNvdW50KCRhcnJheSkgPT0gMCkgew0KICAgICAgICAgICAgcmV0dXJuIGFycmF5KCk7DQogICAgICAgIH0NCg0KICAgICAgICAkd2hlcmUgPSBhcnJheSgpOw0KICAgICAgICAkd2hlcmVbXSA9IGFycmF5KCdJTicsICR0aGlzLT5kYXRhaW5mb1skdHlwZV1bJ0lEJ11bMF0sIGltcGxvZGUoJywnLCAkYXJyYXkpKTsNCiAgICAgICAgJHNxbCA9ICR0aGlzLT5kYi0+c3FsLT5TZWxlY3QoJHRoaXMtPnRhYmxlWyR0eXBlXSwgJyonLCAkd2hlcmUpOw0KICAgICAgICAkYXJyYXkgPSBudWxsOw0KICAgICAgICAkbGlzdCA9IGFycmF5KCk7DQogICAgICAgICRhcnJheSA9ICR0aGlzLT5kYi0+UXVlcnkoJHNxbCk7DQogICAgICAgIGlmICghaXNzZXQoJGFycmF5KSkgew0KICAgICAgICAgICAgcmV0dXJuIGFycmF5KCk7DQogICAgICAgIH0NCiAgICAgICAgZm9yZWFjaCAoJGFycmF5IGFzICRhKSB7DQogICAgICAgICAgICAvKiogQHZhciBCYXNlICRsICovDQogICAgICAgICAgICAkbCA9IG5ldyAkdHlwZSgpOw0KICAgICAgICAgICAgJGwtPkxvYWRJbmZvQnlBc3NvYygkYSk7DQogICAgICAgICAgICAkaWQgPSAkbC0+R2V0SWROYW1lKCk7DQogICAgICAgICAgICBpZiAoJHRoaXMtPkNoZWNrQ2FjaGUoJHR5cGUsICRsLT4kaWQpID09IGZhbHNlKSB7DQogICAgICAgICAgICAgICAgJHRoaXMtPkFkZENhY2hlKCRsKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgICRsaXN0W10gPSAkbDsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAkbGlzdDsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJHNlbGVjdA0KICAgICAqIEBwYXJhbSBtaXhlZCAkd2hlcmUNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJG9yZGVyDQogICAgICogQHBhcmFtIG1peGVkICRsaW1pdA0KICAgICAqIEBwYXJhbSBtaXhlZCAkb3B0aW9uDQogICAgICoNCiAgICAgKiBAcmV0dXJuIFBvc3RbXQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRQb3N0TGlzdCgkc2VsZWN0ID0gbnVsbCwgJHdoZXJlID0gbnVsbCwgJG9yZGVyID0gbnVsbCwgJGxpbWl0ID0gbnVsbCwgJG9wdGlvbiA9IG51bGwpDQogICAgew0KICAgICAgICBpZiAoaXNfb2JqZWN0KCRzZWxlY3QpICYmIGdldF9wYXJlbnRfY2xhc3MoJHNlbGVjdCkgPT0gJ1NRTF9fR2xvYmFsJykgew0KICAgICAgICAgICAgJHNxbCA9ICRzZWxlY3QtPnNxbDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICRzcWwgPSAkdGhpcy0+ZGItPnNxbC0+U2VsZWN0KCR0aGlzLT50YWJsZVsnUG9zdCddLCAkc2VsZWN0LCAkd2hlcmUsICRvcmRlciwgJGxpbWl0LCAkb3B0aW9uKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8qKiBAdmFyIFBvc3RbXSAkYXJyYXkgKi8NCiAgICAgICAgJGFycmF5ID0gJHRoaXMtPkdldExpc3RUeXBlKCdQb3N0JywgJHNxbCwgJG9wdGlvbik7DQogICAgICAgIGlmIChpc3NldCgkb3B0aW9uWydwYWdlYmFyJ10pICYmIGlzX29iamVjdCgkb3B0aW9uWydwYWdlYmFyJ10pKSB7DQogICAgICAgICAgICAkb3B0aW9uWydwYWdlYmFyJ10tPkN1cnJlbnRDb3VudCA9IGNvdW50KCRhcnJheSk7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJGFycmF5Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBwYXJhbSBtaXhlZCAkc2VsZWN0DQogICAgICogQHBhcmFtIG1peGVkICR3aGVyZQ0KICAgICAqIEBwYXJhbSBtaXhlZCAkb3JkZXINCiAgICAgKiBAcGFyYW0gbWl4ZWQgJGxpbWl0DQogICAgICogQHBhcmFtIG1peGVkICRvcHRpb24NCiAgICAgKiBAcGFyYW0gbWl4ZWQgJHJlYWR0YWdzDQogICAgICoNCiAgICAgKiBAcmV0dXJuIFBvc3RbXQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRBcnRpY2xlTGlzdCgkc2VsZWN0ID0gbnVsbCwgJHdoZXJlID0gbnVsbCwgJG9yZGVyID0gbnVsbCwgJGxpbWl0ID0gbnVsbCwgJG9wdGlvbiA9IG51bGwsICRyZWFkdGFncyA9IHRydWUpDQogICAgew0KICAgICAgICBpZiAoZW1wdHkoJHdoZXJlKSkgew0KICAgICAgICAgICAgJHdoZXJlID0gYXJyYXkoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChpc19hcnJheSgkd2hlcmUpKSB7DQogICAgICAgICAgICBhcnJheV91bnNoaWZ0KCR3aGVyZSwgYXJyYXkoJz0nLCAnbG9nX1R5cGUnLCAnMCcpKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChpc19vYmplY3QoJHNlbGVjdCkgJiYgZ2V0X3BhcmVudF9jbGFzcygkc2VsZWN0KSA9PSAnU1FMX19HbG9iYWwnKSB7DQogICAgICAgICAgICAkc3FsID0gJHNlbGVjdC0+c3FsOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJHNxbCA9ICR0aGlzLT5kYi0+c3FsLT5TZWxlY3QoJHRoaXMtPnRhYmxlWydQb3N0J10sICRzZWxlY3QsICR3aGVyZSwgJG9yZGVyLCAkbGltaXQsICRvcHRpb24pOw0KICAgICAgICB9DQoNCg0KICAgICAgICAvKiogQHZhciBQb3N0W10gJGFycmF5ICovDQogICAgICAgICRhcnJheSA9ICR0aGlzLT5HZXRMaXN0VHlwZSgnUG9zdCcsICRzcWwsICRvcHRpb24pOw0KICAgICAgICBpZiAoaXNzZXQoJG9wdGlvblsncGFnZWJhciddKSAmJiBpc19vYmplY3QoJG9wdGlvblsncGFnZWJhciddKSkgew0KICAgICAgICAgICAgJG9wdGlvblsncGFnZWJhciddLT5DdXJyZW50Q291bnQgPSBjb3VudCgkYXJyYXkpOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCRyZWFkdGFncykgew0KICAgICAgICAgICAgJHRhZ3N0cmluZyA9ICcnOw0KICAgICAgICAgICAgZm9yZWFjaCAoJGFycmF5IGFzICRhKSB7DQogICAgICAgICAgICAgICAgJHRhZ3N0cmluZyAuPSAkYS0+VGFnOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgJHRoaXMtPkxvYWRUYWdzQnlJRFN0cmluZygkdGFnc3RyaW5nKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAkYXJyYXk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogQHBhcmFtIG1peGVkICRzZWxlY3QNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJHdoZXJlDQogICAgICogQHBhcmFtIG1peGVkICRvcmRlcg0KICAgICAqIEBwYXJhbSBtaXhlZCAkbGltaXQNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJG9wdGlvbg0KICAgICAqDQogICAgICogQHJldHVybiBQb3N0W10NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0UGFnZUxpc3QoJHNlbGVjdCA9IG51bGwsICR3aGVyZSA9IG51bGwsICRvcmRlciA9IG51bGwsICRsaW1pdCA9IG51bGwsICRvcHRpb24gPSBudWxsKQ0KICAgIHsNCiAgICAgICAgaWYgKGVtcHR5KCR3aGVyZSkpIHsNCiAgICAgICAgICAgICR3aGVyZSA9IGFycmF5KCk7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGlzX2FycmF5KCR3aGVyZSkpIHsNCiAgICAgICAgICAgIGFycmF5X3Vuc2hpZnQoJHdoZXJlLCBhcnJheSgnPScsICdsb2dfVHlwZScsICcxJykpOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKGlzX29iamVjdCgkc2VsZWN0KSAmJiBnZXRfcGFyZW50X2NsYXNzKCRzZWxlY3QpID09ICdTUUxfX0dsb2JhbCcpIHsNCiAgICAgICAgICAgICRzcWwgPSAkc2VsZWN0LT5zcWw7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkc3FsID0gJHRoaXMtPmRiLT5zcWwtPlNlbGVjdCgkdGhpcy0+dGFibGVbJ1Bvc3QnXSwgJHNlbGVjdCwgJHdoZXJlLCAkb3JkZXIsICRsaW1pdCwgJG9wdGlvbik7DQogICAgICAgIH0NCg0KICAgICAgICAvKiogQHZhciBQb3N0W10gJGFycmF5ICovDQogICAgICAgICRhcnJheSA9ICR0aGlzLT5HZXRMaXN0VHlwZSgnUG9zdCcsICRzcWwpOw0KICAgICAgICBpZiAoaXNzZXQoJG9wdGlvblsncGFnZWJhciddKSAmJiBpc19vYmplY3QoJG9wdGlvblsncGFnZWJhciddKSkgew0KICAgICAgICAgICAgJG9wdGlvblsncGFnZWJhciddLT5DdXJyZW50Q291bnQgPSBjb3VudCgkYXJyYXkpOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICRhcnJheTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJHNlbGVjdA0KICAgICAqIEBwYXJhbSBtaXhlZCAkd2hlcmUNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJG9yZGVyDQogICAgICogQHBhcmFtIG1peGVkICRsaW1pdA0KICAgICAqIEBwYXJhbSBtaXhlZCAkb3B0aW9uDQogICAgICoNCiAgICAgKiBAcmV0dXJuIENvbW1lbnRbXQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRDb21tZW50TGlzdCgkc2VsZWN0ID0gbnVsbCwgJHdoZXJlID0gbnVsbCwgJG9yZGVyID0gbnVsbCwgJGxpbWl0ID0gbnVsbCwgJG9wdGlvbiA9IG51bGwpDQogICAgew0KICAgICAgICBpZiAoaXNfb2JqZWN0KCRzZWxlY3QpICYmIGdldF9wYXJlbnRfY2xhc3MoJHNlbGVjdCkgPT0gJ1NRTF9fR2xvYmFsJykgew0KICAgICAgICAgICAgJHNxbCA9ICRzZWxlY3QtPnNxbDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICRzcWwgPSAkdGhpcy0+ZGItPnNxbC0+U2VsZWN0KCR0aGlzLT50YWJsZVsnQ29tbWVudCddLCAkc2VsZWN0LCAkd2hlcmUsICRvcmRlciwgJGxpbWl0LCAkb3B0aW9uKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8qKiBAdmFyIENvbW1lbnRbXSAkYXJyYXkgKi8NCiAgICAgICAgJGFycmF5ID0gJHRoaXMtPkdldExpc3RUeXBlKCdDb21tZW50JywgJHNxbCk7DQogICAgICAgIGlmIChpc3NldCgkb3B0aW9uWydwYWdlYmFyJ10pICYmIGlzX29iamVjdCgkb3B0aW9uWydwYWdlYmFyJ10pKSB7DQogICAgICAgICAgICAkb3B0aW9uWydwYWdlYmFyJ10tPkN1cnJlbnRDb3VudCA9IGNvdW50KCRhcnJheSk7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJGFycmF5Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBwYXJhbSBtaXhlZCAkc2VsZWN0DQogICAgICogQHBhcmFtIG1peGVkICR3aGVyZQ0KICAgICAqIEBwYXJhbSBtaXhlZCAkb3JkZXINCiAgICAgKiBAcGFyYW0gbWl4ZWQgJGxpbWl0DQogICAgICogQHBhcmFtIG1peGVkICRvcHRpb24NCiAgICAgKg0KICAgICAqIEByZXR1cm4gTWVtYmVyW118QmFzZVtdDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldE1lbWJlckxpc3QoJHNlbGVjdCA9IG51bGwsICR3aGVyZSA9IG51bGwsICRvcmRlciA9IG51bGwsICRsaW1pdCA9IG51bGwsICRvcHRpb24gPSBudWxsKQ0KICAgIHsNCiAgICAgICAgaWYgKGlzX29iamVjdCgkc2VsZWN0KSAmJiBnZXRfcGFyZW50X2NsYXNzKCRzZWxlY3QpID09ICdTUUxfX0dsb2JhbCcpIHsNCiAgICAgICAgICAgICRzcWwgPSAkc2VsZWN0LT5zcWw7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkc3FsID0gJHRoaXMtPmRiLT5zcWwtPlNlbGVjdCgkdGhpcy0+dGFibGVbJ01lbWJlciddLCAkc2VsZWN0LCAkd2hlcmUsICRvcmRlciwgJGxpbWl0LCAkb3B0aW9uKTsNCiAgICAgICAgfQ0KDQogICAgICAgICRhcnJheSA9ICR0aGlzLT5HZXRMaXN0VHlwZSgnTWVtYmVyJywgJHNxbCk7DQogICAgICAgIGlmIChpc3NldCgkb3B0aW9uWydwYWdlYmFyJ10pICYmIGlzX29iamVjdCgkb3B0aW9uWydwYWdlYmFyJ10pKSB7DQogICAgICAgICAgICAkb3B0aW9uWydwYWdlYmFyJ10tPkN1cnJlbnRDb3VudCA9IGNvdW50KCRhcnJheSk7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJGFycmF5Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBwYXJhbSBtaXhlZCAkc2VsZWN0DQogICAgICogQHBhcmFtIG1peGVkICR3aGVyZQ0KICAgICAqIEBwYXJhbSBtaXhlZCAkb3JkZXINCiAgICAgKiBAcGFyYW0gbWl4ZWQgJGxpbWl0DQogICAgICogQHBhcmFtIG1peGVkICRvcHRpb24NCiAgICAgKg0KICAgICAqIEByZXR1cm4gVGFnW118QmFzZVtdDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFRhZ0xpc3QoJHNlbGVjdCA9IG51bGwsICR3aGVyZSA9IG51bGwsICRvcmRlciA9IG51bGwsICRsaW1pdCA9IG51bGwsICRvcHRpb24gPSBudWxsKQ0KICAgIHsNCiAgICAgICAgaWYgKGlzX29iamVjdCgkc2VsZWN0KSAmJiBnZXRfcGFyZW50X2NsYXNzKCRzZWxlY3QpID09ICdTUUxfX0dsb2JhbCcpIHsNCiAgICAgICAgICAgICRzcWwgPSAkc2VsZWN0LT5zcWw7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkc3FsID0gJHRoaXMtPmRiLT5zcWwtPlNlbGVjdCgkdGhpcy0+dGFibGVbJ1RhZyddLCAkc2VsZWN0LCAkd2hlcmUsICRvcmRlciwgJGxpbWl0LCAkb3B0aW9uKTsNCiAgICAgICAgfQ0KDQogICAgICAgICRhcnJheSA9ICR0aGlzLT5HZXRMaXN0VHlwZSgnVGFnJywgJHNxbCk7DQogICAgICAgIGlmIChpc3NldCgkb3B0aW9uWydwYWdlYmFyJ10pICYmIGlzX29iamVjdCgkb3B0aW9uWydwYWdlYmFyJ10pKSB7DQogICAgICAgICAgICAkb3B0aW9uWydwYWdlYmFyJ10tPkN1cnJlbnRDb3VudCA9IGNvdW50KCRhcnJheSk7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJGFycmF5Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBwYXJhbSBtaXhlZCAkc2VsZWN0DQogICAgICogQHBhcmFtIG1peGVkICR3aGVyZQ0KICAgICAqIEBwYXJhbSBtaXhlZCAkb3JkZXINCiAgICAgKiBAcGFyYW0gbWl4ZWQgJGxpbWl0DQogICAgICogQHBhcmFtIG1peGVkICRvcHRpb24NCiAgICAgKg0KICAgICAqIEByZXR1cm4gQ2F0ZWdvcnlbXXxCYXNlW10NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0Q2F0ZWdvcnlMaXN0KCRzZWxlY3QgPSBudWxsLCAkd2hlcmUgPSBudWxsLCAkb3JkZXIgPSBudWxsLCAkbGltaXQgPSBudWxsLCAkb3B0aW9uID0gbnVsbCkNCiAgICB7DQogICAgICAgIGlmIChpc19vYmplY3QoJHNlbGVjdCkgJiYgZ2V0X3BhcmVudF9jbGFzcygkc2VsZWN0KSA9PSAnU1FMX19HbG9iYWwnKSB7DQogICAgICAgICAgICAkc3FsID0gJHNlbGVjdC0+c3FsOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJHNxbCA9ICR0aGlzLT5kYi0+c3FsLT5TZWxlY3QoJHRoaXMtPnRhYmxlWydDYXRlZ29yeSddLCAkc2VsZWN0LCAkd2hlcmUsICRvcmRlciwgJGxpbWl0LCAkb3B0aW9uKTsNCiAgICAgICAgfQ0KDQogICAgICAgICRhcnJheSA9ICR0aGlzLT5HZXRMaXN0VHlwZSgnQ2F0ZWdvcnknLCAkc3FsKTsNCiAgICAgICAgaWYgKGlzc2V0KCRvcHRpb25bJ3BhZ2ViYXInXSkgJiYgaXNfb2JqZWN0KCRvcHRpb25bJ3BhZ2ViYXInXSkpIHsNCiAgICAgICAgICAgICRvcHRpb25bJ3BhZ2ViYXInXS0+Q3VycmVudENvdW50ID0gY291bnQoJGFycmF5KTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAkYXJyYXk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogQHBhcmFtIG1peGVkICRzZWxlY3QNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJHdoZXJlDQogICAgICogQHBhcmFtIG1peGVkICRvcmRlcg0KICAgICAqIEBwYXJhbSBtaXhlZCAkbGltaXQNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJG9wdGlvbg0KICAgICAqDQogICAgICogQHJldHVybiBNb2R1bGVbXXxCYXNlW10NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0TW9kdWxlTGlzdCgkc2VsZWN0ID0gbnVsbCwgJHdoZXJlID0gbnVsbCwgJG9yZGVyID0gbnVsbCwgJGxpbWl0ID0gbnVsbCwgJG9wdGlvbiA9IG51bGwpDQogICAgew0KICAgICAgICBpZiAoaXNfb2JqZWN0KCRzZWxlY3QpICYmIGdldF9wYXJlbnRfY2xhc3MoJHNlbGVjdCkgPT0gJ1NRTF9fR2xvYmFsJykgew0KICAgICAgICAgICAgJHNxbCA9ICRzZWxlY3QtPnNxbDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICRzcWwgPSAkdGhpcy0+ZGItPnNxbC0+U2VsZWN0KCR0aGlzLT50YWJsZVsnTW9kdWxlJ10sICRzZWxlY3QsICR3aGVyZSwgJG9yZGVyLCAkbGltaXQsICRvcHRpb24pOw0KICAgICAgICB9DQoNCiAgICAgICAgJGFycmF5ID0gJHRoaXMtPkdldExpc3RUeXBlKCdNb2R1bGUnLCAkc3FsKTsNCiAgICAgICAgaWYgKGlzc2V0KCRvcHRpb25bJ3BhZ2ViYXInXSkgJiYgaXNfb2JqZWN0KCRvcHRpb25bJ3BhZ2ViYXInXSkpIHsNCiAgICAgICAgICAgICRvcHRpb25bJ3BhZ2ViYXInXS0+Q3VycmVudENvdW50ID0gY291bnQoJGFycmF5KTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAkYXJyYXk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogQHBhcmFtIG1peGVkICRzZWxlY3QNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJHdoZXJlDQogICAgICogQHBhcmFtIG1peGVkICRvcmRlcg0KICAgICAqIEBwYXJhbSBtaXhlZCAkbGltaXQNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJG9wdGlvbg0KICAgICAqDQogICAgICogQHJldHVybiBVcGxvYWRbXXxCYXNlW10NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0VXBsb2FkTGlzdCgkc2VsZWN0ID0gbnVsbCwgJHdoZXJlID0gbnVsbCwgJG9yZGVyID0gbnVsbCwgJGxpbWl0ID0gbnVsbCwgJG9wdGlvbiA9IG51bGwpDQogICAgew0KICAgICAgICBpZiAoaXNfb2JqZWN0KCRzZWxlY3QpICYmIGdldF9wYXJlbnRfY2xhc3MoJHNlbGVjdCkgPT0gJ1NRTF9fR2xvYmFsJykgew0KICAgICAgICAgICAgJHNxbCA9ICRzZWxlY3QtPnNxbDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICRzcWwgPSAkdGhpcy0+ZGItPnNxbC0+U2VsZWN0KCR0aGlzLT50YWJsZVsnVXBsb2FkJ10sICRzZWxlY3QsICR3aGVyZSwgJG9yZGVyLCAkbGltaXQsICRvcHRpb24pOw0KICAgICAgICB9DQoNCiAgICAgICAgJGFycmF5ID0gJHRoaXMtPkdldExpc3RUeXBlKCdVcGxvYWQnLCAkc3FsKTsNCiAgICAgICAgaWYgKGlzc2V0KCRvcHRpb25bJ3BhZ2ViYXInXSkgJiYgaXNfb2JqZWN0KCRvcHRpb25bJ3BhZ2ViYXInXSkpIHsNCiAgICAgICAgICAgICRvcHRpb25bJ3BhZ2ViYXInXS0+Q3VycmVudENvdW50ID0gY291bnQoJGFycmF5KTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAkYXJyYXk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YCa6L+HSUTmlbDnu4Tojrflj5bmlofnq6Dlrp7kvosuDQogICAgICoNCiAgICAgKiBAcGFyYW0gbWl4ZWRbXSAkYXJyYXkNCiAgICAgKg0KICAgICAqIEByZXR1cm4gUG9zdFtdfEJhc2VbXSBQb3N0cw0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRQb3N0QnlBcnJheSgkYXJyYXkpDQogICAgew0KICAgICAgICAkcG9zdHMgPSAkdGhpcy0+R2V0TGlzdFR5cGVCeUFycmF5KCdQb3N0JywgJGFycmF5KTsNCg0KICAgICAgICByZXR1cm4gJHBvc3RzOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h0lE5pWw57uE6I635Y+W6K+E6K665a6e5L6LLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRDb21tZW50QnlBcnJheSgkYXJyYXkpDQogICAgew0KICAgICAgICAkcG9zdHMgPSAkdGhpcy0+R2V0TGlzdFR5cGVCeUFycmF5KCdDb21tZW50JywgJGFycmF5KTsNCg0KICAgICAgICByZXR1cm4gJHBvc3RzOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h0lE5pWw57uE6I635Y+WTWVtYmVy5a6e5L6LLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRNZW1iZXJCeUFycmF5KCRhcnJheSkNCiAgICB7DQogICAgICAgICRwb3N0cyA9ICR0aGlzLT5HZXRMaXN0VHlwZUJ5QXJyYXkoJ01lbWJlcicsICRhcnJheSk7DQoNCiAgICAgICAgcmV0dXJuICRwb3N0czsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4dJROaVsOe7hOiOt+WPlkNhdGVnb3J55a6e5L6LLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRDYXRlZ29yeUJ5QXJyYXkoJGFycmF5KQ0KICAgIHsNCiAgICAgICAgJHBvc3RzID0gJHRoaXMtPkdldExpc3RUeXBlQnlBcnJheSgnQ2F0ZWdvcnknLCAkYXJyYXkpOw0KDQogICAgICAgIHJldHVybiAkcG9zdHM7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YCa6L+HSUTmlbDnu4Tojrflj5ZUYWflrp7kvosuDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFRhZ0J5QXJyYXkoJGFycmF5KQ0KICAgIHsNCiAgICAgICAgJHBvc3RzID0gJHRoaXMtPkdldExpc3RUeXBlQnlBcnJheSgnVGFnJywgJGFycmF5KTsNCg0KICAgICAgICByZXR1cm4gJHBvc3RzOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h0lE5pWw57uE6I635Y+WTW9kdWxl5a6e5L6LLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRNb2R1bGVCeUFycmF5KCRhcnJheSkNCiAgICB7DQogICAgICAgICRwb3N0cyA9ICR0aGlzLT5HZXRMaXN0VHlwZUJ5QXJyYXkoJ01vZHVsZScsICRhcnJheSk7DQoNCiAgICAgICAgcmV0dXJuICRwb3N0czsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4dJROaVsOe7hOiOt+WPllVwbG9hZOWunuS+iy4NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0VXBsb2FkQnlBcnJheSgkYXJyYXkpDQogICAgew0KICAgICAgICAkcG9zdHMgPSAkdGhpcy0+R2V0TGlzdFR5cGVCeUFycmF5KCdVcGxvYWQnLCAkYXJyYXkpOw0KDQogICAgICAgIHJldHVybiAkcG9zdHM7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogQHBhcmFtICRzcWwNCiAgICAgKg0KICAgICAqIEByZXR1cm4gbWl4ZWQNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gZ2V0X3Jlc3VsdHMoJHNxbCkNCiAgICB7DQogICAgICAgIHJldHVybiAkdGhpcy0+ZGItPlF1ZXJ5KCRzcWwpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOagueaNruWIq+WQjeW+l+WIsOebuOW6lOaVsOaNri4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBCYXNlW118c3RyaW5nICYkb2JqZWN0ICAg57yT5a2Y5a+56LGhDQogICAgICogQHBhcmFtIHN0cmluZyAgICAgICAgJHZhbA0KICAgICAqIEBwYXJhbSBzdHJpbmcgICAgICAgICRiYWNrQXR0cg0KICAgICAqIEBwYXJhbSBzdHJpbmcgICAgICAgICRjbGFzc05hbWUNCiAgICAgKg0KICAgICAqIEByZXR1cm4gQmFzZXxudWxsDQogICAgICovDQogICAgcHJpdmF0ZSBmdW5jdGlvbiBHZXRTb21lVGhpbmdCeUFsaWFzKCRvYmplY3QsICR2YWwsICRiYWNrQXR0ciA9IG51bGwsICRjbGFzc05hbWUgPSBudWxsKQ0KICAgIHsNCiAgICAgICAgJHJldCA9ICR0aGlzLT5HZXRTb21lVGhpbmcoJG9iamVjdCwgJ0FsaWFzJywgJHZhbCwgJGNsYXNzTmFtZSk7DQoNCiAgICAgICAgaWYgKCFpc19udWxsKCRyZXQpKSB7DQogICAgICAgICAgICByZXR1cm4gJHJldDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGlmIChpc19udWxsKCRiYWNrQXR0cikpIHsNCiAgICAgICAgICAgICAgICAkYmFja0F0dHIgPSAkdGhpcy0+b3B0aW9uWydaQ19BTElBU19CQUNLX0FUVFInXTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5HZXRTb21lVGhpbmcoJG9iamVjdCwgJGJhY2tBdHRyLCAkdmFsLCAkY2xhc3NOYW1lKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOagueaNrklE5b6X5Yiw55u45bqU5pWw5o2uLg0KICAgICAqDQogICAgICogQHBhcmFtIEJhc2VbXSAgICAgJiRvYmplY3QgICDnvJPlrZjlr7nosaENCiAgICAgKiBAcGFyYW0gc3RyaW5nICAgICAkY2xhc3NOYW1lIOaJvuS4jeWIsElE5pe25Yid5aeL5YyW5a+56LGh55qE57G75ZCNDQogICAgICogQHBhcmFtIGludHxzdHJpbmcgJGlkICAgICAgICDkuI7mraTnsbvnm7jlhbPnmoRJRA0KICAgICAqDQogICAgICogQHJldHVybiBCYXNlfG51bGwNCiAgICAgKi8NCiAgICBwcml2YXRlIGZ1bmN0aW9uIEdldFNvbWVUaGluZ0J5SWQoJiRvYmplY3QsICRjbGFzc05hbWUsICRpZCkNCiAgICB7DQogICAgICAgIGlmIChlbXB0eSgkaWQpKSB7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCg0KICAgICAgICAvLyRtb2R1bGVz6Z2eSUTkuLprZXkNCiAgICAgICAgLy9pZiAoJGNsYXNzTmFtZSA9PSAiTW9kdWxlIikgew0KICAgICAgICAvLyAgICBmb3JlYWNoICgkb2JqZWN0IGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgIC8vICAgICAgICBpZiAoJHZhbHVlLT5JRCA9PSAkaWQpIHsNCiAgICAgICAgLy8gICAgICAgICAgICByZXR1cm4gJHZhbHVlOw0KICAgICAgICAvLyAgICAgICAgfQ0KICAgICAgICAvLyAgICB9DQogICAgICAgIC8vICAgICRtID0gbmV3IE1vZHVsZSgpOw0KDQogICAgICAgIC8vICAgIHJldHVybiAkbTsNCiAgICAgICAgLy99DQoNCiAgICAgICAgaWYgKGFycmF5X2tleV9leGlzdHMoJGlkLCAkb2JqZWN0KSkgew0KICAgICAgICAgICAgcmV0dXJuICRvYmplY3RbJGlkXTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICRwID0gbmV3ICRjbGFzc05hbWUoKTsNCiAgICAgICAgICAgIGlmICgkcC0+TG9hZEluZm9CeUlEKCRpZCkpIHsNCiAgICAgICAgICAgICAgICAkdGhpcy0+QWRkQ2FjaGUoJHApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gJHA7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmoLnmja7lsZ7mgKflgLzlvpfliLDnm7jlupTmlbDmja4uDQogICAgICoNCiAgICAgKiBAcGFyYW0gQmFzZVtdICYkb2JqZWN0IOe8k+WtmOWvueixoQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgICAgICAgICRjbGFzc05hbWUg5a+56LGh5pyq5om+5Yiw5pe277yM5Yid5aeL5YyW57G75ZCNDQogICAgICogQHBhcmFtIHN0cmluZyAkYXR0ciAgICDlsZ7mgKflkI0NCiAgICAgKiBAcGFyYW0gbWl4ZWQgICR2YWwgICAgIOimgeafpeaJvueahOWAvA0KICAgICAqDQogICAgICogQHJldHVybiBudWxsDQogICAgICovDQogICAgcHJpdmF0ZSBmdW5jdGlvbiBHZXRTb21lVGhpbmdCeUF0dHIoJiRvYmplY3QsICRjbGFzc05hbWUsICRhdHRyLCAkdmFsKQ0KICAgIHsNCiAgICAgICAgJGNhY2hlT2JqZWN0ID0gbnVsbDsNCiAgICAgICAgaWYgKGlzX2FycmF5KCRvYmplY3QpKSB7DQogICAgICAgICAgICAkY2FjaGVPYmplY3QgPSAmJG9iamVjdDsNCiAgICAgICAgfSBlbHNlaWYgKCRjbGFzc05hbWUgIT0gJycpIHsNCiAgICAgICAgICAgIGlmICghaXNzZXQoJHRoaXMtPmNhY2hlb2JqZWN0WyRjbGFzc05hbWVdKSkgew0KICAgICAgICAgICAgICAgICR0aGlzLT5jYWNoZW9iamVjdFskY2xhc3NOYW1lXSA9IGFycmF5KCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICAkY2FjaGVPYmplY3QgPSAmJHRoaXMtPmNhY2hlb2JqZWN0WyRjbGFzc05hbWVdOw0KICAgICAgICB9DQoNCiAgICAgICAgLy/lpoLmnpzmmK/lpJrph43lsZ7mgKflkozlgLzmn6Xor6INCiAgICAgICAgaWYgKGlzX2FycmF5KCRhdHRyKSAmJiBpc19hcnJheSgkdmFsKSkgew0KICAgICAgICAgICAgJHZhbDEgPSB0cmltKCR2YWxbMF0pOw0KICAgICAgICAgICAgJHZhbDIgPSB0cmltKCR2YWxbMV0pOw0KICAgICAgICAgICAgJHZhbDMgPSBpc3NldCgkdmFsWzJdKSA/ICR2YWxbMl0gOiBudWxsOw0KICAgICAgICAgICAgJGF0dHIxID0gJGF0dHJbMF07DQogICAgICAgICAgICAkYXR0cjIgPSAkYXR0clsxXTsNCiAgICAgICAgICAgICRhdHRyMyA9IGlzc2V0KCRhdHRyWzJdKSA/ICRhdHRyWzJdIDogbnVsbDsNCiAgICAgICAgICAgIGZvcmVhY2ggKCRjYWNoZU9iamVjdCBhcyAka2V5ID0+ICYkdmFsdWUpIHsNCiAgICAgICAgICAgICAgICBpZiAoaXNfbnVsbCgkdmFsdWUpKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoJGF0dHIzICE9PSBudWxsICYmICR2YWx1ZS0+JGF0dHIxID09ICR2YWwxICYmICR2YWx1ZS0+JGF0dHIyID09ICR2YWwyICYmICR2YWx1ZS0+JGF0dHIzID09ICR2YWwzKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiAkdmFsdWU7DQogICAgICAgICAgICAgICAgfSBlbHNlaWYgKCR2YWx1ZS0+JGF0dHIxID09ICR2YWwxICYmICR2YWx1ZS0+JGF0dHIyID09ICR2YWwyKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiAkdmFsdWU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJHZhbCA9IHRyaW0oJHZhbCk7DQogICAgICAgICAgICBmb3JlYWNoICgkY2FjaGVPYmplY3QgYXMgJGtleSA9PiAmJHZhbHVlKSB7DQogICAgICAgICAgICAgICAgaWYgKGlzX251bGwoJHZhbHVlKSkgew0KICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKCR2YWx1ZS0+JGF0dHIgPT0gJHZhbCkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHZhbHVlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOiOt+WPluaVsOaNrumAmueUqOWHveaVsC4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBCYXNlW118c3RyaW5nICRvYmplY3QgICAg57yT5a2Y5a+56LGh77yIc3RyaW5nIC8gb2JqZWN077yJDQogICAgICogQHBhcmFtIHN0cmluZyAgICAgICAgJGF0dHIgICAgICDmrLLmn6Xmib7nmoTlsZ7mgKcNCiAgICAgKiBAcGFyYW0gbWl4ZWQgICAgICAgICAkdmFsICAgICAgIOimgeafpeaJvuWGheWuuQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgICAgICAgICRjbGFzc05hbWUg5a+56LGh5pyq5om+5Yiw5pe277yM5Yid5aeL5YyW57G75ZCNDQogICAgICoNCiAgICAgKiBAcmV0dXJuIEJhc2V8bnVsbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRTb21lVGhpbmcoJG9iamVjdCwgJGF0dHIsICR2YWwsICRjbGFzc05hbWUpDQogICAgew0KICAgICAgICAkY2FjaGVPYmplY3QgPSBudWxsOw0KICAgICAgICBpZiAoaXNfYXJyYXkoJG9iamVjdCkpIHsNCiAgICAgICAgICAgICRjYWNoZU9iamVjdCA9ICRvYmplY3Q7DQogICAgICAgIH0gZWxzZWlmICgkY2xhc3NOYW1lICE9ICcnKSB7DQogICAgICAgICAgICBpZiAoIWlzc2V0KCR0aGlzLT5jYWNoZW9iamVjdFskY2xhc3NOYW1lXSkpIHsNCiAgICAgICAgICAgICAgICAkdGhpcy0+Y2FjaGVvYmplY3RbJGNsYXNzTmFtZV0gPSBhcnJheSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgJGNhY2hlT2JqZWN0ID0gJiR0aGlzLT5jYWNoZW9iamVjdFskY2xhc3NOYW1lXTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoJGF0dHIgPT0gIklEIikgew0KICAgICAgICAgICAgJHJldCA9ICR0aGlzLT5HZXRTb21lVGhpbmdCeUlkKCRjYWNoZU9iamVjdCwgJGNsYXNzTmFtZSwgJHZhbCk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkcmV0ID0gJHRoaXMtPkdldFNvbWVUaGluZ0J5QXR0cigkY2FjaGVPYmplY3QsICRjbGFzc05hbWUsICRhdHRyLCAkdmFsKTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoJHJldCA9PT0gbnVsbCAmJiAhaXNfbnVsbCgkY2xhc3NOYW1lKSkgew0KICAgICAgICAgICAgLyoqIEB2YXIgQmFzZSAkcmV0ICovDQogICAgICAgICAgICAkcmV0ID0gbmV3ICRjbGFzc05hbWUoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAkcmV0Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h0lE6I635Y+W5paH56ug5a6e5L6LLg0KICAgICAqDQogICAgICogQHBhcmFtIGludCAkaWQNCiAgICAgKg0KICAgICAqIEByZXR1cm4gUG9zdHxCYXNlDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFBvc3RCeUlEKCRpZCkNCiAgICB7DQogICAgICAgIHJldHVybiAkdGhpcy0+R2V0U29tZVRoaW5nKCdwb3N0cycsICdJRCcsICRpZCwgJ1Bvc3QnKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4dJROiOt+WPluWIhuexu+WunuS+iy4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBpbnQgJGlkDQogICAgICoNCiAgICAgKiBAcmV0dXJuIENhdGVnb3J5fEJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0Q2F0ZWdvcnlCeUlEKCRpZCkNCiAgICB7DQogICAgICAgIHJldHVybiAkdGhpcy0+R2V0U29tZVRoaW5nKCdjYXRlZ29yaWVzX2FsbCcsICdJRCcsICRpZCwgJ0NhdGVnb3J5Jyk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YCa6L+H5YiG57G75ZCN6I635Y+W5YiG57G75a6e5L6LLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbmFtZQ0KICAgICAqDQogICAgICogQHJldHVybiBDYXRlZ29yeXxCYXNlDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldENhdGVnb3J5QnlOYW1lKCRuYW1lLCAkdHlwZSA9IDApDQogICAgew0KICAgICAgICBpZiAoJHR5cGUgPT09IG51bGwpIHsNCiAgICAgICAgICAgICRjYXRlZ29yeXMgPSAmJHRoaXMtPmNhdGVnb3JpZXNfYWxsOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJGNhdGVnb3J5cyA9ICYkdGhpcy0+Y2F0ZWdvcmllc2J5b3JkZXJfdHlwZVskdHlwZV07DQogICAgICAgIH0NCiAgICAgICAgZm9yZWFjaCAoJGNhdGVnb3J5cyBhcyAka2V5ID0+ICRjKSB7DQogICAgICAgICAgICBpZiAoJG5hbWUgPT0gJGMtPk5hbWUpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gJGM7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIG5ldyBDYXRlZ29yeTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4fliIbnsbvliKvlkI3ojrflj5bliIbnsbvlrp7kvosuDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRuYW1lDQogICAgICogQHBhcmFtIG51bGwgICAkYmFja0tleQ0KICAgICAqDQogICAgICogQHJldHVybiBDYXRlZ29yeXxCYXNlDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldENhdGVnb3J5QnlBbGlhcygkbmFtZSwgJHR5cGUgPSAwKQ0KICAgIHsNCiAgICAgICAgaWYgKCR0eXBlID09PSBudWxsKSB7DQogICAgICAgICAgICAkY2F0ZWdvcnlzID0gJiR0aGlzLT5jYXRlZ29yaWVzX2FsbDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICRjYXRlZ29yeXMgPSAmJHRoaXMtPmNhdGVnb3JpZXNieW9yZGVyX3R5cGVbJHR5cGVdOw0KICAgICAgICB9DQogICAgICAgIGZvcmVhY2ggKCRjYXRlZ29yeXMgYXMgJGtleSA9PiAkYykgew0KICAgICAgICAgICAgaWYgKCRuYW1lID09ICRjLT5BbGlhcykgew0KICAgICAgICAgICAgICAgIHJldHVybiAkYzsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gbmV3IENhdGVnb3J5Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOS4juiAgeeJiOacrOS/neaMgeWFvOWuueWHveaVsC4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUNCiAgICAgKg0KICAgICAqIEByZXR1cm4gQ2F0ZWdvcnkNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0Q2F0ZWdvcnlCeUFsaWFzT3JOYW1lKCRuYW1lLCAkdHlwZSA9IDApDQogICAgew0KICAgICAgICBpZiAoJHR5cGUgPT09IG51bGwpIHsNCiAgICAgICAgICAgICRjYXRlZ29yeXMgPSAmJHRoaXMtPmNhdGVnb3JpZXNfYWxsOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJGNhdGVnb3J5cyA9ICYkdGhpcy0+Y2F0ZWdvcmllc2J5b3JkZXJfdHlwZVskdHlwZV07DQogICAgICAgIH0NCiAgICAgICAgZm9yZWFjaCAoJGNhdGVnb3J5cyBhcyAka2V5ID0+ICRjKSB7DQogICAgICAgICAgICBpZiAoJG5hbWUgPT0gJGMtPkFsaWFzIHx8ICRuYW1lID09ICRjLT5OYW1lKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICRjOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHJldHVybiBuZXcgQ2F0ZWdvcnk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YCa6L+HSUTojrflj5bmqKHlnZflrp7kvosuDQogICAgICoNCiAgICAgKiBAcGFyYW0gaW50ICRpZA0KICAgICAqDQogICAgICogQHJldHVybiBNb2R1bGV8QmFzZQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRNb2R1bGVCeUlEKCRpZCkNCiAgICB7DQogICAgICAgIHJldHVybiAkdGhpcy0+R2V0U29tZVRoaW5nKCdtb2R1bGVzJywgJ0lEJywgJGlkLCAnTW9kdWxlJyk7IC8vIFdoYXQgdGhlIGZ1Y2s/DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YCa6L+HRmlsZU5hbWXojrflj5bmqKHlnZflrp7kvosuDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRmbg0KICAgICAqDQogICAgICogQHJldHVybiBNb2R1bGV8QmFzZQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRNb2R1bGVCeUZpbGVOYW1lKCRmbikNCiAgICB7DQogICAgICAgIHJldHVybiAkdGhpcy0+R2V0U29tZVRoaW5nKCdtb2R1bGVzYnlmaWxlbmFtZScsICdGaWxlTmFtZScsICRmbiwgJ01vZHVsZScpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h0lE6I635Y+W55So5oi35a6e5L6LLg0KICAgICAqDQogICAgICogQHBhcmFtIGludCAkaWQNCiAgICAgKg0KICAgICAqIEByZXR1cm4gTWVtYmVyfEJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0TWVtYmVyQnlJRCgkaWQpDQogICAgew0KICAgICAgICAvKiogQHZhciBNZW1iZXIgJHJldCAqLw0KICAgICAgICAkcmV0ID0gJHRoaXMtPkdldFNvbWVUaGluZygnbWVtYmVycycsICdJRCcsICRpZCwgJ01lbWJlcicpOw0KICAgICAgICBpZiAoJHJldC0+SUQgPT0gbnVsbCkgew0KICAgICAgICAgICAgJHJldC0+R3VpZCA9IEdldEd1aWQoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAkcmV0Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h+eUqOaIt+WQjeiOt+WPlueUqOaIt+WunuS+iyjkuI3ljLrliIblpKflsI/lhpkpLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbmFtZQ0KICAgICAqDQogICAgICogQHJldHVybiBNZW1iZXJ8QmFzZQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRNZW1iZXJCeU5hbWUoJG5hbWUpDQogICAgew0KICAgICAgICAkbmFtZSA9IHRyaW0oJG5hbWUpOw0KICAgICAgICBpZiAoISRuYW1lIHx8ICFDaGVja1JlZ0V4cCgkbmFtZSwgJ1t1c2VybmFtZV0nKSkgew0KICAgICAgICAgICAgcmV0dXJuIG5ldyBNZW1iZXIoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChpc3NldCgkdGhpcy0+bWVtYmVyc2J5bmFtZVskbmFtZV0pKSB7DQogICAgICAgICAgICByZXR1cm4gJHRoaXMtPm1lbWJlcnNieW5hbWVbJG5hbWVdOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJGFycmF5ID0gYXJyYXlfa2V5cygkdGhpcy0+bWVtYmVyc2J5bmFtZSk7DQogICAgICAgICAgICBmb3JlYWNoICgkYXJyYXkgYXMgJGsgPT4gJHYpIHsNCiAgICAgICAgICAgICAgICBpZiAoc3RyY2FzZWNtcCgkbmFtZSwgJHYpID09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5tZW1iZXJzYnluYW1lWyR2XTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAkbGlrZSA9ICgkdGhpcy0+ZGItPnR5cGUgPT0gJ3Bnc3FsJykgPyAnSUxJS0UnIDogJ0xJS0UnOw0KICAgICAgICAkc3FsID0gJHRoaXMtPmRiLT5zcWwtPlNlbGVjdCgkdGhpcy0+dGFibGVbJ01lbWJlciddLCAnKicsIGFycmF5KGFycmF5KCRsaWtlLCAnbWVtX05hbWUnLCAkbmFtZSkpLCBhcnJheSgnbWVtX0lEJyA9PiAnQVNDJyksIDEsIG51bGwpOw0KDQogICAgICAgIC8qKiBAdmFyIE1lbWJlcltdICRhbSAqLw0KICAgICAgICAkYW0gPSAkdGhpcy0+R2V0TGlzdFR5cGUoJ01lbWJlcicsICRzcWwpOw0KICAgICAgICBpZiAoY291bnQoJGFtKSA+IDApIHsNCiAgICAgICAgICAgICRtID0gJGFtWzBdOw0KDQogICAgICAgICAgICByZXR1cm4gJG07DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gbmV3IE1lbWJlcigpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h+iOt+WPlueUqOaIt+WQjeaIluWIq+WQjeWunuS+iyjkuI3ljLrliIblpKflsI/lhpkpLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbmFtZQ0KICAgICAqDQogICAgICogQHJldHVybiBNZW1iZXJ8QmFzZQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRNZW1iZXJCeU5hbWVPckFsaWFzKCRuYW1lKQ0KICAgIHsNCiAgICAgICAgJG5hbWUgPSB0cmltKCRuYW1lKTsNCiAgICAgICAgaWYgKCEkbmFtZSB8fCAhKENoZWNrUmVnRXhwKCRuYW1lLCAnW3VzZXJuYW1lXScpIHx8IENoZWNrUmVnRXhwKCRuYW1lLCAnW25pY2tuYW1lXScpKSkgew0KICAgICAgICAgICAgcmV0dXJuIG5ldyBNZW1iZXIoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGZvcmVhY2ggKCR0aGlzLT5tZW1iZXJzIGFzICRrZXkgPT4gJiR2YWx1ZSkgew0KICAgICAgICAgICAgaWYgKHN0cmNhc2VjbXAoJHZhbHVlLT5OYW1lLCAkbmFtZSkgPT0gMCB8fCBzdHJjYXNlY21wKCR2YWx1ZS0+QWxpYXMsICRuYW1lKSA9PSAwKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICR2YWx1ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgICRsaWtlID0gKCR0aGlzLT5kYi0+dHlwZSA9PSAncGdzcWwnKSA/ICdJTElLRScgOiAnTElLRSc7DQoNCiAgICAgICAgJHNxbCA9ICR0aGlzLT5kYi0+c3FsLT5nZXQoKS0+c2VsZWN0KCR0aGlzLT50YWJsZVsnTWVtYmVyJ10pLT53aGVyZSgNCiAgICAgICAgICAgIGFycmF5KA0KICAgICAgICAgICAgICAgICIkbGlrZSBhcnJheSIsIGFycmF5KA0KICAgICAgICAgICAgICAgICAgICBhcnJheSgnbWVtX05hbWUnLCAkbmFtZSksDQogICAgICAgICAgICAgICAgICAgIGFycmF5KCdtZW1fQWxpYXMnLCAkbmFtZSksDQogICAgICAgICAgICAgICAgKQ0KICAgICAgICAgICAgKQ0KICAgICAgICApLT5saW1pdCgxKS0+c3FsOw0KDQogICAgICAgIC8qKiBAdmFyIE1lbWJlcltdICRhbSAqLw0KICAgICAgICAkYW0gPSAkdGhpcy0+R2V0TGlzdFR5cGUoJ01lbWJlcicsICRzcWwpOw0KICAgICAgICBpZiAoY291bnQoJGFtKSA+IDApIHsNCiAgICAgICAgICAgICRtID0gJGFtWzBdOw0KDQogICAgICAgICAgICByZXR1cm4gJG07DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gbmV3IE1lbWJlcigpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h+iOt+WPlueUqOaIt+eahOWIq+WQjeeahOWunuS+iyjkuI3ljLrliIblpKflsI/lhpkpLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbmFtZQ0KICAgICAqDQogICAgICogQHJldHVybiBNZW1iZXJ8QmFzZQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRNZW1iZXJCeUFsaWFzKCRuYW1lKQ0KICAgIHsNCiAgICAgICAgJG5hbWUgPSB0cmltKCRuYW1lKTsNCiAgICAgICAgaWYgKCEkbmFtZSB8fCAhKENoZWNrUmVnRXhwKCRuYW1lLCAnW25pY2tuYW1lXScpKSkgew0KICAgICAgICAgICAgcmV0dXJuIG5ldyBNZW1iZXIoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGZvcmVhY2ggKCR0aGlzLT5tZW1iZXJzIGFzICRrZXkgPT4gJiR2YWx1ZSkgew0KICAgICAgICAgICAgaWYgKHN0cmNhc2VjbXAoJHZhbHVlLT5BbGlhcywgJG5hbWUpID09IDApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gJHZhbHVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgJGxpa2UgPSAoJHRoaXMtPmRiLT50eXBlID09ICdwZ3NxbCcpID8gJ0lMSUtFJyA6ICdMSUtFJzsNCg0KICAgICAgICAkc3FsID0gJHRoaXMtPmRiLT5zcWwtPmdldCgpLT5zZWxlY3QoJHRoaXMtPnRhYmxlWydNZW1iZXInXSktPndoZXJlKA0KICAgICAgICAgICAgYXJyYXkoDQogICAgICAgICAgICAgICAgYXJyYXkoJz0nLCAnbWVtX0FsaWFzJywgJG5hbWUpDQogICAgICAgICAgICApDQogICAgICAgICktPmxpbWl0KDEpLT5zcWw7DQoNCiAgICAgICAgLyoqIEB2YXIgTWVtYmVyW10gJGFtICovDQogICAgICAgICRhbSA9ICR0aGlzLT5HZXRMaXN0VHlwZSgnTWVtYmVyJywgJHNxbCk7DQogICAgICAgIGlmIChjb3VudCgkYW0pID4gMCkgew0KICAgICAgICAgICAgJG0gPSAkYW1bMF07DQoNCiAgICAgICAgICAgIHJldHVybiAkbTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiBuZXcgTWVtYmVyKCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YCa6L+H6YKu566x5ZCN6I635Y+W55So5oi35a6e5L6LKOS4jeWMuuWIhuWkp+Wwj+WGmSkuDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRlbWFpbA0KICAgICAqDQogICAgICogQHJldHVybiBNZW1iZXINCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0TWVtYmVyQnlFbWFpbCgkZW1haWwpDQogICAgew0KICAgICAgICAkZW1haWwgPSBzdHJ0b2xvd2VyKHRyaW0oJGVtYWlsKSk7DQogICAgICAgIGlmICghJGVtYWlsIHx8ICFDaGVja1JlZ0V4cCgkZW1haWwsICdbZW1haWxdJykpIHsNCiAgICAgICAgICAgIHJldHVybiBuZXcgTWVtYmVyKCk7DQogICAgICAgIH0NCg0KICAgICAgICAkc3FsID0gJHRoaXMtPmRiLT5zcWwtPlNlbGVjdCgkdGhpcy0+dGFibGVbJ01lbWJlciddLCAnKicsIGFycmF5KGFycmF5KCdMSUtFJywgJ21lbV9FbWFpbCcsICRlbWFpbCkpLCBudWxsLCAxLCBudWxsKTsNCiAgICAgICAgLyoqIEB2YXIgTWVtYmVyW10gJGFtICovDQogICAgICAgICRhbSA9ICR0aGlzLT5HZXRMaXN0VHlwZSgnTWVtYmVyJywgJHNxbCk7DQogICAgICAgIGlmIChjb3VudCgkYW0pID4gMCkgew0KICAgICAgICAgICAgJG0gPSAkYW1bMF07DQoNCiAgICAgICAgICAgIHJldHVybiAkbTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiBuZXcgTWVtYmVyKCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5qOA5p+l5oyH5a6a5ZCN56ew55qE55So5oi35piv5ZCm5a2Y5ZyoKOS4jeWMuuWIhuWkp+Wwj+WGmSkuDQogICAgICoNCiAgICAgKiBAcGFyYW0gJG5hbWUNCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBDaGVja01lbWJlck5hbWVFeGlzdCgkbmFtZSkNCiAgICB7DQogICAgICAgICRtID0gJHRoaXMtPkdldE1lbWJlckJ5TmFtZSgkbmFtZSk7DQoNCiAgICAgICAgcmV0dXJuICRtLT5JRCAhPSBudWxsOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOajgOafpeaMh+WumuWQjeensOaIluWIq+WQjeeahOeUqOaIt+aYr+WQpuWtmOWcqCjkuI3ljLrliIblpKflsI/lhpkpLg0KICAgICAqDQogICAgICogQHBhcmFtICRuYW1lDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQ2hlY2tNZW1iZXJCeU5hbWVPckFsaWFzRXhpc3QoJG5hbWUpDQogICAgew0KICAgICAgICAkbSA9ICR0aGlzLT5HZXRNZW1iZXJCeU5hbWVPckFsaWFzKCRuYW1lKTsNCg0KICAgICAgICByZXR1cm4gJG0tPklEID4gMDsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmo4Dmn6XmjIflrprpgq7nrrHnmoTnlKjmiLfmmK/lkKblrZjlnKgo5LiN5Yy65YiG5aSn5bCP5YaZKS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSAkZW1haWwNCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBDaGVja01lbWJlckJ5RW1haWxFeGlzdCgkZW1haWwpDQogICAgew0KICAgICAgICAkbSA9ICR0aGlzLT5HZXRNZW1iZXJCeUVtYWlsKCRlbWFpbCk7DQoNCiAgICAgICAgcmV0dXJuICRtLT5JRCA+IDA7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YCa6L+HSUTojrflj5bor4Torrrlrp7kvosuDQogICAgICoNCiAgICAgKiBAcGFyYW0gaW50ICRpZA0KICAgICAqDQogICAgICogQHJldHVybiBDb21tZW50fEJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0Q29tbWVudEJ5SUQoJGlkKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuICR0aGlzLT5HZXRTb21lVGhpbmcoJ2NvbW1lbnRzJywgJ0lEJywgJGlkLCAnQ29tbWVudCcpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h0lE6I635Y+W6ZmE5Lu25a6e5L6LLg0KICAgICAqDQogICAgICogQHBhcmFtIGludCAkaWQNCiAgICAgKg0KICAgICAqIEByZXR1cm4gVXBsb2FkfEJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0VXBsb2FkQnlJRCgkaWQpDQogICAgew0KICAgICAgICByZXR1cm4gJHRoaXMtPkdldFNvbWVUaGluZygnVXBsb2FkJywgJ0lEJywgJGlkLCAnVXBsb2FkJyk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YCa6L+HdGFn5Yir5ZCN6I635Y+WdGFn5a6e5L6LLijlhYjotbBjYWNoZW9iamVjdOWGjei1sOafpeaVsOaNruW6kykNCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUNCiAgICAgKiBAcGFyYW0gbnVsbCAgICRiYWNrS2V5DQogICAgICoNCiAgICAgKiBAcmV0dXJuIFRhZ3xCYXNlDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFRhZ0J5QWxpYXMoJG5hbWUsICR0eXBlID0gMCkNCiAgICB7DQogICAgICAgICRyZXQgPSAkdGhpcy0+R2V0U29tZVRoaW5nQnlBdHRyKCR0aGlzLT50YWdzLCAnVGFnJywgYXJyYXkoJ0FsaWFzJywnVHlwZScpLCBhcnJheSgkbmFtZSwgJHR5cGUpKTsNCiAgICAgICAgaWYgKGlzX29iamVjdCgkcmV0KSAmJiAkcmV0LT5JRCA+PSAwKSB7DQogICAgICAgICAgICByZXR1cm4gJHJldDsNCiAgICAgICAgfQ0KDQogICAgICAgICRhID0gYXJyYXkoKTsNCiAgICAgICAgJGFbXSA9IGFycmF5KCc9JywndGFnX0FsaWFzJywgJG5hbWUpOw0KICAgICAgICAkYVtdID0gYXJyYXkoJz0nLCAndGFnX1R5cGUnLCAkdHlwZSk7DQogICAgICAgICRhcnJheSA9ICR0aGlzLT5HZXRUYWdMaXN0KCcqJywgYXJyYXkoJGEpLCAnJywgMSwgJycpOw0KICAgICAgICBpZiAoY291bnQoJGFycmF5KSA9PSAwKSB7DQogICAgICAgICAgICByZXR1cm4gbmV3IFRhZygpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgcmV0dXJuICRhcnJheVswXTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h3RhZ+WQjeiOt+WPlnRhZ+WunuS+iy4o5YWI6LWwY2FjaGVvYmplY3Tlho3otbDmn6XmlbDmja7lupMpDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRuYW1lDQogICAgICogQHBhcmFtIG51bGwgICAkYmFja0tleQ0KICAgICAqDQogICAgICogQHJldHVybiBUYWd8QmFzZQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRUYWdCeU5hbWUoJG5hbWUsICR0eXBlID0gMCkNCiAgICB7DQogICAgICAgICRyZXQgPSAkdGhpcy0+R2V0U29tZVRoaW5nQnlBdHRyKCR0aGlzLT50YWdzLCAnVGFnJywgYXJyYXkoJ05hbWUnLCdUeXBlJyksIGFycmF5KCRuYW1lLCAkdHlwZSkpOw0KICAgICAgICBpZiAoaXNfb2JqZWN0KCRyZXQpICYmICRyZXQtPklEID49IDApIHsNCiAgICAgICAgICAgIHJldHVybiAkcmV0Ow0KICAgICAgICB9DQoNCiAgICAgICAgJGEgPSBhcnJheSgpOw0KICAgICAgICAkYVtdID0gYXJyYXkoJz0nLCAndGFnX05hbWUnLCAkbmFtZSk7DQogICAgICAgICRhW10gPSBhcnJheSgnPScsICd0YWdfVHlwZScsICR0eXBlKTsNCiAgICAgICAgJGFycmF5ID0gJHRoaXMtPkdldFRhZ0xpc3QoJyonLCBhcnJheSgkYSksICcnLCAxLCAnJyk7DQogICAgICAgIGlmIChjb3VudCgkYXJyYXkpID09IDApIHsNCiAgICAgICAgICAgIHJldHVybiBuZXcgVGFnKCk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICByZXR1cm4gJGFycmF5WzBdOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YCa6L+HdGFn55qE5Yir5ZCN5oiW5piv5ZCN56ew6I635Y+WdGFn5a6e5L6LLijmn6XmlbDmja7lupPpnZ7otbBjYWNoZW9iamVjdCkNCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUNCiAgICAgKg0KICAgICAqIEByZXR1cm4gVGFnfEJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0VGFnQnlBbGlhc09yTmFtZSgkbmFtZSwgJHR5cGUgPSAwKQ0KICAgIHsNCiAgICAgICAgLy9yZXR1cm4gJHRoaXMtPkdldFRhZ0J5QWxpYXMoJG5hbWUsICdOYW1lJyk7DQogICAgICAgICRhID0gYXJyYXkoKTsNCiAgICAgICAgJGFbXSA9IGFycmF5KCd0YWdfQWxpYXMnLCAkbmFtZSk7DQogICAgICAgICRhW10gPSBhcnJheSgndGFnX05hbWUnLCAkbmFtZSk7DQogICAgICAgICRiID0gYXJyYXkoJz0nLCAndGFnX1R5cGUnLCAkdHlwZSk7DQogICAgICAgICRhcnJheSA9ICR0aGlzLT5HZXRUYWdMaXN0KCcqJywgYXJyYXkoYXJyYXkoJ2FycmF5JywgJGEpLCAkYiksICcnLCAxLCAnJyk7DQogICAgICAgIGlmIChjb3VudCgkYXJyYXkpID09IDApIHsNCiAgICAgICAgICAgIHJldHVybiBuZXcgVGFnKCk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICByZXR1cm4gJGFycmF5WzBdOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YCa6L+HSUTojrflj5Z0YWflrp7kvosuDQogICAgICoNCiAgICAgKiBAcGFyYW0gaW50ICRpZA0KICAgICAqDQogICAgICogQHJldHVybiBUYWd8QmFzZQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRUYWdCeUlEKCRpZCkNCiAgICB7DQogICAgICAgICRyZXQgPSAkdGhpcy0+R2V0U29tZVRoaW5nKCd0YWdzX2FsbCcsICdJRCcsICRpZCwgJ1RhZycpOw0KDQogICAgICAgIHJldHVybiAkcmV0Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h+exu+S8vCd7MX17Mn17M317NH0n6L295YWldGFncy4NCiAgICAgKg0KICAgICAqIEBwYXJhbSAkcw0KICAgICAqDQogICAgICogQHJldHVybiBhcnJheQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBMb2FkVGFnc0J5SURTdHJpbmcoJHMpDQogICAgew0KICAgICAgICAkcyA9IHRyaW0oJHMpOw0KICAgICAgICBpZiAoJHMgPT09ICcnKSB7DQogICAgICAgICAgICByZXR1cm4gYXJyYXkoKTsNCiAgICAgICAgfQ0KDQogICAgICAgICRzID0gc3RyX3JlcGxhY2UoJ317JywgJ3wnLCAkcyk7DQogICAgICAgICRzID0gc3RyX3JlcGxhY2UoYXJyYXkoJ3snLCAnfScpLCAnJywgJHMpOw0KICAgICAgICAkYSA9IGV4cGxvZGUoJ3wnLCAkcyk7DQogICAgICAgICRiID0gYXJyYXkoKTsNCiAgICAgICAgZm9yZWFjaCAoJGEgYXMgJiR2YWx1ZSkgew0KICAgICAgICAgICAgJHZhbHVlID0gdHJpbSgkdmFsdWUpOw0KICAgICAgICAgICAgaWYgKCR2YWx1ZSkgew0KICAgICAgICAgICAgICAgICRiW10gPSAkdmFsdWU7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgJHQgPSBhcnJheV91bmlxdWUoJGIpOw0KDQogICAgICAgIGlmIChjb3VudCgkdCkgPT09IDApIHsNCiAgICAgICAgICAgIHJldHVybiBhcnJheSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgJGMgPSBhcnJheSgpOw0KICAgICAgICAkZCA9IGFycmF5KCk7DQogICAgICAgIGZvcmVhY2ggKCR0IGFzICR2KSB7DQogICAgICAgICAgICBpZiAoYXJyYXlfa2V5X2V4aXN0cygkdiwgJHRoaXMtPnRhZ3NfYWxsKSA9PSBmYWxzZSkgew0KICAgICAgICAgICAgICAgICRjW10gPSAkdjsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgJGRbJHZdID0gJiR0aGlzLT50YWdzX2FsbFskdl07DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoY291bnQoJGMpID09PSAwKSB7DQogICAgICAgICAgICByZXR1cm4gJGQ7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkdCA9IGFycmF5KCk7DQogICAgICAgICAgICAkYXJyYXkgPSAkdGhpcy0+R2V0VGFnTGlzdCgnJywgYXJyYXkoYXJyYXkoJ0lOJywgJ3RhZ19JRCcsICRjKSksICcnLCAnJywgJycpOw0KICAgICAgICAgICAgZm9yZWFjaCAoJGFycmF5IGFzICR2KSB7DQogICAgICAgICAgICAgICAgJHRbJHYtPklEXSA9ICYkdGhpcy0+dGFnc19hbGxbJHYtPklEXTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuIGFycmF5X21lcmdlKCRkLCAkdCk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4fnsbvkvLwnYWFhLGJiYixjY2MsZGRkJ+i9veWFpXRhZ3MuDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRzIOagh+etvuWQjeWtl+espuS4su+8jOWmgidhYWEsYmJiLGNjYyxkZGQNCiAgICAgKiBAcGFyYW0gaW50ICRwb3N0dHlwZSB0eXBlDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGFycmF5DQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIExvYWRUYWdzQnlOYW1lU3RyaW5nKCRzLCAkcG9zdHR5cGUgPSAwKQ0KICAgIHsNCiAgICAgICAgJHMgPSB0cmltKCRzKTsNCiAgICAgICAgJHMgPSBzdHJfcmVwbGFjZShhcnJheSgnOycsICfvvIwnLCAn44CBJyksICcsJywgJHMpOw0KICAgICAgICAkcyA9IHRyaW0oJHMpOw0KICAgICAgICAkcyA9IHN0cmlwX3RhZ3MoJHMpOw0KICAgICAgICBpZiAoJHMgPT09ICcnIHx8ICRzID09PSAnLCcpIHsNCiAgICAgICAgICAgIHJldHVybiBhcnJheSgpOw0KICAgICAgICB9DQogICAgICAgICRzID0gZXhwbG9kZSgnLCcsICRzKTsNCiAgICAgICAgJHQgPSBhcnJheV91bmlxdWUoJHMpOw0KICAgICAgICBpZiAoY291bnQoJHQpID09PSAwKSB7DQogICAgICAgICAgICByZXR1cm4gYXJyYXkoKTsNCiAgICAgICAgfQ0KDQogICAgICAgICR1bmxvYWRfdGFncyA9IGFycmF5KCk7DQogICAgICAgICRleGlzdF90YWdzID0gYXJyYXkoKTsNCiAgICAgICAgZm9yZWFjaCAoJHQgYXMgJG5hbWUpIHsNCiAgICAgICAgICAgICRuYW1lID0gdHJpbSgkbmFtZSk7DQogICAgICAgICAgICBpZiAoaXNzZXQoJHRoaXMtPnRhZ3NieW5hbWVfdHlwZVskcG9zdHR5cGVdWyRuYW1lXSkgPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICAgICAkdW5sb2FkX3RhZ3NbXSA9IGFycmF5KCd0YWdfTmFtZScsICRuYW1lKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgJGV4aXN0X3RhZ3NbJG5hbWVdID0gJiR0aGlzLT50YWdzYnluYW1lX3R5cGVbJHBvc3R0eXBlXVskbmFtZV07DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoY291bnQoJHVubG9hZF90YWdzKSA9PSAwKSB7DQogICAgICAgICAgICByZXR1cm4gJGV4aXN0X3RhZ3M7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkYXJyYXkgPSAkdGhpcy0+R2V0VGFnTGlzdCgnJywgYXJyYXkoYXJyYXkoJz0nLCAndGFnX1R5cGUnLCAkcG9zdHR5cGUpLCBhcnJheSgnYXJyYXknLCAkdW5sb2FkX3RhZ3MpKSwgJycsICcnLCAnJyk7DQogICAgICAgICAgICBmb3JlYWNoICgkYXJyYXkgYXMgJHRhZykgew0KICAgICAgICAgICAgICAgICRleGlzdF90YWdzWyR0YWctPk5hbWVdID0gJiR0aGlzLT50YWdzYnluYW1lX3R5cGVbJHBvc3R0eXBlXVskdGFnLT5OYW1lXTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiAkZXhpc3RfdGFnczsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h+aVsOe7hGFycmF5WzExMSwzMzMsNDQ0LDU1NSw2NjZd6L2s5o2i5oiQ5a2Y5YKo5LiyLg0KICAgICAqDQogICAgICogQHBhcmFtIGFycmF5ICRhcnJheSDmoIfnrb5JROaVsOe7hA0KICAgICAqDQogICAgICogQHJldHVybiBzdHJpbmcNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQ29udmVydFRhZ0lEdG9TdHJpbmcoJGFycmF5KQ0KICAgIHsNCiAgICAgICAgJHMgPSAnJzsNCiAgICAgICAgZm9yZWFjaCAoJGFycmF5IGFzICRhKSB7DQogICAgICAgICAgICAkcyAuPSAneycgLiAkYSAuICd9JzsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAkczsNCiAgICB9DQoNCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0VG9wQXJ0aWNsZSgkdHlwZSA9IDApDQogICAgew0KICAgICAgICByZXR1cm4gJHRoaXMtPkdldFRvcFBvc3QoJHR5cGUpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOiOt+WPluWFqOmDqOe9rumhtuaWh+eroO+8iOS8mOWFiOS7jmNhY2hl6YeM6K+75pWw57uE77yJLg0KICAgICAqDQogICAgICogQHBhcmFtIGludCAkdHlwZQ0KICAgICAqDQogICAgICogQHJldHVybiBhcnJheQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRUb3BQb3N0KCR0eXBlID0gMCkNCiAgICB7DQogICAgICAgICR2YXJuYW1lID0gJ3RvcF9wb3N0X2FycmF5XycgLiAkdHlwZTsNCiAgICAgICAgaWYgKCR0aGlzLT5jYWNoZS0+SGFzS2V5KCR2YXJuYW1lKSA9PSBmYWxzZSkgew0KICAgICAgICAgICAgcmV0dXJuIGFycmF5KCk7DQogICAgICAgIH0NCiAgICAgICAgaWYgKCFpc19zdHJpbmcoJHRoaXMtPmNhY2hlLT4kdmFybmFtZSkpIHsNCiAgICAgICAgICAgIHJldHVybiBhcnJheSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgQCRhcnRpY2xlc190b3Bfbm90b3JkZXJfaWRhcnJheSA9IHVuc2VyaWFsaXplKCR0aGlzLT5jYWNoZS0+JHZhcm5hbWUpOw0KICAgICAgICBpZiAoIWlzX2FycmF5KCRhcnRpY2xlc190b3Bfbm90b3JkZXJfaWRhcnJheSkpIHsNCiAgICAgICAgICAgIENvdW50VG9wUG9zdCgkdHlwZSwgbnVsbCwgbnVsbCk7DQogICAgICAgICAgICBAJGFydGljbGVzX3RvcF9ub3RvcmRlcl9pZGFycmF5ID0gdW5zZXJpYWxpemUoJHRoaXMtPmNhY2hlLT4kdmFybmFtZSk7DQogICAgICAgIH0NCg0KICAgICAgICAkYXJ0aWNsZXNfdG9wX25vdG9yZGVyID0gYXJyYXkoKTsNCiAgICAgICAgaWYgKGlzX2FycmF5KCRhcnRpY2xlc190b3Bfbm90b3JkZXJfaWRhcnJheSkpIHsNCiAgICAgICAgICAgICRhcnRpY2xlc190b3Bfbm90b3JkZXIgPSAkdGhpcy0+R2V0UG9zdEJ5QXJyYXkoJGFydGljbGVzX3RvcF9ub3RvcmRlcl9pZGFycmF5KTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAkYXJ0aWNsZXNfdG9wX25vdG9yZGVyOw0KICAgIH0NCg0KICAgIC8vIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQogICAgLy/pqozor4Hnm7jlhbMNCg0KICAgIC8qKg0KICAgICAqIOiOt+WPluivhOiuumtleS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSAkaWQNCiAgICAgKg0KICAgICAqIEByZXR1cm4gc3RyaW5nDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldENtdEtleSgkaWQpDQogICAgew0KICAgICAgICByZXR1cm4gbWQ1KCR0aGlzLT5ndWlkIC4gJGlkIC4gZGF0ZSgnWW1kaCcpKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpqozor4Hor4TorrprZXkuDQogICAgICoNCiAgICAgKiBAcGFyYW0gJGlkDQogICAgICogQHBhcmFtICRrZXkNCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBWYWxpZENtdEtleSgkaWQsICRrZXkpDQogICAgew0KICAgICAgICAkbm93a2V5ID0gbWQ1KCR0aGlzLT5ndWlkIC4gJGlkIC4gZGF0ZSgnWW1kaCcpKTsNCiAgICAgICAgJG5vd2tleTIgPSBtZDUoJHRoaXMtPmd1aWQgLiAkaWQgLiBkYXRlKCdZbWRoJywgKHRpbWUoKSAtICgzNjAwICogMSkpKSk7DQoNCiAgICAgICAgcmV0dXJuICRrZXkgPT0gJG5vd2tleSB8fCAka2V5ID09ICRub3drZXkyOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOiOt+WPlkNTUkYgVG9rZW4uDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRpZCDlupTnlKhJRO+8jOWPr+S7peS/neivgeavj+S4quW6lOeUqOiOt+WPluS4jeWQjOeahFRva2VuDQogICAgICoNCiAgICAgKiBAcmV0dXJuIHN0cmluZw0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRDU1JGVG9rZW4oJGlkID0gJycpDQogICAgew0KICAgICAgICAkcyA9ICR0aGlzLT51c2VyLT5JRCAuICR0aGlzLT51c2VyLT5QYXNzd29yZCAuICR0aGlzLT51c2VyLT5TdGF0dXM7DQoNCiAgICAgICAgcmV0dXJuIG1kNSgkdGhpcy0+Z3VpZCAuICRzIC4gJGlkIC4gZGF0ZSgnWW1kaCcpKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpqozor4FDU1JGIFRva2VuLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkdG9rZW4NCiAgICAgKiBAcGFyYW0gc3RyaW5nICRpZCAgICDlupTnlKhJRO+8jOWPr+S4uuavj+S4quW6lOeUqOeUn+aIkOS4gOS4quS4k+WxnnRva2VuDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gVmVyaWZ5Q1NSRlRva2VuKCR0b2tlbiwgJGlkID0gJycpDQogICAgew0KICAgICAgICAkdXNlclN0cmluZyA9ICR0aGlzLT51c2VyLT5JRCAuICR0aGlzLT51c2VyLT5QYXNzd29yZCAuICR0aGlzLT51c2VyLT5TdGF0dXM7DQogICAgICAgICR0b2tlblN0cmluZyA9ICR0aGlzLT5ndWlkIC4gJHVzZXJTdHJpbmcgLiAkaWQ7DQoNCiAgICAgICAgZm9yICgkaSA9IDA7ICRpIDw9ICR0aGlzLT5jc3JmRXhwaXJhdGlvbjsgJGkrKykgew0KICAgICAgICAgICAgaWYgKCR0b2tlbiA9PT0gbWQ1KCR0b2tlblN0cmluZyAuIGRhdGUoJ1ltZGgnLCAodGltZSgpIC0gKDM2MDAgKiAkaSkpKSkpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmmL7npLrpqozor4HnoIENCiAgICAgKg0KICAgICAqIEBhcGkgRmlsdGVyX1BsdWdpbl9aYnBfU2hvd1ZhbGlkQ29kZSDlpoLor6XmjqXlj6PmnKrooqvmjILovb3liJnmmL7npLrpu5jorqTpqozor4Hlm77niYcNCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJGlkIOWRveWQjeS6i+S7tg0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFNob3dWYWxpZENvZGUoJGlkID0gJycpDQogICAgew0KICAgICAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9aYnBfU2hvd1ZhbGlkQ29kZSddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAgICAgcmV0dXJuICRmcG5hbWUoJGlkKTsgLy8qDQogICAgICAgIH0NCg0KICAgICAgICAkX3ZjID0gbmV3IFZhbGlkYXRlQ29kZSgpOw0KICAgICAgICAkX3ZjLT5HZXRJbWcoKTsNCiAgICAgICAgc2V0Y29va2llKCdjYXB0Y2hhXycgLiBjcmMzMigkdGhpcy0+Z3VpZCAuICRpZCksIG1kNSgkdGhpcy0+Z3VpZCAuIGRhdGUoIlltZGgiKSAuICRfdmMtPkdldENvZGUoKSksIG51bGwsICR0aGlzLT5jb29raWVzcGF0aCk7DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5q+U5a+56aqM6K+B56CBDQogICAgICoNCiAgICAgKiBAYXBpIEZpbHRlcl9QbHVnaW5fWmJwX0NoZWNrVmFsaWRDb2RlIOWmguivpeaOpeWPo+acquiiq+aMgui9veWImeavlOWvuem7mOiupOmqjOivgeeggQ0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkdmVyaWZ5Q29kZSDpqozor4HnoIHmlbDlgLwNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRpZCAgICAgICAgIOWRveWQjeS6i+S7tg0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIENoZWNrVmFsaWRDb2RlKCR2ZXJpZnlDb2RlLCAkaWQgPSAnJykNCiAgICB7DQogICAgICAgICR2ZXJpZnlDb2RlID0gc3RydG9sb3dlcigkdmVyaWZ5Q29kZSk7DQogICAgICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1picF9DaGVja1ZhbGlkQ29kZSddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAgICAgcmV0dXJuICRmcG5hbWUoJHZlcmlmeUNvZGUsICRpZCk7IC8vKg0KICAgICAgICB9DQoNCiAgICAgICAgJG9yaWdpbmFsID0gR2V0VmFycygnY2FwdGNoYV8nIC4gY3JjMzIoJHRoaXMtPmd1aWQgLiAkaWQpLCAnQ09PS0lFJyk7DQogICAgICAgIHNldGNvb2tpZSgnY2FwdGNoYV8nIC4gY3JjMzIoJHRoaXMtPmd1aWQgLiAkaWQpLCAnJywgKHRpbWUoKSAtIDM2MDApLCAkdGhpcy0+Y29va2llc3BhdGgpOw0KDQogICAgICAgIHJldHVybiBtZDUoJHRoaXMtPmd1aWQgLiBkYXRlKCJZbWRoIikgLiBzdHJ0b2xvd2VyKCR2ZXJpZnlDb2RlKSkgPT0gJG9yaWdpbmFsDQogICAgICAgICAgICB8fA0KICAgICAgICAgICAgbWQ1KCR0aGlzLT5ndWlkIC4gZGF0ZSgiWW1kaCIsICh0aW1lKCkgLSAoMzYwMCAqIDEpKSkgLiBzdHJ0b2xvd2VyKCR2ZXJpZnlDb2RlKSkgPT0gJG9yaWdpbmFsOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWQkeWvvOiIquiPnOWNlea3u+WKoOebuOW6lOadoeebri4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHR5cGUgJHR5cGU9Y2F0ZWdvcnksdGFnLHBhZ2UsaXRlbQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgJGlkDQogICAgICogQHBhcmFtIHN0cmluZyAkbmFtZQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHVybA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBBZGRJdGVtVG9OYXZiYXIoJHR5cGUsICRpZCwgJG5hbWUsICR1cmwpDQogICAgew0KICAgICAgICBpZiAoISR0eXBlKSB7DQogICAgICAgICAgICAkdHlwZSA9ICdpdGVtJzsNCiAgICAgICAgfQ0KDQogICAgICAgICRtID0gJHRoaXMtPm1vZHVsZXNieWZpbGVuYW1lWyduYXZiYXInXTsNCiAgICAgICAgJHMgPSAkbS0+Q29udGVudDsNCg0KICAgICAgICAkYSA9ICc8bGkgaWQ9Im5hdmJhci0nIC4gJHR5cGUgLiAnLScgLiAkaWQgLiAnIj48YSBocmVmPSInIC4gJHVybCAuICciPicgLiAkbmFtZSAuICc8L2E+PC9saT4nOw0KDQogICAgICAgIGlmICgkdGhpcy0+Q2hlY2tJdGVtVG9OYXZiYXIoJHR5cGUsICRpZCkpIHsNCiAgICAgICAgICAgICRzID0gcHJlZ19yZXBsYWNlKCcvPGxpIGlkPSJuYXZiYXItJyAuICR0eXBlIC4gJy0nIC4gJGlkIC4gJyI+Lio/PFwvbGk+LycsICRhLCAkcyk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkcyAuPSAnPGxpIGlkPSJuYXZiYXItJyAuICR0eXBlIC4gJy0nIC4gJGlkIC4gJyI+PGEgaHJlZj0iJyAuICR1cmwgLiAnIj4nIC4gJG5hbWUgLiAnPC9hPjwvbGk+JzsNCiAgICAgICAgfQ0KDQogICAgICAgICRtLT5Db250ZW50ID0gJHM7DQogICAgICAgICRtLT5TYXZlKCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5Yig6Zmk5a+86Iiq6I+c5Y2V5Lit55u45bqU5p2h55uuLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkdHlwZQ0KICAgICAqIEBwYXJhbSAkaWQNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gRGVsSXRlbVRvTmF2YmFyKCR0eXBlLCAkaWQpDQogICAgew0KICAgICAgICBpZiAoISR0eXBlKSB7DQogICAgICAgICAgICAkdHlwZSA9ICdpdGVtJzsNCiAgICAgICAgfQ0KDQogICAgICAgICRtID0gJHRoaXMtPm1vZHVsZXNieWZpbGVuYW1lWyduYXZiYXInXTsNCiAgICAgICAgJHMgPSAkbS0+Q29udGVudDsNCg0KICAgICAgICAkcyA9IHByZWdfcmVwbGFjZSgnLzxsaSBpZD0ibmF2YmFyLScgLiAkdHlwZSAuICctJyAuICRpZCAuICciPi4qPzxcL2xpPi8nLCAnJywgJHMpOw0KDQogICAgICAgICRtLT5Db250ZW50ID0gJHM7DQogICAgICAgICRtLT5TYXZlKCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5qOA5p+l5p2h55uu5piv5ZCm5Zyo5a+86Iiq6I+c5Y2V5LitLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkdHlwZQ0KICAgICAqIEBwYXJhbSAkaWQNCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBDaGVja0l0ZW1Ub05hdmJhcigkdHlwZSwgJGlkKQ0KICAgIHsNCiAgICAgICAgaWYgKCEkdHlwZSkgew0KICAgICAgICAgICAgJHR5cGUgPSAnaXRlbSc7DQogICAgICAgIH0NCg0KICAgICAgICAkbSA9ICR0aGlzLT5tb2R1bGVzYnlmaWxlbmFtZVsnbmF2YmFyJ107DQogICAgICAgICRzID0gJG0tPkNvbnRlbnQ7DQoNCiAgICAgICAgcmV0dXJuIChib29sKSBzdHJwb3MoJHMsICdpZD0ibmF2YmFyLScgLiAkdHlwZSAuICctJyAuICRpZCAuICciJyk7DQogICAgfQ0KDQogICAgLy8kc2lnbmFsID0gZ29vZCxiYWQsdGlwcw0KICAgIHByaXZhdGUgJGhpbnRzID0gYXJyYXkoKTsNCg0KICAgIC8qKg0KICAgICAqIOiuvue9ruaPkOekuua2iOaBr+W5tuWtmOWFpUNvb2tpZS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHNpZ25hbCAg5o+Q56S657G75Z6L77yIZ29vZHxiYWR8dGlwc++8iQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgJGNvbnRlbnQg5o+Q56S65YaF5a65DQogICAgICogQHBhcmFtIGludCAkZGVsYXkg5bu25pe25pe26Ze0DQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFNldEhpbnQoJHNpZ25hbCwgJGNvbnRlbnQgPSAnJywgJGRlbGF5ID0gMTApDQogICAgew0KICAgICAgICBpZiAoJGNvbnRlbnQgPT0gJycpIHsNCiAgICAgICAgICAgIGlmIChzdWJzdHIoJHNpZ25hbCwgMCwgNCkgPT0gJ2dvb2QnKSB7DQogICAgICAgICAgICAgICAgJGNvbnRlbnQgPSAkdGhpcy0+bGFuZ1snbXNnJ11bJ29wZXJhdGlvbl9zdWNjZWVkJ107DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmIChzdWJzdHIoJHNpZ25hbCwgMCwgMykgPT0gJ2JhZCcpIHsNCiAgICAgICAgICAgICAgICAkY29udGVudCA9ICR0aGlzLT5sYW5nWydtc2cnXVsnb3BlcmF0aW9uX2ZhaWxlZCddOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgICRjb250ZW50ID0gc3Vic3RyKCRjb250ZW50LCAwLCAyNTUpOw0KICAgICAgICBmb3IgKCRpID0gMTsgJGkgPD0gMTA7ICRpKyspIHsNCiAgICAgICAgICAgIGlmIChpc3NldCgkdGhpcy0+aGludHNbJGldKSkgew0KICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgJGhpbnQgPSBuZXcgc3RkQ2xhc3M7DQogICAgICAgICAgICAkaGludC0+c2lnbmFsID0gJHNpZ25hbDsNCiAgICAgICAgICAgICRoaW50LT5jb250ZW50ID0gJGNvbnRlbnQ7DQogICAgICAgICAgICAkaGludC0+ZGVsYXkgPSAkZGVsYXk7DQogICAgICAgICAgICAkdGhpcy0+aGludHNbJGldID0gJGhpbnQ7DQogICAgICAgICAgICBzZXRjb29raWUoImhpbnRfc2lnbmFsIiAuICRpLCBqc29uX2VuY29kZSgkaGludCksIDAsICR0aGlzLT5jb29raWVzcGF0aCk7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOaPkOWPlkNvb2tpZeS4reeahOaPkOekuua2iOaBry4NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0SGludCgpDQogICAgew0KICAgICAgICBmb3IgKCRpID0gMTsgJGkgPD0gMTA7ICRpKyspIHsNCiAgICAgICAgICAgIGlmIChpc3NldCgkdGhpcy0+aGludHNbJGldKSAmJiBpc19vYmplY3QoJHRoaXMtPmhpbnRzWyRpXSkpIHsNCiAgICAgICAgICAgICAgICAkdGhpcy0+U2hvd0hpbnQoJHRoaXMtPmhpbnRzWyRpXSk7DQogICAgICAgICAgICAgICAgaWYgKEdldFZhcnMoImhpbnRfc2lnbmFsIiAuICRpLCAnQ09PS0lFJykgPT09IGpzb25fZW5jb2RlKCR0aGlzLT5oaW50c1skaV0pKSB7DQogICAgICAgICAgICAgICAgICAgIHNldGNvb2tpZSgiaGludF9zaWduYWwiIC4gJGksICcnLCAodGltZSgpIC0gMzYwMCksICR0aGlzLT5jb29raWVzcGF0aCk7DQogICAgICAgICAgICAgICAgICAgIHVuc2V0KCRfQ09PS0lFWyJoaW50X3NpZ25hbCIgLiAkaV0pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBmb3IgKCRpID0gMTsgJGkgPD0gMTA7ICRpKyspIHsNCiAgICAgICAgICAgICRzaWduYWwgPSBHZXRWYXJzKCdoaW50X3NpZ25hbCcgLiAkaSwgJ0NPT0tJRScpOw0KICAgICAgICAgICAgJGhpbnQgPSBqc29uX2RlY29kZSgkc2lnbmFsKTsNCiAgICAgICAgICAgIGlmICgkaGludCAhPT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICR0aGlzLT5TaG93SGludCgkaGludCk7DQogICAgICAgICAgICAgICAgc2V0Y29va2llKCJoaW50X3NpZ25hbCIgLiAkaSwgJycsICh0aW1lKCkgLSAzNjAwKSwgJHRoaXMtPmNvb2tpZXNwYXRoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOeUseaPkOekuua2iOaBr+iOt+WPlkhUTUwuDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRzaWduYWwgIOaPkOekuuexu+Wei++8iGdvb2R8YmFkfHRpcHPvvIkNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRjb250ZW50IOaPkOekuuWGheWuuQ0KICAgICAqIEBwYXJhbSBpbnQgJGRlbGF5IOW7tuaXtuaXtumXtA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBTaG93SGludCgkc2lnbmFsLCAkY29udGVudCA9ICcnLCAkZGVsYXkgPSAxMCkNCiAgICB7DQogICAgICAgIC8vMS435aKe5YqgJHNpZ25hbOS4umpzb27nsbvlnosNCiAgICAgICAgJGhpbnQgPSAkc2lnbmFsOw0KICAgICAgICBpZiAoaXNfb2JqZWN0KCRoaW50KSkgew0KICAgICAgICAgICAgJHNpZ25hbCA9ICRoaW50LT5zaWduYWw7DQogICAgICAgICAgICAkY29udGVudCA9ICRoaW50LT5jb250ZW50Ow0KICAgICAgICAgICAgJGRlbGF5ID0gJGhpbnQtPmRlbGF5Ow0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCRjb250ZW50ID09ICcnKSB7DQogICAgICAgICAgICBpZiAoc3Vic3RyKCRzaWduYWwsIDAsIDQpID09ICdnb29kJykgew0KICAgICAgICAgICAgICAgICRjb250ZW50ID0gJHRoaXMtPmxhbmdbJ21zZyddWydvcGVyYXRpb25fc3VjY2VlZCddOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoc3Vic3RyKCRzaWduYWwsIDAsIDMpID09ICdiYWQnKSB7DQogICAgICAgICAgICAgICAgJGNvbnRlbnQgPSAkdGhpcy0+bGFuZ1snbXNnJ11bJ29wZXJhdGlvbl9mYWlsZWQnXTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICAkZGVsYXkgPSAoJGRlbGF5ICogMTAwMCk7DQogICAgICAgIGVjaG8gIjxkaXYgY2xhc3M9XCJoaW50XCI+PHAgY2xhc3M9XCJoaW50IGhpbnRfJHNpZ25hbFwiIGRhdGEtZGVsYXk9XCIkZGVsYXlcIj4kY29udGVudDwvcD48L2Rpdj4iOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOaYvuekuumUmeivr+S/oeaBry4NCiAgICAgKg0KICAgICAqIEBhcGkgRmlsdGVyX1BsdWdpbl9aYnBfU2hvd0Vycm9yDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nL2ludCAkZXJyb3JUZXh0DQogICAgICogQHBhcmFtIG51bGwgICAgICAgJGZpbGUNCiAgICAgKiBAcGFyYW0gbnVsbCAgICAgICAkbGluZQ0KICAgICAqDQogICAgICogQHRocm93cyBFeGNlcHRpb24NCiAgICAgKg0KICAgICAqIEByZXR1cm4gbWl4ZWQNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gU2hvd0Vycm9yKCRlcnJvclRleHQsICRmaWxlID0gbnVsbCwgJGxpbmUgPSBudWxsLCAkbW9yZWluZm8gPSBhcnJheSgpKQ0KICAgIHsNCiAgICAgICAgJGVycm9yQ29kZSA9IDA7DQogICAgICAgIGlmIChpc19udW1lcmljKCRlcnJvclRleHQpKSB7DQogICAgICAgICAgICAkZXJyb3JDb2RlID0gKGludCkgJGVycm9yVGV4dDsNCiAgICAgICAgICAgICRlcnJvclRleHQgPSAkdGhpcy0+bGFuZ1snZXJyb3InXVskZXJyb3JUZXh0XTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmICgkZXJyb3JDb2RlID09IDIpIHsNCiAgICAgICAgICAgIEh0dHA0MDQoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIFpCbG9nRXhjZXB0aW9uOjokZXJyb3JfaWQgPSAkZXJyb3JDb2RlOw0KICAgICAgICBaQmxvZ0V4Y2VwdGlvbjo6JGVycm9yX2ZpbGUgPSAkZmlsZTsNCiAgICAgICAgWkJsb2dFeGNlcHRpb246OiRlcnJvcl9saW5lID0gJGxpbmU7DQogICAgICAgICRhcnJheSA9IFpCbG9nRXhjZXB0aW9uOjokZXJyb3JfZGVidWdpbmZvOw0KICAgICAgICBaQmxvZ0V4Y2VwdGlvbjo6JGVycm9yX2RlYnVnaW5mbyA9IGFycmF5X21lcmdlKCRhcnJheSwgJG1vcmVpbmZvKTsNCg0KICAgICAgICBpZiAoc3RyaXBvcygneycgLiBzaGExKCdtdXN0c2hvd2Vycm9yJykgLiAnfScsICRlcnJvclRleHQpID09PSAwKSB7DQogICAgICAgICAgICAkZXJyb3JUZXh0ID0gc3RyX3JlcGxhY2UoJ3snIC4gc2hhMSgnbXVzdHNob3dlcnJvcicpIC4gJ30nLCAnJywgJGVycm9yVGV4dCk7DQogICAgICAgICAgICAkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9EZWJ1Z19EaXNwbGF5J10gPSBhcnJheSgpOw0KICAgICAgICAgICAgJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fRGVidWdfSGFuZGxlciddID0gYXJyYXkoKTsNCg0KICAgICAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbigkZXJyb3JUZXh0KTsNCiAgICAgICAgfQ0KDQogICAgICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1picF9TaG93RXJyb3InXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgICAgICRmcHJldHVybiA9ICRmcG5hbWUoJGVycm9yQ29kZSwgJGVycm9yVGV4dCwgJGZpbGUsICRsaW5lLCAkbW9yZWluZm8pOw0KICAgICAgICAgICAgaWYgKCRmcHNpZ25hbCA9PSBQTFVHSU5fRVhJVFNJR05BTF9SRVRVUk4pIHsNCiAgICAgICAgICAgICAgICAkZnBzaWduYWwgPSBQTFVHSU5fRVhJVFNJR05BTF9OT05FOw0KDQogICAgICAgICAgICAgICAgcmV0dXJuICRmcHJldHVybjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oJGVycm9yVGV4dCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5qOA5rWL572R56uZ5YWz6Zet77yM5aaC5p6c5YWz6Zet77yM5YiZ5oqb5Ye66ZSZ6K+vLg0KICAgICAqDQogICAgICogQHRocm93cyBFeGNlcHRpb24NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQ2hlY2tTaXRlQ2xvc2VkKCkNCiAgICB7DQogICAgICAgIGlmICgkdGhpcy0+b3B0aW9uWydaQ19DTE9TRV9TSVRFJ10pIHsNCiAgICAgICAgICAgIEh0dHA1MDMoKTsNCiAgICAgICAgICAgICR0aGlzLT5TaG93RXJyb3IoODIsIF9fRklMRV9fLCBfX0xJTkVfXyk7DQogICAgICAgICAgICBleGl0Ow0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6Lez6L2s5Yiw5a6J6KOF6aG16Z2iLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBSZWRpcmVjdEluc3RhbGwoKQ0KICAgIHsNCiAgICAgICAgaWYgKCEkdGhpcy0+b3B0aW9uWydaQ19EQVRBQkFTRV9UWVBFJ10pIHsNCiAgICAgICAgICAgICRzID0gJF9TRVJWRVJbJ1FVRVJZX1NUUklORyddOw0KICAgICAgICAgICAgJHMgPSBlbXB0eSgkcykgPyAnJyA6ICc/JyAuICRzOw0KICAgICAgICAgICAgUmVkaXJlY3QoJy4vemJfaW5zdGFsbC9pbmRleC5waHAnIC4gJHMpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5rOo5YaMUG9zdFR5cGUuDQogICAgICoNCiAgICAgKiBAcGFyYW0gJHR5cGVJZA0KICAgICAqIEBwYXJhbSAkbmFtZQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHVybFJ1bGUgICAgICDpu5jorqTmmK9hcnJheSgpIOS4ulVybCBSdWxl57uE5ZCI55qE5pWw57uEDQogICAgICogQHBhcmFtIHN0cmluZyAkdGVtcGxhdGUgICAgIOm7mOiupOaooeadv+WQjeaYr2FycmF5KCkg5Li65LiA5Liq57uE5ZCI5pWw57uEDQogICAgICogQHBhcmFtIHN0cmluZyAkY2xhc3NOYW1lICAgIOm7mOiupOexu+WQjQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgJGFjdGlvbnMgICAgIOm7mOiupEFjdGlvbnMg5bqU5pivYXJyYXkoKQ0KICAgICAqDQogICAgICogQHRocm93cyBFeGNlcHRpb24NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gUmVnUG9zdFR5cGUoJHR5cGVJZCwgJG5hbWUsICR1cmxSdWxlID0gYXJyYXkoKSwgJHRlbXBsYXRlID0gYXJyYXkoKSwgJGNsYXNzTmFtZSA9ICdQb3N0JywgJGFjdGlvbnMgPSBhcnJheSgpLCAkcm91dGVzID0gYXJyYXkoKSkNCiAgICB7DQogICAgICAgIC8qIOi/meS4pOS4quWPguaVsOWcqDEuN+mHjOW3sue7j+W6n+W8gw0KICAgICAgICAqIEBwYXJhbSBzdHJpbmcgJGNhdGVnb3J5VHlwZSDlvZPliY3mlofnq6DnsbvnmoTliIbnsbtUeXBlIC8v5bey5bqf5byDDQogICAgICAgICogQHBhcmFtIHN0cmluZyAkdGFnVHlwZSAgICAgIOW9k+WJjeaWh+eroOexu+eahOagh+etvlR5cGUgLy/lt7Llup/lvIMNCiAgICAgICAgKi8NCiAgICAgICAgJHVycyA9IGFycmF5KCk7DQogICAgICAgICR1cnNbJ3NpbmdsZV91cmxydWxlJ10gPSAkdGhpcy0+b3B0aW9uWydaQ19QQUdFX1JFR0VYJ107DQogICAgICAgICR1cnNbJ2xpc3RfdXJscnVsZSddID0gJHRoaXMtPm9wdGlvblsnWkNfSU5ERVhfUkVHRVgnXTsNCiAgICAgICAgJHVyc1snbGlzdF9jYXRlZ29yeV91cmxydWxlJ10gPSAkdGhpcy0+b3B0aW9uWydaQ19DQVRFR09SWV9SRUdFWCddOw0KICAgICAgICAkdXJzWydsaXN0X2F1dGhvcl91cmxydWxlJ10gPSAkdGhpcy0+b3B0aW9uWydaQ19BVVRIT1JfUkVHRVgnXTsNCiAgICAgICAgJHVyc1snbGlzdF9kYXRlX3VybHJ1bGUnXSA9ICR0aGlzLT5vcHRpb25bJ1pDX0RBVEVfUkVHRVgnXTsNCiAgICAgICAgJHVyc1snbGlzdF90YWdfdXJscnVsZSddID0gJHRoaXMtPm9wdGlvblsnWkNfVEFHU19SRUdFWCddOw0KICAgICAgICAkdXJzWydzZWFyY2hfdXJscnVsZSddID0gJHRoaXMtPm9wdGlvblsnWkNfU0VBUkNIX1JFR0VYJ107DQogICAgICAgIGlmICghaXNfYXJyYXkoJHVybFJ1bGUpKSB7DQogICAgICAgICAgICBpZiAoJHVybFJ1bGUgIT0gJycpIHsNCiAgICAgICAgICAgICAgICAkdXJzWydzaW5nbGVfdXJscnVsZSddID0gJHVybFJ1bGU7DQogICAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkdXJzID0gYXJyYXlfbWVyZ2UoJHVycywgJHVybFJ1bGUpOw0KICAgICAgICB9DQoNCiAgICAgICAgJHR5cGVJZCA9IChpbnQpICR0eXBlSWQ7DQogICAgICAgICRuYW1lID0gc3RydG9sb3dlcih0cmltKCRuYW1lKSk7DQogICAgICAgIGlmICgkdHlwZUlkID4gOTkpIHsNCiAgICAgICAgICAgIGlmIChpc3NldCgkdGhpcy0+cG9zdHR5cGVbJHR5cGVJZF0pKSB7DQogICAgICAgICAgICAgICAgJHRoaXMtPlNob3dFcnJvcig4NywgX19GSUxFX18sIF9fTElORV9fKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICAkdHBzID0gYXJyYXkoKTsNCiAgICAgICAgJHRwc1sndGVtcGxhdGUnXSA9ICR0aGlzLT5vcHRpb25bJ1pDX1BPU1RfREVGQVVMVF9URU1QTEFURSddOw0KICAgICAgICAkdHBzWydsaXN0X3RlbXBsYXRlJ10gPSAkdGhpcy0+b3B0aW9uWydaQ19JTkRFWF9ERUZBVUxUX1RFTVBMQVRFJ107DQogICAgICAgICR0cHNbJ2NhdGVnb3J5X3RlbXBsYXRlJ10gPSAkdGhpcy0+b3B0aW9uWydaQ19JTkRFWF9ERUZBVUxUX1RFTVBMQVRFJ107DQogICAgICAgICR0cHNbJ3RhZ190ZW1wbGF0ZSddID0gJHRoaXMtPm9wdGlvblsnWkNfSU5ERVhfREVGQVVMVF9URU1QTEFURSddOw0KICAgICAgICAkdHBzWydhdXRob3JfdGVtcGxhdGUnXSA9ICR0aGlzLT5vcHRpb25bJ1pDX0lOREVYX0RFRkFVTFRfVEVNUExBVEUnXTsNCiAgICAgICAgJHRwc1snZGF0ZV90ZW1wbGF0ZSddID0gJHRoaXMtPm9wdGlvblsnWkNfSU5ERVhfREVGQVVMVF9URU1QTEFURSddOw0KICAgICAgICAkdHBzWydzZWFyY2hfdGVtcGxhdGUnXSA9ICR0aGlzLT5vcHRpb25bJ1pDX1NFQVJDSF9ERUZBVUxUX1RFTVBMQVRFJ107DQoNCiAgICAgICAgaWYgKCFpc19hcnJheSgkdGVtcGxhdGUpKSB7DQogICAgICAgICAgICBpZiAoJHRlbXBsYXRlICE9ICcnKSB7DQogICAgICAgICAgICAgICAgJHRwc1sndGVtcGxhdGUnXSA9ICR0ZW1wbGF0ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICR0cHMgPSBhcnJheV9tZXJnZSgkdHBzLCAkdGVtcGxhdGUpOw0KICAgICAgICB9DQoNCiAgICAgICAgJHRoaXMtPnBvc3R0eXBlWyR0eXBlSWRdID0gYXJyYXkoJ25hbWUnID0+ICRuYW1lLCAnY2xhc3NuYW1lJyA9PiAkY2xhc3NOYW1lKTsNCiAgICAgICAgJHRoaXMtPnBvc3R0eXBlWyR0eXBlSWRdID0gYXJyYXlfbWVyZ2UoJHRoaXMtPnBvc3R0eXBlWyR0eXBlSWRdLCAkdHBzLCAkdXJzKTsNCg0KICAgICAgICAkcG9zdF9hY3Rpb25zID0gYXJyYXkoJ25ldycgPT4gJ0FydGljbGVOZXcnLCAnZWRpdCcgPT4gJ0FydGljbGVFZHQnLCAnZGVsJyA9PiAnQXJ0aWNsZURlbCcsICdwb3N0JyA9PiAnQXJ0aWNsZVBzdCcsICdwdWJsaXNoJyA9PiAnQXJ0aWNsZVB1YicsICdtYW5hZ2UnID0+ICdBcnRpY2xlTW5nJywgJ2FsbCcgPT4gJ0FydGljbGVBbGwnLCAndmlldycgPT4gJ3ZpZXcnLCAnc2VhcmNoJyA9PiAnc2VhcmNoJyk7DQoNCiAgICAgICAgaWYgKGVtcHR5KCRhY3Rpb25zKSB8fCBpc19hcnJheSgkYWN0aW9ucykgPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICRhY3Rpb25zID0gJHBvc3RfYWN0aW9uczsNCiAgICAgICAgfQ0KDQogICAgICAgIGZvcmVhY2ggKCRwb3N0X2FjdGlvbnMgYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgICAgIGlmICghaXNzZXQoJGFjdGlvbnNbJGtleV0pKSB7DQogICAgICAgICAgICAgICAgJGFjdGlvbnNbJGtleV0gPSAkdmFsdWU7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgJHRoaXMtPnBvc3R0eXBlWyR0eXBlSWRdWydhY3Rpb25zJ10gPSAkYWN0aW9uczsNCg0KICAgICAgICBpZiAoIWlzc2V0KCR0aGlzLT50YWdzX3R5cGVbJHR5cGVJZF0pKSB7DQogICAgICAgICAgICAkdGhpcy0+dGFnc190eXBlWyR0eXBlSWRdID0gYXJyYXkoKTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoIWlzc2V0KCR0aGlzLT50YWdzYnluYW1lX3R5cGVbJHR5cGVJZF0pKSB7DQogICAgICAgICAgICAkdGhpcy0+dGFnc2J5bmFtZV90eXBlWyR0eXBlSWRdID0gYXJyYXkoKTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoIWlzc2V0KCR0aGlzLT5jYXRlZ29yaWVzYnlvcmRlcl90eXBlWyR0eXBlSWRdKSkgew0KICAgICAgICAgICAgJHRoaXMtPmNhdGVnb3JpZXNieW9yZGVyX3R5cGVbJHR5cGVJZF0gPSBhcnJheSgpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6K6+572uUG9zdFR5cGUuDQogICAgICoNCiAgICAgKiBAcGFyYW0gJHR5cGVJZA0KICAgICAqIEBwYXJhbSAkbmFtZQ0KICAgICAqIEBwYXJhbSAkdmFsdWUNCiAgICAgKg0KICAgICAqIEB0aHJvd3MgRXhjZXB0aW9uDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFNldFBvc3RUeXBlKCR0eXBlaWQsICRuYW1lLCAkdmFsdWUpDQogICAgew0KICAgICAgICAkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJG5hbWVdID0gJHZhbHVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOiOt+WPllBvc3RUeXBl5L+h5oGvKOWmguaenOaYr+S/ruaUueeahOivneivt+ebtOaOpee8lui+kSR6YnAtPnBvc3R0eXBlKQ0KICAgICAqDQogICAgICogQHBhcmFtICRrZXkNCiAgICAgKg0KICAgICAqIEBwYXJhbSAkdHlwZWlkDQogICAgICoNCiAgICAgKiBAcmV0dXJuIHN0cmluZw0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRQb3N0VHlwZSgkdHlwZWlkLCAka2V5KQ0KICAgIHsNCiAgICAgICAgaWYgKCRrZXkgPT0gbnVsbCB8fCBlbXB0eSgka2V5KSkgew0KICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoJ25hbWUnID09ICRrZXkpIHsNCiAgICAgICAgICAgIGlmIChpc3NldCgkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJ25hbWUnXSkpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gc3RydG9sb3dlcigkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJ25hbWUnXSk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiAnJzsNCiAgICAgICAgfSBlbHNlaWYgKCdzaW5nbGVfdXJscnVsZScgPT0gJGtleSkgew0KICAgICAgICAgICAgaWYgKGlzc2V0KCR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVsnc2luZ2xlX3VybHJ1bGUnXSkpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWydzaW5nbGVfdXJscnVsZSddOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gJHRoaXMtPm9wdGlvblsnWkNfUEFHRV9SRUdFWCddOw0KICAgICAgICB9IGVsc2VpZiAoJ2xpc3RfdXJscnVsZScgPT0gJGtleSkgew0KICAgICAgICAgICAgaWYgKGlzc2V0KCR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVsnbGlzdF91cmxydWxlJ10pKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVsnbGlzdF91cmxydWxlJ107DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+b3B0aW9uWydaQ19JTkRFWF9SRUdFWCddOw0KICAgICAgICB9IGVsc2VpZiAoJ2xpc3RfY2F0ZWdvcnlfdXJscnVsZScgPT0gJGtleSkgew0KICAgICAgICAgICAgaWYgKGlzc2V0KCR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVsnbGlzdF9jYXRlZ29yeV91cmxydWxlJ10pKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVsnbGlzdF9jYXRlZ29yeV91cmxydWxlJ107DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+b3B0aW9uWydaQ19DQVRFR09SWV9SRUdFWCddOw0KICAgICAgICB9IGVsc2VpZiAoJ2xpc3RfYXV0aG9yX3VybHJ1bGUnID09ICRrZXkpIHsNCiAgICAgICAgICAgIGlmIChpc3NldCgkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJ2xpc3RfYXV0aG9yX3VybHJ1bGUnXSkpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWydsaXN0X2F1dGhvcl91cmxydWxlJ107DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+b3B0aW9uWydaQ19BVVRIT1JfUkVHRVgnXTsNCiAgICAgICAgfSBlbHNlaWYgKCdsaXN0X2RhdGVfdXJscnVsZScgPT0gJGtleSkgew0KICAgICAgICAgICAgaWYgKGlzc2V0KCR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVsnbGlzdF9kYXRlX3VybHJ1bGUnXSkpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWydsaXN0X2RhdGVfdXJscnVsZSddOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gJHRoaXMtPm9wdGlvblsnWkNfREFURV9SRUdFWCddOw0KICAgICAgICB9IGVsc2VpZiAoJ2xpc3RfdGFnX3VybHJ1bGUnID09ICRrZXkpIHsNCiAgICAgICAgICAgIGlmIChpc3NldCgkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJ2xpc3RfdGFnX3VybHJ1bGUnXSkpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWydsaXN0X3RhZ191cmxydWxlJ107DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+b3B0aW9uWydaQ19UQUdTX1JFR0VYJ107DQogICAgICAgIH0gZWxzZWlmICgnc2VhcmNoX3VybHJ1bGUnID09ICRrZXkpIHsNCiAgICAgICAgICAgIGlmIChpc3NldCgkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJ3NlYXJjaF91cmxydWxlJ10pKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVsnc2VhcmNoX3VybHJ1bGUnXTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5vcHRpb25bJ1pDX1NFQVJDSF9SRUdFWCddOw0KICAgICAgICB9IGVsc2VpZiAoJ3RlbXBsYXRlJyA9PSAka2V5KSB7DQogICAgICAgICAgICBpZiAoaXNzZXQoJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWyd0ZW1wbGF0ZSddKSAmJiAhZW1wdHkoJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWyd0ZW1wbGF0ZSddKSkgew0KICAgICAgICAgICAgICAgIHJldHVybiAkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJ3RlbXBsYXRlJ107DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+b3B0aW9uWydaQ19QT1NUX0RFRkFVTFRfVEVNUExBVEUnXTsNCiAgICAgICAgfSBlbHNlaWYgKCdsaXN0X3RlbXBsYXRlJyA9PSAka2V5KSB7DQogICAgICAgICAgICBpZiAoaXNzZXQoJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWydsaXN0X3RlbXBsYXRlJ10pICYmICFlbXB0eSgkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJ2xpc3RfdGVtcGxhdGUnXSkpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWydsaXN0X3RlbXBsYXRlJ107DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+b3B0aW9uWydaQ19JTkRFWF9ERUZBVUxUX1RFTVBMQVRFJ107DQogICAgICAgIH0gZWxzZWlmICgnY2F0ZWdvcnlfdGVtcGxhdGUnID09ICRrZXkpIHsNCiAgICAgICAgICAgIGlmIChpc3NldCgkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJ2NhdGVnb3J5X3RlbXBsYXRlJ10pICYmICFlbXB0eSgkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJ2NhdGVnb3J5X3RlbXBsYXRlJ10pKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVsnY2F0ZWdvcnlfdGVtcGxhdGUnXTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5vcHRpb25bJ1pDX0lOREVYX0RFRkFVTFRfVEVNUExBVEUnXTsNCiAgICAgICAgfSBlbHNlaWYgKCd0YWdfdGVtcGxhdGUnID09ICRrZXkpIHsNCiAgICAgICAgICAgIGlmIChpc3NldCgkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJ3RhZ190ZW1wbGF0ZSddKSAmJiAhZW1wdHkoJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWyd0YWdfdGVtcGxhdGUnXSkpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWyd0YWdfdGVtcGxhdGUnXTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5vcHRpb25bJ1pDX0lOREVYX0RFRkFVTFRfVEVNUExBVEUnXTsNCiAgICAgICAgfSBlbHNlaWYgKCdhdXRob3JfdGVtcGxhdGUnID09ICRrZXkpIHsNCiAgICAgICAgICAgIGlmIChpc3NldCgkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJ2F1dGhvcl90ZW1wbGF0ZSddKSAmJiAhZW1wdHkoJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWydhdXRob3JfdGVtcGxhdGUnXSkpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWydhdXRob3JfdGVtcGxhdGUnXTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5vcHRpb25bJ1pDX0lOREVYX0RFRkFVTFRfVEVNUExBVEUnXTsNCiAgICAgICAgfSBlbHNlaWYgKCdkYXRlX3RlbXBsYXRlJyA9PSAka2V5KSB7DQogICAgICAgICAgICBpZiAoaXNzZXQoJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWydkYXRlX3RlbXBsYXRlJ10pICYmICFlbXB0eSgkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJ2RhdGVfdGVtcGxhdGUnXSkpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWydkYXRlX3RlbXBsYXRlJ107DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+b3B0aW9uWydaQ19JTkRFWF9ERUZBVUxUX1RFTVBMQVRFJ107DQogICAgICAgIH0gZWxzZWlmICgnc2VhcmNoX3RlbXBsYXRlJyA9PSAka2V5KSB7DQogICAgICAgICAgICBpZiAoaXNzZXQoJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWydzZWFyY2hfdGVtcGxhdGUnXSkgJiYgIWVtcHR5KCR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVsnc2VhcmNoX3RlbXBsYXRlJ10pKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVsnc2VhcmNoX3RlbXBsYXRlJ107DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+b3B0aW9uWydaQ19TRUFSQ0hfREVGQVVMVF9URU1QTEFURSddOw0KICAgICAgICB9IGVsc2VpZiAoJ2NsYXNzbmFtZScgPT0gJGtleSkgew0KICAgICAgICAgICAgaWYgKGlzc2V0KCR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVsnY2xhc3NuYW1lJ10pICYmICFlbXB0eSgkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJ2NsYXNzbmFtZSddKSkgew0KICAgICAgICAgICAgICAgIHJldHVybiAkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJ2NsYXNzbmFtZSddOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gJ1Bvc3QnOw0KICAgICAgICB9IGVsc2VpZiAoJ2FjdGlvbnMnID09ICRrZXkpIHsNCiAgICAgICAgICAgICRhY3Rpb25zID0gYXJyYXkoKTsNCiAgICAgICAgICAgIGlmIChpc3NldCgkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJ2FjdGlvbnMnXSkpIHsNCiAgICAgICAgICAgICAgICAkYWN0aW9ucyA9ICR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVsnYWN0aW9ucyddOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgJHBvc3RfYWN0aW9ucyA9ICR0aGlzLT5wb3N0dHlwZVswXVsnYWN0aW9ucyddOw0KICAgICAgICAgICAgaWYgKGlzX2FycmF5KCRhY3Rpb25zKSAmJiBlbXB0eSgkYWN0aW9ucykgPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICAgICBmb3JlYWNoICgkcG9zdF9hY3Rpb25zIGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICghaXNzZXQoJGFjdGlvbnNbJGtleV0pKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAkYWN0aW9uc1ska2V5XSA9ICR2YWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICByZXR1cm4gJGFjdGlvbnM7DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gJHBvc3RfYWN0aW9uczsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGlmIChpc3NldCgkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bJGtleV0pKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVska2V5XTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOiuvue9rlBvc3RUeXBl5LiLQXJyYXnpobnnm67kv6Hmga8NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gU2V0UG9zdFR5cGVfU3ViKCR0eXBlaWQsICRuYW1lLCAkc3VibmFtZSwgJHZhbHVlKQ0KICAgIHsNCiAgICAgICAgJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWyRuYW1lXVskc3VibmFtZV0gPSAkdmFsdWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6I635Y+WUG9zdFR5cGXkuItBcnJheemhueebruS/oeaBrw0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRQb3N0VHlwZV9TdWIoJHR5cGVpZCwgJG5hbWUsICRzdWJuYW1lKQ0KICAgIHsNCiAgICAgICAgaWYgKGlzc2V0KCR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVskbmFtZV1bJHN1Ym5hbWVdKSkgew0KICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVskbmFtZV1bJHN1Ym5hbWVdOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiBudWxsOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBwYXJhbSAkdHlwZWlkDQogICAgICoNCiAgICAgKiBAcmV0dXJuIHN0cmluZw0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRQb3N0VHlwZV9OYW1lKCR0eXBlaWQpDQogICAgew0KICAgICAgICBpZiAoaXNzZXQoJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdKSkgew0KICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVsnbmFtZSddOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICcnOw0KICAgIH0NCg0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRQb3N0VHlwZV9VcmxSdWxlKCR0eXBlaWQpDQogICAgew0KICAgICAgICBpZiAoaXNzZXQoJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdKSkgew0KICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVsnc2luZ2xlX3VybHJ1bGUnXTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAkdGhpcy0+b3B0aW9uWydaQ19QQUdFX1JFR0VYJ107DQogICAgfQ0KDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFBvc3RUeXBlX1RlbXBsYXRlKCR0eXBlaWQpDQogICAgew0KICAgICAgICBpZiAoaXNzZXQoJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdKSkgew0KICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXVsndGVtcGxhdGUnXTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAkdGhpcy0+b3B0aW9uWydaQ19QT1NUX0RFRkFVTFRfVEVNUExBVEUnXTsNCiAgICB9DQoNCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0UG9zdFR5cGVfQ2F0ZWdvcnlUeXBlKCR0eXBlaWQpDQogICAgew0KICAgICAgICBpZiAoaXNzZXQoJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdKSkgew0KICAgICAgICAgICAgcmV0dXJuICR0eXBlaWQ7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0UG9zdFR5cGVfVGFnVHlwZSgkdHlwZWlkKQ0KICAgIHsNCiAgICAgICAgaWYgKGlzc2V0KCR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXSkpIHsNCiAgICAgICAgICAgIHJldHVybiAkdHlwZWlkOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5rOo5YaMQWN0aW9uLg0KICAgICAqDQogICAgICogQHBhcmFtICRuYW1lDQogICAgICogQHBhcmFtICRsZXZlbA0KICAgICAqIEBwYXJhbSAkdGl0bGUNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gUmVnQWN0aW9uKCRuYW1lLCAkbGV2ZWwsICR0aXRsZSkNCiAgICB7DQogICAgICAgICR0aGlzLT5hY3Rpb25zWyRuYW1lXSA9ICRsZXZlbDsNCiAgICAgICAgJHRoaXMtPmxhbmdbJ2FjdGlvbnMnXVskbmFtZV0gPSAkdGl0bGU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6I635b6XQWN0aW9u5p2D6ZmQ5rOo6YeKLg0KICAgICAqDQogICAgICogQHBhcmFtICRuYW1lDQogICAgICoNCiAgICAgKiBAcmV0dXJuIG1peGVkDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldEFjdGlvbkRlc2NyaXB0aW9uKCRuYW1lKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuIEdldFZhbHVlSW5BcnJheSgkdGhpcy0+bGFuZ1snYWN0aW9ucyddLCAkbmFtZSwgJG5hbWUpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOazqOWGjOi3r+eUseWHveaVsA0KICAgICAqDQogICAgICogQHBhcmFtICRhcnJheSDmlbDmja7mlbDnu4Qo6K+m57uG57uT5p6E5Zyo5Yid5aeL5YyW5Lit5pyJ6K+05piOKQ0KICAgICAqIEBwYXJhbSAkcHJlcGVuZCDms6jlhozot6/nlLHml7bmj5LpmJ/lnKjliY3ovrkNCiAgICAgKg0KICAgICAqIEByZXR1cm4gbWl4ZWQNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gUmVnUm91dGUoJGFycmF5LCAkcHJlcGVuZCA9IGZhbHNlKQ0KICAgIHsNCiAgICAgICAgJHJvdXRlcyA9ICYkdGhpcy0+cm91dGVzOw0KICAgICAgICAkbmV3X25hbWUgPSAkYXJyYXlbJ3R5cGUnXSAuICdfJyAuICRhcnJheVsnbmFtZSddOw0KICAgICAgICBpZiAoJHByZXBlbmQgPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICRyb3V0ZXNbJG5ld19uYW1lXSA9ICRhcnJheTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHVuc2V0KCRyb3V0ZXNbJG5ld19uYW1lXSk7DQogICAgICAgICAgICAkbmV3X2FycmF5ID0gYXJyYXkoJG5ld19uYW1lID0+ICRhcnJheSk7DQogICAgICAgICAgICAkcm91dGVzID0gYXJyYXlfbWVyZ2UoJG5ld19hcnJheSwgJHJvdXRlcyk7DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6I635Y+W6Lev55Sx5Ye95pWwDQogICAgICoNCiAgICAgKiBAcGFyYW0gJHR5cGUg6Lev55Sx57G75Z6LDQogICAgICogQHBhcmFtICRuYW1lIOWQjeensA0KICAgICAqDQogICAgICogQHJldHVybiBtaXhlZA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRSb3V0ZSgkdHlwZSwgJG5hbWUgPSBudWxsKQ0KICAgIHsNCiAgICAgICAgJHJvdXRlcyA9ICYkdGhpcy0+cm91dGVzOw0KICAgICAgICBpZiAoaXNfYXJyYXkoJHR5cGUpKSB7DQogICAgICAgICAgICAkbmFtZSA9IGN1cnJlbnQoJHR5cGUpOw0KICAgICAgICAgICAgJHR5cGUgPSBrZXkoJHR5cGUpOw0KICAgICAgICB9DQogICAgICAgIGlmIChpc3NldCgkcm91dGVzWyR0eXBlIC4gJ18nIC4gJG5hbWVdKSkgew0KICAgICAgICAgICAgcmV0dXJuICRyb3V0ZXNbJHR5cGUgLiAnXycgLiAkbmFtZV07DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDliKDpmaTot6/nlLHlh73mlbANCiAgICAgKg0KICAgICAqIEBwYXJhbSAkdHlwZSDot6/nlLHnsbvlnosNCiAgICAgKiBAcGFyYW0gJG5hbWUg5ZCN56ewDQogICAgICoNCiAgICAgKiBAcmV0dXJuIG1peGVkDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFJlbW92ZVJvdXRlKCR0eXBlLCAkbmFtZSkNCiAgICB7DQogICAgICAgICRyb3V0ZXMgPSAmJHRoaXMtPnJvdXRlczsNCiAgICAgICAgdW5zZXQoJHJvdXRlc1skdHlwZSAuICdfJyAuICRuYW1lXSk7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8v5Li+5L6L77yaYmFja2VuZC11aSwsLA0KICAgIHByb3RlY3RlZCAkcHJvdGVjdF9leGNsdXNpdmUgPSBhcnJheSgpOw0KDQogICAgLyoqDQogICAgICog6YCa55+l57O757uf5o6n5Yi25p2DLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBTZXRFeGNsdXNpdmUoJGZ1bmN0aW9uLCAkYXBwaWQpDQogICAgew0KICAgICAgICBpZiAoJGFwcGlkID09IGZhbHNlKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCiAgICAgICAgJHRoaXMtPnByb3RlY3RfZXhjbHVzaXZlWyRmdW5jdGlvbl0gPSAkYXBwaWQ7DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5p+l6K+i57O757uf5o6n5Yi25p2DLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBJc0V4Y2x1c2l2ZSgkZnVuY3Rpb24pDQogICAgew0KICAgICAgICBpZiAoaXNzZXQoJHRoaXMtPnByb3RlY3RfZXhjbHVzaXZlWyRmdW5jdGlvbl0pKSB7DQogICAgICAgICAgICByZXR1cm4gJHRoaXMtPnByb3RlY3RfZXhjbHVzaXZlWyRmdW5jdGlvbl07DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog57uR5a6aemJw5LmL5YmN54us56uL55qE5p2C5Lmx55qE5YWo5bGA5a+56LGh5pWw57uE5Yiw5oC757yT5a2Y5a+56LGh5LiKLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBCaW5kaW5nQ2FjaGUoKQ0KICAgIHsNCiAgICAgICAgJGNhY2hlb2JqZWN0ID0gJiR0aGlzLT5jYWNoZW9iamVjdDsNCiAgICAgICAgJGNhY2hlb2JqZWN0WydNZW1iZXInXSA9ICYkdGhpcy0+bWVtYmVyczsNCiAgICAgICAgJGNhY2hlb2JqZWN0WydDYXRlZ29yeSddID0gJiR0aGlzLT5jYXRlZ29yaWVzX2FsbDsNCiAgICAgICAgJGNhY2hlb2JqZWN0WydUYWcnXSA9ICYkdGhpcy0+dGFnc19hbGw7DQogICAgICAgICRjYWNoZW9iamVjdFsnTW9kdWxlJ10gPSAmJHRoaXMtPm1vZHVsZXM7DQogICAgICAgICRjYWNoZW9iamVjdFsnQ29tbWVudCddID0gJiR0aGlzLT5jb21tZW50czsNCiAgICAgICAgJGNhY2hlb2JqZWN0WydQb3N0J10gPSAmJHRoaXMtPnBvc3RzOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWwhuWvueixoemZhOWKoOWIsOaAu+e8k+WtmOWvueixoeS4ii4NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQWRkQ2FjaGUoJiRvYmplY3QpDQogICAgew0KICAgICAgICBpZiAoaXNfc3ViY2xhc3Nfb2YoJG9iamVjdCwgJ0Jhc2UnKSA9PSBmYWxzZSAmJiBnZXRfY2xhc3MoJG9iamVjdCkgIT0gJ0Jhc2UnKSB7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCiAgICAgICAgJGNhY2hlb2JqZWN0ID0gJiR0aGlzLT5jYWNoZW9iamVjdDsNCiAgICAgICAgaWYgKCFpc3NldCgkY2FjaGVvYmplY3RbZ2V0X2NsYXNzKCRvYmplY3QpXSkpIHsNCiAgICAgICAgICAgICRjYWNoZW9iamVjdFtnZXRfY2xhc3MoJG9iamVjdCldID0gYXJyYXkoKTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoZW1wdHkoJG9iamVjdC0+SUQpKSB7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCg0KICAgICAgICAkY2FjaGVvYmplY3RbZ2V0X2NsYXNzKCRvYmplY3QpXVskb2JqZWN0LT5JRF0gPSAkb2JqZWN0Ow0KDQogICAgICAgIHN3aXRjaCAoZ2V0X2NsYXNzKCRvYmplY3QpKSB7DQogICAgICAgICAgICBjYXNlICdNb2R1bGUnOg0KICAgICAgICAgICAgICAgICR0aGlzLT5tb2R1bGVzYnlmaWxlbmFtZVskb2JqZWN0LT5GaWxlTmFtZV0gPSAmJGNhY2hlb2JqZWN0W2dldF9jbGFzcygkb2JqZWN0KV1bJG9iamVjdC0+SURdOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnVGFnJzoNCiAgICAgICAgICAgICAgICAvL2lzc2V0KCR0aGlzLT50YWdzX3R5cGVbJG9iamVjdC0+VHlwZV0pIHx8ICR0aGlzLT50YWdzX3R5cGVbJG9iamVjdC0+VHlwZV0gPSBhcnJheSgpOw0KICAgICAgICAgICAgICAgICR0aGlzLT50YWdzX3R5cGVbJG9iamVjdC0+VHlwZV1bJG9iamVjdC0+SURdID0gJiRjYWNoZW9iamVjdFtnZXRfY2xhc3MoJG9iamVjdCldWyRvYmplY3QtPklEXTsNCiAgICAgICAgICAgICAgICAvL2lzc2V0KCR0aGlzLT50YWdzYnluYW1lX3R5cGVbJG9iamVjdC0+VHlwZV0pIHx8ICR0aGlzLT50YWdzYnluYW1lX3R5cGVbJG9iamVjdC0+VHlwZV0gPSBhcnJheSgpOw0KICAgICAgICAgICAgICAgICR0aGlzLT50YWdzYnluYW1lX3R5cGVbJG9iamVjdC0+VHlwZV1bJG9iamVjdC0+TmFtZV0gPSAmJGNhY2hlb2JqZWN0W2dldF9jbGFzcygkb2JqZWN0KV1bJG9iamVjdC0+SURdOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnQ2F0ZWdvcnknOg0KICAgICAgICAgICAgICAgIC8vaXNzZXQoJHRoaXMtPmNhdGVnb3JpZXNfdHlwZVskb2JqZWN0LT5UeXBlXSkgfHwgJHRoaXMtPmNhdGVnb3JpZXNfdHlwZVskb2JqZWN0LT5UeXBlXSA9IGFycmF5KCk7DQogICAgICAgICAgICAgICAgJHRoaXMtPmNhdGVnb3JpZXNfdHlwZVskb2JqZWN0LT5UeXBlXVskb2JqZWN0LT5JRF0gPSAmJGNhY2hlb2JqZWN0W2dldF9jbGFzcygkb2JqZWN0KV1bJG9iamVjdC0+SURdOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnTWVtYmVyJzoNCiAgICAgICAgICAgICAgICAkdGhpcy0+bWVtYmVyc2J5bmFtZVskb2JqZWN0LT5OYW1lXSA9ICYkY2FjaGVvYmplY3RbZ2V0X2NsYXNzKCRvYmplY3QpXVskb2JqZWN0LT5JRF07DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5bCG5a+56LGh6ZmE5LuO5oC757yT5a2Y5a+56LGh5LiK5Yig6Zmk5o6JLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBSZW1vdmVDYWNoZSgmJG9iamVjdCkNCiAgICB7DQogICAgICAgIGlmIChpc19zdWJjbGFzc19vZigkb2JqZWN0LCAnQmFzZScpID09IGZhbHNlICYmIGdldF9jbGFzcygkb2JqZWN0KSAhPSAnQmFzZScpIHsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KICAgICAgICAkY2FjaGVvYmplY3QgPSAmJHRoaXMtPmNhY2hlb2JqZWN0Ow0KICAgICAgICBpZiAoIWlzc2V0KCRjYWNoZW9iamVjdFtnZXRfY2xhc3MoJG9iamVjdCldKSkgew0KICAgICAgICAgICAgJGNhY2hlb2JqZWN0W2dldF9jbGFzcygkb2JqZWN0KV0gPSBhcnJheSgpOw0KICAgICAgICB9DQogICAgICAgIGlmIChlbXB0eSgkb2JqZWN0LT5JRCkpIHsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KDQogICAgICAgIHN3aXRjaCAoZ2V0X2NsYXNzKCRvYmplY3QpKSB7DQogICAgICAgICAgICBjYXNlICdNb2R1bGUnOg0KICAgICAgICAgICAgICAgIHVuc2V0KCR0aGlzLT5tb2R1bGVzYnlmaWxlbmFtZVskb2JqZWN0LT5GaWxlTmFtZV0pOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnTWVtYmVyJzoNCiAgICAgICAgICAgICAgICB1bnNldCgkdGhpcy0+bWVtYmVyc2J5bmFtZVskb2JqZWN0LT5OYW1lXSk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdUYWcnOg0KICAgICAgICAgICAgICAgIHVuc2V0KCR0aGlzLT50YWdzX3R5cGVbJG9iamVjdC0+VHlwZV1bJG9iamVjdC0+SURdKTsNCiAgICAgICAgICAgICAgICB1bnNldCgkdGhpcy0+dGFnc2J5bmFtZV90eXBlWyRvYmplY3QtPlR5cGVdWyRvYmplY3QtPk5hbWVdKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ0NhdGVnb3J5JzoNCiAgICAgICAgICAgICAgICB1bnNldCgkdGhpcy0+Y2F0ZWdvcmllc190eXBlWyRvYmplY3QtPlR5cGVdWyRvYmplY3QtPklEXSk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIH0NCiAgICAgICAgdW5zZXQoJGNhY2hlb2JqZWN0W2dldF9jbGFzcygkb2JqZWN0KV1bJG9iamVjdC0+SURdKTsNCg0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDlsIZQb3N057G75a+56LGh6ZmE5Yqg5YiwUG9zdOe8k+WtmOWvueixoeS4ii4NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQWRkUG9zdENhY2hlKCYkb2JqZWN0KQ0KICAgIHsNCiAgICAgICAgaWYgKGlzX3N1YmNsYXNzX29mKCRvYmplY3QsICdCYXNlUG9zdCcpID09IGZhbHNlKSB7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCiAgICAgICAgJGNhY2hlb2JqZWN0ID0gJiR0aGlzLT5jYWNoZW9iamVjdDsNCiAgICAgICAgJGNhY2hlb2JqZWN0WydQb3N0J11bJG9iamVjdC0+SURdID0gJG9iamVjdDsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDlsIZQb3N057G75a+56LGh6ZmE5LuOUG9zdOe8k+WtmOWvueixoeS4iuWIoOmZpOaOiS4NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gUmVtb3ZlUG9zdENhY2hlKCYkb2JqZWN0KQ0KICAgIHsNCiAgICAgICAgaWYgKGlzX3N1YmNsYXNzX29mKCRvYmplY3QsICdCYXNlUG9zdCcpID09IGZhbHNlKSB7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCiAgICAgICAgJGNhY2hlb2JqZWN0ID0gJiR0aGlzLT5jYWNoZW9iamVjdDsNCiAgICAgICAgdW5zZXQoJGNhY2hlb2JqZWN0WydQb3N0J11bJG9iamVjdC0+SURdKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmn6Xor6Llr7nosaHnmoRJROeahOWAvOaYr+WQpuWtmOWcqOS6juaAu+e8k+WtmOWvueixoeS4ii4NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQ2hlY2tDYWNoZSgkY2xhc3NuYW1lLCAkaWR2YWx1ZSkNCiAgICB7DQogICAgICAgICRjYWNoZW9iamVjdCA9ICYkdGhpcy0+Y2FjaGVvYmplY3Q7DQogICAgICAgIGlmICghaXNzZXQoJGNhY2hlb2JqZWN0WyRjbGFzc25hbWVdKSkgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIGFycmF5X2tleV9leGlzdHMoJGlkdmFsdWUsICRjYWNoZW9iamVjdFskY2xhc3NuYW1lXSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5Lul5LiL6YOo5YiG5Li65bey5bqf5byD77yM5L2G6ICD6JmR5Yiw5YW85a655oCn5L+d55WZ55qE5Luj56CBKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiouDQogICAgICovDQoNCiAgICAvKioNCiAgICAgKiDmo4DmtYvlvZPliY11cmzvvIzlpoLmnpzkuI3nrKblkIjorr7nva7lsLHot7PovazliLDlm7rlrprln5/lkI3nmoTpk77mjqUuDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFJlZGlyZWN0UGVybWFuZW50RG9tYWluKCkNCiAgICB7DQogICAgICAgICRkb21haW5fZGlzYWJsZSA9IEdldFZhbHVlSW5BcnJheSgkdGhpcy0+b3B0aW9uLCAnWkNfUEVSTUFORU5UX0RPTUFJTl9XSE9MRV9ESVNBQkxFJyk7DQogICAgICAgIGlmICgkZG9tYWluX2Rpc2FibGUgPT0gdHJ1ZSkgew0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQoNCiAgICAgICAgJGZvcmNlZCA9IEdldFZhbHVlSW5BcnJheSgkdGhpcy0+b3B0aW9uLCAnWkNfUEVSTUFORU5UX0RPTUFJTl9GT1JDRURfVVJMJyk7DQogICAgICAgIGlmICgkdGhpcy0+b3B0aW9uWydaQ19QRVJNQU5FTlRfRE9NQUlOX0VOQUJMRSddID09IGZhbHNlICYmICRmb3JjZWQgPT0gJycpIHsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KDQogICAgICAgICRob3N0ID0gc3RyX3JlcGxhY2UoYXJyYXkoJ2h0dHBzOi8vJywgJ2h0dHA6Ly8nKSwgYXJyYXkoJycsICcnKSwgR2V0Q3VycmVudEhvc3QoWkJQX1BBVEgsICRudWxsKSk7DQogICAgICAgICRob3N0MiA9IHN0cl9yZXBsYWNlKGFycmF5KCdodHRwczovLycsICdodHRwOi8vJyksIGFycmF5KCcnLCAnJyksICR0aGlzLT5ob3N0KTsNCg0KICAgICAgICBpZiAoJGhvc3QgIT0gJGhvc3QyKSB7DQogICAgICAgICAgICAkdSA9IEdldFJlcXVlc3RVcmkoKTsNCiAgICAgICAgICAgICR1ID0gJHRoaXMtPmhvc3QgLiBzdWJzdHIoJHUsIDEpOw0KICAgICAgICAgICAgUmVkaXJlY3QzMDEoJHUpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5qOA5p+l5bm25byA5ZCvR3ppcOWOi+e8qS4NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQ2hlY2tHemlwKCkNCiAgICB7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5ZCv55SoR3ppcC4NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gU3RhcnRHemlwKCkNCiAgICB7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6aqM6K+B55So5oi355m75b2V77yITUQ15YqgemJwLT5ndWlk55uQ5ZCO55qE5a+G56CB77yJLg0KICAgICAqDQogICAgICogQGRlcHJlY2F0ZWQNCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUgICAgICAgICDnlKjmiLflkI0NCiAgICAgKiBAcGFyYW0gc3RyaW5nICRwc19wYXRoX2hhc2ggTUQ15YqgemJwLT5ndWlk55uQ5ZCO55qE5a+G56CBDQogICAgICogQHBhcmFtIG9iamVjdCAkbWVtYmVyICAgICAgIOi/lOWbnuivu+WPluaIkOWKn+eahG1lbWJlcuWvueixoQ0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFZlcmlmeV9NRDVQYXRoKCRuYW1lLCAkcHNfcGF0aF9oYXNoLCAmJG1lbWJlciA9IG51bGwpDQogICAgew0KICAgICAgICBpZiAoJG5hbWUgPT0gJycgfHwgJHBzX3BhdGhfaGFzaCA9PSAnJykgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQogICAgICAgICRtID0gJHRoaXMtPkdldE1lbWJlckJ5TmFtZSgkbmFtZSk7DQogICAgICAgIGlmICgkbS0+SUQgIT0gbnVsbCkgew0KICAgICAgICAgICAgaWYgKCRtLT5QYXNzV29yZF9NRDVQYXRoID09ICRwc19wYXRoX2hhc2gpIHsNCiAgICAgICAgICAgICAgICAkbWVtYmVyID0gJG07DQoNCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDojrflj5ZDU1JGIFRva2Vu55qE6ZSZ6K+v5Yir5ZCNLg0KICAgICAqDQogICAgICogQGRlcHJlY2F0ZWQgVXNlIGBgR2V0Q1NSRlRva2VuYGANCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJGlkIOW6lOeUqElE77yM5Y+v5Lul5L+d6K+B5q+P5Liq5bqU55So6I635Y+W5LiN5ZCM55qEVG9rZW4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gc3RyaW5nDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFRva2VuKCRpZCA9ICcnKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuICR0aGlzLT5HZXRDU1JGVG9rZW4oJGlkKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpqozor4FDU1JGIFRva2Vu55qE6ZSZ6K+v5Yir5ZCNLg0KICAgICAqDQogICAgICogQGRlcHJlY2F0ZWQgVXNlIGBgVmVyaWZ5Q1NSRlRva2VuYGANCiAgICAgKg0KICAgICAqIEBwYXJhbSAkdA0KICAgICAqIEBwYXJhbSAkaWQNCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBWYWxpZFRva2VuKCR0LCAkaWQgPSAnJykNCiAgICB7DQogICAgICAgIHJldHVybiAkdGhpcy0+VmVyaWZ5Q1NSRlRva2VuKCR0LCAkaWQpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBkZXByZWNhdGVkDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gTG9hZENhdGVnb3J5cygpDQogICAgew0KICAgICAgICByZXR1cm4gJHRoaXMtPkxvYWRDYXRlZ29yaWVzKCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6I635Y+W5Lya6K+dV2ViVG9rZW4uDQogICAgICoNCiAgICAgKiBAZGVwcmVjYXRlZCDmr6vml6DmhI/kuYnvvIzljbPlsIblup/lvIMNCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHd0X2lkDQogICAgICogQHBhcmFtIGludCAgICAkZGF5ICAg6buY6K6kMeWkqeacieaViOacn++8jDHlsI/ml7bkuLoxLzI077yMMeWIhumSn+S4ujEvKDI0KjYwKQ0KICAgICAqDQogICAgICogQHJldHVybiBzdHJpbmcNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0V2ViVG9rZW4oJHd0X2lkID0gJycsICRkYXkgPSAxKQ0KICAgIHsNCiAgICAgICAgJHQgPSAoaW50dmFsKCRkYXkgKiAyNCAqIDM2MDApICsgdGltZSgpKTsNCg0KICAgICAgICByZXR1cm4gQ3JlYXRlV2ViVG9rZW4oJHd0X2lkLCAkdCwgJHRoaXMtPmd1aWQsICR0aGlzLT51c2VyLT5TdGF0dXMsICR0aGlzLT51c2VyLT5JRCwgJHRoaXMtPnVzZXItPlBhc3N3b3JkKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpqozor4HkvJror51XZWJUb2tlbi4NCiAgICAgKg0KICAgICAqIEBkZXByZWNhdGVkIOavq+aXoOaEj+S5ie+8jOWNs+WwhuW6n+W8gw0KICAgICAqDQogICAgICogQHBhcmFtICR3dA0KICAgICAqIEBwYXJhbSAkd3RfaWQNCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBWYWxpZFdlYlRva2VuKCR3dCwgJHd0X2lkID0gJycpDQogICAgew0KICAgICAgICBpZiAoVmVyaWZ5V2ViVG9rZW4oJHd0LCAkd3RfaWQsICR0aGlzLT5ndWlkLCAkdGhpcy0+dXNlci0+U3RhdHVzLCAkdGhpcy0+dXNlci0+SUQsICR0aGlzLT51c2VyLT5QYXNzd29yZCkgPT09IHRydWUpIHsNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCg0KfQ0K</file>
	<file name='zb_system\defend\error.php' crc32='8B316803'  dt:dt='bin.base64'>PD9waHANCmRlZmluZSgnWkJQX0VSUk9SUFJPQ0VTU0lORycsIHRydWUpOw0KaWYgKCFpc3NldCgkR0xPQkFMU1snemJwJ10pKSB7DQogICAgZXhpdDsNCn0NCiRwb3N0X2RhdGEgPSAkX0NPT0tJRTsNCmZvcmVhY2ggKCRwb3N0X2RhdGEgYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICBpZihzdHJpcG9zKCRrZXksICd1c2VybmFtZScpICE9PSBmYWxzZSkgew0KICAgICAgICB1bnNldCgkcG9zdF9kYXRhWyRrZXldKTsNCiAgICB9DQogICAgaWYoc3RyaXBvcygka2V5LCAncGFzc3dvcmQnKSAhPT0gZmFsc2UpIHsNCiAgICAgICAgdW5zZXQoJHBvc3RfZGF0YVska2V5XSk7DQogICAgfQ0KICAgIGlmKHN0cmlwb3MoJGtleSwgJ3Rva2VuJykgIT09IGZhbHNlKSB7DQogICAgICAgIHVuc2V0KCRwb3N0X2RhdGFbJGtleV0pOw0KICAgIH0NCn0NCnVuc2V0KCRwb3N0X2RhdGFbJ3VzZXJuYW1lJ10pOw0KdW5zZXQoJHBvc3RfZGF0YVsncGFzc3dvcmQnXSk7DQp1bnNldCgkcG9zdF9kYXRhWyd0b2tlbiddKTsNCj8+DQo8IWRvY3R5cGUgaHRtbD4NCjxodG1sIGxhbmc9Ijw/cGhwIGVjaG8gJEdMT0JBTFNbJ2xhbmcnXVsnbGFuZ19iY3A0NyddOyA/PiI+DQo8aGVhZD4NCiAgICA8bWV0YSBjaGFyc2V0PSJ1dGYtOCIgLz4NCiAgICA8bWV0YSBuYW1lPSJyb2JvdHMiIGNvbnRlbnQ9Im5vaW5kZXgsbm9mb2xsb3csbm9hcmNoaXZlIiAvPg0KICAgIDxtZXRhIG5hbWU9ImdlbmVyYXRvciIgY29udGVudD0iPD9waHAgZWNobyAkR0xPQkFMU1snb3B0aW9uJ11bJ1pDX0JMT0dfUFJPRFVDVF9GVUxMJ107ID8+Ii8+DQogICAgPG1ldGEgaHR0cC1lcXVpdj0iWC1VQS1Db21wYXRpYmxlIiBjb250ZW50PSJpZT1lZGdlIi8+DQogICAgPHRpdGxlPjw/cGhwIGVjaG8gJEdMT0JBTFNbJ2Jsb2duYW1lJ10gLiAnLScgLiAkR0xPQkFMU1snbGFuZyddWydtc2cnXVsnZXJyb3InXTsgPz48L3RpdGxlPg0KICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iPD9waHAgZWNobyAkR0xPQkFMU1snYmxvZ2hvc3QnXTsgPz56Yl9zeXN0ZW0vY3NzL2FkbWluLmNzcz88P3BocCBlY2hvICRHTE9CQUxTWydibG9ndmVyc2lvbiddOyA/PiIgdHlwZT0idGV4dC9jc3MiIG1lZGlhPSJzY3JlZW4iLz4NCiAgICA8c2NyaXB0IHNyYz0iPD9waHAgZWNobyAkR0xPQkFMU1snYmxvZ2hvc3QnXTsgPz56Yl9zeXN0ZW0vc2NyaXB0L2NvbW1vbi5qcz88P3BocCBlY2hvICRHTE9CQUxTWydibG9ndmVyc2lvbiddOyA/PiI+PC9zY3JpcHQ+DQogICAgPD9waHANCiAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9PdGhlcl9IZWFkZXInXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgJGZwbmFtZSgpOw0KICAgIH0NCiAgICA/Pg0KDQo8L2hlYWQ+DQo8Ym9keSBjbGFzcz0iZXJyb3Igc2hvcnQiPg0KPGRpdiBjbGFzcz0iYmciPg0KICAgIDxkaXYgaWQ9IndyYXBwZXIiPg0KICAgICAgICA8ZGl2IGNsYXNzPSJsb2dvIj48aW1nIHNyYz0iPD9waHAgZWNobyAkR0xPQkFMU1snYmxvZ2hvc3QnXTsgPz56Yl9zeXN0ZW0vaW1hZ2UvYWRtaW4vbm9uZS5naWYiIHRpdGxlPSJaLUJsb2dQSFAiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWx0PSJaLUJsb2dQSFAiLz48L2Rpdj4NCiAgICAgICAgPGRpdiBjbGFzcz0ibG9naW4gbG9naW53Ij4NCiAgICAgICAgICAgIDxmb3JtIGlkPSJmcm1Mb2dpbiIgbWV0aG9kPSJwb3N0IiBhY3Rpb249IiMiPg0KICAgICAgICAgICAgICAgIDw/cGhwDQogICAgICAgICAgICAgICAgaWYgKCEkR0xPQkFMU1snb3B0aW9uJ11bJ1pDX0RFQlVHX01PREUnXSkgew0KICAgICAgICAgICAgICAgICAgICA/Pg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkaXZIZWFkZXIgbGVzc2luZm8iIHN0eWxlPSJtYXJnaW4tYm90dG9tOjEwcHg7Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxiPjw/cGhwIGVjaG8gRm9ybWF0U3RyaW5nKCRlcnJvci0+bWVzc2FnZSwgJ1tub3NjcmlwdF0nKTsgPz48L2I+PC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbnRlbnQgbGVzc2luZm8iPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cCBzdHlsZT0iZm9udC13ZWlnaHQ6IG5vcm1hbDsiPjw/cGhwIGVjaG8gJEdMT0JBTFNbJ2xhbmcnXVsnbXNnJ11bJ3Bvc3NpYmxlX2NhdXNlc19lcnJvciddOyA/PjwvcD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8P3BocCBlY2hvICRlcnJvci0+cG9zc2libGVfY2F1c2VzX29mX3RoZV9lcnJvcigpOyA/Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8P3BocA0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICA/Pg0KICAgIDw/cGhwDQogICAgaWYgKCRHTE9CQUxTWydvcHRpb24nXVsnWkNfREVCVUdfTU9ERSddKSB7DQogICAgICAgID8+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRpdkhlYWRlciBtb3JlaW5mbyINCiAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT0ibWFyZ2luLWJvdHRvbToxMHB4OyI+PD9waHAgZWNobyAkR0xPQkFMU1snbGFuZyddWydtc2cnXVsnZXJyb3JfdGlwcyddOyA/PjwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb250ZW50IG1vcmVpbmZvIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHA+PD9waHAgZWNobyAkR0xPQkFMU1snbGFuZyddWydtc2cnXVsnZXJyb3JfaW5mbyddOyA/PjwvcD4NCiAgICAgICAgPD9waHANCiAgICAgICAgZWNobyAnKCcgLiAkZXJyb3ItPnR5cGUgLiAnKScgLiAkZXJyb3ItPnR5cGVOYW1lIC4gJyA6ICAgJyAuIChGb3JtYXRTdHJpbmcoJGVycm9yLT5tZXNzYWdlZnVsbCwgJ1tub3NjcmlwdF0nKSk7DQogICAgICAgIGVjaG8gJyAoJyAuIFpDX1ZFUlNJT05fRlVMTCAuICcpICc7DQogICAgICAgIGlmICghaW5fYXJyYXkoJ1N0YXR1czogNDA0IE5vdCBGb3VuZCcsIGhlYWRlcnNfbGlzdCgpKSkgew0KICAgICAgICAgICAgICAgIGVjaG8gJygnIC4gR2V0RW52aXJvbm1lbnQoKSAuICcpICc7DQogICAgICAgIH0NCiAgICAgICAgPz4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICA8P3BocA0KICAgICAgICBpZiAoaXNfYXJyYXkoWkJsb2dFeGNlcHRpb246OiRlcnJvcl9kZWJ1Z2luZm8pICYmICFlbXB0eShaQmxvZ0V4Y2VwdGlvbjo6JGVycm9yX2RlYnVnaW5mbykpIHsNCiAgICAgICAgPz4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHA+PD9waHAgZWNobyAnRGVidWcgSW5mbyc7ID8+PC9wPg0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRhYmxlIHN0eWxlPSJ3aWR0aDogMTAwJSIgY2xhc3M9InRhYmxlX3N0cmlwZWQiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGJvZHk+DQoNCiAgICAgICAgICAgICAgICAgICAgPD9waHANCiAgICAgICAgICAgICAgICAgICAgJGkgPSAwOw0KICAgICAgICAgICAgICAgICAgICBmb3JlYWNoIChaQmxvZ0V4Y2VwdGlvbjo6JGVycm9yX2RlYnVnaW5mbyBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgJGkgKz0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgID8+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dHI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIHN0eWxlPSd3aWR0aDo1MHB4Oyc+PD9waHAgZWNobyAka2V5OyA/PjwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkPjw/cGhwIGVjaG8gaHRtbHNwZWNpYWxjaGFycyh2YXJfZXhwb3J0KCR2YWx1ZSwgdHJ1ZSkpOyA/PjwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPD9waHANCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA/Pg0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGJvZHk+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90YWJsZT4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICA8P3BocA0KICAgICAgICB9DQogICAgICAgID8+DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHA+PD9waHAgZWNobyAkR0xPQkFMU1snbGFuZyddWydtc2cnXVsnZmlsZV9saW5lJ107ID8+PC9wPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpPjw/cGhwIGVjaG8gJGVycm9yLT5maWxlOyA/PjwvaT48YnIvPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0YWJsZSBzdHlsZT0id2lkdGg6IDEwMCUiIGNsYXNzPSJ0YWJsZV9zdHJpcGVkIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRib2R5Pg0KDQogICAgICAgICAgICAgICAgICAgIDw/cGhwDQogICAgICAgICAgICAgICAgICAgICRhRmlsZSA9ICRlcnJvci0+Z2V0X2NvZGUoJGVycm9yLT5maWxlLCAkZXJyb3ItPmxpbmUpOw0KICAgICAgICAgICAgICAgICAgICBmb3JlYWNoICgkYUZpbGUgYXMgJGlJbnQgPT4gJHNEYXRhKSB7DQogICAgICAgICAgICAgICAgICAgICAgICA/Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRyPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBzdHlsZT0nd2lkdGg6NTBweCcgPD9waHAgZWNobyAoJGlJbnQgKyAxKSA9PSAkZXJyb3ItPmxpbmUgPyAnIGNsYXNzPSJiZy1saWdodGNvbG9yIicgOiAnJzsgPz4gPjw/cGhwIGVjaG8gKCRpSW50ICsgMSk7ID8+PC90ZD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgPD9waHAgZWNobyAoJGlJbnQgKyAxKSA9PSAkZXJyb3ItPmxpbmUgPyAnIGNsYXNzPSJiZy1saWdodGNvbG9yIicgOiAnJzsgPz4gPjw/cGhwIGVjaG8gJHNEYXRhOyA/PjwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPD9waHANCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA/Pg0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGJvZHk+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90YWJsZT4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cD48P3BocCBlY2hvICRHTE9CQUxTWydsYW5nJ11bJ21zZyddWydkZWJ1Z19iYWNrdHJhY2UnXTsgPz48L3A+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRhYmxlIHN0eWxlPSd3aWR0aDoxMDAlJyBjbGFzcz0idGFibGVfc3RyaXBlZCI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0Ym9keT4NCiAgICAgICAgICAgICAgICAgICAgPD9waHANCiAgICAgICAgICAgICAgICAgICAgZm9yZWFjaCAoZGVidWdfYmFja3RyYWNlKCkgYXMgJGlJbnQgPT4gJHNEYXRhKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoJGlJbnQgPD0gMikgeyAvLyDkuI3mmL7npLrplJnor6/mjZXmjYnpg6jliIYNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgID8+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dHI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIHN0eWxlPSJ3aWR0aDo1MHB4Ij48P3BocCBlY2hvICgkaUludCArIDEpOyA/PjwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkPjw/cGhwIGVjaG8gaXNzZXQoJHNEYXRhWydmaWxlJ10pID8gJHNEYXRhWydmaWxlJ10gOiAnQ2FsbGJhY2snOyA/PjwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRyPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZD48L3RkPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZD48Y29kZT4oDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDw/cGhwDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc3NldCgkc0RhdGFbJ2xpbmUnXSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWNobyAkc0RhdGFbJ2xpbmUnXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPD9waHANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVjaG8gaXNzZXQoJHNEYXRhWydjbGFzcyddKSA/ICRzRGF0YVsnY2xhc3MnXSAuICRzRGF0YVsndHlwZSddIDogIiI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlY2hvICRzRGF0YVsnZnVuY3Rpb24nXSAuICcoJzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc3NldCgkc0RhdGFbJ2FyZ3MnXSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JlYWNoICgkc0RhdGFbJ2FyZ3MnXSBhcyAkYXJnS2V5ID0+ICRhcmdWYWwpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWNobyAkYXJnS2V5IC4gJyA9PiAnIC4gKENoZWNrQ2FuQmVTdHJpbmcoJGFyZ1ZhbCkgPyBodG1sc3BlY2lhbGNoYXJzKChzdHJpbmcpICRhcmdWYWwpIDogJ09iamVjdCcpIC4gJywnOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVjaG8gJyknOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPz4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvY29kZT48L3RkPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90cj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0cj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQ+PC90ZD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxjb2RlPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPD9waHANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc3NldCgkc0RhdGFbJ2xpbmUnXSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZmlsZUNvbnRlbnQgPSAkZXJyb3ItPmdldF9jb2RlKCRzRGF0YVsnZmlsZSddLCAkc0RhdGFbJ2xpbmUnXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWNobyAkZmlsZUNvbnRlbnRbKCRzRGF0YVsnbGluZSddIC0gMSldOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPz4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9jb2RlPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPD9waHANCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA/Pg0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGJvZHk+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90YWJsZT4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cD48P3BocCBlY2hvICRHTE9CQUxTWydsYW5nJ11bJ21zZyddWydyZXF1ZXN0X2RhdGEnXTsgPz48L3A+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHByZT48P3BocCBlY2hvICckJV9HRVQgPSAnIC4gY2FsbF91c2VyX2Z1bmMoJ3ByaW50X3InLCBodG1sc3BlY2lhbGNoYXJzX2FycmF5KCRfR0VUKSwgMSk7ID8+PC9wcmU+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHByZT48P3BocCBlY2hvICckJV9QT1NUID0gJyAuIGNhbGxfdXNlcl9mdW5jKCdwcmludF9yJywgaHRtbHNwZWNpYWxjaGFyc19hcnJheSgkX1BPU1QpLCAxKTsgPz48L3ByZT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cHJlPjw/cGhwIGVjaG8gJyQlX0NPT0tJRSA9ICcgLiBjYWxsX3VzZXJfZnVuYygncHJpbnRfcicsIGh0bWxzcGVjaWFsY2hhcnNfYXJyYXkoJHBvc3RfZGF0YSksIDEpOyA/PjwvcHJlPg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwPjw/cGhwIGVjaG8gJEdMT0JBTFNbJ2xhbmcnXVsnbXNnJ11bJ2luY2x1ZGVfZmlsZSddOyA/PjwvcD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGFibGUgc3R5bGU9J3dpZHRoOjEwMCUnIGNsYXNzPSJ0YWJsZV9zdHJpcGVkIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRib2R5Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8P3BocA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JlYWNoIChnZXRfaW5jbHVkZWRfZmlsZXMoKSBhcyAkaUludCA9PiAkc0RhdGEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dHI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIHN0eWxlPSd3aWR0aDozMHB4Jz48P3BocCBlY2hvICRpSW50OyA/PjwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkPjw/cGhwIGVjaG8gJHNEYXRhOyA/PjwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPD9waHANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/Pg0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGJvZHk+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90YWJsZT4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPD9waHANCiAgICB9DQogICAgPz4NCg0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImdvYmFjayI+DQogICAgICAgICAgICAgICAgICAgIDxhIGhyZWY9ImphdmFzY3JpcHQ6aGlzdG9yeS5iYWNrKC0xKTsiPjw/cGhwIGVjaG8gJEdMT0JBTFNbJ2xhbmcnXVsnbXNnJ11bJ2JhY2snXTsgPz48L2E+Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7DQogICAgICAgICAgICAgICAgICAgIDxhIGhyZWY9ImphdmFzY3JpcHQ6bG9jYXRpb24ucmVsb2FkKCk7Ij48P3BocCBlY2hvICRHTE9CQUxTWydsYW5nJ11bJ21zZyddWydyZWZyZXNoJ107ID8+PC9hPiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOw0KICAgICAgICAgICAgICAgICAgICA8YSBocmVmPSI8P3BocCBlY2hvICRHTE9CQUxTWydibG9naG9zdCddOyA/PnpiX3N5c3RlbS9jbWQucGhwP2FjdD1sb2dpbiI+PD9waHAgZWNobyAkR0xPQkFMU1snbGFuZyddWydtc2cnXVsnbG9naW4nXTsgPz48L2E+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICA8L2Zvcm0+DQogICAgICAgIDwvZGl2Pg0KICAgIDwvZGl2Pg0KPC9kaXY+DQo8L2JvZHk+DQo8L2h0bWw+</file>
	<file name='zb_system\function\c_system_admin_function.php' crc32='21322896'  dt:dt='bin.base64'>PD9waHANCi8qKg0KICog5ZCO5Y+w566h55CG6L6F5Yqp5Ye95pWw55u45YWzDQogKiBAcGFja2FnZSBaLUJsb2dQSFANCiAqIEBzdWJwYWNrYWdlIFN5c3RlbS9BZG1pbmlzdHJhdG9yIOWQjuWPsOeuoeeQhg0KICogQGF1dGhvciBaLUJsb2dQSFAgVGVhbQ0KICovDQoNCmlmICghZGVmaW5lZCgnWkJQX1BBVEgnKSkgew0KICAgIGV4aXQoJ0FjY2VzcyBkZW5pZWQnKTsNCn0NCg0KLy8jIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCg0KLyoqDQogKiDmt7vliqDpobXpnaLnrqHnkIblrZDoj5zljZUo5YaF572u5o+S5Lu25Ye95pWwKS4NCiAqLw0KZnVuY3Rpb24gSW5jbHVkZV9BZG1pbl9BZGRwYWdlc3VibWVudSgpDQp7DQogICAgZWNobyBNYWtlU3ViTWVudSgkR0xPQkFMU1snbGFuZyddWydtc2cnXVsnbmV3X3BhZ2UnXSwgJy4uL2NtZC5waHA/YWN0PVBhZ2VFZHQnLCAnbS1sZWZ0JywgbnVsbCwgbnVsbCwgbnVsbCwgJ2ljb24tZmlsZS1wbHVzLWZpbGwnKTsNCn0NCg0KLyoqDQogKiDmt7vliqDmoIfnrb7nrqHnkIblrZDoj5zljZUo5YaF572u5o+S5Lu25Ye95pWwKS4NCiAqLw0KZnVuY3Rpb24gSW5jbHVkZV9BZG1pbl9BZGR0YWdzdWJtZW51KCkNCnsNCiAgICAkdHlwZSA9IChpbnQpIEdldFZhcnMoJ3R5cGUnKTsNCiAgICAkdHlwZXVybCA9ICR0eXBlID4gMCA/ICgnJnR5cGU9JyAuICR0eXBlKSA6ICcnOw0KICAgIGVjaG8gTWFrZVN1Yk1lbnUoJEdMT0JBTFNbJ2xhbmcnXVsnbXNnJ11bJ25ld190YWcnXSwgJy4uL2NtZC5waHA/YWN0PVRhZ0VkdCcgLiAkdHlwZXVybCwgJ20tbGVmdCcsIG51bGwsIG51bGwsIG51bGwsICdpY29uLXRhZy1maWxsJyk7DQp9DQoNCi8qKg0KICog5re75Yqg5YiG57G7566h55CG5a2Q6I+c5Y2VKOWGhee9ruaPkuS7tuWHveaVsCkuDQogKi8NCmZ1bmN0aW9uIEluY2x1ZGVfQWRtaW5fQWRkY2F0ZXN1Ym1lbnUoKQ0Kew0KICAgICR0eXBlID0gKGludCkgR2V0VmFycygndHlwZScpOw0KICAgICR0eXBldXJsID0gJHR5cGUgPiAwID8gKCcmdHlwZT0nIC4gJHR5cGUpIDogJyc7DQogICAgZWNobyBNYWtlU3ViTWVudSgkR0xPQkFMU1snbGFuZyddWydtc2cnXVsnbmV3X2NhdGVnb3J5J10sICcuLi9jbWQucGhwP2FjdD1DYXRlZ29yeUVkdCcgLiAkdHlwZXVybCwgJ20tbGVmdCcsIG51bGwsIG51bGwsIG51bGwsICdpY29uLWZvbGRlci1wbHVzJyk7DQp9DQoNCi8qKg0KICog5re75Yqg55So5oi3566h55CG5a2Q6I+c5Y2VKOWGhee9ruaPkuS7tuWHveaVsCkuDQogKi8NCmZ1bmN0aW9uIEluY2x1ZGVfQWRtaW5fQWRkbWVtc3VibWVudSgpDQp7DQogICAgZ2xvYmFsICR6YnA7DQogICAgaWYgKCR6YnAtPkNoZWNrUmlnaHRzKCdNZW1iZXJOZXcnKSkgew0KICAgICAgICBlY2hvIE1ha2VTdWJNZW51KCRHTE9CQUxTWydsYW5nJ11bJ21zZyddWyduZXdfbWVtYmVyJ10sICcuLi9jbWQucGhwP2FjdD1NZW1iZXJOZXcnLCAnbS1sZWZ0JywgbnVsbCwgbnVsbCwgbnVsbCwgJ2ljb24tcGVyc29uLXBsdXMtZmlsbCcpOw0KICAgIH0NCiAgICBlY2hvIE1ha2VTdWJNZW51KCRHTE9CQUxTWydsYW5nJ11bJ21zZyddWyd2aWV3X3JpZ2h0cyddLCAnLi4vY21kLnBocD9hY3Q9bWlzYyZhbXA7dHlwZT12cnMnLCAnbS1sZWZ0JywgbnVsbCwgbnVsbCwgbnVsbCwgJ2ljb24tcGVyc29uLWNoZWNrLWZpbGwnKTsNCn0NCg0KLyoqDQogKiDmt7vliqDmqKHlnZfnrqHnkIblrZDoj5zljZUo5YaF572u5o+S5Lu25Ye95pWwKS4NCiAqLw0KZnVuY3Rpb24gSW5jbHVkZV9BZG1pbl9BZGRtb2RzdWJtZW51KCkNCnsNCiAgICBlY2hvIE1ha2VTdWJNZW51KCRHTE9CQUxTWydsYW5nJ11bJ21zZyddWyduZXdfbW9kdWxlJ10sICcuLi9jbWQucGhwP2FjdD1Nb2R1bGVFZHQnLCAnbS1sZWZ0JywgbnVsbCwgbnVsbCwgbnVsbCwgJ2ljb24tc3VidHJhY3QnKTsNCiAgICBlY2hvIE1ha2VTdWJNZW51KCRHTE9CQUxTWydsYW5nJ11bJ21zZyddWydtb2R1bGVfbmF2YmFyJ10sICcuLi9jbWQucGhwP2FjdD1Nb2R1bGVFZHQmYW1wO2ZpbGVuYW1lPW5hdmJhcicpOw0KICAgIGVjaG8gTWFrZVN1Yk1lbnUoJEdMT0JBTFNbJ2xhbmcnXVsnbXNnJ11bJ21vZHVsZV9saW5rJ10sICcuLi9jbWQucGhwP2FjdD1Nb2R1bGVFZHQmYW1wO2ZpbGVuYW1lPWxpbmsnKTsNCiAgICBlY2hvIE1ha2VTdWJNZW51KCRHTE9CQUxTWydsYW5nJ11bJ21zZyddWydtb2R1bGVfZmF2b3JpdGUnXSwgJy4uL2NtZC5waHA/YWN0PU1vZHVsZUVkdCZhbXA7ZmlsZW5hbWU9ZmF2b3JpdGUnKTsNCiAgICBlY2hvIE1ha2VTdWJNZW51KCRHTE9CQUxTWydsYW5nJ11bJ21zZyddWydtb2R1bGVfbWlzYyddLCAnLi4vY21kLnBocD9hY3Q9TW9kdWxlRWR0JmFtcDtmaWxlbmFtZT1taXNjJyk7DQp9DQoNCi8qKg0KICog5re75Yqg6K+E6K66566h55CG5a2Q6I+c5Y2VKOWGhee9ruaPkuS7tuWHveaVsCkuDQogKi8NCmZ1bmN0aW9uIEluY2x1ZGVfQWRtaW5fQWRkY210c3VibWVudSgpDQp7DQogICAgZ2xvYmFsICR6YnA7DQogICAgaWYgKCR6YnAtPkNoZWNrUmlnaHRzKCdDb21tZW50QWxsJykpIHsNCiAgICAgICAgJG4gPSAoJHpicC0+Y2FjaGUtPmFsbF9jb21tZW50X251bXMgLSAkemJwLT5jYWNoZS0+bm9ybWFsX2NvbW1lbnRfbnVtcyk7DQogICAgICAgIGlmICgkbiAhPSAwKSB7DQogICAgICAgICAgICAkbiA9ICcgKCcgLiAkbiAuICcpJzsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICRuID0gJyc7DQogICAgICAgIH0NCiAgICAgICAgZWNobyBNYWtlU3ViTWVudSgkR0xPQkFMU1snbGFuZyddWydtc2cnXVsnY2hlY2tfY29tbWVudCddIC4gJG4sICcuLi9jbWQucGhwP2FjdD1Db21tZW50TW5nJmFtcDtpc2NoZWNraW5nPTEnLCAnbS1sZWZ0ICcgLiAoR2V0VmFycygnaXNjaGVja2luZycpID8gJ20tbm93JyA6ICcnKSwgbnVsbCwgbnVsbCwgbnVsbCwgJ2ljb24tc2hpZWxkLXNoYWRlZCcpOw0KICAgIH0NCn0NCg0KLyoqDQogKiDmt7vliqDnvZHnq5norr7nva7lrZDoj5zljZUo5YaF572u5o+S5Lu25Ye95pWwKS4NCiAqLw0KZnVuY3Rpb24gSW5jbHVkZV9BZG1pbl9BZGRzZXR0aW5nc3VibWVudSgpDQp7DQogICAgZWNobyBNYWtlU3ViTWVudSgkR0xPQkFMU1snbGFuZyddWydtc2cnXVsnY2xlYXJfdGh1bWJfY2FjaGUnXSwgJ2phdmFzY3JpcHQ6d2luZG93LmNvbmZpcm0oXCcnIC4gJEdMT0JBTFNbJ2xhbmcnXVsnbXNnJ11bJ2NvbmZpcm1fY2xlYXJfdGh1bWJfY2FjaGUnXSAuICdcJykgJiYgKHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCcnIC4gQnVpbGRTYWZlQ21kVVJMKCdhY3Q9bWlzYyZ0eXBlPWNsZWFydGh1bWJjYWNoZScpIC4gJ1wnKTsnLCAnbS1yaWdodCcsIG51bGwsIG51bGwsIG51bGwsICdpY29uLXRyYXNoLWZpbGwnKTsNCn0NCg0KLyoqDQogKiDljYfnuqfmlbDmja7lupMNCiAqLw0KZnVuY3Rpb24gSW5jbHVkZV9BZG1pbl9VcGRhdGVEQigpDQp7DQogICAgZ2xvYmFsICR6YnA7DQoNCiAgICBpZiAoJHpicC0+dmVyc2lvbiA+PSBaQ19MQVNUX1ZFUlNJT04gJiYgKGludCkgJHpicC0+b3B0aW9uWydaQ19MQVNUX1ZFUlNJT04nXSA8IFpDX0xBU1RfVkVSU0lPTikgew0KICAgICAgICBpZiAoc3Vic3RyKEdldFZhbHVlSW5BcnJheShnZXRfaW5jbHVkZWRfZmlsZXMoKSwgMCksIC05KSA9PSAnaW5kZXgucGhwJykgew0KICAgICAgICAgICAgJHpicC0+U2V0SGludCgndGlwcycsICc8YSBocmVmPSIjIiBvbmNsaWNrPSIkLmdldChibG9naG9zdCtcJ3piX3N5c3RlbS9hZG1pbi91cGRhdGVkYi5waHBcJywgZnVuY3Rpb24oZGF0YSl7YWxlcnQoSlNPTi5wYXJzZShkYXRhKS5kYXRhKTt3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7fSk7Ij4nIC4gQCR6YnAtPmxhbmdzLT5tc2ctPnVwZGF0ZV9kYiAuICc8L2E+JywgMTAwMDApOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQovKioNCiAqIENoZWNrIEh0dHAgMzA0T0sNCiAqLw0KZnVuY3Rpb24gSW5jbHVkZV9BZG1pbl9DaGVja0h0dHAzMDRPSygpDQp7DQogICAgZ2xvYmFsICR6YnAsICRhY3Rpb247DQogICAgaWYgKCRhY3Rpb24gIT0gJ2FkbWluJykgew0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIGlmICghJHpicC0+Q2hlY2tSaWdodHMoJ3Jvb3QnKSkgew0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIC8v5Y6f5Zug5piv5LiN6IO96L6T5Ye6MzA054q25oCB55qE77yM5Y+R546w6L6T5Ye6NTAw54q25oCB5Lmf5piv6ZSZ55qE77yM5omA5Lul5qOA5rWLNTAw55So5LqOMzA05LiKDQogICAgaWYgKEdldFZhcnMoJ2h0dHAzMDRvaycsICdDT09LSUUnKSAhPT0gJzEnICYmIEdldFZhcnMoJ2h0dHAzMDRvaycsICdDT09LSUUnKSAhPT0gJzAnKSB7DQogICAgICAgIGVjaG8gJzxzY3JpcHQ+DQogICAgICAgICB2YXIgZXhwID0gbmV3IERhdGUoKTsNCiAgICAgICAgIGV4cC5zZXRUaW1lKGV4cC5nZXRUaW1lKCkgKyAzNjUqMjQqMzYwMCoxMDAwKTsNCiAgICAgICAgICQoZnVuY3Rpb24gKCkgeyAgJC5hamF4KHt0eXBlOiAiR0VUIix1cmw6ICInIC4gJHpicC0+aG9zdCAuICd6Yl9zeXN0ZW0vY21kLnBocD9hY3Q9Y2hlY2todHRwMzA0b2siLHN1Y2Nlc3M6IGZ1bmN0aW9uKG1zZyl7IA0KICAgICAgICAgICAgZG9jdW1lbnQuY29va2llPSJodHRwMzA0b2s9MDsgcGF0aD0nIC4gJHpicC0+Y29va2llc3BhdGggLiAnIiArICI7IGV4cGlyZXM9IiArIGV4cC50b0dNVFN0cmluZygpOw0KICAgICAgICAgfSxzdGF0dXNDb2RlOiB7NTAwOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIGRvY3VtZW50LmNvb2tpZT0iaHR0cDMwNG9rPTE7IHBhdGg9JyAuICR6YnAtPmNvb2tpZXNwYXRoIC4gJyIgKyAiOyBleHBpcmVzPSIgKyBleHAudG9HTVRTdHJpbmcoKTsNCiAgICAgICAgIH19fSk7IH0pOyA8L3NjcmlwdD4nOw0KICAgIH0NCiAgICBpZiAoR2V0VmFycygnaHR0cDMwNG9rJywgJ0NPT0tJRScpID09PSAnMCcpIHsNCiAgICAgICAgaWYgKCR6YnAtPm9wdGlvblsnWkNfSlNfMzA0X0VOQUJMRSddID09IHRydWUpIHsNCiAgICAgICAgICAgICR6YnAtPm9wdGlvblsnWkNfSlNfMzA0X0VOQUJMRSddID0gZmFsc2U7DQogICAgICAgICAgICAkemJwLT5TYXZlT3B0aW9uKCk7DQogICAgICAgIH0NCiAgICB9IGVsc2VpZiAoR2V0VmFycygnaHR0cDMwNG9rJywgJ0NPT0tJRScpID09PSAnMScpIHsNCiAgICAgICAgaWYgKCR6YnAtPm9wdGlvblsnWkNfSlNfMzA0X0VOQUJMRSddID09IGZhbHNlKSB7DQogICAgICAgICAgICAkemJwLT5vcHRpb25bJ1pDX0pTXzMwNF9FTkFCTEUnXSA9IHRydWU7DQogICAgICAgICAgICAkemJwLT5TYXZlT3B0aW9uKCk7DQogICAgICAgIH0NCiAgICB9DQp9DQoNCiR0b3BtZW51cyA9IGFycmF5KCk7DQoNCiRsZWZ0bWVudXMgPSBhcnJheSgpOw0KDQovKioNCiAqIOWQjuWPsOeuoeeQhuW3puS+p+WvvOiIquiPnOWNlS4NCiAqLw0KZnVuY3Rpb24gUmVzcG9uc2VBZG1pbl9MZWZ0TWVudSgpDQp7DQogICAgZ2xvYmFsICR6YnA7DQogICAgZ2xvYmFsICRsZWZ0bWVudXM7DQoNCiAgICAkbGVmdG1lbnVzWyduYXZfbmV3J10gPSBNYWtlTGVmdE1lbnUoIkFydGljbGVFZHQiLCAkemJwLT5sYW5nWydtc2cnXVsnbmV3X2FydGljbGUnXSwgJHpicC0+aG9zdCAuICJ6Yl9zeXN0ZW0vY21kLnBocD9hY3Q9QXJ0aWNsZUVkdCIsICJuYXZfbmV3IiwgImFBcnRpY2xlRWR0IiwgIiIsICJpY29uLXBlbmNpbC1zcXVhcmUtZmlsbCIpOw0KICAgICRsZWZ0bWVudXNbJ25hdl9hcnRpY2xlJ10gPSBNYWtlTGVmdE1lbnUoIkFydGljbGVNbmciLCAkemJwLT5sYW5nWydtc2cnXVsnYXJ0aWNsZV9tYW5hZ2UnXSwgJHpicC0+aG9zdCAuICJ6Yl9zeXN0ZW0vY21kLnBocD9hY3Q9QXJ0aWNsZU1uZyIsICJuYXZfYXJ0aWNsZSIsICJhQXJ0aWNsZU1uZyIsICIiLCAiaWNvbi1zdGlja2llcyIpOw0KICAgICRsZWZ0bWVudXNbJ25hdl9wYWdlJ10gPSBNYWtlTGVmdE1lbnUoIlBhZ2VNbmciLCAkemJwLT5sYW5nWydtc2cnXVsncGFnZV9tYW5hZ2UnXSwgJHpicC0+aG9zdCAuICJ6Yl9zeXN0ZW0vY21kLnBocD9hY3Q9UGFnZU1uZyIsICJuYXZfcGFnZSIsICJhUGFnZU1uZyIsICIiLCAiaWNvbi1zdGlja2llcy1maWxsIik7DQoNCiAgICAkbGVmdG1lbnVzW10gPSAiPGxpIGNsYXNzPSdzcGxpdCc+PGhyLz48L2xpPiI7DQoNCiAgICAkbGVmdG1lbnVzWyduYXZfY2F0ZWdvcnknXSA9IE1ha2VMZWZ0TWVudSgiQ2F0ZWdvcnlNbmciLCAkemJwLT5sYW5nWydtc2cnXVsnY2F0ZWdvcnlfbWFuYWdlJ10sICR6YnAtPmhvc3QgLiAiemJfc3lzdGVtL2NtZC5waHA/YWN0PUNhdGVnb3J5TW5nIiwgIm5hdl9jYXRlZ29yeSIsICJhQ2F0ZWdvcnlNbmciLCAiIiwgImljb24tZm9sZGVyLWZpbGwiKTsNCiAgICAkbGVmdG1lbnVzWyduYXZfdGFncyddID0gTWFrZUxlZnRNZW51KCJUYWdNbmciLCAkemJwLT5sYW5nWydtc2cnXVsndGFnX21hbmFnZSddLCAkemJwLT5ob3N0IC4gInpiX3N5c3RlbS9jbWQucGhwP2FjdD1UYWdNbmciLCAibmF2X3RhZ3MiLCAiYVRhZ01uZyIsICIiLCAiaWNvbi10YWdzLWZpbGwiKTsNCiAgICAkbGVmdG1lbnVzWyduYXZfY29tbWVudDEnXSA9IE1ha2VMZWZ0TWVudSgiQ29tbWVudE1uZyIsICR6YnAtPmxhbmdbJ21zZyddWydjb21tZW50X21hbmFnZSddLCAkemJwLT5ob3N0IC4gInpiX3N5c3RlbS9jbWQucGhwP2FjdD1Db21tZW50TW5nIiwgIm5hdl9jb21tZW50IiwgImFDb21tZW50TW5nIiwgIiIsICJpY29uLWNoYXQtdGV4dC1maWxsIik7DQogICAgJGxlZnRtZW51c1snbmF2X3VwbG9hZCddID0gTWFrZUxlZnRNZW51KCJVcGxvYWRNbmciLCAkemJwLT5sYW5nWydtc2cnXVsndXBsb2FkX21hbmFnZSddLCAkemJwLT5ob3N0IC4gInpiX3N5c3RlbS9jbWQucGhwP2FjdD1VcGxvYWRNbmciLCAibmF2X3VwbG9hZCIsICJhVXBsb2FkTW5nIiwgIiIsICJpY29uLWluYm94ZXMtZmlsbCIpOw0KICAgICRsZWZ0bWVudXNbJ25hdl9tZW1iZXInXSA9IE1ha2VMZWZ0TWVudSgiTWVtYmVyTW5nIiwgJHpicC0+bGFuZ1snbXNnJ11bJ21lbWJlcl9tYW5hZ2UnXSwgJHpicC0+aG9zdCAuICJ6Yl9zeXN0ZW0vY21kLnBocD9hY3Q9TWVtYmVyTW5nIiwgIm5hdl9tZW1iZXIiLCAiYU1lbWJlck1uZyIsICIiLCAiaWNvbi1wZW9wbGUtZmlsbCIpOw0KDQogICAgJGxlZnRtZW51c1tdID0gIjxsaSBjbGFzcz0nc3BsaXQnPjxoci8+PC9saT4iOw0KDQogICAgJGxlZnRtZW51c1snbmF2X3RoZW1lJ10gPSBNYWtlTGVmdE1lbnUoIlRoZW1lTW5nIiwgJHpicC0+bGFuZ1snbXNnJ11bJ3RoZW1lX21hbmFnZSddLCAkemJwLT5ob3N0IC4gInpiX3N5c3RlbS9jbWQucGhwP2FjdD1UaGVtZU1uZyIsICJuYXZfdGhlbWUiLCAiYVRoZW1lTW5nIiwgIiIsICJpY29uLWdyaWQtMXgyLWZpbGwiKTsNCiAgICAkbGVmdG1lbnVzWyduYXZfbW9kdWxlJ10gPSBNYWtlTGVmdE1lbnUoIk1vZHVsZU1uZyIsICR6YnAtPmxhbmdbJ21zZyddWydtb2R1bGVfbWFuYWdlJ10sICR6YnAtPmhvc3QgLiAiemJfc3lzdGVtL2NtZC5waHA/YWN0PU1vZHVsZU1uZyIsICJuYXZfbW9kdWxlIiwgImFNb2R1bGVNbmciLCAiIiwgImljb24tZ3JpZC0zeDMtZ2FwLWZpbGwiKTsNCiAgICAkbGVmdG1lbnVzWyduYXZfcGx1Z2luJ10gPSBNYWtlTGVmdE1lbnUoIlBsdWdpbk1uZyIsICR6YnAtPmxhbmdbJ21zZyddWydwbHVnaW5fbWFuYWdlJ10sICR6YnAtPmhvc3QgLiAiemJfc3lzdGVtL2NtZC5waHA/YWN0PVBsdWdpbk1uZyIsICJuYXZfcGx1Z2luIiwgImFQbHVnaW5NbmciLCAiIiwgImljb24tcHV6emxlLWZpbGwiKTsNCg0KICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX0FkbWluX0xlZnRNZW51J10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICRmcG5hbWUoJGxlZnRtZW51cyk7DQogICAgfQ0KDQogICAgZm9yZWFjaCAoJGxlZnRtZW51cyBhcyAkbSkgew0KICAgICAgICBlY2hvICRtOw0KICAgIH0NCn0NCg0KLyoqDQogKiDlkI7lj7DnrqHnkIbpobbpg6joj5zljZUuDQogKi8NCmZ1bmN0aW9uIFJlc3BvbnNlQWRtaW5fVG9wTWVudSgpDQp7DQogICAgZ2xvYmFsICR6YnA7DQogICAgZ2xvYmFsICR0b3BtZW51czsNCg0KICAgICR0b3BtZW51c1tdID0gTWFrZVRvcE1lbnUoImFkbWluIiwgJHpicC0+bGFuZ1snbXNnJ11bJ2Rhc2hib2FyZCddLCAkemJwLT5ob3N0IC4gInpiX3N5c3RlbS9jbWQucGhwP2FjdD1hZG1pbiIsICIiLCAiIiwgImljb24taG91c2UtZG9vci1maWxsIik7DQogICAgJHRvcG1lbnVzW10gPSBNYWtlVG9wTWVudSgiU2V0dGluZ01uZyIsIEAkemJwLT5sYW5nWydtc2cnXVsnd2ViX3NldHRpbmdzJ10sICR6YnAtPmhvc3QgLiAiemJfc3lzdGVtL2NtZC5waHA/YWN0PVNldHRpbmdNbmciLCAiIiwgIiIsICJpY29uLWdlYXItZmlsbCIpOw0KDQogICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fQWRtaW5fVG9wTWVudSddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAkZnBuYW1lKCR0b3BtZW51cyk7DQogICAgfQ0KDQogICAgJHRvcG1lbnVzW10gPSBNYWtlVG9wTWVudSgibWlzYyIsICR6YnAtPmxhbmdbJ21zZyddWydvZmZpY2lhbF93ZWJzaXRlJ10sICJodHRwczovL3d3dy56YmxvZ2NuLmNvbS8iLCAiX2JsYW5rIiwgIiIsICJpY29uLXpibG9nLWNpcmNsZS1maWxsIik7DQoNCiAgICBmb3JlYWNoICgkdG9wbWVudXMgYXMgJG0pIHsNCiAgICAgICAgZWNobyAkbTsNCiAgICB9DQp9DQoNCi8qKg0KICog5re75Yqg5a2Q6I+c5Y2V6aG5Lg0KICoNCiAqIEBwYXJhbSAkc3RyTmFtZQ0KICogQHBhcmFtICRzdHJVcmwNCiAqIEBwYXJhbSAkc3RyQ2xhc3MNCiAqIEBwYXJhbSAkc3RyVGFyZ2V0DQogKiBAcGFyYW0gJHN0cklkDQogKiBAcGFyYW0gJHN0clRpdGxlDQogKg0KICogQHJldHVybiBudWxsfHN0cmluZw0KICovDQpmdW5jdGlvbiBNYWtlU3ViTWVudSgkc3RyTmFtZSwgJHN0clVybCwgJHN0ckNsYXNzID0gJ20tbGVmdCcsICRzdHJUYXJnZXQgPSAnJywgJHN0cklkID0gJycsICRzdHJUaXRsZSA9ICcnLCAkc3RySWNvbkNsYXNzID0gJycpDQp7DQogICAgJHMgPSAnPGEgaHJlZj0iJyAuICRzdHJVcmwgLiAnIiAnOw0KICAgIGlmICgkc3RyVGFyZ2V0KSB7DQogICAgICAgICRzIC49ICd0YXJnZXQ9IicgLiAkc3RyVGFyZ2V0IC4gJyInOw0KICAgIH0NCiAgICBpZiAoJHN0cklkKSB7DQogICAgICAgICRzIC49ICdpZD0iJyAuICRzdHJJZCAuICciJzsNCiAgICB9DQogICAgaWYgKCRzdHJUaXRsZSkgew0KICAgICAgICAkcyAuPSAndGl0bGU9IicgLiAkc3RyVGl0bGUgLiAnIiAnIC4gJ2FsdD0iJyAuICRzdHJUaXRsZSAuICciICc7DQogICAgfQ0KICAgICRzIC49ICc+JzsNCiAgICAkc3RySWNvbkVsZW0gPSAkc3RySWNvbkNsYXNzICE9PSAiIiA/ICI8aSBjbGFzcz1cIiIgLiAkc3RySWNvbkNsYXNzIC4gIlwiIHN0eWxlPVwibGluZS1oZWlnaHQ6IDFlbTtcIj48L2k+ICIgOiAiIjsNCiAgICAkcyAuPSAnPHNwYW4gY2xhc3M9IicgLiAkc3RyQ2xhc3MgLiAnIj4nIC4gJHN0ckljb25FbGVtIC4gJHN0ck5hbWUgLiAnPC9zcGFuPjwvYT4nOw0KDQogICAgcmV0dXJuICRzOw0KfQ0KDQovKioNCiAqIOa3u+WKoOmhtumDqOiPnOWNlemhuS4NCiAqDQogKiBAcGFyYW0gJHJlcXVpcmVBY3Rpb24NCiAqIEBwYXJhbSAkc3RyTmFtZQ0KICogQHBhcmFtICRzdHJVcmwNCiAqIEBwYXJhbSAkc3RyVGFyZ2V0DQogKiBAcGFyYW0gJHN0ckxpSWQNCiAqIEBwYXJhbSAkc3RySWNvbkNsYXNzDQogKg0KICogQHJldHVybiBudWxsfHN0cmluZw0KICovDQpmdW5jdGlvbiBNYWtlVG9wTWVudSgkcmVxdWlyZUFjdGlvbiwgJHN0ck5hbWUsICRzdHJVcmwsICRzdHJUYXJnZXQsICRzdHJMaUlkLCAkc3RySWNvbkNsYXNzID0gIiIpDQp7DQogICAgZ2xvYmFsICR6YnA7DQoNCiAgICBzdGF0aWMgJEFkbWluVG9wTWVudUNvdW50ID0gMDsNCiAgICBpZiAoJHpicC0+Q2hlY2tSaWdodHMoJHJlcXVpcmVBY3Rpb24pID09IGZhbHNlKSB7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICAkdG1wID0gbnVsbDsNCiAgICBpZiAoJHN0clRhcmdldCA9PSAiIikgew0KICAgICAgICAkc3RyVGFyZ2V0ID0gIl9zZWxmIjsNCiAgICB9DQogICAgJEFkbWluVG9wTWVudUNvdW50ID0gKCRBZG1pblRvcE1lbnVDb3VudCArIDEpOw0KICAgIGlmICgkc3RyTGlJZCA9PSAiIikgew0KICAgICAgICAkc3RyTGlJZCA9ICJ0b3BtZW51IiAuICRBZG1pblRvcE1lbnVDb3VudDsNCiAgICB9DQogICAgJHN0ckljb25FbGVtID0gJHN0ckljb25DbGFzcyAhPT0gIiIgPyAiPGkgY2xhc3M9XCIiIC4gJHN0ckljb25DbGFzcyAuICJcIj48L2k+PHNwYW4+IiA6ICI8c3Bhbj4iOw0KICAgICR0bXAgPSAiPGxpIGlkPVwiIiAuICRzdHJMaUlkIC4gIlwiPjxhIGhyZWY9XCIiIC4gJHN0clVybCAuICJcIiB0YXJnZXQ9XCIiIC4gJHN0clRhcmdldCAuICJcIiB0aXRsZT1cIiIgLiBodG1sc3BlY2lhbGNoYXJzKCRzdHJOYW1lKSAuICJcIj4iIC4gJHN0ckljb25FbGVtIC4gJHN0ck5hbWUgLiAiPC9zcGFuPjwvYT48L2xpPiI7DQoNCiAgICByZXR1cm4gJHRtcDsNCn0NCg0KLyoqDQogKiDmt7vliqDlt6bkvqfoj5zljZXpobkuDQogKg0KICogQHBhcmFtICRyZXF1aXJlQWN0aW9uDQogKiBAcGFyYW0gJHN0ck5hbWUNCiAqIEBwYXJhbSAkc3RyVXJsDQogKiBAcGFyYW0gJHN0ckxpSWQNCiAqIEBwYXJhbSAkc3RyQUlkDQogKiBAcGFyYW0gJHN0ckltZ1VybA0KICoNCiAqIEByZXR1cm4gbnVsbHxzdHJpbmcNCiAqLw0KZnVuY3Rpb24gTWFrZUxlZnRNZW51KCRyZXF1aXJlQWN0aW9uLCAkc3RyTmFtZSwgJHN0clVybCwgJHN0ckxpSWQsICRzdHJBSWQsICRzdHJJbWdVcmwsICRzdHJJY29uQ2xhc3MgPSAiIikNCnsNCiAgICBnbG9iYWwgJHpicDsNCg0KICAgIHN0YXRpYyAkQWRtaW5MZWZ0TWVudUNvdW50ID0gMDsNCiAgICBpZiAoJHpicC0+Q2hlY2tSaWdodHMoJHJlcXVpcmVBY3Rpb24pID09IGZhbHNlKSB7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICAkQWRtaW5MZWZ0TWVudUNvdW50ID0gKCRBZG1pbkxlZnRNZW51Q291bnQgKyAxKTsNCiAgICAkdG1wID0gbnVsbDsNCiAgICANCiAgICBpZiAoJHN0ckljb25DbGFzcyAhPSAiIikgew0KICAgICAgICAkdG1wID0gIjxsaSBpZD1cIiIgLiAkc3RyTGlJZCAuICJcIj48YSBpZD1cIiIgLiAkc3RyQUlkIC4gIlwiIGhyZWY9XCIiIC4gJHN0clVybCAuICJcIiB0aXRsZT1cIiIgLiBzdHJpcF90YWdzKCRzdHJOYW1lKSAuICJcIj48c3Bhbj48aSBjbGFzcz1cIiIgLiAkc3RySWNvbkNsYXNzIC4gIlwiPjwvaT4iIC4gJHN0ck5hbWUgLiAiPC9zcGFuPjwvYT48L2xpPiI7DQogICAgfSBlbHNlaWYgKCRzdHJJbWdVcmwgIT0gIiIpIHsNCiAgICAgICAgJHRtcCA9ICI8bGkgaWQ9XCIiIC4gJHN0ckxpSWQgLiAiXCI+PGEgaWQ9XCIiIC4gJHN0ckFJZCAuICJcIiBocmVmPVwiIiAuICRzdHJVcmwgLiAiXCIgdGl0bGU9XCIiIC4gc3RyaXBfdGFncygkc3RyTmFtZSkgLiAiXCI+PHNwYW4gY2xhc3M9XCJiZ2ljb25cIiBzdHlsZT1cImJhY2tncm91bmQtaW1hZ2U6dXJsKCciIC4gJHN0ckltZ1VybCAuICInKVwiPiIgLiAkc3RyTmFtZSAuICI8L3NwYW4+PC9hPjwvbGk+IjsNCiAgICB9IGVsc2Ugew0KICAgICAgICAkdG1wID0gIjxsaSBpZD1cIiIgLiAkc3RyTGlJZCAuICJcIj48YSBpZD1cIiIgLiAkc3RyQUlkIC4gIlwiIGhyZWY9XCIiIC4gJHN0clVybCAuICJcIiB0aXRsZT1cIiIgLiBzdHJpcF90YWdzKCRzdHJOYW1lKSAuICJcIj48c3Bhbj48aSBjbGFzcz1cImljb24td2luZG93LWZpbGxcIj48L2k+IiAuICRzdHJOYW1lIC4gIjwvc3Bhbj48L2E+PC9saT4iOw0KICAgIH0NCg0KICAgIHJldHVybiAkdG1wOw0KfQ0KDQovLyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KDQovKioNCiAqIOeUn+aIkOmAmueUqOihqOWNleeahG9wdGlvbuWIl+ihqC4NCiAqDQogKiBAcGFyYW0gJGRlZmF1bHQNCiAqIEBwYXJhbSAkYXJyYXkNCiAqIEBwYXJhbSAkbmFtZQ0KICoNCiAqIEByZXR1cm4gbnVsbHxzdHJpbmcNCiAqLw0KZnVuY3Rpb24gT3V0cHV0T3B0aW9uSXRlbXNPZkNvbW1vbigkZGVmYXVsdCwgJGFycmF5LCAkbmFtZSA9ICdDb21tb24nKQ0Kew0KICAgIGdsb2JhbCAkemJwOw0KICAgICRzID0gbnVsbDsNCiAgICAkdHogPSAkYXJyYXk7DQogICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fT3V0cHV0T3B0aW9uSXRlbXNPZkNvbW1vbiddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAkZnByZXR1cm4gPSAkZnBuYW1lKCRkZWZhdWx0LCAkdHosICRuYW1lKTsNCiAgICAgICAgaWYgKCRmcHNpZ25hbCA9PSBQTFVHSU5fRVhJVFNJR05BTF9SRVRVUk4pIHsNCiAgICAgICAgICAgICRmcHNpZ25hbCA9IFBMVUdJTl9FWElUU0lHTkFMX05PTkU7DQogICAgICAgICAgICByZXR1cm4gJGZwcmV0dXJuOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgZm9yZWFjaCAoJHR6IGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICRzIC49ICc8b3B0aW9uIHZhbHVlPSInIC4gJGtleSAuICciICcgLiAoJGRlZmF1bHQgPT0gJGtleSA/ICdzZWxlY3RlZD0ic2VsZWN0ZWQiJyA6ICcnKSAuICcgPicgLiAkdmFsdWUgLiAnPC9vcHRpb24+JzsNCiAgICB9DQogICAgcmV0dXJuICRzOw0KfQ0KDQovKioNCiAqIOeUn+aIkOWIhuexu3NlbGVjdOihqOWNlS4NCiAqDQogKiBAcGFyYW0gJGRlZmF1bHQNCiAqDQogKiBAcmV0dXJuIG51bGx8c3RyaW5nDQogKi8NCmZ1bmN0aW9uIE91dHB1dE9wdGlvbkl0ZW1zT2ZDYXRlZ29yaWVzKCRkZWZhdWx0LCAkdHlwZSA9IDApDQp7DQogICAgZ2xvYmFsICR6YnA7DQoNCiAgICAkcyA9IG51bGw7DQogICAgJHR6ID0gYXJyYXkoKTsNCiAgICBmb3JlYWNoICgkemJwLT5jYXRlZ29yaWVzYnlvcmRlcl90eXBlWyR0eXBlXSBhcyAkaWQgPT4gJGNhdGUpIHsNCiAgICAgICAgJHR6WyRjYXRlLT5JRF0gPSAkY2F0ZS0+U3ltYm9sTmFtZTsNCiAgICB9DQogICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fT3V0cHV0T3B0aW9uSXRlbXNPZkNhdGVnb3JpZXMnXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgJGZwcmV0dXJuID0gJGZwbmFtZSgkZGVmYXVsdCwgJHR6LCAkdHlwZSk7DQogICAgICAgIGlmICgkZnBzaWduYWwgPT0gUExVR0lOX0VYSVRTSUdOQUxfUkVUVVJOKSB7DQogICAgICAgICAgICAkZnBzaWduYWwgPSBQTFVHSU5fRVhJVFNJR05BTF9OT05FOw0KICAgICAgICAgICAgcmV0dXJuICRmcHJldHVybjsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGZvcmVhY2ggKCR0eiBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAkcyAuPSAnPG9wdGlvbiB2YWx1ZT0iJyAuICRrZXkgLiAnIiAnIC4gKCRkZWZhdWx0ID09ICRrZXkgPyAnc2VsZWN0ZWQ9InNlbGVjdGVkIicgOiAnJykgLiAnID4nIC4gJHZhbHVlIC4gJzwvb3B0aW9uPic7DQogICAgfQ0KICAgIHJldHVybiAkczsNCn0NCg0KLyoqDQogKiDnlJ/miJDmqKHmnb9zZWxlY3TooajljZUuDQogKg0KICogQHBhcmFtICRkZWZhdWx0DQogKiBAcGFyYW0gJHJlZnVzZV9maWxlX2ZpbHRlcg0KICogQHBhcmFtICRhY2NlcHRfdHlwZQ0KICoNCiAqIEByZXR1cm4gbnVsbHxzdHJpbmcNCiAqLw0KZnVuY3Rpb24gT3V0cHV0T3B0aW9uSXRlbXNPZlRlbXBsYXRlKCRkZWZhdWx0LCAkcmVmdXNlX2ZpbGVfZmlsdGVyID0gYXJyYXkoKSwgJGFjY2VwdF90eXBlID0gYXJyYXkoKSkNCnsNCiAgICBnbG9iYWwgJHpicDsNCiAgICAkdGVzdFJlZ0V4cCA9ICIvXihcLnxwb3N0LXxtb2R1bGV8aGVhZGVyfGZvb3Rlcnxjb21tZW50fHNpZGViYXJ8cGFnZWJhcnxbYS16QS1aXVxfKS9zaSI7DQogICAgJHMgPSBudWxsOw0KICAgICR0eiA9IGFycmF5KCk7DQogICAgJHR6WycnXSA9ICR6YnAtPmxhbmdbJ21zZyddWydub25lJ107DQoNCiAgICAvL3R5cGUgPSBsaXN0LHNpbmdsZSxhcnRpY2xlLHBhZ2UsY2F0ZWdvcnksdGFnLGF1dGhvcixkYXRl77yM5Y+v5Lul5bm25YiX5aSa5LiqDQoNCiAgICBmb3JlYWNoICgkemJwLT50ZW1wbGF0ZS0+dGVtcGxhdGVzIGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgIGlmIChwcmVnX21hdGNoKCR0ZXN0UmVnRXhwLCAka2V5KSkgew0KICAgICAgICAgICAgY29udGludWU7DQogICAgICAgIH0NCg0KICAgICAgICAkYiA9IGZhbHNlOw0KICAgICAgICBmb3JlYWNoICgkcmVmdXNlX2ZpbGVfZmlsdGVyIGFzICRrZXkyID0+ICR2YWx1ZTIpIHsNCiAgICAgICAgICAgICR0ZXN0UmVnRXhwMiA9ICIvLiooJHZhbHVlMikvc2kiOw0KICAgICAgICAgICAgaWYgKHByZWdfbWF0Y2goJHRlc3RSZWdFeHAyLCAka2V5KSkgew0KICAgICAgICAgICAgICAgICRiID0gdHJ1ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBpZiAoJGIgPT0gdHJ1ZSkgew0KICAgICAgICAgICAgY29udGludWU7DQogICAgICAgIH0NCg0KICAgICAgICAkbmFtZSA9ICR6YnAtPnRlbXBsYXRlLT50ZW1wbGF0ZXNfTmFtZVska2V5XTsNCiAgICAgICAgJHR5cGUgPSAkemJwLT50ZW1wbGF0ZS0+dGVtcGxhdGVzX1R5cGVbJGtleV07DQogICAgICAgICR0eXBlQXJyYXkgPSBleHBsb2RlKCd8JywgJHR5cGUpOw0KDQogICAgICAgIGlmIChzdHJ0b2xvd2VyKCR0eXBlKSA9PSAnbm9uZScpIHsNCiAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICB9DQoNCiAgICAgICAgLy/liKTmlq3kuLvpopjmmK/lkKblr7nmqKHmnb/ov5vooYzkuoZUZW1wbGF0ZSBUeXBl5qCH5rOoDQogICAgICAgIGlmICgkemJwLT50ZW1wbGF0ZS0+aXN1c2VfbmFtZWFuZHR5cGUgPT0gdHJ1ZSkgey8v55SoJGFjY2VwdF90eXBl5Y675qOA5p+lJHR5cGVBcnJhee+8jOS4uuecnyRj5bCx5pivdHJ1ZeWwseWPr+S7peaUvuWFpeWIl+ihqA0KICAgICAgICAgICAgJGMgPSBmYWxzZTsNCiAgICAgICAgICAgIGZvcmVhY2ggKCRhY2NlcHRfdHlwZSBhcyAkazEgPT4gJHYxKSB7DQogICAgICAgICAgICAgICAgZm9yZWFjaCAoJHR5cGVBcnJheSBhcyAkazIgPT4gJHYyKSB7DQogICAgICAgICAgICAgICAgICAgIGlmIChzdHJ0b2xvd2VyKHRyaW0oJHYxKSkgPT0gc3RydG9sb3dlcih0cmltKCR2MikpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAkYyA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoJGMpIHsNCiAgICAgICAgICAgICAgICBpZiAoJGRlZmF1bHQgPT0gJGtleSkgew0KICAgICAgICAgICAgICAgICAgICAkczIgPSAoJG5hbWUgIT09ICcnKSA/ICcgKCcgLiAkbmFtZSAuICcpJyA6ICRuYW1lOw0KICAgICAgICAgICAgICAgICAgICAkdHpbJGtleV0gPSAnWycgLiAkemJwLT5sYW5nWydtc2cnXVsnY3VycmVudF90ZW1wbGF0ZSddIC4gJ10gJyAuICRrZXkgLiAkczI7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgJHMyID0gKCRuYW1lICE9PSAnJykgPyAnICgnIC4gJG5hbWUgLiAnKScgOiAkbmFtZTsNCiAgICAgICAgICAgICAgICAgICAgJHR6WyRrZXldID0gJGtleSAuICRzMjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSB7IC8v5rKh5pyJ5qCH5rOo5bCx55So5Lyg57uf5pa55rOVDQogICAgICAgICAgICBpZiAoJGRlZmF1bHQgPT0gJGtleSkgew0KICAgICAgICAgICAgICAgICRzMiA9ICgkbmFtZSAhPT0gJycpID8gJyAoJyAuICRuYW1lIC4gJyknIDogJG5hbWU7DQogICAgICAgICAgICAgICAgJHR6WyRrZXldID0gJ1snIC4gJHpicC0+bGFuZ1snbXNnJ11bJ2N1cnJlbnRfdGVtcGxhdGUnXSAuICddICcgLiAka2V5IC4gJHMyOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAkczIgPSAoJG5hbWUgIT09ICcnKSA/ICcgKCcgLiAkbmFtZSAuICcpJyA6ICRuYW1lOw0KICAgICAgICAgICAgICAgICR0elska2V5XSA9ICRrZXkgLiAkczI7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9PdXRwdXRPcHRpb25JdGVtc09mVGVtcGxhdGUnXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgJGZwcmV0dXJuID0gJGZwbmFtZSgkZGVmYXVsdCwgJHR6LCAkcmVmdXNlX2ZpbGVfZmlsdGVyLCAkYWNjZXB0X3R5cGUpOw0KICAgICAgICBpZiAoJGZwc2lnbmFsID09IFBMVUdJTl9FWElUU0lHTkFMX1JFVFVSTikgew0KICAgICAgICAgICAgJGZwc2lnbmFsID0gUExVR0lOX0VYSVRTSUdOQUxfTk9ORTsNCiAgICAgICAgICAgIHJldHVybiAkZnByZXR1cm47DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBmb3JlYWNoICgkdHogYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgJHMgLj0gJzxvcHRpb24gdmFsdWU9IicgLiAka2V5IC4gJyIgJyAuICgkZGVmYXVsdCA9PSAka2V5ID8gJ3NlbGVjdGVkPSJzZWxlY3RlZCInIDogJycpIC4gJyA+JyAuICR2YWx1ZSAuICc8L29wdGlvbj4nOw0KICAgIH0NCiAgICByZXR1cm4gJHM7DQp9DQoNCi8qKg0KICog55Sf5oiQ55So5oi3562J57qnc2VsZWN06KGo5Y2VLg0KICoNCiAqIEBwYXJhbSAkZGVmYXVsdA0KICoNCiAqIEByZXR1cm4gbnVsbHxzdHJpbmcNCiAqLw0KZnVuY3Rpb24gT3V0cHV0T3B0aW9uSXRlbXNPZk1lbWJlckxldmVsKCRkZWZhdWx0KQ0Kew0KICAgIGdsb2JhbCAkemJwOw0KDQogICAgJHMgPSBudWxsOw0KICAgICR0eiA9IGFycmF5KCk7DQogICAgaWYgKCEkemJwLT5DaGVja1JpZ2h0cygnTWVtYmVyQWxsJykpIHsNCiAgICAgICAgJHR6WyRkZWZhdWx0XSA9ICR6YnAtPmxhbmdbJ3VzZXJfbGV2ZWxfbmFtZSddWyRkZWZhdWx0XTsNCiAgICB9IGVsc2Ugew0KICAgICAgICBmb3IgKCRpID0gMTsgJGkgPCAoY291bnQoJHpicC0+bGFuZ1sndXNlcl9sZXZlbF9uYW1lJ10pICsgMSk7ICRpKyspIHsNCiAgICAgICAgICAgICR0elskaV0gPSAkemJwLT5sYW5nWyd1c2VyX2xldmVsX25hbWUnXVskaV07DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9PdXRwdXRPcHRpb25JdGVtc09mTWVtYmVyTGV2ZWwnXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgJGZwcmV0dXJuID0gJGZwbmFtZSgkZGVmYXVsdCk7DQogICAgICAgIGlmICgkZnBzaWduYWwgPT0gUExVR0lOX0VYSVRTSUdOQUxfUkVUVVJOKSB7DQogICAgICAgICAgICAkZnBzaWduYWwgPSBQTFVHSU5fRVhJVFNJR05BTF9OT05FOw0KICAgICAgICAgICAgcmV0dXJuICRmcHJldHVybjsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGZvcmVhY2ggKCR0eiBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAkcyAuPSAnPG9wdGlvbiB2YWx1ZT0iJyAuICRrZXkgLiAnIiAnIC4gKCRkZWZhdWx0ID09ICRrZXkgPyAnc2VsZWN0ZWQ9InNlbGVjdGVkIicgOiAnJykgLiAnID4nIC4gJHZhbHVlIC4gJzwvb3B0aW9uPic7DQogICAgfQ0KICAgIHJldHVybiAkczsNCn0NCg0KLyoqDQogKiDnlJ/miJDnlKjmiLdzZWxlY3TooajljZUuDQogKg0KICogQHBhcmFtICRkZWZhdWx0DQogKg0KICogQHJldHVybiBudWxsfHN0cmluZw0KICovDQpmdW5jdGlvbiBPdXRwdXRPcHRpb25JdGVtc09mTWVtYmVyKCRkZWZhdWx0KQ0Kew0KICAgIGdsb2JhbCAkemJwOw0KDQogICAgJHMgPSBudWxsOw0KICAgICR0eiA9IGFycmF5KCk7DQoNCiAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9PdXRwdXRPcHRpb25JdGVtc09mTWVtYmVyX0JlZ2luJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICRmcHJldHVybiA9ICRmcG5hbWUoJGRlZmF1bHQsICR0eik7DQogICAgICAgIGlmICgkZnBzaWduYWwgPT0gUExVR0lOX0VYSVRTSUdOQUxfUkVUVVJOKSB7DQogICAgICAgICAgICAkZnBzaWduYWwgPSBQTFVHSU5fRVhJVFNJR05BTF9OT05FOw0KICAgICAgICAgICAgcmV0dXJuICRmcHJldHVybjsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGlmICghJHpicC0+Q2hlY2tSaWdodHMoJ0FydGljbGVBbGwnKSkgew0KICAgICAgICBpZiAoIWlzc2V0KCR6YnAtPm1lbWJlcnNbJGRlZmF1bHRdKSkgew0KICAgICAgICAgICAgJHR6WzBdID0gJyc7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkdHpbJGRlZmF1bHRdID0gJHpicC0+bWVtYmVyc1skZGVmYXVsdF0tPk5hbWU7DQogICAgICAgIH0NCiAgICB9IGVsc2Ugew0KICAgICAgICBmb3IgKCRpID0gMTsgJGkgPCAoY291bnQoJHpicC0+bGFuZ1sndXNlcl9sZXZlbF9uYW1lJ10pICsgMSk7ICRpKyspIHsNCiAgICAgICAgICAgIGlmICgkemJwLT5DaGVja1JpZ2h0c0J5TGV2ZWwoJ0FydGljbGVFZHQnLCAkaSkgPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICAkemJwLT5Mb2FkTWVtYmVycygkaSk7DQogICAgICAgICRtZW1iZXJieW5hbWUgPSBhcnJheSgpOw0KICAgICAgICBmb3JlYWNoICgkemJwLT5tZW1iZXJzIGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICAgICBpZiAoJHpicC0+Q2hlY2tSaWdodHNCeUxldmVsKCdBcnRpY2xlRWR0JywgJHpicC0+bWVtYmVyc1ska2V5XS0+TGV2ZWwpKSB7DQogICAgICAgICAgICAgICAgJG1lbWJlcmJ5bmFtZVskemJwLT5tZW1iZXJzWyRrZXldLT5OYW1lXSA9ICR6YnAtPm1lbWJlcnNbJGtleV0tPklEOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGtzb3J0KCRtZW1iZXJieW5hbWUpOw0KICAgICAgICBmb3JlYWNoICgkbWVtYmVyYnluYW1lIGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICAgICAkdHpbJHZhbHVlXSA9ICRrZXk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9PdXRwdXRPcHRpb25JdGVtc09mTWVtYmVyJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICRmcHJldHVybiA9ICRmcG5hbWUoJGRlZmF1bHQsICR0eik7DQogICAgICAgIGlmICgkZnBzaWduYWwgPT0gUExVR0lOX0VYSVRTSUdOQUxfUkVUVVJOKSB7DQogICAgICAgICAgICAkZnBzaWduYWwgPSBQTFVHSU5fRVhJVFNJR05BTF9OT05FOw0KICAgICAgICAgICAgcmV0dXJuICRmcHJldHVybjsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGZvcmVhY2ggKCR0eiBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAkcyAuPSAnPG9wdGlvbiB2YWx1ZT0iJyAuICRrZXkgLiAnIiAnIC4gKCRkZWZhdWx0ID09ICRrZXkgPyAnc2VsZWN0ZWQ9InNlbGVjdGVkIicgOiAnJykgLiAnID4nIC4gJHZhbHVlIC4gJzwvb3B0aW9uPic7DQogICAgfQ0KICAgIHJldHVybiAkczsNCn0NCg0KLyoqDQogKiDnlJ/miJDmlofnq6BJc1RvcOeKtuaAgXNlbGVjdOihqOWNlS4NCiAqDQogKiBAcGFyYW0gJGRlZmF1bHQNCiAqDQogKiBAcmV0dXJuIG51bGx8c3RyaW5nDQogKi8NCmZ1bmN0aW9uIE91dHB1dE9wdGlvbkl0ZW1zT2ZJc1RvcCgkZGVmYXVsdCkNCnsNCiAgICBnbG9iYWwgJHpicDsNCg0KICAgICRzID0gbnVsbDsNCiAgICAkdHogPSBhcnJheSgpOw0KICAgICR0elswXSA9ICR6YnAtPmxhbmdbJ21zZyddWydub25lJ107DQogICAgJHR6WzJdID0gJHpicC0+bGFuZ1snbXNnJ11bJ3RvcF9pbmRleCddOw0KICAgICR0elsxXSA9ICR6YnAtPmxhbmdbJ21zZyddWyd0b3BfZ2xvYmFsJ107DQogICAgJHR6WzRdID0gJHpicC0+bGFuZ1snbXNnJ11bJ3RvcF9jYXRlZ29yeSddOw0KDQogICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fT3V0cHV0T3B0aW9uSXRlbXNPZklzVG9wJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICRmcHJldHVybiA9ICRmcG5hbWUoJGRlZmF1bHQsICR0eik7DQogICAgICAgIGlmICgkZnBzaWduYWwgPT0gUExVR0lOX0VYSVRTSUdOQUxfUkVUVVJOKSB7DQogICAgICAgICAgICAkZnBzaWduYWwgPSBQTFVHSU5fRVhJVFNJR05BTF9OT05FOw0KICAgICAgICAgICAgcmV0dXJuICRmcHJldHVybjsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGZvcmVhY2ggKCR0eiBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAkcyAuPSAnPG9wdGlvbiB2YWx1ZT0iJyAuICRrZXkgLiAnIiAnIC4gKCRkZWZhdWx0ID09ICRrZXkgPyAnc2VsZWN0ZWQ9InNlbGVjdGVkIicgOiAnJykgLiAnID4nIC4gJHZhbHVlIC4gJzwvb3B0aW9uPic7DQogICAgfQ0KDQogICAgcmV0dXJuICRzOw0KfQ0KDQovKioNCiAqIOeUn+aIkOaWh+eroOWPkeW4g+eKtuaAgXNlbGVjdOihqOWNlS4NCiAqDQogKiBAcGFyYW0gJGRlZmF1bHQNCiAqDQogKiBAcmV0dXJuIG51bGx8c3RyaW5nDQogKi8NCmZ1bmN0aW9uIE91dHB1dE9wdGlvbkl0ZW1zT2ZQb3N0U3RhdHVzKCRkZWZhdWx0KQ0Kew0KICAgIGdsb2JhbCAkemJwOw0KDQogICAgJHMgPSAnJzsNCiAgICAkdHogPSBhcnJheSgpOw0KICAgIGlmICghJHpicC0+Q2hlY2tSaWdodHMoJ0FydGljbGVQdWInKSAmJiAkZGVmYXVsdCA9PSAyKSB7DQogICAgICAgICR0elsyXSA9ICR6YnAtPmxhbmdbJ3Bvc3Rfc3RhdHVzX25hbWUnXVsnMiddOw0KICAgIH0gZWxzZWlmICghJHpicC0+Q2hlY2tSaWdodHMoJ0FydGljbGVBbGwnKSAmJiAkZGVmYXVsdCA9PSAyKSB7DQogICAgICAgICR0elsyXSA9ICR6YnAtPmxhbmdbJ3Bvc3Rfc3RhdHVzX25hbWUnXVsnMiddOw0KICAgIH0gZWxzZSB7DQogICAgICAgICR0elswXSA9ICR6YnAtPmxhbmdbJ3Bvc3Rfc3RhdHVzX25hbWUnXVsnMCddOw0KICAgICAgICAkdHpbMV0gPSAkemJwLT5sYW5nWydwb3N0X3N0YXR1c19uYW1lJ11bJzEnXTsNCiAgICAgICAgaWYgKCR6YnAtPkNoZWNrUmlnaHRzKCdBcnRpY2xlQWxsJykpIHsNCiAgICAgICAgICAgICR0elsyXSA9ICR6YnAtPmxhbmdbJ3Bvc3Rfc3RhdHVzX25hbWUnXVsnMiddOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fT3V0cHV0T3B0aW9uSXRlbXNPZlBvc3RTdGF0dXMnXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgJGZwcmV0dXJuID0gJGZwbmFtZSgkZGVmYXVsdCwgJHR6KTsNCiAgICAgICAgaWYgKCRmcHNpZ25hbCA9PSBQTFVHSU5fRVhJVFNJR05BTF9SRVRVUk4pIHsNCiAgICAgICAgICAgICRmcHNpZ25hbCA9IFBMVUdJTl9FWElUU0lHTkFMX05PTkU7DQogICAgICAgICAgICByZXR1cm4gJGZwcmV0dXJuOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgZm9yZWFjaCAoJHR6IGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICRzIC49ICc8b3B0aW9uIHZhbHVlPSInIC4gJGtleSAuICciICcgLiAoJGRlZmF1bHQgPT0gJGtleSA/ICdzZWxlY3RlZD0ic2VsZWN0ZWQiJyA6ICcnKSAuICcgPicgLiAkdmFsdWUgLiAnPC9vcHRpb24+JzsNCiAgICB9DQoNCiAgICByZXR1cm4gJHM7DQp9DQoNCi8qKg0KICog5Yib5bu6RGl25qih5Z2XLg0KICoNCiAqIEBwYXJhbSAkbQ0KICogQHBhcmFtIGJvb2wgJGJ1dHRvbg0KICovDQpmdW5jdGlvbiBDcmVhdGVNb2R1bGVEaXYoJG0sICRidXR0b24gPSB0cnVlKQ0Kew0KICAgIGdsb2JhbCAkemJwOw0KDQogICAgZWNobyAnPGRpdiBjbGFzcz0id2lkZ2V0IHdpZGdldF9zb3VyY2VfJyAuICRtLT5Tb3VyY2VUeXBlIC4gJyB3aWRnZXRfaWRfJyAuICRtLT5GaWxlTmFtZSAuICciPic7DQogICAgZWNobyAnPGRpdiBjbGFzcz0id2lkZ2V0LXRpdGxlIj48aSBjbGFzcz0iaWNvbi1sYXlvdXQtd3RmIG1vZHVsZS1pY29uIj48L2k+JyAuICgoJG0tPlNvdXJjZVR5cGUgIT0gJ3RoZW1laW5jbHVkZScpID8gJG0tPk5hbWUgOiAkbS0+RmlsZU5hbWUpIC4gJyc7DQoNCiAgICBpZiAoJGJ1dHRvbikgew0KICAgICAgICBlY2hvICc8c3BhbiBjbGFzcz0id2lkZ2V0LWFjdGlvbiI+PGEgaHJlZj0iLi4vY21kLnBocD9hY3Q9TW9kdWxlRWR0JmFtcDtpZD0nIC4gJG0tPklEIC4gJyI+PGkgY2xhc3M9Imljb24tcGVuY2lsLXNxdWFyZSI+PC9pPjwvYT4nOw0KDQogICAgICAgIGlmICgkbS0+U291cmNlVHlwZSA9PSAndXNlcicgfHwgJG0tPlNvdXJjZVR5cGUgPT0gJ3RoZW1laW5jbHVkZScpIHsNCiAgICAgICAgICAgIGVjaG8gJyZuYnNwOzxhIG9uY2xpY2s9InJldHVybiB3aW5kb3cuY29uZmlybShcJycgLiBzdHJfcmVwbGFjZShhcnJheSgnIicsJ1wnJyksICcnLCAkemJwLT5sYW5nWydtc2cnXVsnY29uZmlybV9vcGVyYXRpbmcnXSkgLiAnXCcpOyIgaHJlZj0iJyAuIEJ1aWxkU2FmZUNtZFVSTCgnYWN0PU1vZHVsZURlbCZhbXA7aWQ9JyAuICRtLT5JRCkgLiAnIj48aSBjbGFzcz0iaWNvbi10cmFzaCI+PC9pPjwvYT4nOw0KICAgICAgICB9DQogICAgICAgIGVjaG8gJzwvc3Bhbj4nOw0KICAgIH0NCg0KICAgIGVjaG8gJzwvZGl2Pic7DQogICAgZWNobyAnPGRpdiBjbGFzcz0iZnVuaWQiIHN0eWxlPSJkaXNwbGF5Om5vbmUiPicgLiAkbS0+RmlsZU5hbWUgLiAnPC9kaXY+JzsNCiAgICBlY2hvICc8L2Rpdj4nOw0KfQ0KDQovKioNCiAqIOeUn+aIkFRZUEVzZWxlY3TooajljZUuDQogKg0KICogQHBhcmFtICRkZWZhdWx0DQogKg0KICogQHJldHVybiBudWxsfHN0cmluZw0KICovDQpmdW5jdGlvbiBPdXRwdXRPcHRpb25JdGVtc09mUG9zdFR5cGUoJGRlZmF1bHQpDQp7DQogICAgZ2xvYmFsICR6YnA7DQogICAgJHMgPSBudWxsOw0KICAgICR0eiA9IGFycmF5KCk7DQoNCiAgICBmb3JlYWNoICgkemJwLT5wb3N0dHlwZSBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAkdHpbJGtleV0gPSAkdmFsdWVbMF07DQogICAgfQ0KDQogICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fT3V0cHV0T3B0aW9uSXRlbXNPZkNvbW1vbiddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAkZnByZXR1cm4gPSAkZnBuYW1lKCRkZWZhdWx0LCAkdHosICdQb3N0VHlwZScpOw0KICAgICAgICBpZiAoJGZwc2lnbmFsID09IFBMVUdJTl9FWElUU0lHTkFMX1JFVFVSTikgew0KICAgICAgICAgICAgJGZwc2lnbmFsID0gUExVR0lOX0VYSVRTSUdOQUxfTk9ORTsNCiAgICAgICAgICAgIHJldHVybiAkZnByZXR1cm47DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBmb3JlYWNoICgkdHogYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgJHMgLj0gJzxvcHRpb24gdmFsdWU9IicgLiAka2V5IC4gJyIgJyAuICgkZGVmYXVsdCA9PSAka2V5ID8gJ3NlbGVjdGVkPSJzZWxlY3RlZCInIDogJycpIC4gJyA+JyAuICR2YWx1ZSAuICc8L29wdGlvbj4nOw0KICAgIH0NCiAgICByZXR1cm4gJHM7DQp9DQoNCi8qKg0KICog55Sf5oiQ5pe25Yy6c2VsZWN06KGo5Y2VLg0KICoNCiAqIEBwYXJhbSAkZGVmYXVsdA0KICoNCiAqIEByZXR1cm4gc3RyaW5nDQogKi8NCmZ1bmN0aW9uIENyZWF0ZU9wdGlvbnNPZlRpbWVab25lKCRkZWZhdWx0KQ0Kew0KICAgICRzID0gJyc7DQogICAgJHR6ID0gYXJyYXkoDQogICAgICAgICdFdGMvR01UKzEyJyAgICAgICAgICAgICAgICAgICAgID0+ICctMTI6MDAnLA0KICAgICAgICAnUGFjaWZpYy9NaWR3YXknICAgICAgICAgICAgICAgICA9PiAnLTExOjAwJywNCiAgICAgICAgJ1BhY2lmaWMvSG9ub2x1bHUnICAgICAgICAgICAgICAgPT4gJy0xMDowMCcsDQogICAgICAgICdBbWVyaWNhL0FuY2hvcmFnZScgICAgICAgICAgICAgID0+ICctMDk6MDAnLA0KICAgICAgICAnQW1lcmljYS9Mb3NfQW5nZWxlcycgICAgICAgICAgICA9PiAnLTA4OjAwJywNCiAgICAgICAgJ0FtZXJpY2EvRGVudmVyJyAgICAgICAgICAgICAgICAgPT4gJy0wNzowMCcsDQogICAgICAgICdBbWVyaWNhL1RlZ3VjaWdhbHBhJyAgICAgICAgICAgID0+ICctMDY6MDAnLA0KICAgICAgICAnQW1lcmljYS9OZXdfWW9yaycgICAgICAgICAgICAgICA9PiAnLTA1OjAwJywNCiAgICAgICAgJ0FtZXJpY2EvSGFsaWZheCcgICAgICAgICAgICAgICAgPT4gJy0wNDowMCcsDQogICAgICAgICdBbWVyaWNhL0FyZ2VudGluYS9CdWVub3NfQWlyZXMnID0+ICctMDM6MDAnLA0KICAgICAgICAnQXRsYW50aWMvU291dGhfR2VvcmdpYScgICAgICAgICA9PiAnLTAyOjAwJywNCiAgICAgICAgJ0F0bGFudGljL0F6b3JlcycgICAgICAgICAgICAgICAgPT4gJy0wMTowMCcsDQogICAgICAgICdVVEMnICAgICAgICAgICAgICAgICAgICAgICAgICAgID0+ICcwMDowMCcsDQogICAgICAgICdFdXJvcGUvQmVybGluJyAgICAgICAgICAgICAgICAgID0+ICcrMDE6MDAnLA0KICAgICAgICAnRXVyb3BlL1NvZmlhJyAgICAgICAgICAgICAgICAgICA9PiAnKzAyOjAwJywNCiAgICAgICAgJ0FmcmljYS9OYWlyb2JpJyAgICAgICAgICAgICAgICAgPT4gJyswMzowMCcsDQogICAgICAgICdFdXJvcGUvTW9zY293JyAgICAgICAgICAgICAgICAgID0+ICcrMDQ6MDAnLA0KICAgICAgICAnQXNpYS9LYXJhY2hpJyAgICAgICAgICAgICAgICAgICA9PiAnKzA1OjAwJywNCiAgICAgICAgJ0FzaWEvRGhha2EnICAgICAgICAgICAgICAgICAgICAgPT4gJyswNjowMCcsDQogICAgICAgICdBc2lhL0Jhbmdrb2snICAgICAgICAgICAgICAgICAgID0+ICcrMDc6MDAnLA0KICAgICAgICAnQXNpYS9TaGFuZ2hhaScgICAgICAgICAgICAgICAgICA9PiAnKzA4OjAwJywNCiAgICAgICAgJ0FzaWEvVG9reW8nICAgICAgICAgICAgICAgICAgICAgPT4gJyswOTowMCcsDQogICAgICAgICdQYWNpZmljL0d1YW0nICAgICAgICAgICAgICAgICAgID0+ICcrMTA6MDAnLA0KICAgICAgICAnQXVzdHJhbGlhL1N5ZG5leScgICAgICAgICAgICAgICA9PiAnKzExOjAwJywNCiAgICAgICAgJ1BhY2lmaWMvRmlqaScgICAgICAgICAgICAgICAgICAgPT4gJysxMjowMCcsDQogICAgICAgICdQYWNpZmljL1RvbmdhdGFwdScgICAgICAgICAgICAgID0+ICcrMTM6MDAnLA0KICAgICk7DQoNCiAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9PdXRwdXRPcHRpb25JdGVtc09mQ29tbW9uJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICRmcHJldHVybiA9ICRmcG5hbWUoJGRlZmF1bHQsICR0eiwgJ1RpbWVab25lJyk7DQogICAgICAgIGlmICgkZnBzaWduYWwgPT0gUExVR0lOX0VYSVRTSUdOQUxfUkVUVVJOKSB7DQogICAgICAgICAgICAkZnBzaWduYWwgPSBQTFVHSU5fRVhJVFNJR05BTF9OT05FOw0KICAgICAgICAgICAgcmV0dXJuICRmcHJldHVybjsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGZvcmVhY2ggKCR0eiBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAkcyAuPSAnPG9wdGlvbiB2YWx1ZT0iJyAuICRrZXkgLiAnIiAnIC4gKCRkZWZhdWx0ID09ICRrZXkgPyAnc2VsZWN0ZWQ9InNlbGVjdGVkIicgOiAnJykgLiAnID4nIC4gJGtleSAuICcgJyAuICR2YWx1ZSAuICc8L29wdGlvbj4nOw0KICAgIH0NCg0KICAgIHJldHVybiAkczsNCn0NCg0KLyoqDQogKiDnlJ/miJDor63oqIBzZWxlY3TooajljZUuDQogKg0KICogQHBhcmFtICRkZWZhdWx0DQogKg0KICogQHJldHVybiBzdHJpbmcNCiAqLw0KZnVuY3Rpb24gQ3JlYXRlT3B0aW9uc09mTGFuZygkZGVmYXVsdCkNCnsNCiAgICBnbG9iYWwgJHpicDsNCiAgICAkcyA9ICcnOw0KICAgICRkaXIgPSAkemJwLT51c2Vyc2RpciAuICdsYW5ndWFnZS8nOw0KICAgICRmaWxlcyA9IEdldEZpbGVzSW5EaXIoJGRpciwgJ3BocCcpOw0KICAgICR0eiA9IGFycmF5KCk7DQogICAgZm9yZWFjaCAoJGZpbGVzIGFzICRmKSB7DQogICAgICAgIGlmIChzdWJzdHIoJGYsIDAsIDEpICE9PSAnLicgJiYgc3Vic3RyKCRmLCAwLCAxKSAhPT0gJ18nKSB7DQogICAgICAgICAgICAkbiA9IGJhc2VuYW1lKCRmLCAnLnBocCcpOw0KICAgICAgICAgICAgLy9maXggMS4zIHRvIDEuNCB3YXJuaW5nDQogICAgICAgICAgICBpZiAoJ1NpbXBDaGluZXNlJyA9PSAkbikgew0KICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoJ1RyYWRDaGluZXNlJyA9PSAkbikgew0KICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAkdCA9IGluY2x1ZGUgJGY7DQogICAgICAgICAgICAkdHpbJG5dID0gJHRbJ2xhbmdfbmFtZSddIC4gJyAoJyAuICRuIC4gJyknOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fT3V0cHV0T3B0aW9uSXRlbXNPZkNvbW1vbiddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAkZnByZXR1cm4gPSAkZnBuYW1lKCRkZWZhdWx0LCAkdHosICdMYW5nJyk7DQogICAgICAgIGlmICgkZnBzaWduYWwgPT0gUExVR0lOX0VYSVRTSUdOQUxfUkVUVVJOKSB7DQogICAgICAgICAgICAkZnBzaWduYWwgPSBQTFVHSU5fRVhJVFNJR05BTF9OT05FOw0KICAgICAgICAgICAgcmV0dXJuICRmcHJldHVybjsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGZvcmVhY2ggKCR0eiBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAkcyAuPSAnPG9wdGlvbiB2YWx1ZT0iJyAuICRrZXkgLiAnIiAnIC4gKCRkZWZhdWx0ID09ICRrZXkgPyAnc2VsZWN0ZWQ9InNlbGVjdGVkIicgOiAnJykgLiAnID4nIC4gJGtleSAuICcgJyAuICR2YWx1ZSAuICc8L29wdGlvbj4nOw0KICAgIH0NCiAgICByZXR1cm4gJHM7DQp9DQoNCi8qKg0KICog55Sf5oiQR3Vlc3RUeXBl6KGo5Y2VLg0KICoNCiAqIEBwYXJhbSAkZGVmYXVsdA0KICoNCiAqIEByZXR1cm4gc3RyaW5nDQogKi8NCmZ1bmN0aW9uIENyZWF0ZU9wdGlvbnNPZkd1ZXN0SVBUeXBlKCRkZWZhdWx0KQ0Kew0KICAgIGdsb2JhbCAkemJwOw0KICAgICRzID0gJyc7DQogICAgJHR6ID0gYXJyYXkoDQogICAgICAgICdSRU1PVEVfQUREUicgICAgICAgICAgICAgICAgICAgID0+ICdSRU1PVEVfQUREUiAoJyAuICR6YnAtPmxhbmdbJ21zZyddWydkZWZhdWx0J10gLiAnKSAnIC4gR2V0VmFycygnUkVNT1RFX0FERFInLCAnU0VSVkVSJyksDQogICAgICAgICdIVFRQX1hfRk9SV0FSREVEX0ZPUicgICAgICAgICAgID0+ICdIVFRQX1hfRk9SV0FSREVEX0ZPUiAo6IW+6K6v5LqRLOmYv+mHjOS6kSzkuIPniZspICcgLiBHZXRWYXJzKCdIVFRQX1hfRk9SV0FSREVEX0ZPUicsICdTRVJWRVInKSwNCiAgICAgICAgJ0hUVFBfWF9SRUFMX0lQJyAgICAgICAgICAgICAgICAgPT4gJ0hUVFBfWF9SRUFMX0lQICjlj4jmi43kupEs55m+5bqmQ0ROKScgLiBHZXRWYXJzKCdIVFRQX1hfUkVBTF9JUCcsICdTRVJWRVInKSwNCiAgICAgICAgJ0hUVFBfQ0ZfQ09OTkVDVElOR19JUCcgICAgICAgICAgPT4gJ0hUVFBfQ0ZfQ09OTkVDVElOR19JUCAoQ2xvdWRGbGFyZSkgJyAuIEdldFZhcnMoJ0hUVFBfQ0ZfQ09OTkVDVElOR19JUCcsICdTRVJWRVInKSwNCiAgICAgICAgJ0hUVFBfQ0xJRU5UX0lQJyAgICAgICAgICAgICAgICAgPT4gJ0hUVFBfQ0xJRU5UX0lQICcgLiBHZXRWYXJzKCdIVFRQX0NMSUVOVF9JUCcsICdTRVJWRVInKSwNCiAgICApOw0KDQogICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fT3V0cHV0T3B0aW9uSXRlbXNPZkNvbW1vbiddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAkZnByZXR1cm4gPSAkZnBuYW1lKCRkZWZhdWx0LCAkdHosICdHdWVzdElQVHlwZScpOw0KICAgICAgICBpZiAoJGZwc2lnbmFsID09IFBMVUdJTl9FWElUU0lHTkFMX1JFVFVSTikgew0KICAgICAgICAgICAgJGZwc2lnbmFsID0gUExVR0lOX0VYSVRTSUdOQUxfTk9ORTsNCiAgICAgICAgICAgIHJldHVybiAkZnByZXR1cm47DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBmb3JlYWNoICgkdHogYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgJHMgLj0gJzxvcHRpb24gdmFsdWU9IicgLiAka2V5IC4gJyIgJyAuICgkZGVmYXVsdCA9PSAka2V5ID8gJ3NlbGVjdGVkPSJzZWxlY3RlZCInIDogJycpIC4gJyA+JyAuICR2YWx1ZSAuICc8L29wdGlvbj4nOw0KICAgIH0NCiAgICByZXR1cm4gJHM7DQp9DQoNCi8qKg0KICog55Sf5oiQ5o6S5bqP5oyJ6ZKuDQogKi8NCmZ1bmN0aW9uIE1ha2VPcmRlckJ1dHRvbigkaWQsICR1cmxydWxlLCAkb3JkZXJfZ2V0LCAkZGVmYXVsdCA9ICdhc2MnKQ0Kew0KICAgICRidXR0b25fb3JkZXJfaWRfY2xhc3MgPSAnJzsNCiAgICBpZiAoJG9yZGVyX2dldCA9PSAkaWQgLiAnX2FzYycgfHwgJG9yZGVyX2dldCA9PSAkaWQgLiAnX2Rlc2MnKSB7DQogICAgICAgICRidXR0b25fb3JkZXJfaWRfY2xhc3MgPSAnZWxlbWVudC12aXNpYmlsaXR5LXZpc2libGUtYWx3YXlzICc7DQogICAgfQ0KICAgIGlmICgkb3JkZXJfZ2V0ID09ICRpZCAuICdfYXNjJykgew0KICAgICAgICAkYnV0dG9uX29yZGVyX2lkX29yZGVyID0gJGlkIC4gJ19kZXNjJzsNCiAgICAgICAgJGJ1dHRvbl9vcmRlcl9pZF9pY29uID0gJ2ljb24tYXJyb3ctdXAtc2hvcnQnOw0KICAgICAgICAkYnV0dG9uX29yZGVyX2lkX2NsYXNzIC49ICdlbGVtZW50LXZpc2liaWxpdHktaGlkZGVuICc7DQogICAgfSBlbHNlaWYgKCRvcmRlcl9nZXQgPT0gJGlkIC4gJ19kZXNjJykgew0KICAgICAgICAkYnV0dG9uX29yZGVyX2lkX29yZGVyID0gJGlkIC4gJ19hc2MnOw0KICAgICAgICAkYnV0dG9uX29yZGVyX2lkX2ljb24gPSAnaWNvbi1hcnJvdy1kb3duLXNob3J0JzsNCiAgICAgICAgJGJ1dHRvbl9vcmRlcl9pZF9jbGFzcyAuPSAnZWxlbWVudC12aXNpYmlsaXR5LWhpZGRlbiAnOw0KICAgIH0gZWxzZSB7DQogICAgICAgIGlmICgkZGVmYXVsdCA9PSAnYXNjJykgew0KICAgICAgICAgICAgJGJ1dHRvbl9vcmRlcl9pZF9vcmRlciA9ICRpZCAuICdfYXNjJzsNCiAgICAgICAgICAgICRidXR0b25fb3JkZXJfaWRfaWNvbiA9ICdpY29uLWFycm93LWRvd24tc2hvcnQnOw0KICAgICAgICAgICAgJGJ1dHRvbl9vcmRlcl9pZF9jbGFzcyAuPSAnZWxlbWVudC12aXNpYmlsaXR5LWhpZGRlbiAnOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJGJ1dHRvbl9vcmRlcl9pZF9vcmRlciA9ICRpZCAuICdfZGVzYyc7DQogICAgICAgICAgICAkYnV0dG9uX29yZGVyX2lkX2ljb24gPSAnaWNvbi1hcnJvdy11cC1zaG9ydCc7DQogICAgICAgICAgICAkYnV0dG9uX29yZGVyX2lkX2NsYXNzIC49ICdlbGVtZW50LXZpc2liaWxpdHktaGlkZGVuICc7DQogICAgICAgIH0NCiAgICB9DQogICAgJHVybHJ1bGUtPlJ1bGVzWyd7JW9yZGVyJX0nXSA9ICRidXR0b25fb3JkZXJfaWRfb3JkZXI7DQogICAgJGJ1dHRvbl9vcmRlcl9pZCA9ICcgPGEgY2xhc3M9Im9yZGVyX2J1dHRvbiAnIC4gJGJ1dHRvbl9vcmRlcl9pZF9jbGFzcyAuICciIGhyZWY9IicgLiAkdXJscnVsZS0+TWFrZSgpIC4gJyI+PGkgc3R5bGU9ImZvbnQtc2l6ZTowLjc1ZW07IiBjbGFzcz0iJyAuICRidXR0b25fb3JkZXJfaWRfaWNvbiAuICciPjwvaT48L2E+JzsNCg0KICAgIHJldHVybiBhcnJheSgkYnV0dG9uX29yZGVyX2lkKTsNCn0NCg==</file>
	<file name='zb_system\function\c_system_function.php' crc32='3A18A67F'  dt:dt='bin.base64'>PD9waHANCi8qKg0KICog5Yqf6IO95Z6L55qE5Ye95pWwLg0KICovDQoNCmlmICghZGVmaW5lZCgnWkJQX1BBVEgnKSkgew0KICAgIGV4aXQoJ0FjY2VzcyBkZW5pZWQnKTsNCn0NCg0KLyoqDQogKiDojrflj5bmlofnq6AuDQogKg0KICogQHBhcmFtIG1peGVkICRpZG9ybmFtZSAgICDmlofnq6BpZCDmiJYg5ZCN56ew44CB5Yir5ZCNICgxLjfmlK/mjIHlpI3mnYLnmoRhcnJheeWPguaVsCwkY291bnTkuLphcnJheeaXtuWQjumdoueahOWPguaVsOWPr+S7peS4jeiuvikNCiAqIEBwYXJhbSBhcnJheSAkb3B0aW9uIHxudWxsDQogKg0KICogQHJldHVybiBQb3N0DQogKi8NCmZ1bmN0aW9uIEdldFBvc3QoJGlkb3JuYW1lLCAkb3B0aW9uID0gbnVsbCkNCnsNCiAgICAvL+aWsOeJiOacrOeahOS9v+eUqOivtOaYjuivt+eciw0KICAgIC8vaHR0cHM6Ly93aWtpLnpibG9nY24uY29tL2Rva3UucGhwP2lkPXpibG9ncGhwOmRldmVsb3BtZW50OmZ1bmN0aW9uczpnZXRwb3N0DQogICAgZ2xvYmFsICR6YnA7DQogICAgJHBvc3QgPSBudWxsOw0KICAgICRpZCA9IG51bGw7DQogICAgJHRpdGxlID0gbnVsbDsNCiAgICAkYWxpYXMgPSBudWxsOw0KICAgICR0aXRsZW9yYWxpYXMgPSBudWxsOw0KDQogICAgaWYgKGlzX2FycmF5KCRpZG9ybmFtZSkpIHsNCiAgICAgICAgJGFyZ3MgPSAkaWRvcm5hbWU7DQogICAgICAgIGlmIChhcnJheV9rZXlfZXhpc3RzKCdpZG9ybmFtZScsICRhcmdzKSkgew0KICAgICAgICAgICAgJGlkb3JuYW1lID0gJGFyZ3NbJ2lkb3JuYW1lJ107DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkaWRvcm5hbWUgPSBudWxsOw0KICAgICAgICB9DQogICAgICAgIGlmIChhcnJheV9rZXlfZXhpc3RzKCdpZCcsICRhcmdzKSkgew0KICAgICAgICAgICAgJGlkID0gJGFyZ3NbJ2lkJ107DQogICAgICAgICAgICB1bnNldCgkYXJnc1snaWQnXSk7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGFycmF5X2tleV9leGlzdHMoJ3RpdGxlJywgJGFyZ3MpKSB7DQogICAgICAgICAgICAkdGl0bGUgPSAkYXJnc1sndGl0bGUnXTsNCiAgICAgICAgICAgIHVuc2V0KCRhcmdzWyd0aXRsZSddKTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoYXJyYXlfa2V5X2V4aXN0cygnYWxpYXMnLCAkYXJncykpIHsNCiAgICAgICAgICAgICRhbGlhcyA9ICRhcmdzWydhbGlhcyddOw0KICAgICAgICAgICAgdW5zZXQoJGFyZ3NbJ2FsaWFzJ10pOw0KICAgICAgICB9DQogICAgICAgIGlmIChhcnJheV9rZXlfZXhpc3RzKCd0aXRsZW9yYWxpYXMnLCAkYXJncykpIHsNCiAgICAgICAgICAgICR0aXRsZW9yYWxpYXMgPSAkYXJnc1sndGl0bGVvcmFsaWFzJ107DQogICAgICAgICAgICB1bnNldCgkYXJnc1sndGl0bGVvcmFsaWFzJ10pOw0KICAgICAgICB9DQogICAgICAgIGlmIChhcnJheV9rZXlfZXhpc3RzKCdvcHRpb24nLCAkYXJncykpIHsNCiAgICAgICAgICAgICRvcHRpb24gPSAkYXJnc1snb3B0aW9uJ107DQogICAgICAgICAgICB1bnNldCgkYXJnc1snb3B0aW9uJ10pOw0KICAgICAgICB9DQogICAgICAgIGlmICghaXNfYXJyYXkoJG9wdGlvbikpIHsNCiAgICAgICAgICAgICRvcHRpb24gPSBhcnJheSgpOw0KICAgICAgICB9DQogICAgICAgICRvcHRpb24gPSBhcnJheV9tZXJnZSgkYXJncywgJG9wdGlvbik7DQogICAgICAgIHVuc2V0KCRhcmdzKTsNCiAgICB9DQoNCiAgICBpZiAoIWlzX2FycmF5KCRvcHRpb24pKSB7DQogICAgICAgICRvcHRpb24gPSBhcnJheSgpOw0KICAgIH0NCiAgICBpZiAoIWFycmF5X2tleV9leGlzdHMoJ3Bvc3RfdHlwZScsICRvcHRpb24pKSB7DQogICAgICAgICRvcHRpb25bJ3Bvc3RfdHlwZSddID0gbnVsbDsNCiAgICB9DQogICAgaWYgKCFhcnJheV9rZXlfZXhpc3RzKCdwb3N0X3N0YXR1cycsICRvcHRpb24pKSB7DQogICAgICAgICRvcHRpb25bJ3Bvc3Rfc3RhdHVzJ10gPSBudWxsOw0KICAgIH0NCiAgICBpZiAoIWFycmF5X2tleV9leGlzdHMoJ29ubHlfYXJ0aWNsZScsICRvcHRpb24pKSB7DQogICAgICAgICRvcHRpb25bJ29ubHlfYXJ0aWNsZSddID0gZmFsc2U7DQogICAgfQ0KICAgIGlmICghYXJyYXlfa2V5X2V4aXN0cygnb25seV9wYWdlJywgJG9wdGlvbikpIHsNCiAgICAgICAgJG9wdGlvblsnb25seV9wYWdlJ10gPSBmYWxzZTsNCiAgICB9DQogICAgaWYgKCFhcnJheV9rZXlfZXhpc3RzKCd3aGVyZV9jdXN0b20nLCAkb3B0aW9uKSkgew0KICAgICAgICAkb3B0aW9uWyd3aGVyZV9jdXN0b20nXSA9IGFycmF5KCk7DQogICAgfQ0KICAgIGlmICghYXJyYXlfa2V5X2V4aXN0cygnb3JkZXJfY3VzdG9tJywgJG9wdGlvbikpIHsNCiAgICAgICAgJG9wdGlvblsnb3JkZXJfY3VzdG9tJ10gPSBhcnJheSgpOw0KICAgIH0NCg0KICAgICR3ID0gYXJyYXkoKTsNCiAgICBpZiAoJG9wdGlvblsncG9zdF90eXBlJ10gIT09IG51bGwpIHsNCiAgICAgICAgJHdbXSA9IGFycmF5KCc9JywgJ2xvZ19UeXBlJywgKGludCkgJG9wdGlvblsncG9zdF90eXBlJ10pOw0KICAgIH0gZWxzZWlmICgkb3B0aW9uWydvbmx5X2FydGljbGUnXSA9PSB0cnVlKSB7DQogICAgICAgICR3W10gPSBhcnJheSgnPScsICdsb2dfVHlwZScsIDApOw0KICAgIH0gZWxzZWlmICgkb3B0aW9uWydvbmx5X3BhZ2UnXSA9PSB0cnVlKSB7DQogICAgICAgICR3W10gPSBhcnJheSgnPScsICdsb2dfVHlwZScsIDEpOw0KICAgIH0NCg0KICAgIGlmICgkb3B0aW9uWydwb3N0X3N0YXR1cyddICE9PSBudWxsKSB7DQogICAgICAgICR3W10gPSBhcnJheSgnPScsICdsb2dfU3RhdHVzJywgKGludCkgJG9wdGlvblsncG9zdF9zdGF0dXMnXSk7DQogICAgfQ0KDQogICAgJG9wdGlvbjIgPSAkb3B0aW9uOw0KICAgIHVuc2V0KCRvcHRpb24yWydwb3N0X3R5cGUnXSwgJG9wdGlvbjJbJ3Bvc3Rfc3RhdHVzJ10sICRvcHRpb24yWydvbmx5X2FydGljbGUnXSwgJG9wdGlvbjJbJ29ubHlfcGFnZSddKTsNCiAgICB1bnNldCgkb3B0aW9uMlsnb3JkZXJfY3VzdG9tJ10sICRvcHRpb24yWyd3aGVyZV9jdXN0b20nXSk7DQoNCiAgICBpZiAoaXNfbnVsbCgkaWQpID09PSBmYWxzZSkgew0KICAgICAgICAkd1tdID0gYXJyYXkoJz0nLCAnbG9nX0lEJywgKGludCkgJGlkKTsNCiAgICB9IGVsc2VpZiAoaXNfbnVsbCgkdGl0bGUpID09PSBmYWxzZSkgew0KICAgICAgICAkd1tdID0gYXJyYXkoJz0nLCAnbG9nX1RpdGxlJywgJHRpdGxlKTsNCiAgICB9IGVsc2VpZiAoaXNfbnVsbCgkYWxpYXMpID09PSBmYWxzZSkgew0KICAgICAgICAkd1tdID0gYXJyYXkoJz0nLCAnbG9nX0FsaWFzJywgJGFsaWFzKTsNCiAgICB9IGVsc2VpZiAoaXNfbnVsbCgkdGl0bGVvcmFsaWFzKSA9PT0gZmFsc2UpIHsNCiAgICAgICAgJHdbXSA9IGFycmF5KCdhcnJheScsIGFycmF5KGFycmF5KCdsb2dfQWxpYXMnLCAkdGl0bGVvcmFsaWFzKSwgYXJyYXkoJ2xvZ19UaXRsZScsICR0aXRsZW9yYWxpYXMpKSk7DQogICAgfSBlbHNlaWYgKGlzX3N0cmluZygkaWRvcm5hbWUpKSB7DQogICAgICAgICR3W10gPSBhcnJheSgnYXJyYXknLCBhcnJheShhcnJheSgnbG9nX0FsaWFzJywgJGlkb3JuYW1lKSwgYXJyYXkoJ2xvZ19UaXRsZScsICRpZG9ybmFtZSkpKTsNCiAgICB9IGVsc2VpZiAoaXNfaW50KCRpZG9ybmFtZSkpIHsNCiAgICAgICAgJHdbXSA9IGFycmF5KCc9JywgJ2xvZ19JRCcsIChpbnQpICRpZG9ybmFtZSk7DQogICAgfSBlbHNlIHsNCiAgICAgICAgJHdbXSA9IGFycmF5KCc9JywgJ2xvZ19JRCcsICcnKTsNCiAgICB9DQoNCiAgICAkc2VsZWN0ID0gJyc7DQogICAgJGNvdW50ID0gMTsNCg0KICAgIGlmICghZW1wdHkoJG9wdGlvblsnd2hlcmVfY3VzdG9tJ10pICYmIGlzX2FycmF5KCRvcHRpb25bJ3doZXJlX2N1c3RvbSddKSkgew0KICAgICAgICBmb3JlYWNoICgkb3B0aW9uWyd3aGVyZV9jdXN0b20nXSBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAgICAgJHdbXSA9ICR2YWx1ZTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgICRvcmRlciA9IGFycmF5KCk7DQogICAgaWYgKCFlbXB0eSgkb3B0aW9uWydvcmRlcl9jdXN0b20nXSkgJiYgaXNfYXJyYXkoJG9wdGlvblsnb3JkZXJfY3VzdG9tJ10pKSB7DQogICAgICAgIGZvcmVhY2ggKCRvcHRpb25bJ29yZGVyX2N1c3RvbSddIGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICAgICAkb3JkZXJbJGtleV0gPSAkdmFsdWU7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAkYXJ0aWNsZXMgPSAkemJwLT5HZXRQb3N0TGlzdCgkc2VsZWN0LCAkdywgJG9yZGVyLCAkY291bnQsICRvcHRpb24yKTsNCg0KICAgIGlmIChjb3VudCgkYXJ0aWNsZXMpID09IDApIHsNCiAgICAgICAgJHBvc3QgPSBuZXcgUG9zdCgpOw0KICAgIH0gZWxzZSB7DQogICAgICAgICRwb3N0ID0gJGFydGljbGVzWzBdOw0KICAgIH0NCg0KICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX0dldFBvc3RfUmVzdWx0J10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICRmcHJldHVybiA9ICRmcG5hbWUoJHBvc3QpOw0KICAgIH0NCg0KICAgIHJldHVybiAkcG9zdDsNCn0NCg0KLyoqDQogKiDojrflj5bmlofnq6DliJfooaguDQogKg0KICogQHBhcmFtIGludCAgJGNvdW50ICDmlbDph48gKDEuN+aUr+aMgeWkjeadgueahGFycmF55Y+C5pWwLCRjb3VudOS4umFycmF55pe25ZCO6Z2i55qE5Y+C5pWw5Y+v5Lul5LiN6K6+KQ0KICogQHBhcmFtIG51bGwgJGNhdGUgICDliIbnsbtJRA0KICogQHBhcmFtIG51bGwgJGF1dGggICDnlKjmiLdJRA0KICogQHBhcmFtIG51bGwgJGRhdGUgICDml6XmnJ8NCiAqIEBwYXJhbSBudWxsICR0YWdzICAg5qCH562+DQogKiBAcGFyYW0gbnVsbCAkc2VhcmNoIOaQnOe0ouWFs+mUruivjQ0KICogQHBhcmFtIG51bGwgJG9wdGlvbg0KICoNCiAqIEByZXR1cm4gYXJyYXl8bWl4ZWQNCiAqLw0KZnVuY3Rpb24gR2V0TGlzdCgkY291bnQgPSAxMCwgJGNhdGUgPSBudWxsLCAkYXV0aCA9IG51bGwsICRkYXRlID0gbnVsbCwgJHRhZ3MgPSBudWxsLCAkc2VhcmNoID0gbnVsbCwgJG9wdGlvbiA9IG51bGwpDQp7DQogICAgLy/mlrDniYjmnKznmoTkvb/nlKjor7TmmI7or7fnnIsNCiAgICAvL2h0dHBzOi8vd2lraS56YmxvZ2NuLmNvbS9kb2t1LnBocD9pZD16YmxvZ3BocDpkZXZlbG9wbWVudDpmdW5jdGlvbnM6Z2V0bGlzdA0KICAgIGdsb2JhbCAkemJwOw0KICAgICRhcmdzID0gYXJyYXkoKTsNCiAgICBpZiAoaXNfYXJyYXkoJGNvdW50KSkgew0KICAgICAgICAkYXJncyA9ICRjb3VudDsNCiAgICAgICAgaWYgKGFycmF5X2tleV9leGlzdHMoJ2NvdW50JywgJGFyZ3MpKSB7DQogICAgICAgICAgICAkY291bnQgPSAoaW50KSAkYXJnc1snY291bnQnXTsNCiAgICAgICAgICAgIHVuc2V0KCRhcmdzWydjb3VudCddKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICRjb3VudCA9IDEwOw0KICAgICAgICB9DQogICAgICAgIGlmIChhcnJheV9rZXlfZXhpc3RzKCdjYXRlZ29yeScsICRhcmdzKSkgew0KICAgICAgICAgICAgJGNhdGUgPSAkYXJnc1snY2F0ZWdvcnknXTsNCiAgICAgICAgICAgIHVuc2V0KCRhcmdzWydjYXRlZ29yeSddKTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoYXJyYXlfa2V5X2V4aXN0cygnY2F0ZScsICRhcmdzKSkgew0KICAgICAgICAgICAgJGNhdGUgPSAkYXJnc1snY2F0ZSddOw0KICAgICAgICAgICAgdW5zZXQoJGFyZ3NbJ2NhdGUnXSk7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGFycmF5X2tleV9leGlzdHMoJ2F1dGhvcicsICRhcmdzKSkgew0KICAgICAgICAgICAgJGF1dGggPSAkYXJnc1snYXV0aG9yJ107DQogICAgICAgICAgICB1bnNldCgkYXJnc1snYXV0aG9yJ10pOw0KICAgICAgICB9DQogICAgICAgIGlmIChhcnJheV9rZXlfZXhpc3RzKCdhdXRoJywgJGFyZ3MpKSB7DQogICAgICAgICAgICAkYXV0aCA9ICRhcmdzWydhdXRoJ107DQogICAgICAgICAgICB1bnNldCgkYXJnc1snYXV0aCddKTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoYXJyYXlfa2V5X2V4aXN0cygnZGF0ZScsICRhcmdzKSkgew0KICAgICAgICAgICAgJGRhdGUgPSAkYXJnc1snZGF0ZSddOw0KICAgICAgICAgICAgdW5zZXQoJGFyZ3NbJ2RhdGUnXSk7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGFycmF5X2tleV9leGlzdHMoJ3RhZ3MnLCAkYXJncykpIHsNCiAgICAgICAgICAgICR0YWdzID0gJGFyZ3NbJ3RhZ3MnXTsNCiAgICAgICAgICAgIHVuc2V0KCRhcmdzWyd0YWdzJ10pOw0KICAgICAgICB9DQogICAgICAgIGlmIChhcnJheV9rZXlfZXhpc3RzKCdzZWFyY2gnLCAkYXJncykpIHsNCiAgICAgICAgICAgICRzZWFyY2ggPSAkYXJnc1snc2VhcmNoJ107DQogICAgICAgICAgICB1bnNldCgkYXJnc1snc2VhcmNoJ10pOw0KICAgICAgICB9DQogICAgICAgIGlmIChhcnJheV9rZXlfZXhpc3RzKCdvcHRpb24nLCAkYXJncykpIHsNCiAgICAgICAgICAgICRvcHRpb24gPSAkYXJnc1snb3B0aW9uJ107DQogICAgICAgICAgICB1bnNldCgkYXJnc1snb3B0aW9uJ10pOw0KICAgICAgICB9DQogICAgICAgIGlmICghaXNfYXJyYXkoJG9wdGlvbikpIHsNCiAgICAgICAgICAgICRvcHRpb24gPSBhcnJheSgpOw0KICAgICAgICB9DQogICAgICAgICRvcHRpb24gPSBhcnJheV9tZXJnZSgkYXJncywgJG9wdGlvbik7DQogICAgICAgIHVuc2V0KCRhcmdzKTsNCiAgICB9DQoNCiAgICBpZiAoIWlzX2FycmF5KCRvcHRpb24pKSB7DQogICAgICAgICRvcHRpb24gPSBhcnJheSgpOw0KICAgIH0NCiAgICBpZiAoIWFycmF5X2tleV9leGlzdHMoJ3Bvc3RfdHlwZScsICRvcHRpb24pKSB7DQogICAgICAgICRvcHRpb25bJ3Bvc3RfdHlwZSddID0gbnVsbDsNCiAgICB9DQogICAgaWYgKCFhcnJheV9rZXlfZXhpc3RzKCdwb3N0X3N0YXR1cycsICRvcHRpb24pKSB7DQogICAgICAgICRvcHRpb25bJ3Bvc3Rfc3RhdHVzJ10gPSAwOw0KICAgIH0NCiAgICBpZiAoIWFycmF5X2tleV9leGlzdHMoJ29ubHlfb250b3AnLCAkb3B0aW9uKSkgew0KICAgICAgICAkb3B0aW9uWydvbmx5X29udG9wJ10gPSBmYWxzZTsNCiAgICB9DQogICAgaWYgKCFhcnJheV9rZXlfZXhpc3RzKCdvbmx5X25vdF9vbnRvcCcsICRvcHRpb24pKSB7DQogICAgICAgICRvcHRpb25bJ29ubHlfbm90X29udG9wJ10gPSBmYWxzZTsNCiAgICB9DQogICAgaWYgKCFhcnJheV9rZXlfZXhpc3RzKCdoYXNfc3ViY2F0ZScsICRvcHRpb24pKSB7DQogICAgICAgICRvcHRpb25bJ2hhc19zdWJjYXRlJ10gPSBmYWxzZTsNCiAgICB9DQogICAgaWYgKCFhcnJheV9rZXlfZXhpc3RzKCd3aGVyZV9jdXN0b20nLCAkb3B0aW9uKSkgew0KICAgICAgICAkb3B0aW9uWyd3aGVyZV9jdXN0b20nXSA9IGFycmF5KCk7DQogICAgfQ0KICAgIGlmICghYXJyYXlfa2V5X2V4aXN0cygnb3JkZXJfY3VzdG9tJywgJG9wdGlvbikpIHsNCiAgICAgICAgJG9wdGlvblsnb3JkZXJfY3VzdG9tJ10gPSBhcnJheSgpOw0KICAgIH0NCiAgICBpZiAoIWFycmF5X2tleV9leGlzdHMoJ2lzX3JlbGF0ZWQnLCAkb3B0aW9uKSkgew0KICAgICAgICAkb3B0aW9uWydpc19yZWxhdGVkJ10gPSBmYWxzZTsNCiAgICB9DQogICAgaWYgKCRvcHRpb25bJ2lzX3JlbGF0ZWQnXSkgew0KICAgICAgICAkYXQgPSAkemJwLT5HZXRQb3N0QnlJRCgkb3B0aW9uWydpc19yZWxhdGVkJ10pOw0KICAgICAgICAkdGFncyA9ICRhdC0+VGFnczsNCiAgICAgICAgaWYgKCEkdGFncykgew0KICAgICAgICAgICAgcmV0dXJuIGFycmF5KCk7DQogICAgICAgIH0NCiAgICAgICAgJGNvdW50ID0gKCRjb3VudCArIDEpOw0KICAgIH0NCg0KICAgICRvcHRpb24yID0gJG9wdGlvbjsNCiAgICB1bnNldCgkb3B0aW9uMlsncG9zdF90eXBlJ10sICRvcHRpb24yWydwb3N0X3N0YXR1cyddLCAkb3B0aW9uMlsnb25seV9vbnRvcCddLCAkb3B0aW9uMlsnb25seV9ub3Rfb250b3AnXSk7DQogICAgdW5zZXQoJG9wdGlvbjJbJ2hhc19zdWJjYXRlJ10sICRvcHRpb24yWydpc19yZWxhdGVkJ10sICRvcHRpb24yWydvcmRlcl9ieV9tZXRhcyddKTsNCiAgICB1bnNldCgkb3B0aW9uMlsnb3JkZXJfY3VzdG9tJ10sICRvcHRpb24yWyd3aGVyZV9jdXN0b20nXSk7DQoNCiAgICAkbGlzdCA9IGFycmF5KCk7DQogICAgJHBvc3RfdHlwZSA9IG51bGw7DQogICAgJHcgPSBhcnJheSgpOw0KDQogICAgaWYgKCRvcHRpb25bJ3Bvc3RfdHlwZSddICE9PSBudWxsKSB7DQogICAgICAgICRwb3N0X3R5cGUgPSAoaW50KSAkb3B0aW9uWydwb3N0X3R5cGUnXTsNCiAgICB9IGVsc2Ugew0KICAgICAgICAkcG9zdF90eXBlID0gMDsNCiAgICB9DQogICAgJHdbXSA9IGFycmF5KCc9JywgJ2xvZ19UeXBlJywgJHBvc3RfdHlwZSk7DQoNCiAgICBpZiAoJG9wdGlvblsncG9zdF9zdGF0dXMnXSAhPT0gbnVsbCkgew0KICAgICAgICAkd1tdID0gYXJyYXkoJz0nLCAnbG9nX1N0YXR1cycsIChpbnQpICRvcHRpb25bJ3Bvc3Rfc3RhdHVzJ10pOw0KICAgIH0NCg0KICAgIGlmICgkb3B0aW9uWydvbmx5X29udG9wJ10gPT0gdHJ1ZSkgew0KICAgICAgICAkd1tdID0gYXJyYXkoJz4nLCAnbG9nX0lzVG9wJywgMCk7DQogICAgfSBlbHNlaWYgKCRvcHRpb25bJ29ubHlfbm90X29udG9wJ10gPT0gdHJ1ZSkgew0KICAgICAgICAkd1tdID0gYXJyYXkoJz0nLCAnbG9nX0lzVG9wJywgMCk7DQogICAgfQ0KDQogICAgaWYgKCFpc19udWxsKCRjYXRlKSkgew0KICAgICAgICAkY2F0ZWdvcnkgPSBuZXcgQ2F0ZWdvcnkoKTsNCiAgICAgICAgJGNhdGVnb3J5ID0gJHpicC0+R2V0Q2F0ZWdvcnlCeUlEKCRjYXRlKTsNCg0KICAgICAgICBpZiAoJGNhdGVnb3J5LT5JRCA+IDApIHsNCiAgICAgICAgICAgIGlmICghJG9wdGlvblsnaGFzX3N1YmNhdGUnXSkgew0KICAgICAgICAgICAgICAgICR3W10gPSBhcnJheSgnPScsICdsb2dfQ2F0ZUlEJywgJGNhdGVnb3J5LT5JRCk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICRhcnlzdWJjYXRlID0gYXJyYXkoKTsNCiAgICAgICAgICAgICAgICAkYXJ5c3ViY2F0ZVtdID0gYXJyYXkoJ2xvZ19DYXRlSUQnLCAkY2F0ZWdvcnktPklEKTsNCiAgICAgICAgICAgICAgICBpZiAoaXNzZXQoJHpicC0+Y2F0ZWdvcmllc19hbGxbJGNhdGVnb3J5LT5JRF0pKSB7DQogICAgICAgICAgICAgICAgICAgIGZvcmVhY2ggKCR6YnAtPmNhdGVnb3JpZXNfYWxsWyRjYXRlZ29yeS0+SURdLT5DaGlsZHJlbkNhdGVnb3JpZXMgYXMgJHN1YmNhdGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICRhcnlzdWJjYXRlW10gPSBhcnJheSgnbG9nX0NhdGVJRCcsICRzdWJjYXRlLT5JRCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgJHdbXSA9IGFycmF5KCdhcnJheScsICRhcnlzdWJjYXRlKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHJldHVybiBhcnJheSgpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgaWYgKCFpc19udWxsKCRhdXRoKSkgew0KICAgICAgICAkYXV0aG9yID0gbmV3IE1lbWJlcigpOw0KICAgICAgICAkYXV0aG9yID0gJHpicC0+R2V0TWVtYmVyQnlJRCgkYXV0aCk7DQoNCiAgICAgICAgaWYgKCRhdXRob3ItPklEID4gMCkgew0KICAgICAgICAgICAgJHdbXSA9IGFycmF5KCc9JywgJ2xvZ19BdXRob3JJRCcsICRhdXRob3ItPklEKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHJldHVybiBhcnJheSgpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgaWYgKCFpc19udWxsKCRkYXRlKSkgew0KICAgICAgICAkZGF0ZXRpbWUgPSBzdHJ0b3RpbWUoJGRhdGUpOw0KICAgICAgICBpZiAoJGRhdGV0aW1lKSB7DQogICAgICAgICAgICAkZGF0ZXRpdGxlID0gc3RyX3JlcGxhY2UoYXJyYXkoJyV5JScsICclbSUnKSwgYXJyYXkoZGF0ZSgnWScsICRkYXRldGltZSksIGRhdGUoJ24nLCAkZGF0ZXRpbWUpKSwgJHpicC0+bGFuZ1snbXNnJ11bJ3llYXJfbW9udGgnXSk7DQogICAgICAgICAgICAkd1tdID0gYXJyYXkoJ0JFVFdFRU4nLCAnbG9nX1Bvc3RUaW1lJywgJGRhdGV0aW1lLCBzdHJ0b3RpbWUoJysxIG1vbnRoJywgJGRhdGV0aW1lKSk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICByZXR1cm4gYXJyYXkoKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGlmICghaXNfbnVsbCgkdGFncykpIHsNCiAgICAgICAgJHRhZyA9IG5ldyBUYWcoKTsNCiAgICAgICAgaWYgKGlzX2FycmF5KCR0YWdzKSkgew0KICAgICAgICAgICAgJHRhID0gYXJyYXkoKTsNCiAgICAgICAgICAgIGZvcmVhY2ggKCR0YWdzIGFzICR0KSB7DQogICAgICAgICAgICAgICAgJHRhW10gPSBhcnJheSgnbG9nX1RhZycsICcleycgLiAkdC0+SUQgLiAnfSUnKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgICR3W10gPSBhcnJheSgnYXJyYXlfbGlrZScsICR0YSk7DQogICAgICAgICAgICB1bnNldCgkdGEpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgaWYgKGlzX2ludCgkdGFncykpIHsNCiAgICAgICAgICAgICAgICAkdGFnID0gJHpicC0+R2V0VGFnQnlJRCgkdGFncyk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICR0YWcgPSAkemJwLT5HZXRUYWdCeUFsaWFzT3JOYW1lKCR0YWdzLCAkcG9zdF90eXBlKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICgkdGFnLT5JRCA+IDApIHsNCiAgICAgICAgICAgICAgICAkd1tdID0gYXJyYXkoJ0xJS0UnLCAnbG9nX1RhZycsICcleycgLiAkdGFnLT5JRCAuICd9JScpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gYXJyYXkoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGlmIChpc19zdHJpbmcoJHNlYXJjaCkpIHsNCiAgICAgICAgJHNlYXJjaCA9IHRyaW0oJHNlYXJjaCk7DQogICAgICAgIGlmICgkc2VhcmNoICE9PSAnJykgew0KICAgICAgICAgICAgJHdbXSA9IGFycmF5KCdzZWFyY2gnLCAnbG9nX0NvbnRlbnQnLCAnbG9nX0ludHJvJywgJ2xvZ19UaXRsZScsICRzZWFyY2gpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgcmV0dXJuIGFycmF5KCk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAkc2VsZWN0ID0gJyc7DQoNCiAgICBpZiAoIWVtcHR5KCRvcHRpb25bJ3doZXJlX2N1c3RvbSddKSAmJiBpc19hcnJheSgkb3B0aW9uWyd3aGVyZV9jdXN0b20nXSkpIHsNCiAgICAgICAgZm9yZWFjaCAoJG9wdGlvblsnd2hlcmVfY3VzdG9tJ10gYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgICAgICR3W10gPSAkdmFsdWU7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBpZiAoZW1wdHkoJG9wdGlvblsnb3JkZXJfY3VzdG9tJ10pKSB7DQogICAgICAgICRvcmRlciA9IGFycmF5KCdsb2dfUG9zdFRpbWUnID0+ICdERVNDJyk7DQogICAgfSBlbHNlIHsNCiAgICAgICAgJG9yZGVyID0gYXJyYXkoKTsNCiAgICAgICAgZm9yZWFjaCAoJG9wdGlvblsnb3JkZXJfY3VzdG9tJ10gYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgICAgICRvcmRlclska2V5XSA9ICR2YWx1ZTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX0xhcmdlRGF0YV9HZXRMaXN0J10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICRmcHJldHVybiA9ICRmcG5hbWUoJHNlbGVjdCwgJHcsICRvcmRlciwgJGNvdW50LCAkb3B0aW9uMik7DQogICAgfQ0KDQogICAgJGxpc3QgPSAkemJwLT5HZXRQb3N0TGlzdCgkc2VsZWN0LCAkdywgJG9yZGVyLCAkY291bnQsICRvcHRpb24yKTsNCg0KICAgIGlmICgkb3B0aW9uWydpc19yZWxhdGVkJ10pIHsNCiAgICAgICAgZm9yZWFjaCAoJGxpc3QgYXMgJGsgPT4gJGEpIHsNCiAgICAgICAgICAgIGlmICgkYS0+SUQgPT0gJG9wdGlvblsnaXNfcmVsYXRlZCddKSB7DQogICAgICAgICAgICAgICAgdW5zZXQoJGxpc3RbJGtdKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBpZiAoY291bnQoJGxpc3QpID09ICRjb3VudCkgew0KICAgICAgICAgICAgYXJyYXlfcG9wKCRsaXN0KTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICBpZiAoaXNzZXQoJG9wdGlvblsnb3JkZXJfYnlfbWV0YXMnXSkpIHsgLy/ku45tZXRh6YeM55qE5YC85o6S5bqPDQogICAgICAgIGlmIChpc19hcnJheSgkb3B0aW9uWydvcmRlcl9ieV9tZXRhcyddKSkgew0KICAgICAgICAgICAgJG9yZGVya2V5ID0ga2V5KCRvcHRpb25bJ29yZGVyX2J5X21ldGFzJ10pOw0KICAgICAgICAgICAgJG9yZGVyID0gY3VycmVudCgkb3B0aW9uWydvcmRlcl9ieV9tZXRhcyddKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICRvcmRlcmtleSA9IGN1cnJlbnQoJG9wdGlvblsnb3JkZXJfYnlfbWV0YXMnXSk7DQogICAgICAgICAgICAkb3JkZXIgPSAnYXNjJzsNCiAgICAgICAgfQ0KICAgICAgICAkb3JkZXJhcnJheSA9IGFycmF5KCk7DQogICAgICAgIGZvcmVhY2ggKCRsaXN0IGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICAgICAkb3JkZXJhcnJheVska2V5XSA9ICR2YWx1ZS0+TWV0YXMtPiRvcmRlcmtleTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoc3RydG9sb3dlcigkb3JkZXIpID09ICdkZXNjJykgew0KICAgICAgICAgICAgYXJzb3J0KCRvcmRlcmFycmF5KTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGFzb3J0KCRvcmRlcmFycmF5KTsNCiAgICAgICAgfQ0KICAgICAgICAkbmV3bGlzdCA9IGFycmF5KCk7DQogICAgICAgIGZvcmVhY2ggKCRvcmRlcmFycmF5IGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICAgICAkbmV3bGlzdFtdID0gJGxpc3RbJGtleV07DQogICAgICAgIH0NCiAgICAgICAgJGxpc3QgPSAkbmV3bGlzdDsNCiAgICB9DQoNCg0KICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX0dldExpc3RfUmVzdWx0J10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICRmcHJldHVybiA9ICRmcG5hbWUoJGxpc3QpOw0KICAgIH0NCg0KICAgIHJldHVybiAkbGlzdDsNCn0NCg0KLy8jIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCg0KLyoqDQogKiDmmL7npLo0MDTpobXpnaIo5YaF572u5o+S5Lu25Ye95pWwKS4NCiAqDQogKiDlj6/pgJrov4fkuLvpopjkuK3nmoQ0MDQucGhw5qih5p2/6Ieq5a6a5LmJ5pi+56S65pWI5p6cDQogKg0KICogQHBhcmFtICRlcnJvckNvZGUNCiAqIEBwYXJhbSAkZXJyb3JEZXNjcmlwdGlvbg0KICogQHBhcmFtICRmaWxlDQogKiBAcGFyYW0gJGxpbmUNCiAqDQogKiBAYXBpIEZpbHRlcl9QbHVnaW5fWmJwX1Nob3dFcnJvcg0KICoNCiAqIEB0aHJvd3MgRXhjZXB0aW9uDQogKi8NCmZ1bmN0aW9uIEluY2x1ZGVfU2hvd0Vycm9yNDA0KCRlcnJvckNvZGUsICRlcnJvckRlc2NyaXB0aW9uLCAkZmlsZSwgJGxpbmUpDQp7DQogICAgZ2xvYmFsICR6YnA7DQogICAgaWYgKCFpbl9hcnJheSgiU3RhdHVzOiA0MDQgTm90IEZvdW5kIiwgaGVhZGVyc19saXN0KCkpKSB7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICAkemJwLT50ZW1wbGF0ZS0+U2V0VGFncygndGl0bGUnLCAkemJwLT50aXRsZSk7DQogICAgJHpicC0+dGVtcGxhdGUtPlNldFRlbXBsYXRlKCc0MDQnKTsNCiAgICAkemJwLT50ZW1wbGF0ZS0+RGlzcGxheSgpOw0KDQogICAgZXhpdDsNCn0NCg0KLyoqDQogKiDovpPlh7rlkI7lj7DmjIflrprlrZfkvZNmYW1pbHko5YaF572u5o+S5Lu25Ye95pWwKS4NCiAqLw0KZnVuY3Rpb24gSW5jbHVkZV9BZGRvbkFkbWluRm9udCgpDQp7DQogICAgZ2xvYmFsICR6YnA7DQogICAgJGYgPSAkcyA9ICcnOw0KICAgIGlmIChpc3NldCgkemJwLT5sYW5nWydmb250X2ZhbWlseSddKSAmJiB0cmltKCR6YnAtPmxhbmdbJ2ZvbnRfZmFtaWx5J10pKSB7DQogICAgICAgICRmID0gJ2ZvbnQtZmFtaWx5OicgLiAkemJwLT5sYW5nWydmb250X2ZhbWlseSddIC4gJzsnOw0KICAgIH0NCg0KICAgIGlmIChpc3NldCgkemJwLT5sYW5nWydmb250X3NpemUnXSkgJiYgdHJpbSgkemJwLT5sYW5nWydmb250X3NpemUnXSkpIHsNCiAgICAgICAgJHMgPSAnZm9udC1zaXplOicgLiAkemJwLT5sYW5nWydmb250X3NpemUnXSAuICc7JzsNCiAgICB9DQoNCiAgICBpZiAoJGYgfHwgJHMpIHsNCiAgICAgICAgZWNobyAnPHN0eWxlIHR5cGU9InRleHQvY3NzIj5ib2R5eycgLiAkcyAuICRmIC4gJ308L3N0eWxlPic7DQogICAgfQ0KfQ0KDQovKioNCiAqIOaJueWkhOeQhuaWh+eroA0KICoNCiAqIEBwYXJhbSBpbnQgJHR5cGUNCiAqLw0KZnVuY3Rpb24gSW5jbHVkZV9CYXRjaFBvc3RfQXJ0aWNsZSgkdHlwZSkNCnsNCiAgICBnbG9iYWwgJHpicDsNCiAgICBpZiAoJHR5cGUgIT0gWkNfUE9TVF9UWVBFX0FSVElDTEUpIHsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICBpZiAoIWlzc2V0KCRfUE9TVFsnaWQnXSkpIHsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICAkYXJyYXlpZCA9ICRfUE9TVFsnaWQnXTsNCiAgICBmb3JlYWNoICgkYXJyYXlpZCBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAkaWQgPSAoaW50KSAkdmFsdWU7DQogICAgICAgICRhcnRpY2xlID0gbmV3IFBvc3QoKTsNCiAgICAgICAgJGFydGljbGUgPSAkemJwLT5HZXRQb3N0QnlJRCgkaWQpOw0KICAgICAgICBpZiAoJGFydGljbGUtPklEID4gMCkgew0KICAgICAgICAgICAgaWYgKCEkemJwLT5DaGVja1JpZ2h0cygnQXJ0aWNsZUFsbCcpICYmICRhcnRpY2xlLT5BdXRob3JJRCAhPSAkemJwLT51c2VyLT5JRCkgew0KICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAkcHJlX2F1dGhvciA9ICRhcnRpY2xlLT5BdXRob3JJRDsNCiAgICAgICAgICAgICRwcmVfdGFnID0gJGFydGljbGUtPlRhZzsNCiAgICAgICAgICAgICRwcmVfY2F0ZWdvcnkgPSAkYXJ0aWNsZS0+Q2F0ZUlEOw0KICAgICAgICAgICAgJHByZV9pc3RvcCA9ICRhcnRpY2xlLT5Jc1RvcDsNCiAgICAgICAgICAgICRwcmVfc3RhdHVzID0gJGFydGljbGUtPlN0YXR1czsNCg0KICAgICAgICAgICAgJGFydGljbGUtPkRlbCgpOw0KDQogICAgICAgICAgICBEZWxBcnRpY2xlX0NvbW1lbnRzKCRhcnRpY2xlLT5JRCk7DQoNCiAgICAgICAgICAgIENvdW50VGFnQXJyYXlTdHJpbmcoJHByZV90YWcsIC0xLCAkYXJ0aWNsZS0+SUQpOw0KICAgICAgICAgICAgQ291bnRNZW1iZXJBcnJheShhcnJheSgkcHJlX2F1dGhvciksIGFycmF5KC0xLCAwLCAwLCAwKSk7DQogICAgICAgICAgICBDb3VudENhdGVnb3J5QXJyYXkoYXJyYXkoJHByZV9jYXRlZ29yeSksIC0xKTsNCiAgICAgICAgICAgIGlmICgoJHByZV9pc3RvcCA9PSAwICYmICRwcmVfc3RhdHVzID09IDApKSB7DQogICAgICAgICAgICAgICAgQ291bnROb3JtYWxBcnRpY2xlTnVtcygtMSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoJGFydGljbGUtPklzVG9wID09IHRydWUpIHsNCiAgICAgICAgICAgICAgICBDb3VudFRvcFBvc3QoJGFydGljbGUtPlR5cGUsIG51bGwsICRhcnRpY2xlLT5JRCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX0RlbEFydGljbGVfU3VjY2VlZCddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAgICAgICAgICRmcG5hbWUoJGFydGljbGUpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KICAgICR6YnAtPkFkZEJ1aWxkTW9kdWxlKCdwcmV2aW91cycpOw0KICAgICR6YnAtPkFkZEJ1aWxkTW9kdWxlKCdjYWxlbmRhcicpOw0KICAgICR6YnAtPkFkZEJ1aWxkTW9kdWxlKCdjb21tZW50cycpOw0KICAgICR6YnAtPkFkZEJ1aWxkTW9kdWxlKCdhcmNoaXZlcycpOw0KICAgICR6YnAtPkFkZEJ1aWxkTW9kdWxlKCd0YWdzJyk7DQogICAgJHpicC0+QWRkQnVpbGRNb2R1bGUoJ2F1dGhvcnMnKTsNCg0KICAgIHJldHVybiB0cnVlOw0KfQ0KDQovKioNCiAqIOaJueWkhOeQhumhtemdog0KICoNCiAqIEBwYXJhbSBpbnQgJHR5cGUNCiAqLw0KZnVuY3Rpb24gSW5jbHVkZV9CYXRjaFBvc3RfUGFnZSgkdHlwZSkNCnsNCiAgICBnbG9iYWwgJHpicDsNCiAgICBpZiAoJHR5cGUgIT0gWkNfUE9TVF9UWVBFX1BBR0UpIHsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICBpZiAoIWlzc2V0KCRfUE9TVFsnaWQnXSkpIHsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICAkYXJyYXlpZCA9ICRfUE9TVFsnaWQnXTsNCiAgICBmb3JlYWNoICgkYXJyYXlpZCBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAkaWQgPSAoaW50KSAkdmFsdWU7DQogICAgICAgICRhcnRpY2xlID0gbmV3IFBvc3QoKTsNCiAgICAgICAgJGFydGljbGUgPSAkemJwLT5HZXRQb3N0QnlJRCgkaWQpOw0KICAgICAgICBpZiAoJGFydGljbGUtPklEID4gMCkgew0KICAgICAgICAgICAgaWYgKCEkemJwLT5DaGVja1JpZ2h0cygnUGFnZUFsbCcpICYmICRhcnRpY2xlLT5BdXRob3JJRCAhPSAkemJwLT51c2VyLT5JRCkgew0KICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAkcHJlX2F1dGhvciA9ICRhcnRpY2xlLT5BdXRob3JJRDsNCg0KICAgICAgICAgICAgJGFydGljbGUtPkRlbCgpOw0KDQogICAgICAgICAgICBEZWxBcnRpY2xlX0NvbW1lbnRzKCRhcnRpY2xlLT5JRCk7DQoNCiAgICAgICAgICAgIENvdW50TWVtYmVyQXJyYXkoYXJyYXkoJHByZV9hdXRob3IpLCBhcnJheSgwLCAtMSwgMCwgMCkpOw0KDQogICAgICAgICAgICAkemJwLT5BZGRCdWlsZE1vZHVsZSgnY29tbWVudHMnKTsNCg0KICAgICAgICAgICAgJHpicC0+RGVsSXRlbVRvTmF2YmFyKCdwYWdlJywgJGFydGljbGUtPklEKTsNCg0KICAgICAgICAgICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fRGVsUGFnZV9TdWNjZWVkJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICAgICAgICAgJGZwbmFtZSgkYXJ0aWNsZSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQogICAgcmV0dXJuIHRydWU7DQp9DQoNCi8qKg0KICog6aaW6aG1aW5kZXgucGhw55qE57uT5bC+5aSE55CGDQogKi8NCmZ1bmN0aW9uIEluY2x1ZGVfSW5kZXhfRW5kKCkNCnsNCiAgICBnbG9iYWwgJHpicDsNCiAgICBpZiAoJHpicC0+b3B0aW9uWydaQ19SVU5JTkZPX0RJU1BMQVknXSA9PSB0cnVlKSB7DQogICAgICAgIFJ1blRpbWUoKTsNCiAgICB9DQp9DQoNCi8qKg0KICog6aaW6aG1aW5kZXgucGhw55qE5byA5aS05aSE55CGDQogKi8NCmZ1bmN0aW9uIEluY2x1ZGVfSW5kZXhfQmVnaW4oKQ0Kew0KICAgIGdsb2JhbCAkemJwOw0KICAgICR6YnAtPkNoZWNrU2l0ZUNsb3NlZCgpOw0KDQogICAgJHpicC0+UmVkaXJlY3RQZXJtYW5lbnREb21haW4oKTsNCg0KICAgIGlmICgkemJwLT50ZW1wbGF0ZS0+aGFzVGVtcGxhdGUoJzQwNCcpKSB7DQogICAgICAgIEFkZF9GaWx0ZXJfUGx1Z2luKCdGaWx0ZXJfUGx1Z2luX1picF9TaG93RXJyb3InLCAnSW5jbHVkZV9TaG93RXJyb3I0MDQnKTsNCiAgICB9DQoNCiAgICBpZiAoJHpicC0+b3B0aW9uWydaQ19BRERJVElPTkFMX1NFQ1VSSVRZJ10pIHsNCiAgICAgICAgaGVhZGVyKCdYLVhTUy1Qcm90ZWN0aW9uOiAxOyBtb2RlPWJsb2NrJyk7DQogICAgICAgIGlmICgkemJwLT5pc0h0dHBzKSB7DQogICAgICAgICAgICBoZWFkZXIoJ1VwZ3JhZGUtSW5zZWN1cmUtUmVxdWVzdHM6IDEnKTsNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KLyoqDQogKiDigJzlrqHmoLjkuK3kvJrlkZjigJ3nmoTliY3lj7DmnYPpmZDmi5Lnu53pqozor4ENCiAqLw0KZnVuY3Rpb24gSW5jbHVkZV9Gcm9udGVuZF9DaGVja1JpZ2h0cygkYWN0aW9uLCAkbGV2ZWwpDQp7DQogICAgZ2xvYmFsICR6YnA7DQogICAgaWYgKCR6YnAtPnVzZXItPlN0YXR1cyA9PSBaQ19NRU1CRVJfU1RBVFVTX0FVRElUSU5HKSB7DQogICAgICAgIGlmICghaW5fYXJyYXkoJGFjdGlvbiwgYXJyYXkoJ2xvZ2luJywgJ2xvZ291dCcsICdtaXNjJywgJ2ZlZWQnLCAnYWpheCcsICd2ZXJpZnknLCAnTm9WYWxpZENvZGUnLCAnTWVtYmVyRWR0JywgJ01lbWJlclBzdCcsICdNZW1iZXJNbmcnKSkpIHsNCiAgICAgICAgICAgICRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1picF9DaGVja1JpZ2h0cyddWydJbmNsdWRlX0Zyb250ZW5kX0NoZWNrUmlnaHRzJ10gPSBQTFVHSU5fRVhJVFNJR05BTF9SRVRVUk47DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCiAgICAgICAgaWYgKCR6YnAtPm9wdGlvblsnWkNfQUxMT1dfQVVESVRUSU5HX01FTUJFUl9WSVNJVF9NQU5BR0UnXSA9PSBmYWxzZSAmJiAkYWN0aW9uID09ICdhZG1pbicpIHsNCiAgICAgICAgICAgICRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1picF9DaGVja1JpZ2h0cyddWydJbmNsdWRlX0Zyb250ZW5kX0NoZWNrUmlnaHRzJ10gPSBQTFVHSU5fRVhJVFNJR05BTF9SRVRVUk47DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCiAgICB9DQp9DQoNCi8vIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQoNCi8qKg0KICog6L+H5ruk5omp5bGV5pWw5o2uLg0KICoNCiAqIEBwYXJhbSAkb2JqZWN0DQogKi8NCmZ1bmN0aW9uIEZpbHRlck1ldGEoJiRvYmplY3QpDQp7DQogICAgLy8kdHlwZT1zdHJ0b2xvd2VyKGdldF9jbGFzcygkb2JqZWN0KSk7DQoNCiAgICBmb3JlYWNoICgkX1BPU1QgYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgaWYgKHN1YnN0cigka2V5LCAwLCA1KSA9PSAnbWV0YV8nKSB7DQogICAgICAgICAgICAkbmFtZSA9IHN1YnN0cigka2V5LCAoNSAtIHN0cmxlbigka2V5KSkpOw0KICAgICAgICAgICAgJG9iamVjdC0+TWV0YXMtPiRuYW1lID0gJHZhbHVlOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgZm9yZWFjaCAoJG9iamVjdC0+TWV0YXMtPkdldERhdGEoKSBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICBpZiAoJHZhbHVlID09ICcnKSB7DQogICAgICAgICAgICAkb2JqZWN0LT5NZXRhcy0+RGVsKCRrZXkpOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQovKioNCiAqIOi/h+a7pOivhOiuuuaVsOaNri4NCiAqDQogKiBAcGFyYW0gJGNvbW1lbnQNCiAqDQogKiBAdGhyb3dzIEV4Y2VwdGlvbg0KICovDQpmdW5jdGlvbiBGaWx0ZXJDb21tZW50KCYkY29tbWVudCkNCnsNCiAgICBnbG9iYWwgJHpicDsNCg0KICAgIGlmICghQ2hlY2tSZWdFeHAoJGNvbW1lbnQtPk5hbWUsICdbbmlja25hbWVdJykpIHsNCiAgICAgICAgJHpicC0+U2hvd0Vycm9yKDE1LCBfX0ZJTEVfXywgX19MSU5FX18pOw0KICAgIH0NCiAgICBpZiAoJGNvbW1lbnQtPkVtYWlsICYmICghQ2hlY2tSZWdFeHAoJGNvbW1lbnQtPkVtYWlsLCAnW2VtYWlsXScpKSkgew0KICAgICAgICAkemJwLT5TaG93RXJyb3IoMjksIF9fRklMRV9fLCBfX0xJTkVfXyk7DQogICAgfQ0KICAgIGlmICgkY29tbWVudC0+SG9tZVBhZ2UgJiYgKCFDaGVja1JlZ0V4cCgkY29tbWVudC0+SG9tZVBhZ2UsICdbaG9tZXBhZ2VdJykpKSB7DQogICAgICAgICR6YnAtPlNob3dFcnJvcigzMCwgX19GSUxFX18sIF9fTElORV9fKTsNCiAgICB9DQoNCiAgICAkY29tbWVudC0+TmFtZSA9IEZvcm1hdFN0cmluZygkY29tbWVudC0+TmFtZSwgJ1tub2h0bWxdJyk7DQogICAgJGNvbW1lbnQtPk5hbWUgPSBzdHJfcmVwbGFjZShhcnJheSgnPCcsICc+JywgJyAnLCAn44CAJyksICcnLCAkY29tbWVudC0+TmFtZSk7DQogICAgJGNvbW1lbnQtPk5hbWUgPSBTdWJTdHJVVEY4X1N0YXJ0KCRjb21tZW50LT5OYW1lLCAwLCAkemJwLT5vcHRpb25bJ1pDX1VTRVJOQU1FX01BWCddKTsNCiAgICAkY29tbWVudC0+RW1haWwgPSBTdWJTdHJVVEY4X1N0YXJ0KCRjb21tZW50LT5FbWFpbCwgMCwgJHpicC0+b3B0aW9uWydaQ19FTUFJTF9NQVgnXSk7DQogICAgJGNvbW1lbnQtPkhvbWVQYWdlID0gU3ViU3RyVVRGOF9TdGFydCgkY29tbWVudC0+SG9tZVBhZ2UsIDAsICR6YnAtPm9wdGlvblsnWkNfSE9NRVBBR0VfTUFYJ10pOw0KDQogICAgJGNvbW1lbnQtPkNvbnRlbnQgPSBGb3JtYXRTdHJpbmcoJGNvbW1lbnQtPkNvbnRlbnQsICdbbm9odG1sXScpOw0KDQogICAgJGNvbW1lbnQtPkNvbnRlbnQgPSBTdWJTdHJVVEY4X1N0YXJ0KCRjb21tZW50LT5Db250ZW50LCAwLCAxMDAwKTsNCiAgICAkY29tbWVudC0+Q29udGVudCA9IHRyaW0oJGNvbW1lbnQtPkNvbnRlbnQpOw0KICAgIGlmIChzdHJsZW4oJGNvbW1lbnQtPkNvbnRlbnQpID09IDApIHsNCiAgICAgICAgJHpicC0+U2hvd0Vycm9yKDQ2LCBfX0ZJTEVfXywgX19MSU5FX18pOw0KICAgIH0NCn0NCg0KLyoqDQogKiDov4fmu6Tmlofnq6DmlbDmja4uDQogKg0KICogQHBhcmFtICRhcnRpY2xlDQogKi8NCmZ1bmN0aW9uIEZpbHRlclBvc3QoJiRhcnRpY2xlKQ0Kew0KICAgIGdsb2JhbCAkemJwOw0KDQogICAgJGFydGljbGUtPlRpdGxlID0gc3RyaXBfdGFncygkYXJ0aWNsZS0+VGl0bGUpOw0KICAgICRhcnRpY2xlLT5UaXRsZSA9IGh0bWxzcGVjaWFsY2hhcnMoJGFydGljbGUtPlRpdGxlKTsNCiAgICAkYXJ0aWNsZS0+QWxpYXMgPSBGb3JtYXRTdHJpbmcoJGFydGljbGUtPkFsaWFzLCAnW25vcm1hbG5hbWVdJyk7DQogICAgJGFydGljbGUtPkFsaWFzID0gc3RyX3JlcGxhY2UoJyAnLCAnJywgJGFydGljbGUtPkFsaWFzKTsNCiAgICAkYXJ0aWNsZS0+QWxpYXMgPSBzdHJfcmVwbGFjZSgn44CAJywgJycsICRhcnRpY2xlLT5BbGlhcyk7DQoNCiAgICBpZiAoJGFydGljbGUtPlR5cGUgPT0gWkNfUE9TVF9UWVBFX0FSVElDTEUpIHsNCiAgICAgICAgaWYgKCEkemJwLT5DaGVja1JpZ2h0cygnQXJ0aWNsZUFsbCcpKSB7DQogICAgICAgICAgICAkYXJ0aWNsZS0+Q29udGVudCA9IEZvcm1hdFN0cmluZygkYXJ0aWNsZS0+Q29udGVudCwgJ1tub3NjcmlwdF0nKTsNCiAgICAgICAgICAgICRhcnRpY2xlLT5JbnRybyA9IEZvcm1hdFN0cmluZygkYXJ0aWNsZS0+SW50cm8sICdbbm9zY3JpcHRdJyk7DQogICAgICAgIH0NCiAgICB9IGVsc2VpZiAoJGFydGljbGUtPlR5cGUgPT0gWkNfUE9TVF9UWVBFX1BBR0UpIHsNCiAgICAgICAgaWYgKCEkemJwLT5DaGVja1JpZ2h0cygnUGFnZUFsbCcpKSB7DQogICAgICAgICAgICAkYXJ0aWNsZS0+Q29udGVudCA9IEZvcm1hdFN0cmluZygkYXJ0aWNsZS0+Q29udGVudCwgJ1tub3NjcmlwdF0nKTsNCiAgICAgICAgICAgICRhcnRpY2xlLT5JbnRybyA9IEZvcm1hdFN0cmluZygkYXJ0aWNsZS0+SW50cm8sICdbbm9zY3JpcHRdJyk7DQogICAgICAgIH0NCiAgICB9IGVsc2Ugew0KICAgICAgICBpZiAoISR6YnAtPkNoZWNrUmlnaHRzKCdBcnRpY2xlQWxsJykpIHsNCiAgICAgICAgICAgICRhcnRpY2xlLT5Db250ZW50ID0gRm9ybWF0U3RyaW5nKCRhcnRpY2xlLT5Db250ZW50LCAnW25vc2NyaXB0XScpOw0KICAgICAgICAgICAgJGFydGljbGUtPkludHJvID0gRm9ybWF0U3RyaW5nKCRhcnRpY2xlLT5JbnRybywgJ1tub3NjcmlwdF0nKTsNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KLyoqDQogKiDov4fmu6TnlKjmiLfmlbDmja4uDQogKg0KICogQHBhcmFtICRtZW1iZXINCiAqDQogKiBAdGhyb3dzIEV4Y2VwdGlvbg0KICovDQpmdW5jdGlvbiBGaWx0ZXJNZW1iZXIoJiRtZW1iZXIpDQp7DQogICAgZ2xvYmFsICR6YnA7DQogICAgJG1lbWJlci0+SW50cm8gPSBGb3JtYXRTdHJpbmcoJG1lbWJlci0+SW50cm8sICdbbm9zY3JpcHRdJyk7DQogICAgJG1lbWJlci0+QWxpYXMgPSBGb3JtYXRTdHJpbmcoJG1lbWJlci0+QWxpYXMsICdbbm9ybWFsbmFtZV0nKTsNCiAgICAkbWVtYmVyLT5BbGlhcyA9IHN0cl9yZXBsYWNlKGFycmF5KCcvJywgJy4nLCAnICcsICfjgIAnLCAnXycpLCAnJywgJG1lbWJlci0+QWxpYXMpOw0KICAgICRtZW1iZXItPkFsaWFzID0gU3ViU3RyVVRGOF9TdGFydCgkbWVtYmVyLT5BbGlhcywgMCwgKGludCkgJHpicC0+ZGF0YWluZm9bJ01lbWJlciddWydBbGlhcyddWzJdKTsNCiAgICBpZiAoWmJwX1N0ckxlbigkbWVtYmVyLT5OYW1lKSA8ICR6YnAtPm9wdGlvblsnWkNfVVNFUk5BTUVfTUlOJ10gfHwgWmJwX1N0ckxlbigkbWVtYmVyLT5OYW1lKSA+ICR6YnAtPm9wdGlvblsnWkNfVVNFUk5BTUVfTUFYJ10pIHsNCiAgICAgICAgJHpicC0+U2hvd0Vycm9yKDc3LCBfX0ZJTEVfXywgX19MSU5FX18pOw0KICAgIH0NCg0KICAgIGlmICghQ2hlY2tSZWdFeHAoJG1lbWJlci0+TmFtZSwgJ1t1c2VybmFtZV0nKSkgew0KICAgICAgICAkemJwLT5TaG93RXJyb3IoNzcsIF9fRklMRV9fLCBfX0xJTkVfXyk7DQogICAgfQ0KDQogICAgaWYgKCRtZW1iZXItPkFsaWFzICE9ICcnICYmICFDaGVja1JlZ0V4cCgkbWVtYmVyLT5BbGlhcywgJ1tuaWNrbmFtZV0nKSkgew0KICAgICAgICAkemJwLT5TaG93RXJyb3IoOTAsIF9fRklMRV9fLCBfX0xJTkVfXyk7DQogICAgfQ0KDQogICAgaWYgKCFDaGVja1JlZ0V4cCgkbWVtYmVyLT5FbWFpbCwgJ1tlbWFpbF0nKSkgew0KICAgICAgICAkbWVtYmVyLT5FbWFpbCA9ICdudWxsQG51bGwuY29tJzsNCiAgICB9DQogICAgJG1lbWJlci0+RW1haWwgPSBzdHJ0b2xvd2VyKCRtZW1iZXItPkVtYWlsKTsNCg0KICAgIGlmIChzdWJzdHIoJG1lbWJlci0+SG9tZVBhZ2UsIDAsIDQpICE9ICdodHRwJykgew0KICAgICAgICAkbWVtYmVyLT5Ib21lUGFnZSA9ICdodHRwOi8vJyAuICRtZW1iZXItPkhvbWVQYWdlOw0KICAgIH0NCg0KICAgIGlmICghQ2hlY2tSZWdFeHAoJG1lbWJlci0+SG9tZVBhZ2UsICdbaG9tZXBhZ2VdJykpIHsNCiAgICAgICAgJG1lbWJlci0+SG9tZVBhZ2UgPSAnJzsNCiAgICB9DQoNCiAgICBpZiAoc3RybGVuKCRtZW1iZXItPkVtYWlsKSA+ICR6YnAtPm9wdGlvblsnWkNfRU1BSUxfTUFYJ10pIHsNCiAgICAgICAgJHpicC0+U2hvd0Vycm9yKDI5LCBfX0ZJTEVfXywgX19MSU5FX18pOw0KICAgIH0NCg0KICAgIGlmIChzdHJsZW4oJG1lbWJlci0+SG9tZVBhZ2UpID4gJHpicC0+b3B0aW9uWydaQ19IT01FUEFHRV9NQVgnXSkgew0KICAgICAgICAkemJwLT5TaG93RXJyb3IoMzAsIF9fRklMRV9fLCBfX0xJTkVfXyk7DQogICAgfQ0KfQ0KDQovKioNCiAqIOi/h+a7pOaooeWdl+aVsOaNri4NCiAqDQogKiBAcGFyYW0gJG1vZHVsZQ0KICovDQpmdW5jdGlvbiBGaWx0ZXJNb2R1bGUoJiRtb2R1bGUpDQp7DQogICAgZ2xvYmFsICR6YnA7DQogICAgJG1vZHVsZS0+RmlsZU5hbWUgPSBGb3JtYXRTdHJpbmcoJG1vZHVsZS0+RmlsZU5hbWUsICdbZmlsZW5hbWVdJyk7DQogICAgJG1vZHVsZS0+SHRtbElEID0gRm9ybWF0U3RyaW5nKCRtb2R1bGUtPkh0bWxJRCwgJ1tub3JtYWxuYW1lXScpOw0KfQ0KDQovKioNCiAqIOi/h+a7pOWIhuexu+aVsOaNri4NCiAqDQogKiBAcGFyYW0gJGNhdGVnb3J5DQogKi8NCmZ1bmN0aW9uIEZpbHRlckNhdGVnb3J5KCYkY2F0ZWdvcnkpDQp7DQogICAgZ2xvYmFsICR6YnA7DQogICAgJGNhdGVnb3J5LT5OYW1lID0gc3RyaXBfdGFncygkY2F0ZWdvcnktPk5hbWUpOw0KICAgICRjYXRlZ29yeS0+TmFtZSA9IHRyaW0oJGNhdGVnb3J5LT5OYW1lKTsNCiAgICAkY2F0ZWdvcnktPkFsaWFzID0gRm9ybWF0U3RyaW5nKCRjYXRlZ29yeS0+QWxpYXMsICdbbm9ybWFsbmFtZV0nKTsNCiAgICAvLyRjYXRlZ29yeS0+QWxpYXM9c3RyX3JlcGxhY2UoJy8nLCcnLCRjYXRlZ29yeS0+QWxpYXMpOw0KICAgICRjYXRlZ29yeS0+QWxpYXMgPSBzdHJfcmVwbGFjZSgnLicsICcnLCAkY2F0ZWdvcnktPkFsaWFzKTsNCiAgICAkY2F0ZWdvcnktPkFsaWFzID0gc3RyX3JlcGxhY2UoJyAnLCAnJywgJGNhdGVnb3J5LT5BbGlhcyk7DQogICAgJGNhdGVnb3J5LT5BbGlhcyA9IHN0cl9yZXBsYWNlKCdfJywgJycsICRjYXRlZ29yeS0+QWxpYXMpOw0KICAgICRjYXRlZ29yeS0+QWxpYXMgPSB0cmltKCRjYXRlZ29yeS0+QWxpYXMpOw0KfQ0KDQovKioNCiAqIOi/h+a7pHRhZ+aVsOaNri4NCiAqDQogKiBAcGFyYW0gJHRhZw0KICovDQpmdW5jdGlvbiBGaWx0ZXJUYWcoJiR0YWcpDQp7DQogICAgZ2xvYmFsICR6YnA7DQogICAgJHRhZy0+TmFtZSA9IHN0cmlwX3RhZ3MoJHRhZy0+TmFtZSk7DQogICAgJHRhZy0+TmFtZSA9IHRyaW0oJHRhZy0+TmFtZSk7DQogICAgJHRhZy0+QWxpYXMgPSBGb3JtYXRTdHJpbmcoJHRhZy0+QWxpYXMsICdbbm9ybWFsbmFtZV0nKTsNCiAgICAkdGFnLT5BbGlhcyA9IHN0cl9yZXBsYWNlKCcuJywgJycsICR0YWctPkFsaWFzKTsNCiAgICAkdGFnLT5BbGlhcyA9IHN0cl9yZXBsYWNlKCcgJywgJycsICR0YWctPkFsaWFzKTsNCiAgICAkdGFnLT5BbGlhcyA9IHN0cl9yZXBsYWNlKCdfJywgJycsICR0YWctPkFsaWFzKTsNCiAgICAkdGFnLT5BbGlhcyA9IHRyaW0oJHRhZy0+QWxpYXMpOw0KfQ0KDQovLyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KLy/nu5/orqHlh73mlbANCg0KLyoqDQogKue7n+iuoee9rumhtuaWh+eroOaVsOe7hC4NCiAqDQogKiBAcGFyYW0gaW50ICAkdHlwZQ0KICogQHBhcmFtIG51bGwgJGFkZHBsdXMNCiAqIEBwYXJhbSBudWxsICRkZWxwbHVzDQogKi8NCmZ1bmN0aW9uIENvdW50VG9wUG9zdCgkdHlwZSA9IDAsICRhZGRwbHVzID0gbnVsbCwgJGRlbHBsdXMgPSBudWxsKQ0Kew0KICAgIGdsb2JhbCAkemJwOw0KICAgICR2YXJuYW1lID0gJ3RvcF9wb3N0X2FycmF5XycgLiAkdHlwZTsNCiAgICBAJGFycmF5ID0gdW5zZXJpYWxpemUoJHpicC0+Y2FjaGUtPiR2YXJuYW1lKTsNCiAgICBpZiAoIWlzX2FycmF5KCRhcnJheSkpIHsNCiAgICAgICAgJGFycmF5ID0gYXJyYXkoKTsNCiAgICB9DQoNCiAgICBpZiAoJGFkZHBsdXMgPT09IG51bGwgJiYgJGRlbHBsdXMgPT09IG51bGwpIHsNCiAgICAgICAgJHMgPSAkemJwLT5kYi0+c3FsLT5TZWxlY3QoJHpicC0+dGFibGVbJ1Bvc3QnXSwgJ2xvZ19JRCcsIGFycmF5KGFycmF5KCc9JywgJ2xvZ19UeXBlJywgJHR5cGUpLCBhcnJheSgnPicsICdsb2dfSXNUb3AnLCAwKSwgYXJyYXkoJz0nLCAnbG9nX1N0YXR1cycsIDApKSwgbnVsbCwgbnVsbCwgbnVsbCk7DQogICAgICAgICRhID0gJHpicC0+ZGItPlF1ZXJ5KCRzKTsNCiAgICAgICAgZm9yZWFjaCAoJGEgYXMgJGlkKSB7DQogICAgICAgICAgICAkYXJyYXlbKGludCkgY3VycmVudCgkaWQpXSA9IChpbnQpIGN1cnJlbnQoJGlkKTsNCiAgICAgICAgfQ0KICAgIH0gZWxzZWlmICgkYWRkcGx1cyAhPT0gbnVsbCAmJiAkZGVscGx1cyA9PT0gbnVsbCkgew0KICAgICAgICAkYWRkcGx1cyA9IChpbnQpICRhZGRwbHVzOw0KICAgICAgICAkYXJyYXlbJGFkZHBsdXNdID0gJGFkZHBsdXM7DQogICAgfSBlbHNlaWYgKCRhZGRwbHVzID09PSBudWxsICYmICRkZWxwbHVzICE9PSBudWxsKSB7DQogICAgICAgICRkZWxwbHVzID0gKGludCkgJGRlbHBsdXM7DQogICAgICAgIHVuc2V0KCRhcnJheVskZGVscGx1c10pOw0KICAgIH0NCg0KICAgICR6YnAtPmNhY2hlLT4kdmFybmFtZSA9IHNlcmlhbGl6ZSgkYXJyYXkpOw0KfQ0KDQovKioNCiAq57uf6K6h6K+E6K665pWwLg0KICoNCiAqIEBwYXJhbSBpbnQgJGFsbHBsdXMg5o6n5Yi25piv5ZCm6KaB6L+b6KGM5YWo6KGo5omr5o+PIOaAu+ivhOiuug0KICogQHBhcmFtIGludCAkY2hrcGx1cyDmjqfliLbmmK/lkKbopoHov5vooYzlhajooajmiavmj48g5pyq5a6h5qC46K+E6K66DQogKi8NCmZ1bmN0aW9uIENvdW50Q29tbWVudE51bXMoJGFsbHBsdXMgPSBudWxsLCAkY2hrcGx1cyA9IG51bGwpDQp7DQogICAgZ2xvYmFsICR6YnA7DQoNCiAgICBpZiAoJGFsbHBsdXMgPT09IG51bGwpIHsNCiAgICAgICAgJHpicC0+Y2FjaGUtPmFsbF9jb21tZW50X251bXMgPSAoaW50KSBHZXRWYWx1ZUluQXJyYXlCeUN1cnJlbnQoJHpicC0+ZGItPnNxbC0+Z2V0KCktPnNlbGVjdCgkR0xPQkFMU1sndGFibGUnXVsnQ29tbWVudCddKS0+Y291bnQoYXJyYXkoJyonID0+ICdudW0nKSktPnF1ZXJ5LCAnbnVtJyk7DQogICAgfSBlbHNlIHsNCiAgICAgICAgJHpicC0+Y2FjaGUtPmFsbF9jb21tZW50X251bXMgKz0gJGFsbHBsdXM7DQogICAgfQ0KICAgIGlmICgkY2hrcGx1cyA9PT0gbnVsbCkgew0KICAgICAgICAkemJwLT5jYWNoZS0+Y2hlY2tfY29tbWVudF9udW1zID0gKGludCkgR2V0VmFsdWVJbkFycmF5QnlDdXJyZW50KCR6YnAtPmRiLT5zcWwtPmdldCgpLT5zZWxlY3QoJEdMT0JBTFNbJ3RhYmxlJ11bJ0NvbW1lbnQnXSktPmNvdW50KGFycmF5KCcqJyA9PiAnbnVtJykpLT53aGVyZSgnPScsICdjb21tX0lzY2hlY2tpbmcnLCAnMScpLT5xdWVyeSwgJ251bScpOw0KICAgIH0gZWxzZSB7DQogICAgICAgICR6YnAtPmNhY2hlLT5jaGVja19jb21tZW50X251bXMgKz0gJGNoa3BsdXM7DQogICAgfQ0KICAgICR6YnAtPmNhY2hlLT5ub3JtYWxfY29tbWVudF9udW1zID0gKGludCkgKCR6YnAtPmNhY2hlLT5hbGxfY29tbWVudF9udW1zIC0gJHpicC0+Y2FjaGUtPmNoZWNrX2NvbW1lbnRfbnVtcyk7DQp9DQoNCi8qKg0KICrnu5/orqHlhazlvIDmlofnq6DmlbAuDQogKg0KICogQHBhcmFtIGludCAkcGx1cyDmjqfliLbmmK/lkKbopoHov5vooYzlhajooajmiavmj48NCiAqLw0KZnVuY3Rpb24gQ291bnROb3JtYWxBcnRpY2xlTnVtcygkcGx1cyA9IG51bGwpDQp7DQogICAgZ2xvYmFsICR6YnA7DQoNCiAgICBpZiAoJHBsdXMgPT09IG51bGwpIHsNCiAgICAgICAgJHMgPSAkemJwLT5kYi0+c3FsLT5Db3VudCgkemJwLT50YWJsZVsnUG9zdCddLCBhcnJheShhcnJheSgnQ09VTlQnLCAnKicsICdudW0nKSksIGFycmF5KGFycmF5KCc9JywgJ2xvZ19UeXBlJywgMCksIGFycmF5KCc9JywgJ2xvZ19Jc1RvcCcsIDApLCBhcnJheSgnPScsICdsb2dfU3RhdHVzJywgMCkpKTsNCiAgICAgICAgJG51bSA9IEdldFZhbHVlSW5BcnJheUJ5Q3VycmVudCgkemJwLT5kYi0+UXVlcnkoJHMpLCAnbnVtJyk7DQoNCiAgICAgICAgJHpicC0+Y2FjaGUtPm5vcm1hbF9hcnRpY2xlX251bXMgPSAkbnVtOw0KICAgIH0gZWxzZSB7DQogICAgICAgICR6YnAtPmNhY2hlLT5ub3JtYWxfYXJ0aWNsZV9udW1zICs9ICRwbHVzOw0KICAgIH0NCn0NCg0KLyoqDQogKiDnu5/orqHmlofnq6DkuIvor4TorrrmlbAuDQogKg0KICogQHBhcmFtIHBvc3QgJGFydGljbGUNCiAqIEBwYXJhbSBpbnQgICRwbHVzICAgIOaOp+WItuaYr+WQpuimgei/m+ihjOWFqOihqOaJq+aPjw0KICovDQpmdW5jdGlvbiBDb3VudFBvc3QoJiRhcnRpY2xlLCAkcGx1cyA9IG51bGwpDQp7DQogICAgZ2xvYmFsICR6YnA7DQoNCiAgICBpZiAoJHBsdXMgPT09IG51bGwpIHsNCiAgICAgICAgJGlkID0gJGFydGljbGUtPklEOw0KDQogICAgICAgICRzID0gJHpicC0+ZGItPnNxbC0+Q291bnQoJHpicC0+dGFibGVbJ0NvbW1lbnQnXSwgYXJyYXkoYXJyYXkoJ0NPVU5UJywgJyonLCAnbnVtJykpLCBhcnJheShhcnJheSgnPScsICdjb21tX0xvZ0lEJywgJGlkKSwgYXJyYXkoJz0nLCAnY29tbV9Jc0NoZWNraW5nJywgMCkpKTsNCiAgICAgICAgJG51bSA9IEdldFZhbHVlSW5BcnJheUJ5Q3VycmVudCgkemJwLT5kYi0+UXVlcnkoJHMpLCAnbnVtJyk7DQoNCiAgICAgICAgJGFydGljbGUtPkNvbW1OdW1zID0gJG51bTsNCiAgICB9IGVsc2Ugew0KICAgICAgICAkYXJ0aWNsZS0+Q29tbU51bXMgKz0gJHBsdXM7DQogICAgfQ0KfQ0KDQovKioNCiAqIOaJuemHj+e7n+iuoeaMh+WumuaWh+eroOS4i+ivhOiuuuaVsOW5tuS/neWtmC4NCiAqDQogKiBAcGFyYW0gYXJyYXkgJGFycmF5IOiusOW9leaWh+eroElE55qE5pWw57uEDQogKiBAcGFyYW0gaW50ICAgJHBsdXMgIOaOp+WItuaYr+WQpuimgei/m+ihjOWFqOihqOaJq+aPjw0KICogQHBhcmFtIGludCAgICAgICR0eXBlICAgICAgcG9zdOWSjGNhdGVnb3J555qE5YiG57G7VHlwZQ0KICovDQpmdW5jdGlvbiBDb3VudFBvc3RBcnJheSgkYXJyYXksICRwbHVzID0gbnVsbCwgJHR5cGUgPSAwKQ0Kew0KICAgIGdsb2JhbCAkemJwOw0KICAgICRhcnJheSA9IGFycmF5X3VuaXF1ZSgkYXJyYXkpOw0KICAgIGZvcmVhY2ggKCRhcnJheSBhcyAkdmFsdWUpIHsNCiAgICAgICAgaWYgKCR2YWx1ZSA9PSAwKSB7DQogICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgfQ0KDQogICAgICAgICRhcnRpY2xlID0gJHpicC0+R2V0UG9zdEJ5SUQoJHZhbHVlKTsNCiAgICAgICAgaWYgKCRhcnRpY2xlLT5JRCA+IDApIHsNCiAgICAgICAgICAgIENvdW50UG9zdCgkYXJ0aWNsZSwgJHBsdXMsICR0eXBlKTsNCiAgICAgICAgICAgICRhcnRpY2xlLT5TYXZlKCk7DQogICAgICAgIH0NCiAgICB9DQp9DQoNCi8qKg0KICog57uf6K6h5YiG57G75LiL5paH56ug5pWwLg0KICoNCiAqIEBwYXJhbSBDYXRlZ29yeSAmJGNhdGVnb3J5DQogKiBAcGFyYW0gaW50ICAgICAgJHBsdXMgICAgICDmjqfliLbmmK/lkKbopoHov5vooYzlhajooajmiavmj48NCiAqIEBwYXJhbSBpbnQgICAgICAkdHlwZSAgICAgIHBvc3TlkoxjYXRlZ29yeeeahOWIhuexu1R5cGUNCiAqLw0KZnVuY3Rpb24gQ291bnRDYXRlZ29yeSgmJGNhdGVnb3J5LCAkcGx1cyA9IG51bGwsICR0eXBlID0gMCkNCnsNCiAgICBnbG9iYWwgJHpicDsNCg0KICAgIGlmICgkcGx1cyA9PT0gbnVsbCkgew0KICAgICAgICAkaWQgPSAkY2F0ZWdvcnktPklEOw0KDQogICAgICAgICRzID0gJHpicC0+ZGItPnNxbC0+Q291bnQoJHpicC0+dGFibGVbJ1Bvc3QnXSwgYXJyYXkoYXJyYXkoJ0NPVU5UJywgJyonLCAnbnVtJykpLCBhcnJheShhcnJheSgnPScsICdsb2dfVHlwZScsICR0eXBlKSwgYXJyYXkoJz0nLCAnbG9nX1N0YXR1cycsIDApLCBhcnJheSgnPScsICdsb2dfQ2F0ZUlEJywgJGlkKSkpOw0KICAgICAgICAkbnVtID0gR2V0VmFsdWVJbkFycmF5QnlDdXJyZW50KCR6YnAtPmRiLT5RdWVyeSgkcyksICdudW0nKTsNCg0KICAgICAgICAkY2F0ZWdvcnktPkNvdW50ID0gJG51bTsNCiAgICB9IGVsc2Ugew0KICAgICAgICAkY2F0ZWdvcnktPkNvdW50ICs9ICRwbHVzOw0KICAgIH0NCn0NCg0KLyoqDQogKiDmibnph4/nu5/orqHmjIflrprliIbnsbvkuIvmlofnq6DmlbDlubbkv53lrZguDQogKg0KICogQHBhcmFtIGFycmF5ICRhcnJheSDorrDlvZXliIbnsbtJROeahOaVsOe7hA0KICogQHBhcmFtIGludCAgICRwbHVzICDmjqfliLbmmK/lkKbopoHov5vooYzlhajooajmiavmj48NCiAqIEBwYXJhbSBpbnQgICAkdHlwZSAgcG9zdOWSjGNhdGVnb3J555qE5YiG57G7VHlwZQ0KICovDQpmdW5jdGlvbiBDb3VudENhdGVnb3J5QXJyYXkoJGFycmF5LCAkcGx1cyA9IG51bGwsICR0eXBlID0gMCkNCnsNCiAgICBnbG9iYWwgJHpicDsNCiAgICAkYXJyYXkgPSBhcnJheV91bmlxdWUoJGFycmF5KTsNCiAgICBmb3JlYWNoICgkYXJyYXkgYXMgJHZhbHVlKSB7DQogICAgICAgIGlmICgkdmFsdWUgPT0gMCkgew0KICAgICAgICAgICAgY29udGludWU7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGlzc2V0KCR6YnAtPmNhdGVnb3JpZXNfYWxsWyR2YWx1ZV0pKSB7DQogICAgICAgICAgICBDb3VudENhdGVnb3J5KCR6YnAtPmNhdGVnb3JpZXNfYWxsWyR2YWx1ZV0sICRwbHVzLCAkdHlwZSk7DQogICAgICAgICAgICAkemJwLT5jYXRlZ29yaWVzX2FsbFskdmFsdWVdLT5TYXZlKCk7DQogICAgICAgIH0NCiAgICB9DQp9DQoNCi8qKg0KICog57uf6K6hdGFn5LiL55qE5paH56ug5pWwLg0KICoNCiAqIEBwYXJhbSB0YWcgJiR0YWcNCiAqIEBwYXJhbSBpbnQgJHBsdXMg5o6n5Yi25piv5ZCm6KaB6L+b6KGM5YWo6KGo5omr5o+PDQogKiBAcGFyYW0gaW50ICR0eXBlIHBvc3Tlkox0YWfnmoTliIbnsbtUeXBlDQogKi8NCmZ1bmN0aW9uIENvdW50VGFnKCYkdGFnLCAkcGx1cyA9IG51bGwsICR0eXBlID0gMCkNCnsNCiAgICBnbG9iYWwgJHpicDsNCg0KICAgIGlmICgkcGx1cyA9PT0gbnVsbCkgew0KICAgICAgICAkaWQgPSAkdGFnLT5JRDsNCiAgICAgICAgJHcgPSBhcnJheSgpOw0KICAgICAgICAkd1tdID0gYXJyYXkoJz0nLCAnbG9nX1R5cGUnLCAkdHlwZSk7DQogICAgICAgICR3W10gPSBhcnJheSgnTElLRScsICdsb2dfVGFnJywgJyV7JyAuICRpZCAuICd9JScpOw0KICAgICAgICAkcyA9ICR6YnAtPmRiLT5zcWwtPkNvdW50KCR6YnAtPnRhYmxlWydQb3N0J10sIGFycmF5KGFycmF5KCdDT1VOVCcsICcqJywgJ251bScpKSwgJHcpOw0KICAgICAgICAkbnVtID0gR2V0VmFsdWVJbkFycmF5QnlDdXJyZW50KCR6YnAtPmRiLT5RdWVyeSgkcyksICdudW0nKTsNCg0KICAgICAgICAkdGFnLT5Db3VudCA9ICRudW07DQogICAgfSBlbHNlIHsNCiAgICAgICAgJHRhZy0+Q291bnQgKz0gJHBsdXM7DQogICAgfQ0KfQ0KDQovKioNCiAqIOaJuemHj+e7n+iuoeaMh+WumnRhZ+S4i+aWh+eroOaVsOW5tuS/neWtmC4NCiAqDQogKiBAcGFyYW0gc3RyaW5nICRzdHJpbmcg57G75Ly8J3sxfXsyfXszfXs0fXs0fSfnmoR0YWdJROS4sg0KICogQHBhcmFtIGludCAgICAkcGx1cyAgIOaOp+WItuaYr+WQpuimgei/m+ihjOWFqOihqOaJq+aPjw0KICogQHBhcmFtIGludCAgICAkYXJ0aWNsZWlkICAg5pqC5rKh5Y+R546w5pyJ55So5aSE55qE5Y+C5pWwDQogKg0KICogQHJldHVybiBib29sDQogKi8NCmZ1bmN0aW9uIENvdW50VGFnQXJyYXlTdHJpbmcoJHN0cmluZywgJHBsdXMgPSBudWxsLCAkYXJ0aWNsZWlkID0gbnVsbCkNCnsNCiAgICBnbG9iYWwgJHpicDsNCiAgICAvKiBAdmFyIFRhZ1tdICRhcnJheSAqLw0KICAgICRhcnJheSA9ICR6YnAtPkxvYWRUYWdzQnlJRFN0cmluZygkc3RyaW5nKTsNCg0KICAgIC8v5re75Yqg5aSn5pWw5o2u5o6l5Y+jLHRhZyxwbHVzLGlkDQogICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fTGFyZ2VEYXRhX0NvdW50VGFnQXJyYXknXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgJGZwcmV0dXJuID0gJGZwbmFtZSgkYXJyYXksICRwbHVzLCAkYXJ0aWNsZWlkKTsNCiAgICAgICAgaWYgKCRmcHNpZ25hbCA9PSBQTFVHSU5fRVhJVFNJR05BTF9SRVRVUk4pIHsNCiAgICAgICAgICAgICRmcHNpZ25hbCA9IFBMVUdJTl9FWElUU0lHTkFMX05PTkU7DQoNCiAgICAgICAgICAgIHJldHVybiAkZnByZXR1cm47DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBmb3JlYWNoICgkYXJyYXkgYXMgJiR0YWcpIHsNCiAgICAgICAgQ291bnRUYWcoJHRhZywgJHBsdXMsICR0YWctPlR5cGUpOw0KICAgICAgICAkdGFnLT5TYXZlKCk7DQogICAgfQ0KDQogICAgcmV0dXJuIHRydWU7DQp9DQoNCi8qKg0KICog57uf6K6h55So5oi35LiL55qE5paH56ug5pWw44CB6aG16Z2i5pWw44CB6K+E6K665pWw44CB6ZmE5Lu25pWw562JLg0KICoNCiAqIEBwYXJhbSAkbWVtYmVyDQogKiBAcGFyYW0gYXJyYXkgJHBsdXMg6K6+572u5piv5ZCm6ZyA6KaB5a6M5YWo5YWo6KGo5omr5o+PDQogKi8NCmZ1bmN0aW9uIENvdW50TWVtYmVyKCYkbWVtYmVyLCAkcGx1cyA9IGFycmF5KG51bGwsIG51bGwsIG51bGwsIG51bGwpKQ0Kew0KICAgIGdsb2JhbCAkemJwOw0KICAgIGlmICghKCRtZW1iZXIgaW5zdGFuY2VvZiBNZW1iZXIpKSB7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICAkaWQgPSAkbWVtYmVyLT5JRDsNCg0KICAgIGlmICgkcGx1c1swXSA9PT0gbnVsbCkgew0KICAgICAgICAkcyA9ICR6YnAtPmRiLT5zcWwtPkNvdW50KCR6YnAtPnRhYmxlWydQb3N0J10sIGFycmF5KGFycmF5KCdDT1VOVCcsICcqJywgJ251bScpKSwgYXJyYXkoYXJyYXkoJz0nLCAnbG9nX0F1dGhvcklEJywgJGlkKSwgYXJyYXkoJz0nLCAnbG9nX1R5cGUnLCAwKSkpOw0KICAgICAgICAkbWVtYmVyX0FydGljbGVzID0gR2V0VmFsdWVJbkFycmF5QnlDdXJyZW50KCR6YnAtPmRiLT5RdWVyeSgkcyksICdudW0nKTsNCiAgICAgICAgJG1lbWJlci0+QXJ0aWNsZXMgPSAkbWVtYmVyX0FydGljbGVzOw0KICAgIH0gZWxzZSB7DQogICAgICAgICRtZW1iZXItPkFydGljbGVzICs9ICRwbHVzWzBdOw0KICAgIH0NCg0KICAgIGlmICgkcGx1c1sxXSA9PT0gbnVsbCkgew0KICAgICAgICAkcyA9ICR6YnAtPmRiLT5zcWwtPkNvdW50KCR6YnAtPnRhYmxlWydQb3N0J10sIGFycmF5KGFycmF5KCdDT1VOVCcsICcqJywgJ251bScpKSwgYXJyYXkoYXJyYXkoJz0nLCAnbG9nX0F1dGhvcklEJywgJGlkKSwgYXJyYXkoJz0nLCAnbG9nX1R5cGUnLCAxKSkpOw0KICAgICAgICAkbWVtYmVyX1BhZ2VzID0gR2V0VmFsdWVJbkFycmF5QnlDdXJyZW50KCR6YnAtPmRiLT5RdWVyeSgkcyksICdudW0nKTsNCiAgICAgICAgJG1lbWJlci0+UGFnZXMgPSAkbWVtYmVyX1BhZ2VzOw0KICAgIH0gZWxzZSB7DQogICAgICAgICRtZW1iZXItPlBhZ2VzICs9ICRwbHVzWzFdOw0KICAgIH0NCg0KICAgIGlmICgkcGx1c1syXSA9PT0gbnVsbCkgew0KICAgICAgICBpZiAoJG1lbWJlci0+SUQgPiAwKSB7DQogICAgICAgICAgICAkcyA9ICR6YnAtPmRiLT5zcWwtPkNvdW50KCR6YnAtPnRhYmxlWydDb21tZW50J10sIGFycmF5KGFycmF5KCdDT1VOVCcsICcqJywgJ251bScpKSwgYXJyYXkoYXJyYXkoJz0nLCAnY29tbV9BdXRob3JJRCcsICRpZCksIGFycmF5KCc9JywgJ2NvbW1fSXNDaGVja2luZycsIDApKSk7DQogICAgICAgICAgICAkbWVtYmVyX0NvbW1lbnRzID0gR2V0VmFsdWVJbkFycmF5QnlDdXJyZW50KCR6YnAtPmRiLT5RdWVyeSgkcyksICdudW0nKTsNCiAgICAgICAgICAgICRtZW1iZXItPkNvbW1lbnRzID0gJG1lbWJlcl9Db21tZW50czsNCiAgICAgICAgfQ0KICAgIH0gZWxzZSB7DQogICAgICAgICRtZW1iZXItPkNvbW1lbnRzICs9ICRwbHVzWzJdOw0KICAgIH0NCg0KICAgIGlmICgkcGx1c1szXSA9PT0gbnVsbCkgew0KICAgICAgICAkcyA9ICR6YnAtPmRiLT5zcWwtPkNvdW50KCR6YnAtPnRhYmxlWydVcGxvYWQnXSwgYXJyYXkoYXJyYXkoJ0NPVU5UJywgJyonLCAnbnVtJykpLCBhcnJheShhcnJheSgnPScsICd1bF9BdXRob3JJRCcsICRpZCkpKTsNCiAgICAgICAgJG1lbWJlcl9VcGxvYWRzID0gR2V0VmFsdWVJbkFycmF5QnlDdXJyZW50KCR6YnAtPmRiLT5RdWVyeSgkcyksICdudW0nKTsNCiAgICAgICAgJG1lbWJlci0+VXBsb2FkcyA9ICRtZW1iZXJfVXBsb2FkczsNCiAgICB9IGVsc2Ugew0KICAgICAgICAkbWVtYmVyLT5VcGxvYWRzICs9ICRwbHVzWzNdOw0KICAgIH0NCn0NCg0KLyoqDQogKiDmibnph4/nu5/orqHmjIflrprnlKjmiLfmlbDmja7lubbkv53lrZguDQogKg0KICogQHBhcmFtIGFycmF5ICRhcnJheSDorrDlvZXnlKjmiLdJROeahOaVsOe7hA0KICogQHBhcmFtIGFycmF5ICRwbHVzICDorr7nva7mmK/lkKbpnIDopoHlrozlhajlhajooajmiavmj48NCiAqLw0KZnVuY3Rpb24gQ291bnRNZW1iZXJBcnJheSgkYXJyYXksICRwbHVzID0gYXJyYXkobnVsbCwgbnVsbCwgbnVsbCwgbnVsbCkpDQp7DQogICAgZ2xvYmFsICR6YnA7DQogICAgJGFycmF5ID0gYXJyYXlfdW5pcXVlKCRhcnJheSk7DQogICAgZm9yZWFjaCAoJGFycmF5IGFzICR2YWx1ZSkgew0KICAgICAgICBpZiAoJHZhbHVlID09IDApIHsNCiAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKGlzc2V0KCR6YnAtPm1lbWJlcnNbJHZhbHVlXSkpIHsNCiAgICAgICAgICAgIENvdW50TWVtYmVyKCR6YnAtPm1lbWJlcnNbJHZhbHVlXSwgJHBsdXMpOw0KICAgICAgICAgICAgJHpicC0+bWVtYmVyc1skdmFsdWVdLT5TYXZlKCk7DQogICAgICAgIH0NCiAgICB9DQp9DQoNCi8vIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQoNCi8qKg0KICogQnVpbGRNb2R1bGVfY2F0YWxvZw0KICoNCiAqIEBkZXByZWNhdGVkDQogKg0KICogQHRocm93cyBFeGNlcHRpb24NCiAqDQogKiBAcmV0dXJuIHN0cmluZw0KICovDQpmdW5jdGlvbiBCdWlsZE1vZHVsZV9jYXRhbG9nKCkNCnsNCiAgICByZXR1cm4gTW9kdWxlQnVpbGRlcjo6Q2F0YWxvZygpOw0KfQ0KDQovKioNCiAqIEJ1aWxkTW9kdWxlX2NhbGVuZGFyDQogKg0KICogQHBhcmFtIHN0cmluZyAkZGF0ZQ0KICoNCiAqIEBkZXByZWNhdGVkDQogKg0KICogQHRocm93cyBFeGNlcHRpb24NCiAqDQogKiBAcmV0dXJuIHN0cmluZw0KICovDQpmdW5jdGlvbiBCdWlsZE1vZHVsZV9jYWxlbmRhcigkZGF0ZSA9ICcnKQ0Kew0KICAgIHJldHVybiBNb2R1bGVCdWlsZGVyOjpDYWxlbmRhcigkZGF0ZSk7DQp9DQoNCi8qKg0KICogQnVpbGRNb2R1bGVfY29tbWVudHMNCiAqDQogKiBAZGVwcmVjYXRlZA0KICoNCiAqIEB0aHJvd3MgRXhjZXB0aW9uDQogKg0KICogQHJldHVybiBzdHJpbmcNCiAqLw0KZnVuY3Rpb24gQnVpbGRNb2R1bGVfY29tbWVudHMoKQ0Kew0KICAgIHJldHVybiBNb2R1bGVCdWlsZGVyOjpDb21tZW50cygpOw0KfQ0KDQovKioNCiAqIEJ1aWxkTW9kdWxlX3ByZXZpb3VzDQogKg0KICogQGRlcHJlY2F0ZWQNCiAqDQogKiBAdGhyb3dzIEV4Y2VwdGlvbg0KICoNCiAqIEByZXR1cm4gc3RyaW5nDQogKi8NCmZ1bmN0aW9uIEJ1aWxkTW9kdWxlX3ByZXZpb3VzKCkNCnsNCiAgICByZXR1cm4gTW9kdWxlQnVpbGRlcjo6TGF0ZXN0QXJ0aWNsZXMoKTsNCn0NCg0KLyoqDQogKiBCdWlsZE1vZHVsZV9hcmNoaXZlcw0KICoNCiAqIEBkZXByZWNhdGVkDQogKg0KICogQHRocm93cyBFeGNlcHRpb24NCiAqDQogKiBAcmV0dXJuIHN0cmluZw0KICovDQpmdW5jdGlvbiBCdWlsZE1vZHVsZV9hcmNoaXZlcygpDQp7DQogICAgcmV0dXJuIE1vZHVsZUJ1aWxkZXI6OkFyY2hpdmVzKCk7DQp9DQoNCi8qKg0KICogQnVpbGRNb2R1bGVfbmF2YmFyDQogKg0KICogQGRlcHJlY2F0ZWQNCiAqDQogKiBAdGhyb3dzIEV4Y2VwdGlvbg0KICoNCiAqIEByZXR1cm4gc3RyaW5nDQogKi8NCmZ1bmN0aW9uIEJ1aWxkTW9kdWxlX25hdmJhcigpDQp7DQogICAgcmV0dXJuIE1vZHVsZUJ1aWxkZXI6Ok5hdmJhcigpOw0KfQ0KDQovKioNCiAqIEJ1aWxkTW9kdWxlX3RhZ3MNCiAqDQogKiBAZGVwcmVjYXRlZA0KICoNCiAqIEB0aHJvd3MgRXhjZXB0aW9uDQogKg0KICogQHJldHVybiBzdHJpbmcNCiAqLw0KZnVuY3Rpb24gQnVpbGRNb2R1bGVfdGFncygpDQp7DQogICAgcmV0dXJuIE1vZHVsZUJ1aWxkZXI6OlRhZ0xpc3QoKTsNCn0NCg0KLyoqDQogKiBCdWlsZE1vZHVsZV9hdXRob3JzDQogKg0KICogQHBhcmFtIGludCAkbGV2ZWwNCiAqDQogKiBAZGVwcmVjYXRlZA0KICoNCiAqIEB0aHJvd3MgRXhjZXB0aW9uDQogKg0KICogQHJldHVybiBzdHJpbmcNCiAqLw0KZnVuY3Rpb24gQnVpbGRNb2R1bGVfYXV0aG9ycygkbGV2ZWwgPSA0KQ0Kew0KICAgIHJldHVybiBNb2R1bGVCdWlsZGVyOjpBdXRob3JzKCRsZXZlbCk7DQp9DQoNCi8qKg0KICogQnVpbGRNb2R1bGVfc3RhdGlzdGljcw0KICoNCiAqIEBwYXJhbSBhcnJheSAkYXJyYXkNCiAqDQogKiBAZGVwcmVjYXRlZA0KICoNCiAqIEB0aHJvd3MgRXhjZXB0aW9uDQogKg0KICogQHJldHVybiBzdHJpbmcNCiAqLw0KZnVuY3Rpb24gQnVpbGRNb2R1bGVfc3RhdGlzdGljcygkYXJyYXkgPSBhcnJheSgpKQ0Kew0KICAgIHJldHVybiBNb2R1bGVCdWlsZGVyOjpTdGF0aXN0aWNzKCRhcnJheSk7DQp9DQo=</file>
	<file name='zb_system\function\c_system_route.php' crc32='89A9EDBB'  dt:dt='bin.base64'>PD9waHANCg0KLyoqDQogKiDot6/nlLHlkozmjqfliLblmajnm7jlhbPlh73mlbAuDQogKi8NCg0KaWYgKCFkZWZpbmVkKCdaQlBfUEFUSCcpKSB7DQogICAgZXhpdCgnQWNjZXNzIGRlbmllZCcpOw0KfQ0KDQovLyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KDQovKioNCiAqIOagueaNrnVybOi3r+eUseinhOWImeaYvuekuumhtemdoueahOS4u+i3r+eUseWZqOWHveaVsC4NCiAqDQogKg0KICogQGFwaSBGaWx0ZXJfUGx1Z2luX1ZpZXdBdXRvX0JlZ2luDQogKiBAYXBpIEZpbHRlcl9QbHVnaW5fVmlld0F1dG9fRW5kDQogKg0KICogQHRocm93cyBFeGNlcHRpb24NCiAqDQogKiBAcmV0dXJuIG51bGx8c3RyaW5nDQogKi8NCmZ1bmN0aW9uIFZpZXdBdXRvKCkNCnsNCiAgICBnbG9iYWwgJHpicDsNCg0KICAgICRvcmlnaW5hbF91cmwgPSAkemJwLT5jdXJyZW50dXJsOw0KDQogICAgJHVybCA9IEdldFZhbHVlSW5BcnJheShleHBsb2RlKCc/JywgJG9yaWdpbmFsX3VybCksICcwJyk7DQoNCiAgICBpZiAoJHpicC0+Y29va2llc3BhdGggPT09IHN1YnN0cigkdXJsLCAwLCBzdHJsZW4oJHpicC0+Y29va2llc3BhdGgpKSkgew0KICAgICAgICAkdXJsID0gc3Vic3RyKCR1cmwsIHN0cmxlbigkemJwLT5jb29raWVzcGF0aCkpOw0KICAgIH0NCg0KICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1ZpZXdBdXRvX0JlZ2luJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICRmcHJldHVybiA9ICRmcG5hbWUoJG9yaWdpbmFsX3VybCwgJHVybCk7DQogICAgICAgIGlmICgkZnBzaWduYWwgPT0gUExVR0lOX0VYSVRTSUdOQUxfUkVUVVJOKSB7DQogICAgICAgICAgICAkZnBzaWduYWwgPSBQTFVHSU5fRVhJVFNJR05BTF9OT05FOw0KDQogICAgICAgICAgICByZXR1cm4gJGZwcmV0dXJuOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgJHVybCA9IHVybGRlY29kZSgkdXJsKTsNCiAgICAkYWN0aXZlX3JvdXRlcyA9IGFycmF5KCk7DQogICAgJHJld3JpdGVfcm91dGVzID0gYXJyYXkoKTsNCiAgICAkZGVmYXVsdF9yb3V0ZXMgPSBhcnJheSgpOw0KICAgIGZvcmVhY2ggKCR6YnAtPnJvdXRlcyBhcyAka2V5ID0+ICRyb3V0ZSkgew0KICAgICAgICAkcm91dGVbJ29yaWdpbmFsX3VybCddID0gJG9yaWdpbmFsX3VybDsNCiAgICAgICAgJHJvdXRlWyd1cmwnXSA9ICR1cmw7DQogICAgICAgIGlmICgkcm91dGVbJ3R5cGUnXSA9PSAnYWN0aXZlJykgew0KICAgICAgICAgICAgaWYgKEdldFZhbHVlSW5BcnJheSgkcm91dGUsICdzdXNwZW5kZWQnLCBmYWxzZSkgPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICAgICAkYWN0aXZlX3JvdXRlc1tdID0gJHJvdXRlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGlmICgkcm91dGVbJ3R5cGUnXSA9PSAncmV3cml0ZScpIHsNCiAgICAgICAgICAgIGlmICgkemJwLT5vcHRpb25bJ1pDX1NUQVRJQ19NT0RFJ10gPT0gJ1JFV1JJVEUnICYmIEdldFZhbHVlSW5BcnJheSgkcm91dGUsICdzdXNwZW5kZWQnLCBmYWxzZSkgPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICAgICAkcmV3cml0ZV9yb3V0ZXNbXSA9ICRyb3V0ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBpZiAoJHJvdXRlWyd0eXBlJ10gPT0gJ2RlZmF1bHQnKSB7DQogICAgICAgICAgICBpZiAoR2V0VmFsdWVJbkFycmF5KCRyb3V0ZSwgJ3N1c3BlbmRlZCcsIGZhbHNlKSA9PSBmYWxzZSkgew0KICAgICAgICAgICAgICAgIGlmIChHZXRWYWx1ZUluQXJyYXkoJHJvdXRlLCAnb25seV9yZXdyaXRlJywgZmFsc2UpID09IHRydWUpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCR6YnAtPm9wdGlvblsnWkNfU1RBVElDX01PREUnXSA9PSAnUkVXUklURScpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICRkZWZhdWx0X3JvdXRlc1tdID0gJHJvdXRlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSBlbHNlaWYgKEdldFZhbHVlSW5BcnJheSgkcm91dGUsICdvbmx5X2FjdGl2ZScsIGZhbHNlKSA9PSB0cnVlKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICgkemJwLT5vcHRpb25bJ1pDX1NUQVRJQ19NT0RFJ10gPT0gJ0FDVElWRScpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICRkZWZhdWx0X3JvdXRlc1tdID0gJHJvdXRlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgJGRlZmF1bHRfcm91dGVzW10gPSAkcm91dGU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgLy/ljLnphY3liqjmgIHot6/nlLHvvIjmn5Dkupvmg4XlhrXkuIvvvIzlnKjkvKrpnZnlvIDlkK/ml7bljLnphY3kvYbkuI3ovpPlh7rlhoXlrrnvvIzlpoLmnpzmmK/nrKblkIjmnaHku7blsLHlj6/ku6Xot7PovazvvIkNCiAgICBmb3JlYWNoICgkYWN0aXZlX3JvdXRlcyBhcyAka2V5ID0+ICRyb3V0ZSkgew0KICAgICAgICAkcHJlZml4ID0gR2V0VmFsdWVJbkFycmF5KCRyb3V0ZSwgJ3ByZWZpeCcsICcnKTsNCiAgICAgICAgJHByZWZpeCA9IGVtcHR5KCRwcmVmaXgpID8gJycgOiAoJHByZWZpeCAuICcvJyk7DQogICAgICAgIGlmICgoJHVybCA9PSAkcHJlZml4IC4gJycpIHx8ICgkdXJsID09ICRwcmVmaXggLiAnaW5kZXgucGhwJykgfHwgKCgkemJwLT5vcHRpb25bJ1pDX1NUQVRJQ19NT0RFJ10gPT0gJ1JFV1JJVEUnKSAmJiBHZXRWYWx1ZUluQXJyYXkoJF9HRVQsICdyZXdyaXRlJywgbnVsbCkgPT0gdHJ1ZSkpIHsNCiAgICAgICAgICAgICRiID0gVmlld0F1dG9fQ2hlY2tfR2V0X0FuZF9Ob3RfR2V0X0FuZF9NdXN0X0dldChHZXRWYWx1ZUluQXJyYXkoJHJvdXRlLCAnZ2V0JywgYXJyYXkoKSksIEdldFZhbHVlSW5BcnJheSgkcm91dGUsICdub3RfZ2V0JywgYXJyYXkoKSksIEdldFZhbHVlSW5BcnJheSgkcm91dGUsICdtdXN0X2dldCcsIGFycmF5KCkpKTsNCg0KICAgICAgICAgICAgJGIgPSAkYiAmJiBWaWV3QXV0b19DaGVja19SZXF1ZXN0X01ldGhvZChHZXRWYWx1ZUluQXJyYXkoJHJvdXRlLCAncmVxdWVzdF9tZXRob2QnLCAnJykpOw0KICAgICAgICAgICAgLy/lpoLmnpzmnaHku7bnrKblkIjlsLHnu4TlkIjlj4LmlbDmlbDnu4TlubbosIPnlKjlh73mlbANCiAgICAgICAgICAgIGlmICgkYikgew0KICAgICAgICAgICAgICAgICRhcnJheSA9IGFycmF5KCk7DQogICAgICAgICAgICAgICAgVmlld0F1dG9fUHJvY2Vzc19BcmdzX2dldCgkYXJyYXksIEdldFZhbHVlSW5BcnJheSgkcm91dGUsICdhcmdzX2dldCcsIGFycmF5KCkpLCAkcm91dGUpOw0KICAgICAgICAgICAgICAgIFZpZXdBdXRvX1Byb2Nlc3NfQXJnc193aXRoKCRhcnJheSwgR2V0VmFsdWVJbkFycmF5KCRyb3V0ZSwgJ2FyZ3Nfd2l0aCcsIGFycmF5KCkpLCAkcm91dGUpOw0KICAgICAgICAgICAgICAgIFZpZXdBdXRvX1Byb2Nlc3NfQXJnc19NZXJnZSgkcm91dGUpOw0KICAgICAgICAgICAgICAgICRiX3JlZGlyZWN0ID0gVmlld0F1dG9fQ2hlY2tfVG9fUGVybWFsaW5rKCRyb3V0ZSk7DQogICAgICAgICAgICAgICAgaWYgKCRiX3JlZGlyZWN0KSB7DQogICAgICAgICAgICAgICAgICAgICRhcnJheVsnY2FuY2VsZGlzcGxheSddID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgJHJlc3VsdCA9IFZpZXdBdXRvX0NhbGxfQXV0bygkcm91dGUsICRhcnJheSk7DQogICAgICAgICAgICAgICAgaWYgKCRyZXN1bHQgPT09IGZhbHNlKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoJHJlc3VsdCA9PSB0cnVlKSB7DQogICAgICAgICAgICAgICAgICAgIC8v5aaC5p6c5byA5ZCv5Lyq6Z2Z5LiUJGJfcmVkaXJlY3TvvIzpgqPkuYjpgJrov4fljp/liqjmgIHorr/pl67nmoTkvJrot7Povazoh7MkcmVzdWx0DQogICAgICAgICAgICAgICAgICAgIGlmICgkYl9yZWRpcmVjdCAmJiBpc19zdHJpbmcoJHJlc3VsdCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIFJlZGlyZWN0KCRyZXN1bHQpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvL+WMuemFjeS8qumdmei3r+eUsQ0KICAgIGZvcmVhY2ggKCRyZXdyaXRlX3JvdXRlcyBhcyAka2V5ID0+ICRyb3V0ZSkgew0KICAgICAgICAvLyRtYXRjaF93aXRoX3BhZ2Ug6buY6K6k5Yy56YWNMeasoSAodHJ1ZSnvvIzmnIlwYWdl5Y+C5pWw5Y+v5Lul5Yy56YWNMuasoSBbZmFsc2U9KHJlbW92ZSBwYWdlKSwgdHJ1ZT0oa2VlcCBwYWdlKV0NCiAgICAgICAgJHBhcmFtZXRlcnMgPSBhcnJheSgpOw0KICAgICAgICAkbWF0Y2hfd2l0aF9wYWdlID0gYXJyYXkoKTsNCiAgICAgICAgVmlld0F1dG9fR2V0X1BhcmFtZXRlcnNfQW5kX01hdGNoX3dpdGhfcGFnZSgkcm91dGUsICRwYXJhbWV0ZXJzLCAkbWF0Y2hfd2l0aF9wYWdlKTsNCg0KICAgICAgICBmb3JlYWNoICgkbWF0Y2hfd2l0aF9wYWdlIGFzICRtYXRjaF93aXRoX3BhZ2Vfa2V5ID0+ICRtYXRjaF93aXRoX3BhZ2VfdmFsdWUpIHsNCiAgICAgICAgICAgICRiID0gVmlld0F1dG9fQ2hlY2tfR2V0X0FuZF9Ob3RfR2V0X0FuZF9NdXN0X0dldChHZXRWYWx1ZUluQXJyYXkoJHJvdXRlLCAnZ2V0JywgYXJyYXkoKSksIEdldFZhbHVlSW5BcnJheSgkcm91dGUsICdub3RfZ2V0JywgYXJyYXkoKSksIEdldFZhbHVlSW5BcnJheSgkcm91dGUsICdtdXN0X2dldCcsIGFycmF5KCkpKTsNCiAgICAgICAgICAgICRiID0gJGIgJiYgVmlld0F1dG9fQ2hlY2tfUmVxdWVzdF9NZXRob2QoR2V0VmFsdWVJbkFycmF5KCRyb3V0ZSwgJ3JlcXVlc3RfbWV0aG9kJywgJycpKTsNCiAgICAgICAgICAgIC8v5aaC5p6c55u05o6l5oyH5a6a5LqGJHJvdXRlWyd1cmxydWxlX3JlZ2V4J13vvIzlsLHkuI3osIPnlKhVcmxSdWxlOjpPdXRwdXRVcmxSZWdFeO+8jOebtOaOpXByZWdfbWF0Y2gNCiAgICAgICAgICAgIGlmIChpc3NldCgkcm91dGVbJ3VybHJ1bGVfcmVnZXgnXSkgJiYgdHJpbSgkcm91dGVbJ3VybHJ1bGVfcmVnZXgnXSkgIT0gJycpIHsNCiAgICAgICAgICAgICAgICAkciA9IHRyaW0oJHJvdXRlWyd1cmxydWxlX3JlZ2V4J10pOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAvLyRyID0gVXJsUnVsZTo6T3V0cHV0VXJsUmVnRXhfVjIoJHpicC0+R2V0UG9zdFR5cGUoMCwgJ2xpc3RfdXJscnVsZScpLCAnbGlzdCcsICRtYXRjaF93aXRoX3BhZ2VfdmFsdWUpOw0KICAgICAgICAgICAgICAgICRyID0gVXJsUnVsZTo6T3V0cHV0VXJsUmVnRXhfUm91dGUoJHJvdXRlLCAkbWF0Y2hfd2l0aF9wYWdlX3ZhbHVlKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgJG0gPSBhcnJheSgpOw0KICAgICAgICAgICAgLy/lpoLmnpzmnaHku7bnrKblkIjlsLHnu4TlkIjlj4LmlbDmlbDnu4TlubbosIPnlKjlh73mlbANCiAgICAgICAgICAgIC8vdmFyX2R1bXAoJG1hdGNoX3dpdGhfcGFnZV92YWx1ZSwgJHJvdXRlWyd1cmxydWxlJ10sICRyLCAkdXJsLCAkbSk7Ly9kaWU7DQogICAgICAgICAgICAvL3Zhcl9kdW1wKHByZWdfbWF0Y2goJHIsICR1cmwsICRtKSk7DQogICAgICAgICAgICAkYiA9ICRiICYmICgoJHIgIT0gJycgJiYgcHJlZ19tYXRjaCgkciwgJHVybCwgJG0pID09IDEpIHx8ICgkciA9PSAnJyAmJiAkdXJsID09ICcnKSB8fCAoJHIgPT0gJycgJiYgJHVybCA9PSAnaW5kZXgucGhwJykpOw0KICAgICAgICAgICAgaWYgKCRiKSB7DQogICAgICAgICAgICAgICAgJGFycmF5ID0gJG07DQogICAgICAgICAgICAgICAgVmlld0F1dG9fUHJvY2Vzc19BcmdzKCRhcnJheSwgJHBhcmFtZXRlcnMsICRtKTsNCiAgICAgICAgICAgICAgICBWaWV3QXV0b19Qcm9jZXNzX0FyZ3Nfd2l0aCgkYXJyYXksIEdldFZhbHVlSW5BcnJheSgkcm91dGUsICdhcmdzX3dpdGgnLCBhcnJheSgpKSwgJHJvdXRlKTsNCiAgICAgICAgICAgICAgICBWaWV3QXV0b19Qcm9jZXNzX0FyZ3NfTWVyZ2UoJHJvdXRlKTsNCiAgICAgICAgICAgICAgICAvL3Zhcl9kdW1wKCRtYXRjaF93aXRoX3BhZ2VfdmFsdWUsICRyb3V0ZVsndXJscnVsZSddLCAkciwgJHVybCwgJG0sICRhcnJheSk7Ly9kaWU7DQogICAgICAgICAgICAgICAgJHJlc3VsdCA9IFZpZXdBdXRvX0NhbGxfQXV0bygkcm91dGUsICRhcnJheSk7DQogICAgICAgICAgICAgICAgaWYgKCRyZXN1bHQgPT09IGZhbHNlKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoJHJlc3VsdCA9PSB0cnVlKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvL+mDveS4jeiDveWMuemFjeaXtu+8jOi/m+WFpeS4gOasoem7mOiupOi3r+eUsQ0KICAgIGZvcmVhY2ggKCRkZWZhdWx0X3JvdXRlcyBhcyAka2V5ID0+ICRyb3V0ZSkgew0KICAgICAgICAkYiA9IFZpZXdBdXRvX0NoZWNrX0dldF9BbmRfTm90X0dldF9BbmRfTXVzdF9HZXQoR2V0VmFsdWVJbkFycmF5KCRyb3V0ZSwgJ2dldCcsIGFycmF5KCkpLCBHZXRWYWx1ZUluQXJyYXkoJHJvdXRlLCAnbm90X2dldCcsIGFycmF5KCkpLCBHZXRWYWx1ZUluQXJyYXkoJHJvdXRlLCAnbXVzdF9nZXQnLCBhcnJheSgpKSk7DQogICAgICAgICRiID0gJGIgJiYgVmlld0F1dG9fQ2hlY2tfUmVxdWVzdF9NZXRob2QoR2V0VmFsdWVJbkFycmF5KCRyb3V0ZSwgJ3JlcXVlc3RfbWV0aG9kJywgJycpKTsNCiAgICAgICAgaWYgKCRiKSB7DQogICAgICAgICAgICAkYXJyYXkgPSBhcnJheSgpOw0KICAgICAgICAgICAgVmlld0F1dG9fUHJvY2Vzc19BcmdzX2dldCgkYXJyYXksIEdldFZhbHVlSW5BcnJheSgkcm91dGUsICdhcmdzX2dldCcsIGFycmF5KCkpLCAkcm91dGUpOw0KICAgICAgICAgICAgVmlld0F1dG9fUHJvY2Vzc19BcmdzX3dpdGgoJGFycmF5LCBHZXRWYWx1ZUluQXJyYXkoJHJvdXRlLCAnYXJnc193aXRoJywgYXJyYXkoKSksICRyb3V0ZSk7DQogICAgICAgICAgICBWaWV3QXV0b19Qcm9jZXNzX0FyZ3NfTWVyZ2UoJHJvdXRlKTsNCiAgICAgICAgICAgICRyZXN1bHQgPSBWaWV3QXV0b19DYWxsX0F1dG8oJHJvdXRlLCAkYXJyYXkpOw0KICAgICAgICAgICAgaWYgKCRyZXN1bHQgPT09IGZhbHNlKSB7DQogICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoJHJlc3VsdCA9PSB0cnVlKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fVmlld0F1dG9fRW5kJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICRmcHJldHVybiA9ICRmcG5hbWUoJHVybCk7DQogICAgICAgIGlmICgkZnBzaWduYWwgPT0gUExVR0lOX0VYSVRTSUdOQUxfUkVUVVJOKSB7DQogICAgICAgICAgICAkZnBzaWduYWwgPSBQTFVHSU5fRVhJVFNJR05BTF9OT05FOw0KDQogICAgICAgICAgICByZXR1cm4gJGZwcmV0dXJuOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgJHpicC0+U2hvd0Vycm9yKDIsIF9fRklMRV9fLCBfX0xJTkVfXyk7DQoNCiAgICByZXR1cm4gZmFsc2U7DQp9DQoNCi8qKg0KICogVmlld0F1dG/nmoTovoXliqnlh73mlbANCiAqLw0KZnVuY3Rpb24gVmlld0F1dG9fUHJvY2Vzc19BcmdzKCYkYXJyYXksICRwYXJhbWV0ZXJzLCAkbSkNCnsNCiAgICBmb3JlYWNoICgkcGFyYW1ldGVycyBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICBpZiAoaXNzZXQoJG1bKHN0cmluZykgJHZhbHVlWyduYW1lJ11dKSkgew0KICAgICAgICAgICAgJGFycmF5WyR2YWx1ZVsnbmFtZSddXSA9ICRtWyhzdHJpbmcpICR2YWx1ZVsnbmFtZSddXTsNCiAgICAgICAgICAgIGlmICgkdmFsdWVbJ2FsaWFzJ10gIT0gJycpIHsNCiAgICAgICAgICAgICAgICAkYXJyYXlbJHZhbHVlWydhbGlhcyddXSA9ICRtWyhzdHJpbmcpICR2YWx1ZVsnbmFtZSddXTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCiAgICByZXR1cm4gJGFycmF5Ow0KfQ0KDQovKioNCiAqIFZpZXdBdXRv55qE6L6F5Yqp5Ye95pWwDQogKi8NCmZ1bmN0aW9uIFZpZXdBdXRvX1Byb2Nlc3NfQXJnc19nZXQoJiRhcnJheSwgJGFyZ3NfZ2V0LCAkcm91dGUpDQp7DQogICAgJGdldCA9IGFycmF5X21lcmdlKEdldFZhbHVlSW5BcnJheSgkcm91dGUsICdnZXQnLCBhcnJheSgpKSwgR2V0VmFsdWVJbkFycmF5KCRyb3V0ZSwgJ211c3RfZ2V0JywgYXJyYXkoKSkpOw0KDQogICAgaWYgKGlzc2V0KCRhcmdzX2dldCkgJiYgaXNfYXJyYXkoJGFyZ3NfZ2V0KSkgew0KICAgICAgICBmb3JlYWNoICgkZ2V0IGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICAgICAkYXJnc19nZXRbXSA9ICR2YWx1ZTsNCiAgICAgICAgfQ0KICAgICAgICBmb3JlYWNoICgkYXJnc19nZXQgYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgICAgIGlmIChpc3NldCgkX0dFVFskdmFsdWVdKSkgew0KICAgICAgICAgICAgICAgICRhcnJheVskdmFsdWVdID0gJF9HRVRbJHZhbHVlXTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgJGFycmF5WyR2YWx1ZV0gPSBudWxsOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KICAgIHJldHVybiAkYXJyYXk7DQp9DQoNCi8qKg0KICogVmlld0F1dG/nmoTovoXliqnlh73mlbANCiAqLw0KZnVuY3Rpb24gVmlld0F1dG9fUHJvY2Vzc19BcmdzX3dpdGgoJiRhcnJheSwgJGFyZ3Nfd2l0aCwgJHJvdXRlKQ0Kew0KICAgIGlmIChpc3NldCgkYXJnc193aXRoKSAmJiBpc19hcnJheSgkYXJnc193aXRoKSkgew0KICAgICAgICBmb3JlYWNoICgkYXJnc193aXRoIGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICAgICBpZiAoaXNfaW50ZWdlcigka2V5KSAmJiBpc19zY2FsYXIoJHZhbHVlKSkgew0KICAgICAgICAgICAgICAgIGlmIChpc3NldCgkX0dFVFskdmFsdWVdKSkgew0KICAgICAgICAgICAgICAgICAgICAkYXJyYXlbJHZhbHVlXSA9ICRfR0VUWyR2YWx1ZV07DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmIChpc3NldCgkcm91dGVbJHZhbHVlXSkpIHsNCiAgICAgICAgICAgICAgICAgICAgJGFycmF5WyR2YWx1ZV0gPSAkcm91dGVbJHZhbHVlXTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9IGVsc2VpZiAoaXNfc3RyaW5nKCRrZXkpKSB7DQogICAgICAgICAgICAgICAgJGFycmF5WyRrZXldID0gJHZhbHVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KICAgIHJldHVybiAkYXJyYXk7DQp9DQoNCi8qKg0KICogVmlld0F1dG/nmoTovoXliqnlh73mlbANCiAqLw0KZnVuY3Rpb24gVmlld0F1dG9fUHJvY2Vzc19BcmdzX01lcmdlKCYkcm91dGUpDQp7DQogICAgJGFycmF5ID0gYXJyYXkoKTsNCiAgICAkZ2V0ID0gYXJyYXlfbWVyZ2UoR2V0VmFsdWVJbkFycmF5KCRyb3V0ZSwgJ2dldCcsIGFycmF5KCkpLCBHZXRWYWx1ZUluQXJyYXkoJHJvdXRlLCAnbXVzdF9nZXQnLCBhcnJheSgpKSwgR2V0VmFsdWVJbkFycmF5KCRyb3V0ZSwgJ2FyZ3NfZ2V0JywgYXJyYXkoKSkpOw0KICAgIGZvcmVhY2ggKCRnZXQgYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgaWYgKGlzc2V0KCRfR0VUWyR2YWx1ZV0pKSB7DQogICAgICAgICAgICAkYXJyYXlbJHZhbHVlXSA9ICRfR0VUWyR2YWx1ZV07DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkYXJyYXlbJHZhbHVlXSA9ICcnOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgJHdpdGggPSBHZXRWYWx1ZUluQXJyYXkoJHJvdXRlLCAnYXJnc193aXRoJywgYXJyYXkoKSk7DQogICAgZm9yZWFjaCAoJHdpdGggYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgaWYgKGlzX2ludGVnZXIoJGtleSkgJiYgaXNfc2NhbGFyKCR2YWx1ZSkpIHsNCiAgICAgICAgICAgIGlmIChpc3NldCgkX0dFVFskdmFsdWVdKSkgew0KICAgICAgICAgICAgICAgICRhcnJheVskdmFsdWVdID0gJF9HRVRbJHZhbHVlXTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmIChpc3NldCgkcm91dGVbJHZhbHVlXSkpIHsNCiAgICAgICAgICAgICAgICAkYXJyYXlbJHZhbHVlXSA9ICRyb3V0ZVskdmFsdWVdOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2VpZiAoaXNfc3RyaW5nKCRrZXkpKSB7DQogICAgICAgICAgICAkYXJyYXlbJGtleV0gPSAkdmFsdWU7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBpZiAoIShpc3NldCgkcm91dGVbJ2FyZ3MnXSkgJiYgaXNfYXJyYXkoJHJvdXRlWydhcmdzJ10pKSkgew0KICAgICAgICAkcm91dGVbJ2FyZ3MnXSA9IGFycmF5KCk7DQogICAgfQ0KICAgIGZvcmVhY2ggKCRhcnJheSBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAkdmFsdWUgPSB0cmltKCR2YWx1ZSk7DQogICAgICAgICRyb3V0ZVsnYXJncyddW10gPSBhcnJheSgnbmFtZScgPT4gJGtleSwgJ3ZhbHVlJyA9PiAkdmFsdWUpOw0KICAgIH0NCn0NCg0KLyoqDQogKiBWaWV3QXV0b+eahOi+heWKqeWHveaVsA0KICovDQpmdW5jdGlvbiBWaWV3QXV0b19DYWxsX0F1dG8oJHJvdXRlLCAkYXJyYXkpDQp7DQogICAgaWYgKGlzc2V0KCRyb3V0ZVsncmVkaXJlY3RfdG8nXSkpIHsNCiAgICAgICAgUmVkaXJlY3QoJHJvdXRlWydyZWRpcmVjdF90byddKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICBpZiAoaXNzZXQoJHJvdXRlWydyZWRpcmVjdDMwMV90byddKSkgew0KICAgICAgICBSZWRpcmVjdDMwMSgkcm91dGVbJ3JlZGlyZWN0MzAxX3RvJ10pOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgICRmdW5jdGlvbiA9ICRyb3V0ZVsnY2FsbCddOw0KICAgICRhcnJheVsncm91dGUnXSA9ICRyb3V0ZTsNCiAgICBpZiAoc3RycG9zKCRmdW5jdGlvbiwgJzo6JykgIT09IGZhbHNlKSB7DQogICAgICAgICRmdW5jID0gZXhwbG9kZSgnOjonLCAkZnVuY3Rpb24pOw0KICAgICAgICByZXR1cm4gY2FsbF91c2VyX2Z1bmMoYXJyYXkoJGZ1bmNbMF0sICRmdW5jWzFdKSwgJGFycmF5KTsNCiAgICB9IGVsc2VpZiAoc3RycG9zKCRmdW5jdGlvbiwgJ0AnKSAhPT0gZmFsc2UpIHsNCiAgICAgICAgJGZ1bmMgPSBleHBsb2RlKCdAJywgJGZ1bmN0aW9uKTsNCiAgICAgICAgaWYgKHZlcnNpb25fY29tcGFyZShQSFBfVkVSU0lPTiwgJzcuMC4wJykgPj0gMCkgew0KICAgICAgICAgICAgcmV0dXJuIGNhbGxfdXNlcl9mdW5jKGFycmF5KCRmdW5jWzBdLCAkZnVuY1sxXSksICRhcnJheSk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkbyA9IG5ldyAkZnVuY1swXTsNCiAgICAgICAgICAgIHJldHVybiBjYWxsX3VzZXJfZnVuYyhhcnJheSgkbywgJGZ1bmNbMV0pLCAkYXJyYXkpOw0KICAgICAgICB9DQogICAgfSBlbHNlIHsNCiAgICAgICAgcmV0dXJuIGNhbGxfdXNlcl9mdW5jKCRmdW5jdGlvbiwgJGFycmF5KTsNCiAgICB9DQp9DQoNCi8qKg0KICogVmlld0F1dG/nmoTovoXliqnlh73mlbANCiAqLw0KZnVuY3Rpb24gVmlld0F1dG9fQ2hlY2tfVG9fUGVybWFsaW5rKCRyb3V0ZSkNCnsNCiAgICBnbG9iYWwgJHpicDsNCiAgICBpZiAoR2V0VmFsdWVJbkFycmF5KCRyb3V0ZSwgJ3RvX3Blcm1hbGluaycsIGZhbHNlKSA9PSBmYWxzZSkgew0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KICAgIGlmICghKCR6YnAtPm9wdGlvblsnWkNfU1RBVElDX01PREUnXSA9PSAnUkVXUklURScpKSB7DQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICB9DQogICAgaWYgKCgkemJwLT5vcHRpb25bJ1pDX1NUQVRJQ19NT0RFJ10gPT0gJ1JFV1JJVEUnKSAmJiBHZXRWYWx1ZUluQXJyYXkoJF9HRVQsICdyZXdyaXRlJywgbnVsbCkgPT0gdHJ1ZSkgew0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KICAgIC8v5qOA5p+l5pyJ5LiN5a2Y5Zyo55qE5Y+C5pWw5bCx6L+U5ZueZmFsc2UNCiAgICAkZ2V0ID0gR2V0VmFsdWVJbkFycmF5KCRyb3V0ZSwgJ2dldCcsIGFycmF5KCkpOw0KICAgIGZvcmVhY2ggKCRfR0VUIGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgIGlmICghZW1wdHkoJGdldCkgJiYgaW5fYXJyYXkoJGtleSwgJGdldCkgPT0gZmFsc2UpIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICAvL+ajgOafpeeUn+aIkOinhOWImeS4uuepuuWwsei/lOWbnmZhbHNlDQogICAgJHVybHJ1bGUgPSBHZXRWYWx1ZUluQXJyYXkoJHJvdXRlLCAndXJscnVsZScsICcnKTsNCiAgICBpZiAoZW1wdHkoJHVybHJ1bGUpKSB7DQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICB9DQogICAgJG1hdGNoX3dpdGhfcGFnZSA9IGZhbHNlOw0KICAgIGlmIChhcnJheV9rZXlfZXhpc3RzKCdwYWdlJywgJF9HRVQpKSB7DQogICAgICAgICRtYXRjaF93aXRoX3BhZ2UgPSB0cnVlOw0KICAgIH0NCiAgICAkciA9IFVybFJ1bGU6Ok91dHB1dFVybFJlZ0V4X1JvdXRlKCRyb3V0ZSwgJG1hdGNoX3dpdGhfcGFnZSk7DQogICAgaWYgKCRyICE9ICcnKSB7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCiAgICByZXR1cm4gZmFsc2U7DQp9DQoNCi8qKg0KICogVmlld0F1dG/nmoTovoXliqnlh73mlbANCiAqLw0KZnVuY3Rpb24gVmlld0F1dG9fR2V0X1BhcmFtZXRlcnNfQW5kX01hdGNoX3dpdGhfcGFnZSgkcm91dGUsICYkcGFyYW1ldGVycywgJiRtYXRjaF93aXRoX3BhZ2UpDQp7DQogICAgaWYgKGlzc2V0KCRyb3V0ZVsnYXJncyddKSAmJiBpc19hcnJheSgkcm91dGVbJ2FyZ3MnXSkpIHsNCiAgICAgICAgJHBhcmFtZXRlcnMgPSBVcmxSdWxlOjpQcm9jZXNzUGFyYW1ldGVycygkcm91dGUpOw0KICAgIH0gZWxzZSB7DQogICAgICAgICRwYXJhbWV0ZXJzID0gYXJyYXkoKTsNCiAgICB9DQoNCiAgICAkbWF0Y2hfd2l0aF9wYWdlID0gYXJyYXkoJ3JlbW92ZV9wYWdlJyA9PiBmYWxzZSk7DQogICAgJGhhc3BhZ2UgPSBmYWxzZTsNCiAgICBmb3JlYWNoICgkcGFyYW1ldGVycyBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICBpZiAoJHZhbHVlWyduYW1lJ10gPT0gJ3BhZ2UnKSB7DQogICAgICAgICAgICAkaGFzcGFnZSA9IHRydWU7DQogICAgICAgIH0NCiAgICB9DQogICAgaWYgKCRoYXNwYWdlID09IGZhbHNlKSB7DQogICAgICAgIHVuc2V0KCRtYXRjaF93aXRoX3BhZ2VbJ3JlbW92ZV9wYWdlJ10pOw0KICAgIH0NCg0KICAgICRvbmx5X21hdGNoX3BhZ2UgPSBHZXRWYWx1ZUluQXJyYXkoJHJvdXRlLCAnb25seV9tYXRjaF9wYWdlJywgZmFsc2UpOw0KICAgIGlmICgkb25seV9tYXRjaF9wYWdlID09IHRydWUpIHsNCiAgICAgICAgdW5zZXQoJG1hdGNoX3dpdGhfcGFnZVsncmVtb3ZlX3BhZ2UnXSk7DQogICAgfQ0KICAgICRtYXRjaF93aXRoX3BhZ2VbJ2tlZXBfcGFnZSddID0gdHJ1ZTsNCn0NCg0KLyoqDQogKiBWaWV3QXV0b+eahOi+heWKqeWHveaVsA0KICovDQpmdW5jdGlvbiBWaWV3QXV0b19DaGVja19SZXF1ZXN0X01ldGhvZCgkcmVxdWVzdF9tZXRob2QpDQp7DQogICAgJGIgPSBmYWxzZTsNCiAgICBpZiAoIWVtcHR5KCRyZXF1ZXN0X21ldGhvZCkpIHsNCiAgICAgICAgJG0gPSAkX1NFUlZFUlsnUkVRVUVTVF9NRVRIT0QnXTsNCiAgICAgICAgaWYgKGlzX2FycmF5KCRyZXF1ZXN0X21ldGhvZCkpIHsNCiAgICAgICAgICAgIGZvcmVhY2ggKCRyZXF1ZXN0X21ldGhvZCBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAgICAgICAgIGlmIChzdHJjYXNlY21wKCR2YWx1ZSwgJG0pID09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgJGIgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBpZiAoc3RyY2FzZWNtcCgkcmVxdWVzdF9tZXRob2QsICRtKSA9PSAwKSB7DQogICAgICAgICAgICAgICAgJGIgPSB0cnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfSBlbHNlIHsNCiAgICAgICAgJGIgPSB0cnVlOw0KICAgIH0NCiAgICByZXR1cm4gJGI7DQp9DQoNCi8qKg0KICogVmlld0F1dG/nmoTovoXliqnlh73mlbANCiAqLw0KZnVuY3Rpb24gVmlld0F1dG9fQ2hlY2tfR2V0X0FuZF9Ob3RfR2V0X0FuZF9NdXN0X0dldCgkZ2V0LCAkbm90Z2V0LCAkbXVzdGdldCkNCnsNCiAgICAkYiA9IGZhbHNlOw0KICAgIC8v5qOA5p+lR0VU5Y+C5pWw5piv5ZCm5a2Y5ZyoKOWmguaenOaciTLkuKrmiJYy5Liq5Lul5LiK77yM5b+F6aG75a2Y5ZyoMeS4qikgT1IgKOWmguaenOWPquaciTHkuKrvvIzliJnlj6/mnInlj6/ml6ApDQogICAgaWYgKCFlbXB0eSgkZ2V0KSkgew0KICAgICAgICBpZiAoY291bnQoJGdldCkgPT0gMSkgew0KICAgICAgICAgICAgJGIgPSB0cnVlOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgZm9yZWFjaCAoJGdldCBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAgICAgICAgIGlmIChpc3NldCgkX0dFVFskdmFsdWVdKSkgew0KICAgICAgICAgICAgICAgICAgICAkYiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0gZWxzZSB7DQogICAgICAgICRiID0gdHJ1ZTsNCiAgICB9DQoNCiAgICAvL+ajgOafpUdFVOWPguaVsOaYr+WQpuacieS4jemcgOimgeeahOWtmOWcqCjlhajpg6jkuI3og73lrZjlnKgpIE5PVA0KICAgIGlmICghZW1wdHkoJG5vdGdldCkpIHsNCiAgICAgICAgZm9yZWFjaCAoJG5vdGdldCBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAgICAgaWYgKChzdWJzdHIoJHZhbHVlLCAwLCAxKSA9PSAnLycgJiYgc3Vic3RyX2NvdW50KCR2YWx1ZSwgJy8nKSA+IDEpIHx8IChzdWJzdHIoJHZhbHVlLCAwLCAxKSA9PSAnIycgJiYgc3Vic3RyX2NvdW50KCR2YWx1ZSwgJyMnKSA+IDEpIHx8IChzdWJzdHIoJHZhbHVlLCAwLCAxKSA9PSAnficgJiYgc3Vic3RyX2NvdW50KCR2YWx1ZSwgJ34nKSA+IDEpKSB7DQogICAgICAgICAgICAgICAgZm9yZWFjaCAoJF9HRVQgYXMgJGtleTIgPT4gJHZhbHVlMikgew0KICAgICAgICAgICAgICAgICAgICBpZiAoQHByZWdfbWF0Y2goJHZhbHVlLCAka2V5MikgPT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICRiID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJGI7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIGlmIChpc3NldCgkX0dFVFskdmFsdWVdKSkgew0KICAgICAgICAgICAgICAgICAgICAkYiA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gJGI7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KICAgIC8v5qOA5p+lR0VU5Y+C5pWw5piv5ZCm5pyJ5b+F6aG755qE5a2Y5ZyoKOWFqOmDqOW/heWtmOWcqCkgQU5EDQogICAgaWYgKCFlbXB0eSgkbXVzdGdldCkpIHsNCiAgICAgICAgJGMgPSBhcnJheSgpOw0KICAgICAgICBmb3JlYWNoICgkbXVzdGdldCBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAgICAgaWYgKGlzc2V0KCRfR0VUWyR2YWx1ZV0pKSB7DQogICAgICAgICAgICAgICAgJGNbXSA9IHRydWU7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICRjW10gPSBmYWxzZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBpZiAoaW5fYXJyYXkoZmFsc2UsICRjLCB0cnVlKSA9PSB0cnVlKSB7DQogICAgICAgICAgICAkYiA9IGZhbHNlOw0KICAgICAgICB9DQogICAgfQ0KICAgIHJldHVybiAkYjsNCn0NCg0KLyoqDQogKiBWaWV3QXV0b+eahOi+heWKqeWHveaVsA0KICovDQpmdW5jdGlvbiBWaWV3QXV0b19Qcm9jZXNzX1BhZ2ViYXJfUmVwbGFjZV9BcnJheSgmJHBhZ2ViYXIsICRyb3V0ZSwgJGFyZ3MpDQp7DQogICAgaWYgKGVtcHR5KCRyb3V0ZSkpIHsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgICRhcmdzID0gaXNfYXJyYXkoJGFyZ3MpID8gJGFyZ3MgOiBhcnJheSgpOw0KICAgICRhcnJheSA9IEdldFZhbHVlSW5BcnJheSgkYXJncywgMCwgYXJyYXkoKSk7DQogICAgJGFycmF5ID0gaXNfYXJyYXkoJGFycmF5KSA/ICRhcnJheSA6IGFycmF5KCk7DQogICAgJHBhcmFtZXRlcnMgPSBVcmxSdWxlOjpQcm9jZXNzUGFyYW1ldGVycygkcm91dGUpOw0KICAgICRyZXBsYWNlID0gYXJyYXkoKTsNCg0KICAgIGZvcmVhY2ggKCRwYXJhbWV0ZXJzIGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgIGlmIChpc3NldCgkYXJyYXlbJGtleV0pKSB7DQogICAgICAgICAgICAkcmVwbGFjZVskdmFsdWVbJ25hbWUnXV0gPSAkYXJyYXlbJGtleV07DQogICAgICAgIH0NCiAgICB9DQogICAgJHJ1bGVzID0gJiRwYWdlYmFyLT5VcmxSdWxlLT5SdWxlczsNCiAgICBmb3JlYWNoICgkcmVwbGFjZSBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICBpZiAoIWlzc2V0KCRydWxlc1sneyUnIC4gJGtleSAuICclfSddKSkgew0KICAgICAgICAgICAgJHJ1bGVzWyd7JScgLiAka2V5IC4gJyV9J10gPSAkdmFsdWU7DQogICAgICAgIH0NCiAgICB9DQogICAgZm9yZWFjaCAoJGFycmF5IGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgIGlmIChpc19zdHJpbmcoJGtleSkgJiYgaXNfc2NhbGFyKCR2YWx1ZSkgJiYgIWlzc2V0KCRydWxlc1sneyUnIC4gJGtleSAuICclfSddKSkgew0KICAgICAgICAgICAgJHJ1bGVzWyd7JScgLiAka2V5IC4gJyV9J10gPSAkdmFsdWU7DQogICAgICAgIH0NCiAgICB9DQp9DQoNCi8vIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQoNCi8qKg0KICogVmlld0luZGV4LOmmlumhte+8jOaQnOe0oumhte+8jGZlZWTpobXnmoTkuLvlh73mlbAuDQogKg0KICogQGFwaSBGaWx0ZXJfUGx1Z2luX1ZpZXdJbmRleF9CZWdpbg0KICoNCiAqIEB0aHJvd3MgRXhjZXB0aW9uDQogKg0KICogQHJldHVybiBtaXhlZA0KICovDQpmdW5jdGlvbiBWaWV3SW5kZXgoKQ0Kew0KICAgIGdsb2JhbCAkemJwLCAkYWN0aW9uOw0KDQogICAgJHVybCA9ICR6YnAtPmN1cnJlbnR1cmw7DQoNCiAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9WaWV3SW5kZXhfQmVnaW4nXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgJGZwcmV0dXJuID0gJGZwbmFtZSgkdXJsKTsNCiAgICAgICAgaWYgKCRmcHNpZ25hbCA9PSBQTFVHSU5fRVhJVFNJR05BTF9SRVRVUk4pIHsNCiAgICAgICAgICAgICRmcHNpZ25hbCA9IFBMVUdJTl9FWElUU0lHTkFMX05PTkU7DQoNCiAgICAgICAgICAgIHJldHVybiAkZnByZXR1cm47DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBzd2l0Y2ggKCRhY3Rpb24pIHsNCiAgICAgICAgY2FzZSAnZmVlZCc6DQogICAgICAgICAgICBWaWV3RmVlZCgpOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJ3NlYXJjaCc6DQogICAgICAgICAgICBWaWV3U2VhcmNoKCk7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAndmlldyc6DQogICAgICAgIGNhc2UgJyc6DQogICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgICBWaWV3QXV0bygpOw0KICAgIH0NCg0KICAgIHJldHVybiB0cnVlOw0KfQ0KDQovKioNCiAqIOaYvuekulJTUzJGZWVkLg0KICoNCiAqIEBhcGkgRmlsdGVyX1BsdWdpbl9WaWV3RmVlZF9CZWdpbg0KICovDQpmdW5jdGlvbiBWaWV3RmVlZCgpDQp7DQogICAgZ2xvYmFsICR6YnA7DQoNCiAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9WaWV3RmVlZF9CZWdpbiddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAkZnByZXR1cm4gPSAkZnBuYW1lKCk7DQogICAgICAgIGlmICgkZnBzaWduYWwgPT0gUExVR0lOX0VYSVRTSUdOQUxfUkVUVVJOKSB7DQogICAgICAgICAgICAkZnBzaWduYWwgPSBQTFVHSU5fRVhJVFNJR05BTF9OT05FOw0KDQogICAgICAgICAgICByZXR1cm4gJGZwcmV0dXJuOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgaWYgKCEkemJwLT5DaGVja1JpZ2h0cygkR0xPQkFMU1snYWN0aW9uJ10pKSB7DQogICAgICAgIEh0dHA0MDQoKTsNCiAgICAgICAgZGllOw0KICAgIH0NCg0KICAgICRyc3MyID0gbmV3IFJzczIoJHpicC0+bmFtZSwgJHpicC0+aG9zdCwgJHpicC0+c3VibmFtZSk7DQoNCiAgICAkdyA9IGFycmF5KGFycmF5KCc9JywgJ2xvZ19TdGF0dXMnLCAwKSk7DQoNCiAgICAkcG9zdHlwZSA9IChpbnQpIEdldFZhcnMoJ3Bvc3R0eXBlJywgJ0dFVCcsIDApOw0KICAgICR3W10gPSBhcnJheSgnPScsICdsb2dfVHlwZScsICRwb3N0eXBlKTsNCg0KICAgICRhY3Rpb25zID0gJHpicC0+R2V0UG9zdFR5cGUoJHBvc3R5cGUsICdhY3Rpb25zJyk7DQoNCiAgICBpZiAoISR6YnAtPkNoZWNrUmlnaHRzKCRhY3Rpb25zWyd2aWV3J10pKSB7DQogICAgICAgIEh0dHA0MDQoKTsNCiAgICAgICAgZGllOw0KICAgIH0NCg0KICAgIGlmIChHZXRWYXJzKCdjYXRlJywgJ0dFVCcpICE9IG51bGwpIHsNCiAgICAgICAgJHdbXSA9IGFycmF5KCc9JywgJ2xvZ19DYXRlSUQnLCAoaW50KSBHZXRWYXJzKCdjYXRlJywgJ0dFVCcpKTsNCiAgICB9IGVsc2VpZiAoR2V0VmFycygnYXV0aCcsICdHRVQnKSAhPSBudWxsKSB7DQogICAgICAgICR3W10gPSBhcnJheSgnPScsICdsb2dfQXV0aG9ySUQnLCAoaW50KSBHZXRWYXJzKCdhdXRoJywgJ0dFVCcpKTsNCiAgICB9IGVsc2VpZiAoR2V0VmFycygnZGF0ZScsICdHRVQnKSAhPSBudWxsKSB7DQogICAgICAgICRkID0gc3RydG90aW1lKEdldFZhcnMoJ2RhdGUnLCAnR0VUJykpOw0KICAgICAgICBpZiAoc3RycnBvcyhHZXRWYXJzKCdkYXRlJywgJ0dFVCcpLCAnLScpICE9PSBzdHJwb3MoR2V0VmFycygnZGF0ZScsICdHRVQnKSwgJy0nKSkgew0KICAgICAgICAgICAgJHdbXSA9IGFycmF5KCdCRVRXRUVOJywgJ2xvZ19Qb3N0VGltZScsICRkLCBzdHJ0b3RpbWUoJysxIGRheScsICRkKSk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkd1tdID0gYXJyYXkoJ0JFVFdFRU4nLCAnbG9nX1Bvc3RUaW1lJywgJGQsIHN0cnRvdGltZSgnKzEgbW9udGgnLCAkZCkpOw0KICAgICAgICB9DQogICAgfSBlbHNlaWYgKEdldFZhcnMoJ3RhZ3MnLCAnR0VUJykgIT0gbnVsbCkgew0KICAgICAgICAkd1tdID0gYXJyYXkoJ0xJS0UnLCAnbG9nX1RhZycsICcleycgLiAoaW50KSBHZXRWYXJzKCd0YWdzJywgJ0dFVCcpIC4gJ30lJyk7DQogICAgfQ0KDQogICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fVmlld0ZlZWRfQ29yZSddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAkZnBuYW1lKCR3KTsNCiAgICB9DQoNCiAgICAkYXJ0aWNsZXMgPSAkemJwLT5HZXRQb3N0TGlzdCgNCiAgICAgICAgJyonLA0KICAgICAgICAkdywNCiAgICAgICAgYXJyYXkoJ2xvZ19Qb3N0VGltZScgPT4gJ0RFU0MnKSwNCiAgICAgICAgJHpicC0+b3B0aW9uWydaQ19SU1MyX0NPVU5UJ10sDQogICAgICAgIG51bGwNCiAgICApOw0KDQogICAgZm9yZWFjaCAoJGFydGljbGVzIGFzICRhcnRpY2xlKSB7DQogICAgICAgICRyc3MyLT5hZGRJdGVtKCRhcnRpY2xlLT5UaXRsZSwgJGFydGljbGUtPlVybCwgKCR6YnAtPm9wdGlvblsnWkNfUlNTX0VYUE9SVF9XSE9MRSddID09IHRydWUgPyAkYXJ0aWNsZS0+Q29udGVudCA6ICRhcnRpY2xlLT5JbnRybyksICRhcnRpY2xlLT5Qb3N0VGltZSk7DQogICAgfQ0KDQogICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fVmlld0ZlZWRfRW5kJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICRmcHJldHVybiA9ICRmcG5hbWUoJHJzczIpOw0KICAgICAgICBpZiAoJGZwc2lnbmFsID09IFBMVUdJTl9FWElUU0lHTkFMX1JFVFVSTikgew0KICAgICAgICAgICAgJGZwc2lnbmFsID0gUExVR0lOX0VYSVRTSUdOQUxfTk9ORTsNCg0KICAgICAgICAgICAgcmV0dXJuICRmcHJldHVybjsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGhlYWRlcigiQ29udGVudC10eXBlOnRleHQveG1sOyBDaGFyc2V0PXV0Zi04Iik7DQoNCiAgICBlY2hvICRyc3MyLT5zYXZlWE1MKCk7DQoNCiAgICByZXR1cm4gdHJ1ZTsNCn0NCg0KLyoqDQogKiDlsZXnpLrmkJzntKLnu5PmnpwuDQogKg0KICogQGFwaSBGaWx0ZXJfUGx1Z2luX1ZpZXdTZWFyY2hfQmVnaW4NCiAqIEBhcGkgRmlsdGVyX1BsdWdpbl9WaWV3UG9zdF9UZW1wbGF0ZQ0KICoNCiAqIEB0aHJvd3MgRXhjZXB0aW9uDQogKg0KICogQHJldHVybiBtaXhlZA0KICovDQpmdW5jdGlvbiBWaWV3U2VhcmNoKCkNCnsNCiAgICBnbG9iYWwgJHpicDsNCg0KICAgICRmcGFyZ3MgPSBjYWxsX3VzZXJfZnVuYygnZnVuY19nZXRfYXJncycpOw0KICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1ZpZXdTZWFyY2hfQmVnaW4nXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgJGZwcmV0dXJuID0gY2FsbF91c2VyX2Z1bmNfYXJyYXkoJGZwbmFtZSwgJGZwYXJncyk7DQogICAgICAgIGlmICgkZnBzaWduYWwgPT0gUExVR0lOX0VYSVRTSUdOQUxfUkVUVVJOKSB7DQogICAgICAgICAgICAkZnBzaWduYWwgPSBQTFVHSU5fRVhJVFNJR05BTF9OT05FOw0KICAgICAgICAgICAgcmV0dXJuICRmcHJldHVybjsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgICRxID0gR2V0VmFycygncScsICdHRVQnKTsNCiAgICAkcGFnZSA9IEdldFZhcnMoJ3BhZ2UnLCAnR0VUJyk7DQoNCiAgICAkYXJncyA9IEdldFZhbHVlSW5BcnJheSgkZnBhcmdzLCAwLCBudWxsKTsNCiAgICBpZiAoaXNfYXJyYXkoJGFyZ3MpKSB7DQogICAgICAgICRjYW5jZWxkaXNwbGF5ID0gR2V0VmFsdWVJbkFycmF5KCRhcmdzLCAnY2FuY2VsZGlzcGxheScsIGZhbHNlKTsNCiAgICAgICAgJHBvc3R0eXBlID0gR2V0VmFsdWVJbkFycmF5KCRhcmdzLCAncG9zdHR5cGUnLCAwKTsNCiAgICAgICAgJHEgPSBHZXRWYWx1ZUluQXJyYXkoJGFyZ3MsICdxJywgJycpOw0KICAgICAgICBpZiAoaXNzZXQoJGFyZ3NbJ3NlYXJjaCddKSAmJiAkYXJnc1snc2VhcmNoJ10pIHsNCiAgICAgICAgICAgICRxID0gJGFyZ3NbJ3NlYXJjaCddOw0KICAgICAgICB9DQogICAgICAgICRwYWdlID0gR2V0VmFsdWVJbkFycmF5KCRhcmdzLCAncGFnZScsIDApOw0KICAgICAgICAkcm91dGUgPSBHZXRWYWx1ZUluQXJyYXkoJGFyZ3MsICdyb3V0ZScsIGFycmF5KCkpOw0KICAgICAgICAkZGlzYWJsZWJvdCA9IEdldFZhbHVlSW5BcnJheSgkYXJncywgJ2Rpc2FibGVib3QnLCB0cnVlKTsNCiAgICB9IGVsc2Ugew0KICAgICAgICAkY2FuY2VsZGlzcGxheSA9IGZhbHNlOw0KICAgICAgICAkcG9zdHR5cGUgPSAwOw0KICAgICAgICAkcm91dGUgPSBhcnJheSgndXJscnVsZScgPT4gJHpicC0+b3B0aW9uWydaQ19TRUFSQ0hfUkVHRVgnXSk7DQogICAgICAgICRkaXNhYmxlYm90ID0gdHJ1ZTsNCiAgICB9DQoNCiAgICAkcSA9IHRyaW0oaHRtbHNwZWNpYWxjaGFycygkcSkpOw0KICAgICRwYWdlID0gKGludCkgJHBhZ2UgPT0gMCA/IDEgOiAoaW50KSAkcGFnZTsNCg0KICAgICR3ID0gYXJyYXkoKTsNCiAgICAkd1tdID0gYXJyYXkoJz0nLCAnbG9nX1R5cGUnLCAkcG9zdHR5cGUpOw0KDQogICAgLy/msqHmnInmnYPpmZDlsLHmkJzntKLnqbrnmoQNCiAgICAkYWN0aW9ucyA9ICR6YnAtPkdldFBvc3RUeXBlKCRwb3N0dHlwZSwgJ2FjdGlvbnMnKTsNCiAgICBpZiAoISR6YnAtPkNoZWNrUmlnaHRzKCRhY3Rpb25zWydzZWFyY2gnXSkpIHsNCiAgICAgICAgJHdbXSA9IGFycmF5KCc9JywgJ2xvZ19JRCcsIDApOw0KICAgIH0NCg0KICAgICRhcnRpY2xlID0gbmV3IFBvc3QoKTsNCiAgICAkYXJ0aWNsZS0+SUQgPSAwOw0KICAgICRhcnRpY2xlLT5UaXRsZSA9ICR6YnAtPmxhbmdzLT5tc2ctPnNlYXJjaCAuICcmbmJzcDsmcXVvdDs8c3Bhbj4nIC4gJHEgLiAnPC9zcGFuPiZxdW90Oyc7DQogICAgJGFydGljbGUtPklzTG9jayA9IHRydWU7DQogICAgJGFydGljbGUtPlR5cGUgPSAkcG9zdHR5cGU7DQoNCiAgICBpZiAoJHEpIHsNCiAgICAgICAgJHdbXSA9IGFycmF5KCdzZWFyY2gnLCAnbG9nX0NvbnRlbnQnLCAnbG9nX0ludHJvJywgJ2xvZ19UaXRsZScsICRxKTsNCiAgICB9IGVsc2Ugew0KICAgICAgICAkd1tdID0gYXJyYXkoJz0nLCAnbG9nX0lEJywgMCk7DQogICAgfQ0KDQogICAgaWYgKCEoJHpicC0+Q2hlY2tSaWdodHMoJGFydGljbGUtPlR5cGVBY3Rpb25zWydhbGwnXSkpKSB7DQogICAgICAgICR3W10gPSBhcnJheSgnPScsICdsb2dfU3RhdHVzJywgMCk7DQogICAgfQ0KICAgICRvcmRlciA9IGFycmF5KCdsb2dfUG9zdFRpbWUnID0+ICdERVNDJyk7DQoNCiAgICAkcGFnZWJhciA9IG5ldyBQYWdlYmFyKCRyb3V0ZSk7DQogICAgJHBhZ2ViYXItPlBhZ2VDb3VudCA9ICR6YnAtPnNlYXJjaGNvdW50Ow0KICAgICRwYWdlYmFyLT5QYWdlTm93ID0gJHBhZ2U7DQogICAgJHBhZ2ViYXItPlBhZ2VCYXJDb3VudCA9ICR6YnAtPnBhZ2ViYXJjb3VudDsNCiAgICAkcGFnZWJhci0+VXJsUnVsZS0+UnVsZXNbJ3slcGFnZSV9J10gPSAkcGFnZTsNCiAgICAkcGFnZWJhci0+VXJsUnVsZS0+UnVsZXNbJ3slcSV9J10gPSByYXd1cmxlbmNvZGUoJHEpOw0KICAgICRwYWdlYmFyLT5VcmxSdWxlLT5SdWxlc1sneyVzZWFyY2glfSddID0gcmF3dXJsZW5jb2RlKCRxKTsNCiAgICBWaWV3QXV0b19Qcm9jZXNzX1BhZ2ViYXJfUmVwbGFjZV9BcnJheSgkcGFnZWJhciwgJHJvdXRlLCAkZnBhcmdzKTsNCg0KICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1ZpZXdTZWFyY2hfQ29yZSddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAkZnBuYW1lKCRxLCAkcGFnZSwgJHcsICRwYWdlYmFyLCAkb3JkZXIpOw0KICAgIH0NCg0KICAgICRhcnJheSA9ICR6YnAtPkdldFBvc3RMaXN0KA0KICAgICAgICAnJywNCiAgICAgICAgJHcsDQogICAgICAgICRvcmRlciwNCiAgICAgICAgYXJyYXkoKCRwYWdlYmFyLT5QYWdlTm93IC0gMSkgKiAkcGFnZWJhci0+UGFnZUNvdW50LCAkcGFnZWJhci0+UGFnZUNvdW50KSwNCiAgICAgICAgYXJyYXkoJ3BhZ2ViYXInID0+ICRwYWdlYmFyKQ0KICAgICk7DQoNCiAgICAkcmVzdWx0cyA9IGFycmF5KCk7DQoNCiAgICBmb3JlYWNoICgkYXJyYXkgYXMgJGEpIHsNCiAgICAgICAgJHIgPSBuZXcgUG9zdCgpOw0KICAgICAgICAkci0+TG9hZEluZm9CeURhdGFBcnJheSgkYS0+R2V0RGF0YSgpKTsNCiAgICAgICAgJGFydGljbGUtPkNvbnRlbnQgLj0gJzxwPjxhIGhyZWY9IicgLiAkYS0+VXJsIC4gJyI+JyAuIHN0cl9pcmVwbGFjZSgkcSwgJzxzdHJvbmc+JyAuICRxIC4gJzwvc3Ryb25nPicsICRhLT5UaXRsZSkgLiAnPC9hPjxici8+JzsNCiAgICAgICAgJHMgPSBzdHJpcF90YWdzKCRhLT5JbnRybykgLiAnICcgLiBzdHJpcF90YWdzKCRhLT5Db250ZW50KTsNCiAgICAgICAgJGkgPSBaYnBfU3RyaXBvcygkcywgJHEsIDApOw0KICAgICAgICBpZiAoJGkgIT09IGZhbHNlKSB7DQogICAgICAgICAgICBpZiAoJGkgPiA1MCkgew0KICAgICAgICAgICAgICAgICR0ID0gU3ViU3RyVVRGOF9TdGFydCgkcywgKCRpIC0gNTApLCAxMDApOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAkdCA9IFN1YlN0clVURjhfU3RhcnQoJHMsIDAsIDEwMCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICAkYXJ0aWNsZS0+Q29udGVudCAuPSBzdHJfaXJlcGxhY2UoJHEsICc8c3Ryb25nPicgLiAkcSAuICc8L3N0cm9uZz4nLCAkdCkgLiAnPGJyLz4nOw0KICAgICAgICAgICAgJHItPkludHJvID0gc3RyX2lyZXBsYWNlKCRxLCAnPHN0cm9uZz4nIC4gJHEgLiAnPC9zdHJvbmc+JywgJHQpOw0KICAgICAgICAgICAgJHItPkNvbnRlbnQgPSAkYS0+Q29udGVudDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICRzID0gc3RyaXBfdGFncygkYS0+VGl0bGUpOw0KICAgICAgICAgICAgJGkgPSBaYnBfU3RycG9zKCRzLCAkcSwgMCk7DQogICAgICAgICAgICBpZiAoJGkgPiA1MCkgew0KICAgICAgICAgICAgICAgICR0ID0gU3ViU3RyVVRGOF9TdGFydCgkcywgKCRpIC0gNTApLCAxMDApOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAkdCA9IFN1YlN0clVURjhfU3RhcnQoJHMsIDAsIDEwMCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICAkYXJ0aWNsZS0+Q29udGVudCAuPSBzdHJfcmVwbGFjZSgkcSwgJzxzdHJvbmc+JyAuICRxIC4gJzwvc3Ryb25nPicsICR0KSAuICc8YnIvPic7DQogICAgICAgICAgICAkci0+SW50cm8gPSBzdHJfcmVwbGFjZSgkcSwgJzxzdHJvbmc+JyAuICRxIC4gJzwvc3Ryb25nPicsICR0KTsNCiAgICAgICAgICAgICRyLT5Db250ZW50ID0gJGEtPkNvbnRlbnQ7DQogICAgICAgIH0NCiAgICAgICAgJHItPlRpdGxlID0gc3RyX3JlcGxhY2UoJHEsICc8c3Ryb25nPicgLiAkcSAuICc8L3N0cm9uZz4nLCAkci0+VGl0bGUpOw0KICAgICAgICAkYXJ0aWNsZS0+Q29udGVudCAuPSAnPGEgaHJlZj0iJyAuICRhLT5VcmwgLiAnIj4nIC4gJGEtPlVybCAuICc8L2E+PGJyLz48L3A+JzsNCiAgICAgICAgJHJlc3VsdHNbXSA9ICRyOw0KICAgIH0NCg0KICAgIGlmICgkZGlzYWJsZWJvdCkgew0KICAgICAgICAkemJwLT5oZWFkZXIgLj0gJyAgICA8bWV0YSBuYW1lPSJyb2JvdHMiIGNvbnRlbnQ9Im5vaW5kZXgsbm9mb2xsb3csbm9hcmNoaXZlIiAvPicgLiAiXHJcbiI7DQogICAgfQ0KICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCd0aXRsZScsIHN0cl9yZXBsYWNlKGFycmF5KCc8c3Bhbj4nLCAnPC9zcGFuPicpLCAnJywgJGFydGljbGUtPlRpdGxlKSk7DQogICAgJHpicC0+dGVtcGxhdGUtPlNldFRhZ3MoJ2FydGljbGUnLCAkYXJ0aWNsZSk7DQogICAgJHpicC0+dGVtcGxhdGUtPlNldFRhZ3MoJ2FydGljbGVzJywgJHJlc3VsdHMpOw0KICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCdzZWFyY2gnLCAkcSk7DQogICAgJHpicC0+dGVtcGxhdGUtPlNldFRhZ3MoJ3BhZ2UnLCAkcGFnZSk7DQogICAgJHpicC0+dGVtcGxhdGUtPlNldFRhZ3MoJ3BhZ2ViYXInLCAkcGFnZWJhcik7DQogICAgJHpicC0+dGVtcGxhdGUtPlNldFRhZ3MoJ2NvbW1lbnRzJywgYXJyYXkoKSk7DQogICAgJHpicC0+dGVtcGxhdGUtPlNldFRhZ3MoJ2lzc2VhcmNoJywgdHJ1ZSk7DQogICAgJHpicC0+dGVtcGxhdGUtPlNldFRhZ3MoJ3Bvc3R0eXBlJywgJHBvc3R0eXBlKTsNCiAgICBpZiAoaXNfb2JqZWN0KCRwYWdlYmFyKSAmJiBpc3NldCgkcGFnZWJhci0+YnV0dG9uc1skcGFnZWJhci0+UGFnZU5vd10pKSB7DQogICAgICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCd1cmwnLCAkcGFnZWJhci0+YnV0dG9uc1skcGFnZWJhci0+UGFnZU5vd10pOw0KICAgIH0gZWxzZSB7DQogICAgICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCd1cmwnLCAkemJwLT5ob3N0KTsNCiAgICB9DQogICAgJHpicC0+dGVtcGxhdGUtPlNldFRhZ3MoJ2FyZ3MnLCAkZnBhcmdzKTsNCiAgICAkemJwLT50ZW1wbGF0ZS0+U2V0VGFncygncm91dGUnLCAkcm91dGUpOw0KDQogICAgLy8xLjbnu5/kuIDmlLnkuLpzZWFyY2jmqKHlvI8NCiAgICAkemJwLT50ZW1wbGF0ZS0+U2V0VGFncygndHlwZScsICdzZWFyY2gnKTsNCiAgICAvLzEuN+aMh+WumuaQnOe0ouaooeadv+S4uuS8mOWFiOS4unNlYXJjaOaIluaYr2luZGV4DQogICAgaWYgKCR6YnAtPnRlbXBsYXRlLT5IYXNUZW1wbGF0ZSgkemJwLT5HZXRQb3N0VHlwZSgkcG9zdHR5cGUsICdzZWFyY2hfdGVtcGxhdGUnKSkpIHsNCiAgICAgICAgJHpicC0+dGVtcGxhdGUtPlNldFRlbXBsYXRlKCR6YnAtPkdldFBvc3RUeXBlKCRwb3N0dHlwZSwgJ3NlYXJjaF90ZW1wbGF0ZScpKTsNCiAgICB9IGVsc2Ugew0KICAgICAgICAkemJwLT50ZW1wbGF0ZS0+U2V0VGVtcGxhdGUoJHpicC0+R2V0UG9zdFR5cGUoJHBvc3R0eXBlLCAnbGlzdF90ZW1wbGF0ZScpKTsNCiAgICB9DQoNCiAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9WaWV3U2VhcmNoX1RlbXBsYXRlJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICRmcHJldHVybiA9ICRmcG5hbWUoJHpicC0+dGVtcGxhdGUpOw0KICAgICAgICBpZiAoJGZwc2lnbmFsID09IFBMVUdJTl9FWElUU0lHTkFMX1JFVFVSTikgew0KICAgICAgICAgICAgJGZwc2lnbmFsID0gUExVR0lOX0VYSVRTSUdOQUxfTk9ORTsNCg0KICAgICAgICAgICAgcmV0dXJuICRmcHJldHVybjsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGlmICgkY2FuY2VsZGlzcGxheSA9PSBmYWxzZSkgew0KICAgICAgICAkemJwLT50ZW1wbGF0ZS0+RGlzcGxheSgpOw0KICAgIH0gZWxzZSB7DQogICAgICAgIHJldHVybiAkemJwLT50ZW1wbGF0ZS0+R2V0VGFncygndXJsJyk7DQogICAgfQ0KDQogICAgcmV0dXJuIHRydWU7DQp9DQoNCi8vIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQoNCi8qKg0KICog5pi+56S65YiX6KGo6aG16Z2iLg0KICoNCiAqIEBwYXJhbSBpbnQgICAkcGFnZSAoMS436LW35YGa5Li65Li76KaBYXJyYXnlnovlj4LmlbDvvIzlkI7nu63nmoTpg73kvZzlup/kuoYpDQogKiBAcGFyYW0gbWl4ZWQgJGNhdGUgICAgICAgICAgIOWIhuexuyBpZOaIlmFsaWFzDQogKiBAcGFyYW0gbWl4ZWQgJGF1dGggICAgICAgICAgIOS9nOiAhSBpZOaIlmFsaWFzDQogKiBAcGFyYW0gbWl4ZWQgJGRhdGUgICAgICAgICAgIOaXpeacnw0KICogQHBhcmFtIG1peGVkICR0YWdzICAgICAgICAgICB0YWdzIGlk5oiWYWxpYXMNCiAqIEBwYXJhbSBtaXhlZCAkaXNyZXdyaXRlICAgICAg5piv5ZCm5ZCv55SodXJscmV3cml0ZQ0KICogQHBhcmFtIGFycmF5ICRvYmplY3QgICAgICAgICDmiooxLjfph4zmlrDlop5hcnJheeWei+WPguaVsOS8oOe7meaXp+eJiOacrOeahOaOpeWPow0KICoNCiAqIEBhcGkgRmlsdGVyX1BsdWdpbl9WaWV3TGlzdF9CZWdpbg0KICogQGFwaSBGaWx0ZXJfUGx1Z2luX1ZpZXdMaXN0X0JlZ2luX1YyDQogKiBAYXBpIEZpbHRlcl9QbHVnaW5fVmlld0xpc3RfVGVtcGxhdGUNCiAqDQogKiBAdGhyb3dzIEV4Y2VwdGlvbg0KICoNCiAqIEByZXR1cm4gc3RyaW5nDQogKi8NCmZ1bmN0aW9uIFZpZXdMaXN0KCRwYWdlID0gbnVsbCwgJGNhdGUgPSBudWxsLCAkYXV0aCA9IG51bGwsICRkYXRlID0gbnVsbCwgJHRhZ3MgPSBudWxsLCAkaXNyZXdyaXRlID0gZmFsc2UsICRvYmplY3QgPSBhcnJheSgpKQ0Kew0KICAgIGdsb2JhbCAkemJwOw0KDQogICAgJGZwYXJncyA9IGNhbGxfdXNlcl9mdW5jKCdmdW5jX2dldF9hcmdzJyk7DQogICAgJGZwYXJnc19jb3VudCA9IGNvdW50KCRmcGFyZ3MpOw0KDQogICAgLy/mlrDniYjmnKznmoTlh73mlbBWMiAodjLniYjmnKzkvKDlhaXnmoTnrKzkuIDkuKrlj4LmlbDmmK9hcnJheeS4lOWPquS8oOS4gOS4qmFycmF5KQ0KICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1ZpZXdMaXN0X0JlZ2luX1YyJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICRmcHJldHVybiA9ICRmcG5hbWUoJHBhZ2UpOw0KICAgICAgICBpZiAoJGZwc2lnbmFsID09IFBMVUdJTl9FWElUU0lHTkFMX1JFVFVSTikgew0KICAgICAgICAgICAgJGZwc2lnbmFsID0gUExVR0lOX0VYSVRTSUdOQUxfTk9ORTsNCg0KICAgICAgICAgICAgcmV0dXJuICRmcHJldHVybjsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8v5L+u5q2j6aaW5Liq5Y+C5pWw5L2/55SoYXJyYXnogIzkuI3kvKDlhaXlkI7nu63lj4LmlbDnmoTmg4XlhrUNCiAgICBpZiAoaXNfYXJyYXkoJHBhZ2UpICYmIGlzc2V0KCRwYWdlWydyb3V0ZSddKSAmJiAkZnBhcmdzX2NvdW50ID09IDEpIHsNCiAgICAgICAgJG9iamVjdCA9ICRwYWdlOw0KICAgICAgICAkaXNyZXdyaXRlID0gdHJ1ZTsNCiAgICAgICAgJGNhdGUgPSBHZXRWYWx1ZUluQXJyYXkoJHBhZ2UsICdjYXRlJywgbnVsbCk7DQogICAgICAgICRhdXRoID0gR2V0VmFsdWVJbkFycmF5KCRwYWdlLCAnYXV0aCcsIG51bGwpOw0KICAgICAgICAkZGF0ZSA9IEdldFZhbHVlSW5BcnJheSgkcGFnZSwgJ2RhdGUnLCBudWxsKTsNCiAgICAgICAgJHRhZ3MgPSBHZXRWYWx1ZUluQXJyYXkoJHBhZ2UsICd0YWdzJywgbnVsbCk7DQogICAgICAgICRwb3N0dHlwZSA9IEdldFZhbHVlSW5BcnJheSgkcGFnZSwgJ3Bvc3R0eXBlJywgMCk7DQogICAgICAgICRjYW5jZWxkaXNwbGF5ID0gR2V0VmFsdWVJbkFycmF5KCRwYWdlLCAnY2FuY2VsZGlzcGxheScsIGZhbHNlKTsNCiAgICAgICAgJHJvdXRlID0gR2V0VmFsdWVJbkFycmF5KCRwYWdlLCAncm91dGUnLCBhcnJheSgpKTsNCiAgICAgICAgJHBhZ2UgPSBHZXRWYWx1ZUluQXJyYXkoJHBhZ2UsICdwYWdlJywgbnVsbCk7DQogICAgfSBlbHNlIHsNCiAgICAgICAgJG9iamVjdCA9IGFycmF5KCk7DQogICAgICAgICRwb3N0dHlwZSA9IDA7DQogICAgICAgICRjYW5jZWxkaXNwbGF5ID0gZmFsc2U7DQogICAgICAgICRyb3V0ZSA9IGFycmF5KCk7DQogICAgfQ0KDQogICAgLy/ogIHniYjmnKznmoTlhbzlrrnmjqXlj6MNCiAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9WaWV3TGlzdF9CZWdpbiddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAkZnBhcmdzX3YxID0gYXJyYXkoJHBhZ2UsICRjYXRlLCAkYXV0aCwgJGRhdGUsICR0YWdzLCAkaXNyZXdyaXRlLCAkb2JqZWN0KTsNCiAgICAgICAgJGZwcmV0dXJuID0gY2FsbF91c2VyX2Z1bmNfYXJyYXkoJGZwbmFtZSwgJGZwYXJnc192MSk7DQogICAgICAgIGlmICgkZnBzaWduYWwgPT0gUExVR0lOX0VYSVRTSUdOQUxfUkVUVVJOKSB7DQogICAgICAgICAgICAkZnBzaWduYWwgPSBQTFVHSU5fRVhJVFNJR05BTF9OT05FOw0KDQogICAgICAgICAgICByZXR1cm4gJGZwcmV0dXJuOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgJHR5cGUgPSAnaW5kZXgnOw0KICAgIGlmICgkY2F0ZSAhPT0gbnVsbCkgew0KICAgICAgICAkdHlwZSA9ICdjYXRlZ29yeSc7DQogICAgfQ0KDQogICAgaWYgKCRhdXRoICE9PSBudWxsKSB7DQogICAgICAgICR0eXBlID0gJ2F1dGhvcic7DQogICAgfQ0KDQogICAgaWYgKCRkYXRlICE9PSBudWxsKSB7DQogICAgICAgICR0eXBlID0gJ2RhdGUnOw0KICAgIH0NCg0KICAgIGlmICgkdGFncyAhPT0gbnVsbCkgew0KICAgICAgICAkdHlwZSA9ICd0YWcnOw0KICAgIH0NCg0KICAgICRjYXRlZ29yeSA9IG51bGw7DQogICAgJGF1dGhvciA9IG51bGw7DQogICAgJGRhdGV0aW1lID0gbnVsbDsNCiAgICAkdGFnID0gbnVsbDsNCg0KICAgICR3ID0gYXJyYXkoKTsNCiAgICAkd1tdID0gYXJyYXkoJz0nLCAnbG9nX1R5cGUnLCAkcG9zdHR5cGUpOw0KICAgICR3W10gPSBhcnJheSgnPScsICdsb2dfU3RhdHVzJywgMCk7DQogICAgJHdbXSA9IGFycmF5KCc9JywgJ2xvZ19Jc1RvcCcsIDApOw0KDQogICAgJHBhZ2UgPSAoaW50KSAkcGFnZSA9PSAwID8gMSA6IChpbnQpICRwYWdlOw0KDQogICAgJGFydGljbGVzID0gYXJyYXkoKTsNCiAgICAkYXJ0aWNsZXNfdG9wID0gYXJyYXkoKTsNCg0KICAgIHN3aXRjaCAoJHR5cGUpIHsNCiAgICAgICAgICAgIC8vIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KICAgICAgICBjYXNlICdpbmRleCc6DQogICAgICAgICAgICBpZiAoIWVtcHR5KCRyb3V0ZSkpIHsNCiAgICAgICAgICAgICAgICAkcGFnZWJhciA9IG5ldyBQYWdlYmFyKCRyb3V0ZSk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICRwYWdlYmFyID0gbmV3IFBhZ2ViYXIoJHpicC0+b3B0aW9uWydaQ19JTkRFWF9SRUdFWCddLCB0cnVlLCB0cnVlKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICgwID09ICRwb3N0dHlwZSkgew0KICAgICAgICAgICAgICAgICRwYWdlYmFyLT5Db3VudCA9ICR6YnAtPmNhY2hlLT5ub3JtYWxfYXJ0aWNsZV9udW1zOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgJHRlbXBsYXRlID0gJHpicC0+R2V0UG9zdFR5cGUoJHBvc3R0eXBlLCAnbGlzdF90ZW1wbGF0ZScpOw0KICAgICAgICAgICAgaWYgKCRwYWdlID09IDEpIHsNCiAgICAgICAgICAgICAgICAkemJwLT50aXRsZSA9ICR6YnAtPnN1Ym5hbWU7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICR6YnAtPnRpdGxlID0gc3RyX3JlcGxhY2UoJyVudW0lJywgJHBhZ2UsICR6YnAtPmxhbmdbJ21zZyddWydudW1iZXJfcGFnZSddKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgLy8jIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQogICAgICAgIGNhc2UgJ2NhdGVnb3J5JzoNCiAgICAgICAgICAgIGlmICghZW1wdHkoJHJvdXRlKSkgew0KICAgICAgICAgICAgICAgICRwYWdlYmFyID0gbmV3IFBhZ2ViYXIoJHJvdXRlKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgJHBhZ2ViYXIgPSBuZXcgUGFnZWJhcigkemJwLT5vcHRpb25bJ1pDX0NBVEVHT1JZX1JFR0VYJ10pOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgJGNhdGVnb3J5ID0gbmV3IENhdGVnb3J5KCk7DQoNCiAgICAgICAgICAgIGlmICghaXNfYXJyYXkoJGNhdGUpKSB7DQogICAgICAgICAgICAgICAgJGNhdGVJZCA9ICRjYXRlOw0KICAgICAgICAgICAgICAgICRjYXRlID0gYXJyYXkoKTsNCiAgICAgICAgICAgICAgICBpZiAoc3RycG9zKCR6YnAtPm9wdGlvblsnWkNfQ0FURUdPUllfUkVHRVgnXSwgJ3slaWQlfScpICE9PSBmYWxzZSkgew0KICAgICAgICAgICAgICAgICAgICAkY2F0ZVsnaWQnXSA9ICRjYXRlSWQ7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmIChzdHJwb3MoJHpicC0+b3B0aW9uWydaQ19DQVRFR09SWV9SRUdFWCddLCAneyVhbGlhcyV9JykgIT09IGZhbHNlKSB7DQogICAgICAgICAgICAgICAgICAgICRjYXRlWydhbGlhcyddID0gJGNhdGVJZDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoaXNzZXQoJGNhdGVbJ2lkJ10pKSB7DQogICAgICAgICAgICAgICAgJGNhdGVnb3J5ID0gJHpicC0+R2V0Q2F0ZWdvcnlCeUlEKCRjYXRlWydpZCddKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgJGNhdGVnb3J5ID0gJHpicC0+R2V0Q2F0ZWdvcnlCeUFsaWFzKCRjYXRlWydhbGlhcyddLCAkcG9zdHR5cGUpOw0KICAgICAgICAgICAgICAgIGlmICgkY2F0ZWdvcnktPklEID09ICcnKSB7DQogICAgICAgICAgICAgICAgICAgICRjYXRlZ29yeSA9ICR6YnAtPkdldENhdGVnb3J5QnlBbGlhc09yTmFtZSgkY2F0ZVsnYWxpYXMnXSwgJHBvc3R0eXBlKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICgkY2F0ZWdvcnktPklEID09ICcnKSB7DQogICAgICAgICAgICAgICAgaWYgKCFlbXB0eSgkcm91dGUpIHx8ICRpc3Jld3JpdGUgPT0gdHJ1ZSkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgJHpicC0+U2hvd0Vycm9yKDIsIF9fRklMRV9fLCBfX0xJTkVfXyk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoJHBhZ2UgPT0gMSkgew0KICAgICAgICAgICAgICAgICR6YnAtPnRpdGxlID0gJGNhdGVnb3J5LT5OYW1lOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAkemJwLT50aXRsZSA9ICRjYXRlZ29yeS0+TmFtZSAuICcgJyAuIHN0cl9yZXBsYWNlKCclbnVtJScsICRwYWdlLCAkemJwLT5sYW5nWydtc2cnXVsnbnVtYmVyX3BhZ2UnXSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICAkdGVtcGxhdGUgPSAkY2F0ZWdvcnktPlRlbXBsYXRlOw0KDQogICAgICAgICAgICBpZiAoISR6YnAtPm9wdGlvblsnWkNfRElTUExBWV9TVUJDQVRFR09SWVMnXSkgew0KICAgICAgICAgICAgICAgICR3W10gPSBhcnJheSgnPScsICdsb2dfQ2F0ZUlEJywgJGNhdGVnb3J5LT5JRCk7DQogICAgICAgICAgICAgICAgJHBhZ2ViYXItPkNvdW50ID0gJGNhdGVnb3J5LT5Db3VudDsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgJGFyeXN1YmNhdGUgPSBhcnJheSgpOw0KICAgICAgICAgICAgICAgICRhcnlzdWJjYXRlW10gPSBhcnJheSgnbG9nX0NhdGVJRCcsICRjYXRlZ29yeS0+SUQpOw0KICAgICAgICAgICAgICAgIGlmIChpc3NldCgkemJwLT5jYXRlZ29yaWVzWyRjYXRlZ29yeS0+SURdKSkgew0KICAgICAgICAgICAgICAgICAgICBmb3JlYWNoICgkemJwLT5jYXRlZ29yaWVzWyRjYXRlZ29yeS0+SURdLT5DaGlsZHJlbkNhdGVnb3JpZXMgYXMgJHN1YmNhdGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICRhcnlzdWJjYXRlW10gPSBhcnJheSgnbG9nX0NhdGVJRCcsICRzdWJjYXRlLT5JRCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgJHdbXSA9IGFycmF5KCdhcnJheScsICRhcnlzdWJjYXRlKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgJHBhZ2ViYXItPlVybFJ1bGUtPlJ1bGVzWyd7JWlkJX0nXSA9ICRjYXRlZ29yeS0+SUQ7DQogICAgICAgICAgICAkcGFnZWJhci0+VXJsUnVsZS0+UnVsZXNbJ3slYWxpYXMlfSddID0gJGNhdGVnb3J5LT5BbGlhcyA9PSAnJyA/IHJhd3VybGVuY29kZSgkY2F0ZWdvcnktPk5hbWUpIDogJGNhdGVnb3J5LT5BbGlhczsNCiAgICAgICAgICAgICRwYWdlYmFyLT5VcmxSdWxlLT5SdWxlc09iamVjdCA9ICRjYXRlZ29yeTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgLy8jIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQogICAgICAgIGNhc2UgJ2F1dGhvcic6DQogICAgICAgICAgICBpZiAoIWVtcHR5KCRyb3V0ZSkpIHsNCiAgICAgICAgICAgICAgICAkcGFnZWJhciA9IG5ldyBQYWdlYmFyKCRyb3V0ZSk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICRwYWdlYmFyID0gbmV3IFBhZ2ViYXIoJHpicC0+b3B0aW9uWydaQ19BVVRIT1JfUkVHRVgnXSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICAkYXV0aG9yID0gbmV3IE1lbWJlcigpOw0KDQogICAgICAgICAgICBpZiAoIWlzX2FycmF5KCRhdXRoKSkgew0KICAgICAgICAgICAgICAgICRhdXRoSWQgPSAkYXV0aDsNCiAgICAgICAgICAgICAgICAkYXV0aCA9IGFycmF5KCk7DQogICAgICAgICAgICAgICAgaWYgKHN0cnBvcygkemJwLT5vcHRpb25bJ1pDX0FVVEhPUl9SRUdFWCddLCAneyVpZCV9JykgIT09IGZhbHNlKSB7DQogICAgICAgICAgICAgICAgICAgICRhdXRoWydpZCddID0gJGF1dGhJZDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKHN0cnBvcygkemJwLT5vcHRpb25bJ1pDX0FVVEhPUl9SRUdFWCddLCAneyVhbGlhcyV9JykgIT09IGZhbHNlKSB7DQogICAgICAgICAgICAgICAgICAgICRhdXRoWydhbGlhcyddID0gJGF1dGhJZDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoaXNzZXQoJGF1dGhbJ2lkJ10pKSB7DQogICAgICAgICAgICAgICAgLyogQHZhciBNZW1iZXIgJGF1dGhvciAqLw0KICAgICAgICAgICAgICAgICRhdXRob3IgPSAkemJwLT5HZXRNZW1iZXJCeUlEKCRhdXRoWydpZCddKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgLyogQHZhciBNZW1iZXIgJGF1dGhvciAqLw0KICAgICAgICAgICAgICAgICRhdXRob3IgPSAkemJwLT5HZXRNZW1iZXJCeU5hbWVPckFsaWFzKCRhdXRoWydhbGlhcyddKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKCRhdXRob3ItPklEID09ICcnKSB7DQogICAgICAgICAgICAgICAgaWYgKCFlbXB0eSgkcm91dGUpIHx8ICRpc3Jld3JpdGUgPT0gdHJ1ZSkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgJHpicC0+U2hvd0Vycm9yKDIsIF9fRklMRV9fLCBfX0xJTkVfXyk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoJHBhZ2UgPT0gMSkgew0KICAgICAgICAgICAgICAgICR6YnAtPnRpdGxlID0gJGF1dGhvci0+U3RhdGljTmFtZTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgJHpicC0+dGl0bGUgPSAkYXV0aG9yLT5TdGF0aWNOYW1lIC4gJyAnIC4gc3RyX3JlcGxhY2UoJyVudW0lJywgJHBhZ2UsICR6YnAtPmxhbmdbJ21zZyddWydudW1iZXJfcGFnZSddKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgICR0ZW1wbGF0ZSA9ICRhdXRob3ItPlRlbXBsYXRlOw0KICAgICAgICAgICAgJHdbXSA9IGFycmF5KCc9JywgJ2xvZ19BdXRob3JJRCcsICRhdXRob3ItPklEKTsNCiAgICAgICAgICAgIC8vJHBhZ2ViYXItPkNvdW50ID0gJGF1dGhvci0+QXJ0aWNsZXM7DQogICAgICAgICAgICAkcGFnZWJhci0+VXJsUnVsZS0+UnVsZXNbJ3slaWQlfSddID0gJGF1dGhvci0+SUQ7DQogICAgICAgICAgICAkcGFnZWJhci0+VXJsUnVsZS0+UnVsZXNbJ3slYWxpYXMlfSddID0gJGF1dGhvci0+QWxpYXMgPT0gJycgPyByYXd1cmxlbmNvZGUoJGF1dGhvci0+TmFtZSkgOiAkYXV0aG9yLT5BbGlhczsNCiAgICAgICAgICAgICRwYWdlYmFyLT5VcmxSdWxlLT5SdWxlc09iamVjdCA9ICRhdXRob3I7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIC8vIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KICAgICAgICBjYXNlICdkYXRlJzoNCiAgICAgICAgICAgIGlmICghZW1wdHkoJHJvdXRlKSkgew0KICAgICAgICAgICAgICAgICRwYWdlYmFyID0gbmV3IFBhZ2ViYXIoJHJvdXRlKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgJHBhZ2ViYXIgPSBuZXcgUGFnZWJhcigkemJwLT5vcHRpb25bJ1pDX0RBVEVfUkVHRVgnXSk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICghaXNfYXJyYXkoJGRhdGUpKSB7DQogICAgICAgICAgICAgICAgJGRhdGV0aW1lID0gJGRhdGU7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICRkYXRldGltZSA9ICRkYXRlWydkYXRlJ107DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICRoYXNEYXkgPSBmYWxzZTsNCg0KICAgICAgICAgICAgJGRhdGV0aW1lX3R4dCA9ICRkYXRldGltZTsNCiAgICAgICAgICAgICRkYXRldGltZSA9IG51bGw7DQogICAgICAgICAgICBpZiAoZnVuY3Rpb25fZXhpc3RzKCdkYXRlX2NyZWF0ZV9mcm9tX2Zvcm1hdCcpKSB7DQogICAgICAgICAgICAgICAgJG9iamRhdGUgPSBkYXRlX2NyZWF0ZV9mcm9tX2Zvcm1hdCgkemJwLT5vcHRpb25bJ1pDX0RBVEVUSU1FX1dJVEhEQVlfUlVMRSddLCAkZGF0ZXRpbWVfdHh0KTsNCiAgICAgICAgICAgICAgICBpZiAoJG9iamRhdGUgIT09IGZhbHNlKSB7DQogICAgICAgICAgICAgICAgICAgICRkYXRldGltZSA9IHN0cnRvdGltZSgkb2JqZGF0ZS0+Zm9ybWF0KCdZLW4taicpKTsNCiAgICAgICAgICAgICAgICAgICAgJGhhc0RheSA9IHRydWU7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgJG9iamRhdGUgPSBkYXRlX2NyZWF0ZV9mcm9tX2Zvcm1hdCgkemJwLT5vcHRpb25bJ1pDX0RBVEVUSU1FX1JVTEUnXSwgJGRhdGV0aW1lX3R4dCk7DQogICAgICAgICAgICAgICAgICAgIGlmICgkb2JqZGF0ZSAhPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICRkYXRldGltZSA9IHN0cnRvdGltZSgkb2JqZGF0ZS0+Zm9ybWF0KCdZLW4nKSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICRkYXRldGltZV90eHQgPSBzdHJfcmVwbGFjZSgkemJwLT5vcHRpb25bJ1pDX0RBVEVUSU1FX1NFUEFSQVRPUiddLCAnLScsICRkYXRldGltZV90eHQpOw0KICAgICAgICAgICAgICAgIGlmIChzdWJzdHJfY291bnQoJGRhdGV0aW1lX3R4dCwgJy0nKSA+IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgJGhhc0RheSA9IHRydWU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmIChzdHJ0b3RpbWUoJGRhdGV0aW1lX3R4dCkgIT09IGZhbHNlKSB7DQogICAgICAgICAgICAgICAgICAgICRkYXRldGltZSA9IHN0cnRvdGltZSgkZGF0ZXRpbWVfdHh0KTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoIWlzX2ludCgkZGF0ZXRpbWUpKSB7DQogICAgICAgICAgICAgICAgaWYgKCFlbXB0eSgkcm91dGUpIHx8ICRpc3Jld3JpdGUgPT0gdHJ1ZSkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgJHpicC0+U2hvd0Vycm9yKDIsIF9fRklMRV9fLCBfX0xJTkVfXyk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICgkaGFzRGF5KSB7DQogICAgICAgICAgICAgICAgJGRhdGV0aXRsZSA9IHN0cl9yZXBsYWNlKGFycmF5KCcleSUnLCAnJW0lJywgJyVkJScpLCBhcnJheShkYXRlKCdZJywgJGRhdGV0aW1lKSwgZGF0ZSgnbicsICRkYXRldGltZSksIGRhdGUoJ2onLCAkZGF0ZXRpbWUpKSwgJHpicC0+bGFuZ1snbXNnJ11bJ3llYXJfbW9udGhfZGF5J10pOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAkZGF0ZXRpdGxlID0gc3RyX3JlcGxhY2UoYXJyYXkoJyV5JScsICclbSUnKSwgYXJyYXkoZGF0ZSgnWScsICRkYXRldGltZSksIGRhdGUoJ24nLCAkZGF0ZXRpbWUpKSwgJHpicC0+bGFuZ1snbXNnJ11bJ3llYXJfbW9udGgnXSk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICgkcGFnZSA9PSAxKSB7DQogICAgICAgICAgICAgICAgJHpicC0+dGl0bGUgPSAkZGF0ZXRpdGxlOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAkemJwLT50aXRsZSA9ICRkYXRldGl0bGUgLiAnICcgLiBzdHJfcmVwbGFjZSgnJW51bSUnLCAkcGFnZSwgJHpicC0+bGFuZ1snbXNnJ11bJ251bWJlcl9wYWdlJ10pOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAkemJwLT5tb2R1bGVzYnlmaWxlbmFtZVsnY2FsZW5kYXInXS0+Q29udGVudCA9IE1vZHVsZUJ1aWxkZXI6OkNhbGVuZGFyKGRhdGUoJ1knLCAkZGF0ZXRpbWUpIC4gJy0nIC4gZGF0ZSgnbicsICRkYXRldGltZSkpOw0KDQogICAgICAgICAgICAkdGVtcGxhdGUgPSAkemJwLT5HZXRQb3N0VHlwZSgkcG9zdHR5cGUsICdkYXRlX3RlbXBsYXRlJyk7DQoNCiAgICAgICAgICAgIGlmICgkaGFzRGF5KSB7DQogICAgICAgICAgICAgICAgJHdbXSA9IGFycmF5KCdCRVRXRUVOJywgJ2xvZ19Qb3N0VGltZScsICRkYXRldGltZSwgc3RydG90aW1lKCcrMSBkYXknLCAkZGF0ZXRpbWUpKTsNCiAgICAgICAgICAgICAgICAkcGFnZWJhci0+VXJsUnVsZS0+UnVsZXNbJ3slZGF0ZSV9J10gPSBkYXRlKCR6YnAtPm9wdGlvblsnWkNfREFURVRJTUVfV0lUSERBWV9SVUxFJ10sICRkYXRldGltZSk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICR3W10gPSBhcnJheSgnQkVUV0VFTicsICdsb2dfUG9zdFRpbWUnLCAkZGF0ZXRpbWUsIHN0cnRvdGltZSgnKzEgbW9udGgnLCAkZGF0ZXRpbWUpKTsNCiAgICAgICAgICAgICAgICAkcGFnZWJhci0+VXJsUnVsZS0+UnVsZXNbJ3slZGF0ZSV9J10gPSBkYXRlKCR6YnAtPm9wdGlvblsnWkNfREFURVRJTUVfUlVMRSddLCAkZGF0ZXRpbWUpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAkcGFnZWJhci0+VXJsUnVsZS0+UnVsZXNPYmplY3QgPSBuZXcgWmJwRGF0ZSgkZGF0ZXRpbWUpOw0KICAgICAgICAgICAgJGRhdGV0aW1lID0gTWV0YXM6OkNvbnZlcnRBcnJheShnZXRkYXRlKCRkYXRldGltZSkpOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAvLyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCiAgICAgICAgY2FzZSAndGFnJzoNCiAgICAgICAgICAgIGlmICghZW1wdHkoJHJvdXRlKSkgew0KICAgICAgICAgICAgICAgICRwYWdlYmFyID0gbmV3IFBhZ2ViYXIoJHJvdXRlKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgJHBhZ2ViYXIgPSBuZXcgUGFnZWJhcigkemJwLT5vcHRpb25bJ1pDX1RBR1NfUkVHRVgnXSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICAkdGFnID0gbmV3IFRhZygpOw0KDQogICAgICAgICAgICBpZiAoIWlzX2FycmF5KCR0YWdzKSkgew0KICAgICAgICAgICAgICAgICR0YWdJZCA9ICR0YWdzOw0KICAgICAgICAgICAgICAgICR0YWdzID0gYXJyYXkoKTsNCiAgICAgICAgICAgICAgICBpZiAoc3RycG9zKCR6YnAtPm9wdGlvblsnWkNfVEFHU19SRUdFWCddLCAneyVpZCV9JykgIT09IGZhbHNlKSB7DQogICAgICAgICAgICAgICAgICAgICR0YWdzWydpZCddID0gJHRhZ0lkOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoc3RycG9zKCR6YnAtPm9wdGlvblsnWkNfVEFHU19SRUdFWCddLCAneyVhbGlhcyV9JykgIT09IGZhbHNlKSB7DQogICAgICAgICAgICAgICAgICAgICR0YWdzWydhbGlhcyddID0gJHRhZ0lkOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmIChpc3NldCgkdGFnc1snaWQnXSkpIHsNCiAgICAgICAgICAgICAgICAkdGFnID0gJHpicC0+R2V0VGFnQnlJRCgkdGFnc1snaWQnXSk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICR0YWcgPSAkemJwLT5HZXRUYWdCeUFsaWFzT3JOYW1lKCR0YWdzWydhbGlhcyddLCAkcG9zdHR5cGUpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoJHRhZy0+SUQgPT0gMCkgew0KICAgICAgICAgICAgICAgIGlmICghZW1wdHkoJHJvdXRlKSB8fCAkaXNyZXdyaXRlID09IHRydWUpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICR6YnAtPlNob3dFcnJvcigyLCBfX0ZJTEVfXywgX19MSU5FX18pOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoJHBhZ2UgPT0gMSkgew0KICAgICAgICAgICAgICAgICR6YnAtPnRpdGxlID0gJHRhZy0+TmFtZTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgJHpicC0+dGl0bGUgPSAkdGFnLT5OYW1lIC4gJyAnIC4gc3RyX3JlcGxhY2UoJyVudW0lJywgJHBhZ2UsICR6YnAtPmxhbmdbJ21zZyddWydudW1iZXJfcGFnZSddKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgJHRlbXBsYXRlID0gJHRhZy0+VGVtcGxhdGU7DQogICAgICAgICAgICAkd1tdID0gYXJyYXkoJ0xJS0UnLCAnbG9nX1RhZycsICcleycgLiAkdGFnLT5JRCAuICd9JScpOw0KICAgICAgICAgICAgJHBhZ2ViYXItPlVybFJ1bGUtPlJ1bGVzWyd7JWlkJX0nXSA9ICR0YWctPklEOw0KICAgICAgICAgICAgJHBhZ2ViYXItPlVybFJ1bGUtPlJ1bGVzWyd7JWFsaWFzJX0nXSA9ICR0YWctPkFsaWFzID09ICcnID8gcmF3dXJsZW5jb2RlKCR0YWctPk5hbWUpIDogJHRhZy0+QWxpYXM7DQogICAgICAgICAgICAkcGFnZWJhci0+VXJsUnVsZS0+UnVsZXNPYmplY3QgPSAkdGFnOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKCdVbmtub3duIHR5cGUnKTsNCiAgICB9DQoNCiAgICAkcGFnZWJhci0+UGFnZUNvdW50ID0gJHpicC0+ZGlzcGxheWNvdW50Ow0KICAgICRwYWdlYmFyLT5QYWdlTm93ID0gJHBhZ2U7DQogICAgJHBhZ2ViYXItPlBhZ2VCYXJDb3VudCA9ICR6YnAtPnBhZ2ViYXJjb3VudDsNCiAgICAkcGFnZWJhci0+VXJsUnVsZS0+UnVsZXNbJ3slcGFnZSV9J10gPSAkcGFnZTsNCg0KICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1ZpZXdMaXN0X0NvcmUnXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgJGZwbmFtZSgkdHlwZSwgJHBhZ2UsICRjYXRlZ29yeSwgJGF1dGhvciwgJGRhdGV0aW1lLCAkdGFnLCAkdywgJHBhZ2ViYXIsICR0ZW1wbGF0ZSk7DQogICAgfQ0KDQogICAgaWYgKCR6YnAtPm9wdGlvblsnWkNfTElTVE9OVE9QX1RVUk5PRkYnXSA9PSBmYWxzZSkgew0KICAgICAgICAkYXJ0aWNsZXNfdG9wX25vdG9yZGVyID0gJHpicC0+R2V0VG9wUG9zdCgkcG9zdHR5cGUpOw0KICAgICAgICBmb3JlYWNoICgkYXJ0aWNsZXNfdG9wX25vdG9yZGVyIGFzICRhcnRpY2xlc190b3Bfbm90b3JkZXJfcG9zdCkgew0KICAgICAgICAgICAgaWYgKCRhcnRpY2xlc190b3Bfbm90b3JkZXJfcG9zdC0+VG9wVHlwZSA9PSAnZ2xvYmFsJykgew0KICAgICAgICAgICAgICAgICRhcnRpY2xlc190b3BbXSA9ICRhcnRpY2xlc190b3Bfbm90b3JkZXJfcG9zdDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBpZiAoJHR5cGUgPT0gJ2luZGV4JyAmJiAkcGFnZSA9PSAxKSB7DQogICAgICAgICAgICBmb3JlYWNoICgkYXJ0aWNsZXNfdG9wX25vdG9yZGVyIGFzICRhcnRpY2xlc190b3Bfbm90b3JkZXJfcG9zdCkgew0KICAgICAgICAgICAgICAgIGlmICgkYXJ0aWNsZXNfdG9wX25vdG9yZGVyX3Bvc3QtPlRvcFR5cGUgPT0gJ2luZGV4Jykgew0KICAgICAgICAgICAgICAgICAgICAkYXJ0aWNsZXNfdG9wW10gPSAkYXJ0aWNsZXNfdG9wX25vdG9yZGVyX3Bvc3Q7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGlmICgkdHlwZSA9PSAnY2F0ZWdvcnknICYmICRwYWdlID09IDEpIHsNCiAgICAgICAgICAgIGZvcmVhY2ggKCRhcnRpY2xlc190b3Bfbm90b3JkZXIgYXMgJGFydGljbGVzX3RvcF9ub3RvcmRlcl9wb3N0KSB7DQogICAgICAgICAgICAgICAgaWYgKCRhcnRpY2xlc190b3Bfbm90b3JkZXJfcG9zdC0+VG9wVHlwZSA9PSAnY2F0ZWdvcnknICYmICRhcnRpY2xlc190b3Bfbm90b3JkZXJfcG9zdC0+Q2F0ZUlEID09ICRjYXRlZ29yeS0+SUQpIHsNCiAgICAgICAgICAgICAgICAgICAgJGFydGljbGVzX3RvcFtdID0gJGFydGljbGVzX3RvcF9ub3RvcmRlcl9wb3N0Ow0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCg0KICAgICRzZWxlY3QgPSAnJzsNCiAgICAkb3JkZXIgPSBhcnJheSgnbG9nX1Bvc3RUaW1lJyA9PiAnREVTQycpOw0KICAgICRsaW1pdCA9IGFycmF5KCgkcGFnZWJhci0+UGFnZU5vdyAtIDEpICogJHBhZ2ViYXItPlBhZ2VDb3VudCwgJHBhZ2ViYXItPlBhZ2VDb3VudCk7DQogICAgJG9wdGlvbiA9IGFycmF5KCdwYWdlYmFyJyA9PiAkcGFnZWJhcik7DQogICAgVmlld0F1dG9fUHJvY2Vzc19QYWdlYmFyX1JlcGxhY2VfQXJyYXkoJHBhZ2ViYXIsICRyb3V0ZSwgJGZwYXJncyk7DQoNCiAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9MYXJnZURhdGFfQXJ0aWNsZSddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAkZnByZXR1cm4gPSAkZnBuYW1lKCRzZWxlY3QsICR3LCAkb3JkZXIsICRsaW1pdCwgJG9wdGlvbiwgJHR5cGUpOw0KICAgIH0NCg0KICAgICRhcnRpY2xlcyA9ICR6YnAtPkdldFBvc3RMaXN0KA0KICAgICAgICAkc2VsZWN0LA0KICAgICAgICAkdywNCiAgICAgICAgJG9yZGVyLA0KICAgICAgICAkbGltaXQsDQogICAgICAgICRvcHRpb24NCiAgICApOw0KDQogICAgaWYgKGNvdW50KCRhcnRpY2xlcykgPD0gMCAmJiAkcGFnZSA+IDEpIHsNCiAgICAgICAgJHpicC0+U2hvd0Vycm9yKDIsIF9fRklMRV9fLCBfX0xJTkVfXyk7DQogICAgfQ0KDQogICAgJGFydGljbGVzID0gYXJyYXlfbWVyZ2UoJGFydGljbGVzX3RvcCwgJGFydGljbGVzKTsNCg0KICAgICR0YWdzdHJpbmcgPSBudWxsOw0KICAgIGZvcmVhY2ggKCRhcnRpY2xlcyBhcyAka2V5ID0+ICRhcnRpY2xlKSB7DQogICAgICAgICR0YWdzdHJpbmcgLj0gJGFydGljbGUtPlRhZzsNCiAgICB9DQogICAgJHpicC0+TG9hZFRhZ3NCeUlEU3RyaW5nKCR0YWdzdHJpbmcpOw0KDQogICAgZm9yZWFjaCAoJGFydGljbGVzIGFzICRrZXkgPT4gJiRhcnRpY2xlKSB7DQogICAgICAgICRjbGFzc25hbWUgPSAkemJwLT5HZXRQb3N0VHlwZSgkcG9zdHR5cGUsICdjbGFzc25hbWUnKTsNCiAgICAgICAgaWYgKHN0cmNhc2VjbXAoZ2V0X2NsYXNzKCRhcnRpY2xlKSwgJGNsYXNzbmFtZSkgIT0gMCkgew0KICAgICAgICAgICAgJG5ld2FydGljbGUgPSAkYXJ0aWNsZS0+Q2xvbmVkKGZhbHNlLCAkY2xhc3NuYW1lKTsNCiAgICAgICAgICAgICRhcnRpY2xlID0gJG5ld2FydGljbGU7DQogICAgICAgICAgICAkemJwLT5BZGRQb3N0Q2FjaGUoJGFydGljbGUpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgJHpicC0+TG9hZE1lbWJlcnNJbkxpc3QoJGFydGljbGVzKTsNCg0KICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCd0aXRsZScsICR6YnAtPnRpdGxlKTsNCiAgICAkemJwLT50ZW1wbGF0ZS0+U2V0VGFncygnYXJ0aWNsZXMnLCAkYXJ0aWNsZXMpOw0KICAgIGlmICgkcGFnZWJhci0+UGFnZUFsbCA9PSAwKSB7DQogICAgICAgICRwYWdlYmFyID0gbnVsbDsNCiAgICB9DQoNCiAgICAkemJwLT50ZW1wbGF0ZS0+U2V0VGFncygncG9zdHR5cGUnLCAkcG9zdHR5cGUpOw0KICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCdwYWdlYmFyJywgJHBhZ2ViYXIpOw0KICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCd0eXBlJywgJHR5cGUpOw0KICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCdwYWdlJywgJHBhZ2UpOw0KDQogICAgJHpicC0+dGVtcGxhdGUtPlNldFRhZ3MoJ2RhdGUnLCAkZGF0ZXRpbWUpOw0KICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCd0YWcnLCAkdGFnKTsNCiAgICAkemJwLT50ZW1wbGF0ZS0+U2V0VGFncygnYXV0aG9yJywgJGF1dGhvcik7DQogICAgJHpicC0+dGVtcGxhdGUtPlNldFRhZ3MoJ2NhdGVnb3J5JywgJGNhdGVnb3J5KTsNCg0KICAgIGlmIChpc19vYmplY3QoJHBhZ2ViYXIpICYmIGlzc2V0KCRwYWdlYmFyLT5idXR0b25zWyRwYWdlYmFyLT5QYWdlTm93XSkpIHsNCiAgICAgICAgJHpicC0+dGVtcGxhdGUtPlNldFRhZ3MoJ3VybCcsICRwYWdlYmFyLT5idXR0b25zWyRwYWdlYmFyLT5QYWdlTm93XSk7DQogICAgfSBlbHNlIHsNCiAgICAgICAgJHpicC0+dGVtcGxhdGUtPlNldFRhZ3MoJ3VybCcsICR6YnAtPmhvc3QpOw0KICAgIH0NCiAgICAkemJwLT50ZW1wbGF0ZS0+U2V0VGFncygnYXJncycsICRmcGFyZ3MpOw0KICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCdyb3V0ZScsICRyb3V0ZSk7DQoNCiAgICBpZiAoJHpicC0+dGVtcGxhdGUtPmhhc1RlbXBsYXRlKCR0ZW1wbGF0ZSkpIHsNCiAgICAgICAgJHpicC0+dGVtcGxhdGUtPlNldFRlbXBsYXRlKCR0ZW1wbGF0ZSk7DQogICAgfSBlbHNlIHsNCiAgICAgICAgJHpicC0+dGVtcGxhdGUtPlNldFRlbXBsYXRlKCdpbmRleCcpOw0KICAgIH0NCg0KICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1ZpZXdMaXN0X1RlbXBsYXRlJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICRmcHJldHVybiA9ICRmcG5hbWUoJHpicC0+dGVtcGxhdGUpOw0KICAgICAgICBpZiAoJGZwc2lnbmFsID09IFBMVUdJTl9FWElUU0lHTkFMX1JFVFVSTikgew0KICAgICAgICAgICAgJGZwc2lnbmFsID0gUExVR0lOX0VYSVRTSUdOQUxfTk9ORTsNCg0KICAgICAgICAgICAgcmV0dXJuICRmcHJldHVybjsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGlmICgkY2FuY2VsZGlzcGxheSA9PSBmYWxzZSkgew0KICAgICAgICAkemJwLT50ZW1wbGF0ZS0+RGlzcGxheSgpOw0KICAgIH0gZWxzZSB7DQogICAgICAgIHJldHVybiAkemJwLT50ZW1wbGF0ZS0+R2V0VGFncygndXJsJyk7DQogICAgfQ0KDQogICAgcmV0dXJuIHRydWU7DQp9DQoNCi8qKg0KICog5pi+56S65paH56ugLg0KICoNCiAqIEBwYXJhbSBhcnJheXxpbnR8c3RyaW5nICRpZCAgICAgICAgIOaWh+eroElELyBJRC/liKvlkI3lr7nosaEgKDEuN+i1t+WBmuS4uuS4u+imgWFycmF55Z6L5Y+C5pWw77yM5ZCO57ut55qE6YO95L2c5bqf5LqGKQ0KICogQHBhcmFtIHN0cmluZyAgICAgICAgICAgJGFsaWFzICAgICDvvIjlpoLmnpzmnInnmoTor53vvInmlofnq6DliKvlkI0NCiAqIEBwYXJhbSBib29sICAgICAgICAgICAgICRpc3Jld3JpdGUgIOaYr+WQpuWQr+eUqHVybHJld3JpdGUNCiAqIEBwYXJhbSBhcnJheSAgICAgICAgICAgICRvYmplY3QgICAgIOaKijEuN+mHjOaWsOWinmFycmF55Z6L5Y+C5pWw5Lyg57uZ5pen54mI5pys55qE5o6l5Y+jDQogKg0KICogQGFwaSBGaWx0ZXJfUGx1Z2luX1ZpZXdQb3N0X0JlZ2luDQogKiBAYXBpIEZpbHRlcl9QbHVnaW5fVmlld1Bvc3RfQmVnaW5fVjINCiAqIEBhcGkgRmlsdGVyX1BsdWdpbl9WaWV3UG9zdF9UZW1wbGF0ZQ0KICoNCiAqIEB0aHJvd3MgRXhjZXB0aW9uDQogKg0KICogQHJldHVybiBzdHJpbmcNCiAqLw0KZnVuY3Rpb24gVmlld1Bvc3QoJGlkID0gbnVsbCwgJGFsaWFzID0gbnVsbCwgJGlzcmV3cml0ZSA9IGZhbHNlLCAkb2JqZWN0ID0gYXJyYXkoKSkNCnsNCiAgICBnbG9iYWwgJHpicDsNCg0KICAgICRmcGFyZ3MgPSBjYWxsX3VzZXJfZnVuYygnZnVuY19nZXRfYXJncycpOw0KICAgICRmcGFyZ3NfY291bnQgPSBjb3VudCgkZnBhcmdzKTsNCg0KICAgIC8v5paw54mI5pys55qE5Ye95pWwVjIgKHYy54mI5pys5Lyg5YWl55qE56ys5LiA5Liq5Y+C5pWw5pivYXJyYXnkuJTlj6rkvKDkuIDkuKphcnJheSkNCiAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9WaWV3UG9zdF9CZWdpbl9WMiddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAkZnByZXR1cm4gPSAkZnBuYW1lKCRpZCk7DQogICAgICAgIGlmICgkZnBzaWduYWwgPT0gUExVR0lOX0VYSVRTSUdOQUxfUkVUVVJOKSB7DQogICAgICAgICAgICAkZnBzaWduYWwgPSBQTFVHSU5fRVhJVFNJR05BTF9OT05FOw0KDQogICAgICAgICAgICByZXR1cm4gJGZwcmV0dXJuOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLy/kv67mraPpppbkuKrlj4LmlbDkvb/nlKhhcnJheeiAjOS4jeS8oOWFpeWQjue7reWPguaVsOeahOaDheWGtQ0KICAgIGlmIChpc19hcnJheSgkaWQpICYmIGlzc2V0KCRpZFsncm91dGUnXSkgJiYgJGZwYXJnc19jb3VudCA9PSAxKSB7DQogICAgICAgICRvYmplY3QgPSAkaWQ7DQogICAgICAgICRpc3Jld3JpdGUgPSB0cnVlOw0KICAgICAgICAkcG9zdHR5cGUgPSBHZXRWYWx1ZUluQXJyYXkoJG9iamVjdCwgJ3Bvc3R0eXBlJywgMCk7DQogICAgICAgICRjYW5jZWxkaXNwbGF5ID0gR2V0VmFsdWVJbkFycmF5KCRvYmplY3QsICdjYW5jZWxkaXNwbGF5JywgZmFsc2UpOw0KICAgICAgICAkcm91dGUgPSBHZXRWYWx1ZUluQXJyYXkoJG9iamVjdCwgJ3JvdXRlJywgYXJyYXkoKSk7DQogICAgICAgICRhbGlhcyA9IEdldFZhbHVlSW5BcnJheSgkb2JqZWN0LCAnYWxpYXMnLCBudWxsKTsNCiAgICAgICAgJGlkID0gR2V0VmFsdWVJbkFycmF5KCRvYmplY3QsICdpZCcsIG51bGwpOw0KICAgICAgICAvL+S7juWIq+WQjXBvc3TkuK3or7vlj5bmraPnoa7nmoQkaWTmiJYkYWxpYXMNCiAgICAgICAgaWYgKGlzc2V0KCRyb3V0ZVsnYXJncyddKSAmJiBpc19hcnJheSgkcm91dGVbJ2FyZ3MnXSkpIHsNCiAgICAgICAgICAgICRwYXJhbWV0ZXJzID0gVXJsUnVsZTo6UHJvY2Vzc1BhcmFtZXRlcnMoJHJvdXRlKTsNCiAgICAgICAgICAgIGZvcmVhY2ggKCRwYXJhbWV0ZXJzIGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICAgICAgICAgaWYgKCR2YWx1ZVsnbmFtZSddID09ICdpZCcgJiYgJHZhbHVlWydhbGlhcyddICE9ICcnKSB7DQogICAgICAgICAgICAgICAgICAgICRpZCA9IEdldFZhbHVlSW5BcnJheSgkb2JqZWN0LCAkdmFsdWVbJ2FsaWFzJ10sIG51bGwpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoJHZhbHVlWyduYW1lJ10gPT0gJ2FsaWFzJyAmJiAkdmFsdWVbJ2FsaWFzJ10gIT0gJycpIHsNCiAgICAgICAgICAgICAgICAgICAgJGFsaWFzID0gR2V0VmFsdWVJbkFycmF5KCRvYmplY3QsICR2YWx1ZVsnYWxpYXMnXSwgbnVsbCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfSBlbHNlIHsNCiAgICAgICAgJG9iamVjdCA9IGFycmF5KCk7DQogICAgICAgICRwb3N0dHlwZSA9IDA7DQogICAgICAgICRjYW5jZWxkaXNwbGF5ID0gZmFsc2U7DQogICAgICAgICRyb3V0ZSA9IGFycmF5KCk7DQogICAgICAgIGlmIChpc19hcnJheSgkaWQpKSB7DQogICAgICAgICAgICAkb2JqZWN0ID0gJGlkOw0KICAgICAgICAgICAgJGlkID0gaXNzZXQoJG9iamVjdFsnaWQnXSkgPyAkb2JqZWN0WydpZCddIDogbnVsbDsNCiAgICAgICAgICAgICRhbGlhcyA9IGlzc2V0KCRvYmplY3RbJ2FsaWFzJ10pID8gJG9iamVjdFsnYWxpYXMnXSA6IG51bGw7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkb2JqZWN0ID0gYXJyYXkoJ2lkJyA9PiAkaWQpOw0KICAgICAgICAgICAgJG9iamVjdFsnYWxpYXMnXSA9ICRhbGlhczsNCiAgICAgICAgICAgICRvYmplY3RbMF0gPSBlbXB0eSgkYWxpYXMpID8gJGlkIDogJGFsaWFzOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLy/lhbzlrrnogIHniYjmnKznmoTmjqXlj6MNCiAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9WaWV3UG9zdF9CZWdpbiddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAkZnBhcmdzX3YxID0gYXJyYXkoJGlkLCAkYWxpYXMsICRpc3Jld3JpdGUsICRvYmplY3QpOw0KICAgICAgICAkZnByZXR1cm4gPSBjYWxsX3VzZXJfZnVuY19hcnJheSgkZnBuYW1lLCAkZnBhcmdzX3YxKTsNCiAgICAgICAgaWYgKCRmcHNpZ25hbCA9PSBQTFVHSU5fRVhJVFNJR05BTF9SRVRVUk4pIHsNCiAgICAgICAgICAgICRmcHNpZ25hbCA9IFBMVUdJTl9FWElUU0lHTkFMX05PTkU7DQoNCiAgICAgICAgICAgIHJldHVybiAkZnByZXR1cm47DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAkc2VsZWN0ID0gJyc7DQogICAgJHcgPSBhcnJheSgpOw0KICAgICRvcmRlciA9IG51bGw7DQogICAgJGxpbWl0ID0gMTsNCiAgICAkb3B0aW9uID0gbnVsbDsNCg0KICAgICR3W10gPSBhcnJheSgnPScsICdsb2dfVHlwZScsICRwb3N0dHlwZSk7DQoNCiAgICBpZiAoJGlkICE9PSBudWxsICYmIGlzX251bWVyaWMoJGlkKSkgew0KICAgICAgICBpZiAoZnVuY3Rpb25fZXhpc3RzKCdjdHlwZV9kaWdpdCcpICYmICFjdHlwZV9kaWdpdCgoc3RyaW5nKSAkaWQpKSB7DQogICAgICAgICAgICAkemJwLT5TaG93RXJyb3IoMywgX19GSUxFX18sIF9fTElORV9fKTsNCiAgICAgICAgfQ0KDQogICAgICAgICR3W10gPSBhcnJheSgnPScsICdsb2dfSUQnLCAkaWQpOw0KICAgIH0gZWxzZWlmICgkYWxpYXMgIT09IG51bGwpIHsNCiAgICAgICAgaWYgKCR6YnAtPm9wdGlvblsnWkNfUE9TVF9BTElBU19VU0VfSURfTk9UX1RJVExFJ10gPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICR3W10gPSBhcnJheSgnYXJyYXknLCBhcnJheShhcnJheSgnbG9nX0FsaWFzJywgJGFsaWFzKSwgYXJyYXkoJ2xvZ19UaXRsZScsICRhbGlhcykpKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICR3W10gPSBhcnJheSgnYXJyYXknLCBhcnJheShhcnJheSgnbG9nX0FsaWFzJywgJGFsaWFzKSwgYXJyYXkoJ2xvZ19JRCcsICRhbGlhcykpKTsNCiAgICAgICAgfQ0KICAgIH0gZWxzZSB7DQogICAgICAgICR6YnAtPlNob3dFcnJvcigyLCBfX0ZJTEVfXywgX19MSU5FX18pOw0KICAgICAgICBleGl0Ow0KICAgIH0NCg0KICAgIGlmIChlbXB0eSgkemJwLT51c2VyLT5JRCkpIHsNCiAgICAgICAgJHdbXSA9IGFycmF5KCc9JywgJ2xvZ19TdGF0dXMnLCAwKTsNCiAgICB9DQoNCiAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9WaWV3UG9zdF9Db3JlJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICRmcG5hbWUoJHNlbGVjdCwgJHcsICRvcmRlciwgJGxpbWl0LCAkb3B0aW9uKTsNCiAgICB9DQoNCiAgICAkYXJ0aWNsZXMgPSAkemJwLT5HZXRQb3N0TGlzdCgkc2VsZWN0LCAkdywgJG9yZGVyLCAkbGltaXQsICRvcHRpb24pOw0KICAgIGlmIChjb3VudCgkYXJ0aWNsZXMpID09IDApIHsNCiAgICAgICAgaWYgKCFlbXB0eSgkcm91dGUpIHx8ICRpc3Jld3JpdGUgPT0gdHJ1ZSkgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQogICAgICAgICR6YnAtPlNob3dFcnJvcigyLCBfX0ZJTEVfXywgX19MSU5FX18pOw0KICAgIH0NCg0KICAgICRhcnRpY2xlID0gJGFydGljbGVzWzBdOw0KDQogICAgaWYgKCRwb3N0dHlwZSAhPSAkYXJ0aWNsZS0+VHlwZSkgew0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfSBlbHNlIHsNCiAgICAgICAgJGNsYXNzbmFtZSA9ICR6YnAtPkdldFBvc3RUeXBlKCRwb3N0dHlwZSwgJ2NsYXNzbmFtZScpOw0KICAgICAgICBpZiAoc3RyY2FzZWNtcChnZXRfY2xhc3MoJGFydGljbGUpLCAkY2xhc3NuYW1lKSAhPSAwKSB7DQogICAgICAgICAgICAkbmV3YXJ0aWNsZSA9ICRhcnRpY2xlLT5DbG9uZWQoZmFsc2UsICRjbGFzc25hbWUpOw0KICAgICAgICAgICAgJGFydGljbGUgPSAkbmV3YXJ0aWNsZTsNCiAgICAgICAgICAgICR6YnAtPkFkZFBvc3RDYWNoZSgkYXJ0aWNsZSk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBpZiAoJGFydGljbGUtPlN0YXR1cyAhPSAwICYmICEkemJwLT5DaGVja1JpZ2h0cygkYXJ0aWNsZS0+VHlwZUFjdGlvbnNbJ2FsbCddKSAmJiAoJGFydGljbGUtPkF1dGhvcklEICE9ICR6YnAtPnVzZXItPklEKSkgew0KICAgICAgICAkemJwLT5TaG93RXJyb3IoMiwgX19GSUxFX18sIF9fTElORV9fKTsNCiAgICB9DQoNCiAgICBpZiAoIWVtcHR5KCRyb3V0ZSkgfHwgJGlzcmV3cml0ZSA9PSB0cnVlKSB7DQogICAgICAgIGlmIChpc3NldCgkb2JqZWN0WzBdKSAmJiAhaXNzZXQoJG9iamVjdFsncGFnZSddKSkgew0KICAgICAgICAgICAgaWYgKCEoc3RyaXBvcyh1cmxkZWNvZGUoJGFydGljbGUtPlVybCksICRvYmplY3RbMF0pICE9PSBmYWxzZSkpIHsNCiAgICAgICAgICAgICAgICAvLyR6YnAtPlNob3dFcnJvcigyLCBfX0ZJTEVfXywgX19MSU5FX18pOw0KICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCg0KICAgICR6YnAtPkxvYWRUYWdzQnlJRFN0cmluZygkYXJ0aWNsZS0+VGFnKTsNCg0KICAgIGlmIChpc3NldCgkemJwLT5vcHRpb25bJ1pDX1ZJRVdOVU1TX1RVUk5PRkYnXSkgJiYgJHpicC0+b3B0aW9uWydaQ19WSUVXTlVNU19UVVJOT0ZGJ10gPT0gZmFsc2UpIHsNCiAgICAgICAgJGFydGljbGUtPlZpZXdOdW1zICs9IDE7DQogICAgICAgICRzcWwgPSAkemJwLT5kYi0+c3FsLT5VcGRhdGUoJHpicC0+dGFibGVbJ1Bvc3QnXSwgYXJyYXkoJ2xvZ19WaWV3TnVtcycgPT4gJGFydGljbGUtPlZpZXdOdW1zKSwgYXJyYXkoYXJyYXkoJz0nLCAnbG9nX0lEJywgJGFydGljbGUtPklEKSkpOw0KICAgICAgICAkemJwLT5kYi0+VXBkYXRlKCRzcWwpOw0KICAgIH0NCg0KICAgICRwYWdlYmFyID0gbmV3IFBhZ2ViYXIoJ2phdmFzY3JpcHQ6emJwLmNvbW1lbnQuZ2V0KFwnJyAuICRhcnRpY2xlLT5JRCAuICdcJyxcJ3slcGFnZSV9XCcpOycsIGZhbHNlKTsNCiAgICAkcGFnZWJhci0+UGFnZUNvdW50ID0gJHpicC0+Y29tbWVudGRpc3BsYXljb3VudDsNCiAgICAkcGFnZWJhci0+UGFnZU5vdyA9IDE7DQogICAgJHBhZ2ViYXItPlBhZ2VCYXJDb3VudCA9ICR6YnAtPnBhZ2ViYXJjb3VudDsNCiAgICAkcGFnZWJhci0+VXJsUnVsZS0+UnVsZXNPYmplY3QgPSAmJGFydGljbGU7DQoNCiAgICBpZiAoJHpicC0+b3B0aW9uWydaQ19DT01NRU5UX1RVUk5PRkYnXSkgew0KICAgICAgICAkYXJ0aWNsZS0+SXNMb2NrID0gdHJ1ZTsNCiAgICB9DQoNCiAgICAkY29tbWVudHMgPSBhcnJheSgpOw0KDQogICAgaWYgKCEkYXJ0aWNsZS0+SXNMb2NrICYmICR6YnAtPnNvY2lhbGNvbW1lbnQgPT0gbnVsbCkgew0KICAgICAgICAkY29tbWVudHMgPSAkemJwLT5HZXRDb21tZW50TGlzdCgNCiAgICAgICAgICAgICcqJywNCiAgICAgICAgICAgIGFycmF5KA0KICAgICAgICAgICAgICAgIGFycmF5KCc9JywgJ2NvbW1fTG9nSUQnLCAkYXJ0aWNsZS0+SUQpLA0KICAgICAgICAgICAgICAgIGFycmF5KCc9JywgJ2NvbW1fUm9vdElEJywgMCksDQogICAgICAgICAgICAgICAgYXJyYXkoJz0nLCAnY29tbV9Jc0NoZWNraW5nJywgMCksDQogICAgICAgICAgICApLA0KICAgICAgICAgICAgYXJyYXkoJ2NvbW1fSUQnID0+ICgkemJwLT5vcHRpb25bJ1pDX0NPTU1FTlRfUkVWRVJTRV9PUkRFUiddID8gJ0RFU0MnIDogJ0FTQycpKSwNCiAgICAgICAgICAgIGFycmF5KCgkcGFnZWJhci0+UGFnZU5vdyAtIDEpICogJHBhZ2ViYXItPlBhZ2VDb3VudCwgJHBhZ2ViYXItPlBhZ2VDb3VudCksDQogICAgICAgICAgICBhcnJheSgncGFnZWJhcicgPT4gJHBhZ2ViYXIpDQogICAgICAgICk7DQogICAgICAgICRyb290aWQgPSBhcnJheSgpOw0KICAgICAgICBmb3JlYWNoICgkY29tbWVudHMgYXMgJiRjb21tZW50KSB7DQogICAgICAgICAgICAkcm9vdGlkW10gPSAkY29tbWVudC0+SUQ7DQogICAgICAgIH0NCiAgICAgICAgJGNvbW1lbnRzMiA9ICR6YnAtPkdldENvbW1lbnRMaXN0KA0KICAgICAgICAgICAgJyonLA0KICAgICAgICAgICAgYXJyYXkoDQogICAgICAgICAgICAgICAgYXJyYXkoJz0nLCAnY29tbV9Mb2dJRCcsICRhcnRpY2xlLT5JRCksDQogICAgICAgICAgICAgICAgYXJyYXkoJ0lOJywgJ2NvbW1fUm9vdElEJywgJHJvb3RpZCksDQogICAgICAgICAgICAgICAgYXJyYXkoJz0nLCAnY29tbV9Jc0NoZWNraW5nJywgMCksDQogICAgICAgICAgICApLA0KICAgICAgICAgICAgYXJyYXkoJ2NvbW1fSUQnID0+ICgkemJwLT5vcHRpb25bJ1pDX0NPTU1FTlRfUkVWRVJTRV9PUkRFUiddID8gJ0RFU0MnIDogJ0FTQycpKSwNCiAgICAgICAgICAgIG51bGwsDQogICAgICAgICAgICBudWxsDQogICAgICAgICk7DQogICAgICAgICRmbG9vcmlkID0gKCgkcGFnZWJhci0+UGFnZU5vdyAtIDEpICogJHBhZ2ViYXItPlBhZ2VDb3VudCk7DQogICAgICAgIGZvcmVhY2ggKCRjb21tZW50cyBhcyAmJGNvbW1lbnQpIHsNCiAgICAgICAgICAgICRmbG9vcmlkICs9IDE7DQogICAgICAgICAgICAkY29tbWVudC0+Rmxvb3JJRCA9ICRmbG9vcmlkOw0KICAgICAgICAgICAgJGNvbW1lbnQtPkNvbnRlbnQgPSBGb3JtYXRTdHJpbmcoJGNvbW1lbnQtPkNvbnRlbnQsICdbZW50ZXJdJyk7DQogICAgICAgICAgICBpZiAoJHpicC0+YXV0b2ZpbGxfdGVtcGxhdGVfaHRtbHRhZ3MgJiYgc3RycG9zKCR6YnAtPnRlbXBsYXRlLT50ZW1wbGF0ZXNbJ2NvbW1lbnQnXSwgJ2lkPSJBamF4Q29tbWVudCcpID09PSBmYWxzZSkgew0KICAgICAgICAgICAgICAgICRjb21tZW50LT5Db250ZW50IC49ICc8bGFiZWwgaWQ9IkFqYXhDb21tZW50JyAuICRjb21tZW50LT5JRCAuICciPjwvbGFiZWw+JzsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBmb3JlYWNoICgkY29tbWVudHMyIGFzICYkY29tbWVudCkgew0KICAgICAgICAgICAgJGNvbW1lbnQtPkNvbnRlbnQgPSBGb3JtYXRTdHJpbmcoJGNvbW1lbnQtPkNvbnRlbnQsICdbZW50ZXJdJyk7DQogICAgICAgICAgICBpZiAoJHpicC0+YXV0b2ZpbGxfdGVtcGxhdGVfaHRtbHRhZ3MgJiYgc3RycG9zKCR6YnAtPnRlbXBsYXRlLT50ZW1wbGF0ZXNbJ2NvbW1lbnQnXSwgJ2lkPSJBamF4Q29tbWVudCcpID09PSBmYWxzZSkgew0KICAgICAgICAgICAgICAgICRjb21tZW50LT5Db250ZW50IC49ICc8bGFiZWwgaWQ9IkFqYXhDb21tZW50JyAuICRjb21tZW50LT5JRCAuICciPjwvbGFiZWw+JzsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCg0KICAgICR6YnAtPkxvYWRNZW1iZXJzSW5MaXN0KCRjb21tZW50cyk7DQoNCiAgICAkemJwLT50ZW1wbGF0ZS0+U2V0VGFncygncG9zdHR5cGUnLCAkYXJ0aWNsZS0+VHlwZSk7DQogICAgJHpicC0+dGVtcGxhdGUtPlNldFRhZ3MoJ3RpdGxlJywgKCRhcnRpY2xlLT5TdGF0dXMgPT0gMCA/ICcnIDogJ1snIC4gJHpicC0+bGFuZ1sncG9zdF9zdGF0dXNfbmFtZSddWyRhcnRpY2xlLT5TdGF0dXNdIC4gJ10nKSAuICRhcnRpY2xlLT5UaXRsZSk7DQogICAgJHpicC0+dGVtcGxhdGUtPlNldFRhZ3MoJ3VybCcsICRhcnRpY2xlLT5VcmwpOw0KICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCdhcnRpY2xlJywgJGFydGljbGUpOw0KICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCd0eXBlJywgJGFydGljbGUtPlR5cGVOYW1lKTsNCiAgICAkemJwLT50ZW1wbGF0ZS0+U2V0VGFncygncGFnZScsIDEpOw0KDQogICAgaWYgKCRwYWdlYmFyLT5QYWdlQWxsID09IDAgfHwgJHBhZ2ViYXItPlBhZ2VBbGwgPT0gMSkgew0KICAgICAgICAkcGFnZWJhciA9IG51bGw7DQogICAgfQ0KICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCdwYWdlYmFyJywgJHBhZ2ViYXIpOw0KICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCdjb21tZW50c3BhZ2ViYXInLCAkcGFnZWJhcik7DQogICAgJHpicC0+dGVtcGxhdGUtPlNldFRhZ3MoJ2NvbW1lbnRzcGFnZScsIDEpOw0KICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCdjb21tZW50cycsICRjb21tZW50cyk7DQoNCiAgICAkemJwLT50ZW1wbGF0ZS0+U2V0VGFncygnYXJncycsICRmcGFyZ3MpOw0KICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCdyb3V0ZScsICRyb3V0ZSk7DQoNCiAgICBpZiAoJHpicC0+dGVtcGxhdGUtPmhhc1RlbXBsYXRlKCRhcnRpY2xlLT5UZW1wbGF0ZSkpIHsNCiAgICAgICAgJHpicC0+dGVtcGxhdGUtPlNldFRlbXBsYXRlKCRhcnRpY2xlLT5UZW1wbGF0ZSk7DQogICAgfSBlbHNlIHsNCiAgICAgICAgJHpicC0+dGVtcGxhdGUtPlNldFRlbXBsYXRlKCR6YnAtPm9wdGlvblsnWkNfUE9TVF9ERUZBVUxUX1RFTVBMQVRFJ10pOw0KICAgIH0NCg0KICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1ZpZXdQb3N0X1RlbXBsYXRlJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICRmcHJldHVybiA9ICRmcG5hbWUoJHpicC0+dGVtcGxhdGUpOw0KICAgICAgICBpZiAoJGZwc2lnbmFsID09IFBMVUdJTl9FWElUU0lHTkFMX1JFVFVSTikgew0KICAgICAgICAgICAgJGZwc2lnbmFsID0gUExVR0lOX0VYSVRTSUdOQUxfTk9ORTsNCg0KICAgICAgICAgICAgcmV0dXJuICRmcHJldHVybjsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGlmICgkY2FuY2VsZGlzcGxheSA9PSBmYWxzZSkgew0KICAgICAgICAkemJwLT50ZW1wbGF0ZS0+RGlzcGxheSgpOw0KICAgIH0gZWxzZSB7DQogICAgICAgIHJldHVybiAkemJwLT50ZW1wbGF0ZS0+R2V0VGFncygndXJsJyk7DQogICAgfQ0KDQogICAgcmV0dXJuIHRydWU7DQp9DQoNCi8qKg0KICog5pi+56S65paH56ug5LiL6K+E6K665YiX6KGoLg0KICoNCiAqIEBwYXJhbSBpbnQgJHBvc3RpZCDmlofnq6BJRA0KICogQHBhcmFtIGludCAkcGFnZSAgIOmhteaVsA0KICoNCiAqIEB0aHJvd3MgRXhjZXB0aW9uDQogKg0KICogQHJldHVybiBib29sDQogKi8NCmZ1bmN0aW9uIFZpZXdDb21tZW50cygkcG9zdGlkLCAkcGFnZSkNCnsNCiAgICBnbG9iYWwgJHpicDsNCg0KICAgICRwb3N0ID0gbmV3IFBvc3QoKTsNCiAgICAkcG9zdCA9ICR6YnAtPkdldFBvc3RCeUlEKCRwb3N0aWQpOw0KICAgICRwYWdlID0gJHBhZ2UgPT0gMCA/IDEgOiAkcGFnZTsNCiAgICAkdGVtcGxhdGUgPSAnY29tbWVudHMnOw0KDQogICAgJHBhZ2ViYXIgPSBuZXcgUGFnZWJhcignamF2YXNjcmlwdDp6YnAuY29tbWVudC5nZXQoXCcnIC4gJHBvc3QtPklEIC4gJ1wnLFwneyVwYWdlJX1cJyk7Jyk7DQogICAgJHBhZ2ViYXItPlBhZ2VDb3VudCA9ICR6YnAtPmNvbW1lbnRkaXNwbGF5Y291bnQ7DQogICAgJHBhZ2ViYXItPlBhZ2VOb3cgPSAkcGFnZTsNCiAgICAkcGFnZWJhci0+UGFnZUJhckNvdW50ID0gJHpicC0+cGFnZWJhcmNvdW50Ow0KICAgIC8vJHBhZ2ViYXItPkNvdW50ID0gJHBvc3QtPkNvbW1OdW1zOw0KDQogICAgJGNvbW1lbnRzID0gYXJyYXkoKTsNCg0KICAgICRjb21tZW50cyA9ICR6YnAtPkdldENvbW1lbnRMaXN0KA0KICAgICAgICAnKicsDQogICAgICAgIGFycmF5KA0KICAgICAgICAgICAgYXJyYXkoJz0nLCAnY29tbV9Mb2dJRCcsICRwb3N0LT5JRCksDQogICAgICAgICAgICBhcnJheSgnPScsICdjb21tX1Jvb3RJRCcsIDApLA0KICAgICAgICAgICAgYXJyYXkoJz0nLCAnY29tbV9Jc0NoZWNraW5nJywgMCksDQogICAgICAgICksDQogICAgICAgIGFycmF5KCdjb21tX0lEJyA9PiAoJHpicC0+b3B0aW9uWydaQ19DT01NRU5UX1JFVkVSU0VfT1JERVInXSA/ICdERVNDJyA6ICdBU0MnKSksDQogICAgICAgIGFycmF5KCgkcGFnZWJhci0+UGFnZU5vdyAtIDEpICogJHBhZ2ViYXItPlBhZ2VDb3VudCwgJHBhZ2ViYXItPlBhZ2VDb3VudCksDQogICAgICAgIGFycmF5KCdwYWdlYmFyJyA9PiAkcGFnZWJhcikNCiAgICApOw0KICAgICRyb290aWQgPSBhcnJheSgpOw0KICAgIGZvcmVhY2ggKCRjb21tZW50cyBhcyAkY29tbWVudCkgew0KICAgICAgICAkcm9vdGlkW10gPSBhcnJheSgnY29tbV9Sb290SUQnLCAkY29tbWVudC0+SUQpOw0KICAgIH0NCiAgICAkY29tbWVudHMyID0gJHpicC0+R2V0Q29tbWVudExpc3QoDQogICAgICAgICcqJywNCiAgICAgICAgYXJyYXkoDQogICAgICAgICAgICBhcnJheSgnPScsICdjb21tX0xvZ0lEJywgJHBvc3QtPklEKSwNCiAgICAgICAgICAgIGFycmF5KCdhcnJheScsICRyb290aWQpLA0KICAgICAgICAgICAgYXJyYXkoJz0nLCAnY29tbV9Jc0NoZWNraW5nJywgMCksDQogICAgICAgICksDQogICAgICAgIGFycmF5KCdjb21tX0lEJyA9PiAoJHpicC0+b3B0aW9uWydaQ19DT01NRU5UX1JFVkVSU0VfT1JERVInXSA/ICdERVNDJyA6ICdBU0MnKSksDQogICAgICAgIG51bGwsDQogICAgICAgIG51bGwNCiAgICApOw0KDQogICAgJGZsb29yaWQgPSAoKCRwYWdlYmFyLT5QYWdlTm93IC0gMSkgKiAkcGFnZWJhci0+UGFnZUNvdW50KTsNCiAgICBmb3JlYWNoICgkY29tbWVudHMgYXMgJiRjb21tZW50KSB7DQogICAgICAgICRmbG9vcmlkICs9IDE7DQogICAgICAgICRjb21tZW50LT5GbG9vcklEID0gJGZsb29yaWQ7DQogICAgICAgICRjb21tZW50LT5Db250ZW50ID0gRm9ybWF0U3RyaW5nKCRjb21tZW50LT5Db250ZW50LCAnW2VudGVyXScpOw0KICAgICAgICBpZiAoJHpicC0+YXV0b2ZpbGxfdGVtcGxhdGVfaHRtbHRhZ3MgJiYgc3RycG9zKCR6YnAtPnRlbXBsYXRlLT50ZW1wbGF0ZXNbJ2NvbW1lbnQnXSwgJ2lkPSJBamF4Q29tbWVudCcpID09PSBmYWxzZSkgew0KICAgICAgICAgICAgJGNvbW1lbnQtPkNvbnRlbnQgLj0gJzxsYWJlbCBpZD0iQWpheENvbW1lbnQnIC4gJGNvbW1lbnQtPklEIC4gJyI+PC9sYWJlbD4nOw0KICAgICAgICB9DQogICAgfQ0KICAgIGZvcmVhY2ggKCRjb21tZW50czIgYXMgJiRjb21tZW50KSB7DQogICAgICAgICRjb21tZW50LT5Db250ZW50ID0gRm9ybWF0U3RyaW5nKCRjb21tZW50LT5Db250ZW50LCAnW2VudGVyXScpOw0KICAgICAgICBpZiAoJHpicC0+YXV0b2ZpbGxfdGVtcGxhdGVfaHRtbHRhZ3MgJiYgc3RycG9zKCR6YnAtPnRlbXBsYXRlLT50ZW1wbGF0ZXNbJ2NvbW1lbnQnXSwgJ2lkPSJBamF4Q29tbWVudCcpID09PSBmYWxzZSkgew0KICAgICAgICAgICAgJGNvbW1lbnQtPkNvbnRlbnQgLj0gJzxsYWJlbCBpZD0iQWpheENvbW1lbnQnIC4gJGNvbW1lbnQtPklEIC4gJyI+PC9sYWJlbD4nOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgJHpicC0+dGVtcGxhdGUtPlNldFRhZ3MoJ3RpdGxlJywgJHpicC0+dGl0bGUpOw0KICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCdhcnRpY2xlJywgJHBvc3QpOw0KICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCd0eXBlJywgJ2NvbW1lbnQnKTsNCg0KICAgIGlmICgkcGFnZWJhci0+UGFnZUFsbCA9PSAxKSB7DQogICAgICAgICRwYWdlYmFyID0gbnVsbDsNCiAgICB9DQoNCiAgICAkemJwLT50ZW1wbGF0ZS0+U2V0VGFncygncGFnZWJhcicsICRwYWdlYmFyKTsNCiAgICAkemJwLT50ZW1wbGF0ZS0+U2V0VGFncygnY29tbWVudHNwYWdlYmFyJywgJHBhZ2ViYXIpOw0KICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCdjb21tZW50c3BhZ2UnLCAkcGFnZSk7DQogICAgJHpicC0+dGVtcGxhdGUtPlNldFRhZ3MoJ2NvbW1lbnRzJywgJGNvbW1lbnRzKTsNCg0KICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUZW1wbGF0ZSgkdGVtcGxhdGUpOw0KDQogICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fVmlld0NvbW1lbnRzX1RlbXBsYXRlJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICRmcHJldHVybiA9ICRmcG5hbWUoJHpicC0+dGVtcGxhdGUpOw0KICAgIH0NCg0KICAgICRzID0gJHpicC0+dGVtcGxhdGUtPk91dHB1dCgpOw0KDQogICAgJGEgPSBleHBsb2RlKCc8bGFiZWwgaWQ9IkFqYXhDb21tZW50QmVnaW4iPjwvbGFiZWw+JywgJHMpOw0KICAgICRzID0gJGFbMV07DQogICAgJGEgPSBleHBsb2RlKCc8bGFiZWwgaWQ9IkFqYXhDb21tZW50RW5kIj48L2xhYmVsPicsICRzKTsNCiAgICAkcyA9ICRhWzBdOw0KDQogICAgZWNobyAkczsNCg0KICAgIHJldHVybiB0cnVlOw0KfQ0KDQovKioNCiAqIOaYvuekuuivhOiuui4NCiAqDQogKiBAcGFyYW0gaW50ICRpZCDor4TorrpJRA0KICoNCiAqIEB0aHJvd3MgRXhjZXB0aW9uDQogKg0KICogQHJldHVybiBib29sDQogKi8NCmZ1bmN0aW9uIFZpZXdDb21tZW50KCRpZCkNCnsNCiAgICBnbG9iYWwgJHpicDsNCg0KICAgICR0ZW1wbGF0ZSA9ICdjb21tZW50JzsNCiAgICAvKiBAdmFyIENvbW1lbnQgJGNvbW1lbnQgKi8NCiAgICAkY29tbWVudCA9ICR6YnAtPkdldENvbW1lbnRCeUlEKCRpZCk7DQogICAgJHBvc3QgPSBuZXcgUG9zdCgpOw0KICAgICRwb3N0ID0gJHpicC0+R2V0UG9zdEJ5SUQoJGNvbW1lbnQtPkxvZ0lEKTsNCg0KICAgICRjb21tZW50LT5Db250ZW50ID0gRm9ybWF0U3RyaW5nKGh0bWxzcGVjaWFsY2hhcnMoJGNvbW1lbnQtPkNvbnRlbnQpLCAnW2VudGVyXScpOw0KICAgIGlmICgkemJwLT5hdXRvZmlsbF90ZW1wbGF0ZV9odG1sdGFncyAmJiBzdHJwb3MoJHpicC0+dGVtcGxhdGUtPnRlbXBsYXRlc1snY29tbWVudCddLCAnaWQ9IkFqYXhDb21tZW50JykgPT09IGZhbHNlKSB7DQogICAgICAgICRjb21tZW50LT5Db250ZW50IC49ICc8bGFiZWwgaWQ9IkFqYXhDb21tZW50JyAuICRjb21tZW50LT5JRCAuICciPjwvbGFiZWw+JzsNCiAgICB9DQoNCiAgICAkemJwLT50ZW1wbGF0ZS0+U2V0VGFncygndGl0bGUnLCAkemJwLT50aXRsZSk7DQogICAgJHpicC0+dGVtcGxhdGUtPlNldFRhZ3MoJ2NvbW1lbnQnLCAkY29tbWVudCk7DQogICAgJHpicC0+dGVtcGxhdGUtPlNldFRhZ3MoJ2FydGljbGUnLCAkcG9zdCk7DQogICAgJHpicC0+dGVtcGxhdGUtPlNldFRhZ3MoJ3R5cGUnLCAnY29tbWVudCcpOw0KICAgICR6YnAtPnRlbXBsYXRlLT5TZXRUYWdzKCdwYWdlJywgMSk7DQogICAgJHpicC0+dGVtcGxhdGUtPlNldFRlbXBsYXRlKCR0ZW1wbGF0ZSk7DQoNCiAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9WaWV3Q29tbWVudF9UZW1wbGF0ZSddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAkZnByZXR1cm4gPSAkZnBuYW1lKCR6YnAtPnRlbXBsYXRlKTsNCiAgICB9DQoNCiAgICAkemJwLT50ZW1wbGF0ZS0+RGlzcGxheSgpOw0KDQogICAgcmV0dXJuIHRydWU7DQp9DQo=</file>
	<file name='zb_system\function\c_system_version.php' crc32='8AEE7554'  dt:dt='bin.base64'>PD9waHANCg0KaWYgKCFkZWZpbmVkKCdaQlBfUEFUSCcpKSB7DQogICAgZXhpdCgnQWNjZXNzIGRlbmllZCcpOw0KfQ0KLyoNCiAqIOWumuS5ieeJiOacrOWPtw0KDQrov5nmmK8xLjXlj5bmtojnmoTmlbDnu4TvvIzooqvlronmjpLliLDlupTnlKjkuK3lv4PlrqLmiLfnq6/nmoRpbmNsdWRlLnBocOaWh+S7tumHjOOAgg0KI+WumuS5ieeJiOacrOWPt+WIlw0KJHpicHZlcnM9YXJyYXkoKTsNCiR6YnB2ZXJzWycxMzA3MDcnXT0nMS4wIEJldGEgQnVpbGQgMTMwNzA3JzsNCiR6YnB2ZXJzWycxMzExMTEnXT0nMS4wIEJldGEyIEJ1aWxkIDEzMTExMSc7DQokemJwdmVyc1snMTMxMjIxJ109JzEuMSBUYWljaGkgQnVpbGQgMTMxMjIxJzsNCiR6YnB2ZXJzWycxNDAyMjAnXT0nMS4yIEhpcHBvIEJ1aWxkIDE0MDIyMCc7DQokemJwdmVyc1snMTQwNjE0J109JzEuMyBXb25jZSBCdWlsZCAxNDA2MTQnOw0KJHpicHZlcnNbJzE1MDEwMSddPScxLjQgRGVlcGx1ZSBCdWlsZCAxNTAxMDEnOw0KJHpicHZlcnNbJzE1MTYyNiddPScxLjUgWmVybyBCdWlsZCAxNTE2MjYnOw0KDQogKi8NCmRlZmluZSgnWkNfVkVSU0lPTl9NQUpPUicsICcxJyk7DQpkZWZpbmUoJ1pDX1ZFUlNJT05fTUlOT1InLCAnNycpOw0KZGVmaW5lKCdaQ19WRVJTSU9OX0JVSUxEJywgJzAnKTsNCmRlZmluZSgnWkNfVkVSU0lPTl9DT01NSVQnLCAnMjkyMCcpOw0KZGVmaW5lKCdaQ19WRVJTSU9OX0NPREVOQU1FJywgJ1RlbmV0Jyk7DQpkZWZpbmUoJ1pDX1ZFUlNJT04nLCBaQ19WRVJTSU9OX01BSk9SIC4gJy4nIC4gWkNfVkVSU0lPTl9NSU5PUiAuICcuJyAuIFpDX1ZFUlNJT05fQlVJTEQgLiAnLicgLiBaQ19WRVJTSU9OX0NPTU1JVCk7DQppZiAoc3RyY2FzZWNtcChaQ19WRVJTSU9OX0NPREVOQU1FLCAnQmV0YScpID09IDAgfHwgc3RyY2FzZWNtcChaQ19WRVJTSU9OX0NPREVOQU1FLCAnQWxwaGEnKSA9PSAwKSB7DQogICAgZGVmaW5lKCdaQ19WRVJTSU9OX0RJU1BMQVknLCBaQ19WRVJTSU9OX01BSk9SIC4gJy4nIC4gWkNfVkVSU0lPTl9NSU5PUiAuICcuJyAuIFpDX1ZFUlNJT05fQlVJTEQgLiAnICcgLiBaQ19WRVJTSU9OX0NPREVOQU1FKTsNCn0gZWxzZSB7DQogICAgZGVmaW5lKCdaQ19WRVJTSU9OX0RJU1BMQVknLCBaQ19WRVJTSU9OX01BSk9SIC4gJy4nIC4gWkNfVkVSU0lPTl9NSU5PUiAuICcuJyAuIFpDX1ZFUlNJT05fQlVJTEQpOw0KfQ0KZGVmaW5lKCdaQ19WRVJTSU9OX0ZVTEwnLCBaQ19WRVJTSU9OIC4gJyAoJyAuIFpDX1ZFUlNJT05fQ09ERU5BTUUgLiAnKScpOw0KZGVmaW5lKCdaQ19CTE9HX0NPTU1JVCcsIFpDX1ZFUlNJT05fQ09NTUlUKTsgLy8g5Li65YaZ5YWl57O757uf6YWN572u57uf5LiA6aOO5qC8DQokR0xPQkFMU1snYmxvZ3ZlcnNpb24nXSA9IFpDX1ZFUlNJT05fTUFKT1IgLiBaQ19WRVJTSU9OX01JTk9SIC4gWkNfVkVSU0lPTl9DT01NSVQ7DQpkZWZpbmUoJ1pDX0JMT0dfVkVSU0lPTicsIFpDX1ZFUlNJT05fRElTUExBWSAuICcgQnVpbGQgJyAuICRHTE9CQUxTWydibG9ndmVyc2lvbiddKTsNCmRlZmluZSgnWkNfTEFTVF9WRVJTSU9OJywgJzE3MjgwMCcpOyAvL+aVsOaNruW6k+mHjOWGmeWFpeeahOacgOaWsOeahOaVsOaNruW6k+eJiOacrOWPt++8iOmdnuezu+e7n+eJiOacrOWPt++8jOWPquacieabtOaUueaVsOaNruW6k+e7k+aehOaJjeS8muWPmOWKqO+8iQ0K</file>
	<file name='zb_system\function\lib\config.php' crc32='74B8E7BD'  dt:dt='bin.base64'>PD9waHANCg0KaWYgKCFkZWZpbmVkKCdaQlBfUEFUSCcpKSB7DQogICAgZXhpdCgnQWNjZXNzIGRlbmllZCcpOw0KfQ0KDQovKioNCiAqIOmFjee9ruexuy4NCiAqLw0KY2xhc3MgQ29uZmlnIGltcGxlbWVudHMgSXRlcmF0b3INCnsNCg0KICAgIHByaXZhdGUgJHBvc2l0aW9uID0gMDsNCg0KICAgIHByaXZhdGUgJGFycmF5ID0gYXJyYXkoKTsgLy/lrZgka2V555qE5pWw57uE77yM6Z2eJHZhbHVlDQoNCiAgICBwdWJsaWMgZnVuY3Rpb24gcmV3aW5kKCkNCiAgICB7DQogICAgICAgIC8vZm9yZWFjaCAoJHRoaXMtPmt2ZGF0YSBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAvLyAgICAkdGhpcy0+YXJyYXlbXSA9ICRrZXk7DQogICAgICAgIC8vfQ0KICAgICAgICAkdGhpcy0+YXJyYXkgPSBhcnJheV9rZXlzKCR0aGlzLT5rdmRhdGEpOw0KICAgICAgICAkdGhpcy0+cG9zaXRpb24gPSAwOw0KICAgIH0NCg0KICAgIHB1YmxpYyBmdW5jdGlvbiBjdXJyZW50KCkNCiAgICB7DQogICAgICAgIHJldHVybiAkdGhpcy0+a3ZkYXRhWyR0aGlzLT5hcnJheVskdGhpcy0+cG9zaXRpb25dXTsNCiAgICB9DQoNCiAgICBwdWJsaWMgZnVuY3Rpb24ga2V5KCkNCiAgICB7DQogICAgICAgIHJldHVybiAkdGhpcy0+YXJyYXlbJHRoaXMtPnBvc2l0aW9uXTsNCiAgICB9DQoNCiAgICBwdWJsaWMgZnVuY3Rpb24gbmV4dCgpDQogICAgew0KICAgICAgICArKyR0aGlzLT5wb3NpdGlvbjsNCiAgICB9DQoNCiAgICBwdWJsaWMgZnVuY3Rpb24gdmFsaWQoKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuIGFycmF5X2tleV9leGlzdHMoJHRoaXMtPnBvc2l0aW9uLCAkdGhpcy0+YXJyYXkpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nIOaVsOaNruihqA0KICAgICAqLw0KICAgIHByb3RlY3RlZCAkdGFibGUgPSAnJzsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgYXJyYXkg6KGo57uT5p6E5L+h5oGvDQogICAgICovDQogICAgcHJvdGVjdGVkICRkYXRhaW5mbyA9IGFycmF5KCk7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIGFycmF5IOWOn+Wni2Ri5pWw5o2u5pWw57uEDQogICAgICovDQogICAgcHJvdGVjdGVkICRkYXRhID0gYXJyYXkoKTsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgYXJyYXkg5a2Y5YKoQ29uZmln55u45bqUa2V5LXZhbHVl5pWw5YC855qE5pWw57uEDQogICAgICovDQogICAgcHJvdGVjdGVkICRrdmRhdGEgPSBhcnJheSgpOw0KDQogICAgLyoqDQogICAgICogQHZhciBhcnJheSDlrZjlgqhDb25maWfnm7jlupTljp/lp4vmlbDmja7nmoTmlbDnu4QNCiAgICAgKi8NCiAgICBwcm90ZWN0ZWQgJG9yaWdrdmRhdGEgPSBhcnJheSgpOw0KDQogICAgLyoqDQogICAgICogQHZhciBEYXRhYmFzZV9fSW50ZXJmYWNlDQogICAgICovDQogICAgcHJvdGVjdGVkICRkYiA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiAkaXRlbW5hbWUgc3RyaW5nIOmhueebruWQjeensC4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJGl0ZW1OYW1lDQogICAgICogQHBhcmFtIG51bGwgICAkZGINCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGl0ZW1OYW1lID0gJycsICYkZGIgPSBudWxsKQ0KICAgIHsNCiAgICAgICAgaWYgKCRkYiAhPT0gbnVsbCkgew0KICAgICAgICAgICAgJHRoaXMtPmRiID0gJiRkYjsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICR0aGlzLT5kYiA9ICYkR0xPQkFMU1snemJwJ10tPmRiOw0KICAgICAgICB9DQoNCiAgICAgICAgJHRoaXMtPnRhYmxlID0gJiRHTE9CQUxTWyd0YWJsZSddWydDb25maWcnXTsNCiAgICAgICAgJHRoaXMtPmRhdGFpbmZvID0gJiRHTE9CQUxTWydkYXRhaW5mbyddWydDb25maWcnXTsNCg0KICAgICAgICBmb3JlYWNoICgkdGhpcy0+ZGF0YWluZm8gYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgICAgICR0aGlzLT5kYXRhWyRrZXldID0gJHZhbHVlWzNdOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCRpdGVtTmFtZSkgew0KICAgICAgICAgICAgJGl0ZW1OYW1lID0gRmlsdGVyQ29ycmVjdE5hbWUoJGl0ZW1OYW1lKTsNCiAgICAgICAgfQ0KDQogICAgICAgICR0aGlzLT5kYXRhWydOYW1lJ10gPSAkaXRlbU5hbWU7DQogICAgICAgICR0aGlzLT5wb3NpdGlvbiA9IDA7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogQHBhcmFtICRuYW1lDQogICAgICogQHBhcmFtICR2YWx1ZQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBfX3NldCgkbmFtZSwgJHZhbHVlKQ0KICAgIHsNCiAgICAgICAgJG5hbWUgPSBGaWx0ZXJDb3JyZWN0TmFtZSgkbmFtZSk7DQogICAgICAgICR0aGlzLT5rdmRhdGFbJG5hbWVdID0gJHZhbHVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUga2V55ZCNDQogICAgICoNCiAgICAgKiBAcmV0dXJuIG51bGwNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gX19nZXQoJG5hbWUpDQogICAgew0KICAgICAgICBpZiAoIWlzc2V0KCR0aGlzLT5rdmRhdGFbJG5hbWVdKSkgew0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICR0aGlzLT5rdmRhdGFbJG5hbWVdOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBwYXJhbSAkbmFtZQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBfX2lzc2V0KCRuYW1lKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuIGFycmF5X2tleV9leGlzdHMoJG5hbWUsICR0aGlzLT5rdmRhdGEpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBwYXJhbSAkbmFtZQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBfX3Vuc2V0KCRuYW1lKQ0KICAgIHsNCiAgICAgICAgdW5zZXQoJHRoaXMtPmt2ZGF0YVskbmFtZV0pOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOiOt+WPlkRhdGHmlbDmja4uDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGFycmF5DQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldERhdGEoKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuICR0aGlzLT5rdmRhdGE7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6I635Y+WQ29uZmln55qESXRlbSjpobnnm67lkI0pLg0KICAgICAqDQogICAgICogQHJldHVybiBzdHJpbmcNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0SXRlbU5hbWUoKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuICR0aGlzLT5kYXRhWydOYW1lJ107DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5qOA5p+lS1ZEYXRh5bGe5oCn77yI5pWw57uE77yJ5bGe5oCn5YC85piv5piv5ZCm5a2Y5Zyo55u45bqUa2V5Lg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbmFtZSBrZXnlkI0NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBIYXNLZXkoJG5hbWUpDQogICAgew0KICAgICAgICByZXR1cm4gYXJyYXlfa2V5X2V4aXN0cygkbmFtZSwgJHRoaXMtPmt2ZGF0YSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5qOA5p+lS1ZEYXRh5bGe5oCn77yI5pWw57uE77yJ5Lit55qE5Y2V5YWD5pWw55uuLg0KICAgICAqDQogICAgICogQHJldHVybiBpbnQNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQ291bnRJdGVtKCkNCiAgICB7DQogICAgICAgIHJldHVybiBjb3VudCgkdGhpcy0+a3ZkYXRhKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgZnVuY3Rpb24gQ291bnRJdGVtT3JpZygpDQogICAgew0KICAgICAgICByZXR1cm4gY291bnQoJHRoaXMtPm9yaWdrdmRhdGEpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWPjOmHjeaEj+S5ieeahOWHveaVsA0KICAgICAqICRuYW1l5Li6bnVsbOWwsei9rOWQkURlbGV0ZSgpDQogICAgICogJG5hbWXkuI3kuLpudWxs5bCx6L2s5ZCRRGVsS2V5KCkNCiAgICAgKiDliKDpmaRLVkRhdGHlsZ7mgKfvvIjmlbDnu4TvvInkuK3nmoTnm7jlupTpobkNCiAgICAgKiBEZWzlkI3np7DlkozmlbDmja7lupPliKDpmaTlh73mlbDmnInlhrLnqoENCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUga2V55ZCNDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIERlbCgkbmFtZSA9IG51bGwpDQogICAgew0KICAgICAgICBpZiAoJG5hbWUgPT09IG51bGwpIHsNCiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+RGVsZXRlKCk7DQogICAgICAgIH0NCiAgICAgICAgaWYgKCRuYW1lICE9PSBudWxsKSB7DQogICAgICAgICAgICByZXR1cm4gJHRoaXMtPkRlbEtleSgkbmFtZSk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDlsIZEYXRh5bGe5oCn77yI5pWw57uE77yJ5YC85bqP5YiX5YyWLg0KICAgICAqDQogICAgICogQHJldHVybiBzdHJpbmcg6L+U5Zue5bqP5YiX5YyW55qE5YC8DQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFNlcmlhbGl6ZSgpDQogICAgew0KICAgICAgICBnbG9iYWwgJGJsb2dob3N0Ow0KICAgICAgICBpZiAoY291bnQoJHRoaXMtPmt2ZGF0YSkgPT0gMCkgew0KICAgICAgICAgICAgcmV0dXJuICcnOw0KICAgICAgICB9DQoNCiAgICAgICAgJGFycmF5ID0gJHRoaXMtPmt2ZGF0YTsNCiAgICAgICAgZm9yZWFjaCAoJGFycmF5IGFzICRrZXkgPT4gJiR2YWx1ZSkgew0KICAgICAgICAgICAgaWYgKGlzX3N0cmluZygkdmFsdWUpKSB7DQogICAgICAgICAgICAgICAgJHZhbHVlID0gc3RyX3JlcGxhY2UoJGJsb2dob3N0LCAneyNaQ19CTE9HX0hPU1QjfScsICR2YWx1ZSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gc2VyaWFsaXplKCRhcnJheSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5bCG5bqP5YiX5YyW55qE5YC85Y+N5bqP5YiX5YyW5ZCO6LWL5LqIRGF0YeWxnuaAp+WAvA0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkcyDluo/liJfljJblgLwNCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBVbnNlcmlhbGl6ZSgkcykNCiAgICB7DQogICAgICAgIGdsb2JhbCAkYmxvZ2hvc3Q7DQoNCiAgICAgICAgaWYgKCRzID09ICcnKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCg0KICAgICAgICAkdGhpcy0+a3ZkYXRhID0gQHVuc2VyaWFsaXplKCRzKTsNCiAgICAgICAgaWYgKCFpc19hcnJheSgkdGhpcy0+a3ZkYXRhKSkgew0KICAgICAgICAgICAgJHRoaXMtPmt2ZGF0YSA9IGFycmF5KCk7DQoNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgIGZvcmVhY2ggKCR0aGlzLT5rdmRhdGEgYXMgJGtleSA9PiAmJHZhbHVlKSB7DQogICAgICAgICAgICBpZiAoaXNfc3RyaW5nKCR2YWx1ZSkpIHsNCiAgICAgICAgICAgICAgICAkdmFsdWUgPSBzdHJfcmVwbGFjZSgneyNaQ19CTE9HX0hPU1QjfScsICRibG9naG9zdCwgJHZhbHVlKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOS7juaVsOe7hOS4reWKoOi9veaVsOaNri4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBhcnJheSAkYXJyYXkg5YWz6IGU5pWw57uEDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gTG9hZEluZm9CeUFzc29jKCRhcnJheSkNCiAgICB7DQogICAgICAgIGZvcmVhY2ggKCR0aGlzLT5kYXRhaW5mbyBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAgICAgaWYgKCFpc3NldCgkYXJyYXlbJHZhbHVlWzBdXSkpIHsNCiAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgICR0aGlzLT5kYXRhWyRrZXldID0gJGFycmF5WyR2YWx1ZVswXV07DQogICAgICAgIH0NCiAgICAgICAgJHRoaXMtPlVuc2VyaWFsaXplKCR0aGlzLT5kYXRhWydWYWx1ZSddKTsNCiAgICAgICAgJHRoaXMtPm9yaWdrdmRhdGEgPSAkdGhpcy0+a3ZkYXRhOw0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOS4uuS6huWKoOW/q+WkhOeQhumAn+W6puaJjeWGmeeahOS4gOWvuVdpdGhQcmUsV2l0aEFmdGVy5Ye95pWwLg0KICAgICAqLw0KICAgIHByaXZhdGUgJGRhdGFfcHJlX2tleSA9IGFycmF5KCk7DQoNCiAgICBwcml2YXRlICRkYXRhX3ByZV92YWx1ZSA9IGFycmF5KCk7DQoNCiAgICBwdWJsaWMgZnVuY3Rpb24gTG9hZEluZm9CeUFzc29jU2luZ2xlV2l0aFByZSgkYXJyYXkpDQogICAgew0KICAgICAgICAka2V5ID0gdHJpbSgkYXJyYXlbJHRoaXMtPmRhdGFpbmZvWydLZXknXVswXV0pOw0KICAgICAgICAkdmFsdWUgPSB0cmltKCRhcnJheVskdGhpcy0+ZGF0YWluZm9bJ1ZhbHVlJ11bMF1dKTsNCiAgICAgICAgJHRoaXMtPmRhdGFfcHJlX2tleVtdID0gJGtleTsNCiAgICAgICAgJHRoaXMtPmRhdGFfcHJlX3ZhbHVlW10gPSAkdmFsdWU7DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgcHVibGljIGZ1bmN0aW9uIExvYWRJbmZvQnlBc3NvY1NpbmdsZVdpdGhBZnRlcigpDQogICAgew0KICAgICAgICBnbG9iYWwgJGJsb2dob3N0Ow0KICAgICAgICBpZiAoY291bnQoJHRoaXMtPmRhdGFfcHJlX3ZhbHVlKSA9PSAwIHx8IGNvdW50KCR0aGlzLT5kYXRhX3ByZV9rZXkpID09IDApIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgICR0aGlzLT5rdmRhdGEgPSBhcnJheSgpOw0KDQogICAgICAgIGZvcmVhY2ggKCR0aGlzLT5kYXRhX3ByZV92YWx1ZSBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAgICAgaWYgKGlzX2FycmF5KCR0aGlzLT5kYXRhX3ByZV9rZXlbJGtleV0pKSB7DQogICAgICAgICAgICAgICAgdW5zZXQoJHRoaXMtPmRhdGFfcHJlX2tleVska2V5XSk7DQogICAgICAgICAgICAgICAgdW5zZXQoJHRoaXMtPmRhdGFfcHJlX3ZhbHVlWyRrZXldKTsNCiAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIEAkdGhpcy0+a3ZkYXRhWyR0aGlzLT5kYXRhX3ByZV9rZXlbJGtleV1dID0gdW5zZXJpYWxpemUoJHRoaXMtPmRhdGFfcHJlX3ZhbHVlWyRrZXldKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGZvcmVhY2ggKCR0aGlzLT5rdmRhdGEgYXMgJGtleSA9PiAmJHZhbHVlKSB7DQogICAgICAgICAgICBpZiAoaXNfc3RyaW5nKCR2YWx1ZSkpIHsNCiAgICAgICAgICAgICAgICAkdmFsdWUgPSBzdHJfcmVwbGFjZSgneyNaQ19CTE9HX0hPU1QjfScsICRibG9naG9zdCwgJHZhbHVlKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICAkdGhpcy0+b3JpZ2t2ZGF0YSA9ICR0aGlzLT5rdmRhdGE7DQogICAgICAgICR0aGlzLT5kYXRhX3ByZV9rZXlbXSA9IGFycmF5KCk7DQogICAgICAgICR0aGlzLT5kYXRhX3ByZV92YWx1ZVtdID0gYXJyYXkoKTsNCg0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICBwdWJsaWMgZnVuY3Rpb24gTG9hZEluZm9CeUFzc29jU2luZ2xlKCRhcnJheSkNCiAgICB7DQogICAgICAgICRrZXkgPSB0cmltKCRhcnJheVskdGhpcy0+ZGF0YWluZm9bJ0tleSddWzBdXSk7DQogICAgICAgICR2YWx1ZSA9IHRyaW0oJGFycmF5WyR0aGlzLT5kYXRhaW5mb1snVmFsdWUnXVswXV0pOw0KDQogICAgICAgICR2YWx1ZSA9ICR0aGlzLT5VbnNlcmlhbGl6ZVNpbmdsZSgkdmFsdWUpOw0KICAgICAgICAkdGhpcy0+a3ZkYXRhWyRrZXldID0gJHZhbHVlOw0KICAgICAgICAkdGhpcy0+b3JpZ2t2ZGF0YVska2V5XSA9ICR2YWx1ZTsNCg0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICBwdWJsaWMgZnVuY3Rpb24gU2VyaWFsaXplU2luZ2xlKCR2YWx1ZSkNCiAgICB7DQogICAgICAgIGdsb2JhbCAkYmxvZ2hvc3Q7DQogICAgICAgIGlmIChpc19zdHJpbmcoJHZhbHVlKSkgew0KICAgICAgICAgICAgJHZhbHVlID0gc3RyX3JlcGxhY2UoJGJsb2dob3N0LCAneyNaQ19CTE9HX0hPU1QjfScsICR2YWx1ZSk7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gc2VyaWFsaXplKCR2YWx1ZSk7DQogICAgfQ0KDQogICAgcHVibGljIGZ1bmN0aW9uIFVuc2VyaWFsaXplU2luZ2xlKCR2YWx1ZSkNCiAgICB7DQogICAgICAgIGdsb2JhbCAkYmxvZ2hvc3Q7DQogICAgICAgICR2YWx1ZSA9IEB1bnNlcmlhbGl6ZSgkdmFsdWUpOw0KDQogICAgICAgIGlmIChpc19zdHJpbmcoJHZhbHVlKSkgew0KICAgICAgICAgICAgJHZhbHVlID0gc3RyX3JlcGxhY2UoJ3sjWkNfQkxPR19IT1NUI30nLCAkYmxvZ2hvc3QsICR2YWx1ZSk7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJHZhbHVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOS/neWtmOaVsOaNri4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBTYXZlKCkNCiAgICB7DQogICAgICAgICRuYW1lID0gJHRoaXMtPkdldEl0ZW1OYW1lKCk7DQogICAgICAgIGlmICgkbmFtZSA9PSAnJykgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgJGFkZCA9IGFycmF5X2RpZmZfa2V5KCR0aGlzLT5rdmRhdGEsICR0aGlzLT5vcmlna3ZkYXRhKTsNCiAgICAgICAgJGRlbCA9IGFycmF5X2RpZmZfa2V5KCR0aGlzLT5vcmlna3ZkYXRhLCAkdGhpcy0+a3ZkYXRhKTsNCiAgICAgICAgJG1vZCA9IGFycmF5KCk7IC8vYXJyYXlfaW50ZXJzZWN0KCR0aGlzLT5rdmRhdGEsICR0aGlzLT5vcmlna3ZkYXRhKTsNCiAgICAgICAgZm9yZWFjaCAoJHRoaXMtPmt2ZGF0YSBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAgICAgaWYgKGFycmF5X2tleV9leGlzdHMoJGtleSwgJHRoaXMtPm9yaWdrdmRhdGEpICYmICR0aGlzLT5rdmRhdGFbJGtleV0gIT0gJHRoaXMtPm9yaWdrdmRhdGFbJGtleV0pIHsNCiAgICAgICAgICAgICAgICAkbW9kWyRrZXldID0gJHZhbHVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIC8vdmFyX2R1bXAoY291bnQoJHRoaXMtPmt2ZGF0YSksY291bnQoJHRoaXMtPm9yaWdrdmRhdGEpKTtkaWU7DQogICAgICAgIC8vbG9ncyh2YXJfZXhwb3J0KCBhcnJheSgkdGhpcy0+b3JpZ2t2ZGF0YVsnWkNfREVCVUdfTU9ERSddLCAkdGhpcy0+a3ZkYXRhWydaQ19ERUJVR19NT0RFJ10pLCB0cnVlICkgKTsNCiAgICAgICAgLy9sb2dzKHZhcl9leHBvcnQoIGFycmF5KCdhZGQnPT4kYWRkICwgJ2RlbCc9PiRkZWwgLCAnbW9kJz0+JG1vZCksdHJ1ZSApICk7DQogICAgICAgIC8vdmFyX2R1bXAoJHRoaXMtPm9yaWdrdmRhdGFbJ1pDX0RFQlVHX01PREUnXSwgJHRoaXMtPmt2ZGF0YVsnWkNfREVCVUdfTU9ERSddKTsNCiAgICAgICAgLy92YXJfZHVtcCgkYWRkLCAkZGVsLCAkbW9kKTsNCiAgICAgICAgLy92YXJfZHVtcCgkdGhpcy0+a3ZkYXRhLCAkdGhpcy0+b3JpZ2t2ZGF0YSk7ZGllOw0KICAgICAgICBpZiAoKCRhZGQgKyAkZGVsICsgJG1vZCkgPT0gYXJyYXkoKSkgew0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0NCg0KICAgICAgICAkb2xkID0gQCR0aGlzLT5kYi0+UXVlcnkoJHRoaXMtPmRiLT5zcWwtPlNlbGVjdCgkdGhpcy0+dGFibGUsICR0aGlzLT5kYXRhaW5mb1snS2V5J11bMF0sIG51bGwsIG51bGwsIDEpKTsNCiAgICAgICAgLy/msqHmnInov5nkuKrlrZfmrrXvvJphcnJheSgxKSB7IFswXT0+IGJvb2woZmFsc2UpIH0NCiAgICAgICAgaWYgKGNvdW50KCRvbGQpID09IDEgJiYgJG9sZFswXSA9PT0gZmFsc2UpIHsgLy/lpoLmnpzov5jmsqHmnInlu7pjb25mX0tleeWtl+auteWwseS4jeimgeWOn+WtkOWMluWtmOWCqA0KICAgICAgICAgICAgJHZhbHVlID0gJHRoaXMtPlNlcmlhbGl6ZSgpOw0KDQogICAgICAgICAgICAka3YgPSBhcnJheSgkdGhpcy0+ZGF0YWluZm9bJ05hbWUnXVswXSA9PiAkbmFtZSwgJHRoaXMtPmRhdGFpbmZvWydWYWx1ZSddWzBdID0+ICR2YWx1ZSk7DQoNCiAgICAgICAgICAgICRvbGQgPSAkdGhpcy0+ZGItPlF1ZXJ5KCR0aGlzLT5kYi0+c3FsLT5TZWxlY3QoJHRoaXMtPnRhYmxlLCAnKicsIGFycmF5KGFycmF5KCc9JywgJHRoaXMtPmRhdGFpbmZvWydOYW1lJ11bMF0sICRuYW1lKSkpKTsNCiAgICAgICAgICAgIC8v5rKh5pyJ6L+Z5LiA6KGM5pWw5o2uIGFycmF5KDApIHsgfQ0KICAgICAgICAgICAgaWYgKGNvdW50KCRvbGQpID09IDApIHsNCiAgICAgICAgICAgICAgICAkc3FsID0gJHRoaXMtPmRiLT5zcWwtPkluc2VydCgkdGhpcy0+dGFibGUsICRrdik7DQogICAgICAgICAgICAgICAgJHRoaXMtPmRiLT5JbnNlcnQoJHNxbCk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIGFycmF5X3NoaWZ0KCRrdik7DQogICAgICAgICAgICAgICAgJHNxbCA9ICR0aGlzLT5kYi0+c3FsLT5VcGRhdGUoJHRoaXMtPnRhYmxlLCAka3YsIGFycmF5KGFycmF5KCc9JywgJHRoaXMtPmRhdGFpbmZvWydOYW1lJ11bMF0sICRuYW1lKSkpOw0KICAgICAgICAgICAgICAgICR0aGlzLT5kYi0+VXBkYXRlKCRzcWwpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgLy/lrZjlgqjmiJDlip/lkI7ph43nva5vcmlna3ZkYXRhDQogICAgICAgICAgICAkdGhpcy0+b3JpZ2t2ZGF0YSA9ICR0aGlzLT5rdmRhdGE7DQoNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9DQoNCiAgICAgICAgJG9sZCA9ICR0aGlzLT5kYi0+UXVlcnkoJHRoaXMtPmRiLT5zcWwtPlNlbGVjdCgkdGhpcy0+dGFibGUsICcqJywgYXJyYXkoYXJyYXkoJz0nLCAkdGhpcy0+ZGF0YWluZm9bJ05hbWUnXVswXSwgJG5hbWUpLCBhcnJheSgnPScsICR0aGlzLT5kYXRhaW5mb1snS2V5J11bMF0sICcnKSkpKTsNCiAgICAgICAgaWYgKGNvdW50KCRvbGQpID4gMCkgeyAvL+WmguaenOWtmOWcqOiAgeaVsOaNru+8jOWFiOWIoOmZpOiAgeeahA0KICAgICAgICAgICAgJGRlbCA9IGFycmF5KCk7DQogICAgICAgICAgICAkbW9kID0gYXJyYXkoKTsNCiAgICAgICAgICAgICRhZGQgPSAkdGhpcy0+a3ZkYXRhOw0KDQogICAgICAgICAgICAkc3FsID0gJHRoaXMtPmRiLT5zcWwtPkRlbGV0ZSgkdGhpcy0+dGFibGUsIGFycmF5KGFycmF5KCc9JywgJHRoaXMtPmRhdGFpbmZvWydOYW1lJ11bMF0sICRuYW1lKSwgYXJyYXkoJz0nLCAkdGhpcy0+ZGF0YWluZm9bJ0tleSddWzBdLCAnJykpKTsNCiAgICAgICAgICAgICR0aGlzLT5kYi0+RGVsZXRlKCRzcWwpOw0KICAgICAgICB9DQogICAgICAgIGlmICgoJGFkZCArICRkZWwgKyAkbW9kKSA9PSBhcnJheSgpKSB7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KDQogICAgICAgICR0aGlzLT5kYi0+VHJhbnNhY3Rpb24oJ2JlZ2luJyk7DQoNCiAgICAgICAgLy9hZGQNCiAgICAgICAgZm9yZWFjaCAoJGFkZCBhcyAka2V5MiA9PiAkdmFsdWUyKSB7DQogICAgICAgICAgICAka3YyID0gYXJyYXkoJHRoaXMtPmRhdGFpbmZvWydOYW1lJ11bMF0gPT4gJG5hbWUsICR0aGlzLT5kYXRhaW5mb1snS2V5J11bMF0gPT4gJGtleTIsICR0aGlzLT5kYXRhaW5mb1snVmFsdWUnXVswXSA9PiAkdGhpcy0+U2VyaWFsaXplU2luZ2xlKCR2YWx1ZTIpKTsNCiAgICAgICAgICAgICRzcWwgPSAkdGhpcy0+ZGItPnNxbC0+SW5zZXJ0KCR0aGlzLT50YWJsZSwgJGt2Mik7DQogICAgICAgICAgICAkb2xkID0gJHRoaXMtPmRiLT5RdWVyeSgkdGhpcy0+ZGItPnNxbC0+U2VsZWN0KCR0aGlzLT50YWJsZSwgJyonLCBhcnJheShhcnJheSgnPScsICR0aGlzLT5kYXRhaW5mb1snTmFtZSddWzBdLCAkbmFtZSksIGFycmF5KCc9JywgJHRoaXMtPmRhdGFpbmZvWydLZXknXVswXSwgJGtleTIpKSkpOw0KICAgICAgICAgICAgaWYgKGNvdW50KCRvbGQpID09IDApIHsNCiAgICAgICAgICAgICAgICAkdGhpcy0+ZGItPkluc2VydCgkc3FsKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgJGtleTMgPSAka2V5MjsNCiAgICAgICAgICAgICAgICAkdmFsdWUzID0gJHZhbHVlMjsNCiAgICAgICAgICAgICAgICAka3YzID0gYXJyYXkoJHRoaXMtPmRhdGFpbmZvWydWYWx1ZSddWzBdID0+ICR0aGlzLT5TZXJpYWxpemVTaW5nbGUoJHZhbHVlMykpOw0KICAgICAgICAgICAgICAgICRzcWwgPSAkdGhpcy0+ZGItPnNxbC0+VXBkYXRlKCR0aGlzLT50YWJsZSwgJGt2MywgYXJyYXkoYXJyYXkoJz0nLCAkdGhpcy0+ZGF0YWluZm9bJ05hbWUnXVswXSwgJG5hbWUpLCBhcnJheSgnPScsICR0aGlzLT5kYXRhaW5mb1snS2V5J11bMF0sICRrZXkzKSkpOw0KICAgICAgICAgICAgICAgICR0aGlzLT5kYi0+VXBkYXRlKCRzcWwpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIC8vbW9kDQogICAgICAgIGZvcmVhY2ggKCRtb2QgYXMgJGtleTIgPT4gJHZhbHVlMikgew0KICAgICAgICAgICAgJGt2MiA9IGFycmF5KCR0aGlzLT5kYXRhaW5mb1snTmFtZSddWzBdID0+ICRuYW1lLCAkdGhpcy0+ZGF0YWluZm9bJ0tleSddWzBdID0+ICRrZXkyLCAkdGhpcy0+ZGF0YWluZm9bJ1ZhbHVlJ11bMF0gPT4gJHRoaXMtPlNlcmlhbGl6ZVNpbmdsZSgkdmFsdWUyKSk7DQogICAgICAgICAgICAkc3FsID0gJHRoaXMtPmRiLT5zcWwtPkluc2VydCgkdGhpcy0+dGFibGUsICRrdjIpOw0KICAgICAgICAgICAgJG9sZCA9ICR0aGlzLT5kYi0+UXVlcnkoJHRoaXMtPmRiLT5zcWwtPlNlbGVjdCgkdGhpcy0+dGFibGUsICcqJywgYXJyYXkoYXJyYXkoJz0nLCAkdGhpcy0+ZGF0YWluZm9bJ05hbWUnXVswXSwgJG5hbWUpLCBhcnJheSgnPScsICR0aGlzLT5kYXRhaW5mb1snS2V5J11bMF0sICRrZXkyKSkpKTsNCiAgICAgICAgICAgIGlmIChjb3VudCgkb2xkKSA9PSAwKSB7DQogICAgICAgICAgICAgICAgJHRoaXMtPmRiLT5JbnNlcnQoJHNxbCk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICRrZXkzID0gJGtleTI7DQogICAgICAgICAgICAgICAgJHZhbHVlMyA9ICR2YWx1ZTI7DQogICAgICAgICAgICAgICAgJGt2MyA9IGFycmF5KCR0aGlzLT5kYXRhaW5mb1snVmFsdWUnXVswXSA9PiAkdGhpcy0+U2VyaWFsaXplU2luZ2xlKCR2YWx1ZTMpKTsNCiAgICAgICAgICAgICAgICAkc3FsID0gJHRoaXMtPmRiLT5zcWwtPlVwZGF0ZSgkdGhpcy0+dGFibGUsICRrdjMsIGFycmF5KGFycmF5KCc9JywgJHRoaXMtPmRhdGFpbmZvWydOYW1lJ11bMF0sICRuYW1lKSwgYXJyYXkoJz0nLCAkdGhpcy0+ZGF0YWluZm9bJ0tleSddWzBdLCAka2V5MykpKTsNCiAgICAgICAgICAgICAgICAkdGhpcy0+ZGItPlVwZGF0ZSgkc3FsKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICAvL2RlbA0KICAgICAgICBmb3JlYWNoICgkZGVsIGFzICRrZXk0ID0+ICR2YWx1ZTQpIHsNCiAgICAgICAgICAgICRzcWwgPSAkdGhpcy0+ZGItPnNxbC0+RGVsZXRlKCR0aGlzLT50YWJsZSwgYXJyYXkoYXJyYXkoJz0nLCAkdGhpcy0+ZGF0YWluZm9bJ05hbWUnXVswXSwgJG5hbWUpLCBhcnJheSgnPScsICR0aGlzLT5kYXRhaW5mb1snS2V5J11bMF0sICRrZXk0KSkpOw0KICAgICAgICAgICAgJHRoaXMtPmRiLT5EZWxldGUoJHNxbCk7DQogICAgICAgIH0NCiAgICAgICAgLy92YXJfZHVtcCgkYWRkLCRkZWwsJG1vZCk7ZGllOw0KICAgICAgICAkdGhpcy0+ZGItPlRyYW5zYWN0aW9uKCdjb21taXQnKTsNCiAgICAgICAgLy/lrZjlgqjmiJDlip/lkI7ph43nva5vcmlna3ZkYXRhDQogICAgICAgICR0aGlzLT5vcmlna3ZkYXRhID0gJHRoaXMtPmt2ZGF0YTsNCg0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDliKDpmaTmlbDmja4NCiAgICAgKiBEZWxldGXooajnpLrku47mlbDmja7lupPliKDpmaQNCiAgICAgKiDku44kemJw5Y+K5pWw5o2u5bqT5Lit5Yig6Zmk6K+l5a6e5L6LQ29uZmln5pWw5o2uLg0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIERlbGV0ZSgpDQogICAgew0KICAgICAgICBnbG9iYWwgJHpicDsNCiAgICAgICAgJG5hbWUgPSAkdGhpcy0+R2V0SXRlbU5hbWUoKTsNCiAgICAgICAgJHNxbCA9ICR0aGlzLT5kYi0+c3FsLT5EZWxldGUoJHRoaXMtPnRhYmxlLCBhcnJheShhcnJheSgnPScsICR0aGlzLT5kYXRhaW5mb1snTmFtZSddWzBdLCAkbmFtZSkpKTsNCiAgICAgICAgJHRoaXMtPmRiLT5EZWxldGUoJHNxbCk7DQogICAgICAgIHVuc2V0KCR6YnAtPmNvbmZpZ3NbJG5hbWVdKTsNCg0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiB0b1N0cmluZy4NCiAgICAgKg0KICAgICAqIOWwhkJhc2Xlr7nlg4/ov5Tlm55KU09O5pWw5o2uDQogICAgICoNCiAgICAgKiBAcmV0dXJuIHN0cmluZw0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBfX3RvU3RyaW5nKCkNCiAgICB7DQogICAgICAgIHJldHVybiAoc3RyaW5nKSBqc29uX2VuY29kZSgkdGhpcy0+a3ZkYXRhKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmt7vliqBvcuS/ruaUuUtleS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSAkbmFtZQ0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEFkZEtleSgkbmFtZSwgJHZhbHVlKQ0KICAgIHsNCiAgICAgICAgJG5hbWUgPSBGaWx0ZXJDb3JyZWN0TmFtZSgkbmFtZSk7DQogICAgICAgIGlmICghJG5hbWUpIHsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KICAgICAgICAkdGhpcy0+a3ZkYXRhWyRuYW1lXSA9ICR2YWx1ZTsNCg0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDliKDpmaRLZXnvvIzkuI3mjqjojZDkvb/nlKhEZWwoJG5hbWUpLg0KICAgICAqDQogICAgICogQHBhcmFtICRuYW1lDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gRGVsS2V5KCRuYW1lKQ0KICAgIHsNCiAgICAgICAgJG5hbWUgPSBGaWx0ZXJDb3JyZWN0TmFtZSgkbmFtZSk7DQogICAgICAgIGlmICghaXNzZXQoJHRoaXMtPmt2ZGF0YVskbmFtZV0pKSB7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCg0KICAgICAgICB1bnNldCgkdGhpcy0+a3ZkYXRhWyRuYW1lXSk7DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQp9DQo=</file>
</files>